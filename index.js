import * as React__default from 'react';
import React__default__default, { useState, useCallback, useRef, useEffect, createContext, useContext, useReducer, useLayoutEffect, useMemo } from 'react';
import { createPortal } from 'react-dom';

function _mergeNamespaces(n, m) {
    m.forEach(function (e) {
        e && typeof e !== 'string' && !Array.isArray(e) && Object.keys(e).forEach(function (k) {
            if (k !== 'default' && !(k in n)) {
                var d = Object.getOwnPropertyDescriptor(e, k);
                Object.defineProperty(n, k, d.get ? d : {
                    enumerable: true,
                    get: function () { return e[k]; }
                });
            }
        });
    });
    return Object.freeze(n);
}

/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var __assign = function () {
  __assign = Object.assign || function __assign(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];

      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
    }

    return t;
  };

  return __assign.apply(this, arguments);
};
function __awaiter$2(thisArg, _arguments, P, generator) {
  function adopt(value) {
    return value instanceof P ? value : new P(function (resolve) {
      resolve(value);
    });
  }

  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
}
function __generator(thisArg, body) {
  var _ = {
    label: 0,
    sent: function () {
      if (t[0] & 1) throw t[1];
      return t[1];
    },
    trys: [],
    ops: []
  },
      f,
      y,
      t,
      g;
  return g = {
    next: verb(0),
    "throw": verb(1),
    "return": verb(2)
  }, typeof Symbol === "function" && (g[Symbol.iterator] = function () {
    return this;
  }), g;

  function verb(n) {
    return function (v) {
      return step([n, v]);
    };
  }

  function step(op) {
    if (f) throw new TypeError("Generator is already executing.");

    while (_) try {
      if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
      if (y = 0, t) op = [op[0] & 2, t.value];

      switch (op[0]) {
        case 0:
        case 1:
          t = op;
          break;

        case 4:
          _.label++;
          return {
            value: op[1],
            done: false
          };

        case 5:
          _.label++;
          y = op[1];
          op = [0];
          continue;

        case 7:
          op = _.ops.pop();

          _.trys.pop();

          continue;

        default:
          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
            _ = 0;
            continue;
          }

          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
            _.label = op[1];
            break;
          }

          if (op[0] === 6 && _.label < t[1]) {
            _.label = t[1];
            t = op;
            break;
          }

          if (t && _.label < t[2]) {
            _.label = t[2];

            _.ops.push(op);

            break;
          }

          if (t[2]) _.ops.pop();

          _.trys.pop();

          continue;
      }

      op = body.call(thisArg, _);
    } catch (e) {
      op = [6, e];
      y = 0;
    } finally {
      f = t = 0;
    }

    if (op[0] & 5) throw op[1];
    return {
      value: op[0] ? op[1] : void 0,
      done: true
    };
  }
}
function __spreadArray(to, from, pack) {
  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
    if (ar || !(i in from)) {
      if (!ar) ar = Array.prototype.slice.call(from, 0, i);
      ar[i] = from[i];
    }
  }
  return to.concat(ar || Array.prototype.slice.call(from));
}

var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

var sendbirdLive_min = {exports: {}};

(function (module, exports) {
	!function(e,t){t(exports);}(commonjsGlobal,function(e){function t(e,t){return t.forEach(function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n];}});}});}),Object.freeze(e);}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable;})),n.push.apply(n,r);}return n;}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){d(e,t,r[t]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t));});}return e;}function i(){i=function(){return e;};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value;},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{c({},"");}catch(e){c=function(e,t,n){return e[t]=n;};}function l(e,t,n,i){var s=t&&t.prototype instanceof f?t:f,o=Object.create(s.prototype),a=new C(i||[]);return r(o,"_invoke",{value:w(e,n,a)}),o;}function d(e,t,n){try{return {type:"normal",arg:e.call(t,n)};}catch(e){return {type:"throw",arg:e};}}e.wrap=l;var h={};function f(){}function p(){}function v(){}var _={};c(_,o,function(){return this;});var y=Object.getPrototypeOf,m=y&&y(y(k([])));m&&m!==t&&n.call(m,o)&&(_=m);var g=v.prototype=f.prototype=Object.create(_);function E(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e);});});}function b(e,t){function i(r,s,o,a){var u=d(e[r],e,s);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then(function(e){i("next",e,o,a);},function(e){i("throw",e,o,a);}):t.resolve(l).then(function(e){c.value=e,o(c);},function(e){return i("throw",e,o,a);});}a(u.arg);}var s;r(this,"_invoke",{value:function(e,n){function r(){return new t(function(t,r){i(e,n,t,r);});}return s=s?s.then(r,r):r();}});}function w(e,t,n){var r="suspendedStart";return function(i,s){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw s;return A();}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var a=I(o,n);if(a){if(a===h)continue;return a;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg);}else "return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=d(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return {value:u.arg,done:n.done};}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg);}};}function I(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var s=i.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h);}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0);}function k(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t;};return i.next=i;}}return {next:A};}function A(){return {value:void 0,done:!0};}return p.prototype=v,r(g,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:p,configurable:!0}),p.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return !!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name));},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e;},e.awrap=function(e){return {__await:e};},E(b.prototype),c(b.prototype,a,function(){return this;}),e.AsyncIterator=b,e.async=function(t,n,r,i,s){void 0===s&&(s=Promise);var o=new b(l(t,n,r,i),s);return e.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next();});},E(g),c(g,u,"Generator"),c(g,o,function(){return this;}),c(g,"toString",function(){return "[object Generator]";}),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e;}return e.done=!0,e;};},e.values=k,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0);},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r;}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var a=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(a&&u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc);}else if(a){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);}else {if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc);}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break;}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o);},complete:function(e,t){if("throw"===e.type)throw e.arg;return "break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h;},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),h;}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n);}return i;}}throw new Error("illegal catch attempt");},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h;}},e;}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e;}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},s(e);}function o(e,t,n,r,i,s,o){try{var a=e[s](o),u=a.value;}catch(e){return void n(e);}a.done?t(u):Promise.resolve(u).then(r,i);}function a(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var s=e.apply(t,n);function a(e){o(s,r,i,a,u,"next",e);}function u(e){o(s,r,i,a,u,"throw",e);}a(void 0);});};}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r);}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;}function d(e,t,n){return (t=S(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t);}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},f(e);}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},p(e,t);}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}function _(e,t,n){return _=v()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r))();return n&&p(i,n.prototype),i;},_.apply(null,arguments);}function y(e){var t="function"==typeof Map?new Map():void 0;return y=function(e){if(null===e||!function(e){return -1!==Function.toString.call(e).indexOf("[native code]");}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n);}function n(){return _(e,arguments,f(this).constructor);}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),p(n,e);},y(e);}function m(e,t){if(null==e)return {};var n,r,i=function(e,t){if(null==e)return {};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i;}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);}return i;}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function E(e){var t=v();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i);}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e);}(this,n);};}function b(e){return function(e){if(Array.isArray(e))return I(e);}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e);}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}();}function w(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return "Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0;}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r;}function T(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=w(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return {s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function(e){throw e;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var s,o=!0,a=!1;return {s:function(){n=n.call(e);},n:function(){var e=n.next();return o=e.done,e;},e:function(e){a=!0,s=e;},f:function(){try{o||null==n.return||n.return();}finally{if(a)throw s;}}};}function S(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.");}return ("string"===t?String:Number)(e);}(e,"string");return "symbol"==typeof t?t:String(t);}var C,k=new Uint8Array(16);function A(){if(!C&&!(C="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return C(k);}var N=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function O(e){return "string"==typeof e&&N.test(e);}for(var R=[],D=0;D<256;++D)R.push((D+256).toString(16).substr(1));function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(R[e[t+0]]+R[e[t+1]]+R[e[t+2]]+R[e[t+3]]+"-"+R[e[t+4]]+R[e[t+5]]+"-"+R[e[t+6]]+R[e[t+7]]+"-"+R[e[t+8]]+R[e[t+9]]+"-"+R[e[t+10]]+R[e[t+11]]+R[e[t+12]]+R[e[t+13]]+R[e[t+14]]+R[e[t+15]]).toLowerCase();if(!O(n))throw TypeError("Stringified UUID is invalid");return n;}var L="6ba7b810-9dad-11d1-80b4-00c04fd430c8",M="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function U(e,t,n){function r(e,r,i,s){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t;}(e)),"string"==typeof r&&(r=function(e){if(!O(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n;}(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var o=new Uint8Array(16+e.length);if(o.set(r),o.set(e,r.length),(o=n(o))[6]=15&o[6]|t,o[8]=63&o[8]|128,i){s=s||0;for(var a=0;a<16;++a)i[s+a]=o[a];return i;}return x(o);}try{r.name=e;}catch(e){}return r.DNS=L,r.URL=M,r;}function P(e){return 14+(e+64>>>9<<4)+1;}function F(e,t){var n=(65535&e)+(65535&t);return (e>>16)+(t>>16)+(n>>16)<<16|65535&n;}function q(e,t,n,r,i,s){return F((o=F(F(t,e),F(r,s)))<<(a=i)|o>>>32-a,n);var o,a;}function H(e,t,n,r,i,s,o){return q(t&n|~t&r,e,t,i,s,o);}function j(e,t,n,r,i,s,o){return q(t&r|n&~r,e,t,i,s,o);}function V(e,t,n,r,i,s,o){return q(t^n^r,e,t,i,s,o);}function G(e,t,n,r,i,s,o){return q(n^(t|~r),e,t,i,s,o);}function z(e,t,n){var r=(e=e||{}).random||(e.rng||A)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t;}return x(r);}function B(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r;}}function K(e,t){return e<<t|e>>>32-t;}U("v3",48,function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n);}return function(e){for(var t=[],n=32*e.length,r="0123456789abcdef",i=0;i<n;i+=8){var s=e[i>>5]>>>i%32&255,o=parseInt(r.charAt(s>>>4&15)+r.charAt(15&s),16);t.push(o);}return t;}(function(e,t){e[t>>5]|=128<<t%32,e[P(t)-1]=t;for(var n=1732584193,r=-271733879,i=-1732584194,s=271733878,o=0;o<e.length;o+=16){var a=n,u=r,c=i,l=s;n=H(n,r,i,s,e[o],7,-680876936),s=H(s,n,r,i,e[o+1],12,-389564586),i=H(i,s,n,r,e[o+2],17,606105819),r=H(r,i,s,n,e[o+3],22,-1044525330),n=H(n,r,i,s,e[o+4],7,-176418897),s=H(s,n,r,i,e[o+5],12,1200080426),i=H(i,s,n,r,e[o+6],17,-1473231341),r=H(r,i,s,n,e[o+7],22,-45705983),n=H(n,r,i,s,e[o+8],7,1770035416),s=H(s,n,r,i,e[o+9],12,-1958414417),i=H(i,s,n,r,e[o+10],17,-42063),r=H(r,i,s,n,e[o+11],22,-1990404162),n=H(n,r,i,s,e[o+12],7,1804603682),s=H(s,n,r,i,e[o+13],12,-40341101),i=H(i,s,n,r,e[o+14],17,-1502002290),n=j(n,r=H(r,i,s,n,e[o+15],22,1236535329),i,s,e[o+1],5,-165796510),s=j(s,n,r,i,e[o+6],9,-1069501632),i=j(i,s,n,r,e[o+11],14,643717713),r=j(r,i,s,n,e[o],20,-373897302),n=j(n,r,i,s,e[o+5],5,-701558691),s=j(s,n,r,i,e[o+10],9,38016083),i=j(i,s,n,r,e[o+15],14,-660478335),r=j(r,i,s,n,e[o+4],20,-405537848),n=j(n,r,i,s,e[o+9],5,568446438),s=j(s,n,r,i,e[o+14],9,-1019803690),i=j(i,s,n,r,e[o+3],14,-187363961),r=j(r,i,s,n,e[o+8],20,1163531501),n=j(n,r,i,s,e[o+13],5,-1444681467),s=j(s,n,r,i,e[o+2],9,-51403784),i=j(i,s,n,r,e[o+7],14,1735328473),n=V(n,r=j(r,i,s,n,e[o+12],20,-1926607734),i,s,e[o+5],4,-378558),s=V(s,n,r,i,e[o+8],11,-2022574463),i=V(i,s,n,r,e[o+11],16,1839030562),r=V(r,i,s,n,e[o+14],23,-35309556),n=V(n,r,i,s,e[o+1],4,-1530992060),s=V(s,n,r,i,e[o+4],11,1272893353),i=V(i,s,n,r,e[o+7],16,-155497632),r=V(r,i,s,n,e[o+10],23,-1094730640),n=V(n,r,i,s,e[o+13],4,681279174),s=V(s,n,r,i,e[o],11,-358537222),i=V(i,s,n,r,e[o+3],16,-722521979),r=V(r,i,s,n,e[o+6],23,76029189),n=V(n,r,i,s,e[o+9],4,-640364487),s=V(s,n,r,i,e[o+12],11,-421815835),i=V(i,s,n,r,e[o+15],16,530742520),n=G(n,r=V(r,i,s,n,e[o+2],23,-995338651),i,s,e[o],6,-198630844),s=G(s,n,r,i,e[o+7],10,1126891415),i=G(i,s,n,r,e[o+14],15,-1416354905),r=G(r,i,s,n,e[o+5],21,-57434055),n=G(n,r,i,s,e[o+12],6,1700485571),s=G(s,n,r,i,e[o+3],10,-1894986606),i=G(i,s,n,r,e[o+10],15,-1051523),r=G(r,i,s,n,e[o+1],21,-2054922799),n=G(n,r,i,s,e[o+8],6,1873313359),s=G(s,n,r,i,e[o+15],10,-30611744),i=G(i,s,n,r,e[o+6],15,-1560198380),r=G(r,i,s,n,e[o+13],21,1309151649),n=G(n,r,i,s,e[o+4],6,-145523070),s=G(s,n,r,i,e[o+11],10,-1120210379),i=G(i,s,n,r,e[o+2],15,718787259),r=G(r,i,s,n,e[o+9],21,-343485551),n=F(n,a),r=F(r,u),i=F(i,c),s=F(s,l);}return [n,r,i,s];}(function(e){if(0===e.length)return [];for(var t=8*e.length,n=new Uint32Array(P(t)),r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n;}(e),8*e.length));}),U("v5",80,function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var r=unescape(encodeURIComponent(e));e=[];for(var i=0;i<r.length;++i)e.push(r.charCodeAt(i));}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var s=e.length/4+2,o=Math.ceil(s/16),a=new Array(o),u=0;u<o;++u){for(var c=new Uint32Array(16),l=0;l<16;++l)c[l]=e[64*u+4*l]<<24|e[64*u+4*l+1]<<16|e[64*u+4*l+2]<<8|e[64*u+4*l+3];a[u]=c;}a[o-1][14]=8*(e.length-1)/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=8*(e.length-1)&4294967295;for(var d=0;d<o;++d){for(var h=new Uint32Array(80),f=0;f<16;++f)h[f]=a[d][f];for(var p=16;p<80;++p)h[p]=K(h[p-3]^h[p-8]^h[p-14]^h[p-16],1);for(var v=n[0],_=n[1],y=n[2],m=n[3],g=n[4],E=0;E<80;++E){var b=Math.floor(E/20),w=K(v,5)+B(b,_,y,m)+g+t[b]+h[E]>>>0;g=m,m=y,y=K(_,30)>>>0,_=v,v=w;}n[0]=n[0]+v>>>0,n[1]=n[1]+_>>>0,n[2]=n[2]+y>>>0,n[3]=n[3]+m>>>0,n[4]=n[4]+g>>>0;}return [n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]];});var Q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof commonjsGlobal?commonjsGlobal:"undefined"!=typeof self?self:{},W=function(e){try{return !!e();}catch(e){return !0;}},Y=!W(function(){var e=function(){}.bind();return "function"!=typeof e||e.hasOwnProperty("prototype");}),Z=Y,X=Function.prototype,J=X.call,$=Z&&X.bind.bind(J,J),ee=Z?$:function(e){return function(){return J.apply(e,arguments);};},te=ee,ne=te({}.toString),re=te("".slice),ie=function(e){return re(ne(e),8,-1);},se=W,oe=ie,ae=Object,ue=ee("".split),ce=se(function(){return !ae("z").propertyIsEnumerable(0);})?function(e){return "String"==oe(e)?ue(e,""):ae(e);}:ae,le=function(e){return null==e;},de=le,he=TypeError,fe=function(e){if(de(e))throw he("Can't call method on "+e);return e;},pe=ce,ve=fe,_e=function(e){return pe(ve(e));},ye=function(e){return e&&e.Math==Math&&e;},me=ye("object"==typeof globalThis&&globalThis)||ye("object"==typeof window&&window)||ye("object"==typeof self&&self)||ye("object"==typeof Q&&Q)||function(){return this;}()||Function("return this")(),ge={exports:{}},Ee=me,be=Object.defineProperty,we=function(e,t){try{be(Ee,e,{value:t,configurable:!0,writable:!0});}catch(n){Ee[e]=t;}return t;},Ie=we,Te="__core-js_shared__",Se=me[Te]||Ie(Te,{}),Ce=Se;(ge.exports=function(e,t){return Ce[e]||(Ce[e]=void 0!==t?t:{});})("versions",[]).push({version:"3.29.1",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.29.1/LICENSE",source:"https://github.com/zloirock/core-js"});var ke,Ae,Ne=fe,Oe=Object,Re=function(e){return Oe(Ne(e));},De=Re,xe=ee({}.hasOwnProperty),Le=Object.hasOwn||function(e,t){return xe(De(e),t);},Me=ee,Ue=0,Pe=Math.random(),Fe=Me(1..toString),qe=function(e){return "Symbol("+(void 0===e?"":e)+")_"+Fe(++Ue+Pe,36);},He="undefined"!=typeof navigator&&String(navigator.userAgent)||"",je=me,Ve=He,Ge=je.process,ze=je.Deno,Be=Ge&&Ge.versions||ze&&ze.version,Ke=Be&&Be.v8;Ke&&(Ae=(ke=Ke.split("."))[0]>0&&ke[0]<4?1:+(ke[0]+ke[1])),!Ae&&Ve&&(!(ke=Ve.match(/Edge\/(\d+)/))||ke[1]>=74)&&(ke=Ve.match(/Chrome\/(\d+)/))&&(Ae=+ke[1]);var Qe=Ae,We=Qe,Ye=W,Ze=!!Object.getOwnPropertySymbols&&!Ye(function(){var e=Symbol();return !String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&We&&We<41;}),Xe=Ze&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Je=me,$e=ge.exports,et=Le,tt=qe,nt=Ze,rt=Xe,it=Je.Symbol,st=$e("wks"),ot=rt?it.for||it:it&&it.withoutSetter||tt,at=function(e){return et(st,e)||(st[e]=nt&&et(it,e)?it[e]:ot("Symbol."+e)),st[e];},ut="object"==typeof document&&document.all,ct={all:ut,IS_HTMLDDA:void 0===ut&&void 0!==ut},lt=ct.all,dt=ct.IS_HTMLDDA?function(e){return "function"==typeof e||e===lt;}:function(e){return "function"==typeof e;},ht=dt,ft=ct.all,pt=ct.IS_HTMLDDA?function(e){return "object"==typeof e?null!==e:ht(e)||e===ft;}:function(e){return "object"==typeof e?null!==e:ht(e);},vt=pt,_t=String,yt=TypeError,mt=function(e){if(vt(e))return e;throw yt(_t(e)+" is not an object");},gt={},Et=!W(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7;}})[1];}),bt=Et&&W(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype;}),wt={},It=pt,Tt=me.document,St=It(Tt)&&It(Tt.createElement),Ct=function(e){return St?Tt.createElement(e):{};},kt=Ct,At=!Et&&!W(function(){return 7!=Object.defineProperty(kt("div"),"a",{get:function(){return 7;}}).a;}),Nt=Y,Ot=Function.prototype.call,Rt=Nt?Ot.bind(Ot):function(){return Ot.apply(Ot,arguments);},Dt=me,xt=dt,Lt=function(e,t){return arguments.length<2?(n=Dt[e],xt(n)?n:void 0):Dt[e]&&Dt[e][t];var n;},Mt=ee({}.isPrototypeOf),Ut=Lt,Pt=dt,Ft=Mt,qt=Object,Ht=Xe?function(e){return "symbol"==typeof e;}:function(e){var t=Ut("Symbol");return Pt(t)&&Ft(t.prototype,qt(e));},jt=String,Vt=function(e){try{return jt(e);}catch(e){return "Object";}},Gt=dt,zt=Vt,Bt=TypeError,Kt=function(e){if(Gt(e))return e;throw Bt(zt(e)+" is not a function");},Qt=Kt,Wt=le,Yt=function(e,t){var n=e[t];return Wt(n)?void 0:Qt(n);},Zt=Rt,Xt=dt,Jt=pt,$t=TypeError,en=Rt,tn=pt,nn=Ht,rn=Yt,sn=function(e,t){var n,r;if("string"===t&&Xt(n=e.toString)&&!Jt(r=Zt(n,e)))return r;if(Xt(n=e.valueOf)&&!Jt(r=Zt(n,e)))return r;if("string"!==t&&Xt(n=e.toString)&&!Jt(r=Zt(n,e)))return r;throw $t("Can't convert object to primitive value");},on=TypeError,an=at("toPrimitive"),un=function(e,t){if(!tn(e)||nn(e))return e;var n,r=rn(e,an);if(r){if(void 0===t&&(t="default"),n=en(r,e,t),!tn(n)||nn(n))return n;throw on("Can't convert object to primitive value");}return void 0===t&&(t="number"),sn(e,t);},cn=un,ln=Ht,dn=function(e){var t=cn(e,"string");return ln(t)?t:t+"";},hn=Et,fn=At,pn=bt,vn=mt,_n=dn,yn=TypeError,mn=Object.defineProperty,gn=Object.getOwnPropertyDescriptor,En="enumerable",bn="configurable",wn="writable";wt.f=hn?pn?function(e,t,n){if(vn(e),t=_n(t),vn(n),"function"==typeof e&&"prototype"===t&&"value"in n&&wn in n&&!n[wn]){var r=gn(e,t);r&&r[wn]&&(e[t]=n.value,n={configurable:bn in n?n[bn]:r[bn],enumerable:En in n?n[En]:r[En],writable:!1});}return mn(e,t,n);}:mn:function(e,t,n){if(vn(e),t=_n(t),vn(n),fn)try{return mn(e,t,n);}catch(e){}if("get"in n||"set"in n)throw yn("Accessors not supported");return "value"in n&&(e[t]=n.value),e;};var In=Math.ceil,Tn=Math.floor,Sn=Math.trunc||function(e){var t=+e;return (t>0?Tn:In)(t);},Cn=Sn,kn=function(e){var t=+e;return t!=t||0===t?0:Cn(t);},An=kn,Nn=Math.max,On=Math.min,Rn=function(e,t){var n=An(e);return n<0?Nn(n+t,0):On(n,t);},Dn=kn,xn=Math.min,Ln=function(e){return e>0?xn(Dn(e),9007199254740991):0;},Mn=Ln,Un=function(e){return Mn(e.length);},Pn=_e,Fn=Rn,qn=Un,Hn=function(e){return function(t,n,r){var i,s=Pn(t),o=qn(s),a=Fn(r,o);if(e&&n!=n){for(;o>a;)if((i=s[a++])!=i)return !0;}else for(;o>a;a++)if((e||a in s)&&s[a]===n)return e||a||0;return !e&&-1;};},jn={includes:Hn(!0),indexOf:Hn(!1)},Vn={},Gn=Le,zn=_e,Bn=jn.indexOf,Kn=Vn,Qn=ee([].push),Wn=function(e,t){var n,r=zn(e),i=0,s=[];for(n in r)!Gn(Kn,n)&&Gn(r,n)&&Qn(s,n);for(;t.length>i;)Gn(r,n=t[i++])&&(~Bn(s,n)||Qn(s,n));return s;},Yn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Zn=Wn,Xn=Yn,Jn=Object.keys||function(e){return Zn(e,Xn);},$n=Et,er=bt,tr=wt,nr=mt,rr=_e,ir=Jn;gt.f=$n&&!er?Object.defineProperties:function(e,t){nr(e);for(var n,r=rr(t),i=ir(t),s=i.length,o=0;s>o;)tr.f(e,n=i[o++],r[n]);return e;};var sr,or=Lt("document","documentElement"),ar=ge.exports,ur=qe,cr=ar("keys"),lr=function(e){return cr[e]||(cr[e]=ur(e));},dr=mt,hr=gt,fr=Yn,pr=Vn,vr=or,_r=Ct,yr="prototype",mr="script",gr=lr("IE_PROTO"),Er=function(){},br=function(e){return "<"+mr+">"+e+"</"+mr+">";},wr=function(e){e.write(br("")),e.close();var t=e.parentWindow.Object;return e=null,t;},Ir=function(){try{sr=new ActiveXObject("htmlfile");}catch(e){}var e,t,n;Ir="undefined"!=typeof document?document.domain&&sr?wr(sr):(t=_r("iframe"),n="java"+mr+":",t.style.display="none",vr.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(br("document.F=Object")),e.close(),e.F):wr(sr);for(var r=fr.length;r--;)delete Ir[yr][fr[r]];return Ir();};pr[gr]=!0;var Tr=Object.create||function(e,t){var n;return null!==e?(Er[yr]=dr(e),n=new Er(),Er[yr]=null,n[gr]=e):n=Ir(),void 0===t?n:hr.f(n,t);},Sr=at,Cr=Tr,kr=wt.f,Ar=Sr("unscopables"),Nr=Array.prototype;null==Nr[Ar]&&kr(Nr,Ar,{configurable:!0,value:Cr(null)});var Or,Rr,Dr,xr=function(e){Nr[Ar][e]=!0;},Lr={},Mr=dt,Ur=me.WeakMap,Pr=Mr(Ur)&&/native code/.test(String(Ur)),Fr=function(e,t){return {enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t};},qr=wt,Hr=Fr,jr=Et?function(e,t,n){return qr.f(e,t,Hr(1,n));}:function(e,t,n){return e[t]=n,e;},Vr=Pr,Gr=me,zr=pt,Br=jr,Kr=Le,Qr=Se,Wr=lr,Yr=Vn,Zr="Object already initialized",Xr=Gr.TypeError,Jr=Gr.WeakMap;if(Vr||Qr.state){var $r=Qr.state||(Qr.state=new Jr());$r.get=$r.get,$r.has=$r.has,$r.set=$r.set,Or=function(e,t){if($r.has(e))throw Xr(Zr);return t.facade=e,$r.set(e,t),t;},Rr=function(e){return $r.get(e)||{};},Dr=function(e){return $r.has(e);};}else {var ei=Wr("state");Yr[ei]=!0,Or=function(e,t){if(Kr(e,ei))throw Xr(Zr);return t.facade=e,Br(e,ei,t),t;},Rr=function(e){return Kr(e,ei)?e[ei]:{};},Dr=function(e){return Kr(e,ei);};}var ti={set:Or,get:Rr,has:Dr,enforce:function(e){return Dr(e)?Rr(e):Or(e,{});},getterFor:function(e){return function(t){var n;if(!zr(t)||(n=Rr(t)).type!==e)throw Xr("Incompatible receiver, "+e+" required");return n;};}},ni={},ri={},ii={}.propertyIsEnumerable,si=Object.getOwnPropertyDescriptor,oi=si&&!ii.call({1:2},1);ri.f=oi?function(e){var t=si(this,e);return !!t&&t.enumerable;}:ii;var ai=Et,ui=Rt,ci=ri,li=Fr,di=_e,hi=dn,fi=Le,pi=At,vi=Object.getOwnPropertyDescriptor;ni.f=ai?vi:function(e,t){if(e=di(e),t=hi(t),pi)try{return vi(e,t);}catch(e){}if(fi(e,t))return li(!ui(ci.f,e,t),e[t]);};var _i={exports:{}},yi=Et,mi=Le,gi=Function.prototype,Ei=yi&&Object.getOwnPropertyDescriptor,bi=mi(gi,"name"),wi={EXISTS:bi,PROPER:bi&&"something"===function(){}.name,CONFIGURABLE:bi&&(!yi||yi&&Ei(gi,"name").configurable)},Ii=dt,Ti=Se,Si=ee(Function.toString);Ii(Ti.inspectSource)||(Ti.inspectSource=function(e){return Si(e);});var Ci=Ti.inspectSource,ki=ee,Ai=W,Ni=dt,Oi=Le,Ri=Et,Di=wi.CONFIGURABLE,xi=Ci,Li=ti.enforce,Mi=ti.get,Ui=String,Pi=Object.defineProperty,Fi=ki("".slice),qi=ki("".replace),Hi=ki([].join),ji=Ri&&!Ai(function(){return 8!==Pi(function(){},"length",{value:8}).length;}),Vi=String(String).split("String"),Gi=_i.exports=function(e,t,n){"Symbol("===Fi(Ui(t),0,7)&&(t="["+qi(Ui(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!Oi(e,"name")||Di&&e.name!==t)&&(Ri?Pi(e,"name",{value:t,configurable:!0}):e.name=t),ji&&n&&Oi(n,"arity")&&e.length!==n.arity&&Pi(e,"length",{value:n.arity});try{n&&Oi(n,"constructor")&&n.constructor?Ri&&Pi(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0);}catch(e){}var r=Li(e);return Oi(r,"source")||(r.source=Hi(Vi,"string"==typeof t?t:"")),e;};Function.prototype.toString=Gi(function(){return Ni(this)&&Mi(this).source||xi(this);},"toString");var zi=dt,Bi=wt,Ki=_i.exports,Qi=we,Wi=function(e,t,n,r){r||(r={});var i=r.enumerable,s=void 0!==r.name?r.name:t;if(zi(n)&&Ki(n,s,r),r.global)i?e[t]=n:Qi(t,n);else {try{r.unsafe?e[t]&&(i=!0):delete e[t];}catch(e){}i?e[t]=n:Bi.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable});}return e;},Yi={},Zi=Wn,Xi=Yn.concat("length","prototype");Yi.f=Object.getOwnPropertyNames||function(e){return Zi(e,Xi);};var Ji={};Ji.f=Object.getOwnPropertySymbols;var $i,es,ts,ns=Lt,rs=Yi,is=Ji,ss=mt,os=ee([].concat),as=ns("Reflect","ownKeys")||function(e){var t=rs.f(ss(e)),n=is.f;return n?os(t,n(e)):t;},us=Le,cs=as,ls=ni,ds=wt,hs=W,fs=dt,ps=/#|\.prototype\./,vs=function(e,t){var n=ys[_s(e)];return n==gs||n!=ms&&(fs(t)?hs(t):!!t);},_s=vs.normalize=function(e){return String(e).replace(ps,".").toLowerCase();},ys=vs.data={},ms=vs.NATIVE="N",gs=vs.POLYFILL="P",Es=vs,bs=me,ws=ni.f,Is=jr,Ts=Wi,Ss=we,Cs=function(e,t,n){for(var r=cs(t),i=ds.f,s=ls.f,o=0;o<r.length;o++){var a=r[o];us(e,a)||n&&us(n,a)||i(e,a,s(t,a));}},ks=Es,As=function(e,t){var n,r,i,s,o,a=e.target,u=e.global,c=e.stat;if(n=u?bs:c?bs[a]||Ss(a,{}):(bs[a]||{}).prototype)for(r in t){if(s=t[r],i=e.dontCallGetSet?(o=ws(n,r))&&o.value:n[r],!ks(u?r:a+(c?".":"#")+r,e.forced)&&void 0!==i){if(typeof s==typeof i)continue;Cs(s,i);}(e.sham||i&&i.sham)&&Is(s,"sham",!0),Ts(n,r,s,e);}},Ns=!W(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e())!==e.prototype;}),Os=Le,Rs=dt,Ds=Re,xs=Ns,Ls=lr("IE_PROTO"),Ms=Object,Us=Ms.prototype,Ps=xs?Ms.getPrototypeOf:function(e){var t=Ds(e);if(Os(t,Ls))return t[Ls];var n=t.constructor;return Rs(n)&&t instanceof n?n.prototype:t instanceof Ms?Us:null;},Fs=W,qs=dt,Hs=pt,js=Ps,Vs=Wi,Gs=at("iterator"),zs=!1;[].keys&&("next"in(ts=[].keys())?(es=js(js(ts)))!==Object.prototype&&($i=es):zs=!0);var Bs=!Hs($i)||Fs(function(){var e={};return $i[Gs].call(e)!==e;});Bs&&($i={}),qs($i[Gs])||Vs($i,Gs,function(){return this;});var Ks={IteratorPrototype:$i,BUGGY_SAFARI_ITERATORS:zs},Qs=wt.f,Ws=Le,Ys=at("toStringTag"),Zs=function(e,t,n){e&&!n&&(e=e.prototype),e&&!Ws(e,Ys)&&Qs(e,Ys,{configurable:!0,value:t});},Xs=Ks.IteratorPrototype,Js=Tr,$s=Fr,eo=Zs,to=Lr,no=function(){return this;},ro=ee,io=Kt,so=dt,oo=String,ao=TypeError,uo=function(e,t,n){try{return ro(io(Object.getOwnPropertyDescriptor(e,t)[n]));}catch(e){}},co=mt,lo=function(e){if("object"==typeof e||so(e))return e;throw ao("Can't set "+oo(e)+" as a prototype");},ho=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=uo(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array;}catch(e){}return function(n,r){return co(n),lo(r),t?e(n,r):n.__proto__=r,n;};}():void 0),fo=As,po=Rt,vo=dt,_o=function(e,t,n,r){var i=t+" Iterator";return e.prototype=Js(Xs,{next:$s(+!r,n)}),eo(e,i,!1),to[i]=no,e;},yo=Ps,mo=ho,go=Zs,Eo=jr,bo=Wi,wo=Lr,Io=wi.PROPER,To=wi.CONFIGURABLE,So=Ks.IteratorPrototype,Co=Ks.BUGGY_SAFARI_ITERATORS,ko=at("iterator"),Ao="keys",No="values",Oo="entries",Ro=function(){return this;},Do=function(e,t,n,r,i,s,o){_o(n,t,r);var a,u,c,l=function(e){if(e===i&&v)return v;if(!Co&&e in f)return f[e];switch(e){case Ao:case No:case Oo:return function(){return new n(this,e);};}return function(){return new n(this);};},d=t+" Iterator",h=!1,f=e.prototype,p=f[ko]||f["@@iterator"]||i&&f[i],v=!Co&&p||l(i),_="Array"==t&&f.entries||p;if(_&&(a=yo(_.call(new e())))!==Object.prototype&&a.next&&(yo(a)!==So&&(mo?mo(a,So):vo(a[ko])||bo(a,ko,Ro)),go(a,d,!0)),Io&&i==No&&p&&p.name!==No&&(To?Eo(f,"name",No):(h=!0,v=function(){return po(p,this);})),i)if(u={values:l(No),keys:s?v:l(Ao),entries:l(Oo)},o)for(c in u)(Co||h||!(c in f))&&bo(f,c,u[c]);else fo({target:t,proto:!0,forced:Co||h},u);return f[ko]!==v&&bo(f,ko,v,{name:i}),wo[t]=v,u;},xo=function(e,t){return {value:e,done:t};},Lo=_e,Mo=xr,Uo=Lr,Po=ti,Fo=wt.f,qo=Do,Ho=xo,jo=Et,Vo="Array Iterator",Go=Po.set,zo=Po.getterFor(Vo),Bo=qo(Array,"Array",function(e,t){Go(this,{type:Vo,target:Lo(e),index:0,kind:t});},function(){var e=zo(this),t=e.target,n=e.kind,r=e.index++;return !t||r>=t.length?(e.target=void 0,Ho(void 0,!0)):Ho("keys"==n?r:"values"==n?t[r]:[r,t[r]],!1);},"values"),Ko=Uo.Arguments=Uo.Array;if(Mo("keys"),Mo("values"),Mo("entries"),jo&&"values"!==Ko.name)try{Fo(Ko,"name",{value:"values"});}catch(e){}var Qo={};Qo[at("toStringTag")]="z";var Wo="[object z]"===String(Qo),Yo=Wo,Zo=dt,Xo=ie,Jo=at("toStringTag"),$o=Object,ea="Arguments"==Xo(function(){return arguments;}()),ta=Yo?Xo:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t];}catch(e){}}(t=$o(e),Jo))?n:ea?Xo(t):"Object"==(r=Xo(t))&&Zo(t.callee)?"Arguments":r;},na=ta,ra=Wo?{}.toString:function(){return "[object "+na(this)+"]";};Wo||Wi(Object.prototype,"toString",ra,{unsafe:!0});var ia="undefined"!=typeof process&&"process"==ie(process),sa=_i.exports,oa=wt,aa=function(e,t,n){return n.get&&sa(n.get,t,{getter:!0}),n.set&&sa(n.set,t,{setter:!0}),oa.f(e,t,n);},ua=Lt,ca=aa,la=Et,da=at("species"),ha=function(e){var t=ua(e);la&&t&&!t[da]&&ca(t,da,{configurable:!0,get:function(){return this;}});},fa=Mt,pa=TypeError,va=function(e,t){if(fa(t,e))return e;throw pa("Incorrect invocation");},_a=ee,ya=W,ma=dt,ga=ta,Ea=Ci,ba=function(){},wa=[],Ia=Lt("Reflect","construct"),Ta=/^\s*(?:class|function)\b/,Sa=_a(Ta.exec),Ca=!Ta.exec(ba),ka=function(e){if(!ma(e))return !1;try{return Ia(ba,wa,e),!0;}catch(e){return !1;}},Aa=function(e){if(!ma(e))return !1;switch(ga(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return !1;}try{return Ca||!!Sa(Ta,Ea(e));}catch(e){return !0;}};Aa.sham=!0;var Na,Oa,Ra,Da,xa=!Ia||ya(function(){var e;return ka(ka.call)||!ka(Object)||!ka(function(){e=!0;})||e;})?Aa:ka,La=xa,Ma=Vt,Ua=TypeError,Pa=mt,Fa=function(e){if(La(e))return e;throw Ua(Ma(e)+" is not a constructor");},qa=le,Ha=at("species"),ja=Y,Va=Function.prototype,Ga=Va.apply,za=Va.call,Ba="object"==typeof Reflect&&Reflect.apply||(ja?za.bind(Ga):function(){return za.apply(Ga,arguments);}),Ka=ie,Qa=ee,Wa=function(e){if("Function"===Ka(e))return Qa(e);},Ya=Kt,Za=Y,Xa=Wa(Wa.bind),Ja=function(e,t){return Ya(e),void 0===t?e:Za?Xa(e,t):function(){return e.apply(t,arguments);};},$a=ee([].slice),eu=TypeError,tu=/(?:ipad|iphone|ipod).*applewebkit/i.test(He),nu=me,ru=Ba,iu=Ja,su=dt,ou=Le,au=W,uu=or,cu=$a,lu=Ct,du=function(e,t){if(e<t)throw eu("Not enough arguments");return e;},hu=tu,fu=ia,pu=nu.setImmediate,vu=nu.clearImmediate,_u=nu.process,yu=nu.Dispatch,mu=nu.Function,gu=nu.MessageChannel,Eu=nu.String,bu=0,wu={},Iu="onreadystatechange";au(function(){Na=nu.location;});var Tu=function(e){if(ou(wu,e)){var t=wu[e];delete wu[e],t();}},Su=function(e){return function(){Tu(e);};},Cu=function(e){Tu(e.data);},ku=function(e){nu.postMessage(Eu(e),Na.protocol+"//"+Na.host);};pu&&vu||(pu=function(e){du(arguments.length,1);var t=su(e)?e:mu(e),n=cu(arguments,1);return wu[++bu]=function(){ru(t,void 0,n);},Oa(bu),bu;},vu=function(e){delete wu[e];},fu?Oa=function(e){_u.nextTick(Su(e));}:yu&&yu.now?Oa=function(e){yu.now(Su(e));}:gu&&!hu?(Da=(Ra=new gu()).port2,Ra.port1.onmessage=Cu,Oa=iu(Da.postMessage,Da)):nu.addEventListener&&su(nu.postMessage)&&!nu.importScripts&&Na&&"file:"!==Na.protocol&&!au(ku)?(Oa=ku,nu.addEventListener("message",Cu,!1)):Oa=Iu in lu("script")?function(e){uu.appendChild(lu("script"))[Iu]=function(){uu.removeChild(this),Tu(e);};}:function(e){setTimeout(Su(e),0);});var Au={set:pu,clear:vu},Nu=function(){this.head=null,this.tail=null;};Nu.prototype={add:function(e){var t={item:e,next:null},n=this.tail;n?n.next=t:this.head=t,this.tail=t;},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item;}};var Ou,Ru,Du,xu,Lu,Mu=Nu,Uu=/ipad|iphone|ipod/i.test(He)&&"undefined"!=typeof Pebble,Pu=/web0s(?!.*chrome)/i.test(He),Fu=me,qu=Ja,Hu=ni.f,ju=Au.set,Vu=Mu,Gu=tu,zu=Uu,Bu=Pu,Ku=ia,Qu=Fu.MutationObserver||Fu.WebKitMutationObserver,Wu=Fu.document,Yu=Fu.process,Zu=Fu.Promise,Xu=Hu(Fu,"queueMicrotask"),Ju=Xu&&Xu.value;if(!Ju){var $u=new Vu(),ec=function(){var e,t;for(Ku&&(e=Yu.domain)&&e.exit();t=$u.get();)try{t();}catch(e){throw $u.head&&Ou(),e;}e&&e.enter();};Gu||Ku||Bu||!Qu||!Wu?!zu&&Zu&&Zu.resolve?((xu=Zu.resolve(void 0)).constructor=Zu,Lu=qu(xu.then,xu),Ou=function(){Lu(ec);}):Ku?Ou=function(){Yu.nextTick(ec);}:(ju=qu(ju,Fu),Ou=function(){ju(ec);}):(Ru=!0,Du=Wu.createTextNode(""),new Qu(ec).observe(Du,{characterData:!0}),Ou=function(){Du.data=Ru=!Ru;}),Ju=function(e){$u.head||Ou(),$u.add(e);};}var tc=Ju,nc=function(e){try{return {error:!1,value:e()};}catch(e){return {error:!0,value:e};}},rc=me.Promise,ic="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,sc=!ic&&!ia&&"object"==typeof window&&"object"==typeof document,oc=me,ac=rc,uc=dt,cc=Es,lc=Ci,dc=at,hc=sc,fc=ic,pc=Qe;ac&&ac.prototype;var vc=dc("species"),_c=!1,yc=uc(oc.PromiseRejectionEvent),mc=cc("Promise",function(){var e=lc(ac),t=e!==String(ac);if(!t&&66===pc)return !0;if(!pc||pc<51||!/native code/.test(e)){var n=new ac(function(e){e(1);}),r=function(e){e(function(){},function(){});};if((n.constructor={})[vc]=r,!(_c=n.then(function(){})instanceof r))return !0;}return !t&&(hc||fc)&&!yc;}),gc={CONSTRUCTOR:mc,REJECTION_EVENT:yc,SUBCLASSING:_c},Ec={},bc=Kt,wc=TypeError,Ic=function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw wc("Bad Promise constructor");t=e,n=r;}),this.resolve=bc(t),this.reject=bc(n);};Ec.f=function(e){return new Ic(e);};var Tc,Sc,Cc,kc=As,Ac=ia,Nc=me,Oc=Rt,Rc=Wi,Dc=ho,xc=Zs,Lc=ha,Mc=Kt,Uc=dt,Pc=pt,Fc=va,qc=function(e,t){var n,r=Pa(e).constructor;return void 0===r||qa(n=Pa(r)[Ha])?t:Fa(n);},Hc=Au.set,jc=tc,Vc=function(e,t){try{1==arguments.length?console.error(e):console.error(e,t);}catch(e){}},Gc=nc,zc=Mu,Bc=ti,Kc=rc,Qc=Ec,Wc="Promise",Yc=gc.CONSTRUCTOR,Zc=gc.REJECTION_EVENT,Xc=gc.SUBCLASSING,Jc=Bc.getterFor(Wc),$c=Bc.set,el=Kc&&Kc.prototype,tl=Kc,nl=el,rl=Nc.TypeError,il=Nc.document,sl=Nc.process,ol=Qc.f,al=ol,ul=!!(il&&il.createEvent&&Nc.dispatchEvent),cl="unhandledrejection",ll=function(e){var t;return !(!Pc(e)||!Uc(t=e.then))&&t;},dl=function(e,t){var n,r,i,s=t.value,o=1==t.state,a=o?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{a?(o||(2===t.rejection&&_l(t),t.rejection=1),!0===a?n=s:(l&&l.enter(),n=a(s),l&&(l.exit(),i=!0)),n===e.promise?c(rl("Promise-chain cycle")):(r=ll(n))?Oc(r,n,u,c):u(n)):c(s);}catch(e){l&&!i&&l.exit(),c(e);}},hl=function(e,t){e.notified||(e.notified=!0,jc(function(){for(var n,r=e.reactions;n=r.get();)dl(n,e);e.notified=!1,t&&!e.rejection&&pl(e);}));},fl=function(e,t,n){var r,i;ul?((r=il.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),Nc.dispatchEvent(r)):r={promise:t,reason:n},!Zc&&(i=Nc["on"+e])?i(r):e===cl&&Vc("Unhandled promise rejection",n);},pl=function(e){Oc(Hc,Nc,function(){var t,n=e.facade,r=e.value;if(vl(e)&&(t=Gc(function(){Ac?sl.emit("unhandledRejection",r,n):fl(cl,n,r);}),e.rejection=Ac||vl(e)?2:1,t.error))throw t.value;});},vl=function(e){return 1!==e.rejection&&!e.parent;},_l=function(e){Oc(Hc,Nc,function(){var t=e.facade;Ac?sl.emit("rejectionHandled",t):fl("rejectionhandled",t,e.value);});},yl=function(e,t,n){return function(r){e(t,r,n);};},ml=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,hl(e,!0));},gl=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw rl("Promise can't be resolved itself");var r=ll(t);r?jc(function(){var n={done:!1};try{Oc(r,t,yl(gl,n,e),yl(ml,n,e));}catch(t){ml(n,t,e);}}):(e.value=t,e.state=1,hl(e,!1));}catch(t){ml({done:!1},t,e);}}};if(Yc&&(nl=(tl=function(e){Fc(this,nl),Mc(e),Oc(Tc,this);var t=Jc(this);try{e(yl(gl,t),yl(ml,t));}catch(e){ml(t,e);}}).prototype,(Tc=function(e){$c(this,{type:Wc,done:!1,notified:!1,parent:!1,reactions:new zc(),rejection:!1,state:0,value:void 0});}).prototype=Rc(nl,"then",function(e,t){var n=Jc(this),r=ol(qc(this,tl));return n.parent=!0,r.ok=!Uc(e)||e,r.fail=Uc(t)&&t,r.domain=Ac?sl.domain:void 0,0==n.state?n.reactions.add(r):jc(function(){dl(r,n);}),r.promise;}),Sc=function(){var e=new Tc(),t=Jc(e);this.promise=e,this.resolve=yl(gl,t),this.reject=yl(ml,t);},Qc.f=ol=function(e){return e===tl||undefined===e?new Sc(e):al(e);},Uc(Kc)&&el!==Object.prototype)){Cc=el.then,Xc||Rc(el,"then",function(e,t){var n=this;return new tl(function(e,t){Oc(Cc,n,e,t);}).then(e,t);},{unsafe:!0});try{delete el.constructor;}catch(e){}Dc&&Dc(el,nl);}kc({global:!0,constructor:!0,wrap:!0,forced:Yc},{Promise:tl}),xc(tl,Wc,!1),Lc(Wc);var El=Lr,bl=at("iterator"),wl=Array.prototype,Il=ta,Tl=Yt,Sl=le,Cl=Lr,kl=at("iterator"),Al=function(e){if(!Sl(e))return Tl(e,kl)||Tl(e,"@@iterator")||Cl[Il(e)];},Nl=Rt,Ol=Kt,Rl=mt,Dl=Vt,xl=Al,Ll=TypeError,Ml=Rt,Ul=mt,Pl=Yt,Fl=Ja,ql=Rt,Hl=mt,jl=Vt,Vl=function(e){return void 0!==e&&(El.Array===e||wl[bl]===e);},Gl=Un,zl=Mt,Bl=function(e,t){var n=arguments.length<2?xl(e):t;if(Ol(n))return Rl(Nl(n,e));throw Ll(Dl(e)+" is not iterable");},Kl=Al,Ql=function(e,t,n){var r,i;Ul(e);try{if(!(r=Pl(e,"return"))){if("throw"===t)throw n;return n;}r=Ml(r,e);}catch(e){i=!0,r=e;}if("throw"===t)throw n;if(i)throw r;return Ul(r),n;},Wl=TypeError,Yl=function(e,t){this.stopped=e,this.result=t;},Zl=Yl.prototype,Xl=function(e,t,n){var r,i,s,o,a,u,c,l=n&&n.that,d=!(!n||!n.AS_ENTRIES),h=!(!n||!n.IS_RECORD),f=!(!n||!n.IS_ITERATOR),p=!(!n||!n.INTERRUPTED),v=Fl(t,l),_=function(e){return r&&Ql(r,"normal",e),new Yl(!0,e);},y=function(e){return d?(Hl(e),p?v(e[0],e[1],_):v(e[0],e[1])):p?v(e,_):v(e);};if(h)r=e.iterator;else if(f)r=e;else {if(!(i=Kl(e)))throw Wl(jl(e)+" is not iterable");if(Vl(i)){for(s=0,o=Gl(e);o>s;s++)if((a=y(e[s]))&&zl(Zl,a))return a;return new Yl(!1);}r=Bl(e,i);}for(u=h?e.next:r.next;!(c=ql(u,r)).done;){try{a=y(c.value);}catch(e){Ql(r,"throw",e);}if("object"==typeof a&&a&&zl(Zl,a))return a;}return new Yl(!1);},Jl=at("iterator"),$l=!1;try{var ed=0,td={next:function(){return {done:!!ed++};},return:function(){$l=!0;}};td[Jl]=function(){return this;},Array.from(td,function(){throw 2;});}catch(e){}var nd=function(e,t){if(!t&&!$l)return !1;var n=!1;try{var r={};r[Jl]=function(){return {next:function(){return {done:n=!0};}};},e(r);}catch(e){}return n;},rd=rc,id=gc.CONSTRUCTOR||!nd(function(e){rd.all(e).then(void 0,function(){});}),sd=Rt,od=Kt,ad=Ec,ud=nc,cd=Xl;As({target:"Promise",stat:!0,forced:id},{all:function(e){var t=this,n=ad.f(t),r=n.resolve,i=n.reject,s=ud(function(){var n=od(t.resolve),s=[],o=0,a=1;cd(e,function(e){var u=o++,c=!1;a++,sd(n,t,e).then(function(e){c||(c=!0,s[u]=e,--a||r(s));},i);}),--a||r(s);});return s.error&&i(s.value),n.promise;}});var ld=As,dd=gc.CONSTRUCTOR,hd=rc,fd=Lt,pd=dt,vd=Wi,_d=hd&&hd.prototype;if(ld({target:"Promise",proto:!0,forced:dd,real:!0},{catch:function(e){return this.then(void 0,e);}}),pd(hd)){var yd=fd("Promise").prototype.catch;_d.catch!==yd&&vd(_d,"catch",yd,{unsafe:!0});}var md=Rt,gd=Kt,Ed=Ec,bd=nc,wd=Xl;As({target:"Promise",stat:!0,forced:id},{race:function(e){var t=this,n=Ed.f(t),r=n.reject,i=bd(function(){var i=gd(t.resolve);wd(e,function(e){md(i,t,e).then(n.resolve,r);});});return i.error&&r(i.value),n.promise;}});var Id=Rt,Td=Ec;As({target:"Promise",stat:!0,forced:gc.CONSTRUCTOR},{reject:function(e){var t=Td.f(this);return Id(t.reject,void 0,e),t.promise;}});var Sd=mt,Cd=pt,kd=Ec,Ad=As,Nd=gc.CONSTRUCTOR,Od=function(e,t){if(Sd(e),Cd(t)&&t.constructor===e)return t;var n=kd.f(e);return (0, n.resolve)(t),n.promise;};Lt("Promise"),Ad({target:"Promise",stat:!0,forced:Nd},{resolve:function(e){return Od(this,e);}});var Rd=ta,Dd=String,xd=function(e){if("Symbol"===Rd(e))throw TypeError("Cannot convert a Symbol value to a string");return Dd(e);},Ld=ee,Md=kn,Ud=xd,Pd=fe,Fd=Ld("".charAt),qd=Ld("".charCodeAt),Hd=Ld("".slice),jd=function(e){return function(t,n){var r,i,s=Ud(Pd(t)),o=Md(n),a=s.length;return o<0||o>=a?e?"":void 0:(r=qd(s,o))<55296||r>56319||o+1===a||(i=qd(s,o+1))<56320||i>57343?e?Fd(s,o):r:e?Hd(s,o,o+2):i-56320+(r-55296<<10)+65536;};},Vd={codeAt:jd(!1),charAt:jd(!0)},Gd=Vd.charAt,zd=xd,Bd=ti,Kd=Do,Qd=xo,Wd="String Iterator",Yd=Bd.set,Zd=Bd.getterFor(Wd);Kd(String,"String",function(e){Yd(this,{type:Wd,string:zd(e),index:0});},function(){var e,t=Zd(this),n=t.string,r=t.index;return r>=n.length?Qd(void 0,!0):(e=Gd(n,r),t.index+=e.length,Qd(e,!1));});var Xd={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Jd=Ct("span").classList,$d=Jd&&Jd.constructor&&Jd.constructor.prototype,eh=$d===Object.prototype?void 0:$d,th=me,nh=Xd,rh=eh,ih=Bo,sh=jr,oh=at,ah=oh("iterator"),uh=oh("toStringTag"),ch=ih.values,lh=function(e,t){if(e){if(e[ah]!==ch)try{sh(e,ah,ch);}catch(t){e[ah]=ch;}if(e[uh]||sh(e,uh,t),nh[t])for(var n in ih)if(e[n]!==ih[n])try{sh(e,n,ih[n]);}catch(t){e[n]=ih[n];}}};for(var dh in nh)lh(th[dh]&&th[dh].prototype,dh);lh(rh,"DOMTokenList");var hh=ie,fh=Array.isArray||function(e){return "Array"==hh(e);},ph=fh,vh=xa,_h=pt,yh=at("species"),mh=Array,gh=function(e){var t;return ph(e)&&(t=e.constructor,(vh(t)&&(t===mh||ph(t.prototype))||_h(t)&&null===(t=t[yh]))&&(t=void 0)),void 0===t?mh:t;},Eh=function(e,t){return new(gh(e))(0===t?0:t);},bh=Ja,wh=ce,Ih=Re,Th=Un,Sh=Eh,Ch=ee([].push),kh=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,s=6==e,o=7==e,a=5==e||s;return function(u,c,l,d){for(var h,f,p=Ih(u),v=wh(p),_=bh(c,l),y=Th(v),m=0,g=d||Sh,E=t?g(u,y):n||o?g(u,0):void 0;y>m;m++)if((a||m in v)&&(f=_(h=v[m],m,p),e))if(t)E[m]=f;else if(f)switch(e){case 3:return !0;case 5:return h;case 6:return m;case 2:Ch(E,h);}else switch(e){case 4:return !1;case 7:Ch(E,h);}return s?-1:r||i?i:E;};},Ah={forEach:kh(0),map:kh(1),filter:kh(2),some:kh(3),every:kh(4),find:kh(5),findIndex:kh(6),filterReject:kh(7)},Nh=W,Oh=Qe,Rh=at("species"),Dh=function(e){return Oh>=51||!Nh(function(){var t=[];return (t.constructor={})[Rh]=function(){return {foo:1};},1!==t[e](Boolean).foo;});},xh=Ah.map;As({target:"Array",proto:!0,forced:!Dh("map")},{map:function(e){return xh(this,e,arguments.length>1?arguments[1]:void 0);}});var Lh=l(function e(){u(this,e);}),Mh=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.call(this);}return l(n,[{key:"getApiOption",value:function(){return {auth:this.getAuth(),path:this.getPath(),method:this.getMethod(),body:this.getData(),headers:this.getHeaders()};}},{key:"getAuth",value:function(){return !0;}},{key:"getHeaders",value:function(){return {};}}]),n;}(Lh),Uh=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.call(this);}return l(n,[{key:"getPath",value:function(){return "/v1".concat(this.getSubPath());}}]),n;}(Mh),Ph=function(e){return e.CREATE="create",e.UPDATE="update",e.GET="get",e.DELETE="delete",e.QUERY="query",e.READY="ready",e.START="start",e.ENTER_HOST="enter_host",e.GET_HOSTS="get_hosts",e.EXIT_HOST="exit_host",e.HOST_ALIVE="host_alive",e.AUDIO="audio",e.VIDEO="video",e.HOST_CREATE_STREAM="host_create_stream",e.HOST_PUT_STREAM="host_put_stream",e.HOST_DELETE_STREAM="host_delete_stream",e.HOST_CONNECTED="host_connected",e.ENTER="enter",e.EXIT="exit",e.ALIVE="alive",e.GET_PARTICIPANTS="get_participants",e.CREATE_STREAM="create_stream",e.PUT_STREAM="put_stream",e.DELETE_STREAM="delete_stream",e.CREATE_RTMP_STREAM="create_rtmp_stream",e.DELETE_RTMP_STREAM="delete_rtmp_stream",e.CONNECTED="connected",e.ATTACH="attach",e.CUSTOM_ITEMS_GET="custom_items_get",e.CUSTOM_ITEMS_UPDATE="custom_items_update",e.CUSTOM_ITEMS_DELETE="custom_items_delete",e.LIVE_EVENT_READY="live_event_ready",e.LIVE_EVENT_STARTED="live_event_started",e.LIVE_EVENT_ENDED="live_event_ended",e.LIVE_EVENT_UPDATED="live_event_updated",e.HOST_ENTERED="host_entered",e.HOST_EXITED="host_exited",e.HOST_DISCONNECTED="host_disconnected",e.HOST_AUDIO_STATUS_CHANGED="host_audio_status_changed",e.HOST_VIDEO_STATUS_CHANGED="host_video_status_changed",e.PARTICIPANT_COUNT_CHANGED="participant_count_changed",e.CUSTOM_ITEMS_UPDATED="custom_items_updated",e.CUSTOM_ITEMS_DELETED="custom_items_deleted",e;}({}),Fh=function(e){return e.SINGLE_HOST="single_host",e.MULTIPLE_HOST="multiple_host",e.SINGLE_HOST_AUDIO_ONLY="single_host_audio_only",e;}({}),qh=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n);}(function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),(r=t.call(this)).payload=r.parseData(e),r;}return l(n);}(Lh));function Hh(e){return {liveEventId:e.live_event_id,hostType:e.host_type,createdAt:e.created_at,setReadyAt:e.set_ready_at,startedAt:e.started_at,endedAt:e.ended_at,state:e.state,isHostStreaming:e.is_host_streaming,createdBy:e.created_by,setReadyBy:e.set_ready_by,startedBy:e.started_by,endedBy:e.ended_by,duration:e.duration,host:e.host?jh(e.host):void 0,participantCount:e.participant_count,peakParticipantCount:e.peak_participant_count,cumulativeParticipantCount:e.cumulative_participant_count,userIdsForHost:e.user_ids_for_host,customItems:e.custom_items,title:e.title,coverUrl:e.cover_url};}function jh(e){return {hostId:e.host_id,userId:e.user.user_id,nickname:e.user.nickname,profileURL:e.user.profile_url,enteredAt:e.entered_at,connectedAt:e.connected_at,disconnectedAt:e.disconnected_at,exitedAt:e.exited_at,duration:e.duration,state:e.state,isAudioOn:e.is_audio_on,isVideoOn:e.is_video_on,liveEventId:e.live_event_id,streamType:e.stream_type,rtmpStream:e.rtmp_stream?Vh(e.rtmp_stream):void 0};}function Vh(e){return {rtmpStreamId:e.rtmp_stream_id,rtmpHostUrl:e.rtmp_host_url,streamKey:e.stream_key,createdAt:e.created_at};}function Gh(e){return {id:e.rtcstream_id};}function zh(e){return {participantId:e.participant_id,userId:e.user.user_id,nickname:e.user.nickname,profileURL:e.user.profile_url,enteredAt:e.entered_at,exitedAt:e.exited_at,duration:e.duration,state:e.state,liveEventId:e.live_event_id};}var Bh=Ah.filter;As({target:"Array",proto:!0,forced:!Dh("filter")},{filter:function(e){return Bh(this,e,arguments.length>1?arguments[1]:void 0);}});var Kh=Re,Qh=Jn;As({target:"Object",stat:!0,forced:W(function(){Qh(1);})},{keys:function(e){return Qh(Kh(e));}});var Wh=TypeError,Yh=function(e){if(e>9007199254740991)throw Wh("Maximum allowed index exceeded");return e;},Zh=dn,Xh=wt,Jh=Fr,$h=function(e,t,n){var r=Zh(t);r in e?Xh.f(e,r,Jh(0,n)):e[r]=n;},ef=As,tf=W,nf=fh,rf=pt,sf=Re,of=Un,af=Yh,uf=$h,cf=Eh,lf=Dh,df=Qe,hf=at("isConcatSpreadable"),ff=df>=51||!tf(function(){var e=[];return e[hf]=!1,e.concat()[0]!==e;}),pf=function(e){if(!rf(e))return !1;var t=e[hf];return void 0!==t?!!t:nf(e);};ef({target:"Array",proto:!0,arity:1,forced:!ff||!lf("concat")},{concat:function(e){var t,n,r,i,s,o=sf(this),a=cf(o,0),u=0;for(t=-1,r=arguments.length;t<r;t++)if(pf(s=-1===t?o:arguments[t]))for(i=of(s),af(u+i),n=0;n<i;n++,u++)n in s&&uf(a,u,s[n]);else af(u+1),uf(a,u++,s);return a.length=u,a;}});var vf=mt,_f=function(){var e=vf(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t;},yf=Rt,mf=Le,gf=Mt,Ef=_f,bf=RegExp.prototype,wf=wi.PROPER,If=Wi,Tf=mt,Sf=xd,Cf=W,kf=function(e){var t=e.flags;return void 0!==t||"flags"in bf||mf(e,"flags")||!gf(bf,e)?t:yf(Ef,e);},Af="toString",Nf=RegExp.prototype[Af],Of=Cf(function(){return "/a/b"!=Nf.call({source:"a",flags:"b"});}),Rf=wf&&Nf.name!=Af;function Df(e){return Object.keys(e).filter(function(t){return null!=e[t];}).map(function(t){return "".concat(encodeURIComponent(t),"=").concat(function(e){if(Array.isArray(e))return e.map(function(e){return encodeURIComponent(e.toString());}).join(",");return encodeURIComponent(e.toString());}(e[t]));}).join("&");}(Of||Rf)&&If(RegExp.prototype,Af,function(){var e=Tf(this);return "/"+Sf(e.source)+"/"+Sf(kf(e));},{unsafe:!0});var xf=function(e){h(n,e);var t=E(n);function n(e,r,i){var s;return u(this,n),d(g(s=t.call(this)),"type",Ph.QUERY),s.params=s._normalizeParams(e),s.prevToken=r,s.nextToken=i,s;}return l(n,[{key:"getData",value:function(){}},{key:"getSubPath",value:function(){return "/live-events?".concat(this._createQuery());}},{key:"getMethod",value:function(){return "GET";}},{key:"_normalizeParams",value:function(e){var t=e.hostTypes,n=e.liveEventState,r=e.createdAtRange,i=e.participantCountRange,s=e.durationRange,o=e.liveEventIds,a=e.createdByUserIds,u=e.limit;return {hostTypes:null!=t?t:[],liveEventState:n,createdAtRange:r,participantCountRange:i,durationRange:s,liveEventIds:o,createdByUserIds:a,limit:null!=u?Math.min(Math.max(1,u),100):void 0};}},{key:"_createQuery",value:function(){var e,t,n,r,i,s;return Df({host_types:Array.isArray(this.params.hostTypes)?this.params.hostTypes:[this.params.hostTypes],state:this.params.liveEventState,created_at_start_date:null===(e=this.params.createdAtRange)||void 0===e?void 0:e[0],created_at_end_date:null===(t=this.params.createdAtRange)||void 0===t?void 0:t[0],participant_count_gte:null===(n=this.params.participantCountRange)||void 0===n?void 0:n[0],participant_count_lte:null===(r=this.params.participantCountRange)||void 0===r?void 0:r[1],duration_range_gte:null===(i=this.params.durationRange)||void 0===i?void 0:i[0],duration_range_lte:null===(s=this.params.durationRange)||void 0===s?void 0:s[1],live_event_ids:this.params.liveEventIds,created_by_user_ids:this.params.createdByUserIds,limit:this.params.limit,prev:this.prevToken,next:this.nextToken});}}]),n;}(Uh),Lf=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){var t;return {liveEvents:null===(t=e.live_events)||void 0===t?void 0:t.map(Hh),prev:e.prev,next:e.next};}}]),n;}(qh),Mf=W,Uf=function(e,t){var n=[][e];return !!n&&Mf(function(){n.call(null,t||function(){return 1;},1);});},Pf=As,Ff=jn.indexOf,qf=Uf,Hf=Wa([].indexOf),jf=!!Hf&&1/Hf([1],1,-0)<0;Pf({target:"Array",proto:!0,forced:jf||!qf("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return jf?Hf(this,e,t)||0:Ff(this,e,t);}});var Vf=Et,Gf=fh,zf=TypeError,Bf=Object.getOwnPropertyDescriptor,Kf=Vf&&!function(){if(void 0!==this)return !0;try{Object.defineProperty([],"length",{writable:!1}).length=1;}catch(e){return e instanceof TypeError;}}()?function(e,t){if(Gf(e)&&!Bf(e,"length").writable)throw zf("Cannot set read only .length");return e.length=t;}:function(e,t){return e.length=t;},Qf=Vt,Wf=TypeError,Yf=As,Zf=Re,Xf=Rn,Jf=kn,$f=Un,ep=Kf,tp=Yh,np=Eh,rp=$h,ip=function(e,t){if(!delete e[t])throw Wf("Cannot delete property "+Qf(t)+" of "+Qf(e));},sp=Dh("splice"),op=Math.max,ap=Math.min;Yf({target:"Array",proto:!0,forced:!sp},{splice:function(e,t){var n,r,i,s,o,a,u=Zf(this),c=$f(u),l=Xf(e,c),d=arguments.length;for(0===d?n=r=0:1===d?(n=0,r=c-l):(n=d-2,r=ap(op(Jf(t),0),c-l)),tp(c+n-r),i=np(u,r),s=0;s<r;s++)(o=l+s)in u&&rp(i,s,u[o]);if(i.length=r,n<r){for(s=l;s<c-r;s++)a=s+n,(o=s+r)in u?u[a]=u[o]:ip(u,a);for(s=c;s>c-r+n;s--)ip(u,s-1);}else if(n>r)for(s=c-r;s>l;s--)a=s+n-1,(o=s+r-1)in u?u[a]=u[o]:ip(u,a);for(s=0;s<n;s++)u[s+l]=arguments[s+2];return ep(u,c-r+n),i;}});var up=function(e){return e.VERBOSE="VERBOSE",e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR",e.NONE="NONE",e;}({}),cp=function(){function e(){u(this,e),this._listeners=[];}return l(e,[{key:"verbose",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,[up.VERBOSE].concat(t));}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,[up.DEBUG].concat(t));}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,[up.INFO].concat(t));}},{key:"warning",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,[up.WARNING].concat(t));}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,[up.ERROR].concat(t));}},{key:"_log",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s=T(this._listeners);try{for(s.s();!(i=s.n()).done;){var o=i.value;o._permit.apply(o,[e].concat(n));}}catch(e){s.e(e);}finally{s.f();}}},{key:"addListener",value:function(e){this._listeners.push(e);}},{key:"removeListener",value:function(e){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1);}},{key:"removeAllListener",value:function(){this._listeners=[];}}]),e;}(),lp=new cp(),dp=function(){function e(t,n,r){u(this,e),this.isLoading=!1,this.params=t,this.sender=n,this.prevToken=null,this.nextToken=null,this.liveEventManager=r;}var t,n,r;return l(e,[{key:"hasPrev",get:function(){return !!this.prevToken;}},{key:"hasNext",get:function(){return !this.prevToken&&!this.nextToken||!!this.nextToken;}},{key:"next",value:(r=a(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isLoading){e.next=2;break;}throw new Error("query is in progress");case 2:if(this.hasNext){e.next=4;break;}return e.abrupt("return",[]);case 4:return e.abrupt("return",this._sendQueryCommand(null,this.nextToken));case 5:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"prev",value:(n=a(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isLoading){e.next=2;break;}throw new Error("query is in progress");case 2:if(this.hasPrev){e.next=4;break;}return e.abrupt("return",[]);case 4:return e.abrupt("return",this._sendQueryCommand(this.prevToken,null));case 5:case"end":return e.stop();}},e,this);})),function(){return n.apply(this,arguments);})},{key:"_sendQueryCommand",value:(t=a(i().mark(function e(t,n){var r,s,o,a=this;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!n){e.next=2;break;}throw new Error("internal error while creating LiveEventListQueryCommand");case 2:return this.isLoading=!0,r=new xf(this.params,t,n),e.next=6,this.sender.send(r);case 6:return s=e.sent,o=s.payload,this.prevToken=o.prev,this.nextToken=o.next,this.isLoading=!1,e.prev=11,e.abrupt("return",Promise.all(o.liveEvents.map(function(e){return a.liveEventManager.deserializeLiveEvent(e);})));case 15:return e.prev=15,e.t0=e.catch(11),lp.error(e.t0),e.abrupt("return",o.liveEvents);case 19:case"end":return e.stop();}},e,this,[[11,15]]);})),function(e,n){return t.apply(this,arguments);})}]),e;}(),hp=As,fp=Ah.find,pp=xr,vp="find",_p=!0;vp in[]&&Array(1)[vp](function(){_p=!1;}),hp({target:"Array",proto:!0,forced:_p},{find:function(e){return fp(this,e,arguments.length>1?arguments[1]:void 0);}}),pp(vp);var yp=As,mp=Ah.findIndex,gp=xr,Ep="findIndex",bp=!0;Ep in[]&&Array(1)[Ep](function(){bp=!1;}),yp({target:"Array",proto:!0,forced:bp},{findIndex:function(e){return mp(this,e,arguments.length>1?arguments[1]:void 0);}}),gp(Ep);var wp={exports:{}},Ip={},Tp=Rn,Sp=Un,Cp=$h,kp=Array,Ap=Math.max,Np=ie,Op=_e,Rp=Yi.f,Dp=function(e,t,n){for(var r=Sp(e),i=Tp(t,r),s=Tp(void 0===n?r:n,r),o=kp(Ap(s-i,0)),a=0;i<s;i++,a++)Cp(o,a,e[i]);return o.length=a,o;},xp="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Ip.f=function(e){return xp&&"Window"==Np(e)?function(e){try{return Rp(e);}catch(e){return Dp(xp);}}(e):Rp(Op(e));};var Lp=W(function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8});}}),Mp=W,Up=pt,Pp=ie,Fp=Lp,qp=Object.isExtensible,Hp=Mp(function(){qp(1);})||Fp?function(e){return !!Up(e)&&(!Fp||"ArrayBuffer"!=Pp(e))&&(!qp||qp(e));}:qp,jp=!W(function(){return Object.isExtensible(Object.preventExtensions({}));}),Vp=As,Gp=ee,zp=Vn,Bp=pt,Kp=Le,Qp=wt.f,Wp=Yi,Yp=Ip,Zp=Hp,Xp=jp,Jp=!1,$p=qe("meta"),ev=0,tv=function(e){Qp(e,$p,{value:{objectID:"O"+ev++,weakData:{}}});},nv=wp.exports={enable:function(){nv.enable=function(){},Jp=!0;var e=Wp.f,t=Gp([].splice),n={};n[$p]=1,e(n).length&&(Wp.f=function(n){for(var r=e(n),i=0,s=r.length;i<s;i++)if(r[i]===$p){t(r,i,1);break;}return r;},Vp({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Yp.f}));},fastKey:function(e,t){if(!Bp(e))return "symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!Kp(e,$p)){if(!Zp(e))return "F";if(!t)return "E";tv(e);}return e[$p].objectID;},getWeakData:function(e,t){if(!Kp(e,$p)){if(!Zp(e))return !0;if(!t)return !1;tv(e);}return e[$p].weakData;},onFreeze:function(e){return Xp&&Jp&&Zp(e)&&!Kp(e,$p)&&tv(e),e;}};zp[$p]=!0;var rv=dt,iv=pt,sv=ho,ov=function(e,t,n){var r,i;return sv&&rv(r=t.constructor)&&r!==n&&iv(i=r.prototype)&&i!==n.prototype&&sv(e,i),e;},av=As,uv=me,cv=ee,lv=Es,dv=Wi,hv=wp.exports,fv=Xl,pv=va,vv=dt,_v=le,yv=pt,mv=W,gv=nd,Ev=Zs,bv=ov,wv=Wi,Iv=Tr,Tv=aa,Sv=function(e,t,n){for(var r in t)wv(e,r,t[r],n);return e;},Cv=Ja,kv=va,Av=le,Nv=Xl,Ov=Do,Rv=xo,Dv=ha,xv=Et,Lv=wp.exports.fastKey,Mv=ti.set,Uv=ti.getterFor,Pv={getConstructor:function(e,t,n,r){var i=e(function(e,i){kv(e,s),Mv(e,{type:t,index:Iv(null),first:void 0,last:void 0,size:0}),xv||(e.size=0),Av(i)||Nv(i,e[r],{that:e,AS_ENTRIES:n});}),s=i.prototype,o=Uv(t),a=function(e,t,n){var r,i,s=o(e),a=u(e,t);return a?a.value=n:(s.last=a={index:i=Lv(t,!0),key:t,value:n,previous:r=s.last,next:void 0,removed:!1},s.first||(s.first=a),r&&(r.next=a),xv?s.size++:e.size++,"F"!==i&&(s.index[i]=a)),e;},u=function(e,t){var n,r=o(e),i=Lv(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n;};return Sv(s,{clear:function(){for(var e=o(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,xv?e.size=0:this.size=0;},delete:function(e){var t=this,n=o(t),r=u(t,e);if(r){var i=r.next,s=r.previous;delete n.index[r.index],r.removed=!0,s&&(s.next=i),i&&(i.previous=s),n.first==r&&(n.first=i),n.last==r&&(n.last=s),xv?n.size--:t.size--;}return !!r;},forEach:function(e){for(var t,n=o(this),r=Cv(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous;},has:function(e){return !!u(this,e);}}),Sv(s,n?{get:function(e){var t=u(this,e);return t&&t.value;},set:function(e,t){return a(this,0===e?0:e,t);}}:{add:function(e){return a(this,e=0===e?0:e,e);}}),xv&&Tv(s,"size",{configurable:!0,get:function(){return o(this).size;}}),i;},setStrong:function(e,t,n){var r=t+" Iterator",i=Uv(t),s=Uv(r);Ov(e,t,function(e,t){Mv(this,{type:r,target:e,state:i(e),kind:t,last:void 0});},function(){for(var e=s(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?Rv("keys"==t?n.key:"values"==t?n.value:[n.key,n.value],!1):(e.target=void 0,Rv(void 0,!0));},n?"entries":"values",!n,!0),Dv(t);}};(function(e,t,n){var r=-1!==e.indexOf("Map"),i=-1!==e.indexOf("Weak"),s=r?"set":"add",o=uv[e],a=o&&o.prototype,u=o,c={},l=function(e){var t=cv(a[e]);dv(a,e,"add"==e?function(e){return t(this,0===e?0:e),this;}:"delete"==e?function(e){return !(i&&!yv(e))&&t(this,0===e?0:e);}:"get"==e?function(e){return i&&!yv(e)?void 0:t(this,0===e?0:e);}:"has"==e?function(e){return !(i&&!yv(e))&&t(this,0===e?0:e);}:function(e,n){return t(this,0===e?0:e,n),this;});};if(lv(e,!vv(o)||!(i||a.forEach&&!mv(function(){new o().entries().next();}))))u=n.getConstructor(t,e,r,s),hv.enable();else if(lv(e,!0)){var d=new u(),h=d[s](i?{}:-0,1)!=d,f=mv(function(){d.has(1);}),p=gv(function(e){new o(e);}),v=!i&&mv(function(){for(var e=new o(),t=5;t--;)e[s](t,t);return !e.has(-0);});p||((u=t(function(e,t){pv(e,a);var n=bv(new o(),e,u);return _v(t)||fv(t,n[s],{that:n,AS_ENTRIES:r}),n;})).prototype=a,a.constructor=u),(f||v)&&(l("delete"),l("has"),r&&l("get")),(v||h)&&l(s),i&&a.clear&&delete a.clear;}c[e]=u,av({global:!0,constructor:!0,forced:u!=o},c),Ev(u,e),i||n.setStrong(u,e,r);})("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0);};},Pv);var Fv=Et,qv=ee,Hv=Rt,jv=W,Vv=Jn,Gv=Ji,zv=ri,Bv=Re,Kv=ce,Qv=Object.assign,Wv=Object.defineProperty,Yv=qv([].concat),Zv=!Qv||jv(function(){if(Fv&&1!==Qv({b:1},Qv(Wv({},"a",{enumerable:!0,get:function(){Wv(this,"b",{value:3,enumerable:!1});}}),{b:2})).b)return !0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e;}),7!=Qv({},e)[n]||Vv(Qv({},t)).join("")!=r;})?function(e,t){for(var n=Bv(e),r=arguments.length,i=1,s=Gv.f,o=zv.f;r>i;)for(var a,u=Kv(arguments[i++]),c=s?Yv(Vv(u),s(u)):Vv(u),l=c.length,d=0;l>d;)a=c[d++],Fv&&!Hv(o,u,a)||(n[a]=u[a]);return n;}:Qv,Xv=Zv;As({target:"Object",stat:!0,arity:2,forced:Object.assign!==Xv},{assign:Xv});var Jv=jn.includes,$v=xr;As({target:"Array",proto:!0,forced:W(function(){return !Array(1).includes();})},{includes:function(e){return Jv(this,e,arguments.length>1?arguments[1]:void 0);}}),$v("includes");var e_=pt,t_=ie,n_=at("match"),r_=function(e){var t;return e_(e)&&(void 0!==(t=e[n_])?!!t:"RegExp"==t_(e));},i_=TypeError,s_=at("match"),o_=As,a_=function(e){if(r_(e))throw i_("The method doesn't accept regular expressions");return e;},u_=fe,c_=xd,l_=function(e){var t=/./;try{"/./"[e](t);}catch(n){try{return t[s_]=!1,"/./"[e](t);}catch(e){}}return !1;},d_=ee("".indexOf);o_({target:"String",proto:!0,forced:!l_("includes")},{includes:function(e){return !!~d_(c_(u_(this)),c_(a_(e)),arguments.length>1?arguments[1]:void 0);}});var h_=function(e){return e.HOST="host",e.PARTICIPANT="participant",e;}({}),f_=function(e){return e.CREATED="created",e.READY="ready",e.ONGOING="ongoing",e.PAUSED="paused",e.ENDED="ended",e;}({}),p_=function(e){return e.ENTERED="entered",e.CONNECTED="connected",e.DISCONNECTED="disconnected",e.EXITED="exited",e;}({}),v_=function(e){return e.ENTERED="entered",e.EXITED="exited",e;}({}),__=function(e){h(n,e);var t=E(n);function n(e,r,i){var s;return u(this,n),(s=t.call(this)).appId=e,s.userId=r,s.accessToken=i,s;}return l(n,[{key:"getAuth",value:function(){return !1;}},{key:"getData",value:function(){return {app_id:this.appId,user_id:this.userId,access_token:this.accessToken};}},{key:"getPath",value:function(){return "/v1/users/".concat(encodeURIComponent(this.userId),"/login");}},{key:"getMethod",value:function(){return "POST";}}]),n;}(Mh),y_=function(e){return e.POST="POST",e.GET="GET",e.DELETE="DELETE",e.OPTION="OPTION",e.PUT="PUT",e;}({}),m_=function(e){h(n,e);var t=E(n);function n(e,r,i,s,o,a){var c;return u(this,n),d(g(c=t.call(this)),"type",Ph.CREATE),c.hostType=e,c.hostIds=Array.isArray(r)?r:[r],c.title=null===i?"":i,c.coverUrl=null===s?"":s,c.coverFile=null===o?"":o,c.customItems=a,c;}return l(n,[{key:"getData",value:function(){var e=function(e,n,r,i){void 0!==r&&t.set(n,r);},t=new FormData();return e(0,"host_type",this.hostType),e(0,"user_ids_for_host",String(this.hostIds.map(function(e){return encodeURIComponent(e);}))),e(0,"title",this.title),e(0,"cover_url",this.coverUrl),e(0,"cover_file",this.coverFile),e(0,"customItems",JSON.stringify(this.customItems)),t;}},{key:"getSubPath",value:function(){return "/live-events";}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),g_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEvent:Hh(e.live_event)};}}]),n;}(qh),E_=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this)),"type",Ph.GET),r.liveEventId=e,r;}return l(n,[{key:"getData",value:function(){}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId);}},{key:"getMethod",value:function(){return y_.GET;}}]),n;}(Uh),b_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEvent:Hh(e.live_event)};}}]),n;}(qh),w_=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this)),"type",Ph.ENTER_HOST),d(g(i),"mediaOption",{turnAudioOn:!0,turnVideoOn:!0}),i.liveEventId=e,i.mediaOption=r,i;}return l(n,[{key:"getData",value:function(){return {is_audio_on:this.mediaOption.turnAudioOn,is_video_on:this.mediaOption.turnVideoOn};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/hosts");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),I_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {host:jh(e.host)};}}]),n;}(qh),T_=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this)),"type",Ph.READY),r.liveEventId=e,r;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/ready");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),S_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEvent:Hh(e.live_event)};}}]),n;}(qh),C_=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this)),"type",Ph.START),r.liveEventId=e,r;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/start");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),k_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEvent:Hh(e.live_event)};}}]),n;}(qh),A_=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this)),"type",Ph.EXIT_HOST),i.liveEventId=e,i.hostId=r,i;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/hosts/").concat(this.hostId);}},{key:"getMethod",value:function(){return y_.DELETE;}}]),n;}(Uh),N_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {host:jh(e.host)};}}]),n;}(qh),O_=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this)),"type",Ph.DELETE),r.liveEventId=e,r;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId);}},{key:"getMethod",value:function(){return y_.DELETE;}}]),n;}(Uh),R_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEvent:Hh(e.live_event)};}}]),n;}(qh),D_=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this)),"type",Ph.ENTER),r.liveEventId=e,r;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/participants");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),x_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {participant:zh(e.participant)};}}]),n;}(qh),L_=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this)),"type",Ph.EXIT),i.liveEventId=e,i.participantId=r,i;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/participants/").concat(this.participantId);}},{key:"getMethod",value:function(){return y_.DELETE;}}]),n;}(Uh),M_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {participant:zh(e.participant)};}}]),n;}(qh),U_=function(e){h(n,e);var t=E(n);function n(e,r,i){var s;return u(this,n),d(g(s=t.call(this)),"type",Ph.CONNECTED),s.liveEventId=e,s.participantId=r,s.endpointId=i,s;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/participants/").concat(this.participantId,"/rtcstreams/").concat(this.endpointId,"/connected");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),P_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {endpoint:Gh(e.rtcstream)};}}]),n;}(qh),F_=function(e){h(n,e);var t=E(n);function n(e,r,i){var s;return u(this,n),d(g(s=t.call(this)),"type",Ph.HOST_CONNECTED),s.liveEventId=e,s.hostId=r,s.endpointId=i,s;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/hosts/").concat(this.hostId,"/rtcstreams/").concat(this.endpointId,"/connected");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),q_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {endpoint:Gh(e.rtcstream)};}}]),n;}(qh),H_=function(e){h(n,e);var t=E(n);function n(e,r,i){var s;return u(this,n),d(g(s=t.call(this)),"type",Ph.DELETE_STREAM),s.liveEventId=e,s.participantId=r,s.endpointId=i,s;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/participants/").concat(this.participantId,"/rtcstreams/").concat(this.endpointId);}},{key:"getMethod",value:function(){return y_.DELETE;}}]),n;}(Uh),j_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {};}}]),n;}(qh),V_=function(e){h(n,e);var t=E(n);function n(e,r,i){var s;return u(this,n),d(g(s=t.call(this)),"type",Ph.HOST_DELETE_STREAM),s.liveEventId=e,s.hostId=r,s.endpointId=i,s;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/hosts/").concat(this.hostId,"/rtcstreams/").concat(this.endpointId);}},{key:"getMethod",value:function(){return y_.DELETE;}}]),n;}(Uh),G_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {};}}]),n;}(qh),z_=function(e){h(n,e);var t=E(n);function n(e,r,i,s){var o;return u(this,n),d(g(o=t.call(this)),"type",Ph.ATTACH),o.liveEventId=e,o.participantId=r,o.endpointId=i,o.attachTo=s,o;}return l(n,[{key:"getData",value:function(){return {attach_to:this.attachTo};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/participants/").concat(this.participantId,"/rtcstreams/").concat(this.endpointId,"/attach");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),B_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {endpoint:Gh(e.rtcstream)};}}]),n;}(qh),K_=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),(r=t.call(this)).type=e.type,r.version=e.version,r.messageId=e.message_id,r.payload=r.parseData(e.payload),r;}return l(n);}(Lh),Q_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,liveEvent:Hh(e.live_event)};}}]),n;}(K_),W_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,liveEvent:Hh(e.live_event)};}}]),n;}(K_),Y_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,liveEvent:Hh(e.live_event)};}}]),n;}(K_),Z_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,host:jh(e.host)};}}]),n;}(K_),X_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,host:jh(e.host)};}}]),n;}(K_),J_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,host:jh(e.host)};}}]),n;}(K_),$_=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,host:jh(e.host)};}}]),n;}(K_),ey=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,host:jh(e.host)};}}]),n;}(K_),ty=function(e){h(n,e);var t=E(n);function n(e,r,i,s,o){var a;return u(this,n),d(g(a=t.call(this)),"type",Ph.CREATE_STREAM),a.liveEventId=e,a.participantId=r,a.sdp=i,a.audioAttr=s,a.videoAttr=o,a;}return l(n,[{key:"getData",value:function(){return {sdp:this.sdp,audio_attr:this.audioAttr,video_attr:this.videoAttr};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/participants/").concat(this.participantId,"/rtcstreams");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),ny=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {sdp:e.sdp,endpoint:Gh(e.rtcstream)};}}]),n;}(qh),ry=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {hosts:e.hosts.map(jh)};}}]),n;}(qh),iy=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this)),"type",Ph.HOST_ALIVE),i.liveEventId=e,i.hostId=r,i;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/hosts/").concat(this.hostId,"/alive");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),sy=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {};}}]),n;}(qh),oy=function(e){h(n,e);var t=E(n);function n(e,r,i,s,o){var a;return u(this,n),d(g(a=t.call(this)),"type",Ph.HOST_CREATE_STREAM),a.liveEventId=e,a.hostId=r,a.sdp=i,a.audioAttr=s,a.videoAttr=o,a;}return l(n,[{key:"getData",value:function(){return {sdp:this.sdp,audio_attr:this.audioAttr,video_attr:this.videoAttr};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/hosts/").concat(this.hostId,"/rtcstreams");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),ay=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {sdp:e.sdp,endpoint:Gh(e.rtcstream)};}}]),n;}(qh),uy=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this)),"type",Ph.ALIVE),i.liveEventId=e,i.participantId=r,i;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/participants/").concat(this.participantId,"/alive");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),cy=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {};}}]),n;}(qh),ly=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {participant:zh(e.participant)};}}]),n;}(qh),dy=function(e){h(n,e);var t=E(n);function n(e,r,i){var s;return u(this,n),d(g(s=t.call(this)),"type",Ph.AUDIO),s.liveEventId=e,s.hostId=r,s.on=i,s;}return l(n,[{key:"getData",value:function(){return {on:this.on};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/hosts/").concat(this.hostId,"/audio");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),hy=function(e){h(n,e);var t=E(n);function n(e,r,i){var s;return u(this,n),d(g(s=t.call(this)),"type",Ph.VIDEO),s.liveEventId=e,s.hostId=r,s.on=i,s;}return l(n,[{key:"getData",value:function(){return {on:this.on};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/hosts/").concat(this.hostId,"/video");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),fy=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,host:jh(e.host)};}}]),n;}(K_),py=function(e){h(n,e);var t=E(n);function n(e,r,i,s,o){var a;return u(this,n),d(g(a=t.call(this)),"type",Ph.UPDATE),a.liveEventId=e,a.hostIds=null===r?"":Array.isArray(r)?r:[r],a.title=null===i?"":i,a.coverUrl=null===s?"":s,a.coverFile=null===o?"":o,a;}return l(n,[{key:"getData",value:function(){var e=function(e,n,r,i){void 0!==r&&t.set(n,r);},t=new FormData();return e(0,"user_ids_for_host",String(this.hostIds)),e(0,"title",this.title),e(0,"cover_url",this.coverUrl),e(0,"cover_file",this.coverFile),t;}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId);}},{key:"getMethod",value:function(){return y_.PUT;}}]),n;}(Uh),vy=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEvent:Hh(e.live_event)};}}]),n;}(qh),_y=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,liveEvent:Hh(e.live_event)};}}]),n;}(K_),yy=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this)),"type",Ph.CUSTOM_ITEMS_GET),r.liveEventId=e,r;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/custom-items");}},{key:"getMethod",value:function(){return y_.GET;}}]),n;}(Uh),my=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {customItems:e.custom_items};}}]),n;}(qh),gy=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this)),"type",Ph.CUSTOM_ITEMS_UPDATE),i.liveEventId=e,i.customItems=r,i;}return l(n,[{key:"getData",value:function(){return {custom_items:this.customItems,mode:"upsert"};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/custom-items");}},{key:"getMethod",value:function(){return y_.PUT;}}]),n;}(Uh),Ey=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {customItems:e.custom_items,updatedKeys:e.updated_keys,updatedAt:e.updated_at};}}]),n;}(qh),by=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this)),"type",Ph.CUSTOM_ITEMS_DELETE),i.liveEventId=e,i.keys=r,i;}return l(n,[{key:"getData",value:function(){return this.keys;}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/custom-items");}},{key:"getMethod",value:function(){return y_.DELETE;}}]),n;}(Uh),wy=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {customItems:e.custom_items,deletedKeys:e.deleted_keys,deletedAt:e.deleted_at};}}]),n;}(qh),Iy=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,updatedAt:e.updated_at,customItems:e.custom_items,updatedKeys:e.updated_keys};}}]),n;}(K_),Ty=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,deletedAt:e.deleted_at,customItems:e.custom_items,deletedKeys:e.deleted_keys};}}]),n;}(K_),Sy=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this)),"type",Ph.CUSTOM_ITEMS_DELETE),r.liveEventId=e,r;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/custom-items");}},{key:"getMethod",value:function(){return y_.DELETE;}}]),n;}(Uh),Cy=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this)),"type",Ph.CREATE_RTMP_STREAM),r.liveEventId=e,r;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/rtmp-streams");}},{key:"getMethod",value:function(){return y_.POST;}}]),n;}(Uh),ky=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {host:jh(e.host)};}}]),n;}(qh),Ay=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this)),"type",Ph.DELETE_RTMP_STREAM),i.liveEventId=e,i.rtmpStreamId=r,i;}return l(n,[{key:"getData",value:function(){return {};}},{key:"getSubPath",value:function(){return "/live-events/".concat(this.liveEventId,"/rtmp-streams/").concat(this.rtmpStreamId);}},{key:"getMethod",value:function(){return y_.DELETE;}}]),n;}(Uh),Ny=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {};}}]),n;}(qh),Oy=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),(r=t.call(this)).statsLog=e,r;}return l(n,[{key:"getData",value:function(){return {log_group:"sdk_webrtc_statistics_v1.1",log_data:this.statsLog};}},{key:"getPath",value:function(){return "/v1/sdk/logs";}},{key:"getMethod",value:function(){return "POST";}}]),n;}(Mh),Ry=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"parseData",value:function(e){return {liveEventId:e.live_event_id,participantCount:e.participant_count,peakParticipantCount:e.peak_participant_count,cumulativeParticipantCount:e.cumulative_participant_count};}}]),n;}(K_),Dy=function(){function e(){u(this,e);}return l(e,null,[{key:"createAuth",value:function(e,t,n){return new __(e,t,n);}},{key:"createLiveEvent",value:function(e,t,n,r,i,s){return new m_(e,t,n,r,i,s);}},{key:"updateLiveEvent",value:function(e,t,n,r,i){return new py(e,t,n,r,i);}},{key:"createGetLiveEvent",value:function(e){return new E_(e);}},{key:"createEnterHost",value:function(e,t){return new w_(e,t);}},{key:"createReady",value:function(e){return new T_(e);}},{key:"createStart",value:function(e){return new C_(e);}},{key:"createExitHost",value:function(e,t){return new A_(e,t);}},{key:"createEndLiveEvent",value:function(e){return new O_(e);}},{key:"createEnter",value:function(e){return new D_(e);}},{key:"createExit",value:function(e,t){return new L_(e,t);}},{key:"createConnected",value:function(e,t,n){return new U_(e,t,n);}},{key:"createHostConnected",value:function(e,t,n){return new F_(e,t,n);}},{key:"createStream",value:function(e,t,n,r,i){return new ty(e,t,n,r,i);}},{key:"createHostCreateStream",value:function(e,t,n,r,i){return new oy(e,t,n,r,i);}},{key:"createDeleteStream",value:function(e,t,n){return new H_(e,t,n);}},{key:"createHostDeleteStream",value:function(e,t,n){return new V_(e,t,n);}},{key:"createRTMPStream",value:function(e){return new Cy(e);}},{key:"deleteRTMPStream",value:function(e,t){return new Ay(e,t);}},{key:"createAttach",value:function(e,t,n,r){return new z_(e,t,n,r);}},{key:"createAudio",value:function(e,t,n){return new dy(e,t,n);}},{key:"createVideo",value:function(e,t,n){return new hy(e,t,n);}},{key:"createAlive",value:function(e,t){return new uy(e,t);}},{key:"createHostAlive",value:function(e,t){return new iy(e,t);}},{key:"createGetCustomItems",value:function(e){return new yy(e);}},{key:"createUpdateCustomItems",value:function(e,t){return new gy(e,t);}},{key:"createDeleteCustomItems",value:function(e,t){return new by(e,t);}},{key:"createDeleteAllCustomItems",value:function(e){return new Sy(e);}},{key:"createStatsLogCommand",value:function(e){return new Oy(e);}},{key:"parseResponse",value:function(e,t){try{switch(e.type){case Ph.CREATE:return new g_(t);case Ph.GET:return new b_(t);case Ph.DELETE:return new R_(t);case Ph.QUERY:return new Lf(t);case Ph.READY:return new S_(t);case Ph.START:return new k_(t);case Ph.ENTER_HOST:return new I_(t);case Ph.GET_HOSTS:return new ry(t);case Ph.EXIT_HOST:return new N_(t);case Ph.HOST_ALIVE:return new sy(t);case Ph.AUDIO:return new $_(t);case Ph.VIDEO:return new ey(t);case Ph.HOST_CREATE_STREAM:return new ay(t);case Ph.HOST_DELETE_STREAM:return new G_(t);case Ph.HOST_CONNECTED:return new q_(t);case Ph.ENTER:return new x_(t);case Ph.EXIT:return new M_(t);case Ph.ALIVE:return new cy(t);case Ph.GET_PARTICIPANTS:return new ly(t);case Ph.CREATE_STREAM:return new ny(t);case Ph.DELETE_STREAM:return new j_(t);case Ph.CONNECTED:return new P_(t);case Ph.ATTACH:return new B_(t);case Ph.UPDATE:return new vy(t);case Ph.CUSTOM_ITEMS_GET:return new my(t);case Ph.CUSTOM_ITEMS_UPDATE:return new Ey(t);case Ph.CUSTOM_ITEMS_DELETE:return new wy(t);case Ph.CREATE_RTMP_STREAM:return new ky(t);case Ph.DELETE_RTMP_STREAM:return new Ny(t);}}catch(e){return;}}},{key:"parse",value:function(e){if("live"===e.call_type)try{switch(e.type){case Ph.LIVE_EVENT_READY:return new Q_(e);case Ph.LIVE_EVENT_STARTED:return new W_(e);case Ph.LIVE_EVENT_ENDED:return new Y_(e);case Ph.LIVE_EVENT_UPDATED:return new _y(e);case Ph.HOST_ENTERED:return new Z_(e);case Ph.HOST_EXITED:return new X_(e);case Ph.HOST_CONNECTED:return new J_(e);case Ph.HOST_DISCONNECTED:return new fy(e);case Ph.HOST_AUDIO_STATUS_CHANGED:return new $_(e);case Ph.HOST_VIDEO_STATUS_CHANGED:return new ey(e);case Ph.PARTICIPANT_COUNT_CHANGED:return new Ry(e);case Ph.CUSTOM_ITEMS_UPDATED:return new Iy(e);case Ph.CUSTOM_ITEMS_DELETED:return new Ty(e);}}catch(e){return;}}}]),e;}(),xy=Ah.forEach,Ly=Uf("forEach")?[].forEach:function(e){return xy(this,e,arguments.length>1?arguments[1]:void 0);},My=me,Uy=Xd,Py=eh,Fy=Ly,qy=jr,Hy=function(e){if(e&&e.forEach!==Fy)try{qy(e,"forEach",Fy);}catch(t){e.forEach=Fy;}};for(var jy in Uy)Uy[jy]&&Hy(My[jy]&&My[jy].prototype);Hy(Py);var Vy=As,Gy=fh,zy=xa,By=pt,Ky=Rn,Qy=Un,Wy=_e,Yy=$h,Zy=at,Xy=$a,Jy=Dh("slice"),$y=Zy("species"),em=Array,tm=Math.max;Vy({target:"Array",proto:!0,forced:!Jy},{slice:function(e,t){var n,r,i,s=Wy(this),o=Qy(s),a=Ky(e,o),u=Ky(void 0===t?o:t,o);if(Gy(s)&&(n=s.constructor,(zy(n)&&(n===em||Gy(n.prototype))||By(n)&&null===(n=n[$y]))&&(n=void 0),n===em||void 0===n))return Xy(s,a,u);for(r=new(void 0===n?em:n)(tm(u-a,0)),i=0;a<u;a++,i++)a in s&&Yy(r,i,s[a]);return r.length=i,r;}});var nm,rm,im=function(){function e(){u(this,e),d(this,"_listeners",{}),d(this,"on",this.addEventListener),d(this,"off",this.removeEventListener);}return l(e,[{key:"addEventListener",value:function(e,t){var n=this;return e in this._listeners||(this._listeners[e]=[]),this._listeners[e].push(t),function(){return n.removeEventListener(e,t);};}},{key:"once",value:function(e,t){var n=this;return this.on(e,function r(){t.apply(void 0,arguments),n.removeEventListener(e,r);});}},{key:"removeEventListener",value:function(e,t){if(e in this._listeners)for(var n=this._listeners[e],r=0,i=n.length;r<i;r++)if(n[r]===t)return void n.splice(r,1);}},{key:"removeAllEventListeners",value:function(){this._listeners={};}},{key:"_dispatchEvent",value:function(e){if(e in this._listeners){for(var t=this._listeners[e].slice(),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var s=0,o=t.length;s<o;s++){var a;(a=t[s]).call.apply(a,[this].concat(r));}}}}]),e;}(),sm=W,om=me.RegExp,am=sm(function(){var e=om("a","y");return e.lastIndex=2,null!=e.exec("abcd");}),um=am||sm(function(){return !om("a","y").sticky;}),cm=am||sm(function(){var e=om("^r","gy");return e.lastIndex=2,null!=e.exec("str");}),lm={BROKEN_CARET:cm,MISSED_STICKY:um,UNSUPPORTED_Y:am},dm=W,hm=me.RegExp,fm=dm(function(){var e=hm(".","s");return !(e.dotAll&&e.exec("\n")&&"s"===e.flags);}),pm=W,vm=me.RegExp,_m=pm(function(){var e=vm("(?<a>b)","g");return "b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c");}),ym=Rt,mm=ee,gm=xd,Em=_f,bm=lm,wm=ge.exports,Im=Tr,Tm=ti.get,Sm=fm,Cm=_m,km=wm("native-string-replace",String.prototype.replace),Am=RegExp.prototype.exec,Nm=Am,Om=mm("".charAt),Rm=mm("".indexOf),Dm=mm("".replace),xm=mm("".slice),Lm=(rm=/b*/g,ym(Am,nm=/a/,"a"),ym(Am,rm,"a"),0!==nm.lastIndex||0!==rm.lastIndex),Mm=bm.BROKEN_CARET,Um=void 0!==/()??/.exec("")[1];(Lm||Um||Mm||Sm||Cm)&&(Nm=function(e){var t,n,r,i,s,o,a,u=this,c=Tm(u),l=gm(e),d=c.raw;if(d)return d.lastIndex=u.lastIndex,t=ym(Nm,d,l),u.lastIndex=d.lastIndex,t;var h=c.groups,f=Mm&&u.sticky,p=ym(Em,u),v=u.source,_=0,y=l;if(f&&(p=Dm(p,"y",""),-1===Rm(p,"g")&&(p+="g"),y=xm(l,u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==Om(l,u.lastIndex-1))&&(v="(?: "+v+")",y=" "+y,_++),n=new RegExp("^(?:"+v+")",p)),Um&&(n=new RegExp("^"+v+"$(?!\\s)",p)),Lm&&(r=u.lastIndex),i=ym(Am,f?n:u,y),f?i?(i.input=xm(i.input,_),i[0]=xm(i[0],_),i.index=u.lastIndex,u.lastIndex+=i[0].length):u.lastIndex=0:Lm&&i&&(u.lastIndex=u.global?i.index+i[0].length:r),Um&&i&&i.length>1&&ym(km,i[0],n,function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(i[s]=void 0);}),i&&h)for(i.groups=o=Im(null),s=0;s<h.length;s++)o[(a=h[s])[0]]=i[a[1]];return i;});var Pm=Nm;As({target:"RegExp",proto:!0,forced:/./.exec!==Pm},{exec:Pm});var Fm=Wa,qm=Wi,Hm=Pm,jm=W,Vm=at,Gm=jr,zm=Vm("species"),Bm=RegExp.prototype,Km=function(e,t,n,r){var i=Vm(e),s=!jm(function(){var t={};return t[i]=function(){return 7;},7!=""[e](t);}),o=s&&!jm(function(){var t=!1,n=/a/;return "split"===e&&((n={}).constructor={},n.constructor[zm]=function(){return n;},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null;},n[i](""),!t;});if(!s||!o||n){var a=Fm(/./[i]),u=t(i,""[e],function(e,t,n,r,i){var o=Fm(e),u=t.exec;return u===Hm||u===Bm.exec?s&&!i?{done:!0,value:a(t,n,r)}:{done:!0,value:o(n,t,r)}:{done:!1};});qm(String.prototype,e,u[0]),qm(Bm,i,u[1]);}r&&Gm(Bm[i],"sham",!0);},Qm=Vd.charAt,Wm=function(e,t,n){return t+(n?Qm(e,t).length:1);},Ym=ee,Zm=Re,Xm=Math.floor,Jm=Ym("".charAt),$m=Ym("".replace),eg=Ym("".slice),tg=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,ng=/\$([$&'`]|\d{1,2})/g,rg=Rt,ig=mt,sg=dt,og=ie,ag=Pm,ug=TypeError,cg=function(e,t){var n=e.exec;if(sg(n)){var r=rg(n,e,t);return null!==r&&ig(r),r;}if("RegExp"===og(e))return rg(ag,e,t);throw ug("RegExp#exec called on incompatible receiver");},lg=Ba,dg=Rt,hg=ee,fg=Km,pg=W,vg=mt,_g=dt,yg=le,mg=kn,gg=Ln,Eg=xd,bg=fe,wg=Wm,Ig=Yt,Tg=function(e,t,n,r,i,s){var o=n+e.length,a=r.length,u=ng;return void 0!==i&&(i=Zm(i),u=tg),$m(s,u,function(s,u){var c;switch(Jm(u,0)){case"$":return "$";case"&":return e;case"`":return eg(t,0,n);case"'":return eg(t,o);case"<":c=i[eg(u,1,-1)];break;default:var l=+u;if(0===l)return s;if(l>a){var d=Xm(l/10);return 0===d?s:d<=a?void 0===r[d-1]?Jm(u,1):r[d-1]+Jm(u,1):s;}c=r[l-1];}return void 0===c?"":c;});},Sg=cg,Cg=at("replace"),kg=Math.max,Ag=Math.min,Ng=hg([].concat),Og=hg([].push),Rg=hg("".indexOf),Dg=hg("".slice),xg=function(e){return void 0===e?e:String(e);},Lg="$0"==="a".replace(/./,"$0"),Mg=!!/./[Cg]&&""===/./[Cg]("a","$0"),Ug=!pg(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e;},"7"!=="".replace(e,"$<a>");});fg("replace",function(e,t,n){var r=Mg?"$":"$0";return [function(e,n){var r=bg(this),i=yg(e)?void 0:Ig(e,Cg);return i?dg(i,e,r,n):dg(t,Eg(r),e,n);},function(e,i){var s=vg(this),o=Eg(e);if("string"==typeof i&&-1===Rg(i,r)&&-1===Rg(i,"$<")){var a=n(t,s,o,i);if(a.done)return a.value;}var u=_g(i);u||(i=Eg(i));var c=s.global;if(c){var l=s.unicode;s.lastIndex=0;}for(var d=[];;){var h=Sg(s,o);if(null===h)break;if(Og(d,h),!c)break;""===Eg(h[0])&&(s.lastIndex=wg(o,gg(s.lastIndex),l));}for(var f="",p=0,v=0;v<d.length;v++){for(var _=Eg((h=d[v])[0]),y=kg(Ag(mg(h.index),o.length),0),m=[],g=1;g<h.length;g++)Og(m,xg(h[g]));var E=h.groups;if(u){var b=Ng([_],m,y,o);void 0!==E&&Og(b,E);var w=Eg(lg(i,void 0,b));}else w=Tg(_,o,y,m,E,i);y>=p&&(f+=Dg(o,p,y)+w,p=y+_.length);}return f+Dg(o,p);}];},!Ug||!Lg||Mg);var Pg=me,Fg=ee(1..valueOf),qg="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",Hg=fe,jg=xd,Vg=qg,Gg=ee("".replace),zg=RegExp("^["+Vg+"]+"),Bg=RegExp("(^|[^"+Vg+"])["+Vg+"]+$"),Kg=function(e){return function(t){var n=jg(Hg(t));return 1&e&&(n=Gg(n,zg,"")),2&e&&(n=Gg(n,Bg,"$1")),n;};},Qg={start:Kg(1),end:Kg(2),trim:Kg(3)},Wg=As,Yg=Et,Zg=me,Xg=Pg,Jg=ee,$g=Es,eE=Le,tE=ov,nE=Mt,rE=Ht,iE=un,sE=W,oE=Yi.f,aE=ni.f,uE=wt.f,cE=Fg,lE=Qg.trim,dE="Number",hE=Zg[dE];Xg[dE];var fE=hE.prototype,pE=Zg.TypeError,vE=Jg("".slice),_E=Jg("".charCodeAt),yE=function(e){var t,n,r,i,s,o,a,u,c=iE(e,"number");if(rE(c))throw pE("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=lE(c),43===(t=_E(c,0))||45===t){if(88===(n=_E(c,2))||120===n)return NaN;}else if(48===t){switch(_E(c,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return +c;}for(o=(s=vE(c,2)).length,a=0;a<o;a++)if((u=_E(s,a))<48||u>i)return NaN;return parseInt(s,r);}return +c;},mE=$g(dE,!hE(" 0o1")||!hE("0b1")||hE("+0x1")),gE=function(e){var t,n=arguments.length<1?0:hE(function(e){var t=iE(e,"number");return "bigint"==typeof t?t:yE(t);}(e));return nE(fE,t=this)&&sE(function(){cE(t);})?tE(Object(n),this,gE):n;};gE.prototype=fE,mE&&(fE.constructor=gE),Wg({global:!0,constructor:!0,wrap:!0,forced:mE},{Number:gE});mE&&function(e,t){for(var n,r=Yg?oE(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),i=0;r.length>i;i++)eE(t,n=r[i])&&!eE(e,n)&&uE(e,n,aE(t,n));}(Xg[dE],hE);var EE=function(e){Object.keys(e).forEach(function(t){var n;(void 0===(n=e[t])||Number.isNaN(n)||""===n||Array.isArray(n)&&0===n.length)&&delete e[t];});},bE=function(){var e=a(i().mark(function e(t){var n,r,s,o,a,u,c,l,d,h,f,p,v;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break;}throw new Error("'getCandidateInfo()' is called without rtcConnection");case 2:return e.next=4,t.getStats();case 4:n=e.sent,s=n.entries(),o=0;case 7:if(!(o<n.size)){e.next=18;break;}if(a=s.next(),u=a.value){e.next=11;break;}return e.abrupt("continue",15);case 11:if("candidate-pair"!==(c=u[1]).type||"succeeded"!==c.state){e.next=15;break;}return r=c.localCandidateId,e.abrupt("break",18);case 15:o++,e.next=7;break;case 18:if(!(o<n.size)){e.next=28;break;}if(l=s.next(),d=l.value){e.next=22;break;}return e.abrupt("continue",25);case 22:if("local-candidate"!==(h=d[1]).type||h.id!==r){e.next=25;break;}return e.abrupt("return",{connectionType:null!==(f=h.candidateType)&&void 0!==f?f:"",protocol:null!==(p=h.protocol)&&void 0!==p?p:"",relayProtocol:null!==(v=h.relayProtocol)&&void 0!==v?v:""});case 25:o++,e.next=18;break;case 28:return e.abrupt("return",null);case 29:case"end":return e.stop();}},e);}));return function(t){return e.apply(this,arguments);};}(),wE=function(){var e=a(i().mark(function e(t){var n,r,s,o,a,u,c;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={},r={},s={},o={},a=new Map(),u=new Map(),t.forEach(function(e){"codec"===e.type&&a.set(e.id,e),"candidate-pair"===e.type&&"succeeded"===e.state&&(c=e.localCandidateId,n.webrtc_timestamp=e.time),"media-source"===e.type&&u.set(e.kind,e);}),t.forEach(function(e){if("local-candidate"===e.type&&e.id===c&&(r.network_type=e.networkType,r.protocol=e.protocol,r.candidate_type=e.candidateType),"audio"===e.kind||"audio"===e.mediaType){var t;if("outbound-rtp"===e.type)s.codec=null===(t=a.get(e.codecId))||void 0===t?void 0:t.mimeType,s.total_packets_sent=e.packetsSent,s.retransmitted_packets_sent=e.retransmittedPacketsSent;if("remote-inbound-rtp"===e.type&&(s.rtt=1e3*e.roundTripTime,s.total_remote_packets_lost=e.packetsLost,s.total_remote_packets_lost_rate=s.total_remote_packets_lost/s.total_packets_sent*100),"inbound-rtp"===e.type){var n=e.packetsLost/(e.packetsLost+e.packetsReceived)*100;s.total_packets_received=e.packetsReceived,s.total_packets_lost_rate=n,s.total_packets_lost=e.packetsLost,s.jitter=1e3*e.jitter;}"track"===e.type&&e.remoteSource&&(s.jitter_buffer_delay=e.jitterBufferDelay,s.jitter_buffer_emitted_count=e.jitterBufferDelayEmittedCount);}if("video"===e.kind||"video"===e.mediaType){var i,l,d,h;if(o.video_source_width=null===(i=u.get("video"))||void 0===i?void 0:i.width,o.video_source_height=null===(l=u.get("video"))||void 0===l?void 0:l.height,o.video_source_frames_per_second=null===(d=u.get("video"))||void 0===d?void 0:d.framesPerSecond,"outbound-rtp"===e.type)o.codec=null===(h=a.get(e.codecId))||void 0===h?void 0:h.mimeType,o.fir_count=e.firCount,o.pli_count=e.pliCount,o.nack_count=e.nackCount,o.qp_sum=e.qpSum,o.total_packets_sent=e.packetsSent,o.retransmitted_packets_sent=e.retransmittedBytesSent,o.quality_limitation_reason=e.qualityLimitationReason,o.quality_limitation_resolution_changes=e.qualityLimitationResolutionChanges;if("remote-inbound-rtp"===e.type&&(o.rtt=1e3*e.roundTripTime,o.total_remote_packets_lost=e.packetsLost,o.total_remote_packets_lost_rate=o.total_remote_packets_lost/o.total_packets_sent*100),"inbound-rtp"===e.type){o.header_bytes_received=e.headerBytesReceived,o.key_frames_decoded=e.keyFramesDecoded,o.total_decode_time=e.totalDecodeTime,o.total_inter_frame_delay=e.totalInterFrameDelay,o.total_squared_inter_frame_delay=e.totalSquaredInterFrameDelay;var f=e.packetsLost/(e.packetsLost+e.packetsReceived)*100;o.total_packets_lost=e.packetsLost,o.total_packets_received=e.packetsReceived,o.total_packets_lost_rate=f;}"track"===e.type&&(e.remoteSource?(o.jitter_buffer_delay=e.jitterBufferDelay,o.jitter_buffer_emitted_count=e.jitterBufferDelayEmittedCount,o.received_frame_width=e.frameWidth,o.received_frame_height=e.frameHeight,o.frames_received=e.framesReceived,o.frames_decoded=e.framesDecoded,o.frames_dropped=e.framesDropped,o.freeze_count=e.freezeCount,o.pause_count=e.pauseCount,o.total_freezes_duration=e.totalFreezesDuration,o.total_pauses_duration=e.totalPausesDuration,o.total_frames_duration=e.totalFramesDuration,o.sum_of_squared_frames_duration=e.sumOfSquaredFramesDuration):(o.sent_frame_width=e.frameWidth,o.sent_frame_height=e.frameHeight));}}),EE(r),EE(s),EE(o),n.transport_info=r,n.audio=s,n.video=o,e.abrupt("return",n);case 15:case"end":return e.stop();}},e);}));return function(t){return e.apply(this,arguments);};}(),IE=function(){var e=a(i().mark(function e(t){var n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break;}throw new Error("'getStats()' is called without rtcConnection");case 2:return e.next=4,t.getStats();case 4:return n=e.sent,e.abrupt("return",wE(n));case 6:case"end":return e.stop();}},e);}));return function(t){return e.apply(this,arguments);};}(),TE=function(e){var t=r(r({},e),{},{transport_info:r({},e.transport_info),audio:r({},e.audio)});return e.video&&(t.video=r({},e.video)),t;},SE=function(e,t){var n=TE(e),r=n.audio,i=n.video;return r.packets_lost=r.total_packets_lost,r.packets_received=r.total_packets_received,r.packets_sent=r.total_packets_sent,r.remote_packets_lost=r.total_remote_packets_lost,t&&(r.packets_lost-=t.audio.total_packets_lost,r.packets_received-=t.audio.total_packets_received,r.packets_sent-=t.audio.total_packets_sent,r.remote_packets_lost-=t.audio.total_remote_packets_lost),r.packets_lost_rate=r.packets_lost/(r.packets_lost+r.packets_received)*100,i.packets_lost=i.total_packets_lost,i.packets_received=i.total_packets_received,i.packets_sent=i.total_packets_sent,i.remote_packets_lost=i.total_remote_packets_lost,t&&(i.packets_lost-=t.video.total_packets_lost,i.packets_received-=t.video.total_packets_received,i.packets_sent-=t.video.total_packets_sent,i.remote_packets_lost-=t.video.total_remote_packets_lost),i.packets_lost_rate=i.packets_lost/(i.packets_lost+i.packets_received)*100,i.remote_packets_lost_rate=i.remote_packets_lost/i.packets_sent*100,n;},CE=function(e,t){return (null!=e?e:0)+(null!=t?t:0);},kE=function(e,t,n){return (null!=e?e:0)*n+(null!=t?t:0)*(1-n);},AE=function(e){return e.OFFER="offer",e.ANSWER="answer",e.CANDIDATE="candidate",e;}({}),NE=function(){function e(t){u(this,e),this._context=t;}return l(e,[{key:"state",get:function(){return this._state;}},{key:"_changeState",value:function(e){this._state&&this._state.type===e.type||(this._state&&this._state.destroy(),this._state=e,this._state.context=this._context,this._state.start());}}]),e;}(),OE=function(){function e(t){u(this,e),this._stateMutator=t;}return l(e,[{key:"context",set:function(e){this._context=e;}},{key:"start",value:function(){this._onStart();}},{key:"destroy",value:function(){this._onDestroy();}}]),e;}(),RE=function(){function e(t,n){u(this,e),this._context=t,this._stateMutator=n,this._context=t,this._stateMutator=n;}return l(e,[{key:"state",get:function(){return this._stateMutator.state;}}]),e;}(),DE=function(e){h(n,e);var t=E(n);function n(e){return u(this,n),t.call(this,e);}return l(n);}(OE),xE=function(e){return e.IDLE="idle",e.OFFERING="offering",e.ANSWERING="answering",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.ICE_RESTART_OFFERING="iceRestartOffering",e.ICE_RESTART_ANSWERING="iceRestartAnswering",e.CLOSED="closed",e;}({}),LE=function(e){h(r,e);var t,n=E(r);function r(e,t){var i;return u(this,r),d(g(i=n.call(this,e)),"type",xE.ANSWERING),i._offerCommand=t,i;}return l(r,[{key:"_onStart",value:function(){this._context.dispatchEvent("answering"),this._context.createRTCConnection(),this._offerCommand&&this.onOfferReceived(this._offerCommand);}},{key:"_onDestroy",value:function(){}},{key:"onOfferReceived",value:(t=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.setRemoteDescription("offer",t.payload.sdp);case 2:this._context.prepareSessionDescription(),this._context.sendAnswer().catch(function(e){});case 4:case"end":return e.stop();}},e,this);})),function(e){return t.apply(this,arguments);})},{key:"onIceConnected",value:function(){this._stateMutator.toConnected(!1);}},{key:"onClose",value:function(){this._stateMutator.toClosed();}}]),r;}(DE),ME=function(e){h(n,e);var t=E(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return d(g(e=t.call.apply(t,[this].concat(i))),"type",xE.CLOSED),e;}return l(n,[{key:"_onStart",value:function(){this._context.dispatchEvent("closed");}},{key:"_onDestroy",value:function(){}}]),n;}(DE),UE=function(e){h(r,e);var t,n=E(r);function r(e,t){var i;return u(this,r),d(g(i=n.call(this,e)),"type",xE.CONNECTED),i._isReconnected=t,i;}return l(r,[{key:"_onStart",value:function(){this._context.dispatchEvent("connected");}},{key:"_onDestroy",value:function(){}},{key:"onOfferReceived",value:(t=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._stateMutator.toReconnecting(t);case 1:case"end":return e.stop();}},e,this);})),function(e){return t.apply(this,arguments);})},{key:"onIceDisconnected",value:function(){this._stateMutator.toReconnecting();}},{key:"onIceFailed",value:function(){this._context.isDisposable&&this.onClose(),this._context.isInitiator?this._stateMutator.toIceRestartOffering():this._stateMutator.toIceRestartAnswering();}},{key:"onClose",value:function(){this._stateMutator.toClosed();}}]),r;}(DE),PE=function(e){h(r,e);var t,n=E(r);function r(e,t){var i;return u(this,r),d(g(i=n.call(this,e)),"type",xE.ICE_RESTART_ANSWERING),i._offerCommand=t,i;}return l(r,[{key:"_onStart",value:function(){this._context.dispatchEvent("iceRestartAnswering"),this._offerCommand&&this.onOfferReceived(this._offerCommand);}},{key:"_onDestroy",value:function(){}},{key:"onOfferReceived",value:(t=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.setRemoteDescription("offer",t.payload.sdp);case 2:this._context.sendAnswer().catch(function(e){});case 3:case"end":return e.stop();}},e,this);})),function(e){return t.apply(this,arguments);})},{key:"onIceConnected",value:function(){this._stateMutator.toConnected(!0);}},{key:"onClose",value:function(){this._stateMutator.toClosed();}}]),r;}(DE),FE=function(e){h(n,e);var t=E(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return d(g(e=t.call.apply(t,[this].concat(i))),"type",xE.ICE_RESTART_OFFERING),e;}return l(n,[{key:"_onStart",value:function(){this._context.dispatchEvent("iceRestartOffering"),this._context.sendOffer(!0);}},{key:"_onDestroy",value:function(){}},{key:"onAnswerReceived",value:function(e){this._context.setRemoteDescription("answer",e.payload.sdp);}},{key:"onIceConnected",value:function(){this._stateMutator.toConnected(!0);}},{key:"onClose",value:function(){this._stateMutator.toClosed();}}]),n;}(DE),qE=function(e){h(r,e);var t,n=E(r);function r(){var e;u(this,r);for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return d(g(e=n.call.apply(n,[this].concat(i))),"type",xE.IDLE),e;}return l(r,[{key:"_onStart",value:function(){}},{key:"_onDestroy",value:function(){}},{key:"createOffer",value:function(){this._stateMutator.toOffering();}},{key:"onOfferReceived",value:(t=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._stateMutator.toAnswering(t);case 1:case"end":return e.stop();}},e,this);})),function(e){return t.apply(this,arguments);})},{key:"onClose",value:function(){this._stateMutator.toClosed();}}]),r;}(DE),HE=function(e){h(n,e);var t=E(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return d(g(e=t.call.apply(t,[this].concat(i))),"type",xE.OFFERING),e;}return l(n,[{key:"_onStart",value:function(){this._context.dispatchEvent("offering"),this._context.createRTCConnection(),this._context.prepareSessionDescription();}},{key:"_onDestroy",value:function(){}},{key:"onAnswerReceived",value:function(e){this._context.setRemoteDescription("answer",e.payload.sdp);}},{key:"onIceConnected",value:function(){this._stateMutator.toConnected(!1);}},{key:"onClose",value:function(){this._stateMutator.toClosed();}}]),n;}(DE),jE=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this,e)),"type",xE.RECONNECTING),i._offerCommand=r,i;}return l(n,[{key:"_onStart",value:function(){this._context.dispatchEvent("reconnecting"),this._offerCommand&&this.onOfferReceived(this._offerCommand);}},{key:"_onDestroy",value:function(){}},{key:"onOfferReceived",value:function(e){this._stateMutator.toIceRestartAnswering(e);}},{key:"onIceConnected",value:function(){this._stateMutator.toConnected(!0);}},{key:"onIceFailed",value:function(){this._context.isDisposable&&this.onClose(),this._context.isInitiator?this._stateMutator.toIceRestartOffering():this._stateMutator.toIceRestartAnswering();}},{key:"onClose",value:function(){this._stateMutator.toClosed();}}]),n;}(DE),VE=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"state",get:function(){return this._state;}},{key:"name",get:function(){return "PeerConnection";}},{key:"toIdle",value:function(){this._changeState(new qE(this));}},{key:"toOffering",value:function(){this._changeState(new HE(this));}},{key:"toAnswering",value:function(e){this._changeState(new LE(this,e));}},{key:"toConnected",value:function(e){this._changeState(new UE(this,e));}},{key:"toReconnecting",value:function(e){this._changeState(new jE(this,e));}},{key:"toIceRestartOffering",value:function(){this._changeState(new FE(this));}},{key:"toIceRestartAnswering",value:function(e){this._changeState(new PE(this,e));}},{key:"toClosed",value:function(){this._changeState(new ME(this));}}]),n;}(NE),GE=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),(r=t.call(this,e,new VE(e)))._stateMutator.toIdle(),r;}return l(n,[{key:"state",get:function(){return this._stateMutator.state;}},{key:"onOfferReceived",value:function(e){lp.verbose("[".concat(this.state.type,"] onOfferReceived"));var t=this.state;switch(t.type){case xE.IDLE:case xE.ANSWERING:case xE.CONNECTED:case xE.RECONNECTING:case xE.ICE_RESTART_ANSWERING:t.onOfferReceived(e);break;default:lp.error("[".concat(this.state.type,"] onOfferReceived"));}}},{key:"onAnswerReceived",value:function(e){lp.verbose("[".concat(this.state.type,"] onAnswerReceived"));var t=this.state;switch(t.type){case xE.OFFERING:case xE.ICE_RESTART_OFFERING:t.onAnswerReceived(e);break;default:lp.error("[".concat(this.state.type,"] onAnswerReceived"));}}},{key:"onClose",value:function(){lp.verbose("[".concat(this.state.type,"] onClose"));var e=this.state;switch(e.type){case xE.IDLE:case xE.OFFERING:case xE.ANSWERING:case xE.CONNECTED:case xE.RECONNECTING:case xE.ICE_RESTART_OFFERING:case xE.ICE_RESTART_ANSWERING:e.onClose();break;default:lp.error("[".concat(this.state.type,"] onClose"));}}},{key:"createOffer",value:function(){lp.verbose("[".concat(this.state.type,"] createOffer"));var e=this.state;if(e.type===xE.IDLE)e.createOffer();else lp.error("[".concat(this.state.type,"] createOffer"));}},{key:"onIceConnected",value:function(){lp.verbose("[".concat(this.state.type,"] onIceConnected"));var e=this.state;switch(e.type){case xE.OFFERING:case xE.ANSWERING:case xE.RECONNECTING:case xE.ICE_RESTART_OFFERING:case xE.ICE_RESTART_ANSWERING:e.onIceConnected();break;default:lp.error("[".concat(this.state.type,"] onIceConnected"));}}},{key:"onIceDisconnected",value:function(){lp.verbose("[".concat(this.state.type,"] onIceDisconnected"));var e=this.state;if(e.type===xE.CONNECTED)e.onIceDisconnected();else lp.error("[".concat(this.state.type,"] onIceDisconnected"));}},{key:"onIceFailed",value:function(){lp.verbose("[".concat(this.state.type,"] onIceFailed"));var e=this.state;switch(e.type){case xE.CONNECTED:case xE.RECONNECTING:e.onIceFailed();break;default:lp.error("[".concat(this.state.type,"] onIceFailed"));}}}]),n;}(RE),zE=function(e){return e.RELAY="relay",e.ALL="all",e;}({}),BE=function(e){h(c,e);var t,n,r,s,o=E(c);function c(e,t,n,r,i,s,a,l){var d;return u(this,c),(d=o.call(this))._ctx=e,d.id=t,d._signalingClient=n,d._localStream=r,d._isInitiator=i,d._turnCredential=s,d._mediaDirections=a,d._isDisposable=l,d._stateMachine=new GE({dispatchEvent:d._dispatchEvent.bind(g(d)),isInitiator:d._isInitiator,setRemoteDescription:d._setRemoteDescription.bind(g(d)),sendAnswer:d._sendAnswer.bind(g(d)),sendOffer:d._sendOffer.bind(g(d)),createRTCConnection:d._createRTCConnection.bind(g(d)),prepareSessionDescription:d._prepareSessionDescription.bind(g(d)),isDisposable:d._isDisposable}),r&&r.on("streamChanged",function(e){return d.onLocalStream(e);}),d;}return l(c,[{key:"_state",get:function(){return this._stateMachine.state;}},{key:"rtcConnection",get:function(){return this._rtcConnection;}},{key:"remoteStream",get:function(){return this._remoteStream;}},{key:"signalingClient",get:function(){return this._signalingClient;}},{key:"onEvent",value:function(e){switch(e.type){case AE.CANDIDATE:return void this._receiveCandidate(e);case AE.OFFER:this._stateMachine.onOfferReceived(e);break;case AE.ANSWER:this._stateMachine.onAnswerReceived(e);break;default:lp.error(new Error("unhandled call event ".concat(e)));}}},{key:"createOffer",value:function(){this._stateMachine.createOffer();}},{key:"close",value:function(){this._closeRTCConnection(),this._stateMachine.onClose();}},{key:"onLocalStream",value:function(e){if(this._rtcConnection){var t,n=T(e.getTracks());try{for(n.s();!(t=n.n()).done;){var r=t.value;this._replaceTrack(r);}}catch(e){n.e(e);}finally{n.f();}}}},{key:"getCandidateInfo",value:(s=a(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",bE(this.rtcConnection));case 1:case"end":return e.stop();}},e,this);})),function(){return s.apply(this,arguments);})},{key:"getStatsLog",value:(r=a(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",IE(this.rtcConnection));case 1:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"_replaceTrack",value:function(e){var t,n=T(this._rtcConnection.getSenders());try{for(n.s();!(t=n.n()).done;){var r=t.value;r.track&&r.track.kind===e.kind&&r.replaceTrack(e);}}catch(e){n.e(e);}finally{n.f();}}},{key:"_createRTCConnection",value:function(){var e,t=this;this._turnCredential&&(e={iceServers:[{username:this._turnCredential.username,credential:this._turnCredential.password,urls:this._turnCredential.turnUrls}],iceTransportPolicy:this._turnCredential.transportPolicy||zE.ALL});var n=new RTCPeerConnection(e);n.onnegotiationneeded=function(){t._sendOffer(!1);},n.onicecandidate=function(e){var n,r;e.candidate&&(null===(n=(r=t._signalingClient).sendCandidate)||void 0===n||n.call(r,e.candidate));},n.onconnectionstatechange=function(){return t._handleConnectionStateChange(n);},n.oniceconnectionstatechange=function(){return t._handleIceConnectionStateChange(n);},n.ontrack=function(e){return t._onRemoteTrack(e);},this._rtcConnection=n;}},{key:"_closeRTCConnection",value:function(){this._rtcConnection&&(this._rtcConnection.onnegotiationneeded=null,this._rtcConnection.onicecandidate=null,this._rtcConnection.oniceconnectionstatechange=null,this._rtcConnection.onconnectionstatechange=null,this._rtcConnection.close(),this._rtcConnection=null,delete this._remoteStream);}},{key:"_prepareSessionDescription",value:function(){var e=this._mediaDirections,t=e.audio,n=e.video,r={sendrecv:[],sendonly:[],recvonly:[],none:[]};r[t].push("audio"),r[n].push("video"),r.sendrecv.length&&this._addTracks(r.sendrecv),r.sendonly.length&&this._addSendOnlyTransceivers(r.sendonly),r.recvonly.length&&this._addReceiveOnlyTransceivers(r.recvonly);}},{key:"_addTracks",value:function(e){var t=this;lp.debug("_addTracks()");var n=this._localStream.localStream;n.getTracks().forEach(function(r){e.includes(r.kind)&&t._rtcConnection.addTrack(r,n);});}},{key:"_addReceiveOnlyTransceivers",value:function(e){var t=this;e.forEach(function(e){t._rtcConnection.addTransceiver(e,{direction:"recvonly"});});}},{key:"_addSendOnlyTransceivers",value:function(e){var t=this,n=this._localStream.localStream;e.forEach(function(e){n.getTracks().forEach(function(r){r.kind===e&&t._rtcConnection.addTransceiver(r,{direction:"sendonly",streams:[n]});});});}},{key:"_setRemoteDescription",value:function(e,t){var n=t.replace(/a=extmap:0 ulpfec\r\n/,""),r=new RTCSessionDescription({type:e,sdp:n});return this._rtcConnection.setRemoteDescription(r);}},{key:"_sendOffer",value:(n=a(i().mark(function e(t){var n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={iceRestart:t||!1},e.next=3,this._rtcConnection.createOffer(n);case 3:return r=e.sent,e.next=6,this._rtcConnection.setLocalDescription(r);case 6:return e.abrupt("return",this._signalingClient.sendOfferSdp(this._rtcConnection.localDescription));case 7:case"end":return e.stop();}},e,this);})),function(e){return n.apply(this,arguments);})},{key:"_sendAnswer",value:(t=a(i().mark(function e(){var t;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rtcConnection.createAnswer();case 2:return (t=e.sent).sdp=t.sdp.replace("actpass","active"),e.next=6,this._rtcConnection.setLocalDescription(t);case 6:return e.abrupt("return",this._signalingClient.sendAnswerSdp(this._rtcConnection.localDescription));case 7:case"end":return e.stop();}},e,this);})),function(){return t.apply(this,arguments);})},{key:"_handleIceConnectionStateChange",value:function(e){switch(lp.verbose("[".concat(this._state.type,"] iceConnectionState ").concat(e.iceConnectionState)),e.iceConnectionState){case"connected":this._stateMachine.onIceConnected();break;case"disconnected":this._stateMachine.onIceDisconnected();break;case"failed":this._dispatchEvent("iceFailed");}}},{key:"_handleConnectionStateChange",value:function(e){if(lp.verbose("[".concat(this._state.type,"] connectionState ").concat(e.connectionState)),"failed"===e.connectionState)this._dispatchEvent("iceFailed");}},{key:"_receiveCandidate",value:function(e){var t=e.payload.candidate;this._rtcConnection.addIceCandidate({sdpMLineIndex:t.sdpMLineIndex,sdpMid:t.sdpMid,candidate:t.sdp}).catch(function(e){lp.error(e);});}},{key:"_onRemoteTrack",value:function(e){this._remoteStream=e.streams[0],this._dispatchEvent("remoteStream",this._remoteStream);}}]),c;}(im),KE=l(function e(){var t=this;u(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n;});}),QE=function(){var e=a(i().mark(function e(t,n,r){var s,o,a,u,c,l,d,h,f=arguments;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=f.length>3&&void 0!==f[3]?f[3]:{count:0,deferred:new KE()},o=s.deferred,a=s.count,e.prev=2,e.next=5,n();case 5:c=e.sent,a>0&&(null===(u=r.onRecover)||void 0===u||u.call(r)),o.resolve(c),e.next=19;break;case 10:if(e.prev=10,e.t0=e.catch(2),null===(l=r.onError)||void 0===l||l.call(r,e.t0),!((d=t.calcTimeout(a+1))>=0)){e.next=18;break;}return null===(h=r.onRetrial)||void 0===h||h.call(r,a+1,e.t0),setTimeout(function(){QE(t,n,r,{count:a+1,deferred:o});},d),e.abrupt("return",o.promise);case 18:o.reject(e.t0);case 19:return e.abrupt("return",o.promise);case 20:case"end":return e.stop();}},e,null,[[2,10]]);}));return function(t,n,r){return e.apply(this,arguments);};}(),WE=function(){function e(){u(this,e);}return l(e,[{key:"calcTimeout",value:function(e){switch(e){case 1:return 1e3;case 2:return 2e3;case 3:return 3e3;default:return -1;}}}]),e;}(),YE=function(){function e(t,n,r){u(this,e),this.interval=t,this.noise=n,this.maxRetrial=r;}return l(e,[{key:"calcTimeout",value:function(e){return e>this.maxRetrial?-1:this.interval+(Math.random()-.5)*this.noise*2;}}]),e;}(),ZE=function(){function e(t){u(this,e),this._requests=new Map(),this.timeoutTime=t;}return l(e,[{key:"has",value:function(e){return this._requests.has(e);}},{key:"get",value:function(e){return this._requests.get(e);}},{key:"register",value:function(e){if(!e)throw new Error("invalid request id");if(this._requests.has(e))throw new Error("duplicate requests");var t=new KE();return this._requests.set(e,{deferred:t,timer:this._createTimeoutTimer(e)}),t;}},{key:"unregister",value:function(e){if(!this._requests.has(e))return null;var t=this._requests.get(e),n=t.timer,r=t.deferred;return clearTimeout(n),this._requests.delete(e),r;}},{key:"_createTimeoutTimer",value:function(e){var t=this;return setTimeout(function(){t.unregister(e).reject(new Error("no response due to timeout"));},this._getTimeoutTime());}},{key:"rejectAll",value:function(e){var t,n=T(this._requests.keys());try{for(n.s();!(t=n.n()).done;){var r=t.value,i=this._requests.get(r);clearTimeout(i.timer),i.deferred.reject(e);}}catch(e){n.e(e);}finally{n.f();}this._requests.clear();}},{key:"_getTimeoutTime",value:function(){return this.timeoutTime;}}]),e;}(),XE=function(){function e(t,n,r,i){u(this,e),d(this,"_timeoutTime",6e4),this._ctx=t,this._participantId=n,this._mediaDirections=r,this._endpointId=i,this._requestMap=new ZE(this._timeoutTime);}var t,n,r;return l(e,[{key:"sendOfferSdp",value:(r=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._endpointId){e.next=5;break;}return e.next=3,this._sendOfferAndUnregisterCreateEndpointRequest(t);case 3:e.next=7;break;case 5:return e.next=7,this._sendOfferAndUnregisterPutEndpointRequest(t);case 7:case"end":return e.stop();}},e,this);})),function(e){return r.apply(this,arguments);})},{key:"_sendOfferAndUnregisterCreateEndpointRequest",value:(n=a(i().mark(function e(t){var n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._requestMap.unregister("".concat(this._participantId,":create-endpoint-request")),e.prev=1,e.next=4,this._sendCreateEndpoint(t);case 4:return r=e.sent,n&&n.resolve(r),e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(1),n&&n.reject(e.t0),e.t0;case 13:case"end":return e.stop();}},e,this,[[1,9]]);})),function(e){return n.apply(this,arguments);})},{key:"_sendOfferAndUnregisterPutEndpointRequest",value:(t=a(i().mark(function e(t){var n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._requestMap.unregister("".concat(this._participantId,":put-endpoint-request")),e.prev=1,e.next=4,this._sendPutEndpoint(t);case 4:return r=e.sent,n&&n.resolve(r),e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(1),n&&n.reject(e.t0),e.t0;case 13:case"end":return e.stop();}},e,this,[[1,9]]);})),function(e){return t.apply(this,arguments);})},{key:"registerCreateEndpointRequest",value:function(){if(this._endpointId)throw new Error("Cannot register create endpoint request on endpoint recycle");return this._requestMap.register("".concat(this._participantId,":create-endpoint-request"));}},{key:"registerPutEndpointRequest",value:function(){if(!this._endpointId)throw new Error("Cannot register put endpoint request without endpoint id");return this._requestMap.register("".concat(this._participantId,":put-endpoint-request"));}},{key:"_sendCreateEndpoint",value:function(e){return this._ctx.sendCreateEndpoint(e);}},{key:"_sendPutEndpoint",value:function(e){return this._ctx.sendPutEndpoint(e);}}]),e;}(),JE=function(e){h(n,e);var t=E(n);function n(e){return u(this,n),t.call(this,e);}return l(n);}(OE),$E=function(e){return e.IDLE="idle",e.OFFERING="offering",e.ESTABLISHED="established",e.CONNECTED="connected",e.DISCONNECTED="disconnected",e.RECONNECTING="reconnecting",e.RELEASING="releasing",e.CLOSED="closed",e;}({}),eb=function(e){h(n,e);var t=E(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return d(g(e=t.call.apply(t,[this].concat(i))),"type",$E.CLOSED),e;}return l(n,[{key:"_onStart",value:function(){this._context.dispatchEvent("closed");}},{key:"_onDestroy",value:function(){}}]),n;}(JE),tb=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this,e)),"type",$E.CONNECTED),r;}return l(n,[{key:"_onStart",value:function(){var e=this._context.reconnectCount>0;this._context.dispatchEvent("connected",e);}},{key:"_onDestroy",value:function(){}},{key:"onICEFailed",value:function(){this._stateMutator.toDisconnected(!0);}},{key:"onAttach",value:function(){this._context.requestAttach();}},{key:"onRelease",value:function(){this._stateMutator.toReleasing();}},{key:"onExit",value:function(){this._stateMutator.toClosed();}}]),n;}(JE),nb=function(e){h(n,e);var t=E(n);function n(e,r,i){var s;return u(this,n),d(g(s=t.call(this,e)),"type",$E.ESTABLISHED),s._sdp=r,s._hasPendingAttach=i,s;}return l(n,[{key:"_onStart",value:function(){this._context.dispatchEvent("established"),this._context.setRemoteDescription(this._sdp),this._hasPendingAttach&&this.onAttach();}},{key:"_onDestroy",value:function(){}},{key:"onPCConnected",value:function(){this._stateMutator.toConnected();}},{key:"onICEFailed",value:function(){this._stateMutator.toDisconnected(!1);}},{key:"onAttach",value:function(){this._context.requestAttach();}},{key:"onRelease",value:function(){this._stateMutator.toReleasing();}},{key:"onExit",value:function(){this._stateMutator.toClosed();}}]),n;}(JE),rb=function(e){h(n,e);var t=E(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return d(g(e=t.call.apply(t,[this].concat(i))),"type",$E.IDLE),e;}return l(n,[{key:"_onStart",value:function(){this._context.dispatchEvent("idle"),this._stateMutator.toOffering();}},{key:"_onDestroy",value:function(){}},{key:"onRelease",value:function(){this._stateMutator.toReleasing();}},{key:"onExit",value:function(){this._stateMutator.toClosed();}}]),n;}(JE),ib=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this,e)),"type",$E.OFFERING),r;}return l(n,[{key:"_onStart",value:function(){this._request();}},{key:"_onDestroy",value:function(){this._requestTimeout&&clearTimeout(this._requestTimeout),delete this._requestTimeout;}},{key:"_request",value:function(){this._context.createSession(),this._context.requestCreateOrPutEndpoint();}},{key:"onICEFailed",value:function(){this._stateMutator.toDisconnected(!1);}},{key:"onEndpointRequestSucceeded",value:function(e){this._stateMutator.toEstablished(e,this._hasPendingAttach);}},{key:"onEndpointRequestFailed",value:function(){this._stateMutator.toDisconnected(!1);}},{key:"onAttach",value:function(){this._hasPendingAttach=!0;}},{key:"onRelease",value:function(){this._stateMutator.toReleasing();}},{key:"onExit",value:function(){this._stateMutator.toClosed();}}]),n;}(JE),sb=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this,e)),"type",$E.DISCONNECTED),i.shouldDispatchEvent=r,i;}return l(n,[{key:"_onStart",value:function(){this.shouldDispatchEvent&&this._context.dispatchEvent("disconnected"),this._stateMutator.toReconnecting();}},{key:"_onDestroy",value:function(){}},{key:"onRelease",value:function(){this._stateMutator.toReleasing();}},{key:"onExit",value:function(){this._stateMutator.toClosed();}}]),n;}(JE),ob=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this,e)),"type",$E.RECONNECTING),r;}return l(n,[{key:"_onStart",value:function(){var e=this;this._context.reconnectCount+=1,setTimeout(function(){e._stateMutator.toOffering();},5e3+1e3*Math.random()),this._context.endpoint.onReconnecting();}},{key:"_onDestroy",value:function(){}},{key:"onRelease",value:function(){this._stateMutator.toReleasing();}},{key:"onExit",value:function(){this._stateMutator.toClosed();}}]),n;}(JE),ab=function(e){h(n,e);var t=E(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return d(g(e=t.call.apply(t,[this].concat(i))),"type",$E.RELEASING),e;}return l(n,[{key:"_onStart",value:function(){this._context.dispatchEvent("releasing"),this._context.closePeerConnection(),this._context.endpoint.id&&this._context.requestRelease();}},{key:"_onDestroy",value:function(){}},{key:"onEndpointRequestSucceeded",value:function(){this._context.requestRelease();}},{key:"onEndpointRequestFailed",value:function(){this._stateMutator.toClosed();}},{key:"onReleased",value:function(){this._stateMutator.toClosed();}},{key:"onExit",value:function(){this._stateMutator.toClosed();}}]),n;}(JE),ub=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n,[{key:"state",get:function(){return this._state;}},{key:"name",get:function(){return "Endpoint";}},{key:"toIdle",value:function(){this._changeState(new rb(this));}},{key:"toOffering",value:function(){this._changeState(new ib(this));}},{key:"toEstablished",value:function(e,t){this._changeState(new nb(this,e,t));}},{key:"toConnected",value:function(){this._changeState(new tb(this));}},{key:"toDisconnected",value:function(e){this._changeState(new sb(this,e));}},{key:"toReconnecting",value:function(){this._changeState(new ob(this));}},{key:"toReleasing",value:function(){this._changeState(new ab(this));}},{key:"toClosed",value:function(){this._changeState(new eb(this));}}]),n;}(NE),cb=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),(r=t.call(this,e,new ub(e)))._stateMutator.toIdle(),r;}return l(n,[{key:"state",get:function(){return this._stateMutator.state;}},{key:"onEndpointRequestSucceeded",value:function(e){lp.verbose("[".concat(this.state.type,"] onEndpointRequestSucceeded"));var t=this.state;switch(t.type){case $E.OFFERING:t.onEndpointRequestSucceeded(e);break;case $E.RELEASING:t.onEndpointRequestSucceeded();break;default:lp.error("[".concat(this.state.type,"] onEndpointRequestSucceeded"));}}},{key:"onEndpointRequestFailed",value:function(){lp.verbose("[".concat(this.state.type,"] onEndpointCreateFailed"));var e=this.state;switch(e.type){case $E.OFFERING:case $E.RELEASING:e.onEndpointRequestFailed();break;default:lp.error("[".concat(this.state.type,"] onEndpointCreateFailed"));}}},{key:"onICEFailed",value:function(){lp.verbose("[".concat(this.state.type,"] onICEFailed"));var e=this.state;switch(e.type){case $E.OFFERING:case $E.ESTABLISHED:case $E.CONNECTED:e.onICEFailed();break;default:lp.error("[".concat(this.state.type,"] onICEFailed"));}}},{key:"onPCConnected",value:function(){lp.verbose("[".concat(this.state.type,"] onPCConnected"));var e=this.state;if(e.type===$E.ESTABLISHED)e.onPCConnected();else lp.error("[".concat(this.state.type,"] onPCConnected"));}},{key:"onAttach",value:function(){lp.verbose("[".concat(this.state.type,"] onAttach"));var e=this.state;switch(e.type){case $E.OFFERING:case $E.ESTABLISHED:case $E.CONNECTED:e.onAttach();break;default:lp.error("[".concat(this.state.type,"] onAttach"));}}},{key:"onRelease",value:function(){lp.verbose("[".concat(this.state.type,"] onRelease"));var e=this.state;switch(e.type){case $E.IDLE:case $E.OFFERING:case $E.ESTABLISHED:case $E.CONNECTED:case $E.DISCONNECTED:case $E.RECONNECTING:e.onRelease();break;default:lp.error("[".concat(this.state.type,"] onRelease"));}}},{key:"onReleased",value:function(){lp.verbose("[".concat(this.state.type,"] onReleased"));var e=this.state;if(e.type===$E.RELEASING)e.onReleased();else lp.error("[".concat(this.state.type,"] onReleased"));}},{key:"onExit",value:function(){lp.verbose("[".concat(this.state.type,"] onExit"));var e=this.state;switch(e.type){case $E.RELEASING:case $E.IDLE:case $E.CONNECTED:case $E.ESTABLISHED:case $E.OFFERING:case $E.DISCONNECTED:case $E.RECONNECTING:e.onExit();break;default:lp.error("[".concat(this.state.type,"] onExit"));}}}]),n;}(RE),lb=function(e){h(n,e);var t=E(n);function n(){return u(this,n),t.apply(this,arguments);}return l(n);}(function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),(r=t.call(this)).payload=e.payload||{},r;}return l(n);}(Lh)),db=function(e){return e.OFFER="offer",e.ANSWER="answer",e.CANDIDATE="candidate",e;}({}),hb=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this,{payload:e})),"type",db.ANSWER),r;}return l(n);}(lb),fb=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this,{payload:e})),"type",db.CANDIDATE),r;}return l(n);}(lb),pb=function(e){h(n,e);var t=E(n);function n(e){var r;return u(this,n),d(g(r=t.call(this,{payload:e})),"type",db.OFFER),r;}return l(n);}(lb),vb=function(){function e(){u(this,e);}return l(e,null,[{key:"createOffer",value:function(e,t){return new pb({peerConnectionId:e,sdp:t});}},{key:"createAnswer",value:function(e,t){return new hb({peerConnectionId:e,sdp:t});}},{key:"createCandidate",value:function(e,t){return new fb({peerConnectionId:e,candidate:t});}}]),e;}(),_b=Rt,yb=mt,mb=le,gb=Ln,Eb=xd,bb=fe,wb=Yt,Ib=Wm,Tb=cg;Km("match",function(e,t,n){return [function(t){var n=bb(this),r=mb(t)?void 0:wb(t,e);return r?_b(r,t,n):new RegExp(t)[e](Eb(n));},function(e){var r=yb(this),i=Eb(e),s=n(t,r,i);if(s.done)return s.value;if(!r.global)return Tb(r,i);var o=r.unicode;r.lastIndex=0;for(var a,u=[],c=0;null!==(a=Tb(r,i));){var l=Eb(a[0]);u[c]=l,""===l&&(r.lastIndex=Ib(i,gb(r.lastIndex),o)),c++;}return 0===c?null:u;}];});var Sb=me,Cb=W,kb=ee,Ab=xd,Nb=Qg.trim,Ob=qg,Rb=Sb.parseInt,Db=Sb.Symbol,xb=Db&&Db.iterator,Lb=/^[+-]?0x/i,Mb=kb(Lb.exec),Ub=8!==Rb(Ob+"08")||22!==Rb(Ob+"0x16")||xb&&!Cb(function(){Rb(Object(xb));})?function(e,t){var n=Nb(Ab(e));return Rb(n,t>>>0||(Mb(Lb,n)?16:10));}:Rb;As({global:!0,forced:parseInt!=Ub},{parseInt:Ub});var Pb=function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10);},Fb=function(){var e={browser:null,version:null};if("undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;var t=window.navigator;if(t.mozGetUserMedia)e.browser="firefox",e.version=Pb(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===window.isSecureContext&&window.webkitRTCPeerConnection&&!window.RTCIceGatherer)e.browser="chrome",e.version=Pb(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))e.browser="edge",e.version=Pb(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else {if(!window.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return e.browser="Not a supported browser.",e;e.browser="safari",e.version=Pb(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=window.RTCRtpTransceiver&&"currentDirection"in window.RTCRtpTransceiver.prototype;}return e;},qb=function(){function e(t,n,r){u(this,e),d(this,"_count",0),this._ctx=t,this._endpoint=n,this._sendStatsLogCommand=r;}return l(e,[{key:"_interval",get:function(){return "master"===this._endpoint.type?3e3:15e3;}},{key:"_insertInfo",value:function(){var e=this._endpoint;Object.assign(this._accumulated,{app_id:this._ctx.appId,browser_type:Fb(),endpoint_id:e.id,live_event_id:this._ctx.liveEventId,device_timestamp:new Date().getTime(),user_id:this._ctx.userId,live_event_user_id:this._ctx.currentLiveUserId,attached_to:e.attachedTo,role:"master"===e.type?h_.HOST:h_.PARTICIPANT});}},{key:"insertStatsLog",value:function(e){var t=this._accumulated;this._count+=1;var n,r=SE(e,t);(this._accumulated=function(e,t,n){var r=TE(e);if(n<=1||!t)return r;var i=1/n,s=1/(n-1);function o(e){return "audio"===e?function(e){r.audio[e]=CE(r.audio[e],t.audio[e]);}:function(e){r.video[e]=CE(r.video[e],t.video[e]);};}function a(e){return "audio"===e?function(e){r.audio[e]=kE(r.audio[e],t.audio[e],["rtt","mos"].includes(e)?s:i);}:function(e){r.video[e]=kE(r.video[e],t.video[e],["rtt","mos"].includes(e)?s:i);};}function u(e){return "audio"===e?function(e){r.audio[e]=t.audio[e];}:function(e){r.video[e]=t.video[e];};}return u("audio")("codec"),a("audio")("rtt"),a("audio")("jitter"),o("audio")("packets_lost"),a("audio")("packets_lost_rate"),o("audio")("remote_packets_lost"),a("audio")("remote_packets_lost_rate"),u("video")("codec"),a("video")("rtt"),o("video")("packets_lost"),a("video")("packets_lost_rate"),o("video")("remote_packets_lost"),a("video")("remote_packets_lost_rate"),a("video")("video_source_width"),a("video")("video_source_height"),a("video")("video_source_frames_per_second"),a("video")("received_frame_width"),a("video")("received_frame_height"),a("video")("sent_frame_width"),a("video")("sent_frame_height"),r;}(r,this._accumulated,this._count),this._count%(this._interval/1e3)==0)&&(this._insertInfo(),null===(n=this._sendStatsLogCommand)||void 0===n||n.call(this,this._accumulated),delete this._accumulated,this._count=0);}},{key:"getAccumulatedStats",value:function(){return this._accumulated;}}]),e;}(),Hb=l(function e(t){u(this,e),Object.assign(this,t);}),jb=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),(i=t.call(this))._type=e,i._hasVideoTrack=r,i._prevStats=null,i._prevMetrics=null,i._startDispatchInterval(),i;}return l(n,[{key:"insertStatsLog",value:function(e){var t,n,r=this._prevStats;e?(t=SE(e,r),n=this._createMetricsFromStats(t)):n=new Hb({packetsLostRate:void 0,rtt:void 0,jitter:void 0}),this._prevStats=t,this._prevMetrics=n;}},{key:"_createMetricsFromStats",value:function(e){switch(this._type){case"master":return new Hb({packetsLostRate:this._hasVideoTrack?e.video.remote_packets_lost_rate:e.audio.remote_packets_lost_rate,rtt:this._hasVideoTrack?e.video.rtt:e.audio.rtt});case"viewer":return new Hb({packetsLostRate:e.audio.packets_lost_rate,jitter:e.audio.jitter});default:throw new Error("inappropriate endpoint type is injected.");}}},{key:"onReconnecting",value:function(){this.insertStatsLog(void 0);}},{key:"onEnded",value:function(){this._stopDispatchInterval();}},{key:"_startDispatchInterval",value:function(){var e=this;this._dispatchIntervalId=setInterval(function(){e._dispatchIfExist();},3e3);}},{key:"_stopDispatchInterval",value:function(){this._dispatchIntervalId&&(clearInterval(this._dispatchIntervalId),delete this._dispatchIntervalId);}},{key:"_dispatchIfExist",value:function(){var e=this._prevMetrics;e&&this._dispatchEvent("updated",e);}}]),n;}(im),Vb=function(){function e(t,n){var r=this;u(this,e),this._ctx=t,this._endpoint=n;this._collector=new qb(t,n,function(e){var t=Dy.createStatsLogCommand(e);return r._ctx.sender.send(t);}),this._connectionQuality=new jb(this._endpoint.type,this.hasVideoTrack);}return l(e,[{key:"hasVideoTrack",get:function(){return "none"!==this._ctx.masterSessionDirection.video;}},{key:"startGetWebRtcStats",value:function(e){var t=this;this._statsIntervalId||(this._statsIntervalId=setInterval(function(){e.getStatsLog().then(function(e){t._collector.insertStatsLog(e),t._connectionQuality.insertStatsLog(e);});},1e3));}},{key:"stopGetWebRtcStats",value:function(){this._statsIntervalId&&(clearInterval(this._statsIntervalId),delete this._statsIntervalId);}},{key:"getAccumulatedStats",value:function(){return this._collector.getAccumulatedStats();}},{key:"setConnectionQualityListener",value:function(e){this.removeConnectionQualityListener(),this._connectionQuality.on("updated",function(t){e(t);});}},{key:"removeConnectionQualityListener",value:function(){this._connectionQuality.removeAllEventListeners();}},{key:"onReconnecting",value:function(){this._connectionQuality.onReconnecting();}},{key:"onEnded",value:function(){this._connectionQuality.onEnded();}}]),e;}(),Gb=function(e){h(n,e);var t=E(n);function n(e,r,i,s){var o;return u(this,n),d(g(o=t.call(this)),"tmpId",z()),d(g(o),"_createSession",function(){switch(lp.debug("_createSession()"),o.type){case"master":o._createMasterSession();break;case"viewer":o._createViewerSession();break;default:lp.error("Not supported endpoint type : ",o.type);}}),d(g(o),"_closePeerConnection",function(){var e,t;lp.debug("_closePeerConnection()"),o._stopGetWebRtcStats(),null===(e=o._pc)||void 0===e||e.removeAllEventListeners(),null===(t=o._pc)||void 0===t||t.close(),o._pc=null;}),d(g(o),"_requestCreateOrPutEndpoint",function(){lp.debug("_requestCreateOrPutEndpoint()");var e,t=o._pc;e=o.id?t.signalingClient.registerPutEndpointRequest():t.signalingClient.registerCreateEndpointRequest(),t.createOffer(),e.promise.then(function(e){o.id=e.payload.endpoint.id,o._stateMachine.onEndpointRequestSucceeded(e.payload.sdp);}).catch(function(e){lp.error("Endpoint request failed",e),o._stateMachine.onEndpointRequestFailed();});}),d(g(o),"_requestAttach",function(){QE(new YE(5e3,1e3,8),function(){return o._sendAttach(o.attachedTo);},{onError:function(e){lp.error("Fail attach endpoint endpointId = ".concat(o.id,", to = ").concat(o.attachedTo," ErrorCode = ").concat(e.code));}}).then(function(){o._dispatchEvent("attached",o.attachedTo);});}),d(g(o),"_requestRelease",function(){lp.debug("_requestRelease()"),o._sendReleaseEndpoint().then(function(){o._stateMachine.onReleased();}).catch(function(e){lp.error("Release request failed",e),o._stateMachine.onReleased();});}),d(g(o),"_setRemoteDescription",function(e){lp.debug("_setRemoteDescription()");var t=o._pc,n=vb.createAnswer(void 0,e);t.onEvent(n),t.once("connected",function(){o._stateMachine.onPCConnected(),o._sendConnected(),o._startGetWebRtcStats();}),t.once("iceFailed",function(){o._stateMachine.onICEFailed();});}),o._ctx=e,o._localStream=r,o._participantId=s,o.type=i,o._stateMachine=new cb({endpoint:g(o),dispatchEvent:o._dispatchEvent.bind(g(o)),createSession:o._createSession,requestCreateOrPutEndpoint:o._requestCreateOrPutEndpoint,setRemoteDescription:o._setRemoteDescription,closePeerConnection:o._closePeerConnection,requestAttach:o._requestAttach,requestRelease:o._requestRelease,trialCount:0,reconnectCount:0}),o._logManager=new Vb(o._ctx,g(o)),o;}return l(n,[{key:"remoteStream",get:function(){var e;return null===(e=this._pc)||void 0===e?void 0:e.remoteStream;}},{key:"_state",get:function(){return this._stateMachine.state;}},{key:"_masterSessionDirection",get:function(){return this._ctx.masterSessionDirection;}},{key:"_viewerSessionDirection",get:function(){return this._ctx.viewerSessionDirection;}},{key:"getAccumulatedStats",value:function(){return this._logManager.getAccumulatedStats();}},{key:"setConnectionQualityListener",value:function(e){this._logManager.setConnectionQualityListener(e);}},{key:"removeConnectionQualityListener",value:function(){this._logManager.removeConnectionQualityListener();}},{key:"attach",value:function(e){lp.debug("attach()"),this.attachedTo=e,this._stateMachine.onAttach();}},{key:"release",value:function(){lp.debug("release()"),this._stateMachine.onRelease();}},{key:"exit",value:function(){lp.debug("exit()"),this._closePeerConnection(),this._stateMachine.onExit();}},{key:"_createMasterSession",value:function(){lp.debug("_createMasterSession()"),this._pc&&this._closePeerConnection(),this._createPeerConnection(this._masterSessionDirection,this._localStream);}},{key:"_createViewerSession",value:function(){lp.debug("_createViewerSession()"),this._pc&&this._closePeerConnection(),this._createPeerConnection(this._viewerSessionDirection,void 0);}},{key:"_createPeerConnection",value:function(e,t){var n=this;lp.debug("_createPeerConnection()");var r=new XE(this._ctx,this._participantId,e,this.id);this._pc=new BE(this._ctx,void 0,r,t,!0,void 0,e,!0),this._pc.on("remoteStream",function(e){n._dispatchEvent("remoteStream",e);}),this._dispatchEvent("pcChanged",this._pc);}},{key:"_startGetWebRtcStats",value:function(){this._logManager.startGetWebRtcStats(this._pc);}},{key:"_stopGetWebRtcStats",value:function(){this._logManager.stopGetWebRtcStats(),this._logManager.onEnded();}},{key:"_sendConnected",value:function(){return this._ctx.sendConnected(this);}},{key:"_sendReleaseEndpoint",value:function(){return this._ctx.sendReleaseEndpoint(this);}},{key:"_sendAttach",value:function(e){return this._ctx.sendAttach(this,e);}},{key:"onReconnecting",value:function(){this._logManager.onReconnecting();}}]),n;}(im),zb=Rt,Bb=Kt,Kb=Ec,Qb=nc,Wb=Xl;As({target:"Promise",stat:!0,forced:id},{allSettled:function(e){var t=this,n=Kb.f(t),r=n.resolve,i=n.reject,s=Qb(function(){var n=Bb(t.resolve),i=[],s=0,o=1;Wb(e,function(e){var a=s++,u=!1;o++,zb(n,t,e).then(function(e){u||(u=!0,i[a]={status:"fulfilled",value:e},--o||r(i));},function(e){u||(u=!0,i[a]={status:"rejected",reason:e},--o||r(i));});}),--o||r(i);});return s.error&&i(s.value),n.promise;}});var Yb=function(e){return e.TOP_LEFT="top_left",e.TOP_RIGHT="top_right",e.BOTTOM_LEFT="bottom_left",e.BOTTOM_RIGHT="bottom_right",e.HIDDEN="hidden",e;}({}),Zb=function(e){h(r,e);var t,n=E(r);function r(){return u(this,r),n.call(this);}return l(r,[{key:"stream",get:function(){return this._stream;}},{key:"isSharing",get:function(){return !!this._stream;}},{key:"startStream",value:(t=a(i().mark(function e(){var t,n=this;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0});case 3:t=e.sent,this._stream=t,this._stream.getVideoTracks()[0].onended=function(){n._releaseStream(),n._dispatchEvent("streamStopped");},e.next=19;break;case 8:e.prev=8,e.t0=e.catch(0),e.t1=e.t0.name,e.next="InvalidStateError"===e.t1?13:"NotAllowedError"===e.t1?14:"NotFoundError"===e.t1?15:"NotReadableError"===e.t1?16:17;break;case 13:case 14:case 15:case 16:return e.abrupt("break",18);case 17:throw new Error("");case 18:throw new Error("failed to start screen share");case 19:case"end":return e.stop();}},e,this,[[0,8]]);})),function(){return t.apply(this,arguments);})},{key:"stopStream",value:function(){this._releaseStream(),this._dispatchEvent("streamStopped");}},{key:"_releaseStream",value:function(){if(this._stream){var e,t=T(this._stream.getTracks());try{for(t.s();!(e=t.n()).done;){e.value.stop();}}catch(e){t.e(e);}finally{t.f();}delete this._stream;}}}]),r;}(im),Xb=null;function Jb(e,t){var n=[];Xb||(Xb=new(window.AudioContext||window.webkitAudioContext)());var r=Xb.createGain();if(r.gain.value=1,e){var i=new MediaStream();i.addTrack(e),n.push(Xb.createMediaStreamSource(i).connect(r));}if(t){var s=new MediaStream();s.addTrack(t),n.push(Xb.createMediaStreamSource(s).connect(r));}for(var o=Xb.createMediaStreamDestination(),a=0,u=n;a<u.length;a++){u[a].connect(o);}return o.stream.getAudioTracks()[0];}var $b=function(e){h(f,e);var t,n,r,s,o,c=E(f);function f(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{audio:!0,video:!0},r=arguments.length>2?arguments[2]:void 0;return u(this,f),d(g(t=c.call(this)),"isCustomStreaming",!1),d(g(t),"_checkScreenSharePrerequisites",function(){if(!navigator.mediaDevices.getDisplayMedia)throw new Error("screen share is not supported in this browser");}),t._deviceManager=e,t._mediaConstraints=n,t._screenShareOptions=r,t._screenShare=new Zb(),t._screenShare.on("streamStopped",function(){t._releaseMergedStream(),t._dispatchEvent("screenShareStreamStopped");}),t;}return l(f,[{key:"mediaConstraints",set:function(e){this._mediaConstraints=e;}},{key:"screenShareOptions",set:function(e){var t=this;this._screenShareOptions=e,this._screenShare.isSharing&&null!=e&&e.frameRate&&(this._releaseMergedStream(!1),this._mergeOverlayingScreenShareStream().then(function(){t._dispatchEvent("streamChanged",t.localStream);}));}},{key:"hasPermission",get:function(){var e;return null===(e=this._mediaAccess)||void 0===e?void 0:e.hasPermission;}},{key:"localStream",get:function(){return this.isCustomStreaming?this._customStream:this.isScreenSharing?this._mergedStream:this.getLocalMediaStream();}},{key:"mergedStream",get:function(){return this._mergedStream;}},{key:"screenStream",get:function(){return this._screenShare.stream;}},{key:"customStream",get:function(){return this._customStream;}},{key:"isScreenSharing",get:function(){return this._screenShare.isSharing;}},{key:"useScreenStream",value:(o=a(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._checkScreenSharePrerequisites(),e.next=3,this._screenShare.startStream();case 3:this._mergeScreenShareStream(),this._dispatchEvent("streamChanged",this.localStream);case 5:case"end":return e.stop();}},e,this);})),function(){return o.apply(this,arguments);})},{key:"stopScreenShare",value:function(){this._screenShare.isSharing&&this._screenShare.stopStream();}},{key:"startOverlayingScreenStream",value:(s=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t&&(this._screenShareOptions=t),this._checkScreenSharePrerequisites(),e.next=4,this._screenShare.startStream();case 4:return e.next=6,this._mergeOverlayingScreenShareStream();case 6:this._dispatchEvent("streamChanged",this.localStream);case 7:case"end":return e.stop();}},e,this);})),function(e){return s.apply(this,arguments);})},{key:"startUsingExternalVideo",value:(r=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this._streamProcessor=t,e.next=4,this._applyStreamProcessor();case 4:this.isCustomStreaming=!0,this._dispatchEvent("streamChanged",this.localStream),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),lp.error("failed to use custom stream",e.t0);case 11:case"end":return e.stop();}},e,this,[[0,8]]);})),function(e){return r.apply(this,arguments);})},{key:"stopUsingExternalVideo",value:function(){this.isCustomStreaming&&(this._releaseCustomStream(!1),this.isCustomStreaming=!1,this._dispatchEvent("streamChanged",this.localStream));}},{key:"getLocalMediaStream",value:function(){return this._mediaAccess||this._grantMediaAccess(this._mediaConstraints),this._mediaAccess.stream;}},{key:"revokeMediaAccess",value:function(){this._mediaAccess&&(this._mediaAccess.dispose(),this._mediaAccess=null);}},{key:"release",value:function(){this.stopScreenShare(),this.revokeMediaAccess();}},{key:"_grantMediaAccess",value:function(e){var t=this;this._mediaAccess=this._deviceManager.useMedia(e);var n=[];this._mediaAccess.on("streamChanged",function(){t._screenShare.isSharing&&n.push(t._mergeOverlayingScreenShareStream()),t.isCustomStreaming&&n.push(t._applyStreamProcessor()),n.length>0?Promise.allSettled(n).then(function(){return t._dispatchEvent("streamChanged",t.localStream);}):t._dispatchEvent("streamChanged",t.localStream);}),this._mediaAccess.on("audioOutputChanged",function(){return t._dispatchEvent("audioOutputChanged");});}},{key:"_mergeScreenShareStream",value:function(){if(this._screenShare.isSharing){var e=new MediaStream();this._mediaAccess.stream&&this._mediaAccess.stream.getAudioTracks().length>0&&e.addTrack(this._mediaAccess.stream.getAudioTracks()[0]),e.addTrack(this.screenStream.getVideoTracks()[0]),this._mergedStream=e;}}},{key:"_mergeOverlayingScreenShareStream",value:(n=a(i().mark(function e(){var t,n,r,s,o,a,u,c,l,d,h,f,p,v=this;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._screenShare.isSharing){e.next=2;break;}return e.abrupt("return");case 2:return n=!1,r=document.createElement("canvas"),(s=document.createElement("video")).srcObject=this.screenStream,s.muted=!0,e.next=9,s.play();case 9:return (o=document.createElement("video")).srcObject=this.getLocalMediaStream(),o.muted=!0,e.next=14,o.play();case 14:a=s.videoWidth,u=s.videoHeight,r.width=a,r.height=u,c=r.getContext("2d"),l=setInterval(function(){var e;if(!n){n=!0;var t=s.videoWidth,i=s.videoHeight,l=o.videoWidth,d=o.videoHeight;(u<i||a<t)&&(a=t,u=i,r.width=t,r.height=i,c.fillRect(0,0,a,u)),s.width=t,s.height=i,c.drawImage(s,0,0,t,i);var h=v.enumToPosition(null===(e=v._screenShareOptions)||void 0===e?void 0:e.cameraOverlayPosition,l,d,r.width,r.height),f=h.dx,p=h.dy,_=h.dw,y=h.dh;c.drawImage(o,f,p,_,y),n=!1;}},null!==(t=this._screenShareOptions)&&void 0!==t&&t.frameRate?1e3/this._screenShareOptions.frameRate:1e3/24),d=r.captureStream(),this.mergeInterval=l,this._mediaAccess.stream&&this._mediaAccess.stream.getAudioTracks().length>0&&(h=this._mediaAccess.stream.getAudioTracks()[0]),this.screenStream&&this.screenStream.getAudioTracks().length>0&&(f=this.screenStream.getAudioTracks()[0]),p=Jb(h,f),d.addTrack(p),this._mergedStream=d;case 27:case"end":return e.stop();}},e,this);})),function(){return n.apply(this,arguments);})},{key:"_applyStreamProcessor",value:(t=a(i().mark(function e(){var t;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=this._mediaAccess)||void 0===t||!t.stream){e.next=4;break;}return e.next=3,this._streamProcessor(this._mediaAccess.stream);case 3:this._customStream=e.sent;case 4:case"end":return e.stop();}},e,this);})),function(){return t.apply(this,arguments);})},{key:"_releaseMergedStream",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._mergedStream&&(this._mergedStream.removeTrack(this._mergedStream.getAudioTracks()[0]),delete this._mergedStream,this.mergeInterval&&(clearInterval(this.mergeInterval),delete this.mergeInterval),e&&this._dispatchEvent("streamChanged",this.localStream));}},{key:"_releaseCustomStream",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._customStream&&(delete this._customStream,delete this._streamProcessor,e&&this._dispatchEvent("streamChanged",this.localStream));}},{key:"enumToPosition",value:function(e,t,n,r,i){var s=t/n,o=.2*i,a=.2*r*(1/s),u=Math.min(o,a),c=u*s,l=Math.min(.05*r,.05*i),d=r-c-l,h=i-u-l;switch(e){case Yb.HIDDEN:return {dx:0,dy:0,dw:0,dh:0};case Yb.TOP_LEFT:return {dx:l,dy:l,dw:c,dh:u};case Yb.TOP_RIGHT:return {dx:d,dy:l,dw:c,dh:u};case Yb.BOTTOM_LEFT:return {dx:l,dy:h,dw:c,dh:u};case Yb.BOTTOM_RIGHT:default:return {dx:d,dy:h,dw:c,dh:u};}}}]),f;}(im),ew=function(){function e(t,n,r,i,s){u(this,e),this._liveEvent=t,this._sender=r,this._deviceManager=n,this._mediaOption=i,this._screenShareOptions=s;}var t,n,r,s,o;return l(e,[{key:"mediaView",get:function(){return this._mediaView;},set:function(e){this._mediaView!==e&&(this._mediaView&&(this._mediaView=null),e?this.isHostStream?this._mediaView=this._updateMediaViewStream(e,this.localStream):this._mediaView=this._updateMediaViewStream(e,this.remoteStream):delete this._mediaView);}},{key:"localStream",get:function(){var e;return null===(e=this._localStream)||void 0===e?void 0:e.localStream;}},{key:"remoteStream",get:function(){var e;return null===(e=this._endpoint)||void 0===e?void 0:e.remoteStream;}},{key:"isHostStream",get:function(){return this._mediaOption;}},{key:"_masterSessionDirection",get:function(){return this._liveEvent.hostType===Fh.SINGLE_HOST_AUDIO_ONLY?{audio:"sendonly",video:"none"}:{audio:"sendonly",video:"sendonly"};}},{key:"_viewerSessionDirection",get:function(){return this._liveEvent.hostType===Fh.SINGLE_HOST_AUDIO_ONLY?{audio:"recvonly",video:"none"}:{audio:"recvonly",video:"recvonly"};}},{key:"_createLocalStream",value:function(){var e=this;this._localStream=new $b(this._deviceManager,{audio:!0,video:this._liveEvent.hostType!==Fh.SINGLE_HOST_AUDIO_ONLY},this._screenShareOptions),this._localStream.on("streamChanged",function(){e._onLocalStream();}),this._mediaOption.streamProcessor&&this._localStream.startUsingExternalVideo(this._mediaOption.streamProcessor);}},{key:"_createEndpoint",value:function(){var e=this;if(this.isHostStream)return this._localStream||this._createLocalStream(),new Gb({appId:this._liveEvent.appId,liveEventId:this._liveEvent.liveEventId,userId:this._liveEvent.userId,currentLiveUserId:this._liveEvent.currentLiveUser.liveUserId,masterSessionDirection:this._masterSessionDirection,viewerSessionDirection:this._viewerSessionDirection,sender:this._sender,sendConnected:this._sendConnected.bind(this),sendReleaseEndpoint:this._sendReleaseEndpoint.bind(this),sendAttach:this._sendAttach.bind(this),sendCreateEndpoint:this._sendCreateEndpoint.bind(this),sendPutEndpoint:this._sendPutEndpoint.bind(this)},this._localStream,"master",this._liveEvent.host.hostId);var t=new Gb({appId:this._liveEvent.appId,liveEventId:this._liveEvent.liveEventId,userId:this._liveEvent.userId,currentLiveUserId:this._liveEvent.currentLiveUser.liveUserId,masterSessionDirection:this._masterSessionDirection,viewerSessionDirection:this._viewerSessionDirection,sender:this._sender,sendConnected:this._sendConnected.bind(this),sendReleaseEndpoint:this._sendReleaseEndpoint.bind(this),sendAttach:this._sendAttach.bind(this),sendCreateEndpoint:this._sendCreateEndpoint.bind(this),sendPutEndpoint:this._sendPutEndpoint.bind(this)},void 0,"viewer",this._liveEvent.currentLiveUser.participantId);return t.on("remoteStream",function(t){e._onStream();}),t.on("connected",function(t){t&&e._onEndpointReconnected();}),t;}},{key:"openStream",value:function(){this._endpoint&&this._teardown(),this._endpoint=this._createEndpoint();}},{key:"closeStream",value:function(e){e&&(this._endpoint.release(),this._endpoint.removeAllEventListeners()),this._teardown();}},{key:"attach",value:function(e){this._endpoint.attach(e);}},{key:"toggleAudio",value:function(e){var t,n,r;null===(t=this.localStream.getAudioTracks())||void 0===t||t.forEach(function(t){t.enabled=e;}),null===(n=this._localStream.getLocalMediaStream())||void 0===n||null===(r=n.getAudioTracks())||void 0===r||r.forEach(function(t){t.enabled=e;}),this._mediaOption.turnAudioOn=e;}},{key:"toggleVideo",value:function(e){var t,n,r;null===(t=this.localStream.getVideoTracks())||void 0===t||t.forEach(function(t){t.enabled=e;}),null===(n=this._localStream.getLocalMediaStream())||void 0===n||null===(r=n.getVideoTracks())||void 0===r||r.forEach(function(t){t.enabled=e;}),this._mediaOption.turnVideoOn=e;}},{key:"startUsingExternalVideo",value:(o=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._localStream.startUsingExternalVideo(t);case 2:case"end":return e.stop();}},e,this);})),function(e){return o.apply(this,arguments);})},{key:"stopUsingExternalVideo",value:function(){this._localStream.stopUsingExternalVideo();}},{key:"startScreenShare",value:(s=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._screenShareOptions=t,e.next=3,this._localStream.startOverlayingScreenStream(t);case 3:case"end":return e.stop();}},e,this);})),function(e){return s.apply(this,arguments);})},{key:"stopScreenShare",value:function(){this._localStream.stopScreenShare();}},{key:"setScreenShareOptions",value:function(e){this._screenShareOptions=e,this._localStream&&(this._localStream.screenShareOptions=e);}},{key:"chooseMediaDevice",value:function(e,t){this._deviceManager.selectDevice(e,t);}},{key:"setConnectionQualityListener",value:function(e){var t=this;this._endpoint.setConnectionQualityListener(function(n){return e(t._liveEvent.host.hostId,n);});}},{key:"removeConnectionQualityListener",value:function(){this._endpoint.removeConnectionQualityListener();}},{key:"_onLocalStream",value:function(){this.toggleAudio(this._mediaOption.turnAudioOn),this.toggleVideo(this._mediaOption.turnVideoOn),this._mediaView&&this._updateMediaViewStream(this._mediaView,this.localStream);}},{key:"_onStream",value:function(){var e=this.remoteStream;this._mediaView&&this._updateMediaViewStream(this._mediaView,e);}},{key:"_onEndpointReconnected",value:function(){var e=this._endpoint;"viewer"===e.type&&e.attachedTo&&this.attach(e.attachedTo);}},{key:"_updateMediaViewStream",value:function(e,t){return t&&(e.srcObject=t),e;}},{key:"_sendConnected",value:(r=a(i().mark(function e(t){var n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.isHostStream?Dy.createHostConnected(this._liveEvent.liveEventId,this._liveEvent.host.hostId,t.id):Dy.createConnected(this._liveEvent.liveEventId,this._liveEvent.currentLiveUser.participantId,t.id),e.abrupt("return",this._sender.send(n));case 2:case"end":return e.stop();}},e,this);})),function(e){return r.apply(this,arguments);})},{key:"_sendReleaseEndpoint",value:function(e){var t;return t=this.isHostStream?Dy.createHostDeleteStream(this._liveEvent.liveEventId,this._liveEvent.host.hostId,e.id):Dy.createDeleteStream(this._liveEvent.liveEventId,this._liveEvent.currentLiveUser.participantId,e.id),this._sender.sendWithRetry(t);}},{key:"_sendAttach",value:function(e,t){var n=Dy.createAttach(this._liveEvent.liveEventId,this._liveEvent.currentLiveUser.participantId,e.id,t);return this._sender.sendWithRetry(n);}},{key:"_sendCreateEndpoint",value:(n=a(i().mark(function e(t){var n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isHostStream){e.next=5;break;}return n=Dy.createHostCreateStream(this._liveEvent.liveEventId,this._liveEvent.host.hostId,t.sdp,this._masterSessionDirection.audio,this._masterSessionDirection.video),e.abrupt("return",this._sender.send(n));case 5:return r=Dy.createStream(this._liveEvent.liveEventId,this._liveEvent.currentLiveUser.participantId,t.sdp,this._viewerSessionDirection.audio,this._viewerSessionDirection.video),e.abrupt("return",this._sender.send(r));case 7:case"end":return e.stop();}},e,this);})),function(e){return n.apply(this,arguments);})},{key:"_sendPutEndpoint",value:(t=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._sendReleaseEndpoint(this._endpoint);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),lp.error("failed to remove endpoint");case 8:return e.abrupt("return",this._sendCreateEndpoint(t));case 9:case"end":return e.stop();}},e,this,[[0,5]]);})),function(e){return t.apply(this,arguments);})},{key:"_teardown",value:function(){var e,t;null===(e=this._endpoint)||void 0===e||e.exit(),null===(t=this._endpoint)||void 0===t||t.removeAllEventListeners(),this._endpoint=null;}}]),e;}(),tw=function(e){return e[e.ERR_REQUEST_FAILED=1800200]="ERR_REQUEST_FAILED",e[e.ERR_WEBSOCKET_CONNECTION_NOT_OPENED=1800201]="ERR_WEBSOCKET_CONNECTION_NOT_OPENED",e[e.ERR_WEBSOCKET_CONNECTION_FAILED=1800202]="ERR_WEBSOCKET_CONNECTION_FAILED",e[e.ERR_NO_RESPONSE_DUE_TO_TIMEOUT=1800203]="ERR_NO_RESPONSE_DUE_TO_TIMEOUT",e[e.ERR_REQUEST_FAILED_DUE_TO_WEBSOCKET_CONNECTION_LOST=1800204]="ERR_REQUEST_FAILED_DUE_TO_WEBSOCKET_CONNECTION_LOST",e[e.ERR_WRONG_RESPONSE=1800205]="ERR_WRONG_RESPONSE",e[e.ERR_QUERY_IN_PROGRESS=1800206]="ERR_QUERY_IN_PROGRESS",e[e.INTERNAL_SERVER_ERROR=1800207]="INTERNAL_SERVER_ERROR",e[e.ERR_MALFORMED_DATA=1800208]="ERR_MALFORMED_DATA",e[e.LIVE_EVENT_ID_NOT_FOUND=2800100]="LIVE_EVENT_ID_NOT_FOUND",e[e.ACTION_NOT_ALLOWED_IN_CURRENT_STATE=2800101]="ACTION_NOT_ALLOWED_IN_CURRENT_STATE",e[e.ACTION_NOT_ALLOWED_FOR_PARTICIPANT=2800102]="ACTION_NOT_ALLOWED_FOR_PARTICIPANT",e[e.USER_NOT_ENTERED_LIVE_EVENT=2800103]="USER_NOT_ENTERED_LIVE_EVENT",e[e.STREAM_NOT_STARTED=2800104]="STREAM_NOT_STARTED",e[e.CONNECTION_TO_MEDIA_STREAM_FAILED=2800105]="CONNECTION_TO_MEDIA_STREAM_FAILED",e[e.ACTION_NOT_ALLOWED_IN_CURRENT_HOST_TYPE=2800107]="ACTION_NOT_ALLOWED_IN_CURRENT_HOST_TYPE",e[e.UNKNOWN_NETWORK_ERROR=2800400]="UNKNOWN_NETWORK_ERROR",e[e.QUERY_IN_PROGRESS=2800900]="QUERY_IN_PROGRESS",e[e.OPEN_CHANNEL_NOT_FETCHED=2800901]="OPEN_CHANNEL_NOT_FETCHED",e;}({}),nw=function(){function e(){u(this,e);}return l(e,null,[{key:"getErrorMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.invalidParameter;var n=t.methodName,r=void 0===n?"":n;switch(e){case tw.LIVE_EVENT_ID_NOT_FOUND:return "The live event ID is not found.";case tw.ACTION_NOT_ALLOWED_IN_CURRENT_STATE:return "The user is trying to perform actions such as calling the ".concat(r,", ").concat(r,", ").concat(r," methods for a live event that is not in the 'ongoing' or 'ready' state.");case tw.ACTION_NOT_ALLOWED_FOR_PARTICIPANT:return "The participant is trying to perform actions that are only allowed for a host.";case tw.USER_NOT_ENTERED_LIVE_EVENT:return "The user is trying to perform actions on a live event without entering the event.";case tw.STREAM_NOT_STARTED:return "The user is trying to end a stream that doesn't exist.";case tw.CONNECTION_TO_MEDIA_STREAM_FAILED:return "The connection to media stream failed to establish.";case tw.ACTION_NOT_ALLOWED_IN_CURRENT_HOST_TYPE:return "The user is trying to perform actions such as calling the ".concat(r," methods for a live event that is not in the 'AUDIO_ONLY' host type.");case tw.UNKNOWN_NETWORK_ERROR:return "An unknown network error has occured.";case tw.QUERY_IN_PROGRESS:return "The last query is in progress.";case tw.OPEN_CHANNEL_NOT_FETCHED:return "The open channel for the live event is not fetched.";default:return "";}}}]),e;}(),rw=["message","error"],iw=function(e){h(n,e);var t=E(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=i.message,o=i.error,a=m(i,rw);u(this,n);var c=s||nw.getErrorMessage(e,a);return (r=t.call(this,c)).code=e,r._error=o,r;}return l(n);}(y(Error)),sw=function(e){h(O,e);var t,n,s,o,c,f,p,v,_,y,m,b,w,I,S,C,k,A,N=E(O);function O(e){var t,n=e.appId,r=e.deviceManager,i=e.sender,s=e.sb,o=e.userId,a=e.info;return u(this,O),d(g(t=N.call(this)),"_customItemsUpdatedAt",0),d(g(t),"_connectionQualityListener",function(e,n){var r,i;null===(r=(i=t)._internalConnectionQualityListener)||void 0===r||r.call(i,e,n);}),t._appId=n,t._deviceManager=r,t._sender=i,t._sb=s,t._userId=o,t._streams=new Map(),t._customItems=null,a&&Object.assign(g(t),a),t._unsubscriber=t._sender.on("command",function(e){t._onEvent(e);}),t;}return l(O,[{key:"appId",get:function(){return this._appId;}},{key:"userId",get:function(){return this._userId;}},{key:"customItems",get:function(){return r({},this._customItems);},set:function(e){this._customItems=e;}},{key:"myRole",get:function(){return this.userIdsForHost.includes(this._userId)?h_.HOST:h_.PARTICIPANT;}},{key:"isHost",get:function(){return this.myRole===h_.HOST;}},{key:"isActiveHost",get:function(){return this.isHost&&!(null==this||!this.currentLiveUser.isHost);}},{key:"isAudioOnly",get:function(){return this.hostType===Fh.SINGLE_HOST_AUDIO_ONLY;}},{key:"duration",get:function(){return this._duration>0?this._duration:Date.now()-this.startedAt;},set:function(e){this._duration=e;}},{key:"fetchOpenChannel",value:(A=a(i().mark(function e(){var t,n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._sb.openChannel.getChannelWithoutCache(this.liveEventId);case 2:return t=e.sent,n=this._sb.openChannel.buildOpenChannelFromSerializedData(t),this.openChannel=n,e.abrupt("return",n);case 6:case"end":return e.stop();}},e,this);})),function(){return A.apply(this,arguments);})},{key:"_getOpenChannel",value:(k=a(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.openChannel){e.next=2;break;}return e.abrupt("return",this.openChannel);case 2:return e.abrupt("return",this.fetchOpenChannel());case 3:case"end":return e.stop();}},e,this);})),function(){return k.apply(this,arguments);})},{key:"enterAsHost",value:(C=a(i().mark(function e(t){var n,r,s,o;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getOpenChannel();case 2:return n=e.sent,e.next=5,n.enter();case 5:return e.prev=5,e.next=8,this._sender.send(Dy.createEnterHost(this.liveEventId,t));case 8:r=e.sent,s=r.payload.host,t&&(o=new ew(this,this._deviceManager,this._sender,t,this._screenShareOptions),this._streams.set(s.hostId,o)),this.upsert({host:s}),this.upsert({currentLiveUser:s}),e.next=20;break;case 15:return e.prev=15,e.t0=e.catch(5),e.next=19,n.exit();case 19:throw e.t0;case 20:this._startToSendAlive();case 21:case"end":return e.stop();}},e,this,[[5,15]]);})),function(e){return C.apply(this,arguments);})},{key:"setEventReady",value:(S=a(i().mark(function e(){var t,n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isHost){e.next=2;break;}throw new Error("host only action");case 2:return e.next=4,this._sender.send(Dy.createReady(this.liveEventId));case 4:t=e.sent,n=t.payload.liveEvent,this.upsert(n);case 7:case"end":return e.stop();}},e,this);})),function(){return S.apply(this,arguments);})},{key:"startEvent",value:(I=a(i().mark(function e(t){var n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isHost){e.next=2;break;}throw new Error("host only action");case 2:return e.next=4,this._sender.send(Dy.createStart(this.liveEventId));case 4:n=e.sent,r=n.payload.liveEvent,this.upsert(r),!this.isHostStreaming&&this.isActiveHost&&this.startStreaming(t),"boolean"==typeof(null==t?void 0:t.turnAudioOn)&&this._toggleAudio(t.turnAudioOn),"boolean"==typeof(null==t?void 0:t.turnVideoOn)&&this._toggleVideo(t.turnVideoOn);case 10:case"end":return e.stop();}},e,this);})),function(e){return I.apply(this,arguments);})},{key:"startStreaming",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{turnAudioOn:!0,turnVideoOn:!0};if(!this.isActiveHost)throw new Error("current host only action");var t=this._streams.get(this.host.hostId);t||(t=new ew(this,this._deviceManager,this._sender,e,this._screenShareOptions),this._streams.set(this.host.hostId,t)),t.openStream(),t.setConnectionQualityListener(this._connectionQualityListener);}},{key:"endStreaming",value:function(){if(!this.isActiveHost)throw new Error("current host only action");var e=this._streams.get(this.host.hostId);e&&(this._streams.delete(this.host.hostId),e.closeStream(!0));}},{key:"createRTMPStream",value:(w=a(i().mark(function e(){var t,n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isHost){e.next=2;break;}throw new iw(tw.ACTION_NOT_ALLOWED_FOR_PARTICIPANT);case 2:return e.next=4,this._sender.send(Dy.createRTMPStream(this.liveEventId));case 4:return t=e.sent,n=t.payload.host,this.upsert({host:n}),e.abrupt("return",n.rtmpStream);case 8:case"end":return e.stop();}},e,this);})),function(){return w.apply(this,arguments);})},{key:"deleteRTMPStream",value:(b=a(i().mark(function e(){var t;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isHost){e.next=2;break;}throw new Error("host only action");case 2:if(null!==(t=this.host)&&void 0!==t&&t.rtmpStream){e.next=4;break;}throw new Error("no rtmp stream");case 4:return e.next=6,this._sender.send(Dy.deleteRTMPStream(this.liveEventId,this.host.rtmpStream.rtmpStreamId));case 6:e.sent,this.upsert({host:null});case 8:case"end":return e.stop();}},e,this);})),function(){return b.apply(this,arguments);})},{key:"exitAsHost",value:(m=a(i().mark(function e(){var t,n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isActiveHost){e.next=2;break;}throw new Error("current host only action");case 2:return t=this.host.hostId,e.next=5,this._sender.send(Dy.createExitHost(this.liveEventId,t));case 5:n=e.sent,r=n.payload.host,this.upsert({host:r}),this.teardown();case 9:case"end":return e.stop();}},e,this);})),function(){return m.apply(this,arguments);})},{key:"endEvent",value:(y=a(i().mark(function e(){var t,n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._sender.send(Dy.createEndLiveEvent(this.liveEventId));case 2:t=e.sent,n=t.payload.liveEvent,this.upsert(n),this.teardown();case 6:case"end":return e.stop();}},e,this);})),function(){return y.apply(this,arguments);})},{key:"muteAudioInput",value:function(){this._toggleAudio(!1);}},{key:"unmuteAudioInput",value:function(){this._toggleAudio(!0);}},{key:"_toggleAudio",value:function(e){if(!this.isActiveHost)throw new Error("current host only action");this._streams.get(this.host.hostId).toggleAudio(e),this._sender.send(Dy.createAudio(this.liveEventId,this.host.hostId,e));}},{key:"stopVideo",value:function(){if(this.isAudioOnly)throw new iw(tw.ACTION_NOT_ALLOWED_IN_CURRENT_HOST_TYPE,{methodName:"stopVideo"});this._toggleVideo(!1);}},{key:"startVideo",value:function(){if(this.isAudioOnly)throw new iw(tw.ACTION_NOT_ALLOWED_IN_CURRENT_HOST_TYPE,{methodName:"startVideo"});this._toggleVideo(!0);}},{key:"_toggleVideo",value:function(e){if(!this.isActiveHost)throw new Error("current host only action");this._streams.get(this.host.hostId).toggleVideo(e),this._sender.send(Dy.createVideo(this.liveEventId,this.host.hostId,e));}},{key:"selectAudioInput",value:function(e){if(!this.isActiveHost)throw new Error("current host only action");return this._deviceManager.selectDevice("audioinput",e);}},{key:"selectVideoInput",value:function(e){if(!this.isActiveHost)throw new Error("current host only action");if(this.isAudioOnly)throw new iw(tw.ACTION_NOT_ALLOWED_IN_CURRENT_HOST_TYPE,{methodName:"selectVideoInput"});return this._deviceManager.selectDevice("videoinput",e);}},{key:"enter",value:(_=a(i().mark(function e(){var t,n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getOpenChannel();case 2:return t=e.sent,e.next=5,t.enter();case 5:return e.prev=5,e.next=8,this._sender.send(Dy.createEnter(this.liveEventId));case 8:n=e.sent,r=n.payload.participant,this.upsert({currentLiveUser:r}),this._tryOpen(),e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(5),e.next=18,t.exit();case 18:throw e.t0;case 19:this._startToSendAlive();case 20:case"end":return e.stop();}},e,this,[[5,14]]);})),function(){return _.apply(this,arguments);})},{key:"exit",value:(v=a(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._sender.send(Dy.createExit(this.liveEventId,this.currentLiveUser.participantId));case 2:e.sent.payload.participant,this.teardown();case 5:case"end":return e.stop();}},e,this);})),function(){return v.apply(this,arguments);})},{key:"setVideoViewForLiveEvent",value:function(e,t){var n=this._streams.get(t);n&&(n.mediaView=e);}},{key:"setMediaViewForLiveEvent",value:function(e,t){var n=this._streams.get(t);n&&(n.mediaView=e);}},{key:"updateLiveEventInfo",value:(p=a(i().mark(function e(t){var n,r,s;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Dy.updateLiveEvent(this.liveEventId,t.userIdsForHost,t.title,t.coverUrl,t.coverFile),e.next=3,this._sender.send(n);case 3:r=e.sent,s=r.payload.liveEvent,this.upsert(s);case 6:case"end":return e.stop();}},e,this);})),function(e){return p.apply(this,arguments);})},{key:"fetchCustomItems",value:(f=a(i().mark(function e(){var t,n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Dy.createGetCustomItems(this.liveEventId),e.prev=1,e.next=4,this._sender.send(t);case 4:return n=e.sent,r=n.payload,this._setCustomItems(r.customItems),e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(1),lp.error("failed to update customItems"),e.t0;case 14:case"end":return e.stop();}},e,this,[[1,10]]);})),function(){return f.apply(this,arguments);})},{key:"updateCustomItems",value:(c=a(i().mark(function e(t){var n,r,s;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object.keys(t).some(function(e){return "string"!=typeof t[e];})){e.next=2;break;}throw new Error("invalid parameter");case 2:return n=Dy.createUpdateCustomItems(this.liveEventId,t),e.prev=3,e.next=6,this._sender.send(n);case 6:return r=e.sent,s=r.payload,this._setCustomItems(s.customItems,s.updatedAt),e.abrupt("return",s);case 12:throw e.prev=12,e.t0=e.catch(3),lp.error("failed to update customItems"),e.t0;case 16:case"end":return e.stop();}},e,this,[[3,12]]);})),function(e){return c.apply(this,arguments);})},{key:"deleteCustomItems",value:(o=a(i().mark(function e(t){var n,r,s;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.some(function(e){return "string"!=typeof e;})){e.next=2;break;}throw new Error("invalid parameter");case 2:return n=Dy.createDeleteCustomItems(this.liveEventId,t),e.prev=3,e.next=6,this._sender.send(n);case 6:return r=e.sent,s=r.payload,this._setCustomItems(s.customItems,s.deletedAt),e.abrupt("return",s);case 12:throw e.prev=12,e.t0=e.catch(3),lp.error("failed to delete customItems"),e.t0;case 16:case"end":return e.stop();}},e,this,[[3,12]]);})),function(e){return o.apply(this,arguments);})},{key:"deleteAllCustomItems",value:(s=a(i().mark(function e(){var t,n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Dy.createDeleteAllCustomItems(this.liveEventId),e.prev=1,e.next=4,this._sender.send(t);case 4:return n=e.sent,r=n.payload,this._setCustomItems(r.customItems,r.deletedAt),e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(1),lp.error("failed to delete all customItems"),e.t0;case 14:case"end":return e.stop();}},e,this,[[1,10]]);})),function(){return s.apply(this,arguments);})},{key:"startUsingExternalVideo",value:(n=a(i().mark(function e(t){var n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isActiveHost){e.next=2;break;}throw new Error("current host only action");case 2:if(!this.isAudioOnly){e.next=4;break;}throw new iw(tw.ACTION_NOT_ALLOWED_IN_CURRENT_HOST_TYPE,{methodName:"startUsingExternalVideo"});case 4:if(n=this._streams.get(this.host.hostId)){e.next=7;break;}throw new Error("no current stream");case 7:return e.next=9,n.startUsingExternalVideo(t);case 9:case"end":return e.stop();}},e,this);})),function(e){return n.apply(this,arguments);})},{key:"stopUsingExternalVideo",value:function(){if(!this.isActiveHost)throw new Error("current host only action");if(this.isAudioOnly)throw new iw(tw.ACTION_NOT_ALLOWED_IN_CURRENT_HOST_TYPE,{methodName:"stopUsingExternalVideo"});var e=this._streams.get(this.host.hostId);if(!e)throw new Error("no current stream");e.stopUsingExternalVideo();}},{key:"startScreenShare",value:(t=a(i().mark(function e(t){var n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isActiveHost){e.next=2;break;}throw new Error("current host only action");case 2:if(!this.isAudioOnly){e.next=4;break;}throw new iw(tw.ACTION_NOT_ALLOWED_IN_CURRENT_HOST_TYPE,{methodName:"startScreenShare"});case 4:if(n=this._streams.get(this.host.hostId)){e.next=7;break;}throw new Error("no current stream");case 7:return e.next=9,n.startScreenShare(t);case 9:case"end":return e.stop();}},e,this);})),function(e){return t.apply(this,arguments);})},{key:"stopScreenShare",value:function(){if(!this.isActiveHost)throw new Error("current host only action");if(this.isAudioOnly)throw new iw(tw.ACTION_NOT_ALLOWED_IN_CURRENT_HOST_TYPE,{methodName:"stopScreenShare"});var e=this._streams.get(this.host.hostId);if(!e)throw new Error("no current stream");e.stopScreenShare();}},{key:"setScreenShareOptions",value:function(e){this._screenShareOptions=e;var t=this._streams.get(this.host.hostId);t&&t.setScreenShareOptions(e);}},{key:"setConnectionQualityListener",value:function(e){this._internalConnectionQualityListener=e;}},{key:"removeConnectionQualityListener",value:function(){this._internalConnectionQualityListener=void 0;}},{key:"upsert",value:function(e){Object.assign(this,e),e.currentLiveUser&&(e.currentLiveUser.hostId?(this.currentLiveUser.isHost=!0,this.currentLiveUser.liveUserId=this.currentLiveUser.hostId):(this.currentLiveUser.isHost=!1,this.currentLiveUser.liveUserId=this.currentLiveUser.participantId));}},{key:"teardown",value:function(){var e;null===(e=this.openChannel)||void 0===e||e.exit();var t,n=T(this._streams.values());try{for(n.s();!(t=n.n()).done;){t.value.closeStream();}}catch(e){n.e(e);}finally{n.f();}this._streams.clear(),this._stopToSendAlive(),this.upsert({currentLiveUser:void 0});}},{key:"_setCustomItems",value:function(e,t){return (void 0===t||t>this._customItemsUpdatedAt)&&(this._customItemsUpdatedAt=t,this._customItems=e||{},!0);}},{key:"_onEvent",value:function(e){if(this.liveEventId===e.payload.liveEventId)if(e instanceof Q_)this._onReady(e);else if(e instanceof W_)this._onStarted(e);else if(e instanceof Y_)this._onEnded(e);else if(e instanceof _y)this._onUpdated(e);else if(e instanceof Z_)this._onHostEntered(e);else if(e instanceof X_)this._onHostExited(e);else if(e instanceof J_)this._onHostConnected(e);else if(e instanceof fy)this._onHostDisconnected(e);else if(e instanceof $_)this._onHostAudioStatusChanged(e);else if(e instanceof ey)this._onHostVideoStatusChanged(e);else if(e instanceof Ry)this._onParticipantCountChanged(e);else if(e instanceof Iy)this._onUpdateCustomItems(e);else {if(!(e instanceof Ty))throw new Error("unknown event is received");this._onDeleteCustomItems(e);}}},{key:"_onReady",value:function(e){var t=e.payload.liveEvent;this.upsert(t),this._dispatchEvent("liveEventReady",this);}},{key:"_onStarted",value:function(e){var t=e.payload.liveEvent;this.upsert(t),this._dispatchEvent("liveEventStarted",this),this._tryOpen();}},{key:"_onEnded",value:function(e){var t=e.payload.liveEvent;this.upsert(t),this._dispatchEvent("liveEventEnded",this),this.teardown();}},{key:"_onUpdated",value:function(e){var t=e.payload.liveEvent;this.upsert(t),this._dispatchEvent("liveEventUpdated",this);}},{key:"_onHostEntered",value:function(e){var t=e.payload.host;this.upsert({host:t}),this._dispatchEvent("hostEntered",this,this.host);}},{key:"_onHostExited",value:function(e){var t=e.payload.host;this.upsert({host:void 0}),this._dispatchEvent("hostExited",this,t);}},{key:"_onHostConnected",value:function(e){var t=e.payload.host;this.upsert({host:t}),this._dispatchEvent("hostConnected",this,this.host),this._tryOpen();}},{key:"_onHostDisconnected",value:function(e){var t=e.payload.host;this.upsert({host:t}),this._dispatchEvent("hostDisconnected",this,this.host);}},{key:"_onHostAudioStatusChanged",value:function(e){var t=e.payload.host;this.upsert({host:t}),t.isAudioOn&&this._dispatchEvent("hostUnmutedAudio",this,this.host),t.isAudioOn||this._dispatchEvent("hostMutedAudio",this,this.host);}},{key:"_onHostVideoStatusChanged",value:function(e){var t=e.payload.host;this.upsert({host:t}),t.isVideoOn&&this._dispatchEvent("hostStartedVideo",this,this.host),t.isVideoOn||this._dispatchEvent("hostStoppedVideo",this,this.host);}},{key:"_onParticipantCountChanged",value:function(e){var t=e.payload,n=t.participantCount,r=t.peakParticipantCount,i=t.cumulativeParticipantCount;this.upsert({participantCount:n,peakParticipantCount:r,cumulativeParticipantCount:i}),this._dispatchEvent("participantCountChanged",this,{participantCount:n,peakParticipantCount:r,cumulativeParticipantCount:i});}},{key:"_onUpdateCustomItems",value:function(e){var t=e.payload,n=t.customItems,r=t.updatedAt;t.updatedKeys,this._setCustomItems(n,r)&&this._dispatchEvent("customItemsUpdated",n,r);}},{key:"_onDeleteCustomItems",value:function(e){var t=e.payload,n=t.customItems,r=t.deletedAt;t.deletedKeys,this._setCustomItems(n,r)&&this._dispatchEvent("customItemsDeleted",n,r);}},{key:"onDisconnected",value:function(){this._dispatchEvent("disconnected",this,new iw(tw.LIVE_EVENT_ID_NOT_FOUND)),this.teardown();}},{key:"_tryOpen",value:function(){if(this.host&&this.currentLiveUser&&this.host.state===p_.CONNECTED&&this.state===f_.ONGOING){var e,t=this.host.hostId;this._streams.has(t)?e=this._streams.get(t):(e=new ew(this,this._deviceManager,this._sender),this._streams.set(t,e)),e.openStream(),e.setConnectionQualityListener(this._connectionQualityListener),e.attach(t);}}},{key:"_tryClose",value:function(){}},{key:"_startToSendAlive",value:function(){var e=this;this.isActiveHost?this._aliveIntervalId=setInterval(function(){var t=Dy.createHostAlive(e.liveEventId,e.host.hostId);e._sender.send(t);},3e3):this._aliveIntervalId=setInterval(function(){var t=Dy.createAlive(e.liveEventId,e.currentLiveUser.participantId);e._sender.send(t);},9e4);}},{key:"_stopToSendAlive",value:function(){this._aliveIntervalId&&(clearInterval(this._aliveIntervalId),delete this._aliveIntervalId);}}]),O;}(im),ow=function(e,t){return ow=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);},ow(e,t);};function aw(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e;}ow(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n());}var uw=function(){return uw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e;},uw.apply(this,arguments);};function cw(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{u(r.next(e));}catch(e){s(e);}}function a(e){try{u(r.throw(e));}catch(e){s(e);}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t);})).then(o,a);}u((r=r.apply(e,t||[])).next());});}function lw(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1];},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this;}),s;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue;}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break;}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break;}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break;}i[2]&&o.ops.pop(),o.trys.pop();continue;}a=t.call(e,o);}catch(e){a=[6,e],r=0;}finally{n=i=0;}if(5&a[0])throw a[1];return {value:a[0]?a[1]:void 0,done:!0};}([a,u]);};}}function dw(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return {next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e};}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.");}function hw(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-->0)&&!(r=s.next()).done;)o.push(r.value);}catch(e){i={error:e};}finally{try{r&&!r.done&&(n=s.return)&&n.call(s);}finally{if(i)throw i.error;}}return o;}function fw(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t));}"function"==typeof SuppressedError&&SuppressedError;var pw,vw="4.9.7",_w=function(){function e(){}return Object.defineProperty(e,"OS_VERSION",{get:function(){return "undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent";},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_VERSION",{get:function(){return vw;},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_MAJOR_VERSION",{get:function(){return e.SDK_VERSION.split(".")[0];},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100;},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INTERNAL_CALL",{get:function(){return "ic";},enumerable:!1,configurable:!0}),e;}();!function(e){e[e.STAT_LOG_NOT_ALLOWED=400108]="STAT_LOG_NOT_ALLOWED",e[e.NON_AUTHORIZED=400108]="NON_AUTHORIZED",e[e.INVALID_TOKEN=400111]="INVALID_TOKEN",e[e.NOT_FOUND_IN_DATABASE=400201]="NOT_FOUND_IN_DATABASE",e[e.USER_AUTH_DEACTIVATED=400300]="USER_AUTH_DEACTIVATED",e[e.USER_AUTH_DELETED_OR_NOT_FOUND=400301]="USER_AUTH_DELETED_OR_NOT_FOUND",e[e.SESSION_TOKEN_EXPIRED=400302]="SESSION_TOKEN_EXPIRED",e[e.SESSION_KEY_EXPIRED=400309]="SESSION_KEY_EXPIRED",e[e.SESSION_REVOKED=400310]="SESSION_REVOKED",e[e.STAT_UPLOAD_NOT_ALLOWED=403200]="STAT_UPLOAD_NOT_ALLOWED",e[e.INTERNAL_SERVER_ERROR=500901]="INTERNAL_SERVER_ERROR",e[e.RATE_LIMIT_EXCEEDED=500910]="RATE_LIMIT_EXCEEDED",e[e.UNKNOWN_SERVER_ERROR=900200]="UNKNOWN_SERVER_ERROR",e[e.DEBUG_MODE_REQUIRED=7e5]="DEBUG_MODE_REQUIRED",e[e.LOST_INSTANCE=700100]="LOST_INSTANCE",e[e.CONNECTION_RENEW=700102]="CONNECTION_RENEW",e[e.INVALID_CONNECTION_STATE_TRANSITION=700200]="INVALID_CONNECTION_STATE_TRANSITION",e[e.INVALID_COMMAND=700700]="INVALID_COMMAND",e[e.UNKNOWN_ERROR=77e4]="UNKNOWN_ERROR",e[e.INVALID_INITIALIZATION=800100]="INVALID_INITIALIZATION",e[e.CONNECTION_REQUIRED=800101]="CONNECTION_REQUIRED",e[e.CONNECTION_CANCELED=800102]="CONNECTION_CANCELED",e[e.INVALID_PARAMETER=800110]="INVALID_PARAMETER",e[e.NOT_SUPPORTED_ERROR=800111]="NOT_SUPPORTED_ERROR",e[e.NETWORK_ERROR=800120]="NETWORK_ERROR",e[e.NETWORK_ROUTING_ERROR=800121]="NETWORK_ROUTING_ERROR",e[e.MALFORMED_DATA=800130]="MALFORMED_DATA",e[e.MALFORMED_ERROR_DATA=800140]="MALFORMED_ERROR_DATA",e[e.WRONG_CHANNEL_TYPE=800150]="WRONG_CHANNEL_TYPE",e[e.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160]="MARK_AS_READ_RATE_LIMIT_EXCEEDED",e[e.QUERY_IN_PROGRESS=800170]="QUERY_IN_PROGRESS",e[e.ACK_TIMEOUT=800180]="ACK_TIMEOUT",e[e.LOGIN_TIMEOUT=800190]="LOGIN_TIMEOUT",e[e.WEBSOCKET_CONNECTION_CLOSED=800200]="WEBSOCKET_CONNECTION_CLOSED",e[e.WEBSOCKET_CONNECTION_FAILED=800210]="WEBSOCKET_CONNECTION_FAILED",e[e.REQUEST_FAILED=800220]="REQUEST_FAILED",e[e.FILE_UPLOAD_CANCEL_FAILED=800230]="FILE_UPLOAD_CANCEL_FAILED",e[e.REQUEST_CANCELED=800240]="REQUEST_CANCELED",e[e.REQUEST_DUPLICATED=800250]="REQUEST_DUPLICATED",e[e.FILE_SIZE_LIMIT_EXCEEDED=800260]="FILE_SIZE_LIMIT_EXCEEDED",e[e.SESSION_TOKEN_REQUEST_FAILED=800500]="SESSION_TOKEN_REQUEST_FAILED",e[e.SESSION_TOKEN_REFRESHED=800501]="SESSION_TOKEN_REFRESHED",e[e.SESSION_TOKEN_REFRESH_FAILED=800502]="SESSION_TOKEN_REFRESH_FAILED",e[e.COLLECTION_DISPOSED=800600]="COLLECTION_DISPOSED",e[e.DATABASE_ERROR=800700]="DATABASE_ERROR";}(pw||(pw={}));var yw,mw,gw,Ew,bw,ww=function(e){return !(e instanceof Iw&&!e.shouldThrowOutside);},Iw=function(e){function t(n){var r=n.code,i=void 0===r?0:r,s=n.message,o=void 0===s?"":s,a=e.call(this,o)||this;return a.shouldThrowOutside=!1,a.name="SendbirdError",a.code=i,Object.setPrototypeOf(a,t.prototype),a;}return aw(t,e),Object.defineProperty(t.prototype,"isInvalidTokenError",{get:function(){return this.code===pw.INVALID_TOKEN;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===pw.SESSION_TOKEN_EXPIRED;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===pw.SESSION_KEY_EXPIRED;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionRevokedError",{get:function(){return this.code===pw.SESSION_REVOKED;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeactivedError",{get:function(){return this.code===pw.USER_AUTH_DEACTIVATED;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeletedOrNotFoundError",{get:function(){return this.code===pw.USER_AUTH_DELETED_OR_NOT_FOUND;},enumerable:!1,configurable:!0}),Object.defineProperty(t,"debugModeRequired",{get:function(){return new t({code:pw.DEBUG_MODE_REQUIRED,message:"Cannot run this operation in production mode."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"lostInstance",{get:function(){return new t({code:pw.LOST_INSTANCE,message:"Instance ID is missing. It should belong to an instance."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidCommand",{get:function(){return new t({code:pw.INVALID_COMMAND,message:"Cannot send invalid command."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"unknown",{get:function(){return new t({code:pw.UNKNOWN_ERROR,message:"Unknown error occurred."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRenew",{get:function(){return new t({code:pw.CONNECTION_RENEW,message:"Connection restarts."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidConnectionStateTransition",{get:function(){return new t({code:pw.INVALID_CONNECTION_STATE_TRANSITION,message:"Invalid connection state transition."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRequired",{get:function(){return new t({code:pw.CONNECTION_REQUIRED,message:"Connection is required."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionCanceled",{get:function(){return new t({code:pw.CONNECTION_CANCELED,message:"Connection is canceled."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidParameters",{get:function(){return new t({code:pw.INVALID_PARAMETER,message:"Invalid parameters."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"notSupportedError",{get:function(){return new t({code:pw.NOT_SUPPORTED_ERROR,message:"Given parameters are not supported."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"networkError",{get:function(){return new t({code:pw.NETWORK_ERROR,message:"There was a network error."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"markAsReadAllRateLimitExceeded",{get:function(){return new t({code:pw.MARK_AS_READ_RATE_LIMIT_EXCEEDED,message:"markAsRead rate limit exceeded."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"queryInProgress",{get:function(){return new t({code:pw.QUERY_IN_PROGRESS,message:"Query in progress."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"noAckTimeout",{get:function(){return new t({code:pw.ACK_TIMEOUT,message:"Command received no ack."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"loginTimeout",{get:function(){return new t({code:pw.LOGIN_TIMEOUT,message:"Connection timeout."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionClosed",{get:function(){return new t({code:pw.WEBSOCKET_CONNECTION_CLOSED,message:"Connection is closed. Please reconnect."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestFailed",{get:function(){return new t({code:pw.REQUEST_FAILED,message:"Request failed."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileUploadCanceled",{get:function(){return new t({code:pw.FILE_UPLOAD_CANCEL_FAILED,message:"File upload has been canceled."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestCanceled",{get:function(){return new t({code:pw.REQUEST_CANCELED,message:"Request has been canceled."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRefreshFailed",{get:function(){return new t({code:pw.SESSION_TOKEN_REFRESH_FAILED,message:"Failed to refresh the session key."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRequestFailed",{get:function(){return new t({code:pw.SESSION_TOKEN_REQUEST_FAILED,message:"Failed to get the session token."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseError",{get:function(){return new t({code:pw.DATABASE_ERROR,message:"Database error."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileSizeLimitExceededError",{get:function(){return new t({code:pw.FILE_SIZE_LIMIT_EXCEEDED,message:"File size exceeds the file size limit."});},enumerable:!1,configurable:!0}),t.prototype.throwOutside=function(){throw this.shouldThrowOutside=!0,this;},t;}(Error),Tw=[pw.CONNECTION_REQUIRED,pw.NETWORK_ERROR,pw.ACK_TIMEOUT,pw.WEBSOCKET_CONNECTION_CLOSED,pw.WEBSOCKET_CONNECTION_FAILED,pw.FILE_UPLOAD_CANCEL_FAILED,pw.REQUEST_CANCELED,pw.INTERNAL_SERVER_ERROR,pw.RATE_LIMIT_EXCEEDED,pw.UNKNOWN_SERVER_ERROR],Sw=[pw.WEBSOCKET_CONNECTION_CLOSED,pw.WEBSOCKET_CONNECTION_FAILED,pw.CONNECTION_REQUIRED],Cw=function(e,t){if(e!==t){var n=uw({},e),r=uw({},t);return !(n.hasOwnProperty("messageId")&&r.hasOwnProperty("messageId")&&n.messageId!==r.messageId||n.hasOwnProperty("reqId")&&r.hasOwnProperty("reqId")&&n.reqId!==r.reqId||(n.hasOwnProperty("messageId")&&delete n.messageId,n.hasOwnProperty("reqId")&&delete n.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(n)!==JSON.stringify(r)));}return !0;},kw=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||("string"!=typeof e?"object"==typeof e?Aw(e,t):Nw(e,t):typeof t===e);},Aw=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||Object.values(e).includes(t);},Nw=function(e,t){return t instanceof e;},Ow=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||Array.isArray(t)&&t.every(function(t){return kw(e,t);});},Rw=function(e){return e>0&&Sw.indexOf(e)>=0;},Dw=function(e,t){if(void 0===t&&(t=!1),t&&null==e)return !0;var n="object"==typeof e&&null!==e&&e.hasOwnProperty("name")&&"string"==typeof e.name&&e.hasOwnProperty("uri")&&"string"==typeof e.uri&&e.hasOwnProperty("type")&&"string"==typeof e.type;if(!n){if("undefined"!=typeof Blob)return e instanceof Blob;if("undefined"!=typeof File)return e instanceof File;}return n;},xw=function(){function e(e){var t=void 0===e?{}:e,n=t.useMemberInfoInMessage,r=void 0===n||n,i=t.typingIndicatorInvalidateTime,s=void 0===i?1e4:i,o=t.typingIndicatorThrottle,a=void 0===o?1e3:o,u=t.websocketResponseTimeout,c=void 0===u?1e4:u,l=t.websocketPayloadDecompression,d=void 0===l||l,h=t.sessionTokenRefreshTimeout,f=void 0===h?60:h;this._useMemberInfoInMessage=!0,this._typingIndicatorInvalidateTime=1e4,this._typingIndicatorThrottle=1e3,this._websocketResponseTimeout=1e4,this._sessionTokenRefreshTimeout=60,this._useMemberInfoInMessage=r,this._typingIndicatorInvalidateTime=s,this._typingIndicatorThrottle=a,this._websocketResponseTimeout=c,this._sessionTokenRefreshTimeout=f,this.websocketPayloadDecompression=d;}return Object.defineProperty(e.prototype,"useMemberInfoInMessage",{get:function(){return this._useMemberInfoInMessage;},set:function(e){kw("boolean",e)&&(this._useMemberInfoInMessage=e);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorInvalidateTime",{get:function(){return this._typingIndicatorInvalidateTime;},set:function(e){kw("number",e)&&(this._typingIndicatorInvalidateTime=e);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorThrottle",{get:function(){return this._typingIndicatorThrottle;},set:function(e){kw("number",e)&&e>=1e3&&e<=9e3&&(this._typingIndicatorThrottle=e);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketResponseTimeout",{get:function(){return this._websocketResponseTimeout;},set:function(e){kw("number",e)&&e>=5e3&&e<=3e4&&(this._websocketResponseTimeout=e);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionTokenRefreshTimeout",{get:function(){return this._sessionTokenRefreshTimeout;},set:function(e){kw("number",e)&&(e<60?e=60:e>1800&&(e=1800),this._sessionTokenRefreshTimeout=e);},enumerable:!1,configurable:!0}),e;}(),Lw={encrypt:function(e){return e;},decrypt:function(e){return e;}},Mw=function(){function e(e){var t=e.store;this._preference=new Map(),this._store=t;}return e.prototype._savePreferenceKeys=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._store.set({key:this._keysAddress,value:fw([],hw(this._preference.keys()),!1)})];case 1:return e.sent(),[2];}});});},e.prototype.init=function(e,t){var n;return void 0===t&&(t=1),cw(this,void 0,void 0,function(){var r,i,s,o,a,u,c,l,d,h;return lw(this,function(f){switch(f.label){case 0:return this._version=t,this._keysAddress=e,r="".concat(e,".metadata.version"),[4,this._store.get(r)];case 1:return i=f.sent(),[4,this._store.get(e)];case 2:return s=null!==(n=f.sent())&&void 0!==n?n:[],!i||i.version<this._version?[4,this._resetPreferenceData(s,r)]:[3,4];case 3:return f.sent(),[3,11];case 4:f.trys.push([4,9,10,11]),o=dw(s),a=o.next(),f.label=5;case 5:return a.done?[3,8]:(u=a.value,[4,this._store.get(u)]);case 6:(c=f.sent())&&this._preference.set(u,c),f.label=7;case 7:return a=o.next(),[3,5];case 8:return [3,11];case 9:return l=f.sent(),d={error:l},[3,11];case 10:try{a&&!a.done&&(h=o.return)&&h.call(o);}finally{if(d)throw d.error;}return [7];case 11:return [2];}});});},e.prototype._resetPreferenceData=function(e,t){return cw(this,void 0,void 0,function(){return lw(this,function(n){switch(n.label){case 0:return this._preference=new Map(),[4,this._store.removeMany(e)];case 1:return n.sent(),[4,this._store.set({key:t,value:{version:this._version}})];case 2:return n.sent(),[2];}});});},e.prototype.get=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this._preference.get(e)];});});},e.prototype.set=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=!this._preference.has(e),[4,this._store.set({key:e,value:t})];case 1:return r.sent(),this._preference.set(e,t),n?[4,this._savePreferenceKeys()]:[3,3];case 2:r.sent(),r.label=3;case 3:return [2];}});});},e.prototype.remove=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,this._store.remove(e)];case 1:return t.sent(),this._preference.delete(e),[4,this._savePreferenceKeys()];case 2:return t.sent(),[2];}});});},e.prototype.clear=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._store.removeMany(fw([],hw(this._preference.keys()),!1))];case 1:return e.sent(),this._preference.clear(),[4,this._savePreferenceKeys()];case 2:return e.sent(),[2];}});});},e;}(),Uw=function(){function e(e){var t=e.encryption,n=e.store,r=e.localCacheEnabled,i=e.localCacheConfig;this.store=n,this.preference=new Mw({store:n}),this.encryption=null!=t?t:Lw,this.localCacheEnabled=r,this.localCacheConfig=i;}return e.prototype.replaceStore=function(e){this.store=e,this.preference=new Mw({store:e});},e;}();!function(e){e.SUCCESS="success",e.PENDING="pending",e.ERROR="error";}(yw||(yw={})),function(e){e.DEFAULT="default",e.ALL="all",e.MENTION_ONLY="mention_only",e.OFF="off";}(mw||(mw={})),function(e){e.FCM="gcm",e.APNS="apns",e.UNKNOWN="unknown";}(gw||(gw={})),function(e){e.ALTERNATIVE="alternative",e.DEFAULT="default";}(Ew||(Ew={})),function(e){e.CUSTOM="custom",e.MESSAGE_COLLECTION_ACCESSED_AT="messagecollection_accessed_at";}(bw||(bw={}));var Pw,Fw,qw,Hw,jw,Vw,Gw,zw,Bw,Kw,Qw=function(){function e(e){var t=void 0===e?{}:e,n=t.maxSize,r=void 0===n?256:n,i=t.clearOrder,s=void 0===i?bw.MESSAGE_COLLECTION_ACCESSED_AT:i,o=t.customClearOrderComparator;this._clearOrderComparatorUseMessageCollectionAccessedAt=function(e,t){return e.channel.messageCollectionLastAccessedAt===t.channel.messageCollectionLastAccessedAt?e.channel.lastMessage&&!t.channel.lastMessage?1:!e.channel.lastMessage&&t.channel.lastMessage?-1:e.channel.lastMessage||t.channel.lastMessage?e.channel.lastMessage.createdAt-t.channel.lastMessage.createdAt:0:e.channel.messageCollectionLastAccessedAt>t.channel.messageCollectionLastAccessedAt?1:-1;},this._maxSize=Math.max(r,64),o?(this._clearOrder=s,this._customClearOrderComparator=o):this._clearOrder=bw.MESSAGE_COLLECTION_ACCESSED_AT;}return Object.defineProperty(e.prototype,"maxSize",{get:function(){return this._maxSize;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrder",{get:function(){return this._clearOrder;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrderComparator",{get:function(){var e;return this._clearOrder===bw.MESSAGE_COLLECTION_ACCESSED_AT?this._clearOrderComparatorUseMessageCollectionAccessedAt:null!==(e=this._customClearOrderComparator)&&void 0!==e?e:this._clearOrderComparatorUseMessageCollectionAccessedAt;},enumerable:!1,configurable:!0}),e;}(),Ww=function(){function e(){}return Object.defineProperty(e.prototype,"hasSession",{get:function(){return !!this.sessionKey;},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.authToken=void 0,this.sessionKey=void 0;},e;}(),Yw=function(){var e=new Date().getTime();return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16);});},Zw=function(){function e(e){var t=e.container;this._container={},this._container=t,this.key=Yw();}return e.prototype._register=function(e,t,n){var r;return e in this._container||(this._container[e]=new Map()),null===(r=this._container[e])||void 0===r||r.set(this.key,{occurence:t,handler:n}),this;},e.prototype.on=function(e,t){return this._register(e,-1,t);},e.prototype.once=function(e,t){return this._register(e,1,t);},e.prototype.close=function(){var e;for(var t in this._container)null===(e=this._container[t])||void 0===e||e.delete(this.key);},e;}(),Xw=function(){function e(){this._container={};}return e.prototype.on=function(e,t){return new Zw({container:this._container}).on(e,t);},e.prototype.once=function(e,t){return new Zw({container:this._container}).once(e,t);},e.prototype.dispatch=function(e,t){var n,r,i=this._container[e];if(i){var s=[];try{for(var o=dw(i.keys()),a=o.next();!a.done;a=o.next()){var u=a.value,c=i.get(u);c.handler(t),c.occurence>0&&(c.occurence--,0===c.occurence&&s.push(u));}}catch(e){n={error:e};}finally{try{a&&!a.done&&(r=o.return)&&r.call(o);}finally{if(n)throw n.error;}}s.forEach(function(e){return i.delete(e);});}},e;}(),Jw=function(){function e(){this._dispatcher=new Xw();}return e.prototype.on=function(e){return this._dispatcher.on("event",e);},e.prototype.once=function(e){return this._dispatcher.once("event",e);},e.prototype.dispatch=function(e){this._dispatcher.dispatch("event",e);},e;}(),$w=function(){},eI=function(e){var t={};return e&&Object.keys(e).forEach(function(n){void 0===e[n]||Number.isNaN(e[n])||null===e[n]||(t[n]=e[n]);}),t;},tI=function(e){if(null!=e){if("object"==typeof e){if(Array.isArray(e)){var t=fw([],hw(e),!1);for(var n in t)t[n]=tI(t[n]);return t;}for(var r in e)null===e[r]&&delete e[r];return e;}return e;}};!function(e){e.BASE="base",e.GROUP="group",e.OPEN="open",e.FEED="feed";}(Pw||(Pw={})),function(e){e.OPERATOR="operator",e.NONE="none";}(Fw||(Fw={})),function(e){e.MUTED="muted",e.UNMUTED="unmuted";}(qw||(qw={})),function(e){e.BASE="base",e.USER="user",e.FILE="file",e.ADMIN="admin";}(Hw||(Hw={})),function(e){e.ALL="",e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM";}(jw||(jw={})),function(e){e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM";}(Vw||(Vw={})),function(e){e.USERS="users",e.CHANNEL="channel";}(Gw||(Gw={})),function(e){e.ALL="all",e.NONE="none",e.ONLY_REPLY_TO_CHANNEL="only_reply_to_channel";}(zw||(zw={})),function(e){e.DEFAULT="default",e.SUPPRESS="suppress";}(Bw||(Bw={})),function(e){e.PENDING="pending",e.SCHEDULED="scheduled",e.SUCCEEDED="succeeded",e.FAILED="failed",e.CANCELED="canceled";}(Kw||(Kw={}));var nI,rI="v3",iI="/".concat(rI,"/users"),sI="/".concat(rI,"/storage/file"),oI="/".concat(rI,"/group_channels"),aI="/".concat(rI,"/open_channels"),uI="/".concat(rI,"/sdk/open_channels"),cI="/".concat(rI,"/search"),lI="/".concat(rI,"/report"),dI="/".concat(rI,"/emojis"),hI="/".concat(rI,"/emoji_categories"),fI="/".concat(rI,"/polls"),pI="/".concat(rI,"/sdk/ui_kit/configuration"),vI="/".concat(rI,"/sdk/statistics"),_I=function(e){switch(e){case Pw.FEED:case Pw.GROUP:return oI;case Pw.OPEN:return aI;default:return null;}},yI=function(e){switch(e){case Pw.GROUP:return "".concat(lI,"/group_channels");case Pw.OPEN:return "".concat(lI,"/open_channels");default:return null;}},mI=function(e,t,n){var r,i;switch(e){case Gw.CHANNEL:return !0;case Gw.USERS:if(t)try{for(var s=dw(t),o=s.next();!o.done;o=s.next())if(o.value===n)return !0;}catch(e){r={error:e};}finally{try{o&&!o.done&&(i=s.return)&&i.call(s);}finally{if(r)throw r.error;}}}return !1;},gI=function(e,t,n){var r,i,s,o,a=mI(null!==(r=e.mentionType)&&void 0!==r?r:null,null!==(i=e.mentionedUserIds)&&void 0!==i?i:[],n),u=mI(null!==(s=t.mentionType)&&void 0!==s?s:null,null!==(o=t.mentionedUserIds)&&void 0!==o?o:[],n);return !a&&u?1:a&&!u?-1:0;},EI=function(e,t,n){var r,i=t||new FormData();for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var o=e[s],a=n?"".concat(n,"[").concat(s,"]"):s;Dw(o)?i.append(a,o,null!==(r=o.name)&&void 0!==r?r:"filename"):"object"!=typeof o||null===o||Array.isArray(o)||o instanceof Blob?i.append(a,String(o)):i=EI(o,i,a);}return i;};!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE";}(nI||(nI={}));var bI,wI=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.params={},t.requireAuth=!0,t.headers={},t.requestId=Yw(),t;}return aw(t,e),t.prototype.encodeParams=function(e){var t=this;return null==e||""===e?encodeURIComponent(""):Array.isArray(e)?e.map(function(e){return t.encodeParams(e);}).join(","):"object"==typeof e?encodeURIComponent(JSON.stringify(e)):encodeURIComponent(String(e));},Object.defineProperty(t.prototype,"query",{get:function(){var e=this,t=eI(this.params);return "?".concat(Object.keys(t).map(function(n){return "".concat(encodeURIComponent(n),"=").concat(e.encodeParams(t[n]));}).join("&"));},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){var e=eI(this.params);return Object.keys(e).some(function(t){return Dw(e[t]);})?EI(e):JSON.stringify(e);},enumerable:!1,configurable:!0}),t;}($w),II=function(e){function t(t,n){var r=e.call(this)||this;return r._iid=t,r._payload=n,r;}return aw(t,e),Object.defineProperty(t.prototype,"payload",{get:function(){return uw({},this._payload);},enumerable:!1,configurable:!0}),t.prototype.as=function(e){return new e(this._iid,this.payload);},t;}($w),TI=function(e){function t(t){var n=e.call(this)||this;return n.requestId=t,n;}return aw(t,e),t;}($w),SI=function(e){function t(t){var n=t.expires_in,r=t.reason,i=void 0===r?pw.SESSION_KEY_EXPIRED:r,s=e.call(this)||this;switch(s.expiresIn=null!=n?n:0,i){case pw.SESSION_KEY_EXPIRED:case pw.SESSION_TOKEN_EXPIRED:case pw.SESSION_REVOKED:case pw.USER_AUTH_DEACTIVATED:case pw.USER_AUTH_DELETED_OR_NOT_FOUND:s.error=new Iw({code:i});}return s;}return aw(t,e),Object.defineProperty(t.prototype,"invalidateSessionToken",{get:function(){var e;return !!(null===(e=this.error)||void 0===e?void 0:e.isSessionTokenExpiredError);},enumerable:!1,configurable:!0}),t;}($w),CI=function(e){function t(t){var n=e.call(this)||this;return n.statLog=t,n;}return aw(t,e),t;}($w);!function(e){e.FEATURE_LOCALCACHE="feature:local_cache",e.WEBSOCKET_CONNECT="ws:connect",e.API_RESULT="api:result";}(bI||(bI={}));var kI,AI,NI,OI=function(){function e(e){var t=e.type,n=e.data,r=e.ts,i=void 0===r?Date.now():r;this.type=t,this.createdAt=i,this.data=n;}return e.payloadify=function(e){return eI({stat_type:e.type,ts:e.createdAt,data:eI(e.data)});},e;}(),RI=function(){return "undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"==navigator.product;},DI=function(){return !("undefined"==typeof navigator||!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent));};!function(e){e.CHAT="chat",e.CALLS="calls",e.DESK="desk",e.LIVE="live",e.UIKIT_CHAT="uikit-chat",e.UIKIT_LIVE="uikit-live";}(kI||(kI={})),function(e){e.ANDROID="android",e.IOS="ios",e.JS="js",e.UNREAL="unreal",e.UNITY="unity",e.REACT_NATIVE="react-native",e.FLUTTER="flutter";}(AI||(AI={})),function(e){e.ANDROID="android",e.IOS="ios",e.WEB="web",e.MOBILE_WEB="mobile_web",e.WINDOWS="windows";}(NI||(NI={}));var xI=function(){function e(){}return e.sendbirdSdkUserAgentWithExtension=function(e){var t=RI()?AI.REACT_NATIVE:AI.JS,n={main_sdk_info:"chat/".concat(t,"/").concat(_w.SDK_VERSION),device_os_platform:DI()?"mobile-web":"web",os_version:_w.OS_VERSION};if(e){var r=e.sendbirdExtensions,i=e.deviceOS,s=e.customData,o=void 0===s?{}:s;i.version&&(n.os_version=i.version),i.platform&&(n.device_os_platform=i.platform),r.length>0&&(n.extension_sdk_info=r.map(function(e){var t=e.product,n=e.platform,r=e.version;return "".concat(t,"/").concat(n,"/").concat(r);}).join(",")),Object.keys(n).forEach(function(e){return delete o[e];}),Object.keys(o).length>0&&(n=uw(uw({},n),o));}return Object.entries(n).map(function(e){var t=hw(e,2),n=t[0],r=t[1];return "".concat(n,"=").concat(r);}).join("&");},e.userAgentWithExtension=function(e){var t=RI()?"reactnative":"JS",n=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",r=e.sb_uikit?"u".concat(e.sb_uikit):"",i=e["device-os-platform"]?"o".concat(e["device-os-platform"]):DI()?"omobile-web":"oweb";return "".concat(t,"/c").concat(_w.SDK_VERSION,"/").concat(n,"/").concat(r,"/").concat(i);},e;}(),LI=function(){function e(e,t){var n=t.auth,r=t.sdkState,i=t.dispatcher,s=t.logger,o=t.useFetchCompat,a=void 0!==o&&o,u=this;this._abortControl=new Map(),this._shouldImportFetchCompat=!1,this._iid=e,this._auth=n,this._sdkState=r,this._dispatcher=i,this._dispatcher.on(function(e){e instanceof TI&&u.cancel(e.requestId);}),this._logger=s,this._shouldImportFetchCompat=a;}return e.prototype._createHeader=function(e,t){var n=this._sdkState,r=n.appId,i=n.appVersion,s=n.sendbirdRuntimeEnvironment,o=uw(uw({},e.headers),{SendBird:"JS,".concat(_w.OS_VERSION,",").concat(_w.SDK_VERSION,",").concat(r).concat(i?",".concat(i):""),"SB-User-Agent":xI.userAgentWithExtension(this._sdkState.extensions),"Request-Sent-Timestamp":Date.now().toString(),"SB-SDK-User-Agent":xI.sendbirdSdkUserAgentWithExtension(s)});return t||(o["Content-Type"]="application/json; charset=utf-8"),e.requireAuth&&this._auth.hasSession&&(o["Session-Key"]=this._auth.sessionKey),this._auth&&this._auth.authToken&&(o["App-Id"]=r,o["Access-Token"]=this._auth.authToken),o;},e.prototype._statLogApiResult=function(e,t,n){this._dispatcher.dispatch(new CI(new OI({type:bI.API_RESULT,data:{endpoint:e.path,method:e.method,success:!n,latency:Date.now()-t,error_code:null==n?void 0:n.code,error_description:null==n?void 0:n.message}})));},e.prototype.send=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c,l,d,h,f,p,v;return lw(this,function(_){switch(_.label){case 0:t=e.path,n=e.method,r=![nI.GET,nI.DELETE].includes(n),i=this._sdkState.api,s="".concat(i.host).concat(t).concat(r?"":e.query),o=r?e.payload:null,a=this._createHeader(e,o instanceof FormData?o:void 0),u=new AbortController(),c=u.signal,this._abortControl.set(e.requestId,u),l=Date.now(),_.label=1;case 1:return _.trys.push([1,8,,9]),this._shouldImportFetchCompat&&(this._shouldImportFetchCompat=!1,("undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof commonjsGlobal&&commonjsGlobal||{fetch:null}).fetch=null),"undefined"!=typeof AbortController?[3,3]:[4,Promise.resolve().then(function(){return _U;})];case 2:_.sent(),_.label=3;case 3:return "function"==typeof fetch?[3,5]:[4,Promise.resolve().then(function(){return VU;})];case 4:_.sent(),_.label=5;case 5:return [4,fetch(s,{method:n,body:o,headers:a,signal:c})];case 6:return [4,(d=_.sent()).json()];case 7:if(h=_.sent(),d.ok||d.redirected)return this._logger.debug("receive api response",e.requestId),this._statLogApiResult(e,l),[2,new II(this._iid,h)];throw h?(((f=new Iw(h)).isSessionKeyExpiredError||f.isSessionTokenExpiredError)&&this._dispatcher.dispatch(new SI({reason:f.code})),this._statLogApiResult(e,l,f),f):(f=Iw.requestFailed,this._statLogApiResult(e,l,f),f);case 8:throw p=_.sent(),this._statLogApiResult(e,l,p),p instanceof Iw?(this._logger.debug("fail api request",p),p):"AbortError"===p.name?Iw.requestCanceled:(v=Iw.networkError,this._logger.debug("fail api request",v),v);case 9:return [2];}});});},e.prototype.cancel=function(e){this._abortControl.has(e)&&(this._abortControl.get(e).abort(),this._abortControl.delete(e));},e.prototype.cancelAll=function(){var e,t;try{for(var n=dw(this._abortControl.values()),r=n.next();!r.done;r=n.next())r.value.abort();}catch(t){e={error:t};}finally{try{r&&!r.done&&(t=n.return)&&t.call(n);}finally{if(e)throw e.error;}}this._abortControl.clear();},e;}(),MI=function(e){function t(t,n,r,i){void 0===i&&(i="");var s,o=this;return (o=e.call(this)||this)._iid=t,o.code=n,o.payload=r,o.requestId=null!==(s=r.req_id)&&void 0!==s?s:i,o;}return aw(t,e),t.createFromRawMessage=function(e,n){var r=n.substring(0,4),i={};try{i=JSON.parse(n.substring(4));}catch(e){r="NOOP";}finally{return new t(e,r,i);}},t.prototype.convertToMessage=function(){return "".concat(this.code).concat(JSON.stringify(this.payload),"\n");},t.prototype.as=function(e){return new e(this._iid,this.code,this.payload);},t;}($w),UI=function(){};function PI(e){let t=e.length;for(;--t>=0;)e[t]=0;}const FI=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),qI=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),HI=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),jI=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),VI=new Array(576);PI(VI);const GI=new Array(60);PI(GI);const zI=new Array(512);PI(zI);const BI=new Array(256);PI(BI);const KI=new Array(29);PI(KI);const QI=new Array(30);function WI(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length;}let YI,ZI,XI;function JI(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t;}PI(QI);const $I=e=>e<256?zI[e]:zI[256+(e>>>7)],eT=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255;},tT=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,eT(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n);},nT=(e,t,n)=>{tT(e,n[2*t],n[2*t+1]);},rT=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1;}while(--t>0);return n>>>1;},iT=(e,t,n)=>{const r=new Array(16);let i,s,o=0;for(i=1;i<=15;i++)o=o+n[i-1]<<1,r[i]=o;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=rT(r[t]++,t));}},sT=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0;},oT=e=>{e.bi_valid>8?eT(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0;},aT=(e,t,n,r)=>{const i=2*t,s=2*n;return e[i]<e[s]||e[i]===e[s]&&r[t]<=r[n];},uT=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&aT(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!aT(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r;},cT=(e,t,n)=>{let r,i,s,o,a=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+a++],r+=(255&e.pending_buf[e.sym_buf+a++])<<8,i=e.pending_buf[e.sym_buf+a++],0===r?nT(e,i,t):(s=BI[i],nT(e,s+256+1,t),o=FI[s],0!==o&&(i-=KI[s],tT(e,i,o)),r--,s=$I(r),nT(e,s,n),o=qI[s],0!==o&&(r-=QI[s],tT(e,r,o)));}while(a<e.sym_next);nT(e,256,t);},lT=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let o,a,u,c=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<s;o++)0!==n[2*o]?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):n[2*o+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,n[2*u]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[2*u+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)uT(e,n,o);u=s;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],uT(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,n[2*u]=n[2*o]+n[2*a],e.depth[u]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,n[2*o+1]=n[2*a+1]=u,e.heap[1]=u++,uT(e,n,1);}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,u=t.stat_desc.max_length;let c,l,d,h,f,p,v=0;for(h=0;h<=15;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)l=e.heap[c],h=n[2*n[2*l+1]+1]+1,h>u&&(h=u,v++),n[2*l+1]=h,l>r||(e.bl_count[h]++,f=0,l>=a&&(f=o[l-a]),p=n[2*l],e.opt_len+=p*(h+f),s&&(e.static_len+=p*(i[2*l+1]+f)));if(0!==v){do{for(h=u-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[u]--,v-=2;}while(v>0);for(h=u;0!==h;h--)for(l=e.bl_count[h];0!==l;)d=e.heap[--c],d>r||(n[2*d+1]!==h&&(e.opt_len+=(h-n[2*d+1])*n[2*d],n[2*d+1]=h),l--);}})(e,t),iT(n,c,e.bl_count);},dT=(e,t,n)=>{let r,i,s=-1,o=t[1],a=0,u=7,c=4;for(0===o&&(u=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++a<u&&i===o||(a<c?e.bl_tree[2*i]+=a:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,s=i,0===o?(u=138,c=3):i===o?(u=6,c=3):(u=7,c=4));},hT=(e,t,n)=>{let r,i,s=-1,o=t[1],a=0,u=7,c=4;for(0===o&&(u=138,c=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++a<u&&i===o)){if(a<c)do{nT(e,i,e.bl_tree);}while(0!=--a);else 0!==i?(i!==s&&(nT(e,i,e.bl_tree),a--),nT(e,16,e.bl_tree),tT(e,a-3,2)):a<=10?(nT(e,17,e.bl_tree),tT(e,a-3,3)):(nT(e,18,e.bl_tree),tT(e,a-11,7));a=0,s=i,0===o?(u=138,c=3):i===o?(u=6,c=3):(u=7,c=4);}};let fT=!1;const pT=(e,t,n,r)=>{tT(e,0+(r?1:0),3),oT(e),eT(e,n),eT(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n;};var vT={_tr_init:e=>{fT||((()=>{let e,t,n,r,i;const s=new Array(16);for(n=0,r=0;r<28;r++)for(KI[r]=n,e=0;e<1<<FI[r];e++)BI[n++]=r;for(BI[n-1]=r,i=0,r=0;r<16;r++)for(QI[r]=i,e=0;e<1<<qI[r];e++)zI[i++]=r;for(i>>=7;r<30;r++)for(QI[r]=i<<7,e=0;e<1<<qI[r]-7;e++)zI[256+i++]=r;for(t=0;t<=15;t++)s[t]=0;for(e=0;e<=143;)VI[2*e+1]=8,e++,s[8]++;for(;e<=255;)VI[2*e+1]=9,e++,s[9]++;for(;e<=279;)VI[2*e+1]=7,e++,s[7]++;for(;e<=287;)VI[2*e+1]=8,e++,s[8]++;for(iT(VI,287,s),e=0;e<30;e++)GI[2*e+1]=5,GI[2*e]=rT(e,5);YI=new WI(VI,FI,257,286,15),ZI=new WI(GI,qI,0,30,15),XI=new WI(new Array(0),HI,0,19,7);})(),fT=!0),e.l_desc=new JI(e.dyn_ltree,YI),e.d_desc=new JI(e.dyn_dtree,ZI),e.bl_desc=new JI(e.bl_tree,XI),e.bi_buf=0,e.bi_valid=0,sT(e);},_tr_stored_block:pT,_tr_flush_block:(e,t,n,r)=>{let i,s,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0;})(e)),lT(e,e.l_desc),lT(e,e.d_desc),o=(e=>{let t;for(dT(e,e.dyn_ltree,e.l_desc.max_code),dT(e,e.dyn_dtree,e.d_desc.max_code),lT(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*jI[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t;})(e),i=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=i&&(i=s)):i=s=n+5,n+4<=i&&-1!==t?pT(e,t,n,r):4===e.strategy||s===i?(tT(e,2+(r?1:0),3),cT(e,VI,GI)):(tT(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(tT(e,t-257,5),tT(e,n-1,5),tT(e,r-4,4),i=0;i<r;i++)tT(e,e.bl_tree[2*jI[i]+1],3);hT(e,e.dyn_ltree,t-1),hT(e,e.dyn_dtree,n-1);})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),cT(e,e.dyn_ltree,e.dyn_dtree)),sT(e),r&&oT(e);},_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(BI[n]+256+1)]++,e.dyn_dtree[2*$I(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{tT(e,2,3),nT(e,256,VI),(e=>{16===e.bi_valid?(eT(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8);})(e);}},_T=(e,t,n,r)=>{let i=65535&e|0,s=e>>>16&65535|0,o=0;for(;0!==n;){o=n>2e3?2e3:n,n-=o;do{i=i+t[r++]|0,s=s+i|0;}while(--o);i%=65521,s%=65521;}return i|s<<16|0;};const yT=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e;}return t;})());var mT=(e,t,n,r)=>{const i=yT,s=r+n;e^=-1;for(let n=r;n<s;n++)e=e>>>8^i[255&(e^t[n])];return -1^e;},gT={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ET={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:bT,_tr_stored_block:wT,_tr_flush_block:IT,_tr_tally:TT,_tr_align:ST}=vT,{Z_NO_FLUSH:CT,Z_PARTIAL_FLUSH:kT,Z_FULL_FLUSH:AT,Z_FINISH:NT,Z_BLOCK:OT,Z_OK:RT,Z_STREAM_END:DT,Z_STREAM_ERROR:xT,Z_DATA_ERROR:LT,Z_BUF_ERROR:MT,Z_DEFAULT_COMPRESSION:UT,Z_FILTERED:PT,Z_HUFFMAN_ONLY:FT,Z_RLE:qT,Z_FIXED:HT,Z_DEFAULT_STRATEGY:jT,Z_UNKNOWN:VT,Z_DEFLATED:GT}=ET,zT=258,BT=262,KT=42,QT=113,WT=666,YT=(e,t)=>(e.msg=gT[t],t),ZT=e=>2*e-(e>4?9:0),XT=e=>{let t=e.length;for(;--t>=0;)e[t]=0;},JT=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0;}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0;}while(--t);};let $T=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const eS=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0));},tS=(e,t)=>{IT(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,eS(e.strm);},nS=(e,t)=>{e.pending_buf[e.pending++]=t;},rS=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t;},iS=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=_T(e.adler,t,i,n):2===e.state.wrap&&(e.adler=mT(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i);},sS=(e,t)=>{let n,r,i=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match;const u=e.strstart>e.w_size-BT?e.strstart-(e.w_size-BT):0,c=e.window,l=e.w_mask,d=e.prev,h=e.strstart+zT;let f=c[s+o-1],p=c[s+o];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,c[n+o]===p&&c[n+o-1]===f&&c[n]===c[s]&&c[++n]===c[s+1]){s+=2,n++;do{}while(c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&s<h);if(r=zT-(h-s),s=h-zT,r>o){if(e.match_start=t,o=r,r>=a)break;f=c[s+o-1],p=c[s+o];}}}while((t=d[t&l])>u&&0!=--i);return o<=e.lookahead?o:e.lookahead;},oS=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-BT)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),JT(e),r+=t),0===e.strm.avail_in)break;if(n=iS(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=$T(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=$T(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<BT&&0!==e.strm.avail_in);},aS=(e,t)=>{let n,r,i,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o=0,a=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<s&&(0===n&&t!==NT||t===CT||n!==r+e.strm.avail_in))break;o=t===NT&&n===r+e.strm.avail_in?1:0,wT(e,0,0,o),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,eS(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(iS(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n);}while(0===o);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?4:t!==CT&&t!==NT&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(iS(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,s=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=s||(r||t===NT)&&t!==CT&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,o=t===NT&&0===e.strm.avail_in&&n===r?1:0,wT(e,e.block_start,n,o),e.block_start+=n,eS(e.strm)),o?3:1);},uS=(e,t)=>{let n,r;for(;;){if(e.lookahead<BT){if(oS(e),e.lookahead<BT&&t===CT)return 1;if(0===e.lookahead)break;}if(n=0,e.lookahead>=3&&(e.ins_h=$T(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-BT&&(e.match_length=sS(e,n)),e.match_length>=3){if(r=TT(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=$T(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;}while(0!=--e.match_length);e.strstart++;}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=$T(e,e.ins_h,e.window[e.strstart+1]);}else r=TT(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(tS(e,!1),0===e.strm.avail_out))return 1;}return e.insert=e.strstart<2?e.strstart:2,t===NT?(tS(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(tS(e,!1),0===e.strm.avail_out)?1:2;},cS=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<BT){if(oS(e),e.lookahead<BT&&t===CT)return 1;if(0===e.lookahead)break;}if(n=0,e.lookahead>=3&&(e.ins_h=$T(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-BT&&(e.match_length=sS(e,n),e.match_length<=5&&(e.strategy===PT||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=TT(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=$T(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(tS(e,!1),0===e.strm.avail_out))return 1;}else if(e.match_available){if(r=TT(e,0,e.window[e.strstart-1]),r&&tS(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1;}else e.match_available=1,e.strstart++,e.lookahead--;}return e.match_available&&(r=TT(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===NT?(tS(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(tS(e,!1),0===e.strm.avail_out)?1:2;};function lS(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i;}const dS=[new lS(0,0,0,0,aS),new lS(4,4,8,4,uS),new lS(4,5,16,8,uS),new lS(4,6,32,32,uS),new lS(4,4,16,16,cS),new lS(8,16,32,32,cS),new lS(8,16,128,128,cS),new lS(8,32,128,256,cS),new lS(32,128,258,1024,cS),new lS(32,258,258,4096,cS)];function hS(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=GT,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),XT(this.dyn_ltree),XT(this.dyn_dtree),XT(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),XT(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),XT(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0;}const fS=e=>{if(!e)return 1;const t=e.state;return !t||t.strm!==e||t.status!==KT&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==QT&&t.status!==WT?1:0;},pS=e=>{if(fS(e))return YT(e,xT);e.total_in=e.total_out=0,e.data_type=VT;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?KT:QT,e.adler=2===t.wrap?0:1,t.last_flush=-2,bT(t),RT;},vS=e=>{const t=pS(e);var n;return t===RT&&((n=e.state).window_size=2*n.w_size,XT(n.head),n.max_lazy_match=dS[n.level].max_lazy,n.good_match=dS[n.level].good_length,n.nice_match=dS[n.level].nice_length,n.max_chain_length=dS[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t;},_S=(e,t,n,r,i,s)=>{if(!e)return xT;let o=1;if(t===UT&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>9||n!==GT||r<8||r>15||t<0||t>9||s<0||s>HT||8===r&&1!==o)return YT(e,xT);8===r&&(r=9);const a=new hS();return e.state=a,a.strm=e,a.status=KT,a.wrap=o,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=s,a.method=n,vS(e);};var yS={deflateInit:(e,t)=>_S(e,t,GT,15,8,jT),deflateInit2:_S,deflateReset:vS,deflateResetKeep:pS,deflateSetHeader:(e,t)=>fS(e)||2!==e.state.wrap?xT:(e.state.gzhead=t,RT),deflate:(e,t)=>{if(fS(e)||t>OT||t<0)return e?YT(e,xT):xT;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===WT&&t!==NT)return YT(e,0===e.avail_out?MT:xT);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(eS(e),0===e.avail_out)return n.last_flush=-1,RT;}else if(0===e.avail_in&&ZT(t)<=ZT(r)&&t!==NT)return YT(e,MT);if(n.status===WT&&0!==e.avail_in)return YT(e,MT);if(n.status===KT&&0===n.wrap&&(n.status=QT),n.status===KT){let t=GT+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=FT||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,rS(n,t),0!==n.strstart&&(rS(n,e.adler>>>16),rS(n,65535&e.adler)),e.adler=1,n.status=QT,eS(e),0!==n.pending)return n.last_flush=-1,RT;}if(57===n.status)if(e.adler=0,nS(n,31),nS(n,139),nS(n,8),n.gzhead)nS(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),nS(n,255&n.gzhead.time),nS(n,n.gzhead.time>>8&255),nS(n,n.gzhead.time>>16&255),nS(n,n.gzhead.time>>24&255),nS(n,9===n.level?2:n.strategy>=FT||n.level<2?4:0),nS(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(nS(n,255&n.gzhead.extra.length),nS(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=mT(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(nS(n,0),nS(n,0),nS(n,0),nS(n,0),nS(n,0),nS(n,9===n.level?2:n.strategy>=FT||n.level<2?4:0),nS(n,3),n.status=QT,eS(e),0!==n.pending)return n.last_flush=-1,RT;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=mT(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,eS(e),0!==n.pending)return n.last_flush=-1,RT;t=0,r-=i;}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=mT(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0;}n.status=73;}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=mT(e.adler,n.pending_buf,n.pending-r,r)),eS(e),0!==n.pending)return n.last_flush=-1,RT;r=0;}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,nS(n,t);}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=mT(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0;}n.status=91;}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=mT(e.adler,n.pending_buf,n.pending-r,r)),eS(e),0!==n.pending)return n.last_flush=-1,RT;r=0;}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,nS(n,t);}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=mT(e.adler,n.pending_buf,n.pending-r,r));}n.status=103;}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(eS(e),0!==n.pending))return n.last_flush=-1,RT;nS(n,255&e.adler),nS(n,e.adler>>8&255),e.adler=0;}if(n.status=QT,eS(e),0!==n.pending)return n.last_flush=-1,RT;}if(0!==e.avail_in||0!==n.lookahead||t!==CT&&n.status!==WT){let r=0===n.level?aS(n,t):n.strategy===FT?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(oS(e),0===e.lookahead)){if(t===CT)return 1;break;}if(e.match_length=0,n=TT(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(tS(e,!1),0===e.strm.avail_out))return 1;}return e.insert=0,t===NT?(tS(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(tS(e,!1),0===e.strm.avail_out)?1:2;})(n,t):n.strategy===qT?((e,t)=>{let n,r,i,s;const o=e.window;for(;;){if(e.lookahead<=zT){if(oS(e),e.lookahead<=zT&&t===CT)return 1;if(0===e.lookahead)break;}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=o[i],r===o[++i]&&r===o[++i]&&r===o[++i])){s=e.strstart+zT;do{}while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<s);e.match_length=zT-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead);}if(e.match_length>=3?(n=TT(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=TT(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(tS(e,!1),0===e.strm.avail_out))return 1;}return e.insert=0,t===NT?(tS(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(tS(e,!1),0===e.strm.avail_out)?1:2;})(n,t):dS[n.level].func(n,t);if(3!==r&&4!==r||(n.status=WT),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),RT;if(2===r&&(t===kT?ST(n):t!==OT&&(wT(n,0,0,!1),t===AT&&(XT(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),eS(e),0===e.avail_out))return n.last_flush=-1,RT;}return t!==NT?RT:n.wrap<=0?DT:(2===n.wrap?(nS(n,255&e.adler),nS(n,e.adler>>8&255),nS(n,e.adler>>16&255),nS(n,e.adler>>24&255),nS(n,255&e.total_in),nS(n,e.total_in>>8&255),nS(n,e.total_in>>16&255),nS(n,e.total_in>>24&255)):(rS(n,e.adler>>>16),rS(n,65535&e.adler)),eS(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?RT:DT);},deflateEnd:e=>{if(fS(e))return xT;const t=e.state.status;return e.state=null,t===QT?YT(e,LT):RT;},deflateSetDictionary:(e,t)=>{let n=t.length;if(fS(e))return xT;const r=e.state,i=r.wrap;if(2===i||1===i&&r.status!==KT||r.lookahead)return xT;if(1===i&&(e.adler=_T(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(XT(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size;}const s=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,oS(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=$T(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++;}while(--t);r.strstart=e,r.lookahead=2,oS(r);}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=o,e.input=a,e.avail_in=s,r.wrap=i,RT;},deflateInfo:"pako deflate (from Nodeca project)"};const mS=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var gS={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)mS(n,t)&&(e[t]=n[t]);}}return e;},flattenChunks:e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,i=e.length;t<i;t++){let i=e[t];n.set(i,r),r+=i.length;}return n;}};let ES=!0;try{String.fromCharCode.apply(null,new Uint8Array(1));}catch(gU){ES=!1;}const bS=new Uint8Array(256);for(let e=0;e<256;e++)bS[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;bS[254]=bS[254]=1;var wS={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,i,s,o=e.length,a=0;for(i=0;i<o;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<o&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),s=0,i=0;s<a;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<o&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t;},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,i;const s=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){s[i++]=t;continue;}let o=bS[t];if(o>4)s[i++]=65533,r+=o-1;else {for(t&=2===o?31:3===o?15:7;o>1&&r<n;)t=t<<6|63&e[r++],o--;o>1?s[i++]=65533:t<65536?s[i++]=t:(t-=65536,s[i++]=55296|t>>10&1023,s[i++]=56320|1023&t);}}return ((e,t)=>{if(t<65534&&e.subarray&&ES)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n;})(s,i);},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+bS[e[n]]>t?n:t;}},IS=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0;};const TS=Object.prototype.toString,{Z_NO_FLUSH:SS,Z_SYNC_FLUSH:CS,Z_FULL_FLUSH:kS,Z_FINISH:AS,Z_OK:NS,Z_STREAM_END:OS,Z_DEFAULT_COMPRESSION:RS,Z_DEFAULT_STRATEGY:DS,Z_DEFLATED:xS}=ET;function LS(e){this.options=gS.assign({level:RS,method:xS,chunkSize:16384,windowBits:15,memLevel:8,strategy:DS},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new IS(),this.strm.avail_out=0;let n=yS.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==NS)throw new Error(gT[n]);if(t.header&&yS.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?wS.string2buf(t.dictionary):"[object ArrayBuffer]"===TS.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=yS.deflateSetDictionary(this.strm,e),n!==NS)throw new Error(gT[n]);this._dict_set=!0;}}function MS(e,t){const n=new LS(t);if(n.push(e,!0),n.err)throw n.msg||gT[n.err];return n.result;}LS.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,s;if(this.ended)return !1;for(s=t===~~t?t:!0===t?AS:SS,"string"==typeof e?n.input=wS.string2buf(e):"[object ArrayBuffer]"===TS.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(s===CS||s===kS)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else {if(i=yS.deflate(n,s),i===OS)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=yS.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===NS;if(0!==n.avail_out){if(s>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break;}else this.onData(n.output);}return !0;},LS.prototype.onData=function(e){this.chunks.push(e);},LS.prototype.onEnd=function(e){e===NS&&(this.result=gS.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg;};var US={Deflate:LS,deflate:MS,deflateRaw:function(e,t){return (t=t||{}).raw=!0,MS(e,t);},gzip:function(e,t){return (t=t||{}).gzip=!0,MS(e,t);},constants:ET};const PS=16209;var FS=function(e,t){let n,r,i,s,o,a,u,c,l,d,h,f,p,v,_,y,m,g,E,b,w,I,T,S;const C=e.state;n=e.next_in,T=e.input,r=n+(e.avail_in-5),i=e.next_out,S=e.output,s=i-(t-e.avail_out),o=i+(e.avail_out-257),a=C.dmax,u=C.wsize,c=C.whave,l=C.wnext,d=C.window,h=C.hold,f=C.bits,p=C.lencode,v=C.distcode,_=(1<<C.lenbits)-1,y=(1<<C.distbits)-1;e:do{f<15&&(h+=T[n++]<<f,f+=8,h+=T[n++]<<f,f+=8),m=p[h&_];t:for(;;){if(g=m>>>24,h>>>=g,f-=g,g=m>>>16&255,0===g)S[i++]=65535&m;else {if(!(16&g)){if(0==(64&g)){m=p[(65535&m)+(h&(1<<g)-1)];continue t;}if(32&g){C.mode=16191;break e;}e.msg="invalid literal/length code",C.mode=PS;break e;}E=65535&m,g&=15,g&&(f<g&&(h+=T[n++]<<f,f+=8),E+=h&(1<<g)-1,h>>>=g,f-=g),f<15&&(h+=T[n++]<<f,f+=8,h+=T[n++]<<f,f+=8),m=v[h&y];n:for(;;){if(g=m>>>24,h>>>=g,f-=g,g=m>>>16&255,!(16&g)){if(0==(64&g)){m=v[(65535&m)+(h&(1<<g)-1)];continue n;}e.msg="invalid distance code",C.mode=PS;break e;}if(b=65535&m,g&=15,f<g&&(h+=T[n++]<<f,f+=8,f<g&&(h+=T[n++]<<f,f+=8)),b+=h&(1<<g)-1,b>a){e.msg="invalid distance too far back",C.mode=PS;break e;}if(h>>>=g,f-=g,g=i-s,b>g){if(g=b-g,g>c&&C.sane){e.msg="invalid distance too far back",C.mode=PS;break e;}if(w=0,I=d,0===l){if(w+=u-g,g<E){E-=g;do{S[i++]=d[w++];}while(--g);w=i-b,I=S;}}else if(l<g){if(w+=u+l-g,g-=l,g<E){E-=g;do{S[i++]=d[w++];}while(--g);if(w=0,l<E){g=l,E-=g;do{S[i++]=d[w++];}while(--g);w=i-b,I=S;}}}else if(w+=l-g,g<E){E-=g;do{S[i++]=d[w++];}while(--g);w=i-b,I=S;}for(;E>2;)S[i++]=I[w++],S[i++]=I[w++],S[i++]=I[w++],E-=3;E&&(S[i++]=I[w++],E>1&&(S[i++]=I[w++]));}else {w=i-b;do{S[i++]=S[w++],S[i++]=S[w++],S[i++]=S[w++],E-=3;}while(E>2);E&&(S[i++]=S[w++],E>1&&(S[i++]=S[w++]));}break;}}break;}}while(n<r&&i<o);E=f>>3,n-=E,f-=E<<3,h&=(1<<f)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<o?o-i+257:257-(i-o),C.hold=h,C.bits=f;};const qS=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),HS=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),jS=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),VS=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var GS=(e,t,n,r,i,s,o,a)=>{const u=a.bits;let c,l,d,h,f,p,v=0,_=0,y=0,m=0,g=0,E=0,b=0,w=0,I=0,T=0,S=null;const C=new Uint16Array(16),k=new Uint16Array(16);let A,N,O,R=null;for(v=0;v<=15;v++)C[v]=0;for(_=0;_<r;_++)C[t[n+_]]++;for(g=u,m=15;m>=1&&0===C[m];m--);if(g>m&&(g=m),0===m)return i[s++]=20971520,i[s++]=20971520,a.bits=1,0;for(y=1;y<m&&0===C[y];y++);for(g<y&&(g=y),w=1,v=1;v<=15;v++)if(w<<=1,w-=C[v],w<0)return -1;if(w>0&&(0===e||1!==m))return -1;for(k[1]=0,v=1;v<15;v++)k[v+1]=k[v]+C[v];for(_=0;_<r;_++)0!==t[n+_]&&(o[k[t[n+_]]++]=_);if(0===e?(S=R=o,p=20):1===e?(S=qS,R=HS,p=257):(S=jS,R=VS,p=0),T=0,_=0,v=y,f=s,E=g,b=0,d=-1,I=1<<g,h=I-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){A=v-b,o[_]+1<p?(N=0,O=o[_]):o[_]>=p?(N=R[o[_]-p],O=S[o[_]-p]):(N=96,O=0),c=1<<v-b,l=1<<E,y=l;do{l-=c,i[f+(T>>b)+l]=A<<24|N<<16|O|0;}while(0!==l);for(c=1<<v-1;T&c;)c>>=1;if(0!==c?(T&=c-1,T+=c):T=0,_++,0==--C[v]){if(v===m)break;v=t[n+o[_]];}if(v>g&&(T&h)!==d){for(0===b&&(b=g),f+=y,E=v-b,w=1<<E;E+b<m&&(w-=C[E+b],!(w<=0));)E++,w<<=1;if(I+=1<<E,1===e&&I>852||2===e&&I>592)return 1;d=T&h,i[d]=g<<24|E<<16|f-s|0;}}return 0!==T&&(i[f+T]=v-b<<24|64<<16|0),a.bits=g,0;};const{Z_FINISH:zS,Z_BLOCK:BS,Z_TREES:KS,Z_OK:QS,Z_STREAM_END:WS,Z_NEED_DICT:YS,Z_STREAM_ERROR:ZS,Z_DATA_ERROR:XS,Z_MEM_ERROR:JS,Z_BUF_ERROR:$S,Z_DEFLATED:eC}=ET,tC=16180,nC=16190,rC=16191,iC=16192,sC=16194,oC=16199,aC=16200,uC=16206,cC=16209,lC=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function dC(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0;}const hC=e=>{if(!e)return 1;const t=e.state;return !t||t.strm!==e||t.mode<tC||t.mode>16211?1:0;},fC=e=>{if(hC(e))return ZS;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=tC,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,QS;},pC=e=>{if(hC(e))return ZS;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,fC(e);},vC=(e,t)=>{let n;if(hC(e))return ZS;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?ZS:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,pC(e));},_C=(e,t)=>{if(!e)return ZS;const n=new dC();e.state=n,n.strm=e,n.window=null,n.mode=tC;const r=vC(e,t);return r!==QS&&(e.state=null),r;};let yC,mC,gC=!0;const EC=e=>{if(gC){yC=new Int32Array(512),mC=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(GS(1,e.lens,0,288,yC,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;GS(2,e.lens,0,32,mC,0,e.work,{bits:5}),gC=!1;}e.lencode=yC,e.lenbits=9,e.distcode=mC,e.distbits=5;},bC=(e,t,n,r)=>{let i;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(t.subarray(n-r,n-r+i),s.wnext),(r-=i)?(s.window.set(t.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0;};var wC={inflateReset:pC,inflateReset2:vC,inflateResetKeep:fC,inflateInit:e=>_C(e,15),inflateInit2:_C,inflate:(e,t)=>{let n,r,i,s,o,a,u,c,l,d,h,f,p,v,_,y,m,g,E,b,w,I,T=0;const S=new Uint8Array(4);let C,k;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(hC(e)||!e.output||!e.input&&0!==e.avail_in)return ZS;n=e.state,n.mode===rC&&(n.mode=iC),o=e.next_out,i=e.output,u=e.avail_out,s=e.next_in,r=e.input,a=e.avail_in,c=n.hold,l=n.bits,d=a,h=u,I=QS;e:for(;;)switch(n.mode){case tC:if(0===n.wrap){n.mode=iC;break;}for(;l<16;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}if(2&n.wrap&&35615===c){0===n.wbits&&(n.wbits=15),n.check=0,S[0]=255&c,S[1]=c>>>8&255,n.check=mT(n.check,S,2,0),c=0,l=0,n.mode=16181;break;}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=cC;break;}if((15&c)!==eC){e.msg="unknown compression method",n.mode=cC;break;}if(c>>>=4,l-=4,w=8+(15&c),0===n.wbits&&(n.wbits=w),w>15||w>n.wbits){e.msg="invalid window size",n.mode=cC;break;}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&c?16189:rC,c=0,l=0;break;case 16181:for(;l<16;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}if(n.flags=c,(255&n.flags)!==eC){e.msg="unknown compression method",n.mode=cC;break;}if(57344&n.flags){e.msg="unknown header flags set",n.mode=cC;break;}n.head&&(n.head.text=c>>8&1),512&n.flags&&4&n.wrap&&(S[0]=255&c,S[1]=c>>>8&255,n.check=mT(n.check,S,2,0)),c=0,l=0,n.mode=16182;case 16182:for(;l<32;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}n.head&&(n.head.time=c),512&n.flags&&4&n.wrap&&(S[0]=255&c,S[1]=c>>>8&255,S[2]=c>>>16&255,S[3]=c>>>24&255,n.check=mT(n.check,S,4,0)),c=0,l=0,n.mode=16183;case 16183:for(;l<16;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&4&n.wrap&&(S[0]=255&c,S[1]=c>>>8&255,n.check=mT(n.check,S,2,0)),c=0,l=0,n.mode=16184;case 16184:if(1024&n.flags){for(;l<16;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&4&n.wrap&&(S[0]=255&c,S[1]=c>>>8&255,n.check=mT(n.check,S,2,0)),c=0,l=0;}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>a&&(f=a),f&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(s,s+f),w)),512&n.flags&&4&n.wrap&&(n.check=mT(n.check,r,f,s)),a-=f,s+=f,n.length-=f),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===a)break e;f=0;do{w=r[s+f++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w));}while(w&&f<a);if(512&n.flags&&4&n.wrap&&(n.check=mT(n.check,r,f,s)),a-=f,s+=f,w)break e;}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===a)break e;f=0;do{w=r[s+f++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w));}while(w&&f<a);if(512&n.flags&&4&n.wrap&&(n.check=mT(n.check,r,f,s)),a-=f,s+=f,w)break e;}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;l<16;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}if(4&n.wrap&&c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=cC;break;}c=0,l=0;}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=rC;break;case 16189:for(;l<32;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}e.adler=n.check=lC(c),c=0,l=0,n.mode=nC;case nC:if(0===n.havedict)return e.next_out=o,e.avail_out=u,e.next_in=s,e.avail_in=a,n.hold=c,n.bits=l,YS;e.adler=n.check=1,n.mode=rC;case rC:if(t===BS||t===KS)break e;case iC:if(n.last){c>>>=7&l,l-=7&l,n.mode=uC;break;}for(;l<3;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}switch(n.last=1&c,c>>>=1,l-=1,3&c){case 0:n.mode=16193;break;case 1:if(EC(n),n.mode=oC,t===KS){c>>>=2,l-=2;break e;}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=cC;}c>>>=2,l-=2;break;case 16193:for(c>>>=7&l,l-=7&l;l<32;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=cC;break;}if(n.length=65535&c,c=0,l=0,n.mode=sC,t===KS)break e;case sC:n.mode=16195;case 16195:if(f=n.length,f){if(f>a&&(f=a),f>u&&(f=u),0===f)break e;i.set(r.subarray(s,s+f),o),a-=f,s+=f,u-=f,o+=f,n.length-=f;break;}n.mode=rC;break;case 16196:for(;l<14;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}if(n.nlen=257+(31&c),c>>>=5,l-=5,n.ndist=1+(31&c),c>>>=5,l-=5,n.ncode=4+(15&c),c>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=cC;break;}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;l<3;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}n.lens[A[n.have++]]=7&c,c>>>=3,l-=3;}for(;n.have<19;)n.lens[A[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},I=GS(0,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,I){e.msg="invalid code lengths set",n.mode=cC;break;}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;T=n.lencode[c&(1<<n.lenbits)-1],_=T>>>24,y=T>>>16&255,m=65535&T,!(_<=l);){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}if(m<16)c>>>=_,l-=_,n.lens[n.have++]=m;else {if(16===m){for(k=_+2;l<k;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}if(c>>>=_,l-=_,0===n.have){e.msg="invalid bit length repeat",n.mode=cC;break;}w=n.lens[n.have-1],f=3+(3&c),c>>>=2,l-=2;}else if(17===m){for(k=_+3;l<k;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}c>>>=_,l-=_,w=0,f=3+(7&c),c>>>=3,l-=3;}else {for(k=_+7;l<k;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}c>>>=_,l-=_,w=0,f=11+(127&c),c>>>=7,l-=7;}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=cC;break;}for(;f--;)n.lens[n.have++]=w;}}if(n.mode===cC)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=cC;break;}if(n.lenbits=9,C={bits:n.lenbits},I=GS(1,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,I){e.msg="invalid literal/lengths set",n.mode=cC;break;}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},I=GS(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,I){e.msg="invalid distances set",n.mode=cC;break;}if(n.mode=oC,t===KS)break e;case oC:n.mode=aC;case aC:if(a>=6&&u>=258){e.next_out=o,e.avail_out=u,e.next_in=s,e.avail_in=a,n.hold=c,n.bits=l,FS(e,h),o=e.next_out,i=e.output,u=e.avail_out,s=e.next_in,r=e.input,a=e.avail_in,c=n.hold,l=n.bits,n.mode===rC&&(n.back=-1);break;}for(n.back=0;T=n.lencode[c&(1<<n.lenbits)-1],_=T>>>24,y=T>>>16&255,m=65535&T,!(_<=l);){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}if(y&&0==(240&y)){for(g=_,E=y,b=m;T=n.lencode[b+((c&(1<<g+E)-1)>>g)],_=T>>>24,y=T>>>16&255,m=65535&T,!(g+_<=l);){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}c>>>=g,l-=g,n.back+=g;}if(c>>>=_,l-=_,n.back+=_,n.length=m,0===y){n.mode=16205;break;}if(32&y){n.back=-1,n.mode=rC;break;}if(64&y){e.msg="invalid literal/length code",n.mode=cC;break;}n.extra=15&y,n.mode=16201;case 16201:if(n.extra){for(k=n.extra;l<k;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra;}n.was=n.length,n.mode=16202;case 16202:for(;T=n.distcode[c&(1<<n.distbits)-1],_=T>>>24,y=T>>>16&255,m=65535&T,!(_<=l);){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}if(0==(240&y)){for(g=_,E=y,b=m;T=n.distcode[b+((c&(1<<g+E)-1)>>g)],_=T>>>24,y=T>>>16&255,m=65535&T,!(g+_<=l);){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}c>>>=g,l-=g,n.back+=g;}if(c>>>=_,l-=_,n.back+=_,64&y){e.msg="invalid distance code",n.mode=cC;break;}n.offset=m,n.extra=15&y,n.mode=16203;case 16203:if(n.extra){for(k=n.extra;l<k;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra;}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=cC;break;}n.mode=16204;case 16204:if(0===u)break e;if(f=h-u,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=cC;break;}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),v=n.window;}else v=i,p=o-n.offset,f=n.length;f>u&&(f=u),u-=f,n.length-=f;do{i[o++]=v[p++];}while(--f);0===n.length&&(n.mode=aC);break;case 16205:if(0===u)break e;i[o++]=n.length,u--,n.mode=aC;break;case uC:if(n.wrap){for(;l<32;){if(0===a)break e;a--,c|=r[s++]<<l,l+=8;}if(h-=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?mT(n.check,i,h,o-h):_T(n.check,i,h,o-h)),h=u,4&n.wrap&&(n.flags?c:lC(c))!==n.check){e.msg="incorrect data check",n.mode=cC;break;}c=0,l=0;}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;l<32;){if(0===a)break e;a--,c+=r[s++]<<l,l+=8;}if(4&n.wrap&&c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=cC;break;}c=0,l=0;}n.mode=16208;case 16208:I=WS;break e;case cC:I=XS;break e;case 16210:return JS;default:return ZS;}return e.next_out=o,e.avail_out=u,e.next_in=s,e.avail_in=a,n.hold=c,n.bits=l,(n.wsize||h!==e.avail_out&&n.mode<cC&&(n.mode<uC||t!==zS))&&bC(e,e.output,e.next_out,h-e.avail_out),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?mT(n.check,i,h,e.next_out-h):_T(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===rC?128:0)+(n.mode===oC||n.mode===sC?256:0),(0===d&&0===h||t===zS)&&I===QS&&(I=$S),I;},inflateEnd:e=>{if(hC(e))return ZS;let t=e.state;return t.window&&(t.window=null),e.state=null,QS;},inflateGetHeader:(e,t)=>{if(hC(e))return ZS;const n=e.state;return 0==(2&n.wrap)?ZS:(n.head=t,t.done=!1,QS);},inflateSetDictionary:(e,t)=>{const n=t.length;let r,i,s;return hC(e)?ZS:(r=e.state,0!==r.wrap&&r.mode!==nC?ZS:r.mode===nC&&(i=1,i=_T(i,t,n,0),i!==r.check)?XS:(s=bC(e,t,n,n),s?(r.mode=16210,JS):(r.havedict=1,QS)));},inflateInfo:"pako inflate (from Nodeca project)"},IC=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1;};const TC=Object.prototype.toString,{Z_NO_FLUSH:SC,Z_FINISH:CC,Z_OK:kC,Z_STREAM_END:AC,Z_NEED_DICT:NC,Z_STREAM_ERROR:OC,Z_DATA_ERROR:RC,Z_MEM_ERROR:DC}=ET;function xC(e){this.options=gS.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new IS(),this.strm.avail_out=0;let n=wC.inflateInit2(this.strm,t.windowBits);if(n!==kC)throw new Error(gT[n]);if(this.header=new IC(),wC.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=wS.string2buf(t.dictionary):"[object ArrayBuffer]"===TC.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=wC.inflateSetDictionary(this.strm,t.dictionary),n!==kC)))throw new Error(gT[n]);}function LC(e,t){const n=new xC(t);if(n.push(e),n.err)throw n.msg||gT[n.err];return n.result;}xC.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,o,a;if(this.ended)return !1;for(o=t===~~t?t:!0===t?CC:SC,"[object ArrayBuffer]"===TC.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),s=wC.inflate(n,o),s===NC&&i&&(s=wC.inflateSetDictionary(n,i),s===kC?s=wC.inflate(n,o):s===RC&&(s=NC));n.avail_in>0&&s===AC&&n.state.wrap>0&&0!==e[n.next_in];)wC.inflateReset(n),s=wC.inflate(n,o);switch(s){case OC:case RC:case NC:case DC:return this.onEnd(s),this.ended=!0,!1;}if(a=n.avail_out,n.next_out&&(0===n.avail_out||s===AC))if("string"===this.options.to){let e=wS.utf8border(n.output,n.next_out),t=n.next_out-e,i=wS.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i);}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(s!==kC||0!==a){if(s===AC)return s=wC.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===n.avail_in)break;}}return !0;},xC.prototype.onData=function(e){this.chunks.push(e);},xC.prototype.onEnd=function(e){e===kC&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=gS.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg;};var MC={Inflate:xC,inflate:LC,inflateRaw:function(e,t){return (t=t||{}).raw=!0,LC(e,t);},ungzip:LC,constants:ET};const{Deflate:UC,deflate:PC,deflateRaw:FC,gzip:qC}=US,{Inflate:HC,inflate:jC,inflateRaw:VC,ungzip:GC}=MC;var zC,BC={Deflate:UC,deflate:PC,deflateRaw:FC,gzip:qC,Inflate:HC,inflate:jC,inflateRaw:VC,ungzip:GC,constants:ET};!function(e){e.CONNECTING="CONNECTING",e.OPEN="OPEN",e.CLOSED="CLOSED";}(zC||(zC={}));var KC,QC=function(e){function t(t,n){var r=n.sdkState,i=n.dispatcher,s=n.logger,o=e.call(this)||this;return o.lastActive=0,o._iid=t,o._sdkState=r,o._dispatcher=i,o._logger=s,o;}return aw(t,e),Object.defineProperty(t.prototype,"isOpen",{get:function(){return this.connectionState===zC.OPEN;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectionState",{get:function(){if(this._ws)switch(this._ws.readyState){case 0:return zC.CONNECTING;case 1:return zC.OPEN;}return zC.CLOSED;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ws",{get:function(){var e;return null!==(e=this._ws)&&void 0!==e?e:null;},enumerable:!1,configurable:!0}),t.prototype._handleMessage=function(e){var t=this;e.split("\n").forEach(function(e){if(e){var n=MI.createFromRawMessage(t._iid,e);if(t._logger.debug("receive websocket event",n),"LOGI"===n.code)t.dispatch("message",n);else if("PONG"===n.code)t.dispatch("pong");else if("EXPR"===n.code){if(n.payload){var r=new SI(n.payload);r.expiresIn>=0&&t._dispatcher.dispatch(r);}}else "NOOP"===n.code||t.dispatch("message",n);}});},t.prototype.connect=function(e){var t=this;this._ws=new WebSocket(e),this._ws.onopen=function(){t._logger.debug("websocket open"),t.dispatch("open");},this._ws.onmessage=function(e){return cw(t,void 0,void 0,function(){var t,n,r=this;return lw(this,function(i){return (null===(n=this._sdkState.websocket)||void 0===n?void 0:n.compression)?e.data instanceof Blob?((t=new FileReader()).readAsArrayBuffer(e.data),t.onloadend=function(){return cw(r,void 0,void 0,function(){var e;return lw(this,function(n){switch(n.label){case 0:return [4,(r=t.result,cw(void 0,void 0,void 0,function(){var e;return lw(this,function(t){return e=BC.ungzip(r),[2,String.fromCharCode.apply(null,e)];});}))];case 1:return e=n.sent(),this._handleMessage(e),[2];}var r;});});}):"string"==typeof e.data&&this._handleMessage(e.data):this._handleMessage(e.data),[2];});});},this._ws.onerror=function(){t._logger.debug("websocket error"),t.dispatch("error",Iw.networkError);},this._ws.onclose=function(){t._logger.debug("websocket close"),t.dispatch("close");},this.lastActive=Date.now();},t.prototype.disconnect=function(){var e=this;return new Promise(function(t){e._logger.debug("websocket disconnect"),e._ws&&e.connectionState!==zC.CLOSED?(e._ws.onopen=UI,e._ws.onmessage=UI,e._ws.onerror=UI,e._ws.onclose=function(){e.dispatch("close"),t();},e._ws.close(),e._ws=void 0):t();});},t.prototype.send=function(e){if(!this._ws)throw Iw.connectionClosed;"PING"!==e.code?this.dispatch("ping-refresh"):this._logger.debug("send ping",e),this._ws.send(e.convertToMessage());},t.prototype.error=function(e){this._logger.debug("websocket error",e),this.dispatch("error",e);},t;}(Xw),WC=function(e){function t(t){var n,r=t.code,i=t.ackRequired,s=t.payload,o=void 0===s?{}:s,a=this;return (a=e.call(this)||this).code=r,a.payload=o,a.requestId=null!==(n=a.payload.req_id)&&void 0!==n?n:Yw(),a.ackRequired=i,a.payload.req_id=a.requestId,a;}return aw(t,e),t.prototype.convertToMessage=function(){return "".concat(this.code).concat(JSON.stringify(this.payload),"\n");},t;}($w),YC=function(e){function t(t){var n=t.all,r=t.feed,i=t.custom_types,s=t.ts,o=e.call(this)||this;return o.all=n,o.feed=r,o.customTypes=i,o.ts=s,o;}return aw(t,e),t;}($w),ZC=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n;});},XC=function(){function e(e,t){var n=t.auth,r=t.sdkState,i=t.dispatcher,s=t.logger,o=t.useFetchCompat,a=void 0!==o&&o,u=this;this._ackStateMap=new Map(),this._sdkState=r,this._dispatcher=i,this._logger=s,this.apiClient=new LI(e,{auth:n,sdkState:r,dispatcher:i,logger:s,useFetchCompat:a}),this.websocketClient=new QC(e,{sdkState:r,dispatcher:i,logger:s}),this.websocketClient.on("message",function(e){if(e.payload.unread_cnt&&u._dispatcher.dispatch(new YC(e.payload.unread_cnt)),e.requestId){if(u._ackStateMap.has(e.requestId)){var t=u._ackStateMap.get(e.requestId);"EROR"!==e.code?t.resolve(e):t.reject(new Iw({code:e.payload.code,message:e.payload.message}));}}else u._dispatcher.dispatch(e);}).on("close",function(){u._ackStateMap.forEach(function(e){e.reject(Iw.connectionClosed);}),u._ackStateMap.clear();});}return e.prototype._sendApiRequest=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,this.apiClient.send(e)];case 1:return [2,t.sent()];}});});},e.prototype._sendWebsocketRequest=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i=this;return lw(this,function(s){if(!this._sdkState.websocket)throw Iw.connectionRequired;if(t=new ZC(),e.ackRequired){r=function(r,s){i._ackStateMap.has(e.requestId)&&(i._ackStateMap.delete(e.requestId),n&&(clearTimeout(n),n=null),r?(i._logger.debug("fail websocket request",r),t.reject(r)):(i._logger.debug("receive websocket ack",e.requestId),t.resolve(s)));};try{n=setTimeout(function(){return r(Iw.noAckTimeout);},this._sdkState.websocket.responseTimeout),this._ackStateMap.set(e.requestId,{resolve:function(e){return r(void 0,e);},reject:function(e){return r(e);}}),this.websocketClient.send(e);}catch(e){r(e);}}else try{this.websocketClient.send(e),t.resolve();}catch(e){t.reject(e);}return [2,t.promise];});});},e.prototype.send=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return e instanceof wI?[4,this._sendApiRequest(e)]:[3,2];case 1:case 3:return [2,t.sent()];case 2:return e instanceof WC?[4,this._sendWebsocketRequest(e)]:[3,4];case 4:throw Iw.invalidParameters;}});});},e.prototype.cancel=function(e){this.apiClient.cancel(e);},e.prototype.cancelAll=function(){this.apiClient.cancelAll();},e;}();!function(e){e[e.NONE=0]="NONE",e[e.INITIALIZED=1]="INITIALIZED",e[e.CONNECTING=2]="CONNECTING",e[e.CONNECTED=3]="CONNECTED",e[e.RECONNECTING=4]="RECONNECTING",e[e.INTERNAL_DISCONNECTED=5]="INTERNAL_DISCONNECTED",e[e.EXTERNAL_DISCONNECTED=6]="EXTERNAL_DISCONNECTED",e[e.LOGOUT=7]="LOGOUT";}(KC||(KC={}));var JC=function(e){function t(t){var n=t.stateType,r=e.call(this)||this;return r.stateType=n,r;}return aw(t,e),t;}($w),$C=function(){function e(e,t){var n=t.auth,r=t.sdkState,i=t.dispatcher,s=t.logger,o=t.useFetchCompat,a=void 0!==o&&o,u=this;this._currentConnectionStateType=KC.INITIALIZED,this._lazyCallQueue=[],this.commandRouter=new XC(e,{auth:n,sdkState:r,dispatcher:i,logger:s,useFetchCompat:a}),this._auth=n,this._logger=s,this._dispatcher=i,this._dispatcher.on(function(e){if(e instanceof JC){var t=e.stateType;switch(u._currentConnectionStateType=t,t){case KC.CONNECTED:var n=u._lazyCallQueue;u._lazyCallQueue=[],n.forEach(function(e){return cw(u,void 0,void 0,function(){var t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:t=e.command,n=e.deferred,r=e.timeout,clearTimeout(r),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.send(t)];case 2:return i=o.sent(),n.resolve(i),[3,4];case 3:return s=o.sent(),n.reject(s),[3,4];case 4:return [2];}});});});break;case KC.INITIALIZED:case KC.INTERNAL_DISCONNECTED:case KC.EXTERNAL_DISCONNECTED:case KC.LOGOUT:n=u._lazyCallQueue,u._lazyCallQueue=[],n.forEach(function(e){return cw(u,void 0,void 0,function(){var t,n;return lw(this,function(r){return t=e.deferred,n=e.timeout,clearTimeout(n),this._auth&&this._auth.hasSession?t.reject(Iw.connectionClosed):t.reject(Iw.connectionRequired),[2];});});});}}});}return Object.defineProperty(e.prototype,"isReady",{get:function(){return this._currentConnectionStateType===KC.CONNECTED;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLazyCallActivated",{get:function(){return this._currentConnectionStateType===KC.CONNECTING||this._currentConnectionStateType===KC.RECONNECTING;},enumerable:!1,configurable:!0}),e.prototype.send=function(e){return cw(this,void 0,void 0,function(){var t,n,r=this;return lw(this,function(i){switch(i.label){case 0:return e instanceof WC?this.isReady?(this._logger.debug("send websocket request",e),[4,this.commandRouter.send(e)]):[3,2]:[3,4];case 1:case 5:return [2,i.sent()];case 2:if(this.isLazyCallActivated)return this._logger.debug("wait websocket request",e),t=new ZC(),this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout(function(){return r.timeout(e.requestId);},1e4)}),[2,t.promise];throw this._logger.debug("fail websocket request"),Iw.connectionRequired;case 3:case 7:return [3,9];case 4:return e instanceof wI?this._auth.hasSession?(this._logger.debug("send api request",e),[4,this.commandRouter.send(e)]):[3,6]:[3,8];case 6:if(this.isLazyCallActivated)return this._logger.debug("wait api request",e),t=new ZC(),this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout(function(){return r.timeout(e.requestId);},1e4)}),[2,t.promise];throw n=Iw.connectionRequired,this._logger.debug("fail api request",n),n;case 8:throw Iw.invalidCommand;case 9:return [2];}});});},e.prototype.forceSend=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return this._logger.debug("send forced request",e),e instanceof WC||e instanceof wI?[4,this.commandRouter.send(e)]:[3,2];case 1:return [2,t.sent()];case 2:throw Iw.invalidCommand;}});});},e.prototype.timeout=function(e){this._logger.debug("timeout request",e);var t=this._lazyCallQueue.findIndex(function(t){return t.command.requestId===e;});t>-1&&(this._lazyCallQueue[t].deferred.reject(Iw.connectionRequired),this._lazyCallQueue.splice(t,1));},e.prototype.cancel=function(e){this._logger.debug("cancel api request",e),this.commandRouter.cancel(e);},e.prototype.cancelAll=function(){this._logger.debug("cancel all api requests"),this.commandRouter.cancelAll();},e;}(),ek="sendbird@devicetokens",tk=function(){function e(e){var t=e.type,n=e.token;this.type=t,this.token=n;}return e.payloadify=function(e){return eI(tI({type:e.type,token:e.token}));},e;}(),nk=function(e){function t(t){var n=t.userId,r=t.authToken,i=t.expiringSession,s=void 0===i||i,o=e.call(this)||this;return o.path="".concat(iI,"/").concat(n,"/session_key"),o.method=nI.POST,o.params={token:r,expiring_session:!!s},o.requireAuth=!1,o;}return aw(t,e),t;}(wI),rk=function(e){function t(t){var n=t.authToken,r=t.expiringSession,i=void 0===r||r,s=t.requestId,o=void 0===s?"":s;return e.call(this,{code:"LOGI",payload:{token:n,expiring_session:i?1:0,req_id:o},ackRequired:!0})||this;}return aw(t,e),t;}(WC),ik=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.key;return r.key=i,r;}return aw(t,e),t;}(II),sk=function(e){function t(t,n,r){var i,s=this;return (s=e.call(this,t,"LOGI",r)||this).error=null,s.newKey=null,s.newKey=null!==(i=r.new_key)&&void 0!==i?i:null,s.error=r.error?new Iw(r.error):null,s;}return aw(t,e),t;}(MI),ok=function(e){function t(){return null!==e&&e.apply(this,arguments)||this;}return aw(t,e),t;}($w),ak=function(e){return cw(void 0,void 0,void 0,function(){return lw(this,function(t){return [2,new Promise(function(t){return setTimeout(t,e);})];});});},uk=function(){function e(){}return e.prototype.calcTimeout=function(){return 0;},e;}(),ck=function(e,t,n){return void 0===n&&(n=new uk()),cw(void 0,void 0,void 0,function(){var r,i,s,o,a,u;return lw(this,function(c){switch(c.label){case 0:r=0,i=null,s=function(e){return i=null!=e?e:new Error("Halted");},o=function(){r=0;},c.label=1;case 1:if(!(-1===t||r<t))return [3,9];c.label=2;case 2:return c.trys.push([2,4,,8]),[4,e(s,o)];case 3:if(a=c.sent(),i)throw i;return [2,a];case 4:if(u=c.sent(),i)return [3,6];if(++r===t)throw u;return [4,ak(n.calcTimeout(r))];case 5:return c.sent(),[3,7];case 6:throw i;case 7:return [3,8];case 8:return [3,1];case 9:throw "It should not happen.";}});});},lk=function(e){return cw(void 0,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:if(!((t=n.sent())instanceof Iw))throw t;return t.throwOutside(),[3,3];case 3:return [2];}});});},dk=function(e){return cw(void 0,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e()];case 1:case 2:return t.sent(),[3,3];case 3:return [2];}});});},hk=new WeakMap(),fk=function(e){function t(t){var n=t.auth,r=t.cacheContext,i=t.sdkState,s=t.dispatcher,o=t.requestQueue,a=t.logger,u=e.call(this)||this;return u._currentConnectionStateType=KC.INITIALIZED,u._isRefreshingAuthToken=!1,u._isRefreshingSessionKey=!1,u.currentUser=null,u.auth=n,u._cacheContext=r,u._sdkState=i,u._dispatcher=s,u._requestQueue=o,u._logger=a,u._deviceTokens=[],u._dispatcher.on(function(e){var t;if(e instanceof JC){var n=e.stateType;u._currentConnectionStateType=n;}else e instanceof SI&&u.handler&&(e.invalidateSessionToken&&(u.auth.authToken=void 0),e.error&&(e.error.isSessionKeyExpiredError||e.error.isSessionTokenExpiredError)&&(u._logger.debug("session expired"),(null===(t=u.handler)||void 0===t?void 0:t.onSessionExpired)&&u.handler.onSessionExpired(),u.refresh()));}),u;}return aw(t,e),Object.defineProperty(t.prototype,"ekey",{get:function(){return hk.get(this);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokens",{get:function(){return this._deviceTokens;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokenLastDeletedAt",{get:function(){return this._deviceTokenLastDeletedAt;},enumerable:!1,configurable:!0}),t.prototype.indexOfDeviceToken=function(e,t){return this._deviceTokens.findIndex(function(n){return n.type===e&&n.token===t;});},t.prototype.hasDeviceToken=function(e,t){return this.indexOfDeviceToken(e,t)>=0;},t.prototype.createRefreshWebsocketCommand=function(e,t){return new rk({authToken:e,expiringSession:!0,requestId:t});},t.prototype._refreshSessionKeyByWebSocket=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return t=this.createRefreshWebsocketCommand(e),[4,this._requestQueue.forceSend(t)];case 1:if(n=o.sent(),r=n.as(sk),i=r.newKey,s=r.error)throw s;return this.auth.sessionKey=null!=i?i:this.auth.sessionKey,[2];}});});},t.prototype._refreshSessionKeyByApi=function(e){return cw(this,void 0,void 0,function(){var t,n=this;return lw(this,function(r){switch(r.label){case 0:return t=new nk({userId:this._sdkState.userId,authToken:e,expiringSession:!0}),[4,ck(function(e){return cw(n,void 0,void 0,function(){var n,r,i;return lw(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this._requestQueue.forceSend(t)];case 1:return n=s.sent(),r=n.as(ik).key,this.auth.sessionKey=r,[3,3];case 2:if(i=s.sent(),!this._isSessionRelatedError(i))throw i;return e(i),[3,3];case 3:return [2];}});});},3)];case 1:return r.sent(),[2];}});});},t.prototype._refreshSessionKey=function(e,t){return void 0===t&&(t=!0),cw(this,void 0,void 0,function(){var n,r,i;return lw(this,function(s){switch(s.label){case 0:if(this._currentConnectionStateType!==KC.CONNECTED)return [3,10];s.label=1;case 1:return s.trys.push([1,3,,10]),[4,this._refreshSessionKeyByWebSocket(e)];case 2:return s.sent(),this.complete(),[2];case 3:return n=s.sent(),this._isSessionRelatedError(n)&&t?[4,this._receiveNewAuthToken()]:[3,9];case 4:return (i=s.sent())?(this.auth.authToken=i,[4,this._refreshSessionKey(this.auth.authToken,!1)]):[3,6];case 5:return s.sent(),this.complete(),[3,8];case 6:return [4,this.clear()];case 7:s.sent(),this.close(),s.label=8;case 8:return [2];case 9:return [3,10];case 10:return s.trys.push([10,12,,22]),[4,this._refreshSessionKeyByApi(e)];case 11:return s.sent(),this.complete(),[3,22];case 12:return r=s.sent(),this._isSessionRelatedError(r)?t?[4,this._receiveNewAuthToken()]:[3,18]:[3,20];case 13:return (i=s.sent())?(this.auth.authToken=i,[4,this._refreshSessionKeyByApi(this.auth.authToken)]):[3,15];case 14:return s.sent(),this.complete(),[3,17];case 15:return [4,this.clear()];case 16:s.sent(),this.close(),s.label=17;case 17:return [3,19];case 18:throw r;case 19:return [3,21];case 20:throw r;case 21:return [3,22];case 22:return [2];}});});},t.prototype._receiveNewAuthToken=function(){var e=this,t=new ZC();return lk(function(){return cw(e,void 0,void 0,function(){var e,n,r,i,s=this;return lw(this,function(o){return this._isRefreshingAuthToken=!0,this.auth.clear(),this.handler.onSessionTokenRequired?(e=null,n=function(){e&&(clearTimeout(e),e=null);},r=function(e){n(),s._isRefreshingAuthToken&&(s._isRefreshingAuthToken=!1,s.dispatch("refresh-authtoken"),t.resolve(e));},i=function(e){n(),s._isRefreshingAuthToken&&(s._isRefreshingAuthToken=!1,t.reject(e));},e=setTimeout(function(){return i();},1e3*this._sdkState.sessionTokenRefreshTimeout),this.handler.onSessionTokenRequired(r,i)):t.resolve(null),[2];});});}),t.promise;},t.prototype._isSessionRelatedError=function(e){return e instanceof Iw&&(e.isSessionKeyExpiredError||e.isSessionTokenExpiredError||e.isSessionRevokedError);},Object.defineProperty(t.prototype,"isSessionKeyRefreshing",{get:function(){return this._isRefreshingSessionKey;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshingAuthToken",{get:function(){return this._isRefreshingAuthToken;},enumerable:!1,configurable:!0}),t.prototype.login=function(e){var t;return cw(this,void 0,void 0,function(){var n,r,i,s,o,a,u;return lw(this,function(c){switch(c.label){case 0:return n=e.key,r=e.ekey,i=e.userProfile,s=e.deviceTokenLastDeletedAt,o=void 0===s?0:s,this.auth.sessionKey=n,hk.set(this,r),this._deviceTokenCacheEnabled=null===(t=null==i?void 0:i.appInfo)||void 0===t?void 0:t.deviceTokenCache,a=this._cacheContext.preference,this._deviceTokenCacheEnabled?[4,a.get(ek)]:[3,5];case 1:return !(u=c.sent())||u.lastDeletedAt<o?(this._deviceTokens=[],this._deviceTokenLastDeletedAt=o,[4,this.saveDeviceToken()]):[3,3];case 2:return c.sent(),[3,4];case 3:this._deviceTokens=u.tokens.map(function(e){return new tk(tk.payloadify(e));}),this._deviceTokenLastDeletedAt=u.lastDeletedAt,c.label=4;case 4:return [3,7];case 5:return [4,a.remove(ek)];case 6:c.sent(),c.label=7;case 7:return [2];}});});},t.prototype.complete=function(){var e=this;this.dispatch("refresh"),lk(function(){return cw(e,void 0,void 0,function(){var e;return lw(this,function(t){return this._logger.debug("session refreshed"),(null===(e=this.handler)||void 0===e?void 0:e.onSessionRefreshed)&&this.handler.onSessionRefreshed(),[2];});});});},t.prototype.error=function(e){var t=this;lk(function(){return cw(t,void 0,void 0,function(){var t;return lw(this,function(n){return (null===(t=this.handler)||void 0===t?void 0:t.onSessionError)&&this.handler.onSessionError(e),[2];});});});},t.prototype.close=function(){var e=this;this.dispatch("close"),lk(function(){return cw(e,void 0,void 0,function(){var e;return lw(this,function(t){return this._logger.debug("session closed"),(null===(e=this.handler)||void 0===e?void 0:e.onSessionClosed)&&this.handler.onSessionClosed(),[2];});});});},t.prototype.refresh=function(){return cw(this,void 0,void 0,function(){var e,t;return lw(this,function(n){switch(n.label){case 0:if(!this.handler)return [3,10];if(this._isRefreshingSessionKey)return [3,10];if(this._isRefreshingSessionKey=!0,this.auth.authToken)return [3,7];n.label=1;case 1:return n.trys.push([1,6,,7]),[4,this._receiveNewAuthToken()];case 2:return (e=n.sent())?(this._logger.debug("session refreshing.."),this.auth.authToken=e,[3,5]):[3,3];case 3:return [4,this.clear()];case 4:return n.sent(),this._isRefreshingSessionKey=!1,[2];case 5:return [3,7];case 6:throw n.sent(),t=Iw.sessionTokenRequestFailed,this._dispatcher.dispatch(new ok()),this.error(t),this._isRefreshingSessionKey=!1,t;case 7:return n.trys.push([7,9,,10]),[4,this._refreshSessionKey(this.auth.authToken)];case 8:return n.sent(),this._isRefreshingSessionKey=!1,[3,10];case 9:throw n.sent(),t=Iw.sessionTokenRefreshFailed,this._dispatcher.dispatch(new ok()),this.error(t),this._isRefreshingSessionKey=!1,t;case 10:return [2];}});});},t.prototype.setDeviceToken=function(e,t){return !!(this._deviceTokenCacheEnabled&&this.indexOfDeviceToken(e,t)<0)&&(this._deviceTokens.push(new tk({type:e,token:t})),!0);},t.prototype.unsetDeviceToken=function(e,t){if(this._deviceTokenCacheEnabled){var n=this.indexOfDeviceToken(e,t);n>=0&&this._deviceTokens.splice(n,1);}},t.prototype.unsetDeviceTokens=function(e){this._deviceTokenCacheEnabled&&(this._deviceTokens=e?this._deviceTokens.filter(function(t){return t.type!==e;}):[]);},t.prototype.setDeviceTokenDeletedAt=function(e){e>0&&(this._deviceTokenLastDeletedAt=e);},t.prototype.saveDeviceToken=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return this._deviceTokenCacheEnabled?[4,this._cacheContext.preference.set(ek,{tokens:this._deviceTokens,lastDeletedAt:this._deviceTokenLastDeletedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return [2];}});});},t.prototype.clear=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return this.currentUser=null,this.auth.clear(),this.close(),hk.delete(this),this._deviceTokens=[],this._deviceTokenLastDeletedAt=0,[4,this.saveDeviceToken()];case 1:return e.sent(),[2];}});});},t;}(Xw),pk=function(){function e(){this.type=KC.NONE,this.name="none";}return e.prototype.run=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(e){return [2];});});},e.prototype.onConnect=function(e,t){return cw(this,void 0,void 0,function(){return lw(this,function(e){return [2];});});},e.prototype.onReconnect=function(e,t){return t.resetReconnectCount,cw(this,void 0,void 0,function(){return lw(this,function(e){return [2];});});},e.prototype.onDisconnect=function(e,t){return t.error,t.autoReconnect,cw(this,void 0,void 0,function(){return lw(this,function(e){return [2];});});},e.prototype.onDisconnectWebSocket=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(e){return [2];});});},e.prototype.onLogout=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(e){return [2];});});},e;}(),vk=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=KC.LOGOUT,t.name="logout",t;}return aw(t,e),t.prototype.run=function(e){return cw(this,void 0,void 0,function(){var t,n,r=this;return lw(this,function(i){switch(i.label){case 0:return t=Date.now(),n=e.sdkState.userId,[4,e.logout()];case 1:return i.sent(),[4,e.changeState(new bk(),t)];case 2:return i.sent(),lk(function(){return cw(r,void 0,void 0,function(){return lw(this,function(t){return e.connectionHandlers.forEach(function(e){e.onDisconnected&&e.onDisconnected(n);}),[2];});});}),[2];}});});},t;}(pk),_k=function(e){function t(){var t=e.call(this)||this;return t.type=KC.EXTERNAL_DISCONNECTED,t.name="externaldisconnected",t;}return aw(t,e),t.prototype.run=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,e.disconnect()];case 1:return t.sent(),[2];}});});},t.prototype.onConnect=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new Ek({authToken:t}),n)];case 2:return r.sent(),[2];}});});},t.prototype.onReconnect=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new mk(),t)];case 1:return n.sent(),[2];}});});},t.prototype.onLogout=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new vk(),t)];case 1:return n.sent(),[2];}});});},t;}(pk),yk=function(e){function t(t){var n=t.autoReconnect,r=e.call(this)||this;return r.type=KC.INTERNAL_DISCONNECTED,r.name="internaldisconnected",r._autoReconnect=!1,r._autoReconnect=n,r;}return aw(t,e),t.prototype.run=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),this._autoReconnect?[4,e.changeState(new mk(),t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return [2];}});});},t.prototype.onConnect=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new Ek({authToken:t}),n)];case 2:return r.sent(),[2];}});});},t.prototype.onReconnect=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new mk(),t)];case 1:return n.sent(),[2];}});});},t.prototype.onDisconnectWebSocket=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new _k(),t)];case 1:return n.sent(),[2];}});});},t.prototype.onLogout=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new vk(),t)];case 1:return n.sent(),[2];}});});},t;}(pk),mk=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=KC.RECONNECTING,t.name="reconnecting",t._callbacks=[],t;}return aw(t,e),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0);},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._resetConnect=void 0,this._callbacks.forEach(function(t){return t(e);});},t.prototype.run=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a=this;return lw(this,function(u){switch(u.label){case 0:t=Date.now(),n=new ZC(),this._callbacks.push(function(e){return e?n.reject(e):n.resolve();}),lk(function(){return cw(a,void 0,void 0,function(){return lw(this,function(t){return e.connectionHandlers.forEach(function(e){e.onReconnectStarted&&e.onReconnectStarted();}),[2];});});}),u.label=1;case 1:return u.trys.push([1,4,,9]),r=e.sdkState.websocket,i=r.reconnectMaxRetry,s=r.reconnectRetryStrategy,[4,ck(function(t,n){return cw(a,void 0,void 0,function(){var r;return lw(this,function(i){switch(i.label){case 0:this._haltConnect=t,this._resetConnect=n,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.connect()];case 2:return i.sent(),[3,4];case 3:if(r=i.sent(),e.clearLoginTimer(),r instanceof Iw&&r.code===pw.CONNECTION_CANCELED)return t(r),[2];throw r;case 4:return [2];}});});},i,s)];case 2:return u.sent(),[4,e.changeState(new gk(),t)];case 3:return u.sent(),lk(function(){return cw(a,void 0,void 0,function(){return lw(this,function(t){return this._flushCallbacks(),e.connectionHandlers.forEach(function(e){e.onReconnectSucceeded&&e.onReconnectSucceeded();}),[2];});});}),[3,9];case 4:return o=u.sent(),ww(o)?[3,7]:o instanceof Iw?o.code===pw.CONNECTION_CANCELED?[3,6]:[4,e.changeState(new yk({autoReconnect:!1}),t)]:[3,6];case 5:u.sent(),u.label=6;case 6:return lk(function(){return cw(a,void 0,void 0,function(){return lw(this,function(t){return this._flushCallbacks(o),e.connectionHandlers.forEach(function(e){e.onReconnectFailed&&e.onReconnectFailed();}),[2];});});}),[3,8];case 7:throw o;case 8:return [3,9];case 9:return [2,n.promise];}});});},t.prototype.onConnect=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){return n=new ZC(),this._halt(Iw.connectionCanceled),e.cancelConnectForRetry(),this._callbacks.push(function(){var r=Date.now();e.changeState(new Ek({authToken:t}),r).then(function(){n.resolve();}).catch(function(e){n.reject(e);});}),[2,n.promise];});});},t.prototype.onReconnect=function(e,t){var n=t.resetReconnectCount,r=void 0!==n&&n;return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){return e=new ZC(),this._resetConnect&&r&&this._resetConnect(),this._callbacks.push(function(t){return t?e.reject(t):e.resolve();}),[2,e.promise];});});},t.prototype.onDisconnect=function(e,t){t.error;var n=t.autoReconnect,r=void 0===n||n;return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(Iw.connectionCanceled),[4,e.changeState(new yk({autoReconnect:r}),t)];case 1:return n.sent(),[2];}});});},t.prototype.onDisconnectWebSocket=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(Iw.connectionCanceled),[4,e.changeState(new _k(),t)];case 1:return n.sent(),[2];}});});},t.prototype.onLogout=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(Iw.connectionCanceled),[4,e.changeState(new vk(),t)];case 1:return n.sent(),[2];}});});},t;}(pk),gk=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=KC.CONNECTED,t.name="connected",t;}return aw(t,e),t.prototype.onReconnect=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),[4,e.changeState(new mk(),t)];case 2:return n.sent(),[2];}});});},t.prototype.onDisconnect=function(e,t){var n=t.autoReconnect;return cw(this,void 0,void 0,function(){var t;return lw(this,function(r){switch(r.label){case 0:return t=Date.now(),[4,e.changeState(new yk({autoReconnect:n}),t)];case 1:return r.sent(),[2];}});});},t.prototype.onDisconnectWebSocket=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new _k(),t)];case 1:return n.sent(),[2];}});});},t.prototype.onLogout=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new vk(),t)];case 1:return n.sent(),[2];}});});},t;}(pk),Ek=function(e){function t(t){var n=t.authToken,r=e.call(this)||this;return r.type=KC.CONNECTING,r.name="connecting",r._authToken="",r._callbacks=[],r._authToken=n,r;}return aw(t,e),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0);},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._callbacks.forEach(function(t){return t(e);});},t.prototype.run=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i=this;return lw(this,function(s){switch(s.label){case 0:t=Date.now(),n=new ZC(),this._callbacks.push(function(e){return e?n.reject(e):n.resolve();}),s.label=1;case 1:return s.trys.push([1,4,,10]),[4,ck(function(t){return cw(i,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:this._haltConnect=t,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.connect(this._authToken)];case 2:return r.sent(),[3,4];case 3:if(n=r.sent(),e.clearLoginTimer(),n instanceof Iw&&n.code===pw.CONNECTION_CANCELED)return t(n),[2];throw n;case 4:return [2];}});});},e.sdkState.websocket.connectMaxRetry)];case 2:return s.sent(),[4,e.changeState(new gk(),t)];case 3:return s.sent(),lk(function(){return cw(i,void 0,void 0,function(){return lw(this,function(t){return this._flushCallbacks(),e.connectionHandlers.forEach(function(t){t.onConnected&&t.onConnected(e.sdkState.userId);}),[2];});});}),[3,10];case 4:return r=s.sent(),ww(r)?[3,8]:[4,e.disconnect()];case 5:return s.sent(),r instanceof Iw?r.code===pw.CONNECTION_CANCELED?[3,7]:[4,e.changeState(new bk(),t)]:[3,7];case 6:s.sent(),s.label=7;case 7:return lk(function(){return cw(i,void 0,void 0,function(){return lw(this,function(e){return this._flushCallbacks(r),[2];});});}),[3,9];case 8:throw r;case 9:return [3,10];case 10:return [2,n.promise];}});});},t.prototype.onConnect=function(e){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){return e=new ZC(),this._callbacks.push(function(t){return t?e.reject(t):e.resolve();}),[2,e.promise];});});},t.prototype.onDisconnect=function(e,t){var n=t.error,r=void 0===n?null:n,i=t.autoReconnect,s=void 0!==i&&i;return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(null!=r?r:Iw.connectionCanceled),e.hasSession?[4,e.changeState(new yk({autoReconnect:s}),t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return [4,e.changeState(new vk(),t)];case 3:n.sent(),n.label=4;case 4:return [2];}});});},t.prototype.onDisconnectWebSocket=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(Iw.connectionCanceled),e.hasSession?[4,e.changeState(new _k(),t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return [4,e.changeState(new vk(),t)];case 3:n.sent(),n.label=4;case 4:return [2];}});});},t.prototype.onLogout=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=Date.now(),this._halt(Iw.connectionCanceled),[4,e.changeState(new vk(),t)];case 1:return n.sent(),[2];}});});},t;}(pk),bk=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=KC.INITIALIZED,t.name="initialized",t;}return aw(t,e),t.prototype.onConnect=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=Date.now(),[4,e.changeState(new Ek({authToken:t}),n)];case 1:return r.sent(),[2];}});});},t;}(pk),wk=function(e){function t(){return e.call(this,{code:"PING",payload:{id:Date.now(),active:1},ackRequired:!1})||this;}return aw(t,e),t;}(WC),Ik=function(){function e(e){var t=e.pingDelegate,n=e.sdkState,r=e.logger;this.pingDelegate=t,this.sdkState=n,this._logger=r;}return Object.defineProperty(e.prototype,"isWaiting",{get:function(){return !!this._pingTimeoutTimer;},enumerable:!1,configurable:!0}),e.prototype.ping=function(){var e,t=this;if(!this.sdkState.websocket)throw Iw.connectionRequired;var n=new wk();try{var r=null!==(e=this.sdkState.websocket.pongTimeout)&&void 0!==e?e:5e3;this._pingTimeoutTimer=setTimeout(function(){t._logger.debug("pinger.ping() timeout"),t.pingDelegate.error();},r),this.pingDelegate.send(n),this._logger.debug("pinger.ping()");}catch(e){this._logger.debug("pinger.ping() error",e),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0),this.pingDelegate.error();}return n;},e.prototype.pong=function(){this._logger.debug("pinger.pong()"),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0);},e.prototype.refreshTimer=function(){var e,t=this;if(!this.sdkState.websocket)throw Iw.connectionRequired;this._logger.debug("pinger.refreshTimer()");var n=null!==(e=this.sdkState.websocket.pingInterval)&&void 0!==e?e:15e3;this.stop(),this._pingTimer=setInterval(function(){t.ping();},n);},e.prototype.start=function(){this._logger.debug("pinger.start()"),this.refreshTimer(),this.ping();},e.prototype.stop=function(){this._logger.debug("pinger.stop()"),this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=void 0),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0);},e;}(),Tk=function(){function e(e){var t,n,r,i;this.isEnabled=null!==(t=e.enabled)&&void 0!==t&&t,this.feedChannels=null!==(n=e.feed_channels)&&void 0!==n?n:{},this.templateListToken=null!==(r=e.template_list_token)&&void 0!==r?r:null,this.settingsUpdatedAt=null!==(i=e.settings_updated_at)&&void 0!==i?i:0;}return e.payloadify=function(e){return eI(tI({enabled:e.isEnabled,feed_channels:e.feedChannels,template_list_token:e.templateListToken,settings_updated_at:e.settingsUpdatedAt}));},e;}(),Sk=function(){function e(e){var t;this.lastUpdatedAt=null!==(t=e.last_updated_at)&&void 0!==t?t:0;}return e.payloadify=function(e){return eI(tI({last_updated_at:e.lastUpdatedAt}));},e;}(),Ck=1048576,kk=function(){function e(e){var t,n,r,i,s;void 0===e&&(e={}),this.emojiHash=e.emoji_hash||"",this.uploadSizeLimit=e.file_upload_size_limit?e.file_upload_size_limit*Ck:Number.MAX_SAFE_INTEGER,this.useReaction=!!e.use_reaction,this.applicationAttributes=null!==(t=e.application_attributes)&&void 0!==t?t:[],this.premiumFeatureList=null!==(n=e.premium_feature_list)&&void 0!==n?n:[],this.deviceTokenCache=this.applicationAttributes.includes("sdk_device_token_cache"),this.enabledChannelMemberShipHistory=this.applicationAttributes.includes("channel_membership_history"),this.multipleFilesMessageFileCountLimit=null!==(r=e.multiple_file_send_max_size)&&void 0!==r?r:5,this.allowSdkStatsUpload=null===(i=e.allow_sdk_log_ingestion)||void 0===i||i,this.uikitConfigInfo=new Sk(null!==(s=e.uikit_config)&&void 0!==s?s:{}),this.notificationInfo=e.notifications?new Tk(e.notifications):null;}return e.payloadify=function(e){return eI(tI({emoji_hash:e.emojiHash,file_upload_size_limit:e.uploadSizeLimit/Ck,application_attributes:e.applicationAttributes,premium_feature_list:e.premiumFeatureList,use_reaction:e.useReaction,allow_sdk_log_ingestion:e.allowSdkStatsUpload,uikit_config:e.uikitConfigInfo?Sk.payloadify(e.uikitConfigInfo):null,notifications:e.notificationInfo?Tk.payloadify(e.notificationInfo):null}));},e;}(),Ak=function(){function e(e){this._iid="",this._iid=e;}return e.payloadify=function(e){return {};},e;}(),Nk=function(e){function t(t){var n=t.userId,r=t.metadata,i=e.call(this)||this;return i.method=nI.POST,i.path="".concat(iI,"/").concat(n,"/metadata"),i.params={metadata:r},i;}return aw(t,e),t;}(wI),Ok=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaData=n,r;}return aw(t,e),t;}(II),Rk=function(e){function t(t){var n=t.userId,r=t.metadata,i=t.upsert,s=e.call(this)||this;return s.method=nI.PUT,s.path="".concat(iI,"/").concat(n,"/metadata"),s.params={metadata:r,upsert:i},s;}return aw(t,e),t;}(wI),Dk=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metadata=n,r;}return aw(t,e),t;}(II),xk=function(e){function t(t){var n=t.userId,r=t.metadataKey,i=e.call(this)||this;return i.method=nI.DELETE,i.path="".concat(iI,"/").concat(n,"/metadata/").concat(r),i;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var Lk=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=nI.DELETE,r.path="".concat(iI,"/").concat(n,"/metadata"),r;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var Mk,Uk=function(e,t){var n=JSON.parse(JSON.stringify(e));return n._iid&&delete n._iid,t&&t(n),n;},Pk=function(e,t){var n=JSON.parse(JSON.stringify(e));return t&&t(n),n;},Fk=function(e){return {do:function(t){e||t();},throw:function(t){if(!e)throw t;}};};!function(e){e.ONLINE="online",e.OFFLINE="offline",e.NON_AVAILABLE="nonavailable";}(Mk||(Mk={}));var qk,Hk=function(e){function t(t,n){var r,i,s,o,a,u,c,l,d,h,f,p,v=this;return (v=e.call(this,t)||this).userId=null!==(i=null!==(r=n.guest_id)&&void 0!==r?r:n.user_id)&&void 0!==i?i:"",v.nickname=null!==(o=null!==(s=n.nickname)&&void 0!==s?s:n.name)&&void 0!==o?o:"",v.plainProfileUrl=null!==(u=null!==(a=n.profile_url)&&void 0!==a?a:n.image)&&void 0!==u?u:"",v.requireAuth=null!==(c=n.require_auth_for_profile_image)&&void 0!==c&&c,v.metaData=null!==(l=n.metadata)&&void 0!==l?l:{},v.connectionStatus=Mk.NON_AVAILABLE,Aw(Mk,n.is_online)?v.connectionStatus=n.is_online:kw("boolean",n.is_online)&&(v.connectionStatus=n.is_online?Mk.ONLINE:Mk.OFFLINE),v.isActive=null===(d=n.is_active)||void 0===d||d,v.lastSeenAt=null!==(h=n.last_seen_at)&&void 0!==h?h:null,v.preferredLanguages=n.preferred_languages?fw([],hw(n.preferred_languages),!1):null,v.friendDiscoveryKey=null!==(f=n.friend_discovery_key)&&void 0!==f?f:null,v.friendName=null!==(p=n.friend_name)&&void 0!==p?p:null,v;}return aw(t,e),t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),{user_id:t.userId,nickname:t.nickname,profile_url:t.plainProfileUrl,require_auth_for_profile_image:t.requireAuth,metadata:t.metaData,is_online:t.connectionStatus,is_active:t.isActive,last_seen_at:t.lastSeenAt,preferred_languages:t.preferredLanguages,friend_discovery_key:t.friendDiscoveryKey,friend_name:t.friendName})));},Object.defineProperty(t.prototype,"profileUrl",{get:function(){var e=tA.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl;},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return Uk(this);},t.prototype._isValidMetaData=function(e){return !Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map(function(t){return e[t];}).every(function(e){return kw("string",e);});},t.prototype._applyMetaData=function(e,t){var n=this;void 0===t&&(t=!1),Object.keys(e).forEach(function(r){t?delete n.metaData[r]:n.metaData[r]=e[r];});},t.prototype.createMetaData=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return Fk(this._isValidMetaData(e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Nk({userId:n.userId,metadata:e}),[4,r.send(i)];case 1:return s=a.sent(),o=s.as(Ok).metaData,this._applyMetaData(o),[2,this.metaData];}});});},t.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),cw(this,void 0,void 0,function(){var n,r,i,s,o,a;return lw(this,function(u){switch(u.label){case 0:return Fk(this._isValidMetaData(e)).throw(Iw.invalidParameters),n=tA.of(this._iid),r=n.sdkState,i=n.requestQueue,s=new Rk({userId:r.userId,metadata:e,upsert:t}),[4,i.send(s)];case 1:return o=u.sent(),a=o.as(Dk).metadata,this._applyMetaData(a),[2,this.metaData];}});});},t.prototype.deleteMetaData=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return Fk(kw("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new xk({userId:n.userId,metadataKey:e}),[4,r.send(i)];case 1:return o.sent(),this._applyMetaData(((s={})[e]=!0,s),!0),[2,this.metaData];}});});},t.prototype.deleteAllMetaData=function(){return cw(this,void 0,void 0,function(){var e,t,n,r;return lw(this,function(i){switch(i.label){case 0:return e=tA.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Lk({userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),this.metaData={},[2];}});});},t;}(Ak),jk=function(e){function t(t){var n=t.userProfile,r=e.call(this)||this;return r.userProfile=n,r;}return aw(t,e),t;}($w),Vk=function(){function e(e,t){var n,r,i,s,o,a,u,c,l,d,h,f,p,v;this._iid=e,this.appInfo=new kk(t),this.user=new Hk(e,t),this.connectedAt=null!==(n=t.login_ts)&&void 0!==n?n:0,this.firstConnectedAt=0,this.pingInterval=null!==(r=t.ping_interval)&&void 0!==r?r:15e3,this.pongTimeout=null!==(i=t.pong_timeout)&&void 0!==i?i:5e3,this.reconnectInterval=null!==(o=null===(s=t.reconnect)||void 0===s?void 0:s.interval)&&void 0!==o?o:3e3,this.reconnectMaxInterval=null!==(u=null===(a=t.reconnect)||void 0===a?void 0:a.max_interval)&&void 0!==u?u:6e4,this.reconnectRetryCount=null!==(l=null===(c=t.reconnect)||void 0===c?void 0:c.retry_cnt)&&void 0!==l?l:5,this.reconnectIntervalMultiple=null!==(h=null===(d=t.reconnect)||void 0===d?void 0:d.mul)&&void 0!==h?h:2,this.maxUnreadCountOnSuperGroup=null!==(f=t.max_unread_cnt_on_super_group)&&void 0!==f?f:100,this.profileImageEncryption=!!t.profile_image_encryption,this.concurrentCallLimit=null!==(p=t.concurrent_call_limit)&&void 0!==p?p:5,this.backOffDelay=null!==(v=t.back_off_delay)&&void 0!==v?v:100;}return e.payloadify=function(e){return eI(tI(uw(uw(uw({},Hk.payloadify(e.user)),kk.payloadify(e.appInfo)),{login_ts:e.connectedAt,ping_interval:e.pingInterval,pong_timeout:e.pongTimeout,reconnect:{interval:e.reconnectInterval,max_interval:e.reconnectMaxInterval,retry_cnt:e.reconnectRetryCount,mul:e.reconnectIntervalMultiple},max_unread_cnt_on_super_group:e.maxUnreadCountOnSuperGroup,profile_image_encryption:e.profileImageEncryption,concurrent_call_limit:e.concurrentCallLimit,back_off_delay:e.backOffDelay})));},e.prototype.apply=function(){var e=this.reconnectInterval,t=this.reconnectMaxInterval,n=this.reconnectIntervalMultiple,r=tA.of(this._iid);r.sdkState.websocket&&(r.sdkState.websocket.pingInterval=1e3*this.pingInterval,r.sdkState.websocket.pongTimeout=1e3*this.pongTimeout,r.sdkState.websocket.reconnectMaxRetry=this.reconnectRetryCount,r.sdkState.websocket.reconnectRetryStrategy={calcTimeout:function(r){return r>0?1e3*Math.min(e*Math.pow(n,r-1),t):10;}}),r.appInfo=this.appInfo,r.sessionManager.currentUser=this.user,r.connectedAt=this.connectedAt,this.firstConnectedAt||(r.firstConnectedAt=this.connectedAt),r.maxSuperGroupChannelUnreadCount=this.maxUnreadCountOnSuperGroup,r.concurrentCallLimit=this.concurrentCallLimit,r.backOffDelay=this.backOffDelay,r.dispatcher.dispatch(new jk({userProfile:this}));},e;}(),Gk=function(e){function t(t,n,r){var i,s,o,a=this;return (a=e.call(this,t,n,r)||this).error=null,a.userProfile=new Vk(t,r),a.deviceTokenLastDeletedAt=null!==(i=r.device_token_last_deleted_at)&&void 0!==i?i:0,a.key=null!==(s=r.key)&&void 0!==s?s:"",a.ekey=null!==(o=r.ekey)&&void 0!==o?o:"",a.error=r.error?new Iw(r):null,a;}return aw(t,e),t.asError=function(e){return new t("","LOGI",uw({user_id:"",error:!0},e));},t.prototype.applyTo=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return this.error?[3,4]:(t=tA.of(e))?[4,t.sessionManager.login(this)]:[3,2];case 1:return n.sent(),this.userProfile.apply(),[3,3];case 2:throw Iw.lostInstance;case 3:return [3,5];case 4:throw this.error;case 5:return [2];}});});},t;}(MI),zk=function(e){function t(t){var n=t.request,r=void 0===n||n,i=t.features,s=void 0===i?{}:i,o=t.options,a=void 0===o?{}:o,u=e.call(this)||this;return u.request=r,u.features=uw({localCache:!0},s),u.options=uw({ingestion:!0},a),u;}return aw(t,e),t;}($w),Bk=function(e){function t(t,n){var r,i=n.sdkState,s=n.cacheContext,o=n.connectionHandlers,a=n.sessionManager,u=n.websocketClient,c=n.dispatcher,l=n.logger,d=n.entryState,h=void 0===d?new bk():d,f=this;return (f=e.call(this)||this)._stateUpdatedAt=0,f._connectingAt=0,f._connectionRequestQueue=[],f._iid=t,f.sdkState=i,f.cacheContext=s,f.connectionHandlers=o,f._sessionManager=a,f._websocketClient=u,f._dispatcher=c,f._logger=l,f._currentState=h,(null===(r=f.sdkState.websocket)||void 0===r?void 0:r.pingerDisabled)||(f._pinger=new Ik({pingDelegate:{send:function(e){return f._websocketClient.send(e);},error:function(e){return f._websocketClient.error(e);}},sdkState:f.sdkState,logger:l})),f._websocketClient.on("open",function(){f._tryResolveConnectionRequest();}).on("message",function(e){"LOGI"===e.code&&(f.clearLoginTimer(),f._dispatcher.dispatch(e.as(Gk)));}).on("ping-refresh",function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.refreshTimer();}).on("pong",function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.pong();}).on("error",function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.stop();}).on("close",function(){f._logiProcessingTimer=setTimeout(function(){f._logiProcessingTimer=void 0,f._unresolvedLogi||f._rejectConnectionRequest(Iw.networkError);},500);}),f._dispatcher.on(function(e){e instanceof Gk&&(f._unresolvedLogi=e,f._tryResolveConnectionRequest());}),f;}return aw(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSession",{get:function(){return this._sessionManager.auth.hasSession;},enumerable:!1,configurable:!0}),t.prototype.changeState=function(e,t){return cw(this,void 0,void 0,function(){return lw(this,function(n){switch(n.label){case 0:return t>=this._stateUpdatedAt?(this._currentState=e,this._stateUpdatedAt=t,this._dispatcher.dispatch(new JC({stateType:e.type})),this._logger.debug("connection state changes to ".concat(e.name)),[4,this._currentState.run(this)]):[3,2];case 1:return n.sent(),[2,!0];case 2:return [2,!1];}});});},t.prototype._tryResolveConnectionRequest=function(){var e;return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return t=this._unresolvedLogi,this._websocketClient.isOpen&&t?(this._unresolvedLogi=void 0,t.error?[3,2]:[4,t.applyTo(this._iid)]):[3,3];case 1:return r.sent(),n=t.userProfile,this._enableStatLog({request:n.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish"),features:{localCache:n.appInfo.applicationAttributes.includes("allow_sdk_feature_local_cache_log_publish")},options:{ingestion:n.appInfo.allowSdkStatsUpload}}),this._statLogConnection(),null===(e=this._pinger)||void 0===e||e.start(),this._connectionRequestQueue.forEach(function(e){return e.resolve();}),this._connectionRequestQueue=[],this.sdkState.appState="foreground",[3,3];case 2:this._sessionManager.auth.authToken=void 0,(t.error.isSessionKeyExpiredError||t.error.isSessionTokenExpiredError)&&this._dispatcher.dispatch(new SI({reason:t.error.code})),this._rejectConnectionRequest(t.error),r.label=3;case 3:return [2];}});});},t.prototype._rejectConnectionRequest=function(e){var t;if(null===(t=this._pinger)||void 0===t||t.stop(),this.clearLoginTimer(),this._connectionRequestQueue.length>0){var n=this._connectionRequestQueue;this._connectionRequestQueue=[],n.forEach(function(t){return t.reject(e);}),this._statLogConnection(e);}},t.prototype._url=function(e){var t,n;void 0===e&&(e="");var r=this.sdkState,i=r.appId,s=r.appVersion,o=r.userId,a=r.extensions,u=r.sendbirdRuntimeEnvironment,c=this.cacheContext.localCacheEnabled,l=this._sessionManager.auth,d=null===(t=this.sdkState.websocket)||void 0===t?void 0:t.compression,h=!!(null!==(n=this.sdkState.extensions)&&void 0!==n?n:{}).sb_uikit,f=xI.userAgentWithExtension(a);return "".concat(this.sdkState.websocket.host,"/?p=JS&pv=").concat(encodeURIComponent(_w.OS_VERSION),"&sv=").concat(encodeURIComponent(_w.SDK_VERSION),"&ai=").concat(i).concat(s?"&av=".concat(s):"").concat(l.hasSession?"&key=".concat(encodeURIComponent(l.sessionKey)):"&user_id=".concat(encodeURIComponent(o),"&access_token=").concat(encodeURIComponent(e)),"&pmce=").concat(d?1:0,"&active=1&device_token_types=").concat(encodeURIComponent(["gcm","huawei","apns"].join(",")),"&SB-User-Agent=").concat(f,"&SB-SDK-User-Agent=").concat(encodeURIComponent(xI.sendbirdSdkUserAgentWithExtension(u)),"&Request-Sent-Timestamp=").concat(Date.now().toString(),"&include_extra_data=").concat(encodeURIComponent(String(["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash","multiple_file_send_max_size","notifications"]))).concat(this._sessionManager.handler?"&expiring_session=1":"","&use_local_cache=").concat(c?1:0,"&include_poll_details=1").concat(h?"&uikit_config=1":"");},t.prototype._enableStatLog=function(e){var t=e.request,n=e.features,r=e.options,i=void 0===r?{}:r;this._dispatcher.dispatch(new zk({request:t,features:n,options:i}));},t.prototype._statLogConnection=function(e){var t;this._dispatcher.dispatch(new CI(new OI({type:bI.WEBSOCKET_CONNECT,data:{host_url:null===(t=this.sdkState.websocket)||void 0===t?void 0:t.host,success:!e,latency:Date.now()-this._connectingAt,error_code:null==e?void 0:e.code,error_description:null==e?void 0:e.message}})));},t.prototype.connect=function(e){var t;return void 0===e&&(e=""),cw(this,void 0,void 0,function(){var n,r,i=this;return lw(this,function(s){return this._logiProcessingTimer&&(clearTimeout(this._logiProcessingTimer),this._logiProcessingTimer=void 0,this._rejectConnectionRequest(Iw.connectionCanceled)),n=this._url(e),r=new ZC(),this._connectionRequestQueue.push(r),1===this._connectionRequestQueue.length&&(this._connectingAt=Date.now(),this._loginTimer=setTimeout(function(){i._loginTimer=void 0,i._rejectConnectionRequest(Iw.loginTimeout);},null===(t=this.sdkState.websocket)||void 0===t?void 0:t.responseTimeout),e&&(this._sessionManager.auth.authToken=e),this._websocketClient.connect(n)),[2,r.promise];});});},t.prototype.cancelConnectForRetry=function(){this._dispatcher.dispatch(Gk.asError(Iw.connectionRenew));},t.prototype.disconnect=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._websocketClient.disconnect()];case 1:return e.sent(),[2];}});});},t.prototype.logout=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return this.sdkState.userId=void 0,this._unresolvedLogi=void 0,[4,this._sessionManager.clear()];case 1:return e.sent(),[4,this.disconnect()];case 2:return e.sent(),[2];}});});},t.prototype.clearLoginTimer=function(){this._loginTimer&&(clearTimeout(this._loginTimer),this._loginTimer=void 0);},t;}(Xw),Kk=function(){function e(e,t){var n=t.sdkState,r=t.cacheContext,i=t.connectionHandlers,s=t.sessionManager,o=t.websocketClient,a=t.dispatcher,u=t.logger,c=t.disableWebSocketCloseEventHandling,l=void 0!==c&&c;this._disableWebSocketCloseEventHandling=!1,this._externalCalledWebSocketClose=!1,this._logger=u,this._disableWebSocketCloseEventHandling=l,this._context=new Bk(e,{sdkState:n,cacheContext:r,connectionHandlers:i,sessionManager:s,websocketClient:o,dispatcher:a,logger:u}),this._sdkState=n,this._sessionManager=s,this._websocketClient=o;}return e.prototype._registerEventDispatcher=function(){var e=this;this._disableWebSocketCloseEventHandling||(this._clearEventDispatcher(),this._sessionEventDispatcherContext=this._sessionManager.on("refresh-authtoken",function(){e.isConnected||(e._logger.debug("try reconnect by session token refresh"),e.reconnect());}).on("refresh",function(){e.isConnecting||e.isConnected||(e._logger.debug("try reconnect by session key refresh"),e.reconnect());}),this._websocketEventDispatcherContext=this._websocketClient.on("close",function(){"foreground"!==e._sdkState.appState||e._externalCalledWebSocketClose||e._sessionManager.isRefreshingAuthToken||(e._logger.debug("try reconnect by websocket connection closed"),e.reconnect());}));},e.prototype._clearEventDispatcher=function(){this._sessionEventDispatcherContext&&(this._sessionEventDispatcherContext.close(),this._sessionEventDispatcherContext=void 0),this._websocketEventDispatcherContext&&(this._websocketEventDispatcherContext.close(),this._websocketEventDispatcherContext=void 0);},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this._context.currentState.type===KC.CONNECTED;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnecting",{get:function(){var e=this._context.currentState;return e.type===KC.CONNECTING||e.type===KC.RECONNECTING;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketClient",{get:function(){return this._websocketClient;},enumerable:!1,configurable:!0}),e.prototype.connect=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,t.onConnect(this._context,e)];case 1:return n.sent(),this._registerEventDispatcher(),[2];}});});},e.prototype.reconnect=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,e.onReconnect(this._context,{})];case 1:return t.sent(),[2];}});});},e.prototype.resetAndReconnect=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,e.onReconnect(this._context,{resetReconnectCount:!0})];case 1:return t.sent(),[2];}});});},e.prototype.background=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!0,[4,e.onDisconnect(this._context,{autoReconnect:!1})];case 1:return t.sent(),[2];}});});},e.prototype.disconnect=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,this._context.currentState.onDisconnect(this._context,{error:e,autoReconnect:!0})];case 1:return t.sent(),[2];}});});},e.prototype.disconnectWebSocket=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!0,[4,e.onDisconnectWebSocket(this._context)];case 1:return t.sent(),[2];}});});},e.prototype.logout=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return e=this._context.currentState,this._clearEventDispatcher(),[4,e.onLogout(this._context)];case 1:return t.sent(),[2];}});});},e;}(),Qk=function(e){function t(t){var n,r,i,s,o=t.type,a=t.data,u=t.ts,c=void 0===u?Date.now():u,l=e.call(this,{type:o,data:a,ts:c})||this;return l.date=new Date(c),l.key="".concat((n=l.date,r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0"),"".concat(r).concat(i).concat(s)),"_").concat(o),l;}return aw(t,e),t;}(OI),Wk=function(e){function t(t){var n=t.deviceId,r=t.statLogs,i=e.call(this)||this;return i.method=nI.POST,i.path="".concat(vI),i.params={device_id:n,log_entries:r.map(function(e){return OI.payloadify(e);})},i;}return aw(t,e),t;}(wI),Yk=function(e,t){var n,r;if(null!==e&&null!==t){var i=Object.keys(e),s=Object.keys(t),o=fw([],hw(new Set(fw(fw([],hw(i),!1),hw(s),!1))),!1),a={};try{for(var u=dw(o),c=u.next();!c.done;c=u.next()){var l=c.value,d=typeof e[l],h=typeof t[l];"undefined"===d?a[l]=t[l]:"undefined"===h?a[l]=e[l]:d!==h?a[l]=t[l]:"object"===d&&e[l]&&t[l]?a[l]=Yk(e[l],t[l]):a[l]=t[l];}}catch(e){n={error:e};}finally{try{c&&!c.done&&(r=u.return)&&r.call(u);}finally{if(n)throw n.error;}}return a;}return t;};!function(e){e[e.PENDING=0]="PENDING",e[e.COLLECT_ONLY=1]="COLLECT_ONLY",e[e.ENABLED=2]="ENABLED",e[e.DISABLED=3]="DISABLED";}(qk||(qk={}));var Zk,Xk=function(e){function t(t){var n=t.cacheContext,r=t.requestQueue,i=t.dispatcher,s=t.baseLimit,o=void 0===s?100:s,a=t.maxLimit,u=void 0===a?1e3:a,c=t.minLimit,l=void 0===c?10:c,d=e.call(this)||this;return d.queue=[],d.enabledState=qk.PENDING,d.isFlushing=!1,d.generation=1,d.lastFlushedAt=0,d._collectRequestStat=!0,d._collectFeatureLocalCacheStat=!0,d.deviceId=Yw(),d.cacheContext=n,d.requestQueue=r,d.dispatcher=i,d.baseLimit=o,d.limit=o,d.maxLimit=u,d.minLimit=l,d;}return aw(t,e),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this.enabledState===qk.ENABLED;},enumerable:!1,configurable:!0}),t.prototype._arrangeStat=function(){var e=[];this._collectRequestStat&&e.push.apply(e,fw([],hw(this.queue.filter(function(e){return e.type===bI.API_RESULT||e.type===bI.WEBSOCKET_CONNECT;})),!1)),this._collectFeatureLocalCacheStat&&e.push.apply(e,fw([],hw(this.queue.filter(function(e){return e.type===bI.FEATURE_LOCALCACHE;})),!1)),this.queue=e;},t.prototype._save=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return this.enabledState!==qk.ENABLED?[3,2]:[4,this.cacheContext.preference.set(this.key,{deviceId:this.deviceId,statLogs:this.queue.map(function(e){return OI.payloadify(e);}),generation:this.generation++,lastFlushedAt:this.lastFlushedAt})];case 1:e.sent(),this.dispatch("save",fw([],hw(this.queue),!1)),e.label=2;case 2:return [2];}});});},t.prototype._flush=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i;return lw(this,function(s){switch(s.label){case 0:if(!this.isEnabled)return [3,10];if(this.isFlushing)return [3,10];this.isFlushing=!0,s.label=1;case 1:return s.trys.push([1,5,9,10]),this._arrangeStat(),e=this.queue.filter(function(e){if(e instanceof Qk){var t=new Date(),n=hw([e.date.getFullYear(),t.getFullYear()],2),r=n[0],i=n[1];if(r<i)return !0;if(r===i){var s=hw([e.date.getMonth(),t.getMonth()],2),o=s[0],a=s[1];if(o<a)return !0;if(o===a){var u=hw([e.date.getDate(),t.getDate()],2);return u[0]<u[1];}}}return !1;}),t=this.queue.filter(function(e){return !(e instanceof Qk);}),(n=fw(fw([],hw(e),!1),hw(t),!1).slice(0,Math.min(this.limit,this.maxLimit))).length>0?(r=new Wk({deviceId:this.deviceId,statLogs:n}),[4,this.requestQueue.send(r)]):[3,4];case 2:return s.sent(),this.dispatch("flush",n),this.queue=fw(fw([],hw(e),!1),hw(t),!1).slice(n.length),[4,this._save()];case 3:s.sent(),s.label=4;case 4:return this.limit=this.baseLimit,this.lastFlushedAt=Date.now(),[3,10];case 5:return (i=s.sent())instanceof Iw?i.code!==pw.STAT_LOG_NOT_ALLOWED?[3,7]:[4,this.clear()]:[3,8];case 6:return s.sent(),this.enabledState=qk.DISABLED,[3,8];case 7:i.code===pw.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=qk.COLLECT_ONLY),s.label=8;case 8:return this.limit=this.limit+20,[3,10];case 9:return this.isFlushing=!1,[7];case 10:return [2];}});});},t.prototype.init=function(e){return cw(this,void 0,void 0,function(){var t,n,r=this;return lw(this,function(i){switch(i.label){case 0:return this.key=e,[4,this.cacheContext.preference.get(this.key)];case 1:return (t=i.sent())?(this.deviceId=t.deviceId,this.queue=t.statLogs.map(function(e){return new OI({type:e.stat_type,ts:e.ts,data:e.data});}),this.generation=t.generation,this.lastFlushedAt=t.lastFlushedAt,Date.now()-this.lastFlushedAt>=108e5&&this.queue.length>=this.minLimit?(n=Math.min(Math.floor(18e4*Math.random()),100),[4,ak(n)]):[3,4]):[3,4];case 2:return i.sent(),[4,this._flush()];case 3:i.sent(),i.label=4;case 4:return this.commandEventContext||(this.commandEventContext=this.dispatcher.on(function(e){if(e instanceof CI){var t=e.statLog;r.put(t);}else if(e instanceof zk){var n=e.request,i=e.features,s=e.options;r._collectRequestStat=n,r._collectFeatureLocalCacheStat=null==i?void 0:i.localCache,r._arrangeStat(),r._collectRequestStat||r._collectFeatureLocalCacheStat?r.enabledState=s.ingestion?qk.ENABLED:qk.COLLECT_ONLY:r.enabledState=qk.DISABLED,r.isEnabled?r.queue.length>=r.limit&&r._flush():r.clear();}})),[2];}});});},t.prototype.put=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return this.enabledState===qk.DISABLED?[3,3]:(e instanceof Qk?this._collectFeatureLocalCacheStat&&(t=hw(this.queue.filter(function(t){return t instanceof Qk&&t.key===e.key;}),1),(n=t[0])?n.data=Yk(n.data,e.data):this.queue.push(e)):this._collectRequestStat&&this.queue.push(e),[4,this._save()]);case 1:return r.sent(),this.queue.length>=this.limit?[4,this._flush()]:[3,3];case 2:r.sent(),r.label=3;case 3:return [2];}});});},t.prototype.clear=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return this.queue=[],this.generation=1,[4,this._save()];case 1:return e.sent(),[2];}});});},t.prototype.close=function(){this.commandEventContext&&(this.commandEventContext.close(),this.commandEventContext=void 0);},t;}(Xw);!function(e){e[e.NONE=0]="NONE",e[e.VERBOSE=1]="VERBOSE",e[e.DEBUG=2]="DEBUG",e[e.INFO=3]="INFO",e[e.WARN=4]="WARN",e[e.ERROR=5]="ERROR";}(Zk||(Zk={}));var Jk,$k=function(){function e(){this.level=Zk.WARN;}return e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Zk.VERBOSE&&console.log.apply(console,fw(["[verbose]"],hw(e),!1));},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Zk.DEBUG&&console.log.apply(console,fw(["[debug]"],hw(e),!1));},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Zk.INFO&&console.log.apply(console,fw(["[info]"],hw(e),!1));},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Zk.WARN&&console.warn.apply(console,fw(["[warn]"],hw(e),!1));},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Zk.ERROR&&console.error.apply(console,fw(["[error]"],hw(e),!1));},e;}(),eA={},tA=function(){function e(e,t){var n,r,i,s,o,a,u,c,l,d;if(this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map(),this.userEventHandlers=new Map(),!eA[e]){eA[e]=this;var h=null!==(n=t.options)&&void 0!==n?n:new xw(),f=this.sdkState={appId:t.appId,appVersion:null!==(r=t.appVersion)&&void 0!==r?r:"",appState:"foreground",userId:void 0,extensions:{},api:{host:null!==(i=t.apiHost)&&void 0!==i?i:"https://api-".concat(t.appId,".sendbird.com")},websocket:{host:null!==(s=t.websocketHost)&&void 0!==s?s:"wss://ws-".concat(t.appId,".sendbird.com"),pingerDisabled:!!t.noPingpong,pingInterval:void 0,pongTimeout:void 0,connectMaxRetry:2,compression:!0,reconnectMaxRetry:-1,reconnectRetryStrategy:new uk(),responseTimeout:h.websocketResponseTimeout},sessionTokenRefreshTimeout:h.sessionTokenRefreshTimeout};this.appInfo=void 0,this.subscribedUnreadMessageCount={all:0,feed:0,customTypes:{},ts:0};var p=this.logger=new $k();this.logger.level=null!==(o=t.logLevel)&&void 0!==o?o:Zk.WARN,this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map(),this.userEventHandlers=new Map();var v=this.cacheContext=new Uw({encryption:t.encryption,store:t.store,localCacheEnabled:null!==(a=t.localCacheEnabled)&&void 0!==a&&a,localCacheConfig:null!==(u=t.localCacheConfig)&&void 0!==u?u:new Qw()});this.debugMode=null!==(c=t.debugMode)&&void 0!==c&&c,this.maxSuperGroupChannelUnreadCount=_w.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,this.useMemberInfoInMessage=h.useMemberInfoInMessage,this.typingIndicatorInvalidateTime=h.typingIndicatorInvalidateTime,this.typingIndicatorThrottle=h.typingIndicatorThrottle,this.concurrentCallLimit=void 0,this.backOffDelay=void 0;var _=this.dispatcher=new Jw(),y=new Ww();this.requestQueue=new $C(e,{auth:y,sdkState:f,dispatcher:_,logger:p,useFetchCompat:t.useFetchCompat}),this.sessionManager=new fk({auth:y,cacheContext:v,sdkState:f,dispatcher:_,requestQueue:this.requestQueue,logger:p}),this.connectionManager=new Kk(e,{sdkState:f,cacheContext:this.cacheContext,connectionHandlers:this.connectionHandlers,dispatcher:_,sessionManager:this.sessionManager,websocketClient:this.requestQueue.commandRouter.websocketClient,disableWebSocketCloseEventHandling:null!==(l=t.disableWebSocketCloseEventHandling)&&void 0!==l&&l,logger:p}),this.statLogCollector=new Xk({cacheContext:this.cacheContext,requestQueue:this.requestQueue,dispatcher:_}),this.appStateToggleEnabled=null===(d=t.appStateToggleEnabled)||void 0===d||d;}return eA[e];}return e.of=function(e){if(eA[e])return eA[e];throw Iw.lostInstance;},e.clear=function(e){eA[e]&&delete eA[e];},e.prototype.hasExtension=function(e){return this.sdkState.extensions&&this.sdkState.extensions[e];},e;}(),nA=function(){function e(){}return e.prototype.init=function(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,s=t.requestQueue,o=t.logger;t.onlineDetector;var a=t.cacheContext;this._iid=e,this._cacheContext=a,this._sdkState=n,this._dispatcher=r,this._sessionManager=i,this._requestQueue=s,this._logger=o;},e;}();!function(e){e.OPEN="open",e.CLOSED="closed";}(Jk||(Jk={}));var rA,iA=function(e){switch(e){case"open":return Jk.OPEN;case"closed":return Jk.CLOSED;default:return null;}},sA=function(e){return !e||!!e.text&&kw("string",e.text);},oA=function(e){function t(t,n){var r,i,s,o,a,u,c,l=this;return (l=e.call(this,t)||this).pollId=0,l.id=0,l.text=null,l.voteCount=0,l.createdBy=null,l.createdAt=0,l.updatedAt=0,l._lastVotedAt=0,l.pollId=null!==(r=n.poll_id)&&void 0!==r?r:0,l.id=null!==(i=n.id)&&void 0!==i?i:0,l.text=null!==(s=n.text)&&void 0!==s?s:null,l.voteCount=null!==(o=n.vote_count)&&void 0!==o?o:0,l.createdBy=null!==(a=n.created_by)&&void 0!==a?a:null,l.createdAt=null!==(u=n.created_at)&&void 0!==u?u:0,l.updatedAt=null!==(c=n.updated_at)&&void 0!==c?c:0,l;}return aw(t,e),t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),{vote_count:t.voteCount,poll_id:t.pollId,text:t.text,created_at:t.createdAt,id:t.id,created_by:t.createdBy,updated_at:t.updatedAt})));},t;}(Ak),aA=function(e){function t(t,n){var r,i,s,o,a,u,c,l,d,h,f,p,v,_=this;return (_=e.call(this,t)||this).id=0,_.title=null,_.createdAt=0,_.updatedAt=0,_.closeAt=-1,_.status=Jk.CLOSED,_.messageId=0,_.data=null,_.voterCount=-1,_.options=[],_.createdBy=null,_.allowUserSuggestion=!1,_.allowMultipleVotes=!1,_.votedPollOptionIds=[],_.id=null!==(r=n.id)&&void 0!==r?r:0,_.title=null!==(i=n.title)&&void 0!==i?i:null,_.createdAt=null!==(s=n.created_at)&&void 0!==s?s:0,_.updatedAt=null!==(o=n.updated_at)&&void 0!==o?o:0,_.closeAt=null!==(a=n.close_at)&&void 0!==a?a:-1,_.status=null!==(u=iA(n.status))&&void 0!==u?u:Jk.CLOSED,_.messageId=null!==(c=n.message_id)&&void 0!==c?c:0,_.data=null!==(l=n.data)&&void 0!==l?l:null,_.voterCount=null!==(d=n.voter_count)&&void 0!==d?d:-1,_.options=n.options?n.options.map(function(e){return new oA(_._iid,e);}):[],_.createdBy=null!==(h=n.created_by)&&void 0!==h?h:null,_.allowUserSuggestion=null!==(f=n.allow_user_suggestion)&&void 0!==f&&f,_.allowMultipleVotes=null!==(p=n.allow_multiple_votes)&&void 0!==p&&p,_.votedPollOptionIds=null!==(v=n.voted_option_ids)&&void 0!==v?v:[],_;}return aw(t,e),t.prototype._applyPollUpdatePayload=function(e){var t,n,r,i,s,o,a,u,c=this;this.title=null!==(t=e.title)&&void 0!==t?t:this.title,this.updatedAt=null!==(n=e.updated_at)&&void 0!==n?n:this.updatedAt,this.closeAt=null!==(r=e.close_at)&&void 0!==r?r:this.closeAt,this.status=null!==(i=iA(e.status))&&void 0!==i?i:this.status,this.data=null!==(s=e.data)&&void 0!==s?s:this.data,this.voterCount=null!==(o=e.voter_count)&&void 0!==o?o:this.voterCount,e.options&&(this.options=e.options.map(function(e){return new oA(c._iid,e);}),this.votedPollOptionIds=e.options.filter(function(e){return e.vote_count>0;}).map(function(e){return e.id;})),this.allowUserSuggestion=null!==(a=e.allow_user_suggestion)&&void 0!==a?a:this.allowUserSuggestion,this.allowMultipleVotes=null!==(u=e.allow_multiple_votes)&&void 0!==u?u:this.allowMultipleVotes;},t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),{id:t.id,title:t.title,created_at:t.createdAt,updated_at:t.updatedAt,close_at:t.closeAt,status:t.status,message_id:t.messageId,data:t.data,voter_count:t.voterCount,options:t.options.map(function(e){return oA.payloadify(e);}),created_by:t.createdBy,allow_user_suggestion:t.allowUserSuggestion,allow_multiple_votes:t.allowMultipleVotes,voted_option_ids:t.votedPollOptionIds})));},t.prototype.applyPollUpdateEvent=function(e){var t=e._payload.poll;return !(!t||this.id!==t.id||t.updated_at<this.updatedAt||(this._applyPollUpdatePayload(t),0));},t.prototype.applyPollVoteEvent=function(e){if(this.id!==e.pollId)return !1;var t=this.options,n=t.map(function(e){return e.id;}),r=e._payload,i=Math.floor(r.ts/1e3);return r.updated_vote_counts.forEach(function(e){var r=n.indexOf(e.option_id);if(r>-1){var s=t[r];i>=s._lastVotedAt&&(s.voteCount=e.vote_count,s._lastVotedAt=i);}}),r.req_id&&r.voted_option_ids&&(this.votedPollOptionIds=r.voted_option_ids),"number"==typeof r.voter_count&&(this.voterCount=r.voter_count),!0;},t.prototype.serialize=function(){return Uk(this);},t;}(Ak);!function(e){e.UNKNOWN="UNKNOWN",e.EVENT_CHANNEL_CREATED="EVENT_CHANNEL_CREATED",e.EVENT_CHANNEL_UPDATED="EVENT_CHANNEL_UPDATED",e.EVENT_CHANNEL_DELETED="EVENT_CHANNEL_DELETED",e.EVENT_CHANNEL_READ="EVENT_CHANNEL_READ",e.EVENT_CHANNEL_DELIVERED="EVENT_CHANNEL_DELIVERED",e.EVENT_CHANNEL_INVITED="EVENT_CHANNEL_INVITED",e.EVENT_CHANNEL_JOINED="EVENT_CHANNEL_JOINED",e.EVENT_CHANNEL_LEFT="EVENT_CHANNEL_LEFT",e.EVENT_CHANNEL_ACCEPTED_INVITE="EVENT_CHANNEL_ACCEPTED_INVITE",e.EVENT_CHANNEL_DECLINED_INVITE="EVENT_CHANNEL_DECLINED_INVITE",e.EVENT_CHANNEL_OPERATOR_UPDATED="EVENT_CHANNEL_OPERATOR_UPDATED",e.EVENT_CHANNEL_BANNED="EVENT_CHANNEL_BANNED",e.EVENT_CHANNEL_UNBANNED="EVENT_CHANNEL_UNBANNED",e.EVENT_CHANNEL_MUTED="EVENT_CHANNEL_MUTED",e.EVENT_CHANNEL_UNMUTED="EVENT_CHANNEL_UNMUTED",e.EVENT_CHANNEL_FROZEN="EVENT_CHANNEL_FROZEN",e.EVENT_CHANNEL_UNFROZEN="EVENT_CHANNEL_UNFROZEN",e.EVENT_CHANNEL_HIDDEN="EVENT_CHANNEL_HIDDEN",e.EVENT_CHANNEL_UNHIDDEN="EVENT_CHANNEL_UNHIDDEN",e.EVENT_CHANNEL_RESET_HISTORY="EVENT_CHANNEL_RESET_HISTORY",e.EVENT_CHANNEL_TYPING_STATUS_UPDATE="EVENT_CHANNEL_TYPING_STATUS_UPDATE",e.EVENT_CHANNEL_MEMBER_COUNT_UPDATED="EVENT_CHANNEL_MEMBER_COUNT_UPDATED",e.EVENT_CHANNEL_METADATA_CREATED="EVENT_CHANNEL_METADATA_CREATED",e.EVENT_CHANNEL_METADATA_UPDATED="EVENT_CHANNEL_METADATA_UPDATED",e.EVENT_CHANNEL_METADATA_DELETED="EVENT_CHANNEL_METADATA_DELETED",e.EVENT_CHANNEL_METACOUNTER_CREATED="EVENT_CHANNEL_METACOUNTER_CREATED",e.EVENT_CHANNEL_METACOUNTER_UPDATED="EVENT_CHANNEL_METACOUNTER_UPDATED",e.EVENT_CHANNEL_METACOUNTER_DELETED="EVENT_CHANNEL_METACOUNTER_DELETED",e.EVENT_MESSAGE_SENT="EVENT_MESSAGE_SENT",e.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",e.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",e.EVENT_PINNED_MESSAGE_UPDATED="EVENT_PINNED_MESSAGE_UPDATED",e.REQUEST_CHANNEL="REQUEST_CHANNEL",e.REQUEST_CHANNEL_CHANGELOGS="REQUEST_CHANNEL_CHANGELOGS",e.REFRESH_CHANNEL="REFRESH_CHANNEL",e.CHANNEL_LASTACCESSEDAT_UPDATED="CHANNEL_LASTACCESSEDAT_UPDATED",e.SYNC_CHANNEL_BACKGROUND="SYNC_CHANNEL_BACKGROUND",e.SYNC_CHANNEL_CHANGELOGS="SYNC_CHANNEL_CHANGELOGS",e.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",e.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",e.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",e.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",e.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",e.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",e.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",e.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",e.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",e.REQUEST_MESSAGE="REQUEST_MESSAGE",e.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",e.EVENT_POLL_VOTED="EVENT_POLL_VOTED",e.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",e.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",e.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",e.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",e.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",e.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",e.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",e.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",e.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",e.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",e.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED";}(rA||(rA={})),uw({},rA);var uA,cA=function(e){function t(t){var n=t.messages,r=t.source,i=t.isWebSocketEventComing,s=void 0!==i&&i,o=e.call(this)||this;return o.messages=n,o.source=r,o.isWebSocketEventComing=s,o;}return aw(t,e),t;}($w),lA=function(e){function t(t){var n=t.messageIds,r=t.source,i=t.isWebSocketEventComing,s=void 0!==i&&i,o=e.call(this)||this;return o.messageIds=n,o.source=r,o.isWebSocketEventComing=s,o;}return aw(t,e),t;}($w),dA=function(e){function t(t){var n=t.reqId,r=t.source,i=e.call(this)||this;return i.reqId=n,i.source=r,i;}return aw(t,e),t;}($w),hA=function(e){function t(t){var n=t.polls,r=t.source,i=e.call(this)||this;return i.polls=n,i.source=r,i;}return aw(t,e),t;}($w),fA=function(e){function t(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i;}return aw(t,e),t;}($w),pA=function(e){function t(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i;}return aw(t,e),t;}($w),vA=function(){function e(e,t){var n;this.limit=20,this._isLoading=!1,this._hasNext=!0,this._token="",this._iid=e,this.limit=null!==(n=t.limit)&&void 0!==n?n:20;}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return this._isLoading;},enumerable:!1,configurable:!0}),e.prototype._validate=function(){return kw("number",this.limit)&&this.limit>0;},e;}(),_A=function(e){function t(t,n,r,i){var s=e.call(this,t,i)||this;return s.channelUrl=n,s.channelType=r,s;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&kw("string",this.channelUrl)&&Aw(Pw,this.channelType);},t;}(vA),yA=function(e){this.pollId=0,this.messageId=0,this.pollId=e.poll_id,this.messageId=e.message_id,this._payload=e;},mA=function(e){function t(t){var n=t.title,r=t.optionTexts,i=t.data,s=t.allowUserSuggestion,o=t.allowMultipleVotes,a=t.closeAt,u=e.call(this)||this;return u.method=nI.POST,u.path=fI,u.params={title:n,options:r,data:i,allow_user_suggestion:s,allow_multiple_votes:o,close_at:a},u;}return aw(t,e),t;}(wI),gA=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new aA(t,n),r;}return aw(t,e),t;}(II),EA=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,s=e.call(this)||this;return s.method=nI.GET,s.path="".concat(fI,"/").concat(encodeURIComponent(i)),s.params={channel_url:n,channel_type:r},s;}return aw(t,e),t;}(wI),bA=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new aA(t,n),r;}return aw(t,e),t;}(II),wA=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,s=t.pollOptionId,o=e.call(this)||this;return o.method=nI.GET,o.path="".concat(fI,"/").concat(encodeURIComponent(i),"/options/").concat(encodeURIComponent(s)),o.params={channel_url:n,channel_type:r},o;}return aw(t,e),t;}(wI),IA=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pollOption=new oA(t,n),r;}return aw(t,e),t;}(II),TA=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,s=t.token,o=e.call(this)||this;return o.method=nI.GET,o.path="".concat(_I(n),"/").concat(encodeURIComponent(r),"/polls/changelogs"),o.params=eI({change_ts:i,token:s}),o;}return aw(t,e),t;}(wI),SA=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedPolls=n.updated.map(function(e){return function(e,t){return new aA(e,t);}(t,e);}),r.deletedPollIds=n.deleted.map(function(e){return e;}),r.hasMore=n.has_more,r.nextToken=n.next,r;}return aw(t,e),t;}(II),CA={title:"",optionTexts:[],data:void 0,allowUserSuggestion:void 0,allowMultipleVotes:void 0,closeAt:-1},kA=function(e){return kw("string",e.title)&&(t=e.optionTexts,Ow("string",t)&&t.every(function(e){return ""!==e.trim();}))&&sA(e.data)&&kw("boolean",e.allowUserSuggestion,!0)&&kw("boolean",e.allowMultipleVotes,!0)&&kw("number",e.closeAt,!0);var t;},AA={channelUrl:"",channelType:Pw.BASE,pollId:0,pollOptionId:0},NA=function(e){return kw("string",e.channelUrl)&&""!==e.channelUrl&&Aw(Pw,e.channelType)&&kw("number",e.pollId)&&e.pollId>0&&kw("number",e.pollOptionId)&&e.pollOptionId>0;},OA={channelUrl:"",channelType:Pw.BASE,pollId:0},RA=function(e){return kw("string",e.channelUrl)&&""!==e.channelUrl&&Aw(Pw,e.channelType)&&kw("number",e.pollId);},DA={},xA=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,s=t.requestQueue,o=t.logger;this._iid=e,this._sdkState=n,this._sessionManager=i,this._requestQueue=s,this._dispatcher=r,this._logger=o,DA[e]=this;}return e.of=function(e){return DA[e];},e.prototype.buildPollFromSerializedData=function(e){var t=Pk(e);return new aA(this._iid,aA.payloadify(t));},e.prototype.get=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return Fk(RA(e)).throw(Iw.invalidParameters),t=new EA(uw({},e)),[4,this._requestQueue.send(t)];case 1:return [2,n.sent().as(bA).poll];}});});},e.prototype.create=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return Fk(kA(e)).throw(Iw.invalidParameters),t=new mA(uw({},e)),[4,this._requestQueue.send(t)];case 1:return [2,n.sent().as(gA).poll];}});});},e.prototype.getOption=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return Fk(NA(e)).throw(Iw.invalidParameters),t=new wA(uw({},e)),[4,this._requestQueue.send(t)];case 1:return [2,n.sent().as(IA).pollOption];}});});},e.prototype.getPollChangeLogs=function(e,t,n,r){return void 0===r&&(r=rA.SYNC_POLL_CHANGELOGS),cw(this,void 0,void 0,function(){var i,s,o,a,u,c,l;return lw(this,function(d){switch(d.label){case 0:return i=new TA(tI({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null})),[4,this._requestQueue.send(i)];case 1:return s=d.sent(),o=s.as(SA),a=o.updatedPolls,u=o.deletedPollIds,c=o.hasMore,l=o.nextToken,a.length>0&&this._dispatcher.dispatch(new hA({polls:a,source:r})),[2,{updatedPolls:a,deletedPollIds:u,hasMore:c,token:l}];}});});},e;}(),LA=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.token,s=t.limit,o=e.call(this)||this;return o.method=nI.GET,o.path=fI,o.params={channel_url:n,channel_type:r,token:i,limit:s},o;}return aw(t,e),t;}(wI),MA=function(e){function t(t,n){var r,i=this;return (i=e.call(this,t,n)||this).polls=(null!==(r=n.polls)&&void 0!==r?r:[]).map(function(e){return new aA(t,e);}),i.token=n.next,i;}return aw(t,e),t;}(II),UA=function(e){function t(t,n){return e.call(this,t,n.channelUrl,n.channelType,n)||this;}return aw(t,e),t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=tA.of(this._iid).requestQueue,t=new LA(uw(uw({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=o.sent(),r=n.as(MA),i=r.polls,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return [2,[]];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(_A),PA=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,s=t.pollOptionId,o=t.token,a=t.limit,u=e.call(this)||this;return u.method=nI.GET,u.path="".concat(fI,"/").concat(encodeURIComponent(i),"/options/").concat(encodeURIComponent(s),"/voters"),u.params={channel_url:n,channel_type:r,token:o,limit:a},u;}return aw(t,e),t;}(wI),FA=function(e){function t(t,n){var r,i=this;return (i=e.call(this,t,n)||this).voters=(null!==(r=n.voters)&&void 0!==r?r:[]).map(function(e){return new Hk(t,e);}),i.token=n.next,i;}return aw(t,e),t;}(II),qA=function(e){function t(t,n){var r=e.call(this,t,n.channelUrl,n.channelType,n)||this;return r.pollId=n.pollId,r.pollOptionId=n.pollOptionId,r;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&kw("number",this.pollId)&&kw("number",this.pollOptionId);},t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=tA.of(this._iid).requestQueue,t=new PA(uw(uw({},this),{pollId:this.pollId,pollOptionId:this.pollOptionId,token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=o.sent(),r=n.as(FA),i=r.voters,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return [2,[]];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(_A),HA=function(e){function t(t){var n=e.call(this)||this;if(n.method=nI.POST,n.path="".concat(sI),n.params=eI({file:t.file,channel_url:t.channelUrl}),t.thumbnailSizes)for(var r=0;r<t.thumbnailSizes.length;r++){var i=t.thumbnailSizes[r],s=i.maxWidth,o=i.maxHeight;n.params["thumbnail".concat(r+1)]="".concat(s,",").concat(o);}return n.requestId=t.requestId,n;}return aw(t,e),t;}(wI),jA=function(e){function t(t,n){var r,i,s,o=this;return (o=e.call(this,t,n)||this).url=n.url,o.fileSize=null!==(r=n.file_size)&&void 0!==r?r:0,o.thumbnailSizes=null!==(i=n.thumbnails)&&void 0!==i?i:[],o.requireAuth=null!==(s=n.require_auth)&&void 0!==s&&s,o;}return aw(t,e),t;}(II),VA=function(e){function t(t,n){var r,i,s,o=this;return (o=e.call(this,t)||this).replyCount=0,o.lastRepliedAt=0,o.updatedAt=0,o.replyCount=null!==(r=n.reply_count)&&void 0!==r?r:0,o.mostRepliedUsers=n.most_replies&&Ow("object",n.most_replies)?n.most_replies.map(function(e){return new Hk(o._iid,e);}):[],o.lastRepliedAt=null!==(i=n.last_replied_at)&&void 0!==i?i:0,o.updatedAt=null!==(s=n.updated_at)&&void 0!==s?s:0,o;}return aw(t,e),t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),{reply_count:t.replyCount,most_replies:Array.isArray(t.mostRepliedUsers)?t.mostRepliedUsers.map(function(e){return Hk.payloadify(e);}):[],last_replied_at:t.lastRepliedAt,updated_at:t.updatedAt})));},t;}(Ak);!function(e){e.ADD="add",e.DELETE="delete";}(uA||(uA={}));var GA,zA,BA=function(e){this.messageId=0,this.operation=null,this.updatedAt=0;var t=kw("string",e.msg_id)?parseInt(e.msg_id):e.msg_id,n=e.user_id,r=e.operation?e.operation.toLowerCase():null,i=e.reaction,s=e.updated_at;t&&kw("string",n)&&kw("string",r)&&Aw(uA,r)&&kw("string",i)&&i&&kw("number",s)&&(this.messageId=t,this.userId=n,this.key=i,this.operation=r,this.updatedAt=s);},KA=function(){function e(e){var t,n,r,i=e.key,s=null!==(r=fw([],hw(e.user_ids),!1))&&void 0!==r?r:[],o=e.updated_at;kw("string",i)&&i&&Ow("string",s)&&s.length>0&&kw("number",o)&&(this.key=i,this.userIds=s,this.updatedAt=o);var a={};try{for(var u=dw(this.userIds),c=u.next();!c.done;c=u.next())a[c.value]=this.updatedAt;}catch(e){t={error:e};}finally{try{c&&!c.done&&(n=u.return)&&n.call(u);}finally{if(t)throw t.error;}}this._version=a;}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.userIds.length;},enumerable:!1,configurable:!0}),e.payloadify=function(e){return eI(tI({key:e.key,user_ids:e.userIds,updated_at:e.updatedAt}));},e.prototype.applyEvent=function(e){if(e.key===this.key&&this.updatedAt<=e.updatedAt){if(!this._version[e.userId]||this._version[e.userId]<=e.updatedAt){var t=this.userIds.indexOf(e.userId);switch(e.operation){case uA.ADD:t<0&&this.userIds.push(e.userId);break;case uA.DELETE:t>=0&&this.userIds.splice(t,1);}this._version[e.userId]=e.updatedAt;}this.updatedAt=Math.max(this.updatedAt,e.updatedAt);}},e;}(),QA=function(){function e(e){this.key=e.key,this.value=Ow("string",e.value)?fw([],hw(e.value),!1):[];}return e.payloadify=function(e){var t;return eI(tI({key:e.key,value:null!==(t=e.value)&&void 0!==t?t:[]}));},e;}(),WA=function(){function e(e){this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,this.url=e.url,e.secure_url&&(this.secureUrl=e.secure_url),e.type&&(this.type=e.type),e.width&&(this.width=e.width),e.height&&(this.height=e.height),e.alt&&(this.alt=e.alt);}return e.payloadify=function(e){var t,n;return eI(tI({url:e.url,secure_url:e.secureUrl,type:e.type,width:null!==(t=e.width)&&void 0!==t?t:0,height:null!==(n=e.height)&&void 0!==n?n:0,alt:e.alt}));},e;}(),YA=function(){function e(e){this.title=null,this.url=null,this.description=null,this.defaultImage=null,e["og:title"]&&(this.title=e["og:title"]),e["og:url"]&&(this.url=e["og:url"]),e["og:description"]&&(this.description=e["og:description"]),e["og:image"]&&(this.defaultImage=new WA(e["og:image"]));}return e.payloadify=function(e){return eI(tI({"og:title":e.title,"og:url":e.url,"og:description":e.description,"og:image":e.defaultImage?WA.payloadify(e.defaultImage):null}));},e;}(),ZA=function(){function e(e){var t,n;this.volume=0,this.name=null!==(t=e.name)&&void 0!==t?t:"default",this.volume=null!==(n=e.volume)&&void 0!==n?n:1;}return e.prototype.serialize=function(){return {name:this.name,volume:this.volume};},e.payloadify=function(e){return eI(tI({name:e.name,volume:e.volume}));},e;}(),XA=function(e){function t(t,n){var r,i=this;return (i=e.call(this,t,n)||this).isBlockedByMe=!1,i.role=Aw(Fw,n.role)?n.role:Fw.NONE,i.isBlockedByMe=null!==(r=n.is_blocked_by_me)&&void 0!==r&&r,i;}return aw(t,e),t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),{role:t.role,is_blocked_by_me:t.isBlockedByMe})));},t;}(Hk);!function(e){e.PENDING="pending",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled";}(GA||(GA={})),function(e){e.PENDING="pending",e.IN_QUEUE="in_queue",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled",e.REMOVED="removed";}(zA||(zA={}));var JA,$A=function(e){switch(e){case Hw.BASE:return "";case Hw.USER:return "MESG";case Hw.FILE:return "FILE";case Hw.ADMIN:return "ADMM";}},eN=function(e){function t(t,n){var r,i,s,o,a,u,c,l,d,h,f,p,v,_,y,m,g=this;(g=e.call(this,t)||this).channelType=Pw.BASE,g.parentMessage=null,g.silent=!1,g.isOperatorMessage=!1,g.messageType=Hw.BASE,g.mentionType=null,g.threadInfo=null,g.reactions=[],g.metaArrays=[],g.appleCriticalAlertOptions=null,g.createdAt=0,g.updatedAt=0,g.scheduledInfo=null,g.extendedMessage={},g._isContinuousMessages=!1,g._scheduledStatus=null,g.messageId=null!==(i=null!==(r=n.msg_id)&&void 0!==r?r:n.message_id)&&void 0!==i?i:0,g.channelUrl=n.channel_url,g.channelType=Aw(Pw,n.channel_type)?n.channel_type:Pw.GROUP,n.channel&&(n.channel.channel_url&&(g.channelUrl=n.channel.channel_url),n.channel.channel_type&&(g.channelType=n.channel.channel_type)),g.parentMessageId=null!==(s="string"==typeof n.parent_message_id?parseInt(n.parent_message_id):n.parent_message_id)&&void 0!==s?s:0,g.data=null!==(o=n.data)&&void 0!==o?o:"",g.customType=null!==(a=n.custom_type)&&void 0!==a?a:"",g.mentionType=Aw(Gw,n.mention_type)?n.mention_type:null,g.mentionedUsers=n.mentioned_users?n.mentioned_users.map(function(e){return new Hk(g._iid,e);}):null,g.mentionedUserIds=null!==(u=n.mentioned_user_ids)&&void 0!==u?u:null,g.mentionedUsers&&!g.mentionedUserIds&&(g.mentionedUserIds=g.mentionedUsers.map(function(e){return e.userId;})),g.mentionedMessageTemplate=null!==(c=n.mentioned_message_template)&&void 0!==c?c:"",g.threadInfo=n.thread_info?new VA(g._iid,n.thread_info):null,g.reactions=n.reactions?n.reactions.map(function(e){return new KA(e);}):[];var E=null!==(l=n.metaarray)&&void 0!==l?l:{},b=null!==(d=n.metaarray_key_order)&&void 0!==d?d:Object.keys(E).sort(function(e,t){return e.localeCompare(t);});g.metaArrays=[];for(var w=0;w<b.length;w++){var I=b[w];g.metaArrays.push(new QA({key:I,value:E[I]||[]}));}return n.sorted_metaarray&&(g.metaArrays=n.sorted_metaarray.map(function(e){return new QA(e);})),g.ogMetaData=n.og_tag?new YA(n.og_tag):null,g.silent=null!==(h=n.silent)&&void 0!==h&&h,g.isOperatorMessage=null!==(f=n.is_op_msg)&&void 0!==f&&f,g.appleCriticalAlertOptions=n.apple_critical_alert_options?new ZA(n.apple_critical_alert_options):null,g.createdAt=null!==(v=null!==(p=n.created_at)&&void 0!==p?p:n.ts)&&void 0!==v?v:0,g.updatedAt=null!==(_=n.updated_at)&&void 0!==_?_:0,"number"==typeof n.scheduled_message_id&&"number"==typeof n.scheduled_at&&n.scheduled_status&&(g.scheduledInfo={scheduledMessageId:n.scheduled_message_id,scheduledAt:n.scheduled_at},g._scheduledStatus=n.scheduled_status),g.extendedMessage=null!==(y=n.extended_message)&&void 0!==y?y:{},g._isContinuousMessages=null!==(m=n.is_continuous_messages)&&void 0!==m&&m,g;}return aw(t,e),t.payloadify=function(t){var n,r,i,s;return eI(tI(uw(uw({},e.payloadify.call(this,t)),{channel_url:t.channelUrl,channel_type:t.channelType,message_id:t.messageId,type:$A(t.messageType),parent_message_id:t.parentMessageId,data:t.data,custom_type:t.customType,mention_type:t.mentionType,mentioned_user_ids:t.mentionedUserIds,mentioned_users:null===(n=t.mentionedUsers)||void 0===n?void 0:n.map(function(e){return Hk.payloadify(e);}),mentioned_message_template:t.mentionedMessageTemplate,thread_info:t.threadInfo?VA.payloadify(t.threadInfo):null,reactions:t.reactions.map(function(e){return KA.payloadify(e);}),sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map(function(e){return QA.payloadify(e);}),og_tag:t.ogMetaData?YA.payloadify(t.ogMetaData):null,silent:t.silent,is_op_msg:t.isOperatorMessage,apple_critical_alert_options:t.appleCriticalAlertOptions?ZA.payloadify(t.appleCriticalAlertOptions):null,created_at:t.createdAt,updated_at:t.updatedAt,scheduled_message_id:null===(i=t.scheduledInfo)||void 0===i?void 0:i.scheduledMessageId,scheduled_at:null===(s=t.scheduledInfo)||void 0===s?void 0:s.scheduledAt,scheduled_status:t._scheduledStatus,extended_message:t.extendedMessage})));},t._getParentMessageInfoPayload=function(e){return eI(tI({type:$A(e.messageType),ts:e.createdAt,user:e.sender?XA.payloadify(e.sender):null,message:e.message,file:{url:e.plainUrl,name:e.name,type:e.type,require_auth:e.requireAuth}}));},t.prototype.isIdentical=function(e){return this.messageId===e.messageId;},t.prototype.isEqual=function(e){return Cw(this,e);},t.prototype.isUserMessage=function(){return this.messageType===Hw.USER;},t.prototype.isFileMessage=function(){return this.messageType===Hw.FILE&&!Object.prototype.hasOwnProperty.call(this,"fileInfoList");},t.prototype.isMultipleFilesMessage=function(){return this.messageType===Hw.FILE&&Object.prototype.hasOwnProperty.call(this,"fileInfoList");},t.prototype.isAdminMessage=function(){return this.messageType===Hw.ADMIN;},t.prototype.serialize=function(){return Uk(this);},t.prototype.getMetaArraysByKeys=function(e){return this.metaArrays.filter(function(t){return e.includes(t.key);});},t.prototype.applyThreadInfoUpdateEvent=function(e){return this.messageId===e.targetMessageId&&(this.threadInfo=e.threadInfo),!1;},t.prototype.applyReactionEvent=function(e){if(this.messageId===e.messageId){for(var t=!1,n=0;n<this.reactions.length;n++)if(this.reactions[n].key===e.key){this.reactions[n].applyEvent(e),this.reactions[n].isEmpty&&this.reactions.splice(n,1),t=!0;break;}t||"add"!==e.operation||this.reactions.push(new KA(KA.payloadify({key:e.key,userIds:[e.userId],updatedAt:e.updatedAt})));}},t.prototype.applyParentMessage=function(e){if(!this.parentMessage)return this.parentMessage=e,!0;if(this.parentMessageId===e.messageId){var t=this.parentMessage.updatedAt;if(e.updatedAt>=t)return this.parentMessage=e,!0;}return !1;},t;}(Ak),tN=function(e){function t(t,n){var r,i,s,o,a=this;if((a=e.call(this,t,n)||this).reqId="",a.replyToChannel=!1,a.errorCode=0,a.sender=n.user?new XA(a._iid,n.user):n.sender_id,a.reqId=null!==(i=null!==(r=n.req_id)&&void 0!==r?r:n.request_id)&&void 0!==i?i:"",a.replyToChannel=null!==(s=n.is_reply_to_channel)&&void 0!==s&&s,n.request_state&&Aw(Kw,n.request_state)&&(a.sendingStatus=n.request_state),!a.sendingStatus)if(a.messageId>0)a.sendingStatus=Kw.SUCCEEDED;else if(a.scheduledInfo)switch(n.scheduled_status&&(a._scheduledStatus=n.scheduled_status),n.scheduled_status){case zA.SENT:case zA.IN_QUEUE:a.sendingStatus=Kw.SUCCEEDED;break;case zA.PENDING:a.sendingStatus=Kw.SCHEDULED;break;case zA.FAILED:case zA.REMOVED:a.sendingStatus=Kw.FAILED;break;case zA.CANCELED:a.sendingStatus=Kw.CANCELED;}else a.sendingStatus=Kw.PENDING;return a.errorCode=null!==(o=n.error_code)&&void 0!==o?o:0,a;}return aw(t,e),t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),{user:XA.payloadify(t.sender),req_id:t.reqId,is_reply_to_channel:t.replyToChannel,request_state:t.sendingStatus,error_code:t.errorCode})));},Object.defineProperty(t.prototype,"isResendable",{get:function(){return this.sendingStatus===Kw.FAILED&&function(e){return e>0&&Tw.indexOf(e)>=0;}(this.errorCode);},enumerable:!1,configurable:!0}),t.prototype.isIdentical=function(e){return this.messageId>0&&e.messageId>0?this.messageId===e.messageId:this.reqId===e.reqId;},t;}(eN),nN=function(){function e(e){var t,n;this.width=0,this.height=0,this.realWidth=0,this.realHeight=0,this.url=e.url,this.width=e.width,this.height=e.height,this.realWidth=null!==(t=e.real_width)&&void 0!==t?t:e.width,this.realHeight=null!==(n=e.real_height)&&void 0!==n?n:e.height;}return e.payloadify=function(e){return eI(tI({url:"",width:e.maxWidth,height:e.maxHeight,real_width:0,real_height:0}));},Object.defineProperty(e.prototype,"plainUrl",{get:function(){return this.url.split("?auth=")[0];},enumerable:!1,configurable:!0}),e;}(),rN={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:jw.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1},iN=function(e){return kw("number",e.prevResultSize)&&kw("number",e.nextResultSize)&&kw("boolean",e.isInclusive)&&kw("boolean",e.reverse)&&kw("string",e.messageTypeFilter)&&Aw(jw,e.messageTypeFilter)&&Ow("string",e.customTypesFilter,!0)&&Ow("string",e.senderUserIdsFilter,!0)&&kw("boolean",e.includeMetaArray)&&kw("boolean",e.includeReactions)&&kw("boolean",e.includeParentMessageInfo);},sN=function(e){function t(t,n){var r,i,s,o,a=this;if((a=e.call(this,t,n)||this).translations={},a.message=null!==(r=n.message)&&void 0!==r?r:"",a.messageType=Hw.ADMIN,a.translations=null!==(i=n.translations)&&void 0!==i?i:{},n.parent_message_info){var u=n.parent_message_info;a.parentMessage=lN(t,eI(tI(uw(uw({},u),{message_id:a.parentMessageId,channel_url:a.channelUrl,channel_type:a.channelType,file:u.file,url:null===(s=u.file)||void 0===s?void 0:s.url,require_auth:null===(o=u.file)||void 0===o?void 0:o.require_auth}))));}return a;}return aw(t,e),t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),{message:t.message,translations:t.translations,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})));},t.prototype.getThreadedMessagesByTimestamp=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=uw(uw({},rN),t),Fk(this.messageId>0&&kw("number",e)&&iN(n)).throw(Iw.invalidParameters),[4,WD.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return [2,r.sent()];}});});},t;}(eN),oN=function(){function e(e){var t,n;this.detail={},this.type=null!==(t=e.type)&&void 0!==t?t:"",this.vendor=null!==(n=e.vendor)&&void 0!==n?n:"",e.detail&&kw("object",e.detail)&&!Array.isArray(e.detail)&&(this.detail=e.detail);}return e.payloadify=function(e){return eI(tI({type:e.type,vendor:e.vendor,detail:e.detail}));},e;}(),aN=function(e){function t(t,n){var r,i,s,o,a,u,c,l=this;if((l=e.call(this,t,n)||this).message="",l.messageParams=null,l.translations={},l.translationTargetLanguages=[],l.messageSurvivalSeconds=-1,l.plugins=[],l._poll=null,l.message=n.message,l.messageType=Hw.USER,l.translations=null!==(s=n.translations)&&void 0!==s?s:{},l.translationTargetLanguages=null!==(o=n.target_langs)&&void 0!==o?o:[],0===Object.keys(l.translations).length&&l.translationTargetLanguages.length>0)try{for(var d=dw(l.translationTargetLanguages),h=d.next();!h.done;h=d.next()){var f=h.value;l.translations[f]="";}}catch(t){r={error:t};}finally{try{h&&!h.done&&(i=d.return)&&i.call(d);}finally{if(r)throw r.error;}}if(l.messageSurvivalSeconds=null!==(a=n.message_survival_seconds)&&void 0!==a?a:-1,l.plugins=n.plugins?n.plugins.map(function(e){return new oN(e);}):[],l._poll=n.poll?new aA(l._iid,n.poll):null,n.parent_message_info){var p=n.parent_message_info;l.parentMessage=lN(t,eI(tI(uw(uw({},p),{created_at:p.ts,message_id:l.parentMessageId,channel_url:l.channelUrl,channel_type:l.channelType,file:p.file,url:null===(u=p.file)||void 0===u?void 0:u.url,require_auth:null===(c=p.file)||void 0===c?void 0:c.require_auth}))));}return l;}return aw(t,e),t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),{message:t.message,translations:t.translations,message_survival_seconds:t.messageSurvivalSeconds,plugins:t.plugins.map(function(e){return oN.payloadify(e);}),poll:t._poll?aA.payloadify(t._poll):null,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})));},t.prototype.getThreadedMessagesByTimestamp=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=uw(uw({},rN),t),Fk(this.messageId>0&&kw("number",e)&&iN(n)).throw(Iw.invalidParameters),[4,WD.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return [2,r.sent()];}});});},t.prototype.applyPoll=function(e){return !(this._poll&&this._poll.id===e.id&&this._poll.updatedAt>e.updatedAt||(this._poll=e,0));},Object.defineProperty(t.prototype,"poll",{get:function(){return this._poll;},enumerable:!1,configurable:!0}),t;}(tN),uN=function(e){function t(t,n){var r,i,s,o,a,u=this;(u=e.call(this,t)||this).plainUrl="",u.fileName=null,u.mimeType=null,u.fileSize=0,u.thumbnails=[],u._requireAuth=!1,u.plainUrl=null!==(r=n.url)&&void 0!==r?r:"",u.fileName=null!==(i=n.file_name)&&void 0!==i?i:null,u.mimeType=null!==(s=n.file_type)&&void 0!==s?s:null,u.fileSize=null!==(o=n.file_size)&&void 0!==o?o:0,u._requireAuth=null!==(a=n.require_auth)&&void 0!==a&&a;var c=tA.of(u._iid).sessionManager;return u.thumbnails=n.thumbnails?n.thumbnails.map(function(e){return new nN(uw(uw({},e),{url:"".concat(e.url.split("?auth=")[0]).concat(u._requireAuth?"?auth=".concat(c.ekey):"")}));}):[],u;}return aw(t,e),t.payloadify=function(e){var t;return eI(tI({url:e.plainUrl,file_name:e.fileName,file_type:e.mimeType,file_size:e.fileSize,thumbnails:null===(t=e.thumbnails)||void 0===t?void 0:t.map(function(e){return {url:e.url,width:e.width,height:e.height,real_width:e.realWidth,real_height:e.realHeight};}),require_auth:e._requireAuth}));},Object.defineProperty(t.prototype,"url",{get:function(){var e=tA.of(this._iid).sessionManager;return this._requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl;},enumerable:!1,configurable:!0}),t;}(Ak),cN=function(e){function t(t,n){var r,i,s,o,a,u=this;if((u=e.call(this,t,n)||this).messageParams=null,u.fileInfoList=[],u.messageSurvivalSeconds=-1,u.messageType=Hw.FILE,u.fileInfoList=null!==(i=null===(r=n.files)||void 0===r?void 0:r.map(function(e){return new uN(t,e);}))&&void 0!==i?i:[],u.messageSurvivalSeconds=null!==(s=n.message_survival_seconds)&&void 0!==s?s:-1,n.parent_message_info){var c=n.parent_message_info;u.parentMessage=lN(t,eI(tI(uw(uw({},c),{created_at:c.ts,message_id:u.parentMessageId,channel_url:u.channelUrl,channel_type:u.channelType,file:c.file,url:null===(o=c.file)||void 0===o?void 0:o.url,require_auth:null===(a=c.file)||void 0===a?void 0:a.require_auth}))));}return u;}return aw(t,e),t.prototype.getThreadedMessagesByTimestamp=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=uw(uw({},rN),t),Fk(this.messageId>0&&kw("number",e)&&iN(n)).throw(Iw.invalidParameters),[4,WD.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return [2,r.sent()];}});});},t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),{files:t.fileInfoList&&t.fileInfoList&&Array.isArray(t.fileInfoList)?t.fileInfoList.map(function(e){return uN.payloadify(e);}):null,message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})));},t._isMultipleFilesMessagePayload=function(e){var t=e.files;return Array.isArray(t)&&t.length>=2;},t._isMultipleFilesMessageSerializedData=function(e){var t=e.fileInfoList;return Array.isArray(t);},t;}(tN),lN=function(e,t){switch(t.type){case"MESG":return new aN(e,t);case"FILE":return cN._isMultipleFilesMessagePayload(t)?new cN(e,t):new dN(e,t);case"ADMM":case"BRDM":return new sN(e,t);}throw Iw.unknown;},dN=function(e){function t(t,n){var r,i,s,o,a,u,c,l,d,h,f,p,v,_,y=this;(y=e.call(this,t,n)||this).messageParams=null,y.plainUrl="",y.requireAuth=!1,y.thumbnails=[],y.messageSurvivalSeconds=-1,y.messageType=Hw.FILE;var m=n.file;y.plainUrl=(null!==(i=null!==(r=null==m?void 0:m.url)&&void 0!==r?r:n.url)&&void 0!==i?i:"").split("?auth=")[0],y.name=null!==(o=null!==(s=null==m?void 0:m.name)&&void 0!==s?s:n.name)&&void 0!==o?o:"File",y.size=null!==(u=null!==(a=null==m?void 0:m.size)&&void 0!==a?a:n.size)&&void 0!==u?u:0,y.data=null!==(l=null!==(c=null==m?void 0:m.data)&&void 0!==c?c:n.custom)&&void 0!==l?l:"",y.type=m?null!==(d=m.type)&&void 0!==d?d:"":null!==(h=n.type)&&void 0!==h?h:"";var g=tA.of(y._iid).sessionManager;if(y.requireAuth=null!==(f=n.require_auth)&&void 0!==f&&f,y.thumbnails=n.thumbnails?n.thumbnails.map(function(e){return new nN(uw(uw({},e),{url:"".concat(e.url.split("?auth=")[0]).concat(y.requireAuth?"?auth=".concat(g.ekey):"")}));}):[],y.messageSurvivalSeconds=null!==(p=n.message_survival_seconds)&&void 0!==p?p:-1,n.parent_message_info){var E=n.parent_message_info;y.parentMessage=lN(t,eI(tI(uw(uw({},E),{created_at:E.ts,message_id:y.parentMessageId,channel_url:y.channelUrl,channel_type:y.channelType,file:E.file,url:null===(v=E.file)||void 0===v?void 0:v.url,require_auth:null===(_=E.file)||void 0===_?void 0:_.require_auth}))));}return y;}return aw(t,e),t.payloadify=function(t){var n;return eI(tI(uw(uw({},e.payloadify.call(this,t)),{url:t.plainUrl,require_auth:t.requireAuth,file:{name:t.name,size:t.size,type:t.type,data:t.data},thumbnails:null===(n=t.thumbnails)||void 0===n?void 0:n.map(function(e){return {url:e.url,width:e.width,height:e.height,real_width:e.realWidth,real_height:e.realHeight};}),message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})));},Object.defineProperty(t.prototype,"url",{get:function(){var e=tA.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl;},enumerable:!1,configurable:!0}),t.prototype.getThreadedMessagesByTimestamp=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=uw(uw({},rN),t),Fk(this.messageId>0&&kw("number",e)&&iN(n)).throw(Iw.invalidParameters),[4,WD.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return [2,r.sent()];}});});},t;}(tN),hN=function(e){function t(t){var n,r,i,s=[];return t.mentionType===Gw.USERS&&(t.mentionedUserIds?s=t.mentionedUserIds:t.mentionedUsers&&(s=t.mentionedUsers.map(function(e){return e.userId;}))),e.call(this,{code:"FILE",ackRequired:!0,payload:eI(tI({channel_url:t.channelUrl,files:t.files?_N(t.files):null,url:t.url,name:null!==(n=t.fileName)&&void 0!==n?n:"",type:null!==(r=t.mimeType)&&void 0!==r?r:"",size:null!==(i=t.fileSize)&&void 0!==i?i:0,custom:t.data,custom_type:t.customType,thumbnails:t.thumbnailSizes,require_auth:t.requireAuth,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:s,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==Bw.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions?ZA.payloadify(t.appleCriticalAlertOptions):null,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,pin_message:t.isPinnedMessage}))})||this;}return aw(t,e),t;}(WC),fN=function(e){function t(t){var n,r,i=this;i=e.call(this)||this;var s=[];return t.mentionType===Gw.USERS&&(t.mentionedUserIds?s=t.mentionedUserIds:t.mentionedUsers&&(s=t.mentionedUsers.map(function(e){return e.userId;}))),i.method=nI.POST,i.path="".concat(_I(t.channelType),"/").concat(encodeURIComponent(t.channelUrl),"/messages"),i.params=eI(tI({message_type:Hw.FILE,user_id:t.userId,files:t.files?_N(t.files):null,url:t.fileUrl,mention_type:t.mentionType,mentioned_user_ids:s,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,data:t.data,custom_type:t.customType,thumbnails:null===(n=t.thumbnailSizes)||void 0===n?void 0:n.map(function(e){return nN.payloadify(e);}),require_auth:t.requireAuth,sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map(function(e){return QA.payloadify(e);}),push_option:t.pushNotificationDeliveryOption,parent_message_id:t.parentMessageId?t.parentMessageId:null,apple_critical_alert_options:t.appleCriticalAlertOptions?ZA.payloadify(t.appleCriticalAlertOptions):null,reply_to_channel:t.isReplyToChannel,req_id:t.reqId,pin_message:t.isPinnedMessage})),i;}return aw(t,e),t;}(wI),pN=function(e){function t(t,n,r){var i,s,o,a,u=this;(u=e.call(this,t,"FILE",r)||this).message=r.files&&r.files.length>=2?new cN(t,r):new dN(t,r);var c=tA.of(t).sdkState;return u.isMentioned=mI(u.message.mentionType,null!==(o=null!==(i=u.message.mentionedUserIds)&&void 0!==i?i:null===(s=u.message.mentionedUsers)||void 0===s?void 0:s.map(function(e){return e.userId;}))&&void 0!==o?o:[],c.userId),u.forceUpdateLastMessage=null!==(a=r.force_update_last_message)&&void 0!==a&&a,u;}return aw(t,e),t;}(MI),vN=function(e){function t(t,n){var r,i,s,o,a=this;(a=e.call(this,t,n)||this).message=n.files&&n.files.length>=2?new cN(t,n):new dN(t,n);var u=tA.of(t).sdkState;return a.isMentioned=mI(a.message.mentionType,null!==(s=null!==(r=a.message.mentionedUserIds)&&void 0!==r?r:null===(i=a.message.mentionedUsers)||void 0===i?void 0:i.map(function(e){return e.userId;}))&&void 0!==s?s:[],u.userId),a.forceUpdateLastMessage=null!==(o=n.force_update_last_message)&&void 0!==o&&o,a;}return aw(t,e),t;}(II);function _N(e){return e.map(function(e){var t,n;return eI(tI({url:e.fileUrl,file_name:e.fileName,file_type:e.mimeType,file_size:e.fileSize,thumbnails:null===(t=e.thumbnailSizes)||void 0===t?void 0:t.map(function(e){return nN.payloadify(e);}),require_auth:null===(n=e._uploadedMetaData)||void 0===n?void 0:n.requireAuth}));});}!function(e){e[e.PENDING=0]="PENDING",e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.SENDING=3]="SENDING",e[e.FAILED=4]="FAILED";}(JA||(JA={}));var yN,mN=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,s=t.onlineDetector,o=t.cacheContext,a=this;this._queueMap=new Map(),this._iid=e,this._sdkState=n,this._requestQueue=i,this._cacheContext=o,this._dispatcher=r,this._dispatcher.on(function(e){e instanceof JC&&(a._connectionState=e.stateType);}),this._onlineDetector=s;}return Object.defineProperty(e.prototype,"_shouldSendThroughWebSocket",{get:function(){return this._connectionState===KC.CONNECTED||this._connectionState===KC.CONNECTING||this._connectionState===KC.RECONNECTING;},enumerable:!1,configurable:!0}),e.prototype._sendFileMessage=function(e,t){return cw(this,void 0,void 0,function(){var n,r;return lw(this,function(i){switch(i.label){case 0:return n=this._createSendFileMessageRequestParams(e,t),this._shouldSendThroughWebSocket?(r=new hN(n),[4,this._requestQueue.send(r)]):[3,2];case 1:return [2,i.sent().as(pN).message];case 2:return r=new fN(uw(uw({},n),{userId:this._sdkState.userId})),[4,this._requestQueue.send(r)];case 3:return [2,i.sent().as(vN).message];}});});},e.prototype._createSendFileMessageRequestParams=function(e,t){var n=uw(uw({},t.params),{channelUrl:e.url,channelType:e.channelType,reqId:t.requestId,url:""});if(t.multipleFileUploadInfo){var r=t.params;n.files=r.fileInfoList;}else r=t.params,n.url=r.fileUrl,n.requireAuth=r.requireAuth;return n;},e.prototype._resolveMessageQueue=function(e){var t;return cw(this,void 0,void 0,function(){var n,r,i,s,o,a,u,c,l,d,h,f,p;return lw(this,function(v){switch(v.label){case 0:if(!(n=this._queueMap.get(e.url)))return [3,21];if(n.isResolving)return [3,20];n.isResolving=!0,r=[],i=!0,v.label=1;case 1:v.trys.push([1,15,16,17]),s=dw(n.messageQueue),o=s.next(),v.label=2;case 2:if(o.done)return [3,14];switch((a=o.value).state){case JA.PENDING:case JA.UPLOADING:return [3,3];case JA.UPLOADED:return [3,4];case JA.FAILED:return [3,12];}return [3,13];case 3:return i=!1,r.push(a),[3,13];case 4:if(!i)return [3,10];v.label=5;case 5:return v.trys.push([5,8,,9]),a.state=JA.SENDING,[4,this._sendFileMessage(e,a)];case 6:return u=v.sent(),a.deferred.resolve(u),[4,ak(100)];case 7:return v.sent(),[3,9];case 8:return c=v.sent(),a.deferred.reject(c),[3,9];case 9:return [3,11];case 10:r.push(a),v.label=11;case 11:return [3,13];case 12:return l=null!==(t=a.error)&&void 0!==t?t:Iw.unknown,a.deferred.reject(l.code===pw.REQUEST_CANCELED?Iw.fileUploadCanceled:l),[3,13];case 13:return o=s.next(),[3,2];case 14:return [3,17];case 15:return d=v.sent(),f={error:d},[3,17];case 16:try{o&&!o.done&&(p=s.return)&&p.call(s);}finally{if(f)throw f.error;}return [7];case 17:return h=n.isResolveRequestPending,n.messageQueue=r,n.isResolving=!1,n.isResolveRequestPending=!1,h?[4,this._resolveMessageQueue(e)]:[3,19];case 18:v.sent(),v.label=19;case 19:return [3,21];case 20:n.isResolveRequestPending=!0,v.label=21;case 21:return [2];}});});},e.prototype._uploadNextPendingItem=function(e){var t;return cw(this,void 0,void 0,function(){var n,r,i,s,o,a,u,c,l;return lw(this,function(d){switch(d.label){case 0:return (n=this._queueMap.get(e.url))&&(r=n.messageQueue.find(function(e){return e.state===JA.PENDING;}))?r.multipleFileUploadInfo?(i=r.multipleFileUploadInfo,s=i.uploadIndex,o=i.uploadCount,a=i.requestHandler,l=r.params,u=l.fileInfoList[s],!Dw(u.file)||(null===(t=u._uploadedMetaData)||void 0===t?void 0:t.isUploaded)?[3,2]:[4,this._tryUploadNextItemAndUpdateItemState(e,n,r)]):[3,4]:[3,9];case 1:return d.sent(),[3,3];case 2:r.state=s<o-1?JA.PENDING:JA.UPLOADED,d.label=3;case 3:return c=s,null==a||a._triggerOnFileUploaded(r.requestId,c,u,r.error),r.multipleFileUploadInfo.uploadIndex++,[3,7];case 4:return l=r.params,Dw(l.file)?[4,this._tryUploadNextItemAndUpdateItemState(e,n,r)]:[3,6];case 5:return d.sent(),[3,7];case 6:l.thumbnailSizes=[],r.state=JA.UPLOADED,d.label=7;case 7:return this._uploadNextPendingItem(e),[4,this._resolveMessageQueue(e)];case 8:d.sent(),d.label=9;case 9:return [2];}});});},e.prototype._tryUploadNextItemAndUpdateItemState=function(e,t,n){return cw(this,void 0,void 0,function(){var r,i,s,o,a,u;return lw(this,function(c){switch(c.label){case 0:return [4,this._onlineDetector.isOnline()];case 1:if(r=c.sent(),!tA.of(this._iid).sessionManager.currentUser||!r)return n.error=Iw.connectionRequired,n.state=JA.FAILED,[2];if(!(t.uploadQueue.length<6))return [3,9];n.state=JA.UPLOADING,t.uploadQueue.push(n),c.label=2;case 2:return c.trys.push([2,7,,8]),n.multipleFileUploadInfo?(i=n.multipleFileUploadInfo,s=i.uploadIndex,o=i.uploadCount,a=n.params,[4,this._uploadNextFileForMultipleFilesItemAndUpdateParams(e,n,a)]):[3,4];case 3:return c.sent(),n.state=s<o-1?JA.PENDING:JA.UPLOADED,[3,6];case 4:return a=n.params,[4,this._uploadNextFileForSingleFileItemAndUpdateParams(e,n,a)];case 5:c.sent(),n.state=JA.UPLOADED,c.label=6;case 6:return [3,8];case 7:return u=c.sent(),n.error=u.code===pw.REQUEST_FAILED?new Iw({code:pw.NETWORK_ERROR,message:"Failed to upload a file."}):u,n.state=JA.FAILED,[3,8];case 8:this._dequeueUploadItem(t,n),c.label=9;case 9:return [2];}});});},e.prototype._dequeueUploadItem=function(e,t){var n=e.uploadQueue.findIndex(function(e){return e.requestId===t.requestId;});n>=0&&e.uploadQueue.splice(n,1);},e.prototype._uploadNextFileForSingleFileItemAndUpdateParams=function(e,t,n){var r,i,s;return cw(this,void 0,void 0,function(){var o,a,u,c,l,d,h,f,p,v;return lw(this,function(_){switch(_.label){case 0:return o=new HA({file:n.file,channelUrl:e.url,thumbnailSizes:n.thumbnailSizes,requestId:t.requestId}),[4,this._requestQueue.send(o)];case 1:return a=_.sent(),u=a.as(jA),c=u.url,l=u.fileSize,d=void 0===l?n.fileSize:l,h=u.thumbnailSizes,f=void 0===h?n.thumbnailSizes:h,p=u.requireAuth,v=void 0!==p&&p,n.fileName=null!==(r=n.fileName)&&void 0!==r?r:n.file.name,n.mimeType=null!==(i=n.mimeType)&&void 0!==i?i:n.file.type,n.fileSize=null!==(s=n.fileSize)&&void 0!==s?s:n.file.size,n.fileUrl=c,n.fileSize=d,n.thumbnailSizes=f,n.requireAuth=v,[2];}});});},e.prototype._uploadNextFileForMultipleFilesItemAndUpdateParams=function(e,t,n){var r,i,s;return cw(this,void 0,void 0,function(){var o,a,u,c,l,d,h,f,p,v,_,y;return lw(this,function(m){switch(m.label){case 0:return o=t.multipleFileUploadInfo.uploadIndex,a=n.fileInfoList[o],u=new HA({file:a.file,channelUrl:e.url,thumbnailSizes:a.thumbnailSizes,requestId:t.requestId}),[4,this._requestQueue.send(u)];case 1:return c=m.sent(),l=c.as(jA),d=l.url,h=l.fileSize,f=void 0===h?a.fileSize:h,p=l.thumbnailSizes,v=void 0===p?a.thumbnailSizes:p,_=l.requireAuth,y=void 0!==_&&_,a.fileName=null!==(r=a.fileName)&&void 0!==r?r:a.file.name,a.mimeType=null!==(i=a.mimeType)&&void 0!==i?i:a.file.type,a.fileSize=null!==(s=a.fileSize)&&void 0!==s?s:a.file.size,a.file=void 0,a.fileUrl=d,a.fileSize=f,a.thumbnailSizes=v,a._uploadedMetaData=uw(uw({},a._uploadedMetaData),{requireAuth:y,isUploaded:!0}),[2];}});});},e.prototype.request=function(e,t,n,r){return cw(this,void 0,void 0,function(){var i,s,o,a,u;return lw(this,function(c){return this._queueMap.has(e.url)||(i={messageQueue:[],uploadQueue:[],isResolving:!1,isResolveRequestPending:!1},this._queueMap.set(e.url,i)),s=this._queueMap.get(e.url),o=new ZC(),a={requestId:t,params:n,state:JA.PENDING,deferred:o},function(e){return "fileInfoList"in e;}(n)&&(u={uploadIndex:0,uploadCount:n.fileInfoList.length,requestHandler:r},a.multipleFileUploadInfo=u),s.messageQueue.push(a),this._uploadNextPendingItem(e),[2,o.promise];});});},e.prototype.cancel=function(e,t){var n,r,i=this._queueMap.get(e.url);if(i){var s=t?[i.messageQueue.find(function(e){return e.requestId===t;})]:fw([],hw(i.messageQueue),!1);try{for(var o=dw(s),a=o.next();!a.done;a=o.next()){var u=a.value;if(u)switch(u.state){case JA.PENDING:u.state=JA.FAILED,u.error=Iw.requestCanceled,this._resolveMessageQueue(e);break;case JA.UPLOADING:this._requestQueue.cancel(u.requestId);}}}catch(e){n={error:e};}finally{try{a&&!a.done&&(r=o.return)&&r.call(o);}finally{if(n)throw n.error;}}}},e;}(),gN={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:jw.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,replyType:zw.NONE,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1,showSubchannelMessagesOnly:!1},EN=function(e){return kw("number",e.prevResultSize)&&kw("number",e.nextResultSize)&&kw("boolean",e.isInclusive)&&kw("boolean",e.reverse)&&kw("string",e.messageTypeFilter)&&Aw(jw,e.messageTypeFilter)&&Ow("string",e.customTypesFilter,!0)&&Ow("string",e.senderUserIdsFilter,!0)&&Aw(zw,e.replyType)&&kw("boolean",e.includeMetaArray)&&kw("boolean",e.includeReactions)&&kw("boolean",e.includeParentMessageInfo)&&kw("boolean",e.includeThreadInfo)&&kw("boolean",e.showSubchannelMessagesOnly);},bN={replyType:zw.NONE,includeReactions:!1,includeThreadInfo:!1,includeMetaArray:!1,includeParentMessageInfo:!1},wN=function(e){return Aw(zw,e.replyType)&&kw("boolean",e.includeReactions)&&kw("boolean",e.includeMetaArray)&&kw("boolean",e.includeParentMessageInfo)&&kw("boolean",e.includeThreadInfo);},IN=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.includeMetaArray,o=t.includeReactions,a=t.includeThreadInfo,u=t.includeParentMessageInfo,c=e.call(this)||this;return c.method=nI.GET,c.path="".concat(_I(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i)),c.params={is_sdk:!0,with_sorted_meta_array:s,include_reactions:o,include_thread_info:a,include_parent_message_info:u,include_poll_details:!0},c;}return aw(t,e),t;}(wI),TN=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=n?lN(t,uw({},n)):null,r;}return aw(t,e),t;}(II),SN=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,s=t.token,o=t.prevResultSize,a=t.nextResultSize,u=t.isInclusive,c=t.reverse,l=t.messageTypeFilter,d=t.customTypesFilter,h=t.senderUserIdsFilter,f=t.replyType,p=t.includeMetaArray,v=t.includeReactions,_=t.parentMessageId,y=t.includeThreadInfo,m=t.includeParentMessageInfo,g=t.showSubchannelMessagesOnly,E=t.checkingContinuousMessages,b=e.call(this)||this;return b.method=nI.GET,b.path="".concat(_I(n),"/").concat(encodeURIComponent(r),"/messages"),b.params=eI(tI({is_sdk:!0,prev_limit:o,next_limit:a,include:u,reverse:c,message_ts:i,message_id:s,message_type:null!=l?l:null,custom_types:d,sender_ids:h,include_reply_type:f,with_sorted_meta_array:p,include_reactions:v,parent_message_id:_,include_thread_info:y,include_parent_message_info:m,show_subchannel_message_only:g,include_poll_details:!0,checking_continuous_messages:E})),b;}return aw(t,e),t;}(wI),CN=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.messages=n.messages.map(function(e){return lN(t,e);}),r;}return aw(t,e),t;}(II),kN=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,s=t.token,o=t.replyType,a=t.includeMetaArray,u=t.includeReactions,c=t.includeThreadInfo,l=t.includeParentMessageInfo,d=e.call(this)||this;return d.method=nI.GET,d.path="".concat(_I(n),"/").concat(encodeURIComponent(r),"/messages/changelogs"),d.params={change_ts:i,token:s,with_sorted_meta_array:a,include_reactions:u,include_thread_info:c,include_reply_type:o,include_parent_message_info:l,include_poll_details:!0},d;}return aw(t,e),t;}(wI),AN=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedMessages=n.updated.map(function(e){return lN(t,e);}),r.deletedMessagesInfo=n.deleted.map(function(e){return {messageId:e.message_id,deletedAt:e.deleted_at};}),r.hasMore=n.has_more,r.nextToken=n.next,r;}return aw(t,e),t;}(II),NN=function(e){function t(t){var n=t.channelUrl,r=t.scheduledMessageId,i=e.call(this)||this;return i.method=nI.GET,i.path="".concat(oI,"/").concat(encodeURIComponent(n),"/scheduled_messages/").concat(encodeURIComponent(r)),i.params={},i;}return aw(t,e),t;}(wI),ON=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=n?lN(t,uw({},n)):null,r;}return aw(t,e),t;}(II);!function(e){e.MUTED="muted",e.BANNED="banned";}(yN||(yN={}));var RN,DN=function(){function e(e){var t,n,r,i;this.restrictionType=null,Aw(yN,e.restriction_type)&&(this.restrictionType=e.restriction_type),this.description=null!==(t=e.description)&&void 0!==t?t:null,this.endAt=null!==(r=null!==(n=e.end_at)&&void 0!==n?n:e.muted_end_at)&&void 0!==r?r:-1,this.remainingDuration=null!==(i=e.remaining_duration)&&void 0!==i?i:-1;}return e.payloadify=function(e){return eI(tI({restriction_type:e.restrictionType,description:e.description,end_at:e.endAt,remaining_duration:e.remainingDuration}));},e;}(),xN=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.restrictionInfo=new DN(n),r;}return aw(t,e),t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),DN.payloadify(t.restrictionInfo))));},t;}(Hk),LN=function(e){function t(t,n){var r,i=this;return (i=e.call(this,t,n)||this).isMuted=!1,i.isMuted=null!==(r=n.is_muted)&&void 0!==r&&r,i;}return aw(t,e),t;}(Hk),MN=function(){function e(){this._onPending=UI,this._onFailed=UI,this._onSucceeded=UI;}return e.prototype._trigger=function(e){switch(null==e?void 0:e.sendingStatus){case Kw.PENDING:0===e.errorCode&&this._onPending(e);break;case Kw.SCHEDULED:case Kw.SUCCEEDED:this._onSucceeded(e);}},e.prototype._triggerFailed=function(e,t){switch(null==t?void 0:t.sendingStatus){case Kw.FAILED:case Kw.CANCELED:this._onFailed(e,t.scheduledInfo?null:t);}},e.prototype.onPending=function(e){return this._onPending=e,this;},e.prototype.onFailed=function(e){return this._onFailed=e,this;},e.prototype.onSucceeded=function(e){return this._onSucceeded=e,this;},e;}(),UN={data:void 0,customType:void 0,mentionType:Gw.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,mentionedMessageTemplate:void 0,metaArrays:void 0,parentMessageId:void 0,isReplyToChannel:!1,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0,isPinnedMessage:!1},PN=function(e){return kw("string",e.data,!0)&&kw("string",e.customType,!0)&&Aw(Gw,e.mentionType)&&Ow("string",e.mentionedUserIds,!0)&&Ow(Hk,e.mentionedUsers,!0)&&kw("string",e.mentionedMessageTemplate,!0)&&Ow(QA,e.metaArrays,!0)&&kw("number",e.parentMessageId,!0)&&kw("boolean",e.isReplyToChannel)&&Aw(Bw,e.pushNotificationDeliveryOption,!0)&&kw(ZA,e.appleCriticalAlertOptions,!0)&&kw("boolean",e.isPinnedMessage,!0);},FN=function(e){return {isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,pollId:e.pollId};},qN=uw(uw({},UN),{message:"",translationTargetLanguages:void 0,pollId:void 0});!function(e){e.FILE="file",e.BLOB="blob",e.BLOB_LIKE_OBJECT="blobLikeObject",e.URL="url";}(RN||(RN={}));var HN,jN=function(e){return "undefined"!=typeof window&&"Blob"in window&&"undefined"!=typeof Blob&&e instanceof Blob;},VN=function(e){return e===RN.BLOB||e===RN.FILE;},GN=function(e){return {file:e.file,fileKey:e.fileKey,fileType:e.fileType,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption};},zN=uw(uw({},UN),{file:void 0,fileKey:void 0,fileUrl:void 0,fileName:void 0,fileType:void 0,fileSize:void 0,mimeType:void 0,thumbnailSizes:void 0,requireAuth:!1}),BN=function(e){return PN(e)&&(Dw(e.file)||kw("string",e.fileUrl))&&kw("string",e.fileName,!0)&&kw("string",e.mimeType,!0)&&kw("number",e.fileSize,!0)&&(null===e.thumbnailSizes||void 0===e.thumbnailSizes||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every(function(e){return kw("object",e)&&e.maxWidth>0&&e.maxHeight>0;}));},KN={data:void 0,customType:void 0,mentionType:Gw.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,mentionedMessageTemplate:void 0,metaArrays:void 0,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0},QN=function(e){return kw("string",e.data,!0)&&kw("string",e.customType,!0)&&Aw(Gw,e.mentionType)&&Ow("string",e.mentionedUserIds,!0)&&Ow(Hk,e.mentionedUsers,!0)&&kw("string",e.mentionedMessageTemplate,!0)&&Ow(QA,e.metaArrays,!0)&&Aw(Bw,e.pushNotificationDeliveryOption,!0)&&kw(ZA,e.appleCriticalAlertOptions,!0);},WN=uw(uw({},KN),{message:void 0,translationTargetLanguages:void 0,pollId:void 0}),YN=uw({},KN),ZN=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.token,s=t.limit,o=e.call(this)||this;return o.method=nI.GET,o.path="".concat(_I(r),"/").concat(encodeURIComponent(n),"/operators"),o.params={token:i,limit:s},o;}return aw(t,e),t;}(wI),XN=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.operators=n.operators.map(function(e){return new Hk(t,e);}),r.token=n.next,r;}return aw(t,e),t;}(II),JN=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this);},t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,t=tA.of(this._iid).requestQueue,n=new ZN(uw(uw({},this),{channelUrl:this.channelUrl,token:this._token})),[4,t.send(n)]):[3,2]):[3,5];case 1:return r=a.sent(),i=r.as(XN),s=i.operators,o=i.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return [2,e];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(_A),$N=function(e){function t(t,n,r,i){var s,o,a,u,c,l,d,h,f,p,v=this;return (v=e.call(this,t,n,r,i)||this).reverse=!1,v.messageTypeFilter=jw.ALL,v.customTypesFilter=null,v.senderUserIdsFilter=null,v.replyType=zw.NONE,v.includeMetaArray=!1,v.includeReactions=!1,v.includeParentMessageInfo=!1,v.includeThreadInfo=!1,v.showSubchannelMessagesOnly=!1,v._edge=Number.MAX_SAFE_INTEGER,v.reverse=null!==(s=i.reverse)&&void 0!==s&&s,v.messageTypeFilter=null!==(o=i.messageTypeFilter)&&void 0!==o?o:jw.ALL,v.customTypesFilter=null!==(a=i.customTypesFilter)&&void 0!==a?a:null,v.senderUserIdsFilter=null!==(u=i.senderUserIdsFilter)&&void 0!==u?u:null,v.replyType=null!==(c=i.replyType)&&void 0!==c?c:zw.NONE,v.includeMetaArray=null!==(l=i.includeMetaArray)&&void 0!==l&&l,v.includeReactions=null!==(d=i.includeReactions)&&void 0!==d&&d,v.includeParentMessageInfo=null!==(h=i.includeParentMessageInfo)&&void 0!==h&&h,v.includeThreadInfo=null!==(f=i.includeThreadInfo)&&void 0!==f&&f,v.showSubchannelMessagesOnly=null!==(p=i.showSubchannelMessagesOnly)&&void 0!==p&&p,v;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&kw("boolean",this.reverse)&&Aw(jw,this.messageTypeFilter)&&Aw(zw,this.replyType)&&Ow("string",this.customTypesFilter,!0)&&Ow("string",this.senderUserIdsFilter,!0)&&kw("boolean",this.includeMetaArray)&&kw("boolean",this.includeReactions)&&kw("boolean",this.includeParentMessageInfo)&&kw("boolean",this.includeThreadInfo)&&kw("boolean",this.showSubchannelMessagesOnly);},t.prototype.load=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,WD.of(this._iid).getMessagesByTimestamp(this.channelUrl,this.channelType,this._edge,tI({prevResultSize:this.limit,nextResultSize:0,isInclusive:!1,reverse:this.reverse,messageTypeFilter:this.messageTypeFilter,customTypesFilter:this.customTypesFilter,replyType:this.replyType,senderUserIdsFilter:this.senderUserIdsFilter,includeReactions:this.includeReactions,includeMetaArray:this.includeMetaArray,includeParentMessageInfo:this.includeParentMessageInfo,includeThreadInfo:this.includeThreadInfo,showSubchannelMessagesOnly:this.showSubchannelMessagesOnly}))]):[3,2]:[3,5];case 1:return e=t.sent(),this._edge=Math.min.apply(Math,fw([Number.MAX_SAFE_INTEGER],hw(e.map(function(e){return e.createdAt;})),!1)),this._hasNext=e.length>=this.limit,this._isLoading=!1,[2,e];case 2:return [2,[]];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(_A),eO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.limit,o=t.token;return (n=e.call(this)||this).method=nI.GET,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/mute"),n.params={limit:s,token:o},n;}return aw(t,e),t;}(wI),tO=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.mutedUsers=[];var i=n.next,s=n.muted_list;return r.token=i,s&&s.length>0&&(r.mutedUsers=s.map(function(e){return new xN(t,e);})),r;}return aw(t,e),t;}(II),nO=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this;}return aw(t,e),t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=tA.of(this._iid).requestQueue,t=new eO(uw(uw({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=o.sent(),r=n.as(tO),i=r.mutedUsers,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return [2,[]];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(_A),rO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.limit,o=t.token;return (n=e.call(this)||this).method=nI.GET,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/ban"),n.params=eI({limit:s,token:o}),n;}return aw(t,e),t;}(wI),iO=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.bannedUsers=[];var i=n.next,s=n.banned_list;return r.token=i,s&&s.length>0&&(r.bannedUsers=s.map(function(e){return new xN(t,e.user);})),r;}return aw(t,e),t;}(II),sO=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this);},t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=tA.of(this._iid).requestQueue,t=new rO(uw(uw({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=o.sent(),r=n.as(iO),i=r.bannedUsers,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return [2,[]];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(_A);!function(e){e.SPAM="spam",e.HARASSING="harassing",e.SUSPICIOUS="suspicious",e.INAPPROPRIATE="inappropriate";}(HN||(HN={}));var oO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.operatorUserIds;return (n=e.call(this)||this).method=nI.POST,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/operators"),n.params={operator_ids:s},n;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var aO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.operatorUserIds;return (n=e.call(this)||this).method=nI.DELETE,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/operators"),n.params={operator_ids:s},n;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){return e.call(this,t,n)||this;},e);}(II);var uO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId;return (n=e.call(this)||this).method=nI.GET,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/mute/").concat(s),n;}return aw(t,e),t;}(wI),cO=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.isMuted=!1,r.startAt=0,r.endAt=0;var i=n.is_muted,s=n.start_at,o=n.end_at,a=n.remaining_duration,u=n.description;return r.isMuted=i,r.startAt=s,r.endAt=o,r.remainingDuration=a,r.description=u,r;}return aw(t,e),t;}(II),lO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.keys;return (n=e.call(this)||this).method=nI.GET,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={keys:s,include_ts:!0},n;}return aw(t,e),t;}(wI),dO=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.metadata,s=n.ts;return r.metadata=i,r.ts=s,r;}return aw(t,e),t;}(II),hO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metadata;return (n=e.call(this)||this).method=nI.POST,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={metadata:s,include_ts:!0},n;}return aw(t,e),t;}(wI),fO=function(e){function t(t,n){var r,i,s=this;return (s=e.call(this,t,n)||this).metaData=null!==(r=n.metadata)&&void 0!==r?r:{},s.ts=null!==(i=n.ts)&&void 0!==i?i:null,s;}return aw(t,e),t;}(II),pO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metadata,o=t.upsert;return (n=e.call(this)||this).method=nI.PUT,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={metadata:s,include_ts:!0,upsert:null!=o&&o},n;}return aw(t,e),t;}(wI),vO=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.metadata,s=n.ts;return r.metadata=i,r.ts=s,r;}return aw(t,e),t;}(II),_O=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return r.data&&(i.created=r.data.created,i.updated=r.data.updated,i.deleted=r.data.deleted),i;}return aw(t,e),t;}(MI),yO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.key;return (n=e.call(this)||this).method=nI.DELETE,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/metadata/").concat(s),n.params={include_ts:!0},n;}return aw(t,e),t;}(wI),mO=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts;return r.ts=i,r;}return aw(t,e),t;}(II),gO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return (n=e.call(this)||this).method=nI.DELETE,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={include_ts:!0},n;}return aw(t,e),t;}(wI),EO=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts;return r.ts=i,r;}return aw(t,e),t;}(II),bO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.keys;return (n=e.call(this)||this).method=nI.GET,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={keys:s},n;}return aw(t,e),t;}(wI),wO=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r;}return aw(t,e),t;}(II),IO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metaCounter;return (n=e.call(this)||this).method=nI.POST,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={metacounter:s},n;}return aw(t,e),t;}(wI),TO=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r;}return aw(t,e),t;}(II),SO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metaCounter,o=t.upsert,a=void 0!==o&&o,u=t.mode,c=void 0===u?"set":u;return (n=e.call(this)||this).method=nI.PUT,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={metacounter:s,upsert:a,mode:c},n;}return aw(t,e),t;}(wI),CO=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r;}return aw(t,e),t;}(II),kO=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return r.data&&(i.created=r.data.created,i.updated=r.data.updated,i.deleted=r.data.deleted),i;}return aw(t,e),t;}(MI),AO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.key;return (n=e.call(this)||this).method=nI.DELETE,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/metacounter/").concat(s),n.params={},n;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){return e.call(this,t,n)||this;},e);}(II);var NO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return (n=e.call(this)||this).method=nI.DELETE,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={},n;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var OO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId,o=t.seconds,a=t.description;return (n=e.call(this)||this).method=nI.POST,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/mute"),n.params={user_id:s,seconds:o,description:a},n;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){return e.call(this,t,n)||this;},e);}(II);var RO=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new xN(t,r.data),i;}return aw(t,e),t;}(MI),DO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId;return (n=e.call(this)||this).method=nI.DELETE,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/mute/").concat(encodeURIComponent(s)),n;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var xO=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new xN(t,r.data),i;}return aw(t,e),t;}(MI),LO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId,o=t.seconds,a=t.description;return (n=e.call(this)||this).method=nI.POST,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/ban"),n.params=eI({user_id:s,seconds:o,description:a}),n;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var MO=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new xN(t,r.data),r.data.member_count&&(i.memberCount=r.data.member_count),r.data.joined_member_count&&(i.joinedMemberCount=r.data.joined_member_count),i;}return aw(t,e),t;}(MI),UO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId;return (n=e.call(this)||this).method=nI.DELETE,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/ban/").concat(encodeURIComponent(s)),n;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var PO=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new xN(t,r.data),i;}return aw(t,e),t;}(MI),FO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.freezing;return (n=e.call(this)||this).method=nI.PUT,n.path="".concat(_I(i),"/").concat(encodeURIComponent(r),"/freeze"),n.params={freeze:s},n;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var qO=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.freeze=r.data.freeze,i;}return aw(t,e),t;}(MI),HO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.category,o=t.userId,a=t.description;return (n=e.call(this)||this).method=nI.POST,n.path="".concat(yI(i),"/").concat(encodeURIComponent(r)),n.params={report_category:s,reporting_user_id:o,report_description:a},n;}return aw(t,e),t;}(wI),jO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.category,o=t.userId,a=t.offendingUserId,u=t.description;return (n=e.call(this)||this).method=nI.POST,n.path="".concat(lI,"/users/").concat(a),n.params={channel_url:r,channel_type:i===Pw.OPEN?"open_channels":"group_channels",report_category:s,reporting_user_id:o,report_description:u},n;}return aw(t,e),t;}(wI),VO=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.category,o=t.userId,a=t.offendingUserId,u=t.messageId,c=t.description;return (n=e.call(this)||this).method=nI.POST,n.path="".concat(yI(i),"/").concat(encodeURIComponent(r),"/messages/").concat(u),n.params={report_category:s,reporting_user_id:o,report_description:c,offending_user_id:a},n;}return aw(t,e),t;}(wI),GO=function(e){function t(t){var n=[];return t.mentionType===Gw.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map(function(e){return e.userId;}))),e.call(this,{code:"MESG",ackRequired:!0,payload:eI(tI({channel_url:t.channelUrl,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:n,mentioned_message_template:t.mentionedMessageTemplate,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==Bw.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage}))})||this;}return aw(t,e),t;}(WC),zO=function(e){function t(t,n,r){var i,s,o,a,u=this;(u=e.call(this,t,"MESG",r)||this).message=new aN(t,r);var c=tA.of(t).sdkState;return u.isMentioned=mI(u.message.mentionType,null!==(o=null!==(i=u.message.mentionedUserIds)&&void 0!==i?i:null===(s=u.message.mentionedUsers)||void 0===s?void 0:s.map(function(e){return e.userId;}))&&void 0!==o?o:[],c.userId),u.forceUpdateLastMessage=null!==(a=r.force_update_last_message)&&void 0!==a&&a,u;}return aw(t,e),t;}(MI),BO=function(e){function t(t){var n=null;return t.mentionType===Gw.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map(function(e){return e.userId;}))),e.call(this,{code:"MEDI",ackRequired:!0,payload:eI(tI({channel_url:t.channelUrl,msg_id:t.messageId,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:n,mentioned_message_template:t.mentionedMessageTemplate,apple_critical_alert_options:t.appleCriticalAlertOptions?ZA.payloadify(t.appleCriticalAlertOptions):null,poll_id:t.pollId}))})||this;}return aw(t,e),t;}(WC),KO=function(e){function t(t,n,r){var i,s,o,a,u,c=this;(c=e.call(this,t,"MEDI",r)||this).message=new aN(t,r);var l=tA.of(t).sdkState;return c.mentionCountChange=gI({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(o=null===(s=r.old_values)||void 0===s?void 0:s.mentioned_user_ids)&&void 0!==o?o:[]},tI({mentionType:c.message.mentionType,mentionedUserIds:null!==(a=c.message.mentionedUserIds)&&void 0!==a?a:null===(u=c.message.mentionedUsers)||void 0===u?void 0:u.map(function(e){return e.userId;})}),l.userId),c;}return aw(t,e),t;}(MI),QO=function(e){function t(t){var n=null;return t.mentionType===Gw.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map(function(e){return e.userId;}))),e.call(this,{code:"FEDI",ackRequired:!0,payload:eI(tI({channel_url:t.channelUrl,msg_id:t.messageId,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:n,apple_critical_alert_options:t.appleCriticalAlertOptions}))})||this;}return aw(t,e),t;}(WC),WO=function(e){function t(t,n,r){var i,s,o,a,u,c=this;(c=e.call(this,t,"FEDI",r)||this).message=new dN(t,r);var l=tA.of(t).sdkState;return c.mentionCountChange=gI({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(o=null===(s=r.old_values)||void 0===s?void 0:s.mentioned_user_ids)&&void 0!==o?o:[]},tI({mentionType:c.message.mentionType,mentionedUserIds:null!==(a=c.message.mentionedUserIds)&&void 0!==a?a:null===(u=c.message.mentionedUsers)||void 0===u?void 0:u.map(function(e){return e.userId;})}),l.userId),c;}return aw(t,e),t;}(MI),YO=function(e){function t(t){var n=e.call(this)||this;return n.method=nI.DELETE,n.path="".concat(_I(t.channelType),"/").concat(t.channelUrl,"/messages/").concat(t.messageId),n;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var ZO=function(e){function t(t,n,r){var i=e.call(this,t,"DELM",r)||this;return i.channelUrl=r.channel_url,i.channelType=r.channel_type,i.messageId=Number(r.msg_id),i;}return aw(t,e),t;}(MI),XO=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.reactionKey,o=e.call(this)||this;return o.method=nI.POST,o.path="".concat(_I(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/reactions"),o.params={reaction:s},o;}return aw(t,e),t;}(wI),JO=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reactionEvent=new BA(n),r;}return aw(t,e),t;}(II),$O=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.reactionKey,o=e.call(this)||this;return o.method=nI.DELETE,o.path="".concat(_I(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/reactions"),o.params={reaction:s},o;}return aw(t,e),t;}(wI),eR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reactionEvent=new BA(uw({},n)),r;}return aw(t,e),t;}(II),tR=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.translationTargetLanguages,o=e.call(this)||this;return o.method=nI.POST,o.path="".concat(_I(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i),"/translation"),o.params={target_langs:s},o;}return aw(t,e),t;}(wI),nR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new aN(t,n),r;}return aw(t,e),t;}(II),rR=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===Gw.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map(function(e){return e.userId;})));var s=t.channelType,o=t.channelUrl;return r.method=nI.POST,r.path="".concat(_I(s),"/").concat(encodeURIComponent(o),"/scheduled_messages"),r.params=eI(tI({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:Vw.USER,message:t.message,custom_type:t.customType,data:t.data,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map(function(e){return QA.payloadify(e);}),apple_critical_alert_options:t.appleCriticalAlertOptions?ZA.payloadify(t.appleCriticalAlertOptions):null,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption})),r;}return aw(t,e),t;}(wI),iR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new aN(t,n),r;}return aw(t,e),t;}(II),sR=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===Gw.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map(function(e){return e.userId;})));var s=t.channelType,o=t.channelUrl;return r.method=nI.POST,r.path="".concat(_I(s),"/").concat(encodeURIComponent(o),"/scheduled_messages"),r.params=tI({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:Vw.FILE,url:t.fileUrl,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,thumbnails:t.thumbnailSizes?t.thumbnailSizes.map(function(e){return nN.payloadify(e);}):[],custom_type:t.customType,data:t.data,require_auth:t.requireAuth,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map(function(e){return QA.payloadify(e);}),apple_critical_alert_options:t.appleCriticalAlertOptions?ZA.payloadify(t.appleCriticalAlertOptions):null,push_option:t.pushNotificationDeliveryOption}),r;}return aw(t,e),t;}(wI),oR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new dN(t,n),r;}return aw(t,e),t;}(II),aR=function(e){function t(t){var n=t.pollId,r=t.title,i=t.data,s=t.allowUserSuggestion,o=t.allowMultipleVotes,a=t.closeAt,u=e.call(this)||this;return u.method=nI.PUT,u.path="".concat(fI,"/").concat(encodeURIComponent(n)),u.params={title:r,data:i,allow_user_suggestion:s,allow_multiple_votes:o,close_at:a},u;}return aw(t,e),t;}(wI),uR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new aA(t,n),r;}return aw(t,e),t;}(II),cR=function(e){function t(t){var n=t.pollId,r=e.call(this)||this;return r.method=nI.DELETE,r.path="".concat(fI,"/").concat(encodeURIComponent(n)),r;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var lR=function(e){function t(t){var n=t.pollId,r=e.call(this)||this;return r.method=nI.PUT,r.path="".concat(fI,"/").concat(encodeURIComponent(n),"/close"),r;}return aw(t,e),t;}(wI),dR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new aA(t,n),r;}return aw(t,e),t;}(II),hR=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,s=t.optionText,o=e.call(this)||this;return o.method=nI.POST,o.path="".concat(fI,"/").concat(encodeURIComponent(i),"/options"),o.params={channel_url:n,channel_type:r,text:s},o;}return aw(t,e),t;}(wI),fR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new aA(t,n),r;}return aw(t,e),t;}(II),pR=function(e){function t(t){var n=t.pollId,r=t.pollOptionId,i=t.optionText,s=e.call(this)||this;return s.method=nI.PUT,s.path="".concat(fI,"/").concat(encodeURIComponent(n),"/options/").concat(encodeURIComponent(r)),s.params={text:i},s;}return aw(t,e),t;}(wI),vR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new aA(t,n),r;}return aw(t,e),t;}(II),_R=function(e){function t(t){var n=t.pollId,r=t.pollOptionId,i=e.call(this)||this;return i.method=nI.DELETE,i.path="".concat(fI,"/").concat(encodeURIComponent(n),"/options/").concat(encodeURIComponent(r)),i;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var yR,mR=function(e){function t(t){var n=t.reqId,r=t.channelType,i=t.channelUrl,s=t.pollId,o=t.pollOptionIds;return e.call(this,{code:"VOTE",ackRequired:!0,payload:eI({req_id:n,channel_type:r===Pw.OPEN?"open_channels":"group_channels",channel_url:i,poll_id:s,option_ids:o})})||this;}return aw(t,e),t;}(WC),gR=function(e){function t(t,n,r){var i=e.call(this,t,"VOTE",r)||this;return i.event=new yA(r),i.channelUrl=r.channel_url,i.channelType=r.channel_type,i;}return aw(t,e),t;}(MI),ER="Message",bR=uw(uw({},UN),{fileInfoList:[]}),wR=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onFileUploaded=UI,t;}return aw(t,e),t.prototype._triggerOnFileUploaded=function(e,t,n,r){this._onFileUploaded(e,t,n,r);},t.prototype.onFileUploaded=function(e){return this._onFileUploaded=e,this;},t.prototype.onPending=function(t){return e.prototype.onPending.call(this,t),this;},t.prototype.onFailed=function(t){return e.prototype.onFailed.call(this,t),this;},t.prototype.onSucceeded=function(t){return e.prototype.onSucceeded.call(this,t),this;},t;}(MN),IR=function(e){function t(t,n){var r,i,s,o,a,u,c=this;return (c=e.call(this,t)||this)._name="",c._createdAt=0,c.channelType=Pw.BASE,c.coverUrl="",c.customType="",c.data="",c.isFrozen=!1,c.isEphemeral=!1,c.creator=null,c._messageCollectionLastAccessedAt=0,c._url=n.channel_url,c._name=null!==(r=n.name)&&void 0!==r?r:"",c._createdAt=1e3*n.created_at,c.coverUrl=null!==(i=n.cover_url)&&void 0!==i?i:"",c.customType=null!==(s=n.custom_type)&&void 0!==s?s:"",c.data=null!==(o=n.data)&&void 0!==o?o:"",c.isFrozen=null!==(a=n.freeze)&&void 0!==a&&a,c.isEphemeral=null!==(u=n.is_ephemeral)&&void 0!==u&&u,c.creator=n.created_by?new Hk(c._iid,n.created_by):null,n.metadata&&Object.keys(n.metadata).length>0&&n.ts&&(c._cachedMetaData=new Map(),Object.keys(n.metadata).forEach(function(e){c._cachedMetaData.set(e,{value:n.metadata[e],isRemoved:!1,updatedAt:n.ts});})),c;}return aw(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this._url;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name;},set:function(e){this._name=e;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"createdAt",{get:function(){return this._createdAt;},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return uw(uw({},this),{url:this._url,name:this._name,createdAt:this._createdAt});},t.payloadify=function(t){return eI(tI(uw(uw({},e.payloadify.call(this,t)),{channel_url:t.url,name:t.name,cover_url:t.coverUrl,custom_type:t.customType,data:t.data,freeze:t.isFrozen,is_ephemeral:t.isEphemeral,created_by:t.creator?Hk.payloadify(t.creator):null,created_at:t.createdAt/1e3})));},t.prototype.isGroupChannel=function(){return this.channelType===Pw.GROUP;},t.prototype.isOpenChannel=function(){return this.channelType===Pw.OPEN;},t.prototype.isFeedChannel=function(){return this.channelType===Pw.FEED;},Object.defineProperty(t.prototype,"cachedMetaData",{get:function(){var e={};return this._cachedMetaData?(this._cachedMetaData.forEach(function(t,n){t.isRemoved||(e[n]=t.value);}),e):e;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"messageCollectionLastAccessedAt",{get:function(){return this._messageCollectionLastAccessedAt;},enumerable:!1,configurable:!0}),t.prototype._updateMessageCollectionLastAccessedAt=function(){this._messageCollectionLastAccessedAt=Date.now();},t.prototype._update=function(e){var t=eI(e);Object.assign(this,t);},t.prototype._upsertCachedMetaData=function(e,t){var n=this;Object.keys(e).forEach(function(r){n._cachedMetaData||(n._cachedMetaData=new Map());var i=n._cachedMetaData.get(r);(!i||i.updatedAt<=t)&&n._cachedMetaData.set(r,{value:e[r],isRemoved:!1,updatedAt:t});});},t.prototype._updateCachedMetaData=function(e,t){var n=this;this._cachedMetaData?this._cachedMetaData.forEach(function(r,i){var s;r.updatedAt<=t&&n._cachedMetaData.set(i,{value:null!==(s=e[i])&&void 0!==s?s:r.value,isRemoved:!e[i],updatedAt:t});}):(this._cachedMetaData=new Map(),Object.keys(e).forEach(function(r){n._cachedMetaData.set(r,{value:e[r],isRemoved:!1,updatedAt:t});}));},t.prototype._removeFromCachedMetaData=function(e,t){var n=this;this._cachedMetaData&&e.forEach(function(e){var r=n._cachedMetaData.get(e);r&&r.updatedAt<t&&(r.isRemoved=!0,r.updatedAt=t);});},t.prototype._runIfHandleableWithGroupChannel=function(e){this.isGroupChannel()?e(this):this.isFeedChannel()&&e(this.groupChannel);},t.prototype._generateRequestId=function(){return "rq-".concat(Yw());},t.prototype.isIdentical=function(e){return e&&this.url===e.url;},t.prototype.isEqual=function(e){return Cw(this,e);},t.prototype.createOperatorListQuery=function(e){return void 0===e&&(e={}),new JN(this._iid,this.url,this.channelType,e);},t.prototype.createMutedUserListQuery=function(e){return void 0===e&&(e={}),new nO(this._iid,this.url,this.channelType,e);},t.prototype.createBannedUserListQuery=function(e){return void 0===e&&(e={}),new sO(this._iid,this.url,this.channelType,e);},t.prototype.createPreviousMessageListQuery=function(e){return void 0===e&&(e={}),new $N(this._iid,this.url,this.channelType,e);},t.prototype.addOperators=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return Fk(Ow("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid).requestQueue,n=new oO({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,t.send(n)];case 1:return r.sent(),[2];}});});},t.prototype.removeOperators=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return Fk(Ow("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid).requestQueue,n=new aO({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,t.send(n)];case 1:return r.sent(),[2];}});});},t.prototype.getMyMutedInfo=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o,a,u,c,l;return lw(this,function(d){switch(d.label){case 0:return e=tA.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new uO({channelUrl:this.url,channelType:this.channelType,userId:t.userId}),[4,n.send(r)];case 1:return i=d.sent(),s=i.as(cO),o=s.isMuted,a=s.startAt,u=s.endAt,c=s.remainingDuration,l=s.description,[2,{isMuted:o,startAt:a,endAt:u,remainingDuration:c,description:l}];}});});},t.prototype.getMetaData=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return Fk(Ow("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid).requestQueue,n=new lO({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,t.send(n)];case 1:return r=a.sent(),i=r.as(dO),s=i.metadata,o=i.ts,this._upsertCachedMetaData(s,o),[2,s];}});});},t.prototype.getAllMetaData=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return e=tA.of(this._iid).requestQueue,t=new lO({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(t)];case 1:return n=o.sent(),r=n.as(dO),i=r.metadata,s=r.ts,this._updateCachedMetaData(i,s),[2,i];}});});},t.prototype.createMetaData=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return t=tA.of(this._iid).requestQueue,n=new hO({channelUrl:this.url,channelType:this.channelType,metadata:e}),[4,t.send(n)];case 1:return r=s.sent(),i=r.as(fO).metaData,this._upsertCachedMetaData(i,0),[2,i];}});});},t.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),cw(this,void 0,void 0,function(){var n,r,i,s,o,a;return lw(this,function(u){switch(u.label){case 0:return n=tA.of(this._iid).requestQueue,r=new pO({channelUrl:this.url,channelType:this.channelType,metadata:e,upsert:t}),[4,n.send(r)];case 1:return i=u.sent(),s=i.as(vO),o=s.metadata,a=s.ts,this._upsertCachedMetaData(o,a),[2,o];}});});},t.prototype.deleteMetaData=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(kw("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid).requestQueue,n=new yO({channelUrl:this.url,channelType:this.channelType,key:e}),[4,t.send(n)];case 1:return r=s.sent(),i=r.as(mO).ts,this._removeFromCachedMetaData([e],i),[2];}});});},t.prototype.deleteAllMetaData=function(){return cw(this,void 0,void 0,function(){var e,t,n,r;return lw(this,function(i){switch(i.label){case 0:return e=tA.of(this._iid).requestQueue,t=new gO({channelUrl:this.url,channelType:this.channelType}),[4,e.send(t)];case 1:return n=i.sent(),r=n.as(EO).ts,this._removeFromCachedMetaData(fw([],hw(this._cachedMetaData.keys()),!1),r),[2];}});});},t.prototype.getMetaCounters=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return Fk(Ow("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid).requestQueue,n=new bO({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,t.send(n)];case 1:return [2,r.sent().as(wO).metaCounter];}});});},t.prototype.getAllMetaCounters=function(){return cw(this,void 0,void 0,function(){var e,t;return lw(this,function(n){switch(n.label){case 0:return e=tA.of(this._iid).requestQueue,t=new bO({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(t)];case 1:return [2,n.sent().as(wO).metaCounter];}});});},t.prototype.createMetaCounters=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return t=tA.of(this._iid).requestQueue,n=new IO({channelUrl:this.url,channelType:this.channelType,metaCounter:e}),[4,t.send(n)];case 1:return [2,r.sent().as(TO).metaCounter];}});});},t.prototype.updateMetaCounters=function(e,t){return void 0===t&&(t=!1),cw(this,void 0,void 0,function(){var n,r;return lw(this,function(i){switch(i.label){case 0:return n=tA.of(this._iid).requestQueue,r=new SO({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:t}),[4,n.send(r)];case 1:return [2,i.sent().as(CO).metaCounter];}});});},t.prototype.increaseMetaCounters=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return t=tA.of(this._iid).requestQueue,n=new SO({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"increase"}),[4,t.send(n)];case 1:return [2,r.sent().as(CO).metaCounter];}});});},t.prototype.decreaseMetaCounters=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return t=tA.of(this._iid).requestQueue,n=new SO({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"decrease"}),[4,t.send(n)];case 1:return [2,r.sent().as(CO).metaCounter];}});});},t.prototype.deleteMetaCounter=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return Fk(kw("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid).requestQueue,n=new AO({channelUrl:this.url,channelType:this.channelType,key:e}),[4,t.send(n)];case 1:return r.sent(),[2];}});});},t.prototype.deleteAllMetaCounters=function(){return cw(this,void 0,void 0,function(){var e,t;return lw(this,function(n){switch(n.label){case 0:return e=tA.of(this._iid).requestQueue,t=new NO({channelUrl:this.url,channelType:this.channelType}),[4,e.send(t)];case 1:return n.sent(),[2];}});});},t.prototype.muteUser=function(e,t,n){return cw(this,void 0,void 0,function(){return lw(this,function(r){return [2,this.muteUserWithUserId(e.userId,t,n)];});});},t.prototype.muteUserWithUserId=function(e,t,n){return cw(this,void 0,void 0,function(){var r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(kw("string",e)&&kw("number",t,!0)&&kw("string",n,!0)).throw(Iw.invalidParameters),r=tA.of(this._iid).requestQueue,i=new OO({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:t,description:n}),[4,r.send(i)];case 1:return s.sent(),[2];}});});},t.prototype.unmuteUser=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this.unmuteUserWithUserId(e.userId)];});});},t.prototype.unmuteUserWithUserId=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return Fk(kw("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid).requestQueue,n=new DO({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,t.send(n)];case 1:return r.sent(),[2];}});});},t.prototype.banUser=function(e,t,n){return cw(this,void 0,void 0,function(){return lw(this,function(r){return [2,this.banUserWithUserId(e.userId,t,n)];});});},t.prototype.banUserWithUserId=function(e,t,n){return cw(this,void 0,void 0,function(){var r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(kw("string",e)&&kw("number",t,!0)&&kw("string",n,!0)).throw(Iw.invalidParameters),r=tA.of(this._iid).requestQueue,i=new LO({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:t,description:n}),[4,r.send(i)];case 1:return s.sent(),[2];}});});},t.prototype.unbanUser=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this.unbanUserWithUserId(e.userId)];});});},t.prototype.unbanUserWithUserId=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return Fk(kw("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid).requestQueue,n=new UO({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,t.send(n)];case 1:return r.sent(),[2];}});});},t.prototype.freeze=function(){return cw(this,void 0,void 0,function(){var e,t;return lw(this,function(n){switch(n.label){case 0:return e=tA.of(this._iid).requestQueue,t=new FO({channelUrl:this.url,channelType:this.channelType,freezing:!0}),[4,e.send(t)];case 1:return n.sent(),this.isFrozen=!0,[2];}});});},t.prototype.unfreeze=function(){return cw(this,void 0,void 0,function(){var e,t;return lw(this,function(n){switch(n.label){case 0:return e=tA.of(this._iid).requestQueue,t=new FO({channelUrl:this.url,channelType:this.channelType,freezing:!1}),[4,e.send(t)];case 1:return n.sent(),this.isFrozen=!1,[2];}});});},t.prototype.getMessagesByMessageId=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=uw(uw({},gN),t),Fk(kw("number",e)&&EN(n)).throw(Iw.invalidParameters),[4,WD.of(this._iid).getMessagesByMessageId(this.url,this.channelType,e,n)];case 1:return [2,r.sent()];}});});},t.prototype.getMessagesByTimestamp=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=uw(uw({},gN),t),Fk(kw("number",e)&&EN(n)).throw(Iw.invalidParameters),[4,WD.of(this._iid).getMessagesByTimestamp(this.url,this.channelType,e,n)];case 1:return [2,r.sent()];}});});},t.prototype.getMessageChangeLogsSinceTimestamp=function(e,t){return void 0===t&&(t={}),cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=uw(uw({},bN),t),Fk(kw("number",e)&&wN(n)).throw(Iw.invalidParameters),[4,WD.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,n)];case 1:return [2,r.sent()];}});});},t.prototype.getMessageChangeLogsSinceToken=function(e,t){return void 0===t&&(t={}),cw(this,void 0,void 0,function(){var n;return lw(this,function(r){switch(r.label){case 0:return n=uw(uw({},bN),t),Fk(kw("string",e)&&wN(n)).throw(Iw.invalidParameters),[4,WD.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,n)];case 1:return [2,r.sent()];}});});},t.prototype._createPendingSendableMessagePayload=function(e,t,n){var r,i=tA.of(this._iid).sessionManager;return eI(tI({channel_url:this.url,channel_type:this.channelType,msg_id:0,parent_message_id:e.parentMessageId,data:e.data,custom_type:e.customType,mention_type:e.mentionType,sorted_metaarray:e.metaArrays?e.metaArrays.map(function(e){return QA.payloadify(e);}):null,apple_critical_alert_options:e.appleCriticalAlertOptions?ZA.payloadify(e.appleCriticalAlertOptions):null,created_at:n,user:i.currentUser?XA.payloadify(i.currentUser):null,req_id:t,request_state:Kw.PENDING,mentioned_user_ids:e.mentionedUserIds,mentioned_users:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map(function(e){return Hk.payloadify(e);})}));},t.prototype._createPendingUserMessage=function(e,t,n){var r,i,s={};if(e.translationTargetLanguages)try{for(var o=dw(e.translationTargetLanguages),a=o.next();!a.done;a=o.next())s[a.value]="";}catch(e){r={error:e};}finally{try{a&&!a.done&&(i=o.return)&&i.call(o);}finally{if(r)throw r.error;}}var u=eI(uw(uw({},this._createPendingSendableMessagePayload(e,t,n)),{type:Hw.USER,message:e.message,translations:s})),c=new aN(this._iid,u);return c.messageParams=e,c;},t.prototype._createPendingScheduledUserMessage=function(e,t,n){var r=this._createPendingUserMessage(e,t,n);return r.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},r;},t.prototype._createPendingFileMessage=function(e,t,n){var r,i,s,o,a,u,c=eI(uw(uw({},this._createPendingSendableMessagePayload(e,t,n)),{type:Hw.FILE,url:e.fileUrl,file:{name:null!==(r=e.fileName)&&void 0!==r?r:null===(i=e.file)||void 0===i?void 0:i.name,size:null!==(s=e.fileSize)&&void 0!==s?s:null===(o=e.file)||void 0===o?void 0:o.size,type:null!==(a=e.mimeType)&&void 0!==a?a:null===(u=e.file)||void 0===u?void 0:u.type,data:e.data},thumbnails:e.thumbnailSizes?e.thumbnailSizes.map(function(e){return {url:"",width:e.maxWidth,height:e.maxHeight};}):[]})),l=new dN(this._iid,c);return l.messageParams=e,l;},t.prototype._createPendingMultipleFilesMessage=function(e,t,n){var r=eI(uw(uw({},this._createPendingSendableMessagePayload(e,t,n)),{type:Hw.FILE})),i=new cN(this._iid,r);return i.messageParams=e,i;},t.prototype._createPendingScheduledFileMessage=function(e,t,n){var r=this._createPendingFileMessage(e,t,n);return r.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},r;},t.prototype._markMessageAsFailed=function(e,t,n){void 0===n&&(n=!1),e.errorCode=t.code,t.code===pw.REQUEST_CANCELED||t.code===pw.FILE_UPLOAD_CANCEL_FAILED?e.sendingStatus=Kw.CANCELED:n||(e.sendingStatus=Kw.FAILED);},t.prototype.sendUserMessage=function(e){var t=uw(uw({},qN),e);return Fk(function(e){return PN(e)&&kw("string",e.message)&&Ow("string",e.translationTargetLanguages,!0)&&kw("number",e.pollId,!0);}(t)).throw(Iw.invalidParameters),this._sendUserMessage(t);},t.prototype._sendUserMessage=function(e,t,n){var r=this;void 0===n&&(n=!1);var i=tA.of(this._iid),s=i.dispatcher,o=i.requestQueue,a=null!=t?t:this._generateRequestId(),u=Date.now(),c=new MN();return a||(a=this._generateRequestId()),ak(2).then(function(){var t=r._createPendingUserMessage(e,a,u);s.dispatch(new cA({messages:[t],source:n?rA.LOCAL_MESSAGE_RESEND_STARTED:rA.EVENT_MESSAGE_SENT_PENDING})),lk(function(){return cw(r,void 0,void 0,function(){return lw(this,function(e){return [2,c._trigger(t)];});});});var i=new GO(uw(uw({},e),{channelUrl:r.url,channelType:r.channelType,reqId:a}));o.send(i).then(function(e){var t=e.as(zO).message;s.dispatch(new cA({messages:[t],source:rA.EVENT_MESSAGE_SENT_SUCCESS})),lk(function(){return cw(r,void 0,void 0,function(){return lw(this,function(e){return [2,c._trigger(t)];});});});}).catch(function(t){if(ww(t))throw t;ak(2).then(function(){var n=r._createPendingUserMessage(e,a,u),i=tA.of(r._iid).cacheContext.localCacheEnabled&&Rw(t.code);r._markMessageAsFailed(n,t,i),s.dispatch(new cA({messages:[n],source:n.sendingStatus===Kw.PENDING?rA.REQUEST_RESEND_MESSAGE:rA.EVENT_MESSAGE_SENT_FAILED})),lk(function(){return cw(r,void 0,void 0,function(){return lw(this,function(e){return [2,c._triggerFailed(t,n)];});});});});});}),c;},t.prototype._autoResendUserMessage=function(e){return Fk(e instanceof aN&&!!e.messageParams).throw(Iw.invalidParameters),this._sendUserMessage(e.messageParams,e.reqId);},t.prototype.resendUserMessage=function(e){var t;return cw(this,void 0,void 0,function(){var n,r;return lw(this,function(i){return Fk(e instanceof aN&&!e.scheduledInfo).throw(Iw.invalidParameters),n=new ZC(),r=null!==(t=e.messageParams)&&void 0!==t?t:function(e){var t;return eI(tI({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,mentionedMessageTemplate:e.mentionedMessageTemplate,metaArrays:e.metaArrays,pollId:null===(t=e.poll)||void 0===t?void 0:t.id,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,message:e.message,translationTargetLanguages:Object.keys(e.translations)}));}(e),this._sendUserMessage(r,e.reqId,!0).onFailed(function(e){return n.reject(e);}).onSucceeded(function(e){return n.resolve(e);}),[2,n.promise];});});},t.prototype.updateUserMessage=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i;return lw(this,function(s){switch(s.label){case 0:return n=uw(uw({},WN),t),Fk(kw("number",e)&&function(e){return QN(e)&&kw("string",e.message,!0)&&Ow("string",e.translationTargetLanguages,!0)&&kw("number",e.pollId,!0);}(n)).throw(Iw.invalidParameters),r=tA.of(this._iid).requestQueue,i=new BO(uw({channelType:this.channelType,channelUrl:this.url,messageId:e},n)),[4,r.send(i)];case 1:return [2,s.sent().as(KO).message];}});});},t.prototype.copyUserMessage=function(e,n){var r,i,s;return cw(this,void 0,void 0,function(){var o,a;return lw(this,function(u){return Fk(e instanceof t&&n instanceof aN&&n.sendingStatus===Kw.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(Iw.invalidParameters),Fk(!n.poll).throw(Iw.notSupportedError),o=new ZC(),a=null!==(r=n.messageParams)&&void 0!==r?r:tI(uw(uw({},n),{mentionType:n.mentionType,mentionedUserIds:null!==(i=n.mentionedUserIds)&&void 0!==i?i:null===(s=n.mentionedUsers)||void 0===s?void 0:s.map(function(e){return e.userId;}),translationTargetLanguages:Object.keys(n.translations),pushNotificationDeliveryOption:Bw.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1})),e._sendUserMessage(a).onSucceeded(function(e){o.resolve(e);}).onFailed(function(e){return o.reject(e);}),[2,o.promise];});});},t.prototype.translateUserMessage=function(e,t){return cw(this,void 0,void 0,function(){var n,r;return lw(this,function(i){switch(i.label){case 0:return Fk(e instanceof aN&&e.messageId>0&&Ow("string",t)).throw(Iw.invalidParameters),n=tA.of(this._iid).requestQueue,r=new tR({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,translationTargetLanguages:t}),[4,n.send(r)];case 1:return [2,i.sent().as(nR).message];}});});},t.prototype._createScheduledUserMessage=function(e,t){var n=this,r=tA.of(this._iid).requestQueue,i=Date.now(),s=this._generateRequestId();ak(2).then(function(){var r=n._createPendingScheduledUserMessage(e,s,i);lk(function(){return cw(n,void 0,void 0,function(){return lw(this,function(e){return [2,t._trigger(r)];});});});});var o=new rR(uw({reqId:s,channelType:this.channelType,channelUrl:this.url},e));r.send(o).then(function(e){var r=e.as(iR).message;lk(function(){return cw(n,void 0,void 0,function(){return lw(this,function(e){return [2,t._trigger(r)];});});});}).catch(function(r){if(ww(r))throw r;ak(2).then(function(){var o=n._createPendingScheduledUserMessage(e,s,i);n._markMessageAsFailed(o,r),lk(function(){return cw(n,void 0,void 0,function(){return lw(this,function(e){return [2,t._trigger(o)];});});});});});},t.prototype.sendFileMessage=function(e){var t=uw(uw({},zN),e);return Fk(BN(t)).throw(Iw.invalidParameters),this._sendFileMessage(t);},t.prototype.sendMultipleFilesMessage=function(e){var t,n=uw(uw({},bR),e),r=tA.of(this._iid);Fk(function(e,t){return void 0===t&&(t=5),PN(e)&&Array.isArray(e.fileInfoList)&&e.fileInfoList.length>=2&&e.fileInfoList.length<=t&&e.fileInfoList.every(function(e){return function(e){return (Dw(e.file)||kw("string",e.fileUrl))&&kw("string",e.fileName,!0)&&kw("string",e.mimeType,!0)&&kw("number",e.fileSize,!0)&&(void 0===e.thumbnailSizes||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every(function(e){return e.maxWidth>0&&e.maxHeight>0;}));}(e);});}(n,null===(t=r.appInfo)||void 0===t?void 0:t.multipleFilesMessageFileCountLimit)).throw(Iw.invalidParameters);var i=!!e.fileInfoList.find(function(e){var t=r.appInfo.uploadSizeLimit;return e.file instanceof Blob&&e.file.size>t||e.fileSize>t;});return Fk(!i).throw(Iw.fileSizeLimitExceededError),this._sendMultipleFilesMessage(n);},t.prototype._sendFileMessage=function(e,t,n){var r=this;void 0===n&&(n=!1);var i=tA.of(this._iid).dispatcher,s=WD.of(this._iid).fileMessageQueue,o=null!=t?t:this._generateRequestId(),a=Date.now(),u=new MN();return o||(o=this._generateRequestId()),ak(2).then(function(){var t=r._createPendingFileMessage(e,o,a);i.dispatch(new cA({messages:[t],source:n?rA.LOCAL_MESSAGE_RESEND_STARTED:rA.EVENT_MESSAGE_SENT_PENDING})),lk(function(){return cw(r,void 0,void 0,function(){return lw(this,function(e){return [2,u._trigger(t)];});});}),s.request(r,o,e).then(function(e){i.dispatch(new cA({messages:[e],source:rA.EVENT_MESSAGE_SENT_SUCCESS})),lk(function(){return cw(r,void 0,void 0,function(){return lw(this,function(t){return [2,u._trigger(e)];});});});}).catch(function(t){if(ww(t))throw t;ak(2).then(function(){var n=r._createPendingFileMessage(e,o,a),s=tA.of(r._iid).cacheContext.localCacheEnabled&&Rw(t.code);r._markMessageAsFailed(n,t,s),i.dispatch(new cA({messages:[n],source:n.sendingStatus===Kw.PENDING?rA.REQUEST_RESEND_MESSAGE:t.code===pw.FILE_UPLOAD_CANCEL_FAILED?rA.LOCAL_MESSAGE_CANCELED:rA.EVENT_MESSAGE_SENT_FAILED})),lk(function(){return cw(r,void 0,void 0,function(){return lw(this,function(e){return [2,u._triggerFailed(t,n)];});});});});});}),u;},t.prototype._autoResendFileMessage=function(e){Fk(e instanceof dN&&!!e.messageParams).throw(Iw.invalidParameters);var t=tA.of(this._iid).logger;return t.debug("autoResendFileMessage pending",e),this._sendFileMessage(e.messageParams,e.reqId).onFailed(function(e){t.debug("autoResendFileMessage failed",e);}).onSucceeded(function(e){t.debug("autoResendFileMessage success",e);});},t.prototype._sendMultipleFilesMessage=function(e,t){var n=this,r=tA.of(this._iid).dispatcher,i=WD.of(this._iid).fileMessageQueue,s=null!=t?t:this._generateRequestId(),o=Date.now(),a=new wR();return s||(s=this._generateRequestId()),ak(2).then(function(){var t=n._createPendingMultipleFilesMessage(e,s,o);r.dispatch(new cA({messages:[t],source:rA.EVENT_MESSAGE_SENT_PENDING})),lk(function(){return cw(n,void 0,void 0,function(){return lw(this,function(e){return [2,a._trigger(t)];});});}),i.request(n,s,e,a).then(function(e){r.dispatch(new cA({messages:[e],source:rA.EVENT_MESSAGE_SENT_SUCCESS})),lk(function(){return cw(n,void 0,void 0,function(){return lw(this,function(t){return [2,a._trigger(e)];});});});}).catch(function(t){if(ww(t))throw t;ak(2).then(function(){var i=n._createPendingMultipleFilesMessage(e,s,o);n._markMessageAsFailed(i,t),r.dispatch(new cA({messages:[i],source:rA.EVENT_MESSAGE_SENT_FAILED})),lk(function(){return cw(n,void 0,void 0,function(){return lw(this,function(e){return [2,a._triggerFailed(t,i)];});});});});});}),a;},t.prototype._createScheduledFileMessage=function(e,t,n,r){var i=this,s=tA.of(this._iid).requestQueue,o=new sR(uw(uw({reqId:n,channelType:this.channelType,channelUrl:this.url},e),{fileUrl:e.fileUrl,requireAuth:e.requireAuth}));s.send(o).then(function(e){var n=e.as(oR).message;lk(function(){return cw(i,void 0,void 0,function(){return lw(this,function(e){return [2,t._trigger(n)];});});});}).catch(function(s){if(ww(s))throw s;ak(2).then(function(){var o=i._createPendingScheduledFileMessage(e,n,r);i._markMessageAsFailed(o,s),lk(function(){return cw(i,void 0,void 0,function(){return lw(this,function(e){return [2,t._triggerFailed(s,o)];});});});});});},t.prototype.sendFileMessages=function(e){var t,n;Fk(e.every(function(e){return BN(uw(uw({},zN),e));})).throw(Iw.invalidParameters);var r=new MN();try{for(var i=dw(e),s=i.next();!s.done;s=i.next()){var o=s.value;this.sendFileMessage(o).onPending(function(e){return r._trigger(e);}).onFailed(function(e,t){return r._triggerFailed(e,t);}).onSucceeded(function(e){return r._trigger(e);});}}catch(e){t={error:e};}finally{try{s&&!s.done&&(n=i.return)&&n.call(i);}finally{if(t)throw t.error;}}return r;},t.prototype.resendFileMessage=function(e,t){var n;return cw(this,void 0,void 0,function(){var r,i,s;return lw(this,function(o){return r=Boolean(e.url)||Dw(t)||Dw(null===(n=e.messageParams)||void 0===n?void 0:n.file),Fk(e instanceof dN&&r&&!e.scheduledInfo).throw(Iw.invalidParameters),i=new ZC(),s=function(e,t){var n;return e.messageParams?(!e.url&&Dw(t)&&(e.messageParams.file=t),e.messageParams):eI(tI({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,file:t,fileUrl:e.url,fileName:e.name,fileSize:e.size,mimeType:e.type,thumbnailSizes:null===(n=e.thumbnails)||void 0===n?void 0:n.map(function(e){return {maxWidth:e.width,maxHeight:e.height};})}));}(e,t),this._sendFileMessage(s,e.reqId,!0).onFailed(function(e){return i.reject(e);}).onSucceeded(function(e){return i.resolve(e);}),[2,i.promise];});});},t.prototype.updateFileMessage=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i;return lw(this,function(s){switch(s.label){case 0:return n=uw(uw({},YN),t),Fk(kw("number",e)&&function(e){return QN(e);}(n)).throw(Iw.invalidParameters),r=tA.of(this._iid).requestQueue,i=new QO(uw({channelType:this.channelType,channelUrl:this.url,messageId:e},n)),[4,r.send(i)];case 1:return [2,s.sent().as(WO).message];}});});},t.prototype.cancelUploadingFileMessage=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return Fk(kw("string",e)).throw(Iw.invalidParameters),WD.of(this._iid).fileMessageQueue.cancel(this,e),[2,!0];});});},t.prototype.copyFileMessage=function(e,n){var r,i,s;return cw(this,void 0,void 0,function(){var o,a;return lw(this,function(u){return Fk(e instanceof t&&n instanceof dN&&n.sendingStatus===Kw.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(Iw.invalidParameters),o=new ZC(),a=tI(uw(uw({},n),{fileUrl:n.url,fileName:n.name,fileSize:n.size,mimeType:n.type,mentionType:n.mentionType,mentionedUserIds:null!==(r=n.mentionedUserIds)&&void 0!==r?r:null===(i=n.mentionedUsers)||void 0===i?void 0:i.map(function(e){return e.userId;}),pushNotificationDeliveryOption:Bw.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:null===(s=n.thumbnails)||void 0===s?void 0:s.map(function(e){return {maxWidth:e.width,maxHeight:e.height};}),requireAuth:n.requireAuth,isPinnedMessage:!1})),e._sendFileMessage(a).onSucceeded(function(e){return o.resolve(e);}).onFailed(function(e){return o.reject(e);}),[2,o.promise];});});},t.prototype.deleteMessage=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return Fk(e instanceof eN).throw(Iw.invalidParameters),e.messageId>0?(t=tA.of(this._iid).requestQueue,n=new YO({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId}),[4,t.send(n)]):[3,2];case 1:r.sent(),r.label=2;case 2:return [2];}});});},t.prototype.addReaction=function(e,t){return cw(this,void 0,void 0,function(){var n,r;return lw(this,function(i){switch(i.label){case 0:return Fk(e instanceof eN&&e.messageId>0&&kw("string",t)).throw(Iw.invalidParameters),n=tA.of(this._iid).requestQueue,r=new XO({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:t}),[4,n.send(r)];case 1:return [2,i.sent().as(JO).reactionEvent];}});});},t.prototype.deleteReaction=function(e,t){return cw(this,void 0,void 0,function(){var n,r;return lw(this,function(i){switch(i.label){case 0:return Fk(e instanceof eN&&e.messageId>0&&kw("string",t)).throw(Iw.invalidParameters),n=tA.of(this._iid).requestQueue,r=new $O({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:t}),[4,n.send(r)];case 1:return [2,i.sent().as(eR).reactionEvent];}});});},t.prototype._updateUserMessageMetaArray=function(e,t,n,r){return cw(this,void 0,void 0,function(){var i,s,o,a,u,c;return lw(this,function(l){switch(l.label){case 0:return i=tA.of(this._iid),s=i.dispatcher,o=i.requestQueue,a=new BO({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:t,mode:n,upsert:r}}),[4,o.send(a)];case 1:return u=l.sent(),c=u.as(KO).message,s.dispatch(new cA({messages:[c],source:rA.EVENT_MESSAGE_UPDATED})),[2,c];}});});},t.prototype._updateFileMessageMetaArray=function(e,t,n,r){return cw(this,void 0,void 0,function(){var i,s,o,a,u,c;return lw(this,function(l){switch(l.label){case 0:return i=tA.of(this._iid),s=i.dispatcher,o=i.requestQueue,a=new QO({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:t,mode:n,upsert:r}}),[4,o.send(a)];case 1:return u=l.sent(),c=u.as(WO).message,s.dispatch(new cA({messages:[c],source:rA.EVENT_MESSAGE_UPDATED})),[2,c];}});});},t.prototype.createMessageMetaArrayKeys=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){return Fk(e instanceof eN&&e.messageId>0&&Ow("string",t)).throw(Iw.invalidParameters),n=t.map(function(e){return new QA({key:e});}),e instanceof dN?[2,this._updateFileMessageMetaArray(e.messageId,n,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,n,"add",!0)];});});},t.prototype.deleteMessageMetaArrayKeys=function(e,t){return cw(this,void 0,void 0,function(){var n;return lw(this,function(r){return Fk(e instanceof eN&&e.messageId>0&&Ow("string",t)).throw(Iw.invalidParameters),n=t.map(function(e){return new QA({key:e});}),e instanceof dN?[2,this._updateFileMessageMetaArray(e.messageId,n,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,n,"remove",!0)];});});},t.prototype.addMessageMetaArrayValues=function(e,t){return cw(this,void 0,void 0,function(){return lw(this,function(n){return Fk(e instanceof eN&&e.messageId>0&&t.every(function(e){return e instanceof QA;})).throw(Iw.invalidParameters),e instanceof dN?[2,this._updateFileMessageMetaArray(e.messageId,t,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,t,"add",!0)];});});},t.prototype.removeMessageMetaArrayValues=function(e,t){return cw(this,void 0,void 0,function(){return lw(this,function(n){return Fk(e instanceof eN&&e.messageId>0&&t.every(function(e){return e instanceof QA;})).throw(Iw.invalidParameters),e instanceof dN?[2,this._updateFileMessageMetaArray(e.messageId,t,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,t,"remove",!0)];});});},t.prototype.report=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return Fk(Aw(HN,e)&&kw("string",t)).throw(Iw.invalidParameters),n=tA.of(this._iid),r=n.sdkState,i=n.requestQueue,s=new HO({channelUrl:this.url,channelType:this.channelType,userId:r.userId,category:e,description:t}),[4,i.send(s)];case 1:return o.sent(),[2];}});});},t.prototype.reportUser=function(e,t,n){return cw(this,void 0,void 0,function(){var r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return Fk(e instanceof Hk&&Aw(HN,t)&&kw("string",n)).throw(Iw.invalidParameters),r=tA.of(this._iid),i=r.sdkState,s=r.requestQueue,o=new jO({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:e.userId,category:t,description:n}),[4,s.send(o)];case 1:return a.sent(),[2];}});});},t.prototype.reportMessage=function(e,t,n){return cw(this,void 0,void 0,function(){var r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return Fk(e instanceof tN&&Aw(HN,t)&&kw("string",n)).throw(Iw.invalidParameters),r=tA.of(this._iid),i=r.sdkState,s=r.requestQueue,o=new VO({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:e.sender.userId,messageId:e.messageId,category:t,description:n}),[4,s.send(o)];case 1:return a.sent(),[2];}});});},t.prototype.updatePoll=function(e,t){return cw(this,void 0,void 0,function(){var n,r;return lw(this,function(i){switch(i.label){case 0:return Fk(kw("number",e)&&function(e){return kw("string",e.title,!0)&&sA(e.data)&&kw("boolean",e.allowUserSuggestion,!0)&&kw("boolean",e.allowMultipleVotes,!0)&&kw("number",e.closeAt,!0);}(t)).throw(Iw.invalidParameters),n=tA.of(this._iid).requestQueue,r=new aR(uw({pollId:e},t)),[4,n.send(r)];case 1:return [2,i.sent().as(uR).poll];}});});},t.prototype.deletePoll=function(e){return cw(this,void 0,void 0,function(){var t,n,r;return lw(this,function(i){switch(i.label){case 0:return t=kw("number",e),Fk(t).throw(Iw.invalidParameters),n=tA.of(this._iid).requestQueue,r=new cR({pollId:e}),[4,n.send(r)];case 1:return i.sent(),[2];}});});},t.prototype.closePoll=function(e){return cw(this,void 0,void 0,function(){var t,n,r;return lw(this,function(i){switch(i.label){case 0:return t=kw("number",e),Fk(t).throw(Iw.invalidParameters),n=tA.of(this._iid).requestQueue,r=new lR({pollId:e}),[4,n.send(r)];case 1:return [2,i.sent().as(dR).poll];}});});},t.prototype.addPollOption=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i;return lw(this,function(s){switch(s.label){case 0:return n=kw("number",e)&&kw("string",t)&&""!==t.trim(),Fk(n).throw(Iw.invalidParameters),r=tA.of(this._iid).requestQueue,i=new hR({channelUrl:this.url,channelType:this.channelType,pollId:e,optionText:t}),[4,r.send(i)];case 1:return [2,s.sent().as(fR).poll];}});});},t.prototype.updatePollOption=function(e,t,n){return cw(this,void 0,void 0,function(){var r,i,s;return lw(this,function(o){switch(o.label){case 0:return r=kw("number",e)&&kw("number",t)&&kw("string",n)&&""!==n.trim(),Fk(r).throw(Iw.invalidParameters),i=tA.of(this._iid).requestQueue,s=new pR({pollId:e,pollOptionId:t,optionText:n}),[4,i.send(s)];case 1:return [2,o.sent().as(vR).poll];}});});},t.prototype.deletePollOption=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i;return lw(this,function(s){switch(s.label){case 0:return n=kw("number",e)&&kw("number",t),Fk(n).throw(Iw.invalidParameters),r=tA.of(this._iid).requestQueue,i=new _R({pollId:e,pollOptionId:t}),[4,r.send(i)];case 1:return s.sent(),[2];}});});},t.prototype.votePoll=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i,s,o,a,u;return lw(this,function(c){switch(c.label){case 0:return n=kw("number",e)&&Ow("number",t),Fk(n).throw(Iw.invalidParameters),r=tA.of(this._iid),i=r.requestQueue,s=r.dispatcher,o=new mR({reqId:this._generateRequestId(),channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionIds:t}),[4,i.send(o)];case 1:return a=c.sent(),u=a.as(gR).event,s.dispatch(new pA({event:u,source:rA.EVENT_POLL_VOTED})),[2,u];}});});},t.prototype.getPollChangeLogsSinceTimestamp=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return Fk(kw("number",e)).throw(Iw.invalidParameters),[4,xA.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return [2,t.sent()];}});});},t.prototype.getPollChangeLogsSinceToken=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return Fk(kw("string",e,!0)),[4,xA.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return [2,t.sent()];}});});},t.prototype.createPollListQuery=function(e){return void 0===e&&(e=10),new UA(this._iid,{channelUrl:this.url,channelType:this.channelType,limit:e});},t.prototype.createPollVoterListQuery=function(e,t,n){return void 0===n&&(n=20),new qA(this._iid,{channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionId:t,limit:n});},t;}(Ak),TR=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach(function(e){n.hasOwnProperty(e)&&(n[e]=t[e]);}),n;}return aw(t,e),t;}(function(){this.onConnected=UI,this.onReconnectStarted=UI,this.onReconnectSucceeded=UI,this.onReconnectFailed=UI,this.onDisconnected=UI;}),SR=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach(function(e){n.hasOwnProperty(e)&&(n[e]=t[e]);}),n;}return aw(t,e),t;}(function(){this.onSessionExpired=UI,this.onSessionTokenRequired=function(e){return e(null);},this.onSessionError=UI,this.onSessionRefreshed=UI,this.onSessionClosed=UI;}),CR=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach(function(e){n.hasOwnProperty(e)&&(n[e]=t[e]);}),n;}return aw(t,e),t;}(function(){this.onFriendsDiscovered=UI,this.onTotalUnreadMessageCountChanged=UI,this.onTotalUnreadMessageCountUpdated=UI;}),kR=function(e){function t(t){var n=t.limit,r=t.token,i=t.userIdsFilter,s=t.metaDataKeyFilter,o=t.metaDataValuesFilter,a=t.nicknameStartsWithFilter,u=e.call(this)||this;return u.method=nI.GET,u.path=iI,u.params=eI({limit:n,token:r,user_ids:i,metadatakey:s,metadatavalues_in:o,nickname_startswith:a}),u;}return aw(t,e),t;}(wI),AR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map(function(e){return new Hk(t,e);}),r.next=n.next,r;}return aw(t,e),t;}(II),NR=function(e){function t(t,n){var r,i,s,o=this;return (o=e.call(this,t,n)||this).userIdsFilter=null,o.metaDataKeyFilter=null,o.metaDataValuesFilter=null,o.nicknameStartsWithFilter=null,o.userIdsFilter=null!==(r=n.userIdsFilter)&&void 0!==r?r:null,o.metaDataKeyFilter=null!==(i=n.metaDataKeyFilter)&&void 0!==i?i:null,o.metaDataValuesFilter=null!==(s=n.metaDataValuesFilter)&&void 0!==s?s:null,o.nicknameStartsWithFilter=n.nicknameStartsWithFilter||null,o;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&Ow("string",this.userIdsFilter,!0)&&kw("string",this.metaDataKeyFilter,!0)&&Ow("string",this.metaDataValuesFilter,!0)&&kw("string",this.metaDataKeyFilter,!0);},t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=tA.of(this._iid).requestQueue,t=new kR(tI(uw(uw({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=o.sent(),r=n.as(AR),i=r.users,s=r.next,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return [2,[]];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(vA),OR=function(e){function t(t){var n=t.userId,r=t.limit,i=t.token,s=t.userIdsFilter,o=e.call(this)||this;return o.method=nI.GET,o.path="".concat(iI,"/").concat(n,"/block"),o.params=eI({limit:r,token:i,user_ids:s}),o;}return aw(t,e),t;}(wI),RR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map(function(e){return new Hk(t,e);}),r.next=n.next,r;}return aw(t,e),t;}(II),DR=function(e){function t(t,n){var r,i=this;return (i=e.call(this,t,n)||this).userIdsFilter=null,i.userIdsFilter=null!==(r=n.userIdsFilter)&&void 0!==r?r:null,i;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&Ow("string",this.userIdsFilter,!0);},t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o,a;return lw(this,function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=tA.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new OR(tI(uw(uw({},this),{userId:t.userId,token:this._token}))),[4,n.send(r)]):[3,2]:[3,5];case 1:return i=u.sent(),s=i.as(RR),o=s.users,a=s.next,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,o];case 2:return [2,[]];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(vA),xR=function(e){function t(t){var n=t.userId,r=t.limit,i=t.token,s=e.call(this)||this;return s.method=nI.GET,s.path="".concat(iI,"/").concat(encodeURIComponent(n),"/friends"),s.params={limit:r,token:i},s;}return aw(t,e),t;}(wI),LR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.hasMore=n.has_more,r.users=n.users.map(function(e){return new Hk(t,e);}),r.next=n.next,r;}return aw(t,e),t;}(II),MR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this);},t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o,a,u;return lw(this,function(c){switch(c.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=tA.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new xR(uw(uw({},this),{userId:t.userId,token:this._token})),[4,n.send(r)]):[3,2]:[3,5];case 1:return i=c.sent(),s=i.as(LR),o=s.users,a=s.hasMore,u=s.next,this._token=u,this._hasNext=a,this._isLoading=!1,[2,o];case 2:return [2,[]];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(vA),UR={},PR=function(){function e(e){var t=e.dbname,n=e.itemSizeLimit,r=void 0===n?1048576:n,i=e.cacheLimit,s=void 0===i?256:i,o=e.blockHashBase,a=void 0===o?2:o,u=e.blockHashMultiplier,c=void 0===u?10:u,l=e.blockHashConstant,d=void 0===l?11:l,h=e.transactionApplyDelay,f=void 0===h?200:h,p=e.disableLogger,v=void 0!==p&&p;return UR[t]||(this.itemSizeLimit=r,this.cacheLimit=s,this.blockHashBase=a,this.blockHashMultiplier=c,this.blockHashConstant=d,this.transactionApplyDelay=f,this.disableLogger=v,UR[t]=this),UR[t];}return e.get=function(e){return UR[e];},e;}();!function(e){e[e.UNKNOWN_ERROR=6e7]="UNKNOWN_ERROR",e[e.STORE_NOT_DEFINED=61001e3]="STORE_NOT_DEFINED",e[e.STORE_NOT_AVAILABLE=61001001]="STORE_NOT_AVAILABLE",e[e.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING=61001002]="STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING",e[e.STORE_IS_FULL=61001003]="STORE_IS_FULL",e[e.STORE_NOT_INITIALIZED=61001004]="STORE_NOT_INITIALIZED",e[e.STORE_INVALID_KEY_TYPE=61002e3]="STORE_INVALID_KEY_TYPE",e[e.STORE_BROKEN_INTEGRITY=61002001]="STORE_BROKEN_INTEGRITY",e[e.STORE_BROKEN_BLOB=61002002]="STORE_BROKEN_BLOB",e[e.STORE_ENCRYPTION_INVALID=61002003]="STORE_ENCRYPTION_INVALID",e[e.STORE_ITEM_SIZE_LIMIT_EXCEEDED=61017e3]="STORE_ITEM_SIZE_LIMIT_EXCEEDED",e[e.STORE_READ_FAILED=61017001]="STORE_READ_FAILED",e[e.STORE_WRITE_FAILED=61017002]="STORE_WRITE_FAILED",e[e.DATABASE_SCHEMA_NOT_ON_UPGRADE=62002e3]="DATABASE_SCHEMA_NOT_ON_UPGRADE",e[e.COLLECTION_NOT_READY=63001e3]="COLLECTION_NOT_READY",e[e.COLLECTION_KEY_NOT_MATCH=63002e3]="COLLECTION_KEY_NOT_MATCH",e[e.COLLECTION_QUERY_NOT_VALID=63002001]="COLLECTION_QUERY_NOT_VALID",e[e.COLLECTION_KEY_NOT_FOUND=63004e3]="COLLECTION_KEY_NOT_FOUND",e[e.COLLECTION_KEY_NOT_GIVEN=63004001]="COLLECTION_KEY_NOT_GIVEN",e[e.COLLECTION_INSERT_DUPLICATE=63009e3]="COLLECTION_INSERT_DUPLICATE",e[e.COLLECTION_WRITE_FAILED=63017e3]="COLLECTION_WRITE_FAILED",e[e.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED=63017001]="COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED",e[e.INDEX_TABLE_IS_REQUIRED=65001e3]="INDEX_TABLE_IS_REQUIRED",e[e.INDEX_TYPE_NOT_MATCH=65002e3]="INDEX_TYPE_NOT_MATCH",e[e.COMPARE_TYPE_NOT_MATCH=69002001]="COMPARE_TYPE_NOT_MATCH",e[e.CIRCULAR_REFERENCE_FOUND=69002002]="CIRCULAR_REFERENCE_FOUND";}(yR||(yR={}));var FR,qR=function(e){function t(n){var r=n.code,i=void 0===r?yR.UNKNOWN_ERROR:r,s=n.message,o=void 0===s?"Unknown error occurred.":s,a=e.call(this,o)||this;return a.code=i,Object.setPrototypeOf(a,t.prototype),a;}return aw(t,e),Object.defineProperty(t,"storeNotDefined",{get:function(){return new t({code:yR.STORE_NOT_DEFINED,message:"Store is not defined. Specify the store on NestDB()"});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailable",{get:function(){return new t({code:yR.STORE_NOT_AVAILABLE,message:"Store is not available. Check your environment settings."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailableInPrivateBrowsing",{get:function(){return new t({code:yR.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,message:"Store is not available because it is in private browsing."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeIsFull",{get:function(){return new t({code:yR.STORE_IS_FULL,message:"Store is full."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotInitialized",{get:function(){return new t({code:yR.STORE_NOT_INITIALIZED,message:"Store is not initialized."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeKeyTypeIsInvalid",{get:function(){return new t({code:yR.STORE_INVALID_KEY_TYPE,message:"Store key should be string type."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenIntegrity",{get:function(){return new t({code:yR.STORE_BROKEN_INTEGRITY,message:"Data should be in a store but it does not. Integrity is broken."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenBlob",{get:function(){return new t({code:yR.STORE_BROKEN_BLOB,message:"Data should be in a store but it does not. Blob data is broken."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeEncryptionInvalid",{get:function(){return new t({code:yR.STORE_ENCRYPTION_INVALID,message:"Encryption algorithm has changed. All the store should reset."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeItemSizeExceeded",{get:function(){return new t({code:yR.STORE_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that the store allows."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeReadFailed",{get:function(){return new t({code:yR.STORE_READ_FAILED,message:"Failed to read from store."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeWriteFailed",{get:function(){return new t({code:yR.STORE_WRITE_FAILED,message:"Failed to write to store."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseSchemaNotOnUpgrade",{get:function(){return new t({code:yR.DATABASE_SCHEMA_NOT_ON_UPGRADE,message:"Committing schema is not allowed when upgrade is not running."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionNotReady",{get:function(){return new t({code:yR.COLLECTION_NOT_READY,message:"Collection is not ready due to an error during initialization."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotMatch",{get:function(){return new t({code:yR.COLLECTION_KEY_NOT_MATCH,message:"keyName of collection could not change."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionQueryNotValid",{get:function(){return new t({code:yR.COLLECTION_QUERY_NOT_VALID,message:"Query parameter is not a valid format."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionInsertDuplicate",{get:function(){return new t({code:yR.COLLECTION_INSERT_DUPLICATE,message:"The key already exists."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotFound",{get:function(){return new t({code:yR.COLLECTION_KEY_NOT_FOUND,message:"The key is not found."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotGiven",{get:function(){return new t({code:yR.COLLECTION_KEY_NOT_GIVEN,message:"The item should contain [keyName] property."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionWriteFailed",{get:function(){return new t({code:yR.COLLECTION_WRITE_FAILED,message:"Failed to write an item."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionItemSizeExceeded",{get:function(){return new t({code:yR.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that a collection allows."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTableIsRequired",{get:function(){return new t({code:yR.INDEX_TABLE_IS_REQUIRED,message:"Index table is required."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTypesNotMatch",{get:function(){return new t({code:yR.INDEX_TYPE_NOT_MATCH,message:"Indexed column should have primitive type."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"compareTypesNotMatch",{get:function(){return new t({code:yR.COMPARE_TYPE_NOT_MATCH,message:"Values to compare have different types."});},enumerable:!1,configurable:!0}),Object.defineProperty(t,"circularReferenceFound",{get:function(){return new t({code:yR.CIRCULAR_REFERENCE_FOUND,message:"Cannot handle circular referenced object."});},enumerable:!1,configurable:!0}),t;}(Error);!function(e){e.INIT="init",e.READY="ready",e.CLOSED="closed";}(FR||(FR={}));var HR,jR=function(e,t){if(void 0===t&&(t=new WeakMap()),"object"==typeof e&&null!==e){if(t.has(e))throw qR.circularReferenceFound;t.set(e,!0);var n=void 0;if(Array.isArray(e))n=e.map(function(e){return jR(e,t);});else if(e instanceof RegExp)n=e;else if(e instanceof Date)n=e;else for(var r in n={},e)n[r]=jR(e[r],t);return t.delete(e),n;}return e;},VR=function(e,t){if(null==t)return 1;if(null==e)return -1;if(typeof e!=typeof t)throw qR.compareTypesNotMatch;var n=0;switch(typeof e){case"boolean":case"number":n=e-t;break;case"string":n=e.localeCompare(t);}return n;},GR=function(e,t){for(var n=0,r=0;r<e.length;r++)n=e.charCodeAt(r)+(n<<6)+(n<<16)-n;return (n>>>0)%t;},zR=function(e){return new Promise(function(t){setTimeout(function(){return t();},e);});},BR=function(e,t){if(!t)return !1;if("function"!=typeof e){for(var n in e)if(["/and","&&"].includes(n)){if(e[n].some(function(e){return !BR(e,t);}))return !1;}else if(["/or","||"].includes(n)){if(e[n].every(function(e){return !BR(e,t);}))return !1;}else if("/where"===n){if(!(0, e[n])(t))return !1;}else {var r=n;if("object"==typeof e[r]){var i=e[r];for(var s in i)switch(s){case"/eq":case"=":if((o=t[r])!==(a=i[s]))return !1;break;case"/neq":case"!=":if((o=t[r])===(a=i[s]))return !1;break;case"/gt":case">":var o=t[r],a=i[s];if(!(VR(o,a)>0))return !1;break;case"/gte":case">=":if(o=t[r],a=i[s],!(VR(o,a)>=0))return !1;break;case"/lt":case"<":if(o=t[r],a=i[s],!(VR(o,a)<0))return !1;break;case"/lte":case"<=":if(o=t[r],a=i[s],!(VR(o,a)<=0))return !1;break;case"/in":if(o=t[r],!(a=i[s]).includes(o))return !1;break;case"/nin":if(o=t[r],(a=i[s]).includes(o))return !1;break;case"/contain":if(o=t[r],a=i[s],!o.includes(a))return !1;break;case"/regex":if(o=t[r],!(a=i[s]).test(o))return !1;break;case"/where":if(o=t[r],!(0, i[s])(o))return !1;}}else if("function"==typeof e[r]){if(!e[r](t[r]))return !1;}else if(e[r]!==t[r])return !1;}return !0;}return e(t);},KR=function(){},QR=function(){return Promise.resolve();},WR=function(e){return e;},YR=function(e,t){t();};!function(e){e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD";}(HR||(HR={}));var ZR,XR,JR,$R=function(){function e(e){var t=e.initialPrevValue,n=void 0===t?null:t,r=e.initialNextValue,i=void 0===r?null:r,s=e.iterator,o=e.map,a=void 0===o?WR:o,u=e.backward,c=void 0===u?QR:u,l=e.forward,d=void 0===l?QR:l,h=e.complete,f=void 0===h?KR:h;this._prevValue=n,this._nextValue=i,this._error=null,this._map=a,this._backward=c,this._forward=d,this._iterator=s,this._complete=f;}return Object.defineProperty(e.prototype,"prevValue",{get:function(){return this._map(this._prevValue);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextValue",{get:function(){return this._map(this._nextValue);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return !!this._prevValue;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return !!this._nextValue;},enumerable:!1,configurable:!0}),e.prototype.prev=function(){return cw(this,void 0,void 0,function(){var e,t,n;return lw(this,function(r){switch(r.label){case 0:if(!this.hasPrevious)return [3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._prevValue,t=this,[4,this._backward()];case 2:return t._prevValue=r.sent()||null,this._nextValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return [4,this._iterator(this)];case 5:return [2,r.sent()];case 6:this._complete(),r.label=7;case 7:return [2];}});});},e.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n;return lw(this,function(r){switch(r.label){case 0:if(!this.hasNext)return [3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._nextValue,t=this,[4,this._forward()];case 2:return t._nextValue=r.sent()||null,this._prevValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return [4,this._iterator(this)];case 5:return [2,r.sent()];case 6:this._complete(),r.label=7;case 7:return [2];}});});},e.prototype.stop=function(){this._prevValue=null,this._nextValue=null,this._complete();},e;}(),eD=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,s=e.blockManager,o=e.indexer;this.condition=n,this.backward=i,this._blockManager=s,this._indexer=o;}return e.prototype.findOptimizedStartPosition=function(){var e=this,t=["=","/eq",">",">=","/gt","/gte"],n=["=","/eq","<","<=","/lt","/lte"];if(this.backward){var r=this._indexer.origin.length-1;if("function"!=typeof this.condition)for(var i in this._indexer.fields){var s=this._indexer.fields[i],o=1;if("-"===s[0]&&(s=s.slice(1),o=-1),this.condition[s])if("object"==typeof this.condition[s]){var a=o>0?n:t;for(var u in this.condition[s])if(a.includes(u))for(var c=r;c>=0;c--)if(o*VR(this._indexer.origin[c].columnValues[i],this.condition[s][u])<=0){r=c;break;}}else for(c=r;c>=0;c--)if(o*VR(this._indexer.origin[c].columnValues[i],this.condition[s])<=0){r=c;break;}}return Math.min(r+1,this._indexer.origin.length-1);}var l=0;if("function"!=typeof this.condition){var d=function(r){var i=h._indexer.fields[r],s=1;if("-"===i[0]&&(i=i.slice(1),s=-1),h.condition[i])if("object"==typeof h.condition[i])Object.keys(h.condition[i]).forEach(function(o){if((s>0?t:n).includes(o))for(var a=l;a<e._indexer.origin.length;a++)if(s*VR(e._indexer.origin[a].columnValues[r],e.condition[i][o])>=0){l=a;break;}});else for(var o=l;o<h._indexer.origin.length;o++)if(s*VR(h._indexer.origin[o].columnValues[r],h.condition[i])>=0){l=o;break;}},h=this;for(i=0;i<this._indexer.fields.length;i++)d(i);}return Math.max(l-1,0);},e.prototype.each=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u=this;return lw(this,function(c){switch(c.label){case 0:if(t=this.findOptimizedStartPosition(),n=0,this.backward&&this._indexer.origin[t]&&(n=this._indexer.origin[t].keys.length-1),r=function(){if(u._indexer.origin[t]){if(!u._indexer.origin[t].keys[++n]){if(!u._indexer.origin[++t])return !1;n=0;}return !0;}return !1;},i=function(){if(u._indexer.origin[t]){if(!u._indexer.origin[t].keys[--n]){if(!u._indexer.origin[--t])return !1;n=u._indexer.origin[t].keys.length-1;}return !0;}return !1;},s=null,!this._indexer.origin[t])return [3,4];o=this.backward?i:r,c.label=1;case 1:return [4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])];case 2:if((a=c.sent())&&BR(this.condition,a))return s=a,[3,4];c.label=3;case 3:if(o())return [3,1];c.label=4;case 4:return [4,new Promise(function(o){var a=new $R({initialNextValue:jR(s),iterator:e,forward:function(){return cw(u,void 0,void 0,function(){var e,s;return lw(this,function(o){switch(o.label){case 0:e=this.backward?i:r,o.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return (s=o.sent())&&BR(this.condition,s)?[2,jR(s)]:[3,1];case 3:return [2,null];}});});},backward:function(){return cw(u,void 0,void 0,function(){var e,s;return lw(this,function(o){switch(o.label){case 0:e=this.backward?r:i,o.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return (s=o.sent())&&BR(this.condition,s)?[2,jR(s)]:[3,1];case 3:return [2,null];}});});},complete:o});e(a);})];case 5:return [2,c.sent()];}});});},e;}(),tD=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,s=e.mutex,o=e.blockManager,a=e.indexer;this._mutex=s,this._iterator=new eD({condition:n,backward:i,blockManager:o,indexer:a});}return e.prototype.fetch=function(e){return void 0===e&&(e={}),cw(this,void 0,void 0,function(){var t,n,r,i,s=this;return lw(this,function(o){switch(o.label){case 0:if(t=Math.max(e.offset||0,0),0===(n="number"==typeof e.limit?e.limit:Number.MAX_SAFE_INTEGER))return [2,[]];if(n<0)throw qR.collectionQueryNotValid;o.label=1;case 1:return o.trys.push([1,4,,5]),r=[],[4,this._mutex.lock()];case 2:return o.sent(),[4,this._iterator.each(function(e){return cw(s,void 0,void 0,function(){return lw(this,function(i){return e.error?e.stop():e.hasNext?0===t?(r.push(e.nextValue),0<n&&n<=r.length?e.stop():e.next()):(t--,e.next()):e.stop(),[2];});});})];case 3:return o.sent(),this._mutex.unlock(),[2,r];case 4:throw i=o.sent(),this._mutex.unlock(),i;case 5:return [2];}});});},e.prototype.count=function(){return cw(this,void 0,void 0,function(){var e,t,n=this;return lw(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=0,[4,this._mutex.lock()];case 1:return r.sent(),[4,this._iterator.each(function(t){return cw(n,void 0,void 0,function(){return lw(this,function(n){return t.error?t.stop():t.hasNext?(e++,t.next()):t.stop(),[2];});});})];case 2:return r.sent(),this._mutex.unlock(),[2,e];case 3:throw t=r.sent(),this._mutex.unlock(),t;case 4:return [2];}});});},e;}(),nD=function(e){return "".concat("nest","@").concat(e);},rD=function(e,t){return "".concat(nD(e),"/").concat(t);},iD=function(e,t){return "".concat(rD(e,t),".metadata");},sD=function(e,t){return "".concat(rD(e,t),"/block.");},oD=function(e,t){return "".concat(rD(e,t),"/blob.");},aD=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this.dbname=t,this.collectionName=n,this.store=r;}return e.prototype.get=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c;return lw(this,function(l){switch(l.label){case 0:return [4,this.store.get(e)];case 1:return (t=l.sent())?(n=t.data,r=t.type,"undefined"==typeof fetch?[3,4]:[4,fetch(n)]):[3,5];case 2:return [4,l.sent().blob()];case 3:return [2,l.sent()];case 4:for(i=[],s=atob(n.split(",")[1]),o=0;o<s.length;o+=512){for(a=s.slice(o,o+512),u=new Array(a.length),c=0;c<a.length;c++)u[c]=a.charCodeAt(c);i.push(new Uint8Array(u));}return [2,new Blob(i,{type:r})];case 5:return [2,null];}});});},e.prototype.save=function(e,t){return void 0===t&&(t="".concat(Date.now())),cw(this,void 0,void 0,function(){var n,r,i,s,o=this;return lw(this,function(a){switch(a.label){case 0:return [4,new Promise(function(n){var r=function(e,t,n,r){return void 0===r&&(r=0),"".concat(oD(e,t)).concat(n,".").concat(r);}(o.dbname,o.collectionName,t),i=new FileReader();i.onload=function(){n({blobId:r,data:i.result,type:e.type});},i.readAsDataURL(e);})];case 1:return n=a.sent(),r=n.blobId,i=n.data,s=n.type,[4,this.store.set({key:r,value:{data:i,type:s}})];case 2:return a.sent(),[2,r];}});});},e.prototype.remove=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,this.store.remove(e)];case 1:return t.sent(),[2];}});});},e.prototype.clear=function(){return cw(this,void 0,void 0,function(){var e,t,n=this;return lw(this,function(r){switch(r.label){case 0:return e=oD(this.dbname,this.collectionName),[4,this.store.getAllKeys()];case 1:return t=r.sent(),[4,Promise.all(t.filter(function(t){return t.startsWith(e);}).map(function(e){return cw(n,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,this.store.remove(e)];case 1:return [2,t.sent()];}});});}))];case 2:return r.sent(),[2];}});});},e;}();!function(e){e[e.COMMIT=0]="COMMIT",e[e.WRITE=1]="WRITE",e[e.ERROR=2]="ERROR";}(ZR||(ZR={})),function(e){e.PENDING="pending",e.PERSISTENT="persistent",e.VOLATILE="volatile";}(XR||(XR={})),function(e){e[e.NO_CACHE=0]="NO_CACHE",e[e.DEFAULT=1]="DEFAULT",e[e.PERSISTENT=2]="PERSISTENT";}(JR||(JR={}));var uD,cD,lD=[XR.PENDING,XR.VOLATILE],dD={},hD=function(){function e(e){var t=e.dbname,n=e.limit,r=void 0===n?256:n;return dD[t]||(this.dbname=t,this._items=[],this._limit=r,dD[t]=this),dD[t];}return e.get=function(e){return dD[e];},Object.defineProperty(e.prototype,"items",{get:function(){return this._items;},enumerable:!1,configurable:!0}),e.prototype.find=function(e,t,n){return void 0===n&&(n=JR.DEFAULT),cw(this,void 0,void 0,function(){var r,i;return lw(this,function(s){switch(s.label){case 0:return (r=this.get(t))?[3,2]:[4,e.get(t)];case 1:return (i=s.sent())&&(r={key:t,value:i,state:n===JR.PERSISTENT?XR.PERSISTENT:XR.VOLATILE},this.put(r)),[3,3];case 2:n===JR.PERSISTENT&&(r.state=XR.PERSISTENT),s.label=3;case 3:return [2,r];}});});},e.prototype.get=function(e,t){void 0===t&&(t=JR.DEFAULT);var n=this._items.map(function(e){return e.key;}).indexOf(e);if(n>-1){var r=this._items[n];return t===JR.PERSISTENT&&(r.state=XR.PERSISTENT),t!==JR.NO_CACHE&&this.put(r),r;}return null;},e.prototype.put=function(e){var t,n;if(this._limit>0){var r=this._items.map(function(e){return e.key;}).indexOf(e.key);if(r>-1)lD.includes(this._items[r].state)&&lD.includes(e.state)?(this._items.splice(r,1),this._items.push(e)):(this._items[r].state=e.state,this._items[r].value=e.value);else {this._items.push(e);var i=this._items.filter(function(e){return e.state===XR.VOLATILE;}),s=i.length-this._limit;if(s>0){var o=[];try{for(var a=dw(this._items),u=a.next();!u.done;u=a.next()){var c=u.value;c.state===XR.VOLATILE&&s>0?s--:o.push(c);}}catch(e){t={error:e};}finally{try{u&&!u.done&&(n=a.return)&&n.call(a);}finally{if(t)throw t.error;}}this._items=o;}}}},e.prototype.remove=function(e){var t=this._items.map(function(e){return e.key;}).indexOf(e);t>-1&&this._items.splice(t,1);},e.prototype.clearByCondition=function(e){this._items=this._items.filter(function(t){return !e(t);});},e.prototype.clear=function(e){void 0===e&&(e=!1),this._items=e?[]:this._items.filter(function(e){return e.state!==XR.VOLATILE;});},e;}(),fD=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this._requests=[],this._onCommit=new Map(),this._onWrite=new Map(),this._onError=new Map(),this.dbname=t,this.collectionName=n,this.metadataKey=function(e,t){return "".concat(rD(e,t),"/trans.metadata");}(t,n),this.recordsetKey=function(e,t){return "".concat(rD(e,t),"/trans.recordset");}(t,n),this._store=r;}return Object.defineProperty(e.prototype,"generation",{get:function(){return this._metadata?this._metadata.generation:0;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requestCount",{get:function(){return this._requests.length;},enumerable:!1,configurable:!0}),e.prototype._getReducedRecordset=function(e){return void 0===e&&(e=[]),cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return [4,this._store.get(this.recordsetKey)];case 1:return (t=n.sent()||[]).push.apply(t,fw([],hw(e),!1)),[2,this._reduceRecordSet(t)];}});});},e.prototype._reduceRecordSet=function(e){for(var t=[],n={},r=e.length-1;r>=0;r--){for(var i=e[r],s=[],o=i.requests.length-1;o>=0;o--){var a=i.requests[o],u=a.data;n[u.key]||(s.unshift(a),n[u.key]=!0);}s.length>0&&(i.requests=s,t.unshift(i));}return t;},e.prototype._applyRecord=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i,s,o,a,u,c,l;return lw(this,function(d){switch(d.label){case 0:n=hD.get(this.dbname),r=t.generation,i=t.requests,s=null,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this._store.setMany(i.map(function(e){return uw(uw({},e.data),{generation:r});}))];case 2:for(o=d.sent(),a=0;a<i.length;a++)o[a]instanceof Error&&(s||(s=o[a]),u=i[a].data,n.put(uw(uw({},u),{state:XR.PERSISTENT})));return [3,4];case 3:return c=d.sent(),s=c,[3,4];case 4:return s?[3,6]:(l=e.filter(function(e){return e.generation!==r;}),[4,this._store.set({key:this.recordsetKey,value:l})]);case 5:return d.sent(),this._onWrite.forEach(function(e){e(i.map(function(e){return e.data;}));}),[3,7];case 6:this._onError.forEach(function(e){s&&e(s);}),d.label=7;case 7:return [2];}});});},e.prototype.init=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o,a;return lw(this,function(u){switch(u.label){case 0:return e=this,[4,this._store.get(this.metadataKey)];case 1:return e._metadata=u.sent()||{generation:1},[4,this._getReducedRecordset()];case 2:t=u.sent(),u.label=3;case 3:u.trys.push([3,8,9,10]),n=dw(t),r=n.next(),u.label=4;case 4:return r.done?[3,7]:(i=r.value,[4,this._applyRecord(t,i)]);case 5:u.sent(),u.label=6;case 6:return r=n.next(),[3,4];case 7:return [3,10];case 8:return s=u.sent(),o={error:s},[3,10];case 9:try{r&&!r.done&&(a=n.return)&&a.call(n);}finally{if(o)throw o.error;}return [7];case 10:return [2];}});});},e.prototype.on=function(e,t,n){switch(e){case ZR.COMMIT:this._onCommit.set(t,n);break;case ZR.WRITE:this._onWrite.set(t,n);break;case ZR.ERROR:this._onError.set(t,n);}},e.prototype.requestWrite=function(e,t){this._requests.push({data:e,options:t}),hD.get(this.dbname).put(uw({state:XR.PENDING},e));},e.prototype.requestMultipleWrite=function(e,t){var n,r,i=hD.get(this.dbname);try{for(var s=dw(e),o=s.next();!o.done;o=s.next()){var a=o.value;this._requests.push({data:a,options:t}),i.put(uw({state:XR.PENDING},a));}}catch(e){n={error:e};}finally{try{o&&!o.done&&(r=s.return)&&r.call(s);}finally{if(n)throw n.error;}}},e.prototype.clear=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){return hD.get(this.dbname).clearByCondition(function(e){return e.state===XR.PENDING;}),this._requests=[],[2];});});},e.prototype.commit=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o,a,u,c,l,d,h=this;return lw(this,function(f){switch(f.label){case 0:if(!((e=this._requests).length>0))return [3,4];for(t=[],n={},a=e.length-1;a>=0;a--)r=e[a],c=r.data,n[c.key]||(n[c.key]=!0,t.unshift(r));return i={generation:this.generation,requests:t},[4,this._getReducedRecordset([i])];case 1:return s=f.sent(),[4,this._store.set({key:this.recordsetKey,value:s})];case 2:return f.sent(),this._metadata.generation++,[4,this._store.set({key:this.metadataKey,value:this._metadata})];case 3:for(f.sent(),o=hD.get(this.dbname),a=0;a<t.length;a++)u=t[a],c=u.data,l=u.options,o.put(uw(uw({},c),{state:l&&l.persistent?XR.PERSISTENT:XR.VOLATILE}));this._requests=[],this._onCommit.forEach(function(t){t(e.map(function(e){return e.data;}));}),d=PR.get(this.dbname),setTimeout(function(){try{h._applyRecord(s,i);}catch(e){h._onError.forEach(function(t){return t(e);});}},d.transactionApplyDelay),f.label=4;case 4:return [2];}});});},e;}(),pD=function(){function e(e){var t=e.blockId,n=e.keyName,r=e.items,i=void 0===r?[]:r,s=e.limit;this.blockId=t,this.keyName=n,this.limit=s,this._items=fw([],hw(i),!1);}return e.createFromCacheItem=function(t){return t?new e(t.value):null;},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._items.length;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items;},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){return {blockId:this.blockId,keyName:this.keyName,limit:this.limit,items:this._items};},e.prototype.getItemByKey=function(e){var t=this,n=this._items.find(function(n){var r=n[t.keyName];return e===r;});return null!=n?n:null;},e.prototype.has=function(e){var t=this;return this._items.map(function(e){return e[t.keyName];}).includes(e);},e.prototype.add=function(e){var t=this,n=this._items.map(function(e){return e[t.keyName];}).indexOf(e[this.keyName]);return n<0?this._items.length<this.limit&&(this._items.push(e),!0):(this._items[n]=e,!0);},e.prototype.remove=function(e){for(var t in this._items)if(this._items[t][this.keyName]===e)return this._items.splice(parseInt(t),1),!0;return !1;},e.prototype.clear=function(){this._items=[];},e;}(),vD=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.metadata,i=e.hashFunction,s=void 0===i?GR:i,o=e.transaction,a=e.store;this.dbname=t,this.collectionName=n,this.hashFunction=s,this.metadata=r,this._transaction=o,this._store=a;}return Object.defineProperty(e.prototype,"keyName",{get:function(){return this.metadata.keyName;},enumerable:!1,configurable:!0}),e.prototype.createBlockId=function(e,t){return void 0===t&&(t=this.metadata.blockLevel),n=this.dbname,r=this.collectionName,i=t,s="".concat(function(e,t,n){var r=n.base*Math.pow(n.multiplier,t)+n.constant;return (n.hashFunction||GR)(e,r);}(e,t,{hashFunction:this.hashFunction,base:this.metadata.blockHashBase,multiplier:this.metadata.blockHashMultiplier,constant:this.metadata.blockHashConstant})),"".concat(sD(n,r)).concat(i,".").concat(s);var n,r,i,s;},e.prototype._findBlock=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:t=hD.get(this.dbname),n=this.metadata.blockLevel,o.label=1;case 1:return n>0?(r=this.createBlockId(e,n),[4,t.find(this._store,r)]):[3,4];case 2:if((i=o.sent())&&(null==(s=pD.createFromCacheItem(i))?void 0:s.getItemByKey(e)))return [2,s];o.label=3;case 3:return n--,[3,1];case 4:return [2,null];}});});},e.prototype.getFromBlock=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return [4,this._findBlock(e)];case 1:return [2,(t=n.sent())?t.getItemByKey(e):null];}});});},e.prototype.putToBlock=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return n=PR.get(this.dbname),r=this.createBlockId(e),i=Math.floor(this._store.itemSizeLimit/n.itemSizeLimit),[4,hD.get(this.dbname).find(this._store,r)];case 1:return s=a.sent(),(null==(o=s?pD.createFromCacheItem(s):new pD({blockId:r,keyName:this.keyName,items:[],limit:i}))?void 0:o.add(t))?(this._transaction.requestWrite({key:o.blockId,value:o.serialize()}),[2,!0]):[2,!1];}});});},e.prototype.removeFromBlock=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return [4,this._findBlock(e)];case 1:return (t=n.sent())&&t.remove(e)?(this._transaction.requestWrite({key:t.blockId,value:t.serialize()}),[2,!0]):[2,!1];}});});},e.prototype.clearAllBlocks=function(){return cw(this,void 0,void 0,function(){var e,t,n;return lw(this,function(r){switch(r.label){case 0:return e=sD(this.dbname,this.collectionName),[4,this._store.getAllKeys()];case 1:return t=r.sent(),n=t.filter(function(t){return t.startsWith(e);}),[4,this._store.removeMany(n)];case 2:return r.sent(),[4,this._transaction.clear()];case 3:return r.sent(),hD.get(this.dbname).clearByCondition(function(t){return t.key.startsWith(e);}),[2];}});});},e;}(),_D={},yD=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,i=e.fields,s=e.transaction,o=e.store,a=this;this._origin=[],this._table=[];var u=function(e,t,n){return "".concat(rD(e,t),"/index.").concat(n);}(t,n,i.join(">"));return _D[u]||(this.dbname=t,this.collectionName=n,this.keyName=r,this.fields=i,this.indexerKey=u,this._transaction=s,this._store=o,this._transaction.on(ZR.COMMIT,this.indexerKey,function(){return a.commit();}),this._transaction.on(ZR.ERROR,this.indexerKey,function(){return a.abort();})),_D[u];}return e.createKey=function(e){return e.join(">");},e.parseKey=function(e){return e.split(">");},e.clearIndexerMap=function(){for(var e in _D)delete _D[e];},e.prototype._addItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=hw(this.indexOf(n),2),i=r[0];return r[1]?!this._table[i].keys.includes(t)&&(this._table[i].keys.push(t),!0):(this._table.splice(i,0,{columnValues:n,keys:[t]}),!0);},e.prototype._removeItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=hw(this.indexOf(n),2),i=r[0];if(r[1]){var s=this._table[i].keys.indexOf(t);if(s>-1)return this._table[i].keys.splice(s,1),0===this._table[i].keys.length&&this._table.splice(i,1),!0;}return !1;},Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this._table;},enumerable:!1,configurable:!0}),e.prototype.getColumnValues=function(e){var t,n,r,i,s=[];try{for(var o=dw(this.fields),a=o.next();!a.done;a=o.next()){var u=a.value;if("-"===u[0]&&(u=u.slice(1)),r=e[u],void 0,i=typeof r,null!==r&&"undefined"!==i&&"boolean"!==i&&"number"!==i&&"string"!==i)throw qR.indexTypesNotMatch;s.push(e[u]);}}catch(e){t={error:e};}finally{try{a&&!a.done&&(n=o.return)&&n.call(o);}finally{if(t)throw t.error;}}return s;},e.prototype.diff=function(e,t){for(var n in this.fields){var r="-"===this.fields[n][0]?-1:1,i=VR(e[n],t[n]);if(0!==i)return r*i;}return 0;},e.prototype.indexOf=function(e){if(this._table.length>0){for(var t=0,n=this._table.length-1;t<=n;){var r=Math.floor((t+n)/2),i=this.diff(e,this._table[r].columnValues);if(i>0)t=r+1;else {if(!(i<0))return [r,!0];n=r-1;}}return [t,!1];}return [0,!1];},e.prototype.ensure=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o,a,u,c,l,d,h,f,p,v,_;return lw(this,function(y){switch(y.label){case 0:return [4,(e=hD.get(this.dbname)).find(this._store,this.indexerKey,JR.PERSISTENT)];case 1:return (t=y.sent())?[3,11]:(n=sD(this.dbname,this.collectionName),[4,this._store.getAllKeys()]);case 2:r=y.sent(),y.label=3;case 3:y.trys.push([3,8,9,10]),i=dw(r),s=i.next(),y.label=4;case 4:return s.done?[3,7]:(o=s.value).startsWith(n)?[4,e.find(this._store,o,JR.NO_CACHE)]:[3,6];case 5:if(a=y.sent(),u=pD.createFromCacheItem(a))try{for(v=void 0,c=dw(u.items),l=c.next();!l.done;l=c.next())d=l.value,this._addItem(d);}catch(e){v={error:e};}finally{try{l&&!l.done&&(_=c.return)&&_.call(c);}finally{if(v)throw v.error;}}y.label=6;case 6:return s=i.next(),[3,4];case 7:return [3,10];case 8:return h=y.sent(),f={error:h},[3,10];case 9:try{s&&!s.done&&(p=i.return)&&p.call(i);}finally{if(f)throw f.error;}return [7];case 10:return this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[3,12];case 11:this._origin=t.value,this._table=jR(this._origin),y.label=12;case 12:return _D[this.indexerKey]=this,[2];}});});},e.prototype.drop=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return hD.get(this.dbname).remove(this.indexerKey),[4,this._store.remove(this.indexerKey)];case 1:return e.sent(),delete _D[this.indexerKey],[2];}});});},e.prototype.addItem=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return this._addItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2];});});},e.prototype.removeItem=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return this._removeItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2];});});},e.prototype.clear=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){return this._table=[],this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2];});});},e.prototype.commit=function(){this._origin=this._table,this._table=jR(this._origin);},e.prototype.abort=function(){this._table=jR(this._origin);},e;}(),mD=function(){return "undefined"!=typeof document&&"undefined"!=typeof navigator&&"ReactNative"!==navigator.product;},gD=function(){var e=new Date().getTime();return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16);});};!function(e){e[e.PROCESSING=0]="PROCESSING",e[e.DONE=1]="DONE";}(uD||(uD={})),function(e){e.NEWNODE="newnode",e.REMOVENODE="removenode",e.CLAIM_HOST="claimhost",e.SYNC_HOST="synchost",e.REQUEST_LOCK="requestlock",e.ACQUIRE_LOCK="acquirelock",e.RELEASE_LOCK="releaselock";}(cD||(cD={}));var ED,bD={},wD=function(){function e(e,t){void 0===t&&(t={});var n=this;return this._state=uD.PROCESSING,this._queue=[],this._activationQueue=[],bD[e]&&!t.forceCreate||(this.nodeId=gD(),this.key=e,mD()&&(t.startAsInvisible?this.registerNode():"visible"===document.visibilityState?this.claimHost():this.registerNode(),document.addEventListener("visibilitychange",function(){"visible"===document.visibilityState&&n.claimHost();}),window.addEventListener("message",function(e){var t,r,i=e.data,s=i.nodeId,o=i.requestId,a=i.key,u=i.op,c=i.data;if(s!==n.nodeId&&a===n.key)switch(u){case cD.NEWNODE:n._sendSync();break;case cD.CLAIM_HOST:n._sendSync(),n._hostId=s;break;case cD.SYNC_HOST:if(!n.isInSync){n._activationTimeout&&clearTimeout(n._activationTimeout);var l=c,d=l.currentItemRequestId,h=l.queue,f=function(e){n._queue.findIndex(function(t){return t.requestId===e.requestId;})<0&&n._requestLock({nodeId:e.nodeId,requestId:e.requestId,key:n.key,op:cD.REQUEST_LOCK,ts:e.ts});};try{for(var p=dw(h),v=p.next();!v.done;v=p.next())f(v.value);}catch(e){t={error:e};}finally{try{v&&!v.done&&(r=p.return)&&r.call(p);}finally{if(t)throw t.error;}}n._currentItem=n._queue.find(function(e){return e.requestId===d;}),n._completeSync();}break;case cD.REMOVENODE:n._queue=n._queue.filter(function(e){return e.nodeId!==i.nodeId;}),n._currentItem&&n._currentItem.nodeId===i.nodeId&&(n._currentItem=void 0,n._acquire(n._queue[0]));break;case cD.REQUEST_LOCK:n._requestLock(i);break;case cD.ACQUIRE_LOCK:var _=n._queue.find(function(e){return e.requestId===o;});n._acquire(_);break;case cD.RELEASE_LOCK:n._release(o);}}),window.addEventListener("beforeunload",function(){n._send(cD.REMOVENODE);})),bD[e]=this),bD[e];}return Object.defineProperty(e.prototype,"locked",{get:function(){return !!this._currentItem;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHost",{get:function(){return this._hostId===this.nodeId;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInSync",{get:function(){return this._state==uD.DONE;},enumerable:!1,configurable:!0}),e.prototype._send=function(e,t){var n;void 0===t&&(t={});var r={nodeId:this.nodeId,requestId:null!==(n=null==t?void 0:t.requestId)&&void 0!==n?n:gD(),key:this.key,op:e,data:t.data,ts:Date.now()};return mD()&&window.postMessage(r,"*"),r;},e.prototype._acquire=function(e){e?(this._currentItem=e,this._currentItem.onAcquired&&this._currentItem.onAcquired(e.requestId)):this._currentItem=void 0;},e.prototype._release=function(e){if(this._currentItem&&this._currentItem.requestId===e){var t=this._currentItem;this._currentItem=void 0,t.nodeId===this.nodeId&&this._send(cD.RELEASE_LOCK,{requestId:t.requestId});var n=this._queue.findIndex(function(t){return t.requestId===e;});n>-1&&this._queue.splice(n,1),t.onReleased&&t.onReleased(e);}},e.prototype._requestLock=function(e){var t=this;return new Promise(function(n){var r={nodeId:e.nodeId,requestId:e.requestId,ts:e.ts,onAcquired:function(e){t.isHost&&t._send(cD.ACQUIRE_LOCK,{requestId:e}),n();},onReleased:function(){t._acquire(t._queue[0]);}},i=!1;for(var s in t._queue)if(t._queue[s].ts>r.ts){t._queue.splice(parseInt(s),0,r),i=!0;break;}i||t._queue.push(r),t._currentItem||t._acquire(t._queue[0]);});},e.prototype._sendSync=function(){var e;this.isHost&&this._send(cD.SYNC_HOST,{data:{currentItemRequestId:null===(e=this._currentItem)||void 0===e?void 0:e.requestId,queue:this._queue.map(function(e){return {nodeId:e.nodeId,requestId:e.requestId,ts:e.ts};})}});},e.prototype._waitUntilSyncCompleted=function(){return cw(this,void 0,void 0,function(){var e=this;return lw(this,function(t){return this.isHost&&!this.isInSync?[2,new Promise(function(t){e._activationQueue.push(t);})]:[2];});});},e.prototype._waitSync=function(){var e=this;this.isInSync||(this._activationTimeout=setTimeout(function(){e._completeSync();},8));},e.prototype._completeSync=function(){this.isInSync||(this._state=uD.DONE,this._activationQueue.forEach(function(e){return e();}),this._activationQueue=[]);},e.prototype.registerNode=function(){this._send(cD.NEWNODE),this._waitSync();},e.prototype.claimHost=function(){this._hostId=this.nodeId,this._send(cD.CLAIM_HOST),this._waitSync();},e.prototype.lock=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return [4,this._waitUntilSyncCompleted()];case 1:return t.sent(),e=this._send(cD.REQUEST_LOCK),[4,this._requestLock(e)];case 2:return t.sent(),[2];}});});},e.prototype.unlock=function(){var e;(null===(e=this._currentItem)||void 0===e?void 0:e.requestId)&&this._release(this._currentItem.requestId);},e;}(),ID=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,i=e.keyHash,s=e.indexes,o=e.store,a=this;this._state=FR.INIT,this._indexers=[],this.dbname=t,this.name=n,this.keyName=r,this.indexes=fw([[r]],hw(s.filter(function(e){return yD.createKey(e)!==a.keyName;})),!1),this._keyHash=i,this._store=o,this._mutex=new wD(function(e,t){return "".concat(rD(e,t),".lock");}(t,n)),this._blobContainer=new aD({dbname:t,collectionName:n,store:o}),this._transaction=new fD({dbname:t,collectionName:n,store:o});}return e.metadataOf=function(e,t,n){return cw(this,void 0,void 0,function(){var r;return lw(this,function(i){switch(i.label){case 0:return r=iD(e,t),[4,n.get(r)];case 1:return [2,i.sent()];}});});},Object.defineProperty(e.prototype,"state",{get:function(){return this._state;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return this._state===FR.READY;},enumerable:!1,configurable:!0}),e.prototype.init=function(){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c,l,d,h,f,p,v=this;return lw(this,function(_){switch(_.label){case 0:return [4,this._mutex.lock()];case 1:_.sent(),_.label=2;case 2:return _.trys.push([2,9,,10]),t=PR.get(this.dbname),[4,e.metadataOf(this.dbname,this.name,this._store)];case 3:return n=_.sent(),this._metadata=n||{keyName:this.keyName,blockLevel:1,blockHashBase:t.blockHashBase,blockHashMultiplier:t.blockHashMultiplier,blockHashConstant:t.blockHashConstant,indexes:this.indexes},[4,this._transaction.init()];case 4:_.sent(),this._blockManager=new vD({dbname:this.dbname,collectionName:this.name,hashFunction:this._keyHash,metadata:this._metadata,transaction:this._transaction,store:this._store}),r=fw([],hw(this.indexes),!1),i=[],s=r.map(function(e){return yD.createKey(e);}),o=n?n.indexes.map(function(e){return yD.createKey(e);}):[];try{for(a=dw(o),u=a.next();!u.done;u=a.next())c=u.value,s.includes(c)||i.push(yD.parseKey(c));}catch(e){f={error:e};}finally{try{u&&!u.done&&(p=a.return)&&p.call(a);}finally{if(f)throw f.error;}}return (l=[]).push.apply(l,fw([],hw(r.map(function(e){var t=new yD({dbname:v.dbname,collectionName:v.name,keyName:v.keyName,fields:e,transaction:v._transaction,store:v._store});return v._indexers.push(t),t.ensure();})),!1)),l.push.apply(l,fw([],hw(i.map(function(e){return new yD({dbname:v.dbname,collectionName:v.name,keyName:v.keyName,fields:e,transaction:v._transaction,store:v._store}).drop();})),!1)),[4,Promise.all(l)];case 5:return _.sent(),[4,this._transaction.commit()];case 6:return _.sent(),s.sort().join(",")===o.sort().join(",")?[3,8]:(d=iD(this.dbname,this.name),this._metadata.indexes=r,[4,this._store.set({key:d,value:this._metadata})]);case 7:_.sent(),_.label=8;case 8:return this._state=FR.READY,this._mutex.unlock(),[3,10];case 9:throw h=_.sent(),this._mutex.unlock(),h;case 10:return [2];}});});},e.prototype.close=function(){this._state=FR.CLOSED;},e.prototype._hasPropertyOfKeyName=function(e){var t=e[this.keyName];return "string"==typeof t&&!!t;},e.prototype._getIndexerBy=function(e){var t,n;void 0===e&&(e=null),e||(e=[this.keyName]);var r=yD.createKey(e);try{for(var i=dw(this._indexers),s=i.next();!s.done;s=i.next()){var o=s.value;if(r===yD.createKey(o.fields))return o;}}catch(e){t={error:e};}finally{try{s&&!s.done&&(n=i.return)&&n.call(i);}finally{if(t)throw t.error;}}throw qR.indexTableIsRequired;},e.prototype._upgradeBlockLevel=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return e=iD(this.dbname,this.name),this._metadata.blockLevel++,[4,this._store.set({key:e,value:this._metadata})];case 1:return t.sent(),[2];}});});},e.prototype._requestInsert=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return a.sent()?[3,13]:[4,this._blockManager.putToBlock(t,e)];case 2:return a.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return a.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:a.sent(),a.label=5;case 5:a.trys.push([5,10,11,12]),n=dw(this._indexers),r=n.next(),a.label=6;case 6:return r.done?[3,9]:[4,r.value.addItem(e)];case 7:a.sent(),a.label=8;case 8:return r=n.next(),[3,6];case 9:return [3,12];case 10:return i=a.sent(),s={error:i},[3,12];case 11:try{r&&!r.done&&(o=n.return)&&o.call(n);}finally{if(s)throw s.error;}return [7];case 12:return [3,14];case 13:throw qR.collectionInsertDuplicate;case 14:return [2];}});});},e.prototype._requestUpsert=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c,l,d,h,f;return lw(this,function(p){switch(p.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return (n=p.sent())?[3,13]:[4,this._blockManager.putToBlock(t,e)];case 2:return p.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return p.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:p.sent(),p.label=5;case 5:p.trys.push([5,10,11,12]),r=dw(this._indexers),i=r.next(),p.label=6;case 6:return i.done?[3,9]:[4,(u=i.value).addItem(e)];case 7:p.sent(),p.label=8;case 8:return i=r.next(),[3,6];case 9:return [3,12];case 10:return s=p.sent(),l={error:s},[3,12];case 11:try{i&&!i.done&&(d=r.return)&&d.call(r);}finally{if(l)throw l.error;}return [7];case 12:return [3,23];case 13:return [4,this._blockManager.putToBlock(t,e)];case 14:p.sent(),p.label=15;case 15:p.trys.push([15,21,22,23]),o=dw(this._indexers),a=o.next(),p.label=16;case 16:return a.done?[3,20]:0===(u=a.value).diff(u.getColumnValues(n),u.getColumnValues(e))?[3,19]:[4,u.removeItem(n)];case 17:return p.sent(),[4,u.addItem(e)];case 18:p.sent(),p.label=19;case 19:return a=o.next(),[3,16];case 20:return [3,23];case 21:return c=p.sent(),h={error:c},[3,23];case 22:try{a&&!a.done&&(f=o.return)&&f.call(o);}finally{if(h)throw h.error;}return [7];case 23:return [2];}});});},e.prototype._requestUpdate=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u;return lw(this,function(c){switch(c.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return (n=c.sent())?[4,this._blockManager.putToBlock(t,e)]:[3,11];case 2:c.sent(),c.label=3;case 3:c.trys.push([3,9,10,11]),r=dw(this._indexers),i=r.next(),c.label=4;case 4:return i.done?[3,8]:0===(s=i.value).diff(s.getColumnValues(n),s.getColumnValues(e))?[3,7]:[4,s.removeItem(n)];case 5:return c.sent(),[4,s.addItem(e)];case 6:c.sent(),c.label=7;case 7:return i=r.next(),[3,4];case 8:return [3,11];case 9:return o=c.sent(),a={error:o},[3,11];case 10:try{i&&!i.done&&(u=r.return)&&u.call(r);}finally{if(a)throw a.error;}return [7];case 11:return [2];}});});},e.prototype._requestRemove=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return [4,this._blockManager.getFromBlock(e)];case 1:return (t=a.sent())?[4,this._blockManager.removeFromBlock(e)]:[3,10];case 2:a.sent(),a.label=3;case 3:a.trys.push([3,8,9,10]),n=dw(this._indexers),r=n.next(),a.label=4;case 4:return r.done?[3,7]:[4,r.value.removeItem(t)];case 5:a.sent(),a.label=6;case 6:return r=n.next(),[3,4];case 7:return [3,10];case 8:return i=a.sent(),s={error:i},[3,10];case 9:try{r&&!r.done&&(o=n.return)&&o.call(n);}finally{if(s)throw s.error;}return [7];case 10:return [2];}});});},e.prototype._requestClear=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return [4,this._blockManager.clearAllBlocks()];case 1:s.sent(),s.label=2;case 2:s.trys.push([2,7,8,9]),e=dw(this._indexers),t=e.next(),s.label=3;case 3:return t.done?[3,6]:[4,t.value.clear()];case 4:s.sent(),s.label=5;case 5:return t=e.next(),[3,3];case 6:return [3,9];case 7:return n=s.sent(),r={error:n},[3,9];case 8:try{t&&!t.done&&(i=e.return)&&i.call(e);}finally{if(r)throw r.error;}return [7];case 9:return [2];}});});},e.prototype.getByKey=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,6];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this._blockManager.getFromBlock(e)];case 3:return t=r.sent(),this._mutex.unlock(),[2,jR(t)];case 4:throw n=r.sent(),this._mutex.unlock(),n;case 5:return [3,7];case 6:throw qR.collectionNotReady;case 7:return [2];}});});},e.prototype.query=function(e){if(void 0===e&&(e={}),this.isReady)return new tD({condition:e.where,mutex:this._mutex,blockManager:this._blockManager,indexer:this._getIndexerBy(e.index),backward:!!e.backward});throw qR.collectionNotReady;},e.prototype.insertOne=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw qR.collectionKeyNotGiven;return [4,this._requestInsert(jR(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return [3,9];case 8:throw qR.collectionNotReady;case 9:return [2];}});});},e.prototype.insertMany=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u=this;return lw(this,function(c){switch(c.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:c.sent(),c.label=2;case 2:if(c.trys.push([2,12,,14]),e.some(function(e){return !u._hasPropertyOfKeyName(e);}))throw qR.collectionKeyNotGiven;c.label=3;case 3:c.trys.push([3,8,9,10]),t=dw(e),n=t.next(),c.label=4;case 4:return n.done?[3,7]:(r=n.value,[4,this._requestInsert(jR(r))]);case 5:c.sent(),c.label=6;case 6:return n=t.next(),[3,4];case 7:return [3,10];case 8:return i=c.sent(),o={error:i},[3,10];case 9:try{n&&!n.done&&(a=t.return)&&a.call(t);}finally{if(o)throw o.error;}return [7];case 10:return [4,this._transaction.commit()];case 11:return c.sent(),this._mutex.unlock(),[2,e];case 12:return s=c.sent(),[4,this._transaction.clear()];case 13:throw c.sent(),this._mutex.unlock(),s;case 14:return [3,16];case 15:throw qR.collectionNotReady;case 16:return [2];}});});},e.prototype.upsertOne=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw qR.collectionKeyNotGiven;return [4,this._requestUpsert(jR(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return [3,9];case 8:throw qR.collectionNotReady;case 9:return [2];}});});},e.prototype.upsertMany=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u=this;return lw(this,function(c){switch(c.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:c.sent(),c.label=2;case 2:if(c.trys.push([2,12,,14]),e.some(function(e){return !u._hasPropertyOfKeyName(e);}))throw qR.collectionKeyNotGiven;c.label=3;case 3:c.trys.push([3,8,9,10]),t=dw(e),n=t.next(),c.label=4;case 4:return n.done?[3,7]:(r=n.value,[4,this._requestUpsert(jR(r))]);case 5:c.sent(),c.label=6;case 6:return n=t.next(),[3,4];case 7:return [3,10];case 8:return i=c.sent(),o={error:i},[3,10];case 9:try{n&&!n.done&&(a=t.return)&&a.call(t);}finally{if(o)throw o.error;}return [7];case 10:return [4,this._transaction.commit()];case 11:return c.sent(),this._mutex.unlock(),[2,e];case 12:return s=c.sent(),[4,this._transaction.clear()];case 13:throw c.sent(),this._mutex.unlock(),s;case 14:return [3,16];case 15:throw qR.collectionNotReady;case 16:return [2];}});});},e.prototype.update=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw qR.collectionKeyNotGiven;return [4,this._requestUpdate(jR(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return [3,9];case 8:throw qR.collectionNotReady;case 9:return [2];}});});},e.prototype.updateIf=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i,s,o,a,u,c,l,d,h,f,p,v,_=this;return lw(this,function(y){switch(y.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,16];case 1:y.sent(),y.label=2;case 2:return y.trys.push([2,13,,15]),n=e.where,r=void 0===n?{}:n,i=e.index,s=void 0===i?null:i,o=e.backward,a=void 0!==o&&o,u=[],[4,new eD({condition:r,blockManager:this._blockManager,backward:a,indexer:this._getIndexerBy(s)}).each(function(e){return cw(_,void 0,void 0,function(){var n,i;return lw(this,function(s){if(e.error)throw e.stop(),e.error;if(e.hasNext){if(n=e.nextValue,BR(r,n)&&t.set){if("function"!=typeof t.set)for(i in t.set)n[i]=t.set[i];else t.set(n);u.push(n);}e.next();}else e.stop();return [2];});});})];case 3:y.sent(),y.label=4;case 4:y.trys.push([4,9,10,11]),c=dw(u),l=c.next(),y.label=5;case 5:return l.done?[3,8]:(d=l.value,[4,this._requestUpdate(jR(d))]);case 6:y.sent(),y.label=7;case 7:return l=c.next(),[3,5];case 8:return [3,11];case 9:return h=y.sent(),p={error:h},[3,11];case 10:try{l&&!l.done&&(v=c.return)&&v.call(c);}finally{if(p)throw p.error;}return [7];case 11:return [4,this._transaction.commit()];case 12:return y.sent(),this._mutex.unlock(),[2,u];case 13:return f=y.sent(),[4,this._transaction.clear()];case 14:throw y.sent(),this._mutex.unlock(),f;case 15:return [3,17];case 16:throw this._transaction.clear(),qR.collectionNotReady;case 17:return [2];}});});},e.prototype.remove=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,5,,7]),[4,this._requestRemove(e)];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[3,7];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return [3,9];case 8:throw qR.collectionNotReady;case 9:return [2];}});});},e.prototype.removeIf=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c,l,d,h,f,p,v=this;return lw(this,function(_){switch(_.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:_.sent(),_.label=2;case 2:return _.trys.push([2,13,,14]),t=e.where,n=void 0===t?{}:t,r=e.index,i=void 0===r?null:r,s=e.backward,o=void 0!==s&&s,a=[],[4,new eD({condition:n,blockManager:this._blockManager,backward:o,indexer:this._getIndexerBy(i)}).each(function(e){return cw(v,void 0,void 0,function(){var t,r;return lw(this,function(i){if(e.error)throw e.stop(),e.error;return e.hasNext?(t=e.nextValue,BR(n,t)&&(r=t[this.keyName],a.push(r)),e.next()):e.stop(),[2];});});})];case 3:_.sent(),_.label=4;case 4:_.trys.push([4,9,10,11]),u=dw(a),c=u.next(),_.label=5;case 5:return c.done?[3,8]:(l=c.value,[4,this._requestRemove(l)]);case 6:_.sent(),_.label=7;case 7:return c=u.next(),[3,5];case 8:return [3,11];case 9:return d=_.sent(),f={error:d},[3,11];case 10:try{c&&!c.done&&(p=u.return)&&p.call(u);}finally{if(f)throw f.error;}return [7];case 11:return [4,this._transaction.commit()];case 12:return _.sent(),this._mutex.unlock(),[2,a];case 13:throw h=_.sent(),this._mutex.unlock(),h;case 14:return [3,16];case 15:throw this._transaction.clear(),qR.collectionNotReady;case 16:return [2];}});});},e.prototype.clear=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,5,,7]),[4,this._requestClear()];case 3:return t.sent(),[4,this._transaction.commit()];case 4:return t.sent(),this._mutex.unlock(),[3,7];case 5:return e=t.sent(),[4,this._transaction.clear()];case 6:throw t.sent(),this._mutex.unlock(),e;case 7:return [3,9];case 8:throw qR.collectionNotReady;case 9:return [2];}});});},e.prototype.getBlob=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,this._blobContainer.get(e)];case 1:return [2,t.sent()];}});});},e.prototype.saveBlob=function(e,t){return cw(this,void 0,void 0,function(){return lw(this,function(n){switch(n.label){case 0:return [4,this._blobContainer.save(e,t)];case 1:return [2,n.sent()];}});});},e.prototype.removeBlob=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,this._blobContainer.remove(e)];case 1:return t.sent(),[2];}});});},e.prototype.removeAllBlobs=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._blobContainer.clear()];case 1:return e.sent(),[2];}});});},e;}(),TD="[NESTDB]",SD=!0,CD=function(){function e(){}return e.off=function(){SD=!1;},e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];SD&&console.log.apply(console,fw(["".concat(TD,"[LOG]")],hw(e),!1));},e.warning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];SD&&console.warn.apply(console,fw(["".concat(TD,"[WARNING]")],hw(e),!1));},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];SD&&console.error.apply(console,fw(["".concat(TD,"[ERROR]")],hw(e),!1));},e;}(),kD=[{},{a:700400,n:"error"}],AD=function(){function e(e){var t,n,r;this.encryption=null!==(t=e.encryption)&&void 0!==t?t:Lw,this.itemSizeLimit=null!==(n=e.itemSizeLimit)&&void 0!==n?n:4194304,this.metadataBuffer=null!==(r=e.metadataBuffer)&&void 0!==r?r:256;}return Object.defineProperty(e.prototype,"_encryptionCheckKey",{get:function(){return "".concat(this.dbname,".encrypt");},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_reservedKeys",{get:function(){return [this._encryptionCheckKey];},enumerable:!1,configurable:!0}),e.prototype._getRawKey=function(e,t){return void 0===t&&(t=""),"".concat(e).concat(t);},e.prototype._generateShardPostfixArray=function(e){return void 0===e&&(e=1),fw([],hw(Array(e).keys()),!1);},e.prototype._shardify=function(e){var t=this,n=e.key,r=e.value,i=JSON.stringify(this.encryption.encrypt(r)),s=Math.ceil(i.length/this.adjustedItemSizeLimit);return this._generateShardPostfixArray(s).map(function(e){var r={key:t._getRawKey(n,".".concat(e)),data:i.substring(e*t.adjustedItemSizeLimit,(e+1)*t.adjustedItemSizeLimit)};return 0===e&&(r.metadata={shards:s}),r;});},e.prototype._resetIfEncryptionChanged=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o,a,u,c=this;return lw(this,function(l){switch(l.label){case 0:return [4,this.get(this._encryptionCheckKey)];case 1:if(e=l.sent(),t={encrypted:kD.map(function(e){var t;return null===(t=c.encryption)||void 0===t?void 0:t.encrypt(e);})},!(e&&e.encrypted&&Array.isArray(e.encrypted)))return [3,5];for(i in n=e.encrypted,r=[],n)r.push(i);s=0,l.label=2;case 2:return s<r.length?(i=r[s])in n?(o=i,a=JSON.stringify(e.encrypted[o]),u=JSON.stringify(t.encrypted[o]),a===u?[3,4]:(CD.warning("Encryption algorithm has changed. Stored data would be cleared."),[4,this.clear()])):[3,4]:[3,5];case 3:return l.sent(),[3,5];case 4:return s++,[3,2];case 5:return [4,this.set({key:this._encryptionCheckKey,value:t})];case 6:return l.sent(),[2];}});});},Object.defineProperty(e.prototype,"adjustedItemSizeLimit",{get:function(){return Math.max(this.itemSizeLimit-this.metadataBuffer,4);},enumerable:!1,configurable:!0}),e.prototype.usage=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o,a,u;return lw(this,function(c){switch(c.label){case 0:return e=0,[4,this._getAllRawKeys()];case 1:t=c.sent(),c.label=2;case 2:c.trys.push([2,7,8,9]),n=dw(t),r=n.next(),c.label=3;case 3:return r.done?[3,6]:(i=r.value,[4,this._getRaw(i)]);case 4:(s=c.sent())&&(e+=JSON.stringify(s).length),c.label=5;case 5:return r=n.next(),[3,3];case 6:return [3,9];case 7:return o=c.sent(),a={error:o},[3,9];case 8:try{r&&!r.done&&(u=n.return)&&u.call(n);}finally{if(a)throw a.error;}return [7];case 9:return [2,e];}});});},e.prototype.getAllKeys=function(){return cw(this,void 0,void 0,function(){var e=this;return lw(this,function(t){switch(t.label){case 0:return [4,this._getAllRawKeys()];case 1:return [2,t.sent().filter(function(e){return e.endsWith(".0");}).map(function(e){return e.replace(/\.0$/,"");}).filter(function(t){return !e._reservedKeys.includes(t);})];}});});},e.prototype.get=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a=this;return lw(this,function(u){switch(u.label){case 0:return t=this._getRawKey(e,".0"),[4,this._getRaw(t)];case 1:if(!(n=u.sent()))return [3,7];u.label=2;case 2:return u.trys.push([2,6,,7]),r=n.data,(null==(i=n.metadata)?void 0:i.shards)&&i.shards>1?[4,Promise.all(this._generateShardPostfixArray(null==i?void 0:i.shards).map(function(t){return cw(a,void 0,void 0,function(){var n,i;return lw(this,function(s){switch(s.label){case 0:return t>0?(n=this._getRawKey(e,".".concat(t)),[4,this._getRaw(n)]):[3,2];case 1:if(!(i=s.sent()))throw qR.storeBrokenIntegrity;return [2,i.data];case 2:return [2,r];}});});}))]:[3,4];case 3:return o=u.sent(),[3,5];case 4:o=[r],u.label=5;case 5:return s=o,[2,this.encryption.decrypt(JSON.parse(s.join("")))];case 6:return u.sent(),[2,null];case 7:return [2,null];}});});},e.prototype.set=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=this._shardify(e),[4,this._setRaw(t)];case 1:return n.sent(),[2,uw({},e.value)];}});});},e.prototype.setMany=function(e){return cw(this,void 0,void 0,function(){var t,n=this;return lw(this,function(r){switch(r.label){case 0:return t=[],[4,this._setRaw(t.concat.apply(t,fw([],hw(e.map(function(e){return n._shardify(e);})),!1)))];case 1:return r.sent(),[2,e.map(function(e){return e.value;})];}});});},e.prototype.remove=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i=this;return lw(this,function(s){switch(s.label){case 0:return t=this._getRawKey(e,".0"),[4,this._getRaw(t)];case 1:return (n=s.sent())?(r=n.metadata,[4,this._removeRaw(this._generateShardPostfixArray(null==r?void 0:r.shards).map(function(t){return i._getRawKey(e,".".concat(t));}))]):[3,3];case 2:return s.sent(),[2,!0];case 3:return [2,!1];}});});},e.prototype.removeMany=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c,l=this;return lw(this,function(d){switch(d.label){case 0:t=[],n=function(e){var n,i,s;return lw(this,function(o){switch(o.label){case 0:return n=r._getRawKey(e,".0"),[4,r._getRaw(n)];case 1:return (i=o.sent())&&(s=i.metadata,t.push.apply(t,fw([],hw(r._generateShardPostfixArray(null==s?void 0:s.shards).map(function(t){return l._getRawKey(e,".".concat(t));})),!1))),[2];}});},r=this,d.label=1;case 1:d.trys.push([1,6,7,8]),i=dw(e),s=i.next(),d.label=2;case 2:return s.done?[3,5]:(o=s.value,[5,n(o)]);case 3:d.sent(),d.label=4;case 4:return s=i.next(),[3,2];case 5:return [3,8];case 6:return a=d.sent(),u={error:a},[3,8];case 7:try{s&&!s.done&&(c=i.return)&&c.call(i);}finally{if(u)throw u.error;}return [7];case 8:return t.length>0?[4,this._removeRaw(t)]:[3,10];case 9:d.sent(),d.label=10;case 10:return [2,e];}});});},e;}(),ND={},OD=function(e){function t(t){void 0===t&&(t={});var n,r=this;r=e.call(this,uw(uw({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:4194304}))||this;var i=t.delay,s=void 0===i?1:i;return r.delay=s,r.observer={},r;}return aw(t,e),Object.defineProperty(t.prototype,"rawData",{get:function(){return ND[this.dbname];},set:function(e){ND[this.dbname]=e;},enumerable:!1,configurable:!0}),t.prototype._getAllRawKeys=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){if(ND[this.dbname])return [2,Object.keys(ND[this.dbname])];throw qR.storeNotAvailable;});});},t.prototype._getRaw=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return ND[this.dbname]?[4,zR(this.delay)]:[3,2];case 1:return t.sent(),[2,ND[this.dbname][e]?uw({key:e},ND[this.dbname][e]):null];case 2:throw qR.storeNotAvailable;}});});},t.prototype._setRaw=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u;return lw(this,function(c){switch(c.label){case 0:return ND[this.dbname]?[4,zR(this.delay)]:[3,2];case 1:c.sent();try{for(t=dw(e),n=t.next();!n.done;n=t.next())r=n.value,i=r.key,s=r.data,o=r.metadata,ND[this.dbname][i]=Object.freeze({data:s,metadata:o});}catch(e){a={error:e};}finally{try{n&&!n.done&&(u=t.return)&&u.call(t);}finally{if(a)throw a.error;}}return [3,3];case 2:throw qR.storeNotAvailable;case 3:return [2];}});});},t.prototype._removeRaw=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return ND[this.dbname]?[4,zR(this.delay)]:[3,2];case 1:o.sent();try{for(t=dw(e),n=t.next();!n.done;n=t.next())r=n.value,ND[this.dbname][r]&&delete ND[this.dbname][r];}catch(e){i={error:e};}finally{try{n&&!n.done&&(s=t.return)&&s.call(t);}finally{if(i)throw i.error;}}return [3,3];case 2:throw qR.storeNotAvailable;case 3:return [2];}});});},t.prototype.observe=function(e,t,n){var r=this;this.observer[e]||(this.observer[e]={}),t.forEach(function(t){return r.observer[e][t]=n;});},t.prototype.checkAvailability=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){return [2];});});},t.prototype.init=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return this.dbname=e,ND[this.dbname]||(ND[this.dbname]={}),[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2];}});});},t.prototype.set=function(t){return cw(this,void 0,void 0,function(){var n,r;return lw(this,function(i){if((n=this.observer[t.key])&&"function"==typeof n.set&&(r=n.set()))throw r;return [2,e.prototype.set.call(this,t)];});});},t.prototype.setMany=function(t){return cw(this,void 0,void 0,function(){var n,r,i,s,o,a,u;return lw(this,function(c){try{for(n=dw(t),r=n.next();!r.done;r=n.next())if(i=r.value,(s=this.observer[i.key])&&"function"==typeof s.set&&(o=s.set()))throw o;}catch(e){a={error:e};}finally{try{r&&!r.done&&(u=n.return)&&u.call(n);}finally{if(a)throw a.error;}}return [2,e.prototype.setMany.call(this,t)];});});},t.prototype.clear=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,zR(this.delay)];case 1:return e.sent(),ND[this.dbname]={},[2];}});});},t;}(AD),RD="NestDBStore";!function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.OPENING=1]="OPENING",e[e.OPEN=2]="OPEN",e[e.CLOSED=3]="CLOSED";}(ED||(ED={}));var DD,xD=function(e){function t(t){void 0===t&&(t={});var n,r=this;return (r=e.call(this,uw(uw({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:104857600}))||this)._storeName=RD,r._state=ED.UNINITIALIZED,r._openJobQueue=[],r._window="undefined"!=typeof window?window:void 0,r._indexedDb=r._window?r._window.indexedDB||r._window.mozIndexedDB||r._window.webkitIndexedDB||r._window.msIndexedDB:void 0,r;}return aw(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state;},enumerable:!1,configurable:!0}),t.prototype._openDatabase=function(e){var t=this;return new Promise(function(n,r){if(t._indexedDb){t._state=ED.OPENING;var i=t._indexedDb.open(e);i.addEventListener("upgradeneeded",function(e){e.target.result.createObjectStore(RD,{keyPath:"key"});}),i.addEventListener("success",function(r){t._state=ED.OPEN,t._database=r.target.result,t._openJobQueue.forEach(function(e){return e();}),t._openJobQueue=[],t._database.onclose=function(){t._database=void 0,t._state=ED.OPENING,setTimeout(function(){t._openDatabase(e);},5);},n(t._database);}),i.addEventListener("error",function(e){t._state=ED.UNINITIALIZED,r(e.target.error);});}else r(qR.storeNotAvailable);});},t.prototype._getObjectStore=function(e){return cw(this,void 0,void 0,function(){var t=this;return lw(this,function(n){switch(n.label){case 0:return this._database?[2,this._database.transaction(this._storeName,e).objectStore(this._storeName)]:[3,1];case 1:switch(this._state){case ED.UNINITIALIZED:case ED.OPEN:return [3,2];case ED.OPENING:case ED.CLOSED:return [3,3];}return [3,4];case 2:throw qR.storeNotInitialized;case 3:return [2,new Promise(function(n){t._openJobQueue.push(function(){return n(t._getObjectStore(e));});})];case 4:return [4,this._getObjectStore(e)];case 5:return [2,n.sent()];}});});},t.prototype._getAllRawKeys=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return [4,this._getObjectStore("readonly")];case 1:return e=t.sent(),[4,new Promise(function(t,n){var r=e.getAllKeys();r.addEventListener("success",function(e){t(e.target.result);}),r.addEventListener("error",function(e){return n(e.target.error);});})];case 2:return [2,t.sent()];}});});},t.prototype._getRaw=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return [4,this._getObjectStore("readonly")];case 1:return t=n.sent(),[4,new Promise(function(n,r){var i=t.get(e);i.addEventListener("success",function(e){var t;n(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.result);}),i.addEventListener("error",function(e){return r(e.target.error);});})];case 2:return [2,n.sent()];}});});},t.prototype._setRaw=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return [4,this._getObjectStore("readwrite")];case 1:return t=n.sent(),[4,Promise.all(e.map(function(e){return new Promise(function(n,r){var i=t.put(e);i.addEventListener("success",function(e){n(e.target.result);}),i.addEventListener("error",function(){r("Failed to write.");});});}))];case 2:return n.sent(),[2];}});});},t.prototype._removeRaw=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return [4,this._getObjectStore("readwrite")];case 1:return t=n.sent(),[4,Promise.all(e.map(function(e){return new Promise(function(n,r){var i=t.delete(e);i.addEventListener("success",function(){return n(e);}),i.addEventListener("error",function(e){return r(e.target.error);});});}))];case 2:return n.sent(),[2];}});});},t.prototype._triggerDatabaseClose=function(){this._database&&this._database.onclose&&this._database.onclose(new Event("dummy"));},t.prototype.checkAvailability=function(){return cw(this,void 0,void 0,function(){var e,t=this;return lw(this,function(n){switch(n.label){case 0:if(!((null==(e="undefined"!=typeof window?window:null)?void 0:e.indexedDB)||(null==e?void 0:e.mozIndexedDB)||(null==e?void 0:e.webkitIndexedDB)||(null==e?void 0:e.msIndexedDB)))return [3,6];if(this._indexedDb=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,!this._window||!mD())return [3,4];if(!(mD()&&navigator.userAgent&&navigator.userAgent.includes("Edge/")))return [3,1];if(!this._window.indexedDB&&(e.PointerEvent||e.MSPointerEvent))throw qR.storeNotAvailableInPrivateBrowsing;return [3,3];case 1:return [4,new Promise(function(e,n){if(t._indexedDb)try{var r=t._indexedDb.open("_testMozilla");r.onerror=function(){return n(qR.storeNotAvailableInPrivateBrowsing);},r.onsuccess=function(){return e();};}catch(e){n(qR.storeNotAvailableInPrivateBrowsing);}else n(qR.storeNotAvailable);})];case 2:n.sent(),n.label=3;case 3:return [3,5];case 4:throw qR.storeNotAvailable;case 5:return [3,7];case 6:throw qR.storeNotAvailable;case 7:return [2];}});});},t.prototype.init=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return this.dbname=e,[4,this.checkAvailability()];case 1:return t.sent(),[4,this._openDatabase(e)];case 2:return t.sent(),[4,this._resetIfEncryptionChanged()];case 3:return t.sent(),[2];}});});},t.prototype.clear=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return [4,this._getObjectStore("readwrite")];case 1:return e=t.sent(),[4,new Promise(function(t,n){var r=e.clear();r.addEventListener("success",function(){return t();}),r.addEventListener("error",function(e){return n(e.target.error);});})];case 2:return [2,t.sent()];}});});},t;}(AD),LD=function(e){function t(t){var n=this,r=t.AsyncStorage,i=t.itemSizeLimit,s=void 0===i?6291456:i,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);}return n;}(t,["AsyncStorage","itemSizeLimit"]);return (n=e.call(this,uw(uw({},o),{itemSizeLimit:s}))||this)._asyncStorage=r,n;}return aw(t,e),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"));},t.prototype._getActualKey=function(e){return "".concat(this.dbname,"/").concat(e);},t.prototype._getAllRawKeys=function(){return cw(this,void 0,void 0,function(){var e=this;return lw(this,function(t){switch(t.label){case 0:return [4,this._asyncStorage.getAllKeys()];case 1:return [2,t.sent().filter(function(t){return e._isBelonging(t);}).map(function(t){return t.substring("".concat(e.dbname,"/").length);})];}});});},t.prototype._getRaw=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return [4,this._asyncStorage.getItem(this._getActualKey(e))];case 1:return [2,(t=n.sent())?JSON.parse(t):null];}});});},t.prototype._setRaw=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a;return lw(this,function(u){switch(u.label){case 0:t=[];try{for(n=dw(e),r=n.next();!r.done;r=n.next())i=r.value,s=i.key,i.data.length<=this.adjustedItemSizeLimit&&t.push([this._getActualKey(s),JSON.stringify(i)]);}catch(e){o={error:e};}finally{try{r&&!r.done&&(a=n.return)&&a.call(n);}finally{if(o)throw o.error;}}return [4,this._asyncStorage.multiSet(t)];case 1:return u.sent(),[2];}});});},t.prototype._removeRaw=function(e){return cw(this,void 0,void 0,function(){var t=this;return lw(this,function(n){switch(n.label){case 0:return [4,this._asyncStorage.multiRemove(e.map(function(e){return t._getActualKey(e);}))];case 1:return n.sent(),[2];}});});},t.prototype.checkAvailability=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){if(!this._asyncStorage)throw qR.storeNotAvailable;return [2];});});},t.prototype.init=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2];}});});},t.prototype.clear=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return [4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[2];}});});},t;}(AD);!function(e){function t(t){var n,r=this;return (r=e.call(this,uw(uw({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:6291456}))||this)._mmkv=t.MMKV,r;}aw(t,e),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"));},t.prototype._getActualKey=function(e){return "".concat(this.dbname,"/").concat(e);},t.prototype._getAllRawKeys=function(){return cw(this,void 0,void 0,function(){var e=this;return lw(this,function(t){switch(t.label){case 0:return [4,this._mmkv.getAllKeys()];case 1:return [2,t.sent().filter(function(t){return e._isBelonging(t);}).map(function(t){return t.substring("".concat(e.dbname,"/").length);})];}});});},t.prototype._getRaw=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return [4,this._mmkv.getString(this._getActualKey(e))];case 1:return [2,(t=n.sent())?JSON.parse(t):null];}});});},t.prototype._setRaw=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o;return lw(this,function(a){try{for(t=dw(e),n=t.next();!n.done;n=t.next())r=n.value,i=r.key,r.data.length<=this.adjustedItemSizeLimit&&this._mmkv.set(this._getActualKey(i),JSON.stringify(r));}catch(e){s={error:e};}finally{try{n&&!n.done&&(o=t.return)&&o.call(t);}finally{if(s)throw s.error;}}return [2];});});},t.prototype._removeRaw=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s;return lw(this,function(o){try{for(t=dw(e),n=t.next();!n.done;n=t.next())r=n.value,this._mmkv.delete(this._getActualKey(r));}catch(e){i={error:e};}finally{try{n&&!n.done&&(s=t.return)&&s.call(t);}finally{if(i)throw i.error;}}return [2];});});},t.prototype.checkAvailability=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){if(!this._mmkv)throw qR.storeNotAvailable;return [2];});});},t.prototype.init=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2];}});});},t.prototype.clear=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return [4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[2];}});});};}(AD),function(e){e.INIT="INIT",e.OPENING="OPENING",e.OPENED="OPENED",e.CLOSED="CLOSED";}(DD||(DD={}));var MD,UD=function(){function e(e){var t=e.name,n=e.version,r=e.store,i=e.config;this.name=t,this._version=n,this._state=DD.INIT,this._config=i||new PR({dbname:t}),this._store=r,this._event={success:KR,error:KR,storeReplaced:KR,upgrade:YR},this._collections=new Map(),this._globalMutex=new wD("".concat(this.name,".lock")),this._config.disableLogger&&CD.off(),new hD({dbname:t,limit:this._config.cacheLimit});}return Object.defineProperty(e.prototype,"version",{get:function(){return this._version;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"store",{get:function(){return this._store;},enumerable:!1,configurable:!0}),e.prototype.estimateUsage=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,(t=this._store,cw(void 0,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,t.usage()];case 1:return [2,e.sent()];}});}))];case 1:return [2,e.sent()];}var t;});});},e.prototype.commitSchema=function(e){return cw(this,void 0,void 0,function(){var t=this;return lw(this,function(n){switch(n.label){case 0:return this._state!==DD.OPENING?[3,2]:[4,Promise.all(e.map(function(e){return cw(t,void 0,void 0,function(){var t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return t=e.collectionName,n=e.keyName,r=e.index,i=void 0===r?[]:r,this._collections.has(t)||this._collections.set(t,new ID({dbname:this.name,collectionName:t,keyName:n,indexes:i,store:this._store})),(s=this._collections.get(t))?[4,s.init()]:[3,2];case 1:o.sent(),o.label=2;case 2:return [2];}});});}))];case 1:return n.sent(),[3,3];case 2:throw qR.databaseSchemaNotOnUpgrade;case 3:return [2];}});});},e.prototype.open=function(){var e;return cw(this,void 0,void 0,function(){var t,n,r,i,s=this;return lw(this,function(o){switch(o.label){case 0:return [4,this._globalMutex.lock()];case 1:if(o.sent(),this._state===DD.OPENED)return [3,12];this._state=DD.OPENING,o.label=2;case 2:return o.trys.push([2,5,,12]),[4,this._store.init(this.name)];case 3:return o.sent(),a=this.name,t="".concat(nD(a),".metadata"),n={version:0,collectionNames:[]},[4,this._store.get(t)];case 4:return r=null!==(e=o.sent())&&void 0!==e?e:n,[2,new Promise(function(e,n){var i=function(e){r.version<s._version?s._event.upgrade(r.version,function(n){return cw(s,void 0,void 0,function(){var i;return lw(this,function(s){switch(s.label){case 0:if(n)return [3,5];r.version++,r.collectionNames=Array.from(this._collections.keys()),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._store.set({key:t,value:r})];case 2:return s.sent(),e({continued:!0}),[3,4];case 3:return i=s.sent(),e({continued:!1,err:i}),[3,4];case 4:return [3,6];case 5:e({continued:!1,err:n}),s.label=6;case 6:return [2];}});});}):e({continued:!1});},o=function(t){var a=t.continued,u=void 0!==a&&a,c=t.err,l=void 0===c?null:c;if(u)setTimeout(function(){return i(o);},10);else if(l)CD.error(l.message),s._globalMutex.unlock(),s._event.error(l),n(l);else {var d=[];r.collectionNames.forEach(function(e){var t=s._collections.get(e);t&&t.state===FR.READY||d.push(cw(s,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return [4,ID.metadataOf(this.name,e,this._store)];case 1:return (t=r.sent())?(n=new ID({dbname:this.name,collectionName:e,keyName:t.keyName,indexes:t.indexes,store:this._store}),this._collections.set(e,n),[4,n.init()]):[3,3];case 2:r.sent(),r.label=3;case 3:return [2];}});}));}),Promise.all(d).then(function(){s._state=DD.OPENED,s._globalMutex.unlock(),s._event.success(),e();}).catch(function(e){CD.error(e.message),s._globalMutex.unlock(),s._event.error(e),n(e);});}};i(o);})];case 5:switch((i=o.sent()).code){case yR.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:return [3,6];case yR.STORE_NOT_AVAILABLE:return [3,8];}return [3,10];case 6:return CD.warning("Access to the local storage is not allowed. Switched to MemoryStore automatically."),this._store=new OD({}),this._globalMutex.unlock(),this._event.error(i),this._event.storeReplaced(this._store),[4,this.open()];case 7:return o.sent(),[3,11];case 8:return CD.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."),this._store=new OD({}),this._globalMutex.unlock(),this._event.error(i),this._event.storeReplaced(this._store),[4,this.open()];case 9:return o.sent(),[3,11];case 10:throw CD.error(i.message),this._globalMutex.unlock(),this._event.error(i),i;case 11:return [3,12];case 12:return [2];}var a;});});},e.prototype.close=function(){this._collections.forEach(function(e){return e.close();}),this._state=DD.CLOSED;},e.prototype.clear=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,Promise.all(Array.from(this._collections.values()).map(function(e){return e.clear();}))];case 1:return e.sent(),[2];}});});},e.prototype.reset=function(){return cw(this,void 0,void 0,function(){var e,t=this;return lw(this,function(n){switch(n.label){case 0:return this.close(),(e=hD.get(this.name))&&e.clearByCondition(function(e){return e.key.startsWith(nD(t.name));}),[4,this._store.clear()];case 1:return n.sent(),[2];}});});},e.prototype.on=function(e,t){this._event[e]=t;},e.prototype.off=function(e){"function"==typeof this._event[e]&&(this._event[e]="upgrade"===e?YR:KR);},e.prototype.collection=function(e){var t=this._collections.get(e);if(t)return t;throw qR.collectionNotReady;},e;}(),PD=function(){function e(){this.messageTypeFilter=jw.ALL,this.customTypesFilter=null,this.senderUserIdsFilter=null,this.replyType=zw.NONE;}return e.prototype.clone=function(){var t=new e(),n=JSON.parse(JSON.stringify(this));return Object.keys(n).forEach(function(e){t[e]=n[e];}),t;},e.prototype.match=function(e){switch(this.messageTypeFilter){case jw.USER:if(e.messageType!==Hw.USER)return !1;break;case jw.FILE:if(e.messageType!==Hw.FILE)return !1;break;case jw.ADMIN:if(e.messageType!==Hw.ADMIN)return !1;}if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes(e.customType))return !1;if(this.senderUserIdsFilter&&this.senderUserIdsFilter.length>0){if(!(e instanceof tN))return !1;if(!this.senderUserIdsFilter.includes(e.sender.userId))return !1;}switch(this.replyType){case zw.NONE:if(e.parentMessageId>0)return !1;break;case zw.ONLY_REPLY_TO_CHANNEL:if(e instanceof tN&&e.parentMessageId>0&&!e.replyToChannel)return !1;}return !0;},e;}();!function(e){e.CHANNEL_LATEST="channel_latest",e.NEWEST_CHILD_MESSAGE="newest_child_message";}(MD||(MD={}));var FD,qD=function(e){switch(e){case MD.CHANNEL_LATEST:return ["channelUrl","-createdAt","-messageId"];case MD.NEWEST_CHILD_MESSAGE:return ["channelUrl","-parentMessageId","-createdAt","-messageId"];}};uw(uw({},qN),{scheduledAt:void 0}),uw(uw({},UN),{scheduledAt:0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1});var HD="UnsentMessage",jD={},VD=function(e){function t(t){var n=e.call(this,t)||this;return n._mutex=new wD("unsendmessagecache.lock"),jD[t]=n,n;}return aw(t,e),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return tA.of(this._iid).cacheContext;},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),jD[e]&&!n||(jD[e]=new t(e)),jD[e];},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb,t=null==e?void 0:e.collection(HD);if(!t)throw Iw.databaseError;return t;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection;},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){if(e.messageId>0)throw Iw.invalidParameters;var t,n=uw({},e.serialize());return e instanceof aN?(e.messageParams&&(n.messageParams=FN(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(n.scheduledInfo.scheduledMessageParams=(t=e.scheduledInfo.scheduledMessageParams,uw(uw({},FN(t)),{scheduledAt:t.scheduledAt})))):e instanceof dN?(e.messageParams&&(n.messageParams=GN(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(n.scheduledInfo.scheduledMessageParams=function(e){return uw(uw({},GN(e)),{scheduledAt:e.scheduledAt});}(e.scheduledInfo.scheduledMessageParams))):e instanceof cN&&e.messageParams&&(n.messageParams=function(e){return eI({fileInfoList:e.fileInfoList,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption});}(e.messageParams)),n;},t.prototype._deserialize=function(e){return e=uw(uw({},e),{messageId:parseInt(e.messageId)}),WD.of(this._iid).buildMessageFromSerializedData(e);},t.prototype._deserializeWithMessageCreateParams=function(e){var t,n,r;return cw(this,void 0,void 0,function(){var i,s,o,a,u,c,l=this;return lw(this,function(d){switch(d.label){case 0:return i=WD.of(this._iid),s=this._deserialize(e),e.messageParams?s instanceof aN?(a=e.messageParams,s.messageParams=i.buildUserMessageCreateParamsFromSerializedData(a,s),[3,6]):[3,1]:[3,6];case 1:return s instanceof dN?(a=e.messageParams).fileKey&&"string"==typeof a.fileKey&&VN(null!==(t=a.fileType)&&void 0!==t?t:"")?(o=a,[4,this.collection.getBlob(a.fileKey)]):[3,3]:[3,4];case 2:o.file=null!==(n=d.sent())&&void 0!==n?n:void 0,d.label=3;case 3:return s.messageParams=i.buildFileMessageCreateParamsFromSerializedData(a,s),[3,6];case 4:return s instanceof cN&&(a=e.messageParams)&&a.fileInfoList?(s.messageParams=i.buildMultipleFilesMessageCreateParamsFromSerializedData(a,s),[4,Promise.all(s.messageParams.fileInfoList.map(function(e){return cw(l,void 0,void 0,function(){var t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return "string"==typeof(null===(n=e._uploadedMetaData)||void 0===n?void 0:n.fileKey)&&VN(null!==(i=null===(r=e._uploadedMetaData)||void 0===r?void 0:r.fileType)&&void 0!==i?i:"")?(t=e,[4,this.collection.getBlob(e._uploadedMetaData.fileKey)]):[3,2];case 1:t.file=null!==(s=o.sent())&&void 0!==s?s:void 0,o.label=2;case 2:return [2];}});});}))]):[3,6];case 5:d.sent(),d.label=6;case 6:return s.scheduledInfo&&e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams?s instanceof aN?(u=e.scheduledInfo.scheduledMessageParams,s.scheduledInfo.scheduledMessageParams=i.buildScheduledUserMessageCreateParamsFromSerializedData(u,s),[3,10]):[3,7]:[3,10];case 7:return s instanceof dN?(u=e.scheduledInfo.scheduledMessageParams).fileKey&&"string"==typeof u.fileKey&&"string"==typeof u.fileType&&VN(u.fileType)?(c=u,[4,this.collection.getBlob(u.fileKey)]):[3,9]:[3,10];case 8:c.file=null!==(r=d.sent())&&void 0!==r?r:void 0,d.label=9;case 9:s.scheduledInfo.scheduledMessageParams=i.buildScheduledFileMessageCreateParamsFromSerializedData(u,s),d.label=10;case 10:return [2,s];}});});},t.prototype._getFileInfoBlobKey=function(e,t){return "".concat(e,".").concat(t);},t.prototype.get=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(t=n.sent())return [2,this._deserializeWithMessageCreateParams(t)];n.label=2;case 2:return [2,void 0];}});});},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.filter,r=void 0===n?new PD():n,i=e.order,s=void 0===i?MD.CHANNEL_LATEST:i,o=e.sendingStatus,a=e.backward,u=void 0!==a&&a,c=e.parentMessageId;return cw(this,void 0,void 0,function(){var e,n,i,a,l=this;return lw(this,function(d){switch(d.label){case 0:return this.localCacheEnabled?(e=qD(s),n={"/where":function(e){return !!(s!==MD.NEWEST_CHILD_MESSAGE||c&&0!==e.parentMessageId&&e.parentMessageId===c)&&r.match(l._deserialize(e));}},t&&(n.channelUrl=t),o&&(n.sendingStatus=o),i={where:n,index:e,backward:u},[4,this.collection.query(i)]):[3,3];case 1:return [4,d.sent().fetch({})];case 2:return a=d.sent(),[2,Promise.all(a.map(function(e){return cw(l,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,this._deserializeWithMessageCreateParams(e)];case 1:return [2,t.sent()];}});});}))];case 3:return [2,[]];}});});},t.prototype.getAllChildMessages=function(e,t){return void 0===t&&(t=new PD()),cw(this,void 0,void 0,function(){return lw(this,function(n){switch(n.label){case 0:return [4,this.fetch({filter:t,order:MD.NEWEST_CHILD_MESSAGE,channelUrl:e.channelUrl,backward:!1,parentMessageId:e.messageId})];case 1:return [2,n.sent()];}});});},t.prototype.upsert=function(e){return cw(this,void 0,void 0,function(){var t=this;return lw(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(e){return cw(t,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return e instanceof dN||e instanceof cN?[4,this._mutex.lock()]:[3,4];case 1:return n.sent(),[4,this.saveBlob(e)];case 2:return n.sent(),[4,this._mutex.unlock()];case 3:n.sent(),n.label=4;case 4:return t=this._serialize(e),[4,this.collection.upsertOne(t)];case 5:return n.sent(),[2];}});});}))]:[3,2];case 1:n.sent(),n.label=2;case 2:return [2];}});});},t.prototype.upsertChildMessages=function(e){return cw(this,void 0,void 0,function(){var t=this;return lw(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(e){return cw(t,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=[],e.threadInfo&&e.threadInfo.replyCount>0?[4,this.getAllChildMessages(e)]:[3,2];case 1:t=n.sent(),n.label=2;case 2:return t.length>0?(t.forEach(function(t){return t.applyParentMessage(e);}),[4,this.upsert(t)]):[3,4];case 3:n.sent(),n.label=4;case 4:return [2];}});});}))]:[3,2];case 1:n.sent(),n.label=2;case 2:return [2];}});});},t.prototype.remove=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:if(!this.localCacheEnabled)return [3,8];a.label=1;case 1:a.trys.push([1,6,7,8]),t=dw(e),n=t.next(),a.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove(r)]);case 3:a.sent(),a.label=4;case 4:return n=t.next(),[3,2];case 5:return [3,8];case 6:return i=a.sent(),s={error:i},[3,8];case 7:try{n&&!n.done&&(o=t.return)&&o.call(t);}finally{if(s)throw s.error;}return [7];case 8:return [2];}});});},t.prototype.removeMessagesOfChannel=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e}})]:[3,2];case 1:t.sent(),t.label=2;case 2:return [2];}});});},t.prototype.clear=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return [2];}});});},t.prototype.saveBlob=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i=this;return lw(this,function(s){switch(s.label){case 0:return e instanceof dN?e.messageParams&&(r=e.messageParams).file&&jN(r.file)?[4,this.collection.saveBlob(r.file,e.reqId)]:[3,2]:[3,5];case 1:n=s.sent(),r.fileKey=n,r.fileType=RN.BLOB,s.label=2;case 2:return e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(t=e.scheduledInfo.scheduledMessageParams).file&&jN(t.file)?[4,this.collection.saveBlob(t.file,e.reqId)]:[3,4];case 3:n=s.sent(),t.fileKey=n,t.fileType=RN.BLOB,s.label=4;case 4:return [3,7];case 5:return e instanceof cN&&(r=e.messageParams)&&r.fileInfoList&&Array.isArray(r.fileInfoList)?[4,Promise.all(r.fileInfoList.map(function(t,n){return cw(i,void 0,void 0,function(){var r;return lw(this,function(i){switch(i.label){case 0:return t.file&&jN(t.file)?[4,this.collection.saveBlob(t.file,this._getFileInfoBlobKey(e.reqId,n))]:[3,2];case 1:r=i.sent(),t._uploadedMetaData||(t._uploadedMetaData={}),t._uploadedMetaData.fileKey=r,t._uploadedMetaData.fileType=RN.BLOB,i.label=2;case 2:return [2];}});});}))]:[3,7];case 6:s.sent(),s.label=7;case 7:return [2];}});});},t;}(Ak),GD={},zD=function(e){function t(t){var n=e.call(this,t)||this;return GD[t]=n,n;}return aw(t,e),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return tA.of(this._iid).sdkState;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return tA.of(this._iid).cacheContext;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return VD.of(this._iid);},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),GD[e]&&!n||(GD[e]=new t(e)),GD[e];},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return Fk(!!e).throw(Iw.databaseError),e.collection(ER);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection;},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return uw(uw({},e.serialize()),{messageId:"".concat(e.messageId)});},t.prototype._deserialize=function(e){return e=uw(uw({},e),{messageId:parseInt(e.messageId)}),WD.of(this._iid).buildMessageFromSerializedData(e);},t.prototype.get=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(t=n.sent())return [2,this._deserialize(t)];n.label=2;case 2:return [2,void 0];}});});},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.token,r=e.limit,i=void 0===r?100:r,s=e.filter,o=void 0===s?new PD():s,a=e.order,u=void 0===a?MD.CHANNEL_LATEST:a,c=e.backward,l=void 0!==c&&c,d=e.parentMessageId,h=e.isPollOnly,f=void 0!==h&&h,p=e.exactMatch,v=void 0!==p&&p,_=e.inclusive,y=void 0===_||_;return cw(this,void 0,void 0,function(){var e,r,s,a=this;return lw(this,function(c){switch(c.label){case 0:return this.localCacheEnabled?(e=qD(u),r={where:{channelUrl:t,"/where":function(e){if(n)switch(u){case MD.CHANNEL_LATEST:if(v&&e.createdAt!==n)return !1;if(l){if(y&&e.createdAt<n||!y&&e.createdAt<=n)return !1;}else if(y&&e.createdAt>n||!y&&e.createdAt>=n)return !1;break;case MD.NEWEST_CHILD_MESSAGE:if(!d||0===e.parentMessageId||e.parentMessageId!==d)return !1;}return !(f&&!e._poll)&&o.match(a._deserialize(e));}},index:e,backward:l},[4,this.collection.query(r)]):[3,3];case 1:return [4,c.sent().fetch({limit:null!=i?i:void 0})];case 2:return s=c.sent(),[2,Promise.all(s.map(function(e){return cw(a,void 0,void 0,function(){return lw(this,function(t){return [2,this._deserialize(e)];});});}))];case 3:return [2,[]];}});});},t.prototype.getAllChildMessages=function(e,t){return void 0===t&&(t=new PD()),cw(this,void 0,void 0,function(){return lw(this,function(n){switch(n.label){case 0:return [4,this.fetch({channelUrl:e.channelUrl,token:Date.now(),limit:null,backward:!1,filter:t,order:MD.NEWEST_CHILD_MESSAGE,parentMessageId:e.messageId})];case 1:return [2,n.sent()];}});});},t.prototype.upsert=function(e){return cw(this,void 0,void 0,function(){var t,n=this;return lw(this,function(r){switch(r.label){case 0:return this.localCacheEnabled?[4,this.saveBlobs(e)]:[3,5];case 1:return r.sent(),t=e.map(function(e){return n._serialize(e);}),[4,this.collection.upsertMany(t)];case 2:return r.sent(),[4,this.upsertChildMessages(e)];case 3:return r.sent(),[4,this._unsentMessageCache.upsertChildMessages(e)];case 4:r.sent(),r.label=5;case 5:return [2];}});});},t.prototype.upsertChildMessages=function(e){return cw(this,void 0,void 0,function(){var t=this;return lw(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(e){return cw(t,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return t=[],(null===(n=e.threadInfo)||void 0===n?void 0:n.replyCount)&&e.threadInfo.replyCount>0?[4,this.getAllChildMessages(e)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return t.length>0?(t.forEach(function(t){return t.applyParentMessage(e);}),[4,this.upsert(t)]):[3,4];case 3:r.sent(),r.label=4;case 4:return [2];}});});}))]:[3,2];case 1:n.sent(),n.label=2;case 2:return [2];}});});},t.prototype.remove=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:if(!this.localCacheEnabled)return [3,8];a.label=1;case 1:a.trys.push([1,6,7,8]),t=dw(e),n=t.next(),a.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove("".concat(r))]);case 3:a.sent(),a.label=4;case 4:return n=t.next(),[3,2];case 5:return [3,8];case 6:return i=a.sent(),s={error:i},[3,8];case 7:try{n&&!n.done&&(o=t.return)&&o.call(t);}finally{if(s)throw s.error;}return [7];case 8:return [2];}});});},t.prototype.removeMessagesOfChannel=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:qD(MD.CHANNEL_LATEST)})]:[3,6];case 1:return n.sent(),[4,(t=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:n.sent(),n.label=6;case 6:return [2];}});});},t.prototype.removeUnderOffset=function(e,t){return cw(this,void 0,void 0,function(){return lw(this,function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":t}},index:qD(MD.CHANNEL_LATEST)})]:[3,2];case 1:n.sent(),n.label=2;case 2:return [2];}});});},t.prototype.clear=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return [2];}});});},t.prototype.countBetween=function(e,t,n){return cw(this,void 0,void 0,function(){var r,i=this;return lw(this,function(s){switch(s.label){case 0:return this.localCacheEnabled?(r=qD(MD.CHANNEL_LATEST),[4,this.collection.query({where:{channelUrl:e,"/where":function(e){var r=i._deserialize(e);return n.includes(r.createdAt)&&t.match(r);}},index:r}).count()]):[3,2];case 1:return [2,s.sent()];case 2:return [2,0];}});});},t.prototype.saveBlobs=function(e){return cw(this,void 0,void 0,function(){var t=this;return lw(this,function(n){switch(n.label){case 0:return [4,Promise.all(e.map(function(e){return cw(t,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return e instanceof dN&&e.messageParams&&(t=e.messageParams).file&&jN(t.file)?[4,this.collection.saveBlob(t.file,e.reqId)]:[3,2];case 1:n=r.sent(),t.fileKey=n,r.label=2;case 2:return [2];}});});}))];case 1:return n.sent(),[2];}});});},t.prototype._getGroupChannelPreferenceSize=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return t=0,[4,(n=this._cacheContext.preference).get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 1:return r=a.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 2:return i=a.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 3:return s=a.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 4:return o=a.sent(),r&&(t+=JSON.stringify(r).length),i&&(t+=JSON.stringify(i).length),s&&(t+=JSON.stringify(s).length),o&&(t+=JSON.stringify(o).length),[2,t];}});});},t;}(Ak),BD={},KD=function(e){function t(t){var n=e.call(this,t)||this;return n._observers=new Map(),n._dispatcherContext=n._dispatcher.on(function(e){return cw(n,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c,l,d,h,f,p,v=this;return lw(this,function(_){switch(_.label){case 0:return e instanceof cA?(t=e.messages,f=e.source,s=e.isWebSocketEventComing,n=t.filter(function(e){return e.messageId>0;}),r=t.filter(function(e){return 0===e.messageId;}),n.length>0?[4,dk(function(){return cw(v,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._messageCache.upsert(n)];case 1:return e.sent(),[4,this._unsentMessageCache.remove(n.map(function(e){return e instanceof tN?e.reqId:null;}).filter(function(e){return null!==e;}))];case 2:return e.sent(),[2];}});});})]:[3,2]):[3,5];case 1:_.sent(),s||this._broadcastUpdateEvent(n,f),_.label=2;case 2:return r.length>0?[4,dk(function(){return cw(v,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._unsentMessageCache.upsert(r)];case 1:return e.sent(),[2];}});});})]:[3,4];case 3:_.sent(),s||this._broadcastUpdateEvent(r,f),_.label=4;case 4:return [3,21];case 5:return e instanceof lA?(i=e.messageIds,f=e.source,s=e.isWebSocketEventComing,[4,dk(function(){return cw(v,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._messageCache.remove(i)];case 1:return e.sent(),[2];}});});})]):[3,7];case 6:return _.sent(),s||this._broadcastRemoveEvent(i,f),[3,21];case 7:return e instanceof dA?(o=e.reqId,f=e.source,[4,dk(function(){return cw(v,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._unsentMessageCache.remove([o])];case 1:return e.sent(),[2];}});});})]):[3,9];case 8:return _.sent(),this._broadcastRemoveUnsentEvent(o,f),[3,21];case 9:return e instanceof hA?(a=e.polls,f=e.source,this._cacheContext.localCacheEnabled?(u=a.map(function(e){return e.messageId;}),[4,Promise.all(u.map(function(e){return v._messageCache.get(e);}))]):[3,12]):[3,13];case 10:return (c=_.sent().filter(function(e){return e;})).length>0&&a.forEach(function(e){var t=c.find(function(t){return t.messageId===e.messageId;});t&&t.applyPoll(e);}),[4,dk(function(){return cw(v,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._messageCache.upsert(c)];case 1:return [2,e.sent()];}});});})];case 11:_.sent(),_.label=12;case 12:return this._broadcastPollChangeLogEvent(a,f),[3,21];case 13:return e instanceof fA?(l=e.event,f=e.source,[4,this._messageCache.get(l.messageId)]):[3,17];case 14:return (d=_.sent())&&d.isUserMessage()&&d.poll&&d.poll.applyPollUpdateEvent(l)?[4,dk(function(){return cw(v,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._messageCache.upsert([d])];case 1:return [2,e.sent()];}});});})]:[3,16];case 15:_.sent(),_.label=16;case 16:return this._broadcastPollUpdateEvent(l,f),[3,21];case 17:return e instanceof pA?(h=e.event,f=e.source,[4,this._messageCache.get(h.messageId)]):[3,21];case 18:return (p=_.sent())&&p.isUserMessage()&&p.poll&&p.poll.applyPollVoteEvent(h)?[4,dk(function(){return cw(v,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,this._messageCache.upsert([p])];case 1:return [2,e.sent()];}});});})]:[3,20];case 19:_.sent(),_.label=20;case 20:this._broadcastPollVoteEvent(h,f),_.label=21;case 21:return [2];}});});}),n;}return aw(t,e),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return tA.of(this._iid).cacheContext;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_dispatcher",{get:function(){return tA.of(this._iid).dispatcher;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return zD.of(this._iid);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return VD.of(this._iid);},enumerable:!1,configurable:!0}),t.of=function(e,n){var r;return void 0===n&&(n=!1),BD[e]&&!n||(BD[e]&&(null===(r=BD[e]._dispatcherContext)||void 0===r||r.close()),BD[e]=new t(e)),BD[e];},t.prototype._broadcastUpdateEvent=function(e,t){var n,r;try{for(var i=dw(this._observers.values()),s=i.next();!s.done;s=i.next()){var o=s.value;o.onUpdate&&o.onUpdate(e,t);}}catch(e){n={error:e};}finally{try{s&&!s.done&&(r=i.return)&&r.call(i);}finally{if(n)throw n.error;}}},t.prototype._broadcastPollChangeLogEvent=function(e,t){var n,r;try{for(var i=dw(this._observers.values()),s=i.next();!s.done;s=i.next()){var o=s.value;o.onPollChangeLogUpdate&&o.onPollChangeLogUpdate(e,t);}}catch(e){n={error:e};}finally{try{s&&!s.done&&(r=i.return)&&r.call(i);}finally{if(n)throw n.error;}}},t.prototype._broadcastPollUpdateEvent=function(e,t){var n,r;try{for(var i=dw(this._observers.values()),s=i.next();!s.done;s=i.next()){var o=s.value;o.onPollUpdate&&o.onPollUpdate(e,t);}}catch(e){n={error:e};}finally{try{s&&!s.done&&(r=i.return)&&r.call(i);}finally{if(n)throw n.error;}}},t.prototype._broadcastPollVoteEvent=function(e,t){var n,r;try{for(var i=dw(this._observers.values()),s=i.next();!s.done;s=i.next()){var o=s.value;o.onPollVote&&o.onPollVote(e,t);}}catch(e){n={error:e};}finally{try{s&&!s.done&&(r=i.return)&&r.call(i);}finally{if(n)throw n.error;}}},t.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var i=dw(this._observers.values()),s=i.next();!s.done;s=i.next()){var o=s.value;o.onRemove&&o.onRemove(e,t);}}catch(e){n={error:e};}finally{try{s&&!s.done&&(r=i.return)&&r.call(i);}finally{if(n)throw n.error;}}},t.prototype._broadcastRemoveUnsentEvent=function(e,t){var n,r;try{for(var i=dw(this._observers.values()),s=i.next();!s.done;s=i.next()){var o=s.value;o.onRemoveUnsent&&o.onRemoveUnsent(e,t);}}catch(e){n={error:e};}finally{try{s&&!s.done&&(r=i.return)&&r.call(i);}finally{if(n)throw n.error;}}},t.prototype.subscribe=function(e,t){this._observers.set(e,t);},t.prototype.unsubscribe=function(e){this._observers.delete(e);},t.prototype.unsubscribeAll=function(){this._observers.clear();},t;}(Ak),QD={},WD=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,s=t.onlineDetector,o=t.cacheContext;this._iid=e,this._sdkState=n,this._requestQueue=i,this._dispatcher=r,this._cacheContext=o,zD.of(e),VD.of(e),KD.of(e),this.fileMessageQueue=new mN(e,{sdkState:n,dispatcher:r,requestQueue:i,onlineDetector:s,cacheContext:o}),QD[e]=this;}return e.of=function(e){return QD[e];},e.prototype.buildMessageFromSerializedData=function(e){var t=Pk(e);switch(t.messageType){case Hw.USER:return new aN(this._iid,aN.payloadify(t));case Hw.FILE:return cN._isMultipleFilesMessageSerializedData(t)?new cN(this._iid,cN.payloadify(t)):new dN(this._iid,dN.payloadify(t));case Hw.ADMIN:return new sN(this._iid,sN.payloadify(t));}throw Iw.invalidParameters;},e.prototype.buildUserMessageCreateParamsFromSerializedData=function(e,t){return eI(tI({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,message:t.message,translationTargetLanguages:Object.keys(t.translations),pollId:e.pollId}));},e.prototype.buildFileMessageCreateParamsFromSerializedData=function(e,t){var n;return eI(tI({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,file:e.file,fileKey:e.fileKey,fileUrl:t.plainUrl,fileName:t.name,fileSize:t.size,mimeType:t.type,thumbnailSizes:null===(n=t.thumbnails)||void 0===n?void 0:n.map(function(e){return {maxWidth:e.width,maxHeight:e.height};}),fileType:e.fileType,requireAuth:t.requireAuth}));},e.prototype.buildMultipleFilesMessageCreateParamsFromSerializedData=function(e,t){return eI({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,fileInfoList:e.fileInfoList});},e.prototype.buildScheduledUserMessageCreateParamsFromSerializedData=function(e,t){return uw(uw({},this.buildUserMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt});},e.prototype.buildScheduledFileMessageCreateParamsFromSerializedData=function(e,t){return uw(uw({},this.buildFileMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt});},e.prototype.buildSenderFromSerializedData=function(e){var t=Pk(e);return new XA(this._iid,XA.payloadify(t));},e.prototype.getMessage=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=new IN(e),[4,this._requestQueue.send(t)];case 1:return [2,n.sent().as(TN).message];}});});},e.prototype.getScheduledMessage=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:return t=new NN(e),[4,this._requestQueue.send(t)];case 1:return [2,n.sent().as(ON).message];}});});},e.prototype.getMessagesByMessageId=function(e,t,n,r,i){return void 0===i&&(i=rA.REQUEST_MESSAGE),cw(this,void 0,void 0,function(){var s,o,a;return lw(this,function(u){switch(u.label){case 0:return s=new SN(uw(uw({channelType:t,channelUrl:e,token:String(n)},gN),r)),[4,this._requestQueue.send(s)];case 1:return o=u.sent(),a=o.as(CN).messages,this._dispatcher.dispatch(new cA({messages:a,source:i})),[2,a];}});});},e.prototype.getMessagesByTimestamp=function(e,t,n,r,i){return void 0===i&&(i=rA.REQUEST_MESSAGE),cw(this,void 0,void 0,function(){var s,o,a;return lw(this,function(u){switch(u.label){case 0:return s=new SN(uw(uw({channelType:t,channelUrl:e,timestamp:n},gN),r)),[4,this._requestQueue.send(s)];case 1:return o=u.sent(),a=o.as(CN).messages,this._dispatcher.dispatch(new cA({messages:a,source:i})),[2,a];}});});},e.prototype._getMessagesByTimestampForCollection=function(e,t,n,r,i,s){return void 0===i&&(i=rA.REQUEST_MESSAGE),cw(this,void 0,void 0,function(){var o,a,u,c;return lw(this,function(l){switch(l.label){case 0:return o=new SN(uw(uw(uw({channelType:t,channelUrl:e,timestamp:n},gN),r),{checkingContinuousMessages:s})),[4,this._requestQueue.send(o)];case 1:return a=l.sent(),u=a.payload,c=a.as(CN).messages,this._dispatcher.dispatch(new cA({messages:c,source:i})),[2,{messages:c,isContinuousMessages:u}];}});});},e.prototype.getThreadedMessagesByTimestamp=function(e,t,n,r){return void 0===r&&(r=rA.REQUEST_THREADED_MESSAGE),cw(this,void 0,void 0,function(){var i,s,o,a;return lw(this,function(u){switch(u.label){case 0:return i=new SN(uw(uw(uw({channelUrl:e.channelUrl,channelType:e.channelType,timestamp:t},rN),n),{replyType:zw.ALL,parentMessageId:e.messageId,includeThreadInfo:!0})),[4,this._requestQueue.send(i)];case 1:return s=u.sent(),o=s.as(CN).messages,(a=o.slice(1)).forEach(function(t){t.parentMessage=e;}),this._dispatcher.dispatch(new cA({messages:a,source:r})),[2,{parentMessage:o[0],threadedMessages:a}];}});});},e.prototype.getMessageChangelogs=function(e,t,n,r,i){return void 0===i&&(i=rA.REQUEST_MESSAGE_CHANGELOGS),cw(this,void 0,void 0,function(){var s,o,a,u,c,l,d,h;return lw(this,function(f){switch(f.label){case 0:return s=new kN(eI(tI(uw(uw({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null},bN),r)))),[4,this._requestQueue.send(s)];case 1:return o=f.sent(),a=o.as(AN),u=a.updatedMessages,c=a.deletedMessagesInfo,l=a.hasMore,d=a.nextToken,h=c.map(function(e){return e.messageId;}),u.length>0&&this._dispatcher.dispatch(new cA({messages:u,source:i})),h.length>0&&this._dispatcher.dispatch(new lA({messageIds:h,source:i})),[2,{updatedMessages:u,deletedMessageIds:h,hasMore:l,token:d}];}});});},e;}(),YD=function(e){function t(t,n){var r=e.call(this,t)||this;r.targetMessageId=0;var i=n.thread_info,s=n.parent_message_id,o=n.channel_url,a=n.channel_type;return i&&kw("object",i)&&kw("number",s)&&kw("string",o)&&kw("string",a)&&(r.threadInfo=new VA(t,i),r.targetMessageId=s,r.channelUrl=o,r.channelType=a),r;}return aw(t,e),t;}(Ak),ZD={channelUrl:"",channelType:Pw.BASE,messageId:0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1},XD=function(e){function t(t){var n=t.channelCustomType,r=t.keyword,i=t.limit,s=t.reverse,o=t.exactMatch,a=t.channelUrl,u=t.order,c=t.messageTimestampFrom,l=t.messageTimestampTo,d=t.advancedQuery,h=t.targetFields,f=t.nextToken,p=e.call(this)||this;return p.method=nI.GET,p.path="".concat(cI,"/messages"),p.params={custom_type:n,query:r,limit:i,reverse:s,exact_match:o,channel_url:a,message_ts_from:c,message_ts_to:l,sort_field:u,advanced_query:d,target_fields:h,after:f},p;}return aw(t,e),t;}(wI),JD=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.messages=n.results.map(function(e){return lN(t,e);}),r.hasNext=n.has_next,r.nextToken=n.end_cursor,r.totalCount=n.total_count,r;}return aw(t,e),t;}(II);!function(e){e.SCORE="score",e.TIMESTAMP="ts";}(FD||(FD={}));var $D,ex=function(e){function t(t,n){var r,i,s,o,a,u,c,l,d,h=this;return (h=e.call(this,t,n)||this).keyword="",h.reverse=!1,h.exactMatch=!1,h.channelUrl="",h.channelCustomType="",h.messageTimestampFrom=null,h.messageTimestampTo=null,h.order=FD.SCORE,h.advancedQuery=!1,h.targetFields=null,h._nextToken="",h.totalCount=-1,h.keyword=n.keyword,h.reverse=null!==(r=n.reverse)&&void 0!==r&&r,h.exactMatch=null!==(i=n.exactMatch)&&void 0!==i&&i,h.channelUrl=null!==(s=n.channelUrl)&&void 0!==s?s:"",h.channelCustomType=null!==(o=n.channelCustomType)&&void 0!==o?o:"",h.messageTimestampFrom=null!==(a=n.messageTimestampFrom)&&void 0!==a?a:null,h.messageTimestampTo=null!==(u=n.messageTimestampTo)&&void 0!==u?u:null,h.order=null!==(c=n.order)&&void 0!==c?c:FD.SCORE,h.advancedQuery=null!==(l=n.advancedQuery)&&void 0!==l&&l,h.targetFields=null!==(d=n.targetFields)&&void 0!==d?d:null,h;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&kw("string",this.keyword)&&this.keyword.length>0&&kw("boolean",this.reverse)&&kw("boolean",this.exactMatch)&&kw("string",this.channelUrl)&&kw("string",this.channelCustomType)&&(kw("number",this.messageTimestampFrom)||null===this.messageTimestampFrom)&&(kw("number",this.messageTimestampTo)||null===this.messageTimestampTo)&&Aw(FD,this.order)&&kw("boolean",this.advancedQuery)&&Ow("string",this.targetFields,!0);},t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o,a;return lw(this,function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=tA.of(this._iid).requestQueue,t=new XD(tI(uw(uw({},this),{nextToken:this._nextToken?this._nextToken:null}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=u.sent(),r=n.as(JD),i=r.messages,s=r.hasNext,o=r.nextToken,a=r.totalCount,this._nextToken=o,this._hasNext=s,this._isLoading=!1,this.totalCount=a,[2,i];case 2:return [2,[]];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(vA),tx={channelUrl:"",scheduledMessageId:0},nx=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="message",t;}return aw(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,s=n.sessionManager,o=n.requestQueue,a=n.logger,u=n.onlineDetector,c=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:s,requestQueue:o,logger:a,onlineDetector:u,cacheContext:c}),this._manager=new WD(t,{sdkState:r,dispatcher:i,requestQueue:o,onlineDetector:u,cacheContext:c});},t.prototype.buildMessageFromSerializedData=function(e){return this._manager.buildMessageFromSerializedData(e);},t.prototype.buildSenderFromSerializedData=function(e){return this._manager.buildSenderFromSerializedData(e);},t.prototype.getMessage=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){return t=uw(uw({},ZD),e),Fk(function(e){return kw("string",e.channelUrl)&&Aw(Pw,e.channelType)&&kw("number",e.messageId)&&kw("boolean",e.includeReactions,!0)&&kw("boolean",e.includeMetaArray,!0)&&kw("boolean",e.includeParentMessageInfo,!0)&&kw("boolean",e.includeThreadInfo,!0);}(t)).throw(Iw.invalidParameters),[2,this._manager.getMessage(t)];});});},t.prototype.getScheduledMessage=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){return t=uw(uw({},tx),e),Fk(function(e){return kw("string",e.channelUrl)&&""!==e.channelUrl&&kw("number",e.scheduledMessageId)&&e.scheduledMessageId>0;}(t)).throw(Iw.invalidParameters),[2,this._manager.getScheduledMessage(t)];});});},t;}(nA),rx=function(e,t){this.pollId=0,this.messageId=0,this.pollId=t.poll.id,this.messageId=t.poll.message_id,this._iid=e,this._payload=t;};!function(e){e[e.NONE=0]="NONE",e[e.CHANNEL_ENTER=10102]="CHANNEL_ENTER",e[e.CHANNEL_EXIT=10103]="CHANNEL_EXIT",e[e.USER_CHANNEL_MUTE=10201]="USER_CHANNEL_MUTE",e[e.USER_CHANNEL_UNMUTE=10200]="USER_CHANNEL_UNMUTE",e[e.USER_CHANNEL_BAN=10601]="USER_CHANNEL_BAN",e[e.USER_CHANNEL_UNBAN=10600]="USER_CHANNEL_UNBAN",e[e.CHANNEL_FREEZE=10701]="CHANNEL_FREEZE",e[e.CHANNEL_UNFREEZE=10700]="CHANNEL_UNFREEZE",e[e.TYPING_START=10900]="TYPING_START",e[e.TYPING_END=10901]="TYPING_END",e[e.CHANNEL_JOIN=1e4]="CHANNEL_JOIN",e[e.CHANNEL_LEAVE=10001]="CHANNEL_LEAVE",e[e.CHANNEL_OPERATOR_UPDATE=10002]="CHANNEL_OPERATOR_UPDATE",e[e.CHANNEL_INVITE=10020]="CHANNEL_INVITE",e[e.CHANNEL_ACCEPT_INVITE=10021]="CHANNEL_ACCEPT_INVITE",e[e.CHANNEL_DECLINE_INVITE=10022]="CHANNEL_DECLINE_INVITE",e[e.CHANNEL_PROP_CHANGED=11e3]="CHANNEL_PROP_CHANGED",e[e.CHANNEL_DELETED=12e3]="CHANNEL_DELETED",e[e.CHANNEL_META_DATA_CHANGED=11100]="CHANNEL_META_DATA_CHANGED",e[e.CHANNEL_META_COUNTERS_CHANGED=11200]="CHANNEL_META_COUNTERS_CHANGED",e[e.CHANNEL_HIDE=13e3]="CHANNEL_HIDE",e[e.CHANNEL_UNHIDE=13001]="CHANNEL_UNHIDE",e[e.PINNED_MESSAGE_CHANGED=11300]="PINNED_MESSAGE_CHANGED";}($D||($D={}));var ix=function(){function e(e){var t;this.channelUrl=e.channel_url,this.channelType=e.channel_type,this.category=e.cat,this.data=null!==(t=e.data)&&void 0!==t?t:{},this.ts=e.ts;}return Object.defineProperty(e.prototype,"isGroupChannelEvent",{get:function(){return this.channelType===Pw.GROUP;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpenChannelEvent",{get:function(){return this.channelType===Pw.OPEN;},enumerable:!1,configurable:!0}),e;}(),sx=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.event=new ix(r),i;}return aw(t,e),t;}(MI),ox=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,s=r.data.operators,o=void 0===s?[]:s;return i.operators=o.map(function(e){return new Hk(i._iid,e);}),i;}return aw(t,e),t;}(sx),ax=function(){function e(e){var t=e.top,n=void 0===t?Number.MAX_SAFE_INTEGER:t,r=e.bottom,i=void 0===r?0:r;this.top=n,this.bottom=i;}return e.prototype.includes=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.every(function(t){return e.top<=t&&t<=e.bottom;});},e.prototype.overlap=function(e){return this.includes(e.top)||this.includes(e.bottom);},e.prototype.intersect=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.some(function(t){return e.top<=t&&t<=e.bottom;});},e.prototype.extends=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.top=Math.min.apply(Math,fw([this.top],hw(e),!1)),this.bottom=Math.max.apply(Math,fw([this.bottom],hw(e),!1));},e;}(),ux=function(e){function t(t,n){var r=e.call(this,t)||this;return r._logger=n.logger,r._sdkState=n.sdkState,r._sessionManager=n.sessionManager,r._requestQueue=n.requestQueue,r._dispatcher=n.dispatcher,r._cacheContext=n.cacheContext,r._channelType=n.channelType,r;}return aw(t,e),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return zD.of(this._iid);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return VD.of(this._iid);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_messageBroadcast",{get:function(){return KD.of(this._iid);},enumerable:!1,configurable:!0}),t.prototype.subscribeMessageEvent=function(e,t){this._messageBroadcast.subscribe(e,t);},t.prototype.unsubscribeMessageEvent=function(e){this._messageBroadcast.unsubscribe(e);},t.prototype.getMessageFromCache=function(e){var t;return cw(this,void 0,void 0,function(){return lw(this,function(n){switch(n.label){case 0:return [4,this._messageCache.get(e)];case 1:return [2,null!==(t=n.sent())&&void 0!==t?t:null];}});});},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,t,n){return cw(this,void 0,void 0,function(){return lw(this,function(r){switch(r.label){case 0:return [4,this._messageCache.fetch({channelUrl:e,token:t,filter:n,exactMatch:!0})];case 1:return [2,r.sent()];}});});},t.prototype.getMessagesFromCache=function(e,t,n,r,i,s){return void 0===i&&(i=100),void 0===s&&(s=!0),cw(this,void 0,void 0,function(){return lw(this,function(o){switch(o.label){case 0:return [4,this._messageCache.fetch({channelUrl:e,token:t,limit:i,filter:r,backward:"next"===n,inclusive:s})];case 1:return [2,o.sent()];}});});},t.prototype.getPollMessagesFromCache=function(e,t,n,r){return cw(this,void 0,void 0,function(){return lw(this,function(i){switch(i.label){case 0:return [4,this._messageCache.fetch({channelUrl:e,token:t,limit:r,filter:n,backward:!1,isPollOnly:!0})];case 1:return [2,i.sent()];}});});},t.prototype.getCachedMessageCountBetween=function(e,t,n,r){return cw(this,void 0,void 0,function(){return lw(this,function(i){switch(i.label){case 0:return [4,this._messageCache.countBetween(e,t,new ax({top:n,bottom:r}))];case 1:return [2,i.sent()];}});});},t.prototype.getUnsentMessagesFromCache=function(e,t){return cw(this,void 0,void 0,function(){return lw(this,function(n){switch(n.label){case 0:return [4,this._unsentMessageCache.fetch({channelUrl:e,filter:t})];case 1:return [2,n.sent()];}});});},t.prototype.removeFailedMessageFromCache=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,this._unsentMessageCache.remove([e])];case 1:return t.sent(),[2];}});});},t;}(Ak),cx=function(e){function t(t,n,r){var i,s,o,a,u=this;(u=e.call(this,t,"ADMM",r)||this).message=new sN(t,r);var c=tA.of(t).sdkState;return u.isMentioned=mI(u.message.mentionType,null!==(o=null!==(i=u.message.mentionedUserIds)&&void 0!==i?i:null===(s=u.message.mentionedUsers)||void 0===s?void 0:s.map(function(e){return e.userId;}))&&void 0!==o?o:[],c.userId),u.forceUpdateLastMessage=null!==(a=r.force_update_last_message)&&void 0!==a&&a,u;}return aw(t,e),t;}(MI),lx=function(e){function t(t,n,r){var i,s,o,a,u,c=this;(c=e.call(this,t,"AEDI",r)||this).message=new sN(t,r);var l=tA.of(t).sdkState;return c.mentionCountChange=gI({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(o=null===(s=r.old_values)||void 0===s?void 0:s.mentioned_user_ids)&&void 0!==o?o:[]},tI({mentionType:c.message.mentionType,mentionedUserIds:null!==(a=c.message.mentionedUserIds)&&void 0!==a?a:null===(u=c.message.mentionedUsers)||void 0===u?void 0:u.map(function(e){return e.userId;})}),l.userId),c;}return aw(t,e),t;}(MI),dx=function(e){function t(t,n,r){var i=e.call(this,t,"MRCT",r)||this;return i.channelUrl=r.channel_url,i.channelType=r.channel_type,i.event=new BA(r),i;}return aw(t,e),t;}(MI),hx=function(e){function t(t,n,r){var i=e.call(this,t,"MTHD",r)||this;return i.event=new YD(t,r),i;}return aw(t,e),t;}(MI),fx=function(e){function t(t,n,r){var i=e.call(this,t,"MCNT",r)||this;return i.groupChannelMemberCounts=r.group_channels.map(function(e){return {channelUrl:e.channel_url,memberCount:e.member_count,joinedMemberCount:e.joined_member_count,updatedAt:e.ts};}),i.openChannelMemberCounts=r.open_channels.map(function(e){return {channelUrl:e.channel_url,participantCount:e.participant_count,updatedAt:e.ts};}),i;}return aw(t,e),t;}(MI),px=function(e){function t(t,n,r){var i=e.call(this,t,"PEDI",r)||this;return i.event=new rx(t,r),i.status=iA(r.poll.status)||r.poll.status,i.channelUrl=r.channel_url,i.channelType=r.channel_type,i;}return aw(t,e),t;}(MI),vx=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._channels=new Map(),t._enteredChannelUrls=[],t;}return aw(t,e),Object.defineProperty(t.prototype,"enteredChannels",{get:function(){var e=this;return this._enteredChannelUrls.map(function(t){return e._channels.get(t);}).filter(function(e){return !!e;});},enumerable:!1,configurable:!0}),t.prototype.isEnteredChannel=function(e){return this._enteredChannelUrls.includes(e);},t.prototype.enter=function(e){this._enteredChannelUrls.indexOf(e)<0&&this._enteredChannelUrls.push(e);},t.prototype.exit=function(e){var t=this._enteredChannelUrls.indexOf(e);t>=0&&this._enteredChannelUrls.splice(t,1);},t.prototype.exitAll=function(){this._enteredChannelUrls=[];},t.prototype.get=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this._channels.get(e)];});});},t.prototype.upsert=function(e){return cw(this,void 0,void 0,function(){var t,n=this;return lw(this,function(r){return t=[],e.forEach(function(e){if(n._channels.has(e.url)){var r=n._channels.get(e.url);Object.assign(r,e),t.push(r);}else n._channels.set(e.url,e),t.push(e);}),[2,t];});});},t.prototype.remove=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return this._channels.delete(e),this.exit(e),[2];});});},t.prototype.clear=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){return this._channels.clear(),this._enteredChannelUrls=[],[2];});});},t;}(Ak),_x={channelUrl:void 0,name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,isEphemeral:void 0},yx=function(e){function t(t){var n=t.channelUrl,r=t.isInternalCall,i=e.call(this)||this;return i.method=nI.GET,i.path="".concat(r?uI:aI,"/").concat(encodeURIComponent(n)),i;}return aw(t,e),t;}(wI),mx=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new xx(t,n),r;}return aw(t,e),t;}(II),gx=function(e){function t(t){var n=this,r=t.channelUrl,i=t.coverUrlOrImage,s=t.name,o=t.data,a=t.customType,u=t.operatorUserIds,c=t.isEphemeral;return (n=e.call(this)||this).method=nI.POST,n.path=aI,n.params=eI(tI({channel_url:r,cover_url:kw("string",i)?i:null,cover_file:Dw(i)?i:null,name:s,data:o,custom_type:a,operators:u,is_ephemeral:c})),n;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){var r=e.call(this,t,n)||this;return r.channel=new xx(t,n),r;},e);}(II);var Ex=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"ENTR",payload:{channel_url:n},ackRequired:!0})||this;}return aw(t,e),t;}(WC),bx=function(e){function t(t,n,r){var i,s,o=this;return o=e.call(this,t,"SYEV",r)||this,r.data&&(o.participantCount=null!==(i=r.data.participant_count)&&void 0!==i?i:0,o.user=new Hk(t,r.data),o.ts=null!==(s=r.data.edge_ts)&&void 0!==s?s:0),o;}return aw(t,e),t;}(sx),wx=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"EXIT",payload:{channel_url:n},ackRequired:!0})||this;}return aw(t,e),t;}(WC),Ix=function(e){function t(t,n,r){var i,s,o=this;return o=e.call(this,t,"EXIT",r)||this,r.data&&(o.participantCount=null!==(i=r.data.participant_count)&&void 0!==i?i:0,o.user=new Hk(t,r.data),o.ts=null!==(s=r.data.edge_ts)&&void 0!==s?s:0),o;}return aw(t,e),t;}(sx),Tx={},Sx=function(e){function t(t,n){var r=e.call(this,t,uw(uw({},n),{channelType:Pw.OPEN}))||this;return r.subscribeChannelEvent=UI,r.unsubscribeChannelEvent=UI,r.refreshChannel=function(){return cw(r,void 0,void 0,function(){return lw(this,function(e){return [2,void 0];});});},r._openChannelCache=new vx(t),r._openChannelHandlers=new Map(),r._dispatcher.on(function(e){var t,n;if(e instanceof MI)r._handleEvent(e);else if(e instanceof JC&&e.stateType===KC.CONNECTED){var i=r._openChannelCache.enteredChannels;try{for(var s=dw(i),o=s.next();!o.done;o=s.next())o.value.enter();}catch(e){t={error:e};}finally{try{o&&!o.done&&(n=s.return)&&n.call(s);}finally{if(t)throw t.error;}}}}),Tx[t]||(Tx[t]=r),r;}return aw(t,e),t.of=function(e){return Tx[e];},t.prototype.buildOpenChannelFromSerializedData=function(e){var t=Pk(e);return new xx(this._iid,xx.payloadify(t));},t.prototype.getChannelFromCache=function(e){var t;return cw(this,void 0,void 0,function(){return lw(this,function(n){switch(n.label){case 0:return [4,this._openChannelCache.get(e)];case 1:return [2,null!==(t=n.sent())&&void 0!==t?t:null];}});});},t.prototype.upsertChannelsToCache=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return [4,this._openChannelCache.upsert(e)];case 1:return [2,t.sent()];}});});},t.prototype.removeChannelsFromCache=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,7]),t=dw(e),n=t.next(),a.label=1;case 1:return n.done?[3,4]:(r=n.value,[4,this._openChannelCache.remove(r)]);case 2:a.sent(),a.label=3;case 3:return n=t.next(),[3,1];case 4:return [3,7];case 5:return i=a.sent(),s={error:i},[3,7];case 6:try{n&&!n.done&&(o=t.return)&&o.call(t);}finally{if(s)throw s.error;}return [7];case 7:return [2];}});});},t.prototype.setEnteredToCache=function(e){this._openChannelCache.enter(e.url);},t.prototype.setExitedToCache=function(e){this._openChannelCache.exit(e.url);},t.prototype._handleEvent=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c,l,d,h,f,p,v,_,y,m,g,E,b,w,I,T,S,C,k,A,N,O,R,D,x,L,M,U,P,F,q,H,j,V,G,z,B,K,Q,W,Y,Z,X,J,$,ee,te,ne,re,ie,se,oe,ae,ue,ce,le,de,he,fe,pe,ve=this;return lw(this,function(_e){switch(_e.label){case 0:switch(_e.trys.push([0,57,,58]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return [3,1];case"MEDI":case"FEDI":case"AEDI":return [3,4];case"DELM":return [3,7];case"MRCT":return [3,10];case"MTHD":return [3,13];case"MCNT":return [3,16];case"PEDI":return [3,27];case"VOTE":return [3,30];case"SYEV":return [3,33];}return [3,56];case 1:return i=null,"MESG"===e.code?i=e.as(zO):"FILE"===e.code?i=e.as(pN):"ADMM"!==e.code&&"BRDM"!=e.code||(i=e.as(cx)),i?(t=i.message,n=i.isMentioned,t.channelType!==Pw.OPEN?[3,3]:[4,this.getChannel(t.channelUrl,!0)]):[3,3];case 2:r=_e.sent(),lk(function(){return cw(ve,void 0,void 0,function(){var e,i,s,o,a;return lw(this,function(u){try{for(e=dw(this._openChannelHandlers.values()),i=e.next();!i.done;i=e.next())s=i.value,this._openChannelCache.isEnteredChannel(r.url)&&(s.onMessageReceived&&s.onMessageReceived(r,t),n&&s.onMentionReceived&&s.onMentionReceived(r,t));}catch(e){o={error:e};}finally{try{i&&!i.done&&(a=e.return)&&a.call(e);}finally{if(o)throw o.error;}}return [2];});});}),_e.label=3;case 3:return [3,56];case 4:return i=null,"MEDI"===e.code?i=e.as(KO):"FEDI"===e.code?i=e.as(WO):"AEDI"===e.code&&(i=e.as(lx)),i?(s=i.message,o=i.mentionCountChange,s.channelType!==Pw.OPEN?[3,6]:[4,this.getChannel(s.channelUrl,!0)]):[3,6];case 5:a=_e.sent(),lk(function(){return cw(ve,void 0,void 0,function(){var e,t,n,r,i;return lw(this,function(u){try{for(e=dw(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(a.url)&&(n.onMessageUpdated&&n.onMessageUpdated(a,s),o>0&&n.onMentionReceived&&n.onMentionReceived(a,s));}catch(e){r={error:e};}finally{try{t&&!t.done&&(i=e.return)&&i.call(e);}finally{if(r)throw r.error;}}return [2];});});}),_e.label=6;case 6:return [3,56];case 7:return u=e.as(ZO),R=u.channelUrl,D=u.channelType,c=u.messageId,D!==Pw.OPEN?[3,9]:[4,this.getChannel(R,!0)];case 8:l=_e.sent(),lk(function(){return cw(ve,void 0,void 0,function(){var e,t,n,r,i;return lw(this,function(s){try{for(e=dw(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(l.url)&&n.onMessageDeleted&&n.onMessageDeleted(l,c);}catch(e){r={error:e};}finally{try{t&&!t.done&&(i=e.return)&&i.call(e);}finally{if(r)throw r.error;}}return [2];});});}),_e.label=9;case 9:return [3,56];case 10:return d=e.as(dx),R=d.channelUrl,D=d.channelType,h=d.event,D!==Pw.OPEN?[3,12]:[4,this.getChannel(R,!0)];case 11:f=_e.sent(),lk(function(){return cw(ve,void 0,void 0,function(){var e,t,n,r,i;return lw(this,function(s){try{for(e=dw(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(f.url)&&n.onReactionUpdated&&n.onReactionUpdated(f,h);}catch(e){r={error:e};}finally{try{t&&!t.done&&(i=e.return)&&i.call(e);}finally{if(r)throw r.error;}}return [2];});});}),_e.label=12;case 12:return [3,56];case 13:return (p=e.as(hx).event).channelType!==Pw.OPEN?[3,15]:[4,this.getChannel(p.channelUrl,!0)];case 14:v=_e.sent(),lk(function(){return cw(ve,void 0,void 0,function(){var e,t,n,r,i;return lw(this,function(s){try{for(e=dw(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(v.url)&&n.onThreadInfoUpdated&&n.onThreadInfoUpdated(v,p);}catch(e){r={error:e};}finally{try{t&&!t.done&&(i=e.return)&&i.call(e);}finally{if(r)throw r.error;}}return [2];});});}),_e.label=15;case 15:return [3,56];case 16:_=e.as(fx).openChannelMemberCounts,y=[],_e.label=17;case 17:_e.trys.push([17,22,23,24]),m=dw(_),g=m.next(),_e.label=18;case 18:return g.done?[3,21]:(E=g.value,R=E.channelUrl,j=E.participantCount,b=E.updatedAt,[4,this.getChannelFromCache(R)]);case 19:(w=_e.sent())&&w._updateParticipantCount(j,b)&&y.push(w),_e.label=20;case 20:return g=m.next(),[3,18];case 21:return [3,24];case 22:return I=_e.sent(),fe={error:I},[3,24];case 23:try{g&&!g.done&&(pe=m.return)&&pe.call(m);}finally{if(fe)throw fe.error;}return [7];case 24:return y.length>0?[4,this.upsertChannelsToCache(y)]:[3,26];case 25:T=_e.sent(),lk(function(){return cw(ve,void 0,void 0,function(){var e,t,n,r,i;return lw(this,function(s){try{for(e=dw(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelMemberCountChanged&&n.onChannelMemberCountChanged(T);}catch(e){r={error:e};}finally{try{t&&!t.done&&(i=e.return)&&i.call(e);}finally{if(r)throw r.error;}}return [2];});});}),_e.label=26;case 26:return [3,56];case 27:return S=e.as(px),C=S.event,k=S.status,R=S.channelUrl,D=S.channelType,R&&D===Pw.OPEN?[4,this.getChannel(R,!0)]:[3,29];case 28:A=_e.sent(),this._dispatcher.dispatch(new fA({event:C,source:rA.EVENT_POLL_UPDATED})),lk("removed"===k?function(){return cw(ve,void 0,void 0,function(){var e,t,n,r,i;return lw(this,function(s){try{for(e=dw(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollDeleted&&n.onPollDeleted(A,C.pollId);}catch(e){r={error:e};}finally{try{t&&!t.done&&(i=e.return)&&i.call(e);}finally{if(r)throw r.error;}}return [2];});});}:function(){return cw(ve,void 0,void 0,function(){var e,t,n,r,i;return lw(this,function(s){try{for(e=dw(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollUpdated&&n.onPollUpdated(A,C);}catch(e){r={error:e};}finally{try{t&&!t.done&&(i=e.return)&&i.call(e);}finally{if(r)throw r.error;}}return [2];});});}),_e.label=29;case 29:return [3,56];case 30:return N=e.as(gR),O=N.event,R=N.channelUrl,D=N.channelType,R&&D===Pw.OPEN?[4,this.getChannel(R,!0)]:[3,32];case 31:x=_e.sent(),this._dispatcher.dispatch(new pA({event:O,source:rA.EVENT_POLL_VOTED})),lk(function(){return cw(ve,void 0,void 0,function(){var e,t,n,r,i;return lw(this,function(s){try{for(e=dw(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollVoted&&n.onPollVoted(x,O);}catch(e){r={error:e};}finally{try{t&&!t.done&&(i=e.return)&&i.call(e);}finally{if(r)throw r.error;}}return [2];});});}),_e.label=32;case 32:return [3,56];case 33:if(!(L=e.as(sx).event).isOpenChannelEvent)return [3,55];switch(L.category){case $D.CHANNEL_ENTER:return [3,34];case $D.CHANNEL_EXIT:return [3,36];case $D.CHANNEL_OPERATOR_UPDATE:return [3,38];case $D.USER_CHANNEL_MUTE:case $D.USER_CHANNEL_UNMUTE:return [3,40];case $D.USER_CHANNEL_BAN:case $D.USER_CHANNEL_UNBAN:return [3,42];case $D.CHANNEL_FREEZE:case $D.CHANNEL_UNFREEZE:return [3,44];case $D.CHANNEL_DELETED:return [3,46];case $D.CHANNEL_PROP_CHANGED:return [3,49];case $D.CHANNEL_META_DATA_CHANGED:return [3,51];case $D.CHANNEL_META_COUNTERS_CHANGED:return [3,53];}return [3,55];case 34:return [4,this.getChannel(L.channelUrl,!0)];case 35:return M=_e.sent(),U=e.as(bx),j=U.participantCount,P=U.user,F=M._updateParticipantCount(j,L.ts),lk(function(){return cw(ve,void 0,void 0,function(){return lw(this,function(e){return this._openChannelHandlers.forEach(function(e){e.onUserEntered&&e.onUserEntered(M,P),F&&e.onChannelParticipantCountChanged&&e.onChannelParticipantCountChanged(M);}),[2];});});}),[3,55];case 36:return [4,this.getChannel(L.channelUrl,!0)];case 37:return q=_e.sent(),H=e.as(Ix),j=H.participantCount,V=H.user,G=q._updateParticipantCount(j,L.ts),lk(function(){return cw(ve,void 0,void 0,function(){return lw(this,function(e){return this._openChannelHandlers.forEach(function(e){e.onUserExited&&e.onUserExited(q,V),G&&e.onChannelParticipantCountChanged&&e.onChannelParticipantCountChanged(q);}),[2];});});}),[3,55];case 38:return [4,this.getChannel(L.channelUrl,!0)];case 39:return z=_e.sent(),B=e.as(ox).operators,z.operators=B,this.upsertChannelsToCache([z]),lk(function(){return cw(ve,void 0,void 0,function(){return lw(this,function(e){return this._openChannelHandlers.forEach(function(e){e.onOperatorUpdated&&e.onOperatorUpdated(z,B);}),[2];});});}),[3,55];case 40:return [4,this.getChannel(L.channelUrl,!0)];case 41:return K=_e.sent(),Q=L.category===$D.USER_CHANNEL_MUTE,W=e.as(Q?RO:xO).user,lk(function(){return cw(ve,void 0,void 0,function(){return lw(this,function(e){return this._openChannelHandlers.forEach(function(e){Q?e.onUserMuted&&e.onUserMuted(K,W):e.onUserUnmuted&&e.onUserUnmuted(K,W);}),[2];});});}),[3,55];case 42:return [4,this.getChannel(L.channelUrl,!0)];case 43:return Y=_e.sent(),Z=L.category===$D.USER_CHANNEL_BAN,X=e.as(Z?MO:PO).user,lk(function(){return cw(ve,void 0,void 0,function(){return lw(this,function(e){return this._openChannelHandlers.forEach(function(e){Z?e.onUserBanned&&e.onUserBanned(Y,X):e.onUserUnbanned&&e.onUserUnbanned(Y,X);}),[2];});});}),[3,55];case 44:return [4,this.getChannel(L.channelUrl,!0)];case 45:return J=_e.sent(),$=e.as(qO).freeze,J.isFrozen=$,this.upsertChannelsToCache([J]),lk(function(){return cw(ve,void 0,void 0,function(){return lw(this,function(e){return this._openChannelHandlers.forEach(function(e){$?e.onChannelFrozen&&e.onChannelFrozen(J):e.onChannelUnfrozen&&e.onChannelUnfrozen(J);}),[2];});});}),[3,55];case 46:return [4,this.getChannel(L.channelUrl,!0)];case 47:return ee=_e.sent(),[4,this.removeChannelsFromCache([ee.url])];case 48:return _e.sent(),lk(function(){return cw(ve,void 0,void 0,function(){return lw(this,function(e){return this._openChannelHandlers.forEach(function(e){e.onChannelDeleted&&e.onChannelDeleted(ee.url,ee.channelType);}),[2];});});}),[3,55];case 49:return [4,this.getChannelWithoutCache(L.channelUrl,!0)];case 50:return te=_e.sent(),lk(function(){return cw(ve,void 0,void 0,function(){return lw(this,function(e){return this._openChannelHandlers.forEach(function(e){e.onChannelChanged&&e.onChannelChanged(te);}),[2];});});}),[3,55];case 51:return [4,this.getChannel(L.channelUrl,!0)];case 52:return ne=_e.sent(),re=e.as(_O),ie=re.created,se=re.updated,oe=re.deleted,ie&&ne._upsertCachedMetaData(ie,L.ts),se&&ne._upsertCachedMetaData(se,L.ts),oe&&ne._removeFromCachedMetaData(oe,L.ts),lk(function(){return cw(ve,void 0,void 0,function(){return lw(this,function(e){return this._openChannelHandlers.forEach(function(e){ie&&e.onMetaDataCreated&&e.onMetaDataCreated(ne,ie),se&&e.onMetaDataUpdated&&e.onMetaDataUpdated(ne,se),oe&&e.onMetaDataDeleted&&e.onMetaDataDeleted(ne,oe);}),[2];});});}),[3,55];case 53:return [4,this.getChannel(L.channelUrl,!0)];case 54:return ae=_e.sent(),ue=e.as(kO),ce=ue.created,le=ue.updated,de=ue.deleted,lk(function(){return cw(ve,void 0,void 0,function(){return lw(this,function(e){return this._openChannelHandlers.forEach(function(e){ce&&e.onMetaCounterCreated&&e.onMetaCounterCreated(ae,ce),le&&e.onMetaCounterUpdated&&e.onMetaCounterUpdated(ae,le),de&&e.onMetaCounterDeleted&&e.onMetaCounterDeleted(ae,de);}),[2];});});}),[3,55];case 55:return [3,56];case 56:return [3,58];case 57:if(he=_e.sent(),ww(he))throw he;return [3,58];case 58:return [2];}});});},t.prototype.addHandler=function(e,t){this._openChannelHandlers.set(e,t);},t.prototype.removeHandler=function(e){this._openChannelHandlers.delete(e);},t.prototype.clearHandler=function(){this._openChannelHandlers.clear();},t.prototype.getChannel=function(e,t){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:Fk(kw("string",e)).throw(Iw.invalidParameters),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return (t=n.sent())?[2,t]:[3,4];case 3:return n.sent(),[3,4];case 4:return [4,this.getChannelWithoutCache(e)];case 5:return [2,n.sent()];}});});},t.prototype.getChannelWithoutCache=function(e,t){return void 0===t&&(t=!1),cw(this,void 0,void 0,function(){var n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(kw("string",e)).throw(Iw.invalidParameters),n=new yx({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(n)];case 1:return r=s.sent(),i=r.as(mx).channel,[4,this.upsertChannelsToCache([i])];case 2:return [2,s.sent()[0]];}});});},t.prototype.createChannel=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return t=uw(uw({},_x),e),Fk(function(e){return Ow("string",e.operatorUserIds,!0)&&(kw("string",e.coverUrlOrImage,!0)||Dw(e.coverUrlOrImage,!0))&&kw("string",e.name,!0)&&kw("string",e.data,!0)&&kw("string",e.customType,!0)&&(kw("string",e.channelUrl)&&/^\w+$/.test(e.channelUrl)||null===e.channelUrl||void 0===e.channelUrl)&&kw("boolean",e.isEphemeral,!0);}(t)).throw(Iw.invalidParameters),n=new gx(t),[4,this._requestQueue.send(n)];case 1:return r=s.sent(),i=r.as(mx).channel,this.upsertChannelsToCache([i]),[2,i];}});});},t;}(ux),Cx={name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0},kx=function(e){function t(t){var n=this,r=t.channelUrl,i=t.token,s=t.limit;return (n=e.call(this)||this).method=nI.GET,n.path="".concat(aI,"/").concat(encodeURIComponent(r),"/participants"),n.params={token:i,limit:s},n;}return aw(t,e),t;}(wI),Ax=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.participants=[];var i=n.next,s=n.participants;return r.token=i,r.participants=s.map(function(e){return new LN(t,e);}),r;}return aw(t,e),t;}(II),Nx=function(e){function t(t,n,r){return e.call(this,t,n,Pw.OPEN,r)||this;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this);},t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=tA.of(this._iid).requestQueue,t=new kx(uw(uw({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=o.sent(),r=n.as(Ax),i=r.participants,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return [2,[]];case 3:throw Iw.queryInProgress;case 4:return [3,6];case 5:throw Iw.invalidParameters;case 6:return [2];}});});},t;}(_A),Ox=function(e){function t(t){var n=this,r=t.channelUrl,i=t.coverUrlOrImage,s=t.name,o=t.data,a=t.customType,u=t.operatorUserIds;return (n=e.call(this)||this).method=nI.PUT,n.path="".concat(aI,"/").concat(encodeURIComponent(r)),n.params=eI(tI({cover_url:kw("string",i)?i:null,cover_file:Dw(i)?i:null,name:s,data:o,custom_type:a,operators:u})),n;}return aw(t,e),t;}(wI),Rx=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new xx(t,n),r;}return aw(t,e),t;}(II),Dx=function(e){function t(t){var n=this,r=t.channelUrl;return (n=e.call(this)||this).method=nI.DELETE,n.path="".concat(aI,"/").concat(encodeURIComponent(r)),n;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){return e.call(this,t,n)||this;},e);}(II);var xx=function(e){function t(t,n){var r,i=this;return (i=e.call(this,t,n)||this)._lastParticipantCountUpdated=0,i.participantCount=0,i.operators=[],i.channelType=Pw.OPEN,i.participantCount=null!==(r=n.participant_count)&&void 0!==r?r:0,i.operators=Array.isArray(n.operators)?n.operators.map(function(e){return new Hk(t,e);}):[],i;}return aw(t,e),t.payloadify=function(e){return eI(tI(uw(uw({},IR.payloadify(e)),{participant_count:e.participantCount,operators:e.operators.map(function(e){return Hk.payloadify(e);})})));},t.prototype.serialize=function(){return Uk(this);},t.prototype.isOperator=function(e){return e instanceof Hk?this.isOperator(e.userId):this.operators.some(function(t){return t.userId===e;});},t.prototype._updateParticipantCount=function(e,t){return t>this._lastParticipantCountUpdated&&(this.participantCount=e,this._lastParticipantCountUpdated=t,!0);},t.prototype.createParticipantListQuery=function(e){return new Nx(this._iid,this.url,e);},t.prototype.refresh=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return [4,Sx.of(this._iid).getChannelWithoutCache(this.url)];case 1:return [2,e.sent()];}});});},t.prototype.enter=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return e=tA.of(this._iid).requestQueue,t=new Ex({channelUrl:this.url}),[4,e.send(t)];case 1:return n=o.sent(),r=n.as(bx),i=r.participantCount,s=r.ts,this._updateParticipantCount(i,s),Sx.of(this._iid).setEnteredToCache(this),[2];}});});},t.prototype.exit=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return e=tA.of(this._iid).requestQueue,t=new wx({channelUrl:this.url}),[4,e.send(t)];case 1:return n=o.sent(),r=n.as(Ix),i=r.participantCount,s=r.ts,this._updateParticipantCount(i,s),Sx.of(this._iid).setExitedToCache(this),WD.of(this._iid).fileMessageQueue.cancel(this),[2];}});});},t.prototype.updateChannel=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return t=uw(uw({},Cx),e),Fk(function(e){return Ow("string",e.operatorUserIds,!0)&&(kw("string",e.coverUrlOrImage)||Dw(e.coverUrlOrImage)||null===e.coverUrlOrImage)&&kw("string",e.name,!0)&&kw("string",e.data,!0)&&kw("string",e.customType,!0);}(t)).throw(Iw.invalidParameters),n=tA.of(this._iid).requestQueue,r=new Ox(uw({channelUrl:this.url},t)),[4,n.send(r)];case 1:return i=o.sent(),s=i.as(Rx).channel,this._update(s),[4,Sx.of(this._iid).upsertChannelsToCache([s])];case 2:return o.sent(),[2,this];}});});},t.prototype.updateChannelWithOperatorUserIds=function(e,t,n,r,i){return cw(this,void 0,void 0,function(){var s;return lw(this,function(o){return s=uw(uw({},Cx),{name:e,coverUrlOrImage:t,data:n,operatorUserIds:r,customType:i}),[2,this.updateChannel(s)];});});},t.prototype.delete=function(){return cw(this,void 0,void 0,function(){var e,t;return lw(this,function(n){switch(n.label){case 0:return e=tA.of(this._iid).requestQueue,t=new Dx({channelUrl:this.url}),[4,e.send(t)];case 1:return n.sent(),[4,Sx.of(this._iid).removeChannelsFromCache([this.url])];case 2:return n.sent(),[2];}});});},t.prototype.sendUserMessage=function(t){return Fk(!t.isPinnedMessage).throw(Iw.notSupportedError),e.prototype.sendUserMessage.call(this,t);},t.prototype.sendFileMessage=function(t){return Fk(!t.isPinnedMessage).throw(Iw.notSupportedError),e.prototype.sendFileMessage.call(this,t);},t;}(IR),Lx=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach(function(e){n.hasOwnProperty(e)&&(n[e]=t[e]);}),n;}return aw(t,e),t;}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onUserEntered=UI,t.onUserExited=UI,t.onChannelParticipantCountChanged=UI,t.onPollUpdated=UI,t.onPollVoted=UI,t.onPollDeleted=UI,t;}return aw(t,e),t;}(function(){this.onUserMuted=UI,this.onUserUnmuted=UI,this.onUserBanned=UI,this.onUserUnbanned=UI,this.onChannelChanged=UI,this.onChannelDeleted=UI,this.onChannelFrozen=UI,this.onChannelUnfrozen=UI,this.onOperatorUpdated=UI,this.onChannelMemberCountChanged=UI,this.onMetaDataCreated=UI,this.onMetaDataUpdated=UI,this.onMetaDataDeleted=UI,this.onMetaCounterCreated=UI,this.onMetaCounterUpdated=UI,this.onMetaCounterDeleted=UI,this.onMessageReceived=UI,this.onMessageUpdated=UI,this.onMessageDeleted=UI,this.onMentionReceived=UI,this.onReactionUpdated=UI,this.onThreadInfoUpdated=UI;})),Mx=function(e){function t(t){var n=this,r=t.token,i=t.limit,s=t.nameKeyword,o=t.urlKeyword,a=t.customTypes,u=t.includeFrozen,c=t.includeMetaData;return (n=e.call(this)||this).method=nI.GET,n.path=aI,n.params=eI({token:r,limit:i,name_contains:s,url_contains:o,custom_types:a,show_frozen:u,show_metadata:c}),n;}return aw(t,e),t;}(wI),Ux=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.channels=[];var i=n.next,s=n.channels,o=n.ts;return r.token=i,s&&s.length>0&&(r.channels=s.map(function(e){return new xx(t,e);})),r.ts="number"==typeof o?o:null,r;}return aw(t,e),t;}(II),Px=function(e){function t(t,n){var r,i,s,o,a,u=this;return (u=e.call(this,t,n)||this).includeFrozen=!0,u.includeMetaData=!0,u.nameKeyword=null,u.urlKeyword=null,u.customTypes=null,u.includeFrozen=null===(r=n.includeFrozen)||void 0===r||r,u.includeMetaData=null===(i=n.includeMetaData)||void 0===i||i,u.nameKeyword=null!==(s=n.nameKeyword)&&void 0!==s?s:null,u.urlKeyword=null!==(o=n.urlKeyword)&&void 0!==o?o:null,u.customTypes=null!==(a=n.customTypes)&&void 0!==a?a:null,u;}return aw(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&kw("boolean",this.includeFrozen)&&kw("boolean",this.includeMetaData)&&kw("string",this.nameKeyword,!0)&&kw("string",this.urlKeyword,!0)&&Ow("string",this.customTypes,!0);},t.prototype.next=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,4]:this._hasNext?(this._isLoading=!0,e=tA.of(this._iid).requestQueue,t=new Mx(tI(uw(uw({},this),{token:this._token}))),[4,e.send(t)]):[3,3]:[3,6];case 1:return n=o.sent(),r=n.as(Ux),i=r.channels,s=r.token,this._token=s,this._hasNext=!!s,[4,Sx.of(this._iid).upsertChannelsToCache(i)];case 2:return o.sent(),this._isLoading=!1,[2,i];case 3:return [2,[]];case 4:throw Iw.queryInProgress;case 5:return [3,7];case 6:throw Iw.invalidParameters;case 7:return [2];}});});},t;}(vA),Fx=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="openChannel",t;}return aw(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,s=n.sessionManager,o=n.requestQueue,a=n.logger,u=n.onlineDetector,c=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:s,requestQueue:o,logger:a,onlineDetector:u,cacheContext:c}),this._manager=new Sx(t,{sdkState:r,dispatcher:i,requestQueue:o,logger:a,cacheContext:c,sessionManager:s});},t.prototype.createOpenChannelListQuery=function(e){return void 0===e&&(e={}),new Px(this._iid,e);},t.prototype.addOpenChannelHandler=function(e,t){this._manager.addHandler(e,t);},t.prototype.removeOpenChannelHandler=function(e){this._manager.removeHandler(e);},t.prototype.removeAllOpenChannelHandlers=function(){this._manager.clearHandler();},t.prototype.buildOpenChannelFromSerializedData=function(e){return this._manager.buildOpenChannelFromSerializedData(e);},t.prototype.getChannel=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this._manager.getChannel(e)];});});},t.prototype.getChannelWithoutCache=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this._manager.getChannelWithoutCache(e)];});});},t.prototype.createChannel=function(e){return void 0===e&&(e={}),cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this._manager.createChannel(e)];});});},t.prototype.createChannelWithOperatorUserIds=function(e,t,n,r,i){return cw(this,void 0,void 0,function(){var s;return lw(this,function(o){return (s=uw({},_x)).name=e,s.coverUrlOrImage=t,s.data=n,s.operatorUserIds=r,s.customType=i,[2,this._manager.createChannel(s)];});});},t;}(nA),qx="LIVE_EVENT_MANAGER",Hx=function(){function e(t){var n=this;u(this,e),this._liveEvents=[],this._ctx=t,this._ctx.sb.openChannel.addOpenChannelHandler(qx,new Lx({onUserBanned:function(e,t){if(t.userId===n._ctx.sb.currentUser.userId){var r=n._liveEvents.find(function(t){var n;return (null===(n=t.openChannel)||void 0===n?void 0:n.url)===e.url;});r&&r.onDisconnected();}}}));}var t,n,r;return l(e,[{key:"createLiveEvent",value:(r=a(i().mark(function e(t){var n,r,s,o,a;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Dy.createLiveEvent(null!==(n=t.hostType)&&void 0!==n?n:Fh.SINGLE_HOST,t.userIdsForHost?[].concat(b(t.userIdsForHost),[this.userId]):[this.userId],t.title,t.coverUrl,t.coverFile,t.customItems),e.next=3,this._ctx.commandRouter.send(r);case 3:return s=e.sent,o=s.payload.liveEvent,a=new sw({appId:this._ctx.appId,deviceManager:this._ctx.deviceManager,sender:this._ctx.commandRouter,sb:this._ctx.sb,userId:this.userId,info:o}),e.prev=6,e.next=9,a.fetchOpenChannel();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),lp.error("failed to fetch initial open channel");case 14:return this._liveEvents.push(a),e.abrupt("return",a);case 16:case"end":return e.stop();}},e,this,[[6,11]]);})),function(e){return r.apply(this,arguments);})},{key:"getLiveEvent",value:(n=a(i().mark(function e(t){var n,r,s;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Dy.createGetLiveEvent(t),e.next=3,this._ctx.commandRouter.send(n);case 3:return r=e.sent,s=r.payload.liveEvent,e.abrupt("return",this.deserializeLiveEvent(s));case 6:case"end":return e.stop();}},e,this);})),function(e){return n.apply(this,arguments);})},{key:"deserializeLiveEvent",value:(t=a(i().mark(function e(t){var n,r,s;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._liveEvents.findIndex(function(e){return e.liveEventId===t.liveEventId;}),!(n>-1)){e.next=15;break;}return (r=this._liveEvents[n]).upsert(t),e.prev=4,e.next=7,r.fetchOpenChannel();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),lp.error("failed to fetch initial open channel");case 12:return e.abrupt("return",r);case 15:return s=new sw({appId:this._ctx.appId,deviceManager:this._ctx.deviceManager,sender:this._ctx.commandRouter,sb:this._ctx.sb,userId:this.userId,info:t}),e.prev=16,e.next=19,s.fetchOpenChannel();case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(16),lp.error("failed to fetch initial open channel");case 24:return this._liveEvents.push(s),e.abrupt("return",s);case 26:case"end":return e.stop();}},e,this,[[4,9],[16,21]]);})),function(e){return t.apply(this,arguments);})},{key:"clear",value:function(){this._liveEvents=[],this._ctx.sb.openChannel.removeOpenChannelHandler(qx);var e,t=T(this._liveEvents);try{for(t.s();!(e=t.n()).done;){e.value.teardown();}}catch(e){t.e(e);}finally{t.f();}}}]),e;}(),jx=Kt,Vx=Re,Gx=ce,zx=Un,Bx=TypeError,Kx=function(e){return function(t,n,r,i){jx(n);var s=Vx(t),o=Gx(s),a=zx(s),u=e?a-1:0,c=e?-1:1;if(r<2)for(;;){if(u in o){i=o[u],u+=c;break;}if(u+=c,e?u<0:a<=u)throw Bx("Reduce of empty array with no initial value");}for(;e?u>=0:a>u;u+=c)u in o&&(i=n(i,o[u],u,s));return i;};},Qx={left:Kx(!1),right:Kx(!0)}.left;As({target:"Array",proto:!0,forced:!ia&&Qe>79&&Qe<83||!Uf("reduce")},{reduce:function(e){var t=arguments.length;return Qx(this,e,t,t>1?arguments[1]:void 0);}});var Wx=function(){function e(t,n){u(this,e),this.key=t,this.value=n;}return l(e,[{key:"toString",value:function(){return this.key;}},{key:"equals",value:function(e){return this.value.width===e.value.width&&this.value.height===e.value.height;}}]),e;}();d(Wx,"_720P",new Wx("_720P",{width:1280,height:720})),d(Wx,"_540P",new Wx("_540P",{width:960,height:540})),d(Wx,"_480P",new Wx("_480P",{width:848,height:480})),d(Wx,"_360P",new Wx("_360P",{width:640,height:360}));var Yx,Zx,Xx,Jx,$x,eL,tL=Wx._720P,nL=function(e){h(n,e);var t=E(n);function n(e,r){var i;return u(this,n),d(g(i=t.call(this)),"hasPermission",!1),i._streamManger=e,i.constraints=r,i;}return l(n,[{key:"stream",get:function(){return this._streamManger.stream;}},{key:"dispose",value:function(){var e;this.removeAllEventListeners(),null===(e=this.onDisposed)||void 0===e||e.call(this);}},{key:"streamChanged",value:function(e){this._dispatchEvent("streamChanged",e);}},{key:"audioOutputChanged",value:function(){this._dispatchEvent("audioOutputChanged");}}]),n;}(im),rL=function(e,t){t.audio&&0===e.getAudioTracks().length&&e.addTrack(function(){Yx||(Yx=new(window.AudioContext||window.webkitAudioContext)());var e=Yx;Zx=e.createOscillator();var t=e.createMediaStreamDestination(),n=e.createGain();return n.gain.setValueAtTime(0,e.currentTime),Zx.connect(n),n.connect(t),Zx.start(),$x=t.stream.getAudioTracks()[0],t.stream.getAudioTracks()[0];}()),t.video&&0===e.getVideoTracks().length&&e.addTrack(function(e){var t=e.width,n=e.height,r=e.frameRate;Xx||(Xx=document.createElement("canvas")),Xx.width=t,Xx.height=n,Xx.getContext("2d").fillRect(0,0,t,n),Jx||(Jx=setInterval(function(){Xx.getContext("2d").fillRect(0,0,t,n);},1e3));var i=Xx.captureStream(r);return eL=i.getVideoTracks()[0],i.getVideoTracks()[0];}(r(r({},tL.value),{},{frameRate:24})));};function iL(){$x&&$x.stop(),eL&&eL.stop(),$x=null,eL=null,Jx&&(clearInterval(Jx),Jx=null),Zx&&(Zx.onended=function(){Zx.disconnect(),Zx=null;},Zx.stop());}function sL(e){if(e){var t,n=T(e.getTracks());try{for(n.s();!(t=n.n()).done;){t.value.stop();}}catch(e){n.e(e);}finally{n.f();}}}var oL=function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10);},aL="safari"===function(){var e={browser:null,version:null};if("undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;var t=window.navigator;if(t.mozGetUserMedia)e.browser="firefox",e.version=oL(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===window.isSecureContext&&window.webkitRTCPeerConnection&&!window.RTCIceGatherer)e.browser="chrome",e.version=oL(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))e.browser="edge",e.version=oL(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else {if(!window.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return e.browser="Not a supported browser.",e;e.browser="safari",e.version=oL(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=window.RTCRtpTransceiver&&"currentDirection"in window.RTCRtpTransceiver.prototype;}return e;}().browser,uL=function(){function e(t){u(this,e),this._deviceManager=t,this._updateQueued=!1;}var t,n;return l(e,[{key:"_getUserMedia",value:(n=a(i().mark(function e(t){var n,r,s,o;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia(t);case 3:return n=e.sent,iL(),e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(0),lp.warning("Failed to first 'getUserMedia()' call Error[".concat(e.t0,"]")),r=new MediaStream(),e.prev=12,e.next=15,navigator.mediaDevices.getUserMedia({audio:t.audio});case 15:s=e.sent,r.addTrack(s.getAudioTracks()[0]),e.next=22;break;case 19:e.prev=19,e.t1=e.catch(12),lp.warning("Failed to get local audio stream Error[".concat(e.t1,"]"));case 22:return e.prev=22,e.next=25,navigator.mediaDevices.getUserMedia({video:t.video});case 25:o=e.sent,r.addTrack(o.getVideoTracks()[0]),e.next=32;break;case 29:e.prev=29,e.t2=e.catch(22),lp.warning("Failed to get local video stream Error[".concat(e.t2,"]"));case 32:return e.abrupt("return",r);case 33:case"end":return e.stop();}},e,null,[[0,8],[12,19],[22,29]]);})),function(e){return n.apply(this,arguments);})},{key:"updateStream",value:(t=a(i().mark(function e(){var t,n,r,s,o,a,u,c,l,d;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._updateAt){e.next=3;break;}return this._updateQueued=!0,e.abrupt("return");case 3:if(t=this._deviceManager.mediaAccesses.some(function(e){return e.constraints.audio;}),n=this._deviceManager.mediaAccesses.some(function(e){return e.constraints.video;}),t||n){e.next=9;break;}return sL(this.stream),iL(),e.abrupt("return");case 9:return this._updateAt=Date.now(),(r=this.stream)||(s=new MediaStream(),rL(s,{audio:t,video:n}),this.stream=s),aL&&sL(r),e.next=15,this._deviceManager.getMediaConstraints({usingAudio:t,usingVideo:n});case 15:return o=e.sent,e.next=18,this._getUserMedia(o);case 18:if((a=e.sent).getVideoTracks().length>0){u=T(this._deviceManager.mediaAccesses);try{for(u.s();!(c=u.n()).done;)c.value.hasPermission=!0;}catch(e){u.e(e);}finally{u.f();}}rL(a,{audio:t,video:n}),aL||sL(r),this.stream=a,l=T(this._deviceManager.mediaAccesses);try{for(l.s();!(d=l.n()).done;)d.value.streamChanged(this.stream);}catch(e){l.e(e);}finally{l.f();}delete this._updateAt,this._updateQueued?(this._updateQueued=!1,this.updateStream()):this._deviceManager.refreshMediaDevices({audio:t,video:n},!0);case 27:case"end":return e.stop();}},e,this);})),function(){return t.apply(this,arguments);})}]),e;}();function cL(e,t){return (null==e?void 0:e.deviceId)===(null==t?void 0:t.deviceId)&&(null==e?void 0:e.label)===(null==t?void 0:t.label)&&(null==e?void 0:e.groupId)===(null==t?void 0:t.groupId);}var lL,dL,hL,fL=function(){function e(){var t=this;u(this,e),this.mediaAccesses=[],this._availableMediaDevices={audioinput:[],audiooutput:[],videoinput:[]},this._currentMediaDevices={audioinput:void 0,audiooutput:void 0,videoinput:void 0},this._sendbirdCallListeners=new Map(),this._streamManager=new uL(this),navigator.mediaDevices.ondevicechange=function(){return t._onDeviceChanged();};}var t,n,s,o;return l(e,[{key:"_onDeviceChanged",value:function(){0!==this.mediaAccesses.length&&this.refreshMediaDevices({audio:this.mediaAccesses.some(function(e){return e.constraints.audio;}),video:this.mediaAccesses.some(function(e){return e.constraints.video;})});}},{key:"addSendBirdCallListener",value:function(e,t){this._sendbirdCallListeners.set(e,t);}},{key:"removeSendBirdCallListener",value:function(e){this._sendbirdCallListeners.delete(e);}},{key:"removeAllSendBirdCallListener",value:function(){this._sendbirdCallListeners.clear();}},{key:"getCurrentAudioInputDevice",value:function(){return this._currentMediaDevices.audioinput;}},{key:"getCurrentAudioOutputDevice",value:function(){return this._currentMediaDevices.audiooutput;}},{key:"getCurrentVideoInputDevice",value:function(){return this._currentMediaDevices.videoinput;}},{key:"getAvailableAudioInputDevices",value:function(){return this._availableMediaDevices.audioinput;}},{key:"getAvailableAudioOutputDevices",value:function(){return this._availableMediaDevices.audiooutput;}},{key:"getAvailableVideoInputDevices",value:function(){return this._availableMediaDevices.videoinput;}},{key:"updateStream",value:(o=a(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._streamManager.updateStream());case 1:case"end":return e.stop();}},e,this);})),function(){return o.apply(this,arguments);})},{key:"_registerMediaAccess",value:function(e){var t=this;this.mediaAccesses.push(e),e.onDisposed=function(){return t.stopMedia(e);};}},{key:"useMedia",value:function(e){if(e.audio||e.video){var t=new nL(this._streamManager,e);return this._registerMediaAccess(t),this.updateStream(),t;}lp.error(new Error("you should set true for at least 1 media type."));}},{key:"stopMedia",value:function(e){this.mediaAccesses.splice(this.mediaAccesses.indexOf(e),1),this.updateStream();}},{key:"fetchMediaDevices",value:(s=a(i().mark(function e(){var t;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return t=e.sent,e.abrupt("return",t.reduce(function(e,t){return e[t.kind].push(t),e;},{audioinput:[],audiooutput:[],videoinput:[]}));case 4:case"end":return e.stop();}},e);})),function(){return s.apply(this,arguments);})},{key:"getMediaConstraints",value:(n=a(i().mark(function e(t){var n,s,o,a,u,c,l,d;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.usingAudio,s=t.usingVideo,o={audio:!1,video:!1},e.next=4,this.fetchMediaDevices();case 4:return a=e.sent,u=a.audioinput,c=a.videoinput,n&&u.length&&(l=this.getCurrentAudioInputDevice(),o.audio={deviceId:null==l?void 0:l.deviceId}),s&&c.length&&(d=this.getCurrentVideoInputDevice(),o.video=r(r({deviceId:null==d?void 0:d.deviceId},tL.value),{},{frameRate:24})),e.abrupt("return",o);case 10:case"end":return e.stop();}},e,this);})),function(e){return n.apply(this,arguments);})},{key:"_updateCurrentMediaDevice",value:function(e,t){var n,r=this._availableMediaDevices[e],i=this._currentMediaDevices[e],s=r.find(function(e){return e.deviceId===(null==t?void 0:t.deviceId);});s||(lp.warning("Selected device is unavailable. fallback to default device."),s=(null!==(n=s)&&void 0!==n?n:r.length>0)?r[0]:null);return this._currentMediaDevices[e]=s,!cL(i,s);}},{key:"_onAudioOutputChanged",value:function(){var e,t=T(this.mediaAccesses);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.constraints.audio&&n.audioOutputChanged();}}catch(e){t.e(e);}finally{t.f();}}},{key:"selectDevice",value:function(e,t){t.kind===e?this._updateCurrentMediaDevice(e,t)&&("audioinput"!==e&&"videoinput"!==e||this.updateStream(),"audiooutput"===e&&this._onAudioOutputChanged()):lp.error(new Error("Tried to select invalid device of type"));}},{key:"_updateAvailableDevices",value:function(e,t){var n,r,i,s=this._currentMediaDevices[e],o=!function(e,t){if(e.length!==t.length)return !1;for(var n=0;n<t.length;n++)if(!cL(e[n],t[n]))return !1;return !0;}(this._availableMediaDevices[e],t);if(!o)return !1;var a;this._availableMediaDevices[e]=t,a=this._updateCurrentMediaDevice(e,s);var u,c=T(this._sendbirdCallListeners.values());try{for(c.s();!(u=c.n()).done;){var l=u.value,d=this._currentMediaDevices[e];switch(e){case"audioinput":null===(n=l.onAudioInputDeviceChanged)||void 0===n||n.call(l,d,t);break;case"audiooutput":null===(r=l.onAudioOutputDeviceChanged)||void 0===r||r.call(l,d,t);break;case"videoinput":null===(i=l.onVideoInputDeviceChanged)||void 0===i||i.call(l,d,t);}}}catch(e){c.e(e);}finally{c.f();}return a;}},{key:"refreshMediaDevices",value:(t=a(i().mark(function e(t){var n,r,s,o,a,u,c,l,d,h=arguments;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.audio,r=t.video,s=h.length>1&&void 0!==h[1]&&h[1],n||r){e.next=4;break;}throw new Error("at least one of the audio or video must be true");case 4:return e.next=6,this.fetchMediaDevices();case 6:o=e.sent,a=o.audioinput,u=o.audiooutput,c=o.videoinput,l=!1,d=!1,n&&(l=this._updateAvailableDevices("audioinput",a),d=this._updateAvailableDevices("audiooutput",u)),r&&(l=this._updateAvailableDevices("videoinput",c)||l),!s&&l&&this.updateStream(),d&&this._onAudioOutputChanged();case 16:case"end":return e.stop();}},e,this);})),function(e){return t.apply(this,arguments);})}]),e;}(),pL="1.1.1",vL=pL,_L=function(){function e(t){u(this,e),this._parse=t;}return l(e,[{key:"parseToJson",value:function(e){try{return JSON.parse(e);}catch(e){return {};}}},{key:"validate",value:function(e){var t=e.cmd,n=e.request_id,r=e.call_type;return !!(n||t||r);}},{key:"parseCommand",value:function(e){return e.error?{isValid:!0,error:{requestId:e.request_id,message:e.message,code:e.code}}:{isValid:!0,command:this._parse(e)};}},{key:"parse",value:function(e){var t=this.parseToJson(e);return this.validate(t)?this.parseCommand(t):{isValid:!1};}}]),e;}(),yL=function(e){h(n,e);var t=E(n);function n(e){var r,i;return u(this,n),(i=t.call(this))._ctx=e,i._ws=null,i._retryTimer=null,i._closed=!0,i._sessionKey=null,i._requestMap=new ZE(i._getTimeoutTime()),i._messageParser=new _L(i._ctx.parse),i._hostUrl=null!==(r=i._ctx.websocketHost)&&void 0!==r?r:"wss://ws-IDENTIFIER.calls.sendbird.com".replace("IDENTIFIER",i._ctx.appId),i;}return l(n,[{key:"connect",value:function(){var e=this;return new Promise(function(t,n){var r;e._sessionKey||n(new Error("tried to connect to websocket server without auth")),0===(null===(r=e._ws)||void 0===r?void 0:r.readyState)&&n(new Error("websocket is reconnecting already")),e._disconnect(),e._ws=e._createWebSocket(),e._closed=!1,e._ws.onopen=function(){e._onOpen(),t(null);},e._ws.onmessage=function(t){var n=e._messageParser.parse(t.data),r=n.isValid,i=n.error,s=n.command;r&&(i?e._processError(i):e.processCommand(s));},e._ws.onerror=function(t){return e._onError(t);},e._ws.onclose=function(){e._onClose(),n(new Error("websocket connection failed"));};});}},{key:"_processError",value:function(e){var t=e.requestId,n=e.code,r=e.message,i=this._requestMap.unregister(t);i&&(lp.debug(t,e.message),i.reject(new iw(n,{message:r})));}},{key:"processCommand",value:function(e){this._dispatchEvent("command",e);}},{key:"setSessionKey",value:function(e){this._sessionKey=e;}},{key:"clearSessionKey",value:function(){this._disconnect(),this._sessionKey=null;}},{key:"_disconnect",value:function(){this._ws&&(this._closed=!0,this._removeRetryTimer(),this._ws.onopen=null,this._ws.onmessage=null,this._ws.onerror=null,this._ws.onclose=null,this._ws.close(),this._requestMap.rejectAll(new Error("request failed due to websocket connection lost")),this._ws=null);}},{key:"isConnected",get:function(){return !!this._ws&&1===this._ws.readyState;}},{key:"_onOpen",value:function(){}},{key:"_onError",value:function(e){}},{key:"_onClose",value:function(){this.startToReconnect();}},{key:"_createWebSocket",value:function(){var e="/?sbcall_session_token=".concat(encodeURIComponent(this._sessionKey),"&sbcall_client_id=").concat(encodeURIComponent(this._ctx.clientId),"&sendbird=").concat(encodeURIComponent(this._getVersion()));return new WebSocket(this._getHost()+e);}},{key:"_getVersion",value:function(){return "JS,".concat(this._getOsVersion(),",").concat(vL);}},{key:"_getHost",value:function(){return this._hostUrl;}},{key:"startToReconnect",value:function(){this._closed||this._retryTimer||(this._retryTimer=setTimeout(this._reconnect.bind(this),this._getRetryTime()));}},{key:"_reconnect",value:function(){var e=this;this._removeRetryTimer();QE(new YE(5e3,1e3,void 0),function(){return e.connect();},{onError:function(e){lp.error("Fail reconnect WebSocket ErrorCode = ".concat(e.code));}});}},{key:"_removeRetryTimer",value:function(){this._retryTimer&&(clearTimeout(this._retryTimer),this._retryTimer=null);}},{key:"_getTimeoutTime",value:function(){return 6e4;}},{key:"_getRetryTime",value:function(){return 2e3;}},{key:"_getOsVersion",value:function(){return "undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"undefined";}}]),n;}(im),mL=function(){function e(t){var n;u(this,e),this._ctx=t,this._fetch=function(){var e;return (e=window).fetch.apply(e,arguments);},this._sessionKey=null,this._hostUrl=null!==(n=this._ctx.apiHost)&&void 0!==n?n:"https://api-IDENTIFIER.calls.sendbird.com".replace("IDENTIFIER",this._ctx.appId);}var t;return l(e,[{key:"setSessionKey",value:function(e){this._sessionKey=e;}},{key:"clearSessionKey",value:function(){this._sessionKey=null;}},{key:"send",value:(t=a(i().mark(function e(t){var n,s,o,a,u,c;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.getApiOption){e.next=2;break;}throw new Error("invalid api request ".concat(JSON.stringify(t)));case 2:if(!(n=t.getApiOption()).auth||this._sessionKey){e.next=5;break;}throw new Error("tried to call private api without auth");case 5:return s=r({},n.headers),n.body instanceof FormData||(s["Content-Type"]="application/json"),s.SendBird="JS,".concat(this._getOsVersion(),",").concat(vL),s["SBCall-Client-Id"]=this._ctx.clientId,this._sessionKey&&(s["SBCall-Session-Token"]=this._sessionKey),e.next=12,this._fetch("".concat(this._getHost()).concat(n.path),{method:n.method,body:n.body instanceof FormData?n.body:JSON.stringify(n.body),headers:s});case 12:return o=e.sent,e.next=15,o.text();case 15:a=e.sent,u=null,e.prev=17,u=JSON.parse(a),e.next=24;break;case 21:throw e.prev=21,e.t0=e.catch(17),new iw(tw.ERR_MALFORMED_DATA);case 24:if(o.ok){e.next=34;break;}if(!u.error){e.next=29;break;}throw new iw(u.code,{message:u.message});case 29:if(500!==o.status){e.next=31;break;}throw new iw(tw.INTERNAL_SERVER_ERROR);case 31:if(!(o.status>=300&&o.status<400)){e.next=33;break;}throw new iw(tw.ERR_MALFORMED_DATA);case 33:throw new iw(tw.ERR_REQUEST_FAILED);case 34:if(e.prev=34,!(c=this._ctx.parseResponse(t,u))){e.next=38;break;}return e.abrupt("return",c);case 38:e.next=43;break;case 40:return e.prev=40,e.t1=e.catch(34),e.abrupt("return",u);case 43:return e.abrupt("return",u);case 44:case"end":return e.stop();}},e,this,[[17,21],[34,40]]);})),function(e){return t.apply(this,arguments);})},{key:"_getHost",value:function(){return this._hostUrl;}},{key:"_getOsVersion",value:function(){return "undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"undefined";}}]),e;}(),gL=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="poll",t;}return aw(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,s=n.sessionManager,o=n.requestQueue,a=n.logger,u=n.onlineDetector,c=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:s,requestQueue:o,logger:a,onlineDetector:u,cacheContext:c}),this._manager=new xA(t,{sdkState:r,dispatcher:i,sessionManager:s,requestQueue:o,logger:a,onlineDetector:u,cacheContext:c});},t.prototype.create=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){return t=uw(uw({},CA),e),Fk(kA(t)).throw(Iw.invalidParameters),[2,this._manager.create(t)];});});},t.prototype.get=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){return t=uw(uw({},OA),e),Fk(RA(t)).throw(Iw.invalidParameters),[2,this._manager.get(t)];});});},t.prototype.getOption=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){return t=uw(uw({},AA),e),Fk(NA(t)).throw(Iw.invalidParameters),[2,this._manager.getOption(t)];});});},t.prototype.buildPollFromSerializedData=function(e){return this._manager.buildPollFromSerializedData(e);},t;}(nA);!function(e){e.LATEST_LAST_MESSAGE="latest_last_message",e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",e.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical";}(lL||(lL={})),function(e){e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",e.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical";}(dL||(dL={})),function(e){e.CREATED_AT="created_at",e.SCHEDULED_AT="scheduled_at";}(hL||(hL={}));var EL,bL=function(e){switch(e){case lL.LATEST_LAST_MESSAGE:return ["-lastMessageUpdatedAt","-createdAt","syncIndex"];case lL.CHRONOLOGICAL:return ["-createdAt","syncIndex"];case lL.CHANNEL_NAME_ALPHABETICAL:return ["name"];default:return ["-lastMessageUpdatedAt","-createdAt","syncIndex"];}},wL=function(e){function t(t){var n=t.message,r=e.call(this)||this;return r.message=n,r;}return aw(t,e),t;}($w),IL={},TL=function(){function e(e,t){var n=t.localCacheEnabled,r=t.dispatcher,i=t.sdkState,s=t.logger,o=this;this._iid=e,IL[e]=this,this._localCacheEnabled=n,this._isProcessingAutoResend=!1,this._autoResendQueue=[],this._dispatcher=r,this._logger=s,this._sdkState=i,this._localCacheEnabled&&r.on(function(e){if(e instanceof JC)switch(e.stateType){case KC.CONNECTED:o._isProcessingAutoResend||o.processAutoResendRegisteredPendingMessages().then(function(){return o._processNextAutoResend();});break;case KC.INTERNAL_DISCONNECTED:case KC.EXTERNAL_DISCONNECTED:o._isProcessingAutoResend=!1;}});}return e.of=function(e){return IL[e];},e.prototype.processNonAutoResendRegisteredPendingMessages=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s;return lw(this,function(o){switch(o.label){case 0:return [4,this._fetchAllCachedPendingMessages()];case 1:e=o.sent();try{for(t=dw(e),n=t.next();!n.done;n=t.next())0===(r=n.value).errorCode&&(this._logger.debug("cached pending message is not auto-resend registered. changing its sending status to failed: ",r.reqId),r.sendingStatus=Kw.FAILED,r.errorCode=pw.ACK_TIMEOUT,this._dispatcher.dispatch(new cA({messages:[r],source:rA.LOCAL_MESSAGE_FAILED})));}catch(e){i={error:e};}finally{try{n&&!n.done&&(s=t.return)&&s.call(t);}finally{if(i)throw i.error;}}return [2];}});});},e.prototype.processAutoResendRegisteredPendingMessages=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o,a;return lw(this,function(u){switch(u.label){case 0:return [4,this._fetchAllCachedPendingMessages()];case 1:e=u.sent();try{for(t=dw(e),n=t.next();!n.done;n=t.next())(r=n.value).errorCode&&Rw(r.errorCode)&&(i=new Date().getTime(),s=r.createdAt+2592e5,i<=s?this._autoResendQueue.map(function(e){return e.reqId;}).indexOf(r.reqId)<0&&this._autoResendQueue.push(r):(this._logger.debug("auto-resend registered pending messaged expired. expiration date: ",new Date(s).toLocaleString()),r.sendingStatus=Kw.FAILED,this._dispatcher.dispatch(new cA({messages:[r],source:rA.LOCAL_MESSAGE_FAILED}))));}catch(e){o={error:e};}finally{try{n&&!n.done&&(a=t.return)&&a.call(t);}finally{if(o)throw o.error;}}return [2];}});});},e.prototype.completeCurrentAndProcessNextAutoResend=function(e){if(this._localCacheEnabled&&(e.sendingStatus===Kw.SUCCEEDED||e.sendingStatus===Kw.FAILED&&!Rw(e.errorCode))){var t=this.indexOf(e);t>=0&&this._autoResendQueue.splice(t,1),0===t&&this._processNextAutoResend();}},e.prototype._fetchAllCachedPendingMessages=function(){return cw(this,void 0,void 0,function(){var e,t;return lw(this,function(n){switch(n.label){case 0:return (e=VD.of(this._iid))?[4,e.fetch({sendingStatus:Kw.PENDING,backward:!0})]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t=[],n.label=3;case 3:return [2,t];}});});},e.prototype.indexOf=function(e){return this._autoResendQueue.length>0?this._autoResendQueue.map(function(e){return e.reqId;}).indexOf(e.reqId):-1;},e.prototype._isNotInQueue=function(e){return -1===this._autoResendQueue.map(function(e){return e.reqId;}).indexOf(e.reqId);},e.prototype._processNextAutoResend=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){if(this._localCacheEnabled&&"foreground"===this._sdkState.appState)try{this._autoResendQueue.length>0?(this._isProcessingAutoResend||(this._logger.debug("auto-resend queue started."),this._isProcessingAutoResend=!0),e=this._autoResendQueue[0],this._dispatcher.dispatch(new wL({message:e})),this._logger.debug("processing auto-resend for message request id: ",e.reqId)):(this._logger.debug("auto-resend queue finished."),this._isProcessingAutoResend=!1);}catch(e){this._logger.warn("process auto-resend error: ",e),this._isProcessingAutoResend=!1;}return [2];});});},e;}();!function(e){e[e.USER_BLOCK=20001]="USER_BLOCK",e[e.USER_UNBLOCK=2e4]="USER_UNBLOCK",e[e.FRIEND_DISCOVERED=20900]="FRIEND_DISCOVERED";}(EL||(EL={}));var SL=function(){function e(e){this.category=e.cat,this.data=e.data;}return e.getDataAsUserBlockEvent=function(e,t){var n=t.data,r=n.blocker,i=n.blockee;return {blocker:new Hk(e,r),blockee:new Hk(e,i)};},e.getDataAsFriendDiscoveredEvent=function(e,t){var n=t.data.friend_discoveries;return {friendDiscoveries:Array.isArray(n)?n.map(function(t){return new Hk(e,t);}):[]};},e;}(),CL=function(e){function t(t,n){var r=n.userId,i=e.call(this)||this;return i._iid=t,i.userId=r,i;}return aw(t,e),t;}($w),kL=function(e){function t(){return e.call(this)||this;}return aw(t,e),t;}($w),AL=function(e){function t(t,n,r){var i=e.call(this,t,"USEV",r)||this;return i.event=new SL(r),i;}return aw(t,e),t;}(MI),NL=function(e){this.key=e.key,this.url=e.url;},OL=function(e){this.id=e.id,this.name=e.name,this.url=e.url,this.emojis=e.emojis?e.emojis.map(function(e){return new NL(e);}):[];},RL=function(e){this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map(function(e){return new OL(e);}):[];},DL={profileImage:void 0,profileUrl:void 0,nickname:void 0},xL=function(e){return {v2:e.commitSchema([{collectionName:"GroupChannel",keyName:"url",index:[bL(lL.LATEST_LAST_MESSAGE),bL(lL.CHRONOLOGICAL),bL(lL.CHANNEL_NAME_ALPHABETICAL)]},{collectionName:ER,keyName:"messageId",index:[qD(MD.CHANNEL_LATEST),qD(MD.NEWEST_CHILD_MESSAGE)]},{collectionName:HD,keyName:"reqId",index:[qD(MD.CHANNEL_LATEST),qD(MD.NEWEST_CHILD_MESSAGE)]},{collectionName:"Poll",keyName:"pollId"}]),v3:e.commitSchema([{collectionName:"FeedChannel",keyName:"url",index:[["-lastMessageUpdatedAt","-createdAt","syncIndex"]]}])};},LL=function(e,t){return function(n,r){switch(n){case 1:e.clear().then(function(){t.clear().then(function(){xL(e).v2.then(function(){return r();}).catch(function(e){return r(e);});}).catch(function(e){return r(e);});}).catch(function(e){return r(e);});break;case 2:xL(e).v3.then(function(){return r();}).catch(function(e){return r(e);});break;default:r();}};},ML=function(){return "undefined"!=typeof document?document.visibilityState:"visible";},UL=function(e){function t(t){var n=t.getVisibilityState,r=void 0===n?ML:n,i=t.initialState,s=void 0===i?"visible":i,o=t.isEnabled,a=void 0===o||o,u=t.pauseCheckDelay,c=void 0===u?3e4:u,l=e.call(this)||this;return l._pauseCheckDelay=3e4,l._currentState="visible",l._getVisibilityState=r,l._pauseCheckDelay=c,l._currentState=s,l._isEnabled=a,l._boundToggleState=l._toggleState.bind(l),l;}return aw(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAvailable",{get:function(){return "undefined"!=typeof window&&!!window.addEventListener&&!!window.removeEventListener;},enumerable:!1,configurable:!0}),t.prototype._toggleState=function(){var e=this,t=this._getVisibilityState();"hidden"!==t?"hidden"===this._currentState&&(this._pauseDelayTimer&&(clearTimeout(this._pauseDelayTimer),this._pauseDelayTimer=void 0),this.dispatch("resume")):"hidden"!==this._currentState&&(this._pauseDelayTimer=setTimeout(function(){e._pauseDelayTimer=void 0,e.dispatch("pause");},this._pauseCheckDelay)),this._currentState=t;},t.prototype.start=function(){this._isEnabled&&this.isAvailable&&(this._boundToggleState=this._toggleState.bind(this),window.addEventListener("visibilitychange",this._boundToggleState,{capture:!0}));},t.prototype.stop=function(){this._isEnabled&&this.isAvailable&&this._boundToggleState&&window.removeEventListener("visibilitychange",this._boundToggleState,{capture:!0});},t;}(Xw),PL=function(){function e(e){var t=e.logger,n=e.connectionDelegate,r=void 0===n?null:n,i=this;this._onlineWorker=function(){var e;return null===(e=i.connectionDelegate)||void 0===e?void 0:e.reconnect();},this._offlineWorker=function(){var e;return null===(e=i.connectionDelegate)||void 0===e?void 0:e.disconnect();},this.unsubscribes=[],this._onlineListener=function(e){if(i.isAvailableOnWeb)return window.addEventListener("online",e),function(){return window.removeEventListener("online",e,!1);};},this._offlineListener=function(e){if(i.isAvailableOnWeb)return window.addEventListener("offline",e),function(){return window.removeEventListener("offline",e,!1);};},this.logger=t,r&&(this.connectionDelegate=r);}return Object.defineProperty(e.prototype,"isAvailableOnWeb",{get:function(){return "undefined"!=typeof window&&!!window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&void 0!==navigator.onLine;},enumerable:!1,configurable:!0}),e.prototype.setOnlineListener=function(e){Boolean(e)&&"function"==typeof e&&(this._onlineListener=e);},e.prototype.setOfflineListener=function(e){Boolean(e)&&"function"==typeof e&&(this._offlineListener=e);},e.prototype.start=function(){this.unsubscribes=[this._onlineListener(this._onlineWorker),this._offlineListener(this._offlineWorker)];},e.prototype.stop=function(){var e=this;this.unsubscribes.forEach(function(t){try{null==t||t();}catch(t){e.logger.warn(t.message);}}),this.unsubscribes=[];},e.prototype.isOnline=function(){return cw(this,void 0,void 0,function(){return lw(this,function(e){return this.isAvailableOnWeb?[2,navigator.onLine]:[2,new Promise(function(e){fetch("https://www.google.com",{method:nI.GET,mode:"no-cors"}).then(function(){return e(!0);}).catch(function(){return e(!1);});})];});});},e;}(),FL=function(e){function t(t){var n=t.userId,r=t.nickname,i=t.profileUrl,s=t.profileImage,o=t.preferredLanguages,a=e.call(this)||this;return a.method=nI.PUT,a.path="".concat(iI,"/").concat(encodeURIComponent(n)),a.params=eI(tI({nickname:r,profile_url:i,profile_file:s,preferred_languages:o})),a;}return aw(t,e),t;}(wI),qL=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.user=new Hk(t,uw({},n)),r;}return aw(t,e),t;}(II),HL=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=nI.POST,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push/apns"),i.params={apns_device_token:r,always_push:!0},i;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.type=n.type?gw[n.type.toLowerCase()]:gw.UNKNOWN,r.user=new Hk(t,n.user),r;},e);}(II);var jL=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=nI.POST,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push/gcm"),i.params={gcm_reg_token:r,always_push:!0},i;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.type=n.type?gw[n.type.toLowerCase()]:gw.UNKNOWN,r.user=new Hk(t,n.user),r;},e);}(II);var VL=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=nI.DELETE,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push/apns/").concat(encodeURIComponent(r)),i;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.user=new Hk(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r;},e);}(II);var GL=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=nI.DELETE,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push/gcm/").concat(encodeURIComponent(r)),i;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.user=new Hk(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r;},e);}(II);var zL=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=nI.DELETE,r.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push/apns"),r;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){var r=e.call(this,t,n)||this;return r.type=n.type?gw[n.type.toLowerCase()]:gw.UNKNOWN,r.user=new Hk(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r;},e);}(II);var BL=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=nI.DELETE,r.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push/gcm"),r;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){var r=e.call(this,t,n)||this;return r.type=n.type?gw[n.type.toLowerCase()]:gw.UNKNOWN,r.user=new Hk(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r;},e);}(II);var KL=function(e){function t(t){var n=t.userId,r=t.type,i=t.token,s=t.ts,o=e.call(this)||this;return o.method=nI.GET,o.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push/").concat(encodeURIComponent(r),"/device_tokens"),o.params={created_ts:s,token:i},o;}return aw(t,e),t;}(wI),QL=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTokens={type:n.type?gw[n.type.toLowerCase()]:gw.UNKNOWN,deviceTokens:n.device_tokens,hasMore:n.has_more,token:n.token},r;}return aw(t,e),t;}(II),WL=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=nI.GET,r.path="".concat(iI,"/").concat(encodeURIComponent(n),"/channel_invitation_preference"),r;}return aw(t,e),t;}(wI),YL=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoAccept=n.auto_accept,r;}return aw(t,e),t;}(II),ZL=function(e){function t(t){var n=t.userId,r=t.willAutoAccept,i=e.call(this)||this;return i.method=nI.PUT,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/channel_invitation_preference"),i.params={auto_accept:r},i;}return aw(t,e),t;}(wI),XL=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoAccept=n.auto_accept,r;}return aw(t,e),t;}(II),JL=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=nI.GET,r.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push_preference"),r;}return aw(t,e),t;}(wI),$L=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.preference={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone},r;}return aw(t,e),t;}(II),eM=function(e){function t(t){var n=t.userId,r=t.doNotDisturbOn,i=t.startHour,s=t.startMin,o=t.endHour,a=t.endMin,u=t.timezone,c=e.call(this)||this;return c.method=nI.PUT,c.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push_preference"),c.params={do_not_disturb:r,start_hour:i,start_min:s,end_hour:o,end_min:a,timezone:u},c;}return aw(t,e),t;}(wI),tM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.preference={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone},r;}return aw(t,e),t;}(II),nM=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=nI.GET,r.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push_preference"),r;}return aw(t,e),t;}(wI),rM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.snoozePeriod={isSnoozeOn:n.snooze_enabled},"number"==typeof n.snooze_start_ts&&(r.snoozePeriod.startTs=n.snooze_start_ts),"number"==typeof n.snooze_end_ts&&(r.snoozePeriod.endTs=n.snooze_end_ts),r;}return aw(t,e),t;}(II),iM=function(e){function t(t){var n=t.userId,r=t.snoozeOn,i=t.startTs,s=t.endTs,o=e.call(this)||this;return o.method=nI.PUT,o.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push_preference"),o.params={snooze_enabled:r,snooze_start_ts:i,snooze_end_ts:s},o;}return aw(t,e),t;}(wI),sM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.snoozePeriod={isSnoozeOn:n.snooze_enabled},"number"==typeof n.snooze_start_ts&&(r.snoozePeriod.startTs=n.snooze_start_ts),"number"==typeof n.snooze_end_ts&&(r.snoozePeriod.endTs=n.snooze_end_ts),r;}return aw(t,e),t;}(II),oM=function(e){function t(t){var n=t.userId,r=t.blockedUserId,i=e.call(this)||this;return i.method=nI.POST,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/block"),i.params={target_id:r},i;}return aw(t,e),t;}(wI);!function(e){aw(function(t,n){var r=e.call(this,t,n)||this;return r.user=new Hk(t,n),r;},e);}(II);var aM=function(e){function t(t){var n=t.userId,r=t.unblockedUserId,i=e.call(this)||this;return i.method=nI.DELETE,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/block/").concat(encodeURIComponent(r)),i;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var uM=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=nI.GET,r.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push_preference"),r;}return aw(t,e),t;}(wI),cM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r;}return aw(t,e),t;}(II),lM=function(e){function t(t){var n=t.userId,r=t.pushTriggerOption,i=e.call(this)||this;return i.method=nI.PUT,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push_preference"),i.params={push_trigger_option:r},i;}return aw(t,e),t;}(wI),dM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r;}return aw(t,e),t;}(II),hM=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=nI.GET,r.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push/template"),r;}return aw(t,e),t;}(wI),fM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.name=n.name,r;}return aw(t,e),t;}(II),pM=function(e){function t(t){var n=t.userId,r=t.templateName,i=e.call(this)||this;return i.method=nI.PUT,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/push/template"),i.params={name:r},i;}return aw(t,e),t;}(wI),vM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.name=n.name,r;}return aw(t,e),t;}(II),_M=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=nI.GET,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/friends/changelogs"),i.params={token:r},i;}return aw(t,e),t;}(wI),yM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.changelogs={addedUsers:n.added.map(function(e){return new Hk(t,e);}),updatedUsers:n.updated.map(function(e){return new Hk(t,e);}),deletedUserIds:n.deleted,hasMore:n.has_more,token:n.next},r;}return aw(t,e),t;}(II),mM=function(e){function t(t){var n=t.userId,r=t.discoveries,i=e.call(this)||this;return i.method=nI.PUT,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/friend_discoveries"),i.params={friend_discoveries:r.map(function(e){return {friend_discovery_key:e.friendDiscoveryKey,friend_name:e.friendName};})},i;}return aw(t,e),t;}(wI),gM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.friendDiscoveryRequestId=n.friend_discovery_request_id,r;}return aw(t,e),t;}(II),EM=function(e){function t(t){var n=t.userId,r=t.discoveryKeys,i=e.call(this)||this;return i.method=nI.DELETE,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/friend_discoveries"),i.params={friend_discovery_keys:r},i;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var bM=function(e){function t(t){var n=t.userId,r=t.userIds,i=e.call(this)||this;return i.method=nI.POST,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/friends"),i.params={user_ids:r},i;}return aw(t,e),t;}(wI),wM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map(function(e){return new Hk(t,e);}),r;}return aw(t,e),t;}(II),IM=function(e){function t(t){var n=t.userId,r=t.userIds,i=e.call(this)||this;return i.method=nI.DELETE,i.path="".concat(iI,"/").concat(encodeURIComponent(n),"/friends"),i.params={user_ids:r},i;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var TM=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=nI.GET,r.path="".concat(iI,"/").concat(n,"/allow_friend_discovery"),r.params={},r;}return aw(t,e),t;}(wI),SM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.allowFriendDiscovery=n.allow_friend_discovery,r;}return aw(t,e),t;}(II),CM=function(e){function t(t){var n=t.userId,r=t.allowFriendDiscovery,i=e.call(this)||this;return i.method=nI.PUT,i.path="".concat(iI,"/").concat(n,"/allow_friend_discovery"),i.params={allow_friend_discovery:r},i;}return aw(t,e),t;}(wI);!function(e){aw(function(){return null!==e&&e.apply(this,arguments)||this;},e);}(II);var kM,AM=function(e){function t(){var t=e.call(this)||this;return t.method=nI.GET,t.path=hI,t;}return aw(t,e),t;}(wI),NM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emojiContainer=new RL(n),r;}return aw(t,e),t;}(II),OM=function(e){function t(t){var n=t.categoryId,r=e.call(this)||this;return r.method=nI.GET,r.path="".concat(hI,"/").concat(n),r;}return aw(t,e),t;}(wI),RM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emojiCategory=new OL(n),r;}return aw(t,e),t;}(II),DM=function(e){function t(t){var n=t.key,r=e.call(this)||this;return r.method=nI.GET,r.path="".concat(dI,"/").concat(n),r;}return aw(t,e),t;}(wI),xM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emoji=new NL(n),r;}return aw(t,e),t;}(II),LM=function(e){function t(){var t=e.call(this)||this;return t.method=nI.GET,t.path="".concat(pI),t;}return aw(t,e),t;}(wI),MM=function(e){function t(t,n){var r,i=this,s=null!=n?n:{};return (i=e.call(this,t,n)||this).uikitConfiguration={string:JSON.stringify(s),json:s},i.updatedAt=null!==(r=null==n?void 0:n.updated_at)&&void 0!==r?r:0,i;}return aw(t,e),t;}(II),UM=function(){function e(e,t,n){var r=this;this._storeInitialized=!1,this._iid=e,this.options=t;var i=tA.of(e),s=i.sdkState,o=i.cacheContext,a=i.dispatcher,u=i.sessionManager,c=i.requestQueue,l=i.logger,d=i.userEventHandlers,h=i.appStateToggleEnabled;this._onlineDetector=new PL({logger:l,connectionDelegate:{reconnect:function(){var t=tA.of(e),n=t.sdkState,r=t.connectionManager,i=t.sessionManager;i.auth.hasSession?"foreground"===n.appState&&r.resetAndReconnect():r.connect(i.auth.authToken);},disconnect:function(){tA.of(e).connectionManager.disconnect();}}});var f=new TL(e,{localCacheEnabled:o.localCacheEnabled,dispatcher:a,sdkState:s,logger:l});n.forEach(function(t){t.init(e,{sdkState:s,cacheContext:o,dispatcher:a,sessionManager:u,requestQueue:c,logger:l,onlineDetector:r._onlineDetector}),r[t.name]=t;}),this._appStateChangeDetector=new UL({isEnabled:h}),this._appStateChangeDetector.on("resume",function(){l.debug("the page resumes from freeze"),r.setForegroundState();}).on("pause",function(){l.debug("the page freezes"),r.setBackgroundState();}),a.on(function(t){var n;if(t instanceof JC)t.stateType===KC.CONNECTED&&f.processNonAutoResendRegisteredPendingMessages();else if(t instanceof MI){if("USEV"===t.code){var i=t.as(AL).event;if(i.category===EL.FRIEND_DISCOVERED){var a=SL.getDataAsFriendDiscoveredEvent(e,i).friendDiscoveries;lk(function(){return cw(r,void 0,void 0,function(){return lw(this,function(e){return [2,d.forEach(function(e){e.onFriendsDiscovered&&e.onFriendsDiscovered(a);})];});});});}}}else if(t instanceof YC){var u=tA.of(r._iid).subscribedUnreadMessageCount,c=!1,h=t.ts;if("number"==typeof h&&h>u.ts){if(u.all!==t.all&&(c=!0),u.all=t.all>=0?t.all:0,t.customTypes)for(var p in t.customTypes)u.customTypes[p]!==t.customTypes[p]&&(c=!0),u.customTypes[p]=t.customTypes[p];c=c&&u.ts>0,u.ts=h;}c&&lk(function(){return cw(r,void 0,void 0,function(){return lw(this,function(e){return [2,d.forEach(function(e){e.onTotalUnreadMessageCountChanged&&e.onTotalUnreadMessageCountChanged({groupChannelCount:u.all,feedChannelCount:u.feed,customTypeUnreadCount:u.customTypes}),e.onTotalUnreadMessageCountUpdated&&e.onTotalUnreadMessageCountUpdated(u.all,u.customTypes);})];});});});}else t instanceof jk?(o.preference.set(r._getUserProfileCacheKey(s.userId),Vk.payloadify(t.userProfile)),(null===(n=t.userProfile.appInfo.notificationInfo)||void 0===n?void 0:n.isEnabled)&&o.preference.set(function(e){return "sendbird@".concat(e,"/changelog_include_chat_notifications");}(r.appId),{value:!0})):t instanceof SI&&t.error&&(t.error.isSessionRevokedError||t.error.isUserAuthDeactivedError||t.error.isUserAuthDeletedOrNotFoundError)&&(l.debug("session revoked."),r.disconnect());});}return e.init=function(t){var n=t.appId,r=t.appVersion,i=t.modules,s=void 0===i?[]:i,o=t.options,a=void 0===o?new xw():o,u=t.debugMode,c=void 0!==u&&u,l=t.customApiHost,d=t.customWebSocketHost,h=t.newInstance,f=void 0!==h&&h,p=t.logLevel,v=t.localCacheEnabled,_=void 0!==v&&v,y=t.localCacheConfig,m=void 0===y?new Qw():y,g=t.localCacheEncryption,E=t.useAsyncStorageStore,b=void 0===E?null:E,w=t.appStateToggleEnabled,I=void 0===w||w;if(!kM||f){var T="su-".concat(Yw()),S=null!=g?g:{encrypt:function(e){return e;},decrypt:function(e){return e;}},C=new OD({encryption:S});c||(C=RI()?b?new LD({AsyncStorage:b,encryption:S}):new OD({encryption:S}):new xD({encryption:S})),new tA(T,{appId:n,appVersion:r,options:a,apiHost:null!=l?l:"https://api-".concat(n,".sendbird.com"),websocketHost:null!=d?d:"wss://ws-".concat(n,".sendbird.com"),store:C,encryption:S,logLevel:p,localCacheEnabled:_,localCacheConfig:m,debugMode:c,appStateToggleEnabled:I});var k=[new nx(),new gL()],A=new e(T,a,fw(fw([],hw(s),!1),hw(k),!1));return kM||(kM=A),A;}return kM;},Object.defineProperty(e,"instance",{get:function(){return kM;},enumerable:!1,configurable:!0}),Object.defineProperty(e,"version",{get:function(){return vw;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appId",{get:function(){return tA.of(this._iid).sdkState.appId;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appInfo",{get:function(){var e=tA.of(this._iid).appInfo;return null!=e?e:null;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appVersion",{get:function(){var e;return null!==(e=tA.of(this._iid).sdkState.appVersion)&&void 0!==e?e:"";},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugMode",{get:function(){return !!tA.of(this._iid).debugMode;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logLevel",{get:function(){return tA.of(this._iid).logger.level;},set:function(e){tA.of(this._iid).logger.level=e;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCacheEnabled",{get:function(){return tA.of(this._iid).cacheContext.localCacheEnabled;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCacheConfig",{get:function(){var e=tA.of(this._iid).cacheContext;return e.localCacheEnabled?e.localCacheConfig:null;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ekey",{get:function(){return tA.of(this._iid).sessionManager.ekey;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentUser",{get:function(){var e;return null!==(e=tA.of(this._iid).sessionManager.currentUser)&&void 0!==e?e:null;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionState",{get:function(){var e=tA.of(this._iid).connectionManager;return e.isConnected?zC.OPEN:e.isConnecting?zC.CONNECTING:zC.CLOSED;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastConnectedAt",{get:function(){var e=tA.of(this._iid),t=e.connectedAt;return e.connectionManager.isConnected?t:0;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fcmPushToken",{get:function(){var e;return null!==(e=this._fcmPushToken)&&void 0!==e?e:null;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apnsPushToken",{get:function(){var e;return null!==(e=this._apnsPushToken)&&void 0!==e?e:null;},enumerable:!1,configurable:!0}),e.prototype._getNestDBVersion=function(){return 3;},e.prototype._getCurrentPreferenceVersion=function(){return 1;},e.prototype._getPreferenceCacheKey=function(e){return "sendbird@".concat(this.appId,"/").concat(e,".pref");},e.prototype._getUserProfileCacheKey=function(e){return "sendbird@".concat(this.appId,"/").concat(e,".profile");},e.prototype.getMemoryStoreForDebugging=function(){var e=tA.of(this._iid),t=e.debugMode,n=e.cacheContext;if(t)return n.store instanceof OD?n.store:null;throw Iw.debugModeRequired;},e.prototype.addExtension=function(e,t){var n=tA.of(this._iid).sdkState;["sb_uikit","sb_syncmanager","device-os-platform"].indexOf(e)>-1&&n.extensions&&(n.extensions[e]=t);},e.prototype.addSendbirdExtensions=function(e,t,n){var r,i,s=tA.of(this._iid),o=s.logger,a=s.sdkState,u=new RegExp("^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$");if(0===e.length)return o.debug("sb.addSendbirdExtensions() has failed because the given sendbirdExtensions is empty."),!1;if(e.find(function(e){return !u.test(e.version);}))return o.debug("sb.addSendbirdExtensions() has failed because the given version did not satisfy the SemVer specification."),!1;if(n)try{for(var c=dw(Object.entries(n)),l=c.next();!l.done;l=c.next()){var d=hw(l.value,2),h=d[0],f=d[1];if(/&|=/.test(h)||/&|=/.test(f))return o.debug("sb.addSendbirdExtensions() has failed because the given customData includes at least one invalid character: = or &."),!1;}}catch(e){r={error:e};}finally{try{l&&!l.done&&(i=c.return)&&i.call(c);}finally{if(r)throw r.error;}}return a.sendbirdRuntimeEnvironment={sendbirdExtensions:e,deviceOS:t,customData:n},!0;},e.prototype.setOnlineListener=function(e){this._onlineDetector.setOnlineListener(e);},e.prototype.setOfflineListener=function(e){this._onlineDetector.setOfflineListener(e);},e.prototype._safeInitializeStore=function(e){return cw(this,void 0,void 0,function(){var t;return lw(this,function(n){switch(n.label){case 0:t=tA.of(this._iid).cacheContext,n.label=1;case 1:return n.trys.push([1,3,,5]),[4,t.store.init(e)];case 2:return n.sent(),this._storeInitialized=!0,[3,5];case 3:return n.sent(),t.replaceStore(new OD()),[4,this._safeInitializeStore(e)];case 4:return n.sent(),[3,5];case 5:return [2];}});});},e.prototype.initializeCache=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c;return lw(this,function(l){switch(l.label){case 0:return t=tA.of(this._iid),n=t.sdkState,r=t.cacheContext,i=t.connectionManager,s=t.dispatcher,o=t.logger,n.userId&&n.userId===e?[3,10]:[4,i.logout()];case 1:if(l.sent(),a="sendbird@".concat(n.appId,"/").concat(e,".db"),!r.localCacheEnabled)return [3,8];l.label=2;case 2:return l.trys.push([2,5,,7]),r.nestdb&&r.nestdb.state!==DD.CLOSED&&r.nestdb.name===a?[3,4]:((u=r.nestdb=new UD({name:"sendbird@".concat(n.appId,"/").concat(e,".db"),version:this._getNestDBVersion(),store:r.store})).on("upgrade",LL(u,r.store)),u.on("storeReplaced",function(e){r.replaceStore(e),r.localCacheEnabled=!1,u.on("upgrade",LL(u,r.store));}),[4,u.open()]);case 3:l.sent(),this._storeInitialized=!0,s.dispatch(new CL(this._iid,{userId:e})),l.label=4;case 4:return n.userId=e,[3,7];case 5:return c=l.sent(),o.warn("Nest DB Open Failed. ",c),[4,this._safeInitializeStore(a)];case 6:throw l.sent(),n.userId=e,Iw.databaseError;case 7:return [3,10];case 8:return [4,this._safeInitializeStore(a)];case 9:l.sent(),n.userId=e,l.label=10;case 10:return [2];}});});},e.prototype.getCacheDataSize=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return (e=tA.of(this._iid).cacheContext).localCacheEnabled&&e.nestdb?[4,e.nestdb.estimateUsage()]:[3,2];case 1:return [2,t.sent()];case 2:return [2,0];}});});},e.prototype.clearCachedData=function(){return cw(this,void 0,void 0,function(){var e;return lw(this,function(t){switch(t.label){case 0:return (e=tA.of(this._iid).cacheContext).localCacheEnabled&&e.nestdb?[4,e.nestdb.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this._storeInitialized?[4,e.preference.clear()]:[3,4];case 3:t.sent(),t.label=4;case 4:return [2];}});});},e.prototype.clearCachedMessages=function(e){return cw(this,void 0,void 0,function(){var t,n,r=this;return lw(this,function(i){switch(i.label){case 0:return Fk(Ow("string",e)).throw(Iw.invalidParameters),t=zD.of(this._iid),n=VD.of(this._iid),t&&n?[4,Promise.all(e.map(function(e){return cw(r,void 0,void 0,function(){return lw(this,function(r){switch(r.label){case 0:return [4,t.removeMessagesOfChannel(e)];case 1:return r.sent(),[4,n.removeMessagesOfChannel(e)];case 2:return r.sent(),[2];}});});}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return [2];}});});},e.prototype.connect=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i,s,o,a,u;return lw(this,function(c){switch(c.label){case 0:Fk(kw("string",e)&&kw("string",t,!0)).throw(Iw.invalidParameters),n=tA.of(this._iid),r=n.sdkState,i=n.cacheContext,s=n.connectionManager,o=n.statLogCollector,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.initializeCache(e)];case 2:return c.sent(),tA.of(this._iid).dispatcher.dispatch(new kL()),[3,4];case 3:return c.sent(),a=tA.of(this._iid).logger,i.localCacheEnabled=!1,a.warn("Cache initialization failed - cache is not available."),[3,4];case 4:return [4,i.preference.init(this._getPreferenceCacheKey(e),this._getCurrentPreferenceVersion())];case 5:return c.sent(),[4,i.preference.get(this._getUserProfileCacheKey(e))];case 6:return (u=c.sent())&&new Vk(this._iid,u).apply(),[4,o.init("sendbird@".concat(r.appId,"/").concat(e,".statlog"))];case 7:c.sent(),c.label=8;case 8:return c.trys.push([8,,10,11]),[4,s.connect(t)];case 9:return c.sent(),[3,11];case 10:return this._onlineDetector.start(),this._appStateChangeDetector.start(),[7];case 11:return [2,this.currentUser];}});});},e.prototype.reconnect=function(){var e=tA.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.sessionManager.auth.hasSession;return r&&(this._appStateChangeDetector.start(),this._onlineDetector.start(),t.resetAndReconnect().then(function(){n.appState="foreground";}).catch(function(){})),r;},e.prototype.disconnect=function(){return cw(this,void 0,void 0,function(){var e,t,n;return lw(this,function(r){switch(r.label){case 0:return e=tA.of(this._iid),t=e.connectionManager,n=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),n.cancelAll(),[4,t.logout()];case 1:return r.sent(),[4,this.clearCachedData()];case 2:return r.sent(),[2];}});});},e.prototype.disconnectWebSocket=function(){return cw(this,void 0,void 0,function(){var e,t,n;return lw(this,function(r){switch(r.label){case 0:return e=tA.of(this._iid),t=e.connectionManager,n=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),n.cancelAll(),[4,t.disconnectWebSocket()];case 1:return r.sent(),[2];}});});},e.prototype.setBackgroundState=function(){var e=tA.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.logger;"foreground"===n.appState&&(n.appState="background",r.debug("going background state"),t.background());},e.prototype.setForegroundState=function(){var e=tA.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.logger;"background"===n.appState&&(n.appState="foreground",r.debug("going foreground state"),t.resetAndReconnect());},e.prototype.setSessionHandler=function(e){Fk(e instanceof SR).throw(Iw.invalidParameters),tA.of(this._iid).sessionManager.handler=e;},e.prototype.addUserEventHandler=function(e,t){Fk(kw("string",e)&&t instanceof CR).throw(Iw.invalidParameters),tA.of(this._iid).userEventHandlers.set(e,t);},e.prototype.removeUserEventHandler=function(e){tA.of(this._iid).userEventHandlers.delete(e);},e.prototype.removeAllUserEventHandler=function(){tA.of(this._iid).userEventHandlers.clear();},e.prototype.addConnectionHandler=function(e,t){Fk(kw("string",e)&&t instanceof TR).throw(Iw.invalidParameters),tA.of(this._iid).connectionHandlers.set(e,t);},e.prototype.removeConnectionHandler=function(e){tA.of(this._iid).connectionHandlers.delete(e);},e.prototype.removeAllConnectionHandler=function(){tA.of(this._iid).connectionHandlers.clear();},e.prototype.createApplicationUserListQuery=function(e){return void 0===e&&(e={}),new NR(this._iid,e);},e.prototype.createBlockedUserListQuery=function(e){return void 0===e&&(e={}),new DR(this._iid,e);},e.prototype.createFriendListQuery=function(e){return void 0===e&&(e={}),new MR(this._iid,e);},e.prototype.createMessageSearchQuery=function(e){return new ex(this._iid,e);},e.prototype.createPollListQuery=function(e){return new UA(this._iid,uw({},e));},e.prototype.createPollVoterListQuery=function(e){return new qA(this._iid,uw({},e));},e.prototype.buildUserFromSerializedData=function(e){var t=Pk(e);return new Hk(this._iid,Hk.payloadify(t));},e.prototype.updateCurrentUserInfo=function(e){return void 0===e&&(e={}),cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a;return lw(this,function(u){switch(u.label){case 0:return t=uw(uw({},DL),e),Fk(function(e){return Dw(e.profileImage,!0)&&kw("string",e.profileUrl,!0)&&kw("string",e.nickname,!0);}(t)).throw(Iw.invalidParameters),this.currentUser?(n=tA.of(this._iid),r=n.sdkState,i=n.requestQueue,s=new FL(uw({userId:r.userId},t)),[4,i.send(s)]):[3,2];case 1:return o=u.sent(),a=o.as(qL).user,this.currentUser&&(t.nickname&&(this.currentUser.nickname=a.nickname),(t.profileUrl||t.profileImage)&&(this.currentUser.plainProfileUrl=a.profileUrl)),[2,a];case 2:throw Iw.connectionRequired;}});});},e.prototype.updateCurrentUserInfoWithPreferredLanguages=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return Fk(Ow("string",e)).throw(Iw.invalidParameters),this.currentUser?(t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new FL({userId:n.userId,preferredLanguages:e}),[4,r.send(i)]):[3,2];case 1:return s=a.sent(),o=s.as(qL).user,this.currentUser&&(this.currentUser.preferredLanguages=o.preferredLanguages),[2,o];case 2:throw Iw.connectionRequired;}});});},e.prototype.registerFCMPushTokenForCurrentUser=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o=this;return lw(this,function(a){switch(a.label){case 0:if(Fk(kw("string",e)).throw(Iw.invalidParameters),!this.currentUser)return [3,6];a.label=1;case 1:return a.trys.push([1,4,,5]),t=tA.of(this._iid),n=t.sessionManager,r=t.sdkState,i=t.requestQueue,n.hasDeviceToken(gw.FCM,e)?[2,yw.SUCCESS]:(s=new jL({userId:r.userId,token:e}),[4,i.send(s)]);case 2:return a.sent(),[4,dk(function(){return cw(o,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return n.setDeviceToken(gw.FCM,e),[4,n.saveDeviceToken()];case 1:return t.sent(),[2];}});});})];case 3:return a.sent(),this._fcmPushToken="",[2,yw.SUCCESS];case 4:return a.sent(),[2,yw.ERROR];case 5:return [3,7];case 6:return this._fcmPushToken=e,[2,yw.PENDING];case 7:return [2];}});});},e.prototype.unregisterFCMPushTokenForCurrentUser=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a=this;return lw(this,function(u){switch(u.label){case 0:if(Fk(kw("string",e)).throw(Iw.invalidParameters),!this.currentUser)return [3,6];u.label=1;case 1:return u.trys.push([1,4,,5]),t=tA.of(this._iid),n=t.sessionManager,r=t.sdkState,i=t.requestQueue,s=new GL({userId:r.userId,token:e}),[4,i.send(s)];case 2:return o=u.sent().lastDeletedAt,[4,dk(function(){return cw(a,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return n.unsetDeviceToken(gw.FCM,e),n.setDeviceTokenDeletedAt(o),[4,n.saveDeviceToken()];case 1:return t.sent(),[2];}});});})];case 3:return u.sent(),this._fcmPushToken="",[2,yw.SUCCESS];case 4:return u.sent(),[2,yw.ERROR];case 5:return [3,7];case 6:return this._fcmPushToken=e,[2,yw.PENDING];case 7:return [2];}});});},e.prototype.unregisterFCMPushTokenAllForCurrentUser=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o=this;return lw(this,function(a){switch(a.label){case 0:return this.currentUser?(e=tA.of(this._iid),t=e.sessionManager,n=e.sdkState,r=e.requestQueue,i=new BL({userId:n.userId}),[4,r.send(i)]):[3,3];case 1:return s=a.sent().lastDeletedAt,[4,dk(function(){return cw(o,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return t.unsetDeviceTokens(gw.FCM),t.setDeviceTokenDeletedAt(s),[4,t.saveDeviceToken()];case 1:return e.sent(),[2];}});});})];case 2:a.sent(),a.label=3;case 3:return [2];}});});},e.prototype.registerAPNSPushTokenForCurrentUser=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o=this;return lw(this,function(a){switch(a.label){case 0:if(Fk(kw("string",e)).throw(Iw.invalidParameters),!this.currentUser)return [3,6];a.label=1;case 1:return a.trys.push([1,4,,5]),t=tA.of(this._iid),n=t.sessionManager,r=t.sdkState,i=t.requestQueue,n.hasDeviceToken(gw.APNS,e)?[2,yw.SUCCESS]:(s=new HL({userId:r.userId,token:e}),[4,i.send(s)]);case 2:return a.sent(),[4,dk(function(){return cw(o,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return n.setDeviceToken(gw.APNS,e),[4,n.saveDeviceToken()];case 1:return t.sent(),[2];}});});})];case 3:return a.sent(),this._apnsPushToken="",[2,yw.SUCCESS];case 4:return a.sent(),[2,yw.ERROR];case 5:return [3,7];case 6:return this._apnsPushToken=e,[2,yw.PENDING];case 7:return [2];}});});},e.prototype.unregisterAPNSPushTokenForCurrentUser=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i,s,o,a=this;return lw(this,function(u){switch(u.label){case 0:if(Fk(kw("string",e)).throw(Iw.invalidParameters),!this.currentUser)return [3,6];u.label=1;case 1:return u.trys.push([1,4,,5]),t=tA.of(this._iid),n=t.sessionManager,r=t.sdkState,i=t.requestQueue,s=new VL({userId:r.userId,token:e}),[4,i.send(s)];case 2:return o=u.sent().lastDeletedAt,[4,dk(function(){return cw(a,void 0,void 0,function(){return lw(this,function(t){switch(t.label){case 0:return n.unsetDeviceToken(gw.APNS,e),n.setDeviceTokenDeletedAt(o),[4,n.saveDeviceToken()];case 1:return t.sent(),[2];}});});})];case 3:return u.sent(),this._apnsPushToken="",[2,yw.SUCCESS];case 4:return u.sent(),[2,yw.ERROR];case 5:return [3,7];case 6:return this._apnsPushToken=e,[2,yw.PENDING];case 7:return [2];}});});},e.prototype.unregisterAPNSPushTokenAllForCurrentUser=function(){return cw(this,void 0,void 0,function(){var e,t,n,r,i,s,o=this;return lw(this,function(a){switch(a.label){case 0:return this.currentUser?(e=tA.of(this._iid),t=e.sessionManager,n=e.sdkState,r=e.requestQueue,i=new zL({userId:n.userId}),[4,r.send(i)]):[3,3];case 1:return s=a.sent().lastDeletedAt,[4,dk(function(){return cw(o,void 0,void 0,function(){return lw(this,function(e){switch(e.label){case 0:return t.unsetDeviceTokens(gw.APNS),t.setDeviceTokenDeletedAt(s),[4,t.saveDeviceToken()];case 1:return e.sent(),[2];}});});})];case 2:a.sent(),a.label=3;case 3:return [2];}});});},e.prototype.getChannelInvitationPreference=function(){return cw(this,void 0,void 0,function(){var e,t,n,r;return lw(this,function(i){switch(i.label){case 0:return e=tA.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new WL({userId:t.userId}),[4,n.send(r)];case 1:return [2,{autoAccept:i.sent().as(YL).autoAccept}];}});});},e.prototype.setChannelInvitationPreference=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(kw("boolean",e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new ZL({userId:n.userId,willAutoAccept:e}),[4,r.send(i)];case 1:return [2,{autoAccept:s.sent().as(XL).autoAccept}];}});});},e.prototype.getDoNotDisturb=function(){return cw(this,void 0,void 0,function(){var e,t,n,r;return lw(this,function(i){switch(i.label){case 0:return e=tA.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new JL({userId:t.userId}),[4,n.send(r)];case 1:return [2,i.sent().as($L).preference];}});});},e.prototype.setDoNotDisturb=function(e,t,n,r,i,s){return void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===s&&(s=""),cw(this,void 0,void 0,function(){var o,a,u,c;return lw(this,function(l){switch(l.label){case 0:return Fk(kw("boolean",e)&&kw("number",t)&&kw("number",n)&&kw("number",r)&&kw("number",i)&&kw("string",s)).throw(Iw.invalidParameters),o=tA.of(this._iid),a=o.sdkState,u=o.requestQueue,c=new eM({userId:a.userId,doNotDisturbOn:e,startHour:t,startMin:n,endHour:r,endMin:i,timezone:s}),[4,u.send(c)];case 1:return [2,l.sent().as(tM).preference];}});});},e.prototype.getSnoozePeriod=function(){return cw(this,void 0,void 0,function(){var e,t,n,r;return lw(this,function(i){switch(i.label){case 0:return e=tA.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new nM({userId:t.userId}),[4,n.send(r)];case 1:return [2,i.sent().as(rM).snoozePeriod];}});});},e.prototype.setSnoozePeriod=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),cw(this,void 0,void 0,function(){var r,i,s,o;return lw(this,function(a){switch(a.label){case 0:return Fk(kw("boolean",e)&&kw("number",t)&&kw("number",n)).throw(Iw.invalidParameters),r=tA.of(this._iid),i=r.sdkState,s=r.requestQueue,o=new iM({userId:i.userId,snoozeOn:e,startTs:t,endTs:n}),[4,s.send(o)];case 1:return [2,a.sent().as(sM).snoozePeriod];}});});},e.prototype.getMyPushTokensByToken=function(e,t){return cw(this,void 0,void 0,function(){var n,r,i,s,o,a,u,c,l,d,h,f;return lw(this,function(p){switch(p.label){case 0:return Fk(kw("string",e)&&Aw(gw,t)).throw(Iw.invalidParameters),n=tA.of(this._iid),r=n.sdkState,i=n.requestQueue,s=n.sessionManager,o=new KL({userId:r.userId,type:t,token:e}),[4,i.send(o)];case 1:a=p.sent(),u=a.as(QL).pushTokens;try{for(c=dw(u.deviceTokens),l=c.next();!l.done;l=c.next())d=l.value,s.setDeviceToken(u.type,d);}catch(e){h={error:e};}finally{try{l&&!l.done&&(f=c.return)&&f.call(c);}finally{if(h)throw h.error;}}return [4,s.saveDeviceToken()];case 2:return p.sent(),[2,u];}});});},e.prototype.getPushTriggerOption=function(){return cw(this,void 0,void 0,function(){var e,t,n,r;return lw(this,function(i){switch(i.label){case 0:return e=tA.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new uM({userId:t.userId}),[4,n.send(r)];case 1:return [2,i.sent().as(cM).pushTriggerOption];}});});},e.prototype.setPushTriggerOption=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(Aw(mw,e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new lM({userId:n.userId,pushTriggerOption:e}),[4,r.send(i)];case 1:return [2,s.sent().as(dM).pushTriggerOption];}});});},e.prototype.getPushTemplate=function(){return cw(this,void 0,void 0,function(){var e,t,n,r;return lw(this,function(i){switch(i.label){case 0:return e=tA.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new hM({userId:t.userId}),[4,n.send(r)];case 1:return [2,i.sent().as(fM).name];}});});},e.prototype.setPushTemplate=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(Aw(Ew,e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new pM({userId:n.userId,templateName:e}),[4,r.send(i)];case 1:return [2,s.sent().as(vM).name];}});});},e.prototype.blockUser=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(e instanceof Hk||kw("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new oM({userId:n.userId,blockedUserId:e instanceof Hk?e.userId:e}),[4,r.send(i)];case 1:return s.sent(),[2];}});});},e.prototype.blockUserWithUserId=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this.blockUser(e)];});});},e.prototype.unblockUser=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(e instanceof Hk||kw("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new aM({userId:n.userId,unblockedUserId:e instanceof Hk?e.userId:e}),[4,r.send(i)];case 1:return s.sent(),[2];}});});},e.prototype.unblockUserWithUserId=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this.unblockUser(e)];});});},e.prototype.getFriendChangeLogsByToken=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(kw("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new _M({userId:n.userId,token:e}),[4,r.send(i)];case 1:return [2,s.sent().as(yM).changelogs];}});});},e.prototype.getAllowFriendDiscovery=function(){return cw(this,void 0,void 0,function(){var e,t,n,r;return lw(this,function(i){switch(i.label){case 0:return e=tA.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new TM({userId:t.userId}),[4,n.send(r)];case 1:return [2,i.sent().as(SM).allowFriendDiscovery];}});});},e.prototype.setAllowFriendDiscovery=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(kw("boolean",e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new CM({userId:n.userId,allowFriendDiscovery:e}),[4,r.send(i)];case 1:return s.sent(),[2,e];}});});},e.prototype.uploadFriendDiscoveries=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new mM({userId:n.userId,discoveries:e}),[4,r.send(i)];case 1:return [2,s.sent().as(gM).friendDiscoveryRequestId];}});});},e.prototype.deleteFriendDiscovery=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this.deleteFriendDiscoveries([e])];});});},e.prototype.deleteFriendDiscoveries=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(Ow("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new EM({userId:n.userId,discoveryKeys:e}),[4,r.send(i)];case 1:return s.sent(),[2];}});});},e.prototype.addFriends=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(Ow("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new bM({userId:n.userId,userIds:e}),[4,r.send(i)];case 1:return [2,s.sent().as(wM).users];}});});},e.prototype.deleteFriend=function(e){return cw(this,void 0,void 0,function(){return lw(this,function(t){return [2,this.deleteFriends([e])];});});},e.prototype.deleteFriends=function(e){return cw(this,void 0,void 0,function(){var t,n,r,i;return lw(this,function(s){switch(s.label){case 0:return Fk(Ow("string",e)).throw(Iw.invalidParameters),t=tA.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new IM({userId:n.userId,userIds:e}),[4,r.send(i)];case 1:return s.sent(),[2];}});});},e.prototype.getAllEmoji=function(){return cw(this,void 0,void 0,function(){var e,t;return lw(this,function(n){switch(n.label){case 0:return e=tA.of(this._iid).requestQueue,t=new AM(),[4,e.send(t)];case 1:return [2,n.sent().as(NM).emojiContainer];}});});},e.prototype.getEmojiCategory=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return t=tA.of(this._iid).requestQueue,n=new OM({categoryId:e}),[4,t.send(n)];case 1:return [2,r.sent().as(RM).emojiCategory];}});});},e.prototype.getEmoji=function(e){return cw(this,void 0,void 0,function(){var t,n;return lw(this,function(r){switch(r.label){case 0:return t=tA.of(this._iid).requestQueue,n=new DM({key:e}),[4,t.send(n)];case 1:return [2,r.sent().as(xM).emoji];}});});},e.prototype.getUIKitConfiguration=function(){return cw(this,void 0,void 0,function(){var e,t,n;return lw(this,function(r){switch(r.label){case 0:return e=tA.of(this._iid),Fk(e.hasExtension("sb_uikit")).throw(Iw.notSupportedError),t=e.requestQueue,n=new LM(),[4,t.send(n)];case 1:return [2,r.sent().as(MM).uikitConfiguration];}});});},e;}(),PM=function(e){h(c,e);var t,n,s,o=E(c);function c(e){var t;return u(this,c),(t=o.call(this))._ctx=e,t.wsClient=new yL(r(r({},e),{},{parse:function(e){return Dy.parse(e);}})),t.apiClient=new mL(r(r({},e),{},{parseResponse:function(e,t){return Dy.parseResponse(e,t);}})),t._unsubscriber=t.wsClient.on("command",function(e){t._dispatchEvent("command",e);}),t;}return l(c,[{key:"connectWs",value:function(){return this.wsClient.connect();}},{key:"reconnectWs",value:function(){return this.wsClient.startToReconnect();}},{key:"sendAPI",value:function(e){return this.apiClient.send(e);}},{key:"send",value:(s=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sendAPI(t));case 1:case"end":return e.stop();}},e,this);})),function(e){return s.apply(this,arguments);})},{key:"sendWithRetry",value:(n=a(i().mark(function e(t){var n,r,s,o,a,u,c=this,l=arguments;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:new WE(),r=l.length>2&&void 0!==l[2]?l[2]:{count:0,deferred:new KE()},s=r.deferred,o=r.count,e.prev=3,e.next=6,this.send(t);case 6:a=e.sent,s.resolve(a),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),(u=n.calcTimeout(o))>0?setTimeout(function(){c.sendWithRetry(t,n,{count:o+1,deferred:s});},u):s.reject(e.t0);case 14:return e.abrupt("return",s.promise);case 15:case"end":return e.stop();}},e,this,[[3,10]]);})),function(e){return n.apply(this,arguments);})},{key:"_setSessionKey",value:function(e){this.apiClient.setSessionKey(e),this.wsClient.setSessionKey(e);}},{key:"authenticate",value:(t=a(i().mark(function e(t){var n,r,s,o,a;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.userId,r=t.accessToken,e.prev=1,s={product:kI.LIVE,version:pL,platform:AI.JS},this._ctx.sb.addSendbirdExtensions([s],{platform:NI.WEB}),e.next=6,this._ctx.sb.connect(n,r);case 6:return o=Dy.createAuth(this._ctx.appId,n,r),e.next=9,this.send(o);case 9:a=e.sent,this._setSessionKey(a.sbcall_session_token),this._ctx.liveEventManager.userId=a.user.user_id,e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(1),lp.error("failed to authenticate user ".concat(n)),e.t0;case 18:case"end":return e.stop();}},e,this,[[1,14]]);})),function(e){return t.apply(this,arguments);})},{key:"deauthenticate",value:function(){this.apiClient.clearSessionKey(),this.wsClient.clearSessionKey();}}]),c;}(im),FM=kn,qM=xd,HM=fe,jM=RangeError,VM=ee,GM=Ln,zM=xd,BM=function(e){var t=qM(HM(this)),n="",r=FM(e);if(r<0||r==1/0)throw jM("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n;},KM=fe,QM=VM(BM),WM=VM("".slice),YM=Math.ceil,ZM=function(e){return function(t,n,r){var i,s,o=zM(KM(t)),a=GM(n),u=o.length,c=void 0===r?" ":zM(r);return a<=u||""==c?o:((s=QM(c,YM((i=a-u)/c.length))).length>i&&(s=WM(s,0,i)),e?o+s:s+o);};},XM={start:ZM(!1),end:ZM(!0)},JM=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(He),$M=XM.start;As({target:"String",proto:!0,forced:JM},{padStart:function(e){return $M(this,e,arguments.length>1?arguments[1]:void 0);}});var eU,tU={VERBOSE:{level:-1,name:up.VERBOSE,public:!1},DEBUG:{level:1,name:up.DEBUG,public:!1},INFO:{level:2,name:up.INFO,public:!0},WARNING:{level:3,name:up.WARNING,public:!0},ERROR:{level:4,name:up.ERROR,public:!0},NONE:{level:100,name:up.NONE,public:!0}},nU=function(e){h(n,e);var t=E(n);function n(e){return u(this,n),t.call(this,e);}return l(n,[{key:"_getLogType",value:function(e){switch(e){case up.ERROR:return "error";case up.WARNING:return "warn";default:return "log";}}},{key:"_getTimeString",value:function(e){var t=e.getFullYear().toString().padStart(2,"0"),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),i=e.getHours().toString().padStart(2,"0"),s=e.getMinutes().toString().padStart(2,"0"),o=e.getSeconds().toString().padStart(2,"0"),a=e.getMilliseconds().toString().padStart(2,"0");return "[".concat(t,".").concat(n,".").concat(r," ").concat(i,":").concat(s,":").concat(o,":").concat(a,"]");}},{key:"_permit",value:function(e){var t=this._getLogType(e),n=new Date();if(this._enabledFor(e)&&console&&console[t]){for(var r,i="".concat(this._getTimeString(n)," [").concat(e,"]"),s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];(r=console)[t].apply(r,[i].concat(o));}}}]),n;}(function(){function e(t){u(this,e),this.level=t||up.NONE;}return l(e,[{key:"setLoggerLevel",value:function(e){var t;return null!==(t=tU[e])&&void 0!==t&&t.public&&(this.level=e),this.level;}},{key:"_enabledFor",value:function(e){try{return tU[this.level].level<=tU[e].level;}catch(e){return !1;}}}]),e;}()),rU="active",iU="passive",sU="hidden",oU="frozen",aU="terminated",uU=function(){return "undefined"!=typeof window&&"object"===s(window.safari)&&window.safari.pushNotification;},cU=[[rU,iU,sU,aU],[rU,iU,sU,oU],[sU,iU,rU],[oU,sU],[oU,rU],[oU,iU]].map(function(e){return e.reduce(function(e,t,n){return e[t]=n,e;},{});}),lU=function(){return "undefined"==typeof document?iU:document.visibilityState===sU?sU:document.hasFocus()?rU:iU;},dU=function(e){h(n,e);var t=E(n);function n(){var e;return u(this,n),(e=t.call(this))._state=lU(),e._handleEvents=e._handleEvents.bind(g(e)),["focus","blur","visibilitychange","freeze","resume","pageshow","onpageshow"in window?"pagehide":"unload"].forEach(function(t){return addEventListener(t,e._handleEvents,!0);}),uU()&&addEventListener("beforeunload",function(t){e._safariBeforeUnloadTimeout=setTimeout(function(){t.defaultPrevented||t.returnValue.length>0||e._dispatchChangesIfNeeded(t,sU);},0);}),e;}return l(n,[{key:"state",get:function(){return this._state;}},{key:"pageWasDiscarded",get:function(){return "undefined"!=typeof document&&(document.wasDiscarded||!1);}},{key:"_dispatchChangesIfNeeded",value:function(e,t){if(t!==this._state)for(var n=function(e,t){for(var n,r=0;n=cU[r];++r){var i=n[e],s=n[t];if(i>=0&&s>=0&&s>i)return Object.keys(n).slice(i,s+1);}return [];}(this._state,t),r=0;r<n.length-1;++r){var i=n[r],s=n[r+1];this._state=s,this._dispatchEvent("statechange",{oldState:i,newState:s,originalEvent:e});}}},{key:"_handleEvents",value:function(e){switch(uU()&&clearTimeout(this._safariBeforeUnloadTimeout),e.type){case"pageshow":case"resume":this._dispatchChangesIfNeeded(e,lU());break;case"focus":this._dispatchChangesIfNeeded(e,rU);break;case"blur":this._state===rU&&this._dispatchChangesIfNeeded(e,lU());break;case"pagehide":case"unload":this._dispatchChangesIfNeeded(e,e.persisted?oU:aU);break;case"visibilitychange":this._state!==oU&&this._state!==aU&&this._dispatchChangesIfNeeded(e,lU());break;case"freeze":this._dispatchChangesIfNeeded(e,oU);}}}]),n;}(im),hU=function(e){h(n,e);var t=E(n);function n(){var e;return u(this,n),(e=t.call(this))._currentState="active",e._lifecycle=new dU(),e;}return l(n,[{key:"_onStateChanged",value:function(e){"hidden"!==e.newState?"hidden"===this._currentState&&this._dispatchEvent("resume"):"hidden"!==this._currentState&&this._dispatchEvent("pause"),this._currentState=e.newState;}},{key:"start",value:function(){var e=this;this._lifecycle.addEventListener("statechange",function(t){return e._onStateChanged(t);});}},{key:"stop",value:function(){var e=this;this._lifecycle.removeEventListener("statechange",function(t){return e._onStateChanged(t);});}}]),n;}(im),fU=function(){function e(){u(this,e),d(this,"_ctx",{});}var t,n,r,s;return l(e,[{key:"init",value:function(e){var t=e.appId,n=e.chatInstance;this._ctx.sb=n||UM.init({appId:t,modules:[new Fx()]}),this._visibilityDetector=new hU(),this._consoleLogListener=new nU(up.NONE),lp.addListener(this._consoleLogListener),this._ctx.appId=t,this._ctx.clientId=z(),this._ctx.commandRouter=new PM(this._ctx),this._ctx.deviceManager=new fL(),this._ctx.liveEventManager=new Hx(this._ctx);}},{key:"setLoggerLevel",value:function(e){return this._consoleLogListener.setLoggerLevel(e);}},{key:"authenticate",value:(s=a(i().mark(function e(t,n){var r=this;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ctx.commandRouter.authenticate({userId:t,accessToken:n});case 2:return e.next=4,this._ctx.commandRouter.connectWs();case 4:this._visibilityDetector.start(),this._visibilityDetector.on("resume",function(){r._ctx.commandRouter.reconnectWs(),r._ctx.deviceManager.updateStream();});case 6:case"end":return e.stop();}},e,this);})),function(e,t){return s.apply(this,arguments);})},{key:"deauthenticate",value:(r=a(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ctx.sb.disconnect();case 2:this._ctx.commandRouter.deauthenticate(),this._ctx.liveEventManager.clear(),this._visibilityDetector.stop(),this._visibilityDetector.removeAllEventListeners(),lp.removeAllListener();case 7:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"createLiveEvent",value:(n=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._ctx.liveEventManager.createLiveEvent(t));case 1:case"end":return e.stop();}},e,this);})),function(e){return n.apply(this,arguments);})},{key:"getLiveEvent",value:(t=a(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._ctx.liveEventManager.getLiveEvent(t));case 1:case"end":return e.stop();}},e,this);})),function(e){return t.apply(this,arguments);})},{key:"createLiveEventListQuery",value:function(e){return new dp(e,this._ctx.commandRouter,this._ctx.liveEventManager);}},{key:"useMedia",value:function(e){return this._ctx.deviceManager.useMedia(e);}},{key:"updateMediaDevices",value:function(e){return this._ctx.deviceManager.refreshMediaDevices(e);}},{key:"getCurrentAudioInputDevice",value:function(){return this._ctx.deviceManager.getCurrentAudioInputDevice();}},{key:"getAvailableAudioInputDevices",value:function(){return this._ctx.deviceManager.getAvailableAudioInputDevices();}},{key:"selectAudioInput",value:function(e){return this._ctx.deviceManager.selectDevice("audioinput",e);}},{key:"setAudioInputDeviceChanged",value:function(e){var t=this;if(this._ctx.deviceManager.removeSendBirdCallListener("AUDIO_DEVICE_CHANGED"),e)return this._ctx.deviceManager.addSendBirdCallListener("AUDIO_DEVICE_CHANGED",{onAudioInputDeviceChanged:e}),function(){t._ctx.deviceManager.removeSendBirdCallListener("AUDIO_DEVICE_CHANGED");};}},{key:"getCurrentVideoInputDevice",value:function(){return this._ctx.deviceManager.getCurrentVideoInputDevice();}},{key:"getAvailableVideoInputDevices",value:function(){return this._ctx.deviceManager.getAvailableVideoInputDevices();}},{key:"selectVideoInput",value:function(e){return this._ctx.deviceManager.selectDevice("videoinput",e);}},{key:"setVideoInputDeviceChanged",value:function(e){var t=this;if(this._ctx.deviceManager.removeSendBirdCallListener("VIDEO_DEVICE_CHANGED"),e)return this._ctx.deviceManager.addSendBirdCallListener("VIDEO_DEVICE_CHANGED",{onVideoInputDeviceChanged:e}),function(){t._ctx.deviceManager.removeSendBirdCallListener("VIDEO_DEVICE_CHANGED");};}}]),e;}(),pU=new fU(),vU={};eU=function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},r(e);}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},i(e,t);}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function o(){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e;}(e,t);if(i){var s=Object.getOwnPropertyDescriptor(i,t);return s.get?s.get.call(arguments.length<3?e:n):s.value;}},o.apply(this,arguments);}var a=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0});}return n(t,[{key:"addEventListener",value:function(e,t,n){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:n});}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,i=n.length;r<i;r++)if(n[r].callback===t)return void n.splice(r,1);}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),n=0,r=t.length;n<r;n++){var i=t[n];try{i.callback.call(this,e);}catch(e){Promise.resolve().then(function(){throw e;});}i.options&&i.options.once&&this.removeEventListener(e.type,i.callback);}return !e.defaultPrevented;}}}]),t;}(),u=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t);}(c,t);var u=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return !1;}}();return function(){var n,i=r(e);if(t){var o=r(this).constructor;n=Reflect.construct(i,arguments,o);}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e);}(this,n);};}(c);function c(){var t;return e(this,c),(t=u.call(this)).listeners||a.call(s(t)),Object.defineProperty(s(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(s(t),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(s(t),"reason",{value:void 0,writable:!0,configurable:!0}),t;}return n(c,[{key:"toString",value:function(){return "[object AbortSignal]";}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),o(r(c.prototype),"dispatchEvent",this).call(this,e);}}]),c;}(a),c=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new u(),writable:!0,configurable:!0});}return n(t,[{key:"abort",value:function(e){var t;try{t=new Event("abort");}catch(e){"undefined"!=typeof document?document.createEvent?(t=document.createEvent("Event")).initEvent("abort",!1,!1):(t=document.createEventObject()).type="abort":t={type:"abort",bubbles:!1,cancelable:!1};}var n=e;if(void 0===n)if("undefined"==typeof document)(n=new Error("This operation was aborted")).name="AbortError";else try{n=new DOMException("signal is aborted without reason");}catch(e){(n=new Error("This operation was aborted")).name="AbortError";}this.signal.reason=n,this.signal.dispatchEvent(t);}},{key:"toString",value:function(){return "[object AbortController]";}}]),t;}();function l(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController;}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(c.prototype[Symbol.toStringTag]="AbortController",u.prototype[Symbol.toStringTag]="AbortSignal"),function(e){if(l(e))if(e.fetch){var t=function(e){"function"==typeof e&&(e={fetch:e});var t=e,n=t.fetch,r=t.Request,i=void 0===r?n.Request:r,s=t.AbortController,o=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,a=void 0!==o&&o;if(!l({fetch:n,Request:i,AbortController:s,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:a}))return {fetch:n,Request:u};var u=i;(u&&!u.prototype.hasOwnProperty("signal")||a)&&((u=function(e,t){var n;t&&t.signal&&(n=t.signal,delete t.signal);var r=new i(e,t);return n&&Object.defineProperty(r,"signal",{writable:!1,enumerable:!1,configurable:!0,value:n}),r;}).prototype=i.prototype);var c=n;return {fetch:function(e,t){var n=u&&u.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(n){var r;try{r=new DOMException("Aborted","AbortError");}catch(e){(r=new Error("Aborted")).name="AbortError";}if(n.aborted)return Promise.reject(r);var i=new Promise(function(e,t){n.addEventListener("abort",function(){return t(r);},{once:!0});});return t&&t.signal&&delete t.signal,Promise.race([i,c(e,t)]);}return c(e,t);},Request:u};}(e),n=t.fetch,r=t.Request;e.fetch=n,e.Request=r,Object.defineProperty(e,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:c}),Object.defineProperty(e,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:u});}else console.warn("fetch() is not available, cannot install abortcontroller-polyfill");}("undefined"!=typeof self?self:Q);},eU();var _U=t({__proto__:null,default:vU},[vU]),yU={},mU="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==Q&&Q||{},gU=("URLSearchParams"in mU),EU="Symbol"in mU&&"iterator"in Symbol,bU="FileReader"in mU&&"Blob"in mU&&function(){try{return new Blob(),!0;}catch(e){return !1;}}(),wU=("FormData"in mU),IU=("ArrayBuffer"in mU);if(IU)var TU=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],SU=ArrayBuffer.isView||function(e){return e&&TU.indexOf(Object.prototype.toString.call(e))>-1;};function CU(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase();}function kU(e){return "string"!=typeof e&&(e=String(e)),e;}function AU(e){var t={next:function(){var t=e.shift();return {done:void 0===t,value:t};}};return EU&&(t[Symbol.iterator]=function(){return t;}),t;}function NU(e){this.map={},e instanceof NU?e.forEach(function(e,t){this.append(t,e);},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1]);},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t]);},this);}function OU(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0);}function RU(e){return new Promise(function(t,n){e.onload=function(){t(e.result);},e.onerror=function(){n(e.error);};});}function DU(e){var t=new FileReader(),n=RU(t);return t.readAsArrayBuffer(e),n;}function xU(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer;}function LU(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:bU&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:wU&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:gU&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():IU&&bU&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=xU(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):IU&&(ArrayBuffer.prototype.isPrototypeOf(e)||SU(e))?this._bodyArrayBuffer=xU(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):gU&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"));},bU&&(this.blob=function(){var e=OU(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]));}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return OU(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(bU)return this.blob().then(DU);throw new Error("could not read as ArrayBuffer");},this.text=function(){var e,t,n,r,i,s=OU(this);if(s)return s;if(this._bodyBlob)return e=this._bodyBlob,n=RU(t=new FileReader()),i=(r=/charset=([A-Za-z0-9_-]+)/.exec(e.type))?r[1]:"utf-8",t.readAsText(e,i),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("");}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText);},wU&&(this.formData=function(){return this.text().then(PU);}),this.json=function(){return this.text().then(JSON.parse);},this;}NU.prototype.append=function(e,t){e=CU(e),t=kU(t);var n=this.map[e];this.map[e]=n?n+", "+t:t;},NU.prototype.delete=function(e){delete this.map[CU(e)];},NU.prototype.get=function(e){return e=CU(e),this.has(e)?this.map[e]:null;},NU.prototype.has=function(e){return this.map.hasOwnProperty(CU(e));},NU.prototype.set=function(e,t){this.map[CU(e)]=kU(t);},NU.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this);},NU.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n);}),AU(e);},NU.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t);}),AU(e);},NU.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t]);}),AU(e);},EU&&(NU.prototype[Symbol.iterator]=NU.prototype.entries);var MU=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function UU(e,t){if(!(this instanceof UU))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,r,i=(t=t||{}).body;if(e instanceof UU){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new NU(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0);}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new NU(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),MU.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in mU)return new AbortController().signal;}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var s=/([?&])_=[^&]*/;s.test(this.url)?this.url=this.url.replace(s,"$1_="+new Date().getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+new Date().getTime();}}function PU(e){var t=new FormData();return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i));}}),t;}function FU(e,t){if(!(this instanceof FU))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new NU(t.headers),this.url=t.url||"",this._initBody(e);}UU.prototype.clone=function(){return new UU(this,{body:this._bodyInit});},LU.call(UU.prototype),LU.call(FU.prototype),FU.prototype.clone=function(){return new FU(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new NU(this.headers),url:this.url});},FU.error=function(){var e=new FU(null,{status:200,statusText:""});return e.status=0,e.type="error",e;};var qU=[301,302,303,307,308];FU.redirect=function(e,t){if(-1===qU.indexOf(t))throw new RangeError("Invalid status code");return new FU(null,{status:t,headers:{location:e}});};var HU=mU.DOMException;try{new HU();}catch(mU){(HU=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack;}).prototype=Object.create(Error.prototype),HU.prototype.constructor=HU;}function jU(e,t){return new Promise(function(n,r){var i=new UU(e,t);if(i.signal&&i.signal.aborted)return r(new HU("Aborted","AbortError"));var s=new XMLHttpRequest();function o(){s.abort();}if(s.onload=function(){var e,t,r={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new NU(),e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e;}).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();try{t.append(r,i);}catch(e){console.warn("Response "+e.message);}}}),t)};r.url="responseURL"in s?s.responseURL:r.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;setTimeout(function(){n(new FU(i,r));},0);},s.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"));},0);},s.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request failed"));},0);},s.onabort=function(){setTimeout(function(){r(new HU("Aborted","AbortError"));},0);},s.open(i.method,function(e){try{return ""===e&&mU.location.href?mU.location.href:e;}catch(t){return e;}}(i.url),!0),"include"===i.credentials?s.withCredentials=!0:"omit"===i.credentials&&(s.withCredentials=!1),"responseType"in s&&(bU?s.responseType="blob":IU&&(s.responseType="arraybuffer")),t&&"object"==typeof t.headers&&!(t.headers instanceof NU||mU.Headers&&t.headers instanceof mU.Headers)){var a=[];Object.getOwnPropertyNames(t.headers).forEach(function(e){a.push(CU(e)),s.setRequestHeader(e,kU(t.headers[e]));}),i.headers.forEach(function(e,t){-1===a.indexOf(t)&&s.setRequestHeader(t,e);});}else i.headers.forEach(function(e,t){s.setRequestHeader(t,e);});i.signal&&(i.signal.addEventListener("abort",o),s.onreadystatechange=function(){4===s.readyState&&i.signal.removeEventListener("abort",o);}),s.send(void 0===i._bodyInit?null:i._bodyInit);});}jU.polyfill=!0,mU.fetch||(mU.fetch=jU,mU.Headers=NU,mU.Request=UU,mU.Response=FU);var VU=t({__proto__:null,default:yU},[yU]);e.CameraOverlayPosition=Yb,e.ErrorCode=tw,e.HostState=p_,e.HostType=Fh,e.LiveEvent=sw,e.LiveEventRole=h_,e.LiveEventState=f_,e.ParticipantState=v_,e.SendbirdLive=pU,Object.defineProperty(e,"__esModule",{value:!0});});
} (sendbirdLive_min, sendbirdLive_min.exports));

var MODAL_ROOT$1 = 'sendbird-modal-root';

function styleInject(css, ref) {
  if (ref === void 0) ref = {};
  var insertAt = ref.insertAt;

  if (!css || typeof document === 'undefined') {
    return;
  }

  var head = document.head || document.getElementsByTagName('head')[0];
  var style = document.createElement('style');
  style.type = 'text/css';

  if (insertAt === 'top') {
    if (head.firstChild) {
      head.insertBefore(style, head.firstChild);
    } else {
      head.appendChild(style);
    }
  } else {
    head.appendChild(style);
  }

  if (style.styleSheet) {
    style.styleSheet.cssText = css;
  } else {
    style.appendChild(document.createTextNode(css));
  }
}

var css_248z$g = "@import url(\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\");\nbody {\n  font-family: \"Roboto\", \"Verdana\", sans-serif;\n  font-size: 14px;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.spin {\n  animation: spin 1s linear infinite;\n}\n\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n.sendbird-modal__mask {\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  z-index: 100000;\n}\n.sendbird-theme--light .sendbird-modal__mask {\n  background-color: var(--sendbird-light-overlay-02);\n}\n.sendbird-theme--dark .sendbird-modal__mask {\n  background-color: var(--sendbird-dark-overlay-02);\n}\n\n.sendbird-modal__container {\n  position: relative;\n  z-index: 100001;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 16px 24px 24px 24px;\n  border-radius: 4px;\n}\n.sendbird-theme--light .sendbird-modal__container {\n  background-color: var(--sendbird-light-background-50);\n  box-shadow: var(--sendbird-light-shadow-04);\n}\n.sendbird-theme--dark .sendbird-modal__container {\n  background-color: var(--sendbird-dark-background-500);\n  box-shadow: var(--sendbird-dark-shadow-04);\n}\n\n.sendbird-modal__wrapper {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  z-index: 1000;\n  top: 0;\n  left: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.sendbird-modal--header {\n  position: relative;\n  margin-bottom: 16px;\n}\n.sendbird-modal--header .sendbird-modal--close {\n  display: inline-block;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.sendbird-modal--footer {\n  margin-top: 32px;\n  text-align: right;\n}\n.sendbird-modal--footer .sendbird-button:last-child {\n  margin-left: 8px;\n}";
styleInject(css_248z$g);

// idea from https://github.com/shibe97/react-hooks-use-modal
var Modal$1 = function (_a) {
    var children = _a.children, _b = _a.isOpen, isOpen = _b === void 0 ? false : _b; _a.close; var _c = _a.modalRoot, modalRoot = _c === void 0 ? MODAL_ROOT$1 : _c, _d = _a.className, className = _d === void 0 ? '' : _d, _e = _a.modalClassName, modalClassName = _e === void 0 ? '' : _e;
    if (!isOpen) {
        return null;
    }
    var root = document.getElementById(modalRoot);
    return createPortal(React__default__default.createElement("div", { className: "sendbird-modal__wrapper ".concat(className) },
        React__default__default.createElement("div", { className: "sendbird-modal__mask" }),
        React__default__default.createElement("div", { className: "sendbird-modal__container ".concat(modalClassName) }, children)), root);
};
var useModal = function (className, modalClassName) {
    var _a = useState(false), isOpen = _a[0], setOpen = _a[1];
    var open = useCallback(function () { return setOpen(true); }, [setOpen]);
    var close = useCallback(function () { return setOpen(false); }, [setOpen]);
    var ModalWrapper = function (_a) {
        var children = _a.children;
        return (React__default__default.createElement(Modal$1, { isOpen: isOpen, close: close, className: className, modalClassName: modalClassName }, children));
    };
    return [ModalWrapper, open, close];
};

function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);

  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);
    enumerableOnly && (symbols = symbols.filter(function (sym) {
      return Object.getOwnPropertyDescriptor(object, sym).enumerable;
    })), keys.push.apply(keys, symbols);
  }

  return keys;
}

function _objectSpread2(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = null != arguments[i] ? arguments[i] : {};
    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {
      _defineProperty(target, key, source[key]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {
      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
    });
  }

  return target;
}

function _defineProperty(obj, key, value) {
  key = _toPropertyKey(key);

  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

function _extends$X() {
  _extends$X = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$X.apply(this, arguments);
}

function _toPrimitive(input, hint) {
  if (typeof input !== "object" || input === null) return input;
  var prim = input[Symbol.toPrimitive];

  if (prim !== undefined) {
    var res = prim.call(input, hint || "default");
    if (typeof res !== "object") return res;
    throw new TypeError("@@toPrimitive must return a primitive value.");
  }

  return (hint === "string" ? String : Number)(input);
}

function _toPropertyKey(arg) {
  var key = _toPrimitive(arg, "string");

  return typeof key === "symbol" ? key : String(key);
}

const SendbirdSdkContext = /*#__PURE__*/React__default__default.createContext({}); // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types

/*!
 * css-vars-ponyfill
 * v2.4.8
 * https://jhildenbiddle.github.io/css-vars-ponyfill/
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */
function _extends$W() {
  _extends$W = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$W.apply(this, arguments);
}
/*!
 * get-css-data
 * v2.1.0
 * https://github.com/jhildenbiddle/get-css-data
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */


function getUrls(urls) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var settings = {
    mimeType: options.mimeType || null,
    onBeforeSend: options.onBeforeSend || Function.prototype,
    onSuccess: options.onSuccess || Function.prototype,
    onError: options.onError || Function.prototype,
    onComplete: options.onComplete || Function.prototype
  };
  var urlArray = Array.isArray(urls) ? urls : [urls];
  var urlQueue = Array.apply(null, Array(urlArray.length)).map(function (x) {
    return null;
  });

  function isValidCss(text) {
    var isString = typeof text === "string";
    var isHTML = isString && text.trim().charAt(0) === "<";
    return isString && !isHTML;
  }

  function onError(xhr, urlIndex) {
    settings.onError(xhr, urlArray[urlIndex], urlIndex);
  }

  function onSuccess(responseText, urlIndex) {
    var returnVal = settings.onSuccess(responseText, urlArray[urlIndex], urlIndex);
    responseText = returnVal === false ? "" : returnVal || responseText;
    urlQueue[urlIndex] = responseText;

    if (urlQueue.indexOf(null) === -1) {
      settings.onComplete(urlQueue);
    }
  }

  var parser = document.createElement("a");
  urlArray.forEach(function (url, i) {
    parser.setAttribute("href", url);
    parser.href = String(parser.href);
    var isIElte9 = Boolean(document.all && !window.atob);
    var isIElte9CORS = isIElte9 && parser.host.split(":")[0] !== location.host.split(":")[0];

    if (isIElte9CORS) {
      var isSameProtocol = parser.protocol === location.protocol;

      if (isSameProtocol) {
        var xdr = new XDomainRequest();
        xdr.open("GET", url);
        xdr.timeout = 0;
        xdr.onprogress = Function.prototype;
        xdr.ontimeout = Function.prototype;

        xdr.onload = function () {
          var text = xdr.responseText;

          if (isValidCss(text)) {
            onSuccess(text, i);
          } else {
            onError(xdr, i);
          }
        };

        xdr.onerror = function (err) {
          onError(xdr, i);
        };

        setTimeout(function () {
          xdr.send();
        }, 0);
      } else {
        console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(url, ")"));
        onError(null, i);
      }
    } else {
      var xhr = new XMLHttpRequest();
      xhr.open("GET", url);

      if (settings.mimeType && xhr.overrideMimeType) {
        xhr.overrideMimeType(settings.mimeType);
      }

      settings.onBeforeSend(xhr, url, i);

      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4) {
          var text = xhr.responseText;

          if (xhr.status < 400 && isValidCss(text)) {
            onSuccess(text, i);
          } else if (xhr.status === 0 && isValidCss(text)) {
            onSuccess(text, i);
          } else {
            onError(xhr, i);
          }
        }
      };

      xhr.send();
    }
  });
}
/**
 * Gets CSS data from <style> and <link> nodes (including @imports), then
 * returns data in order processed by DOM. Allows specifying nodes to
 * include/exclude and filtering CSS data using RegEx.
 *
 * @preserve
 * @param {object}   [options] The options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes.
 * @param {string}   [options.include] CSS selector matching <link> and <style>
 *                   nodes to include
 * @param {string}   [options.exclude] CSS selector matching <link> and <style>
 *                   nodes to exclude
 * @param {object}   [options.filter] Regular expression used to filter node CSS
 *                   data. Each block of CSS data is tested against the filter,
 *                   and only matching data is included.
 * @param {boolean}  [options.skipDisabled=true] Determines if disabled
 *                   stylesheets will be skipped while collecting CSS data.
 * @param {boolean}  [options.useCSSOM=false] Determines if CSS data will be
 *                   collected from a stylesheet's runtime values instead of its
 *                   text content. This is required to get accurate CSS data
 *                   when a stylesheet has been modified using the deleteRule()
 *                   or insertRule() methods because these modifications will
 *                   not be reflected in the stylesheet's text content.
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments.
 * @param {function} [options.onSuccess] Callback on each CSS node read. Passes
 *                   1) CSS text, 2) source node reference, and 3) the source
 *                   URL as arguments.
 * @param {function} [options.onError] Callback on each error. Passes 1) the XHR
 *                   object for inspection, 2) soure node reference, and 3) the
 *                   source URL that failed (either a <link> href or an @import)
 *                   as arguments
 * @param {function} [options.onComplete] Callback after all nodes have been
 *                   processed. Passes 1) concatenated CSS text, 2) an array of
 *                   CSS text in DOM order, and 3) an array of nodes in DOM
 *                   order as arguments.
 *
 * @example
 *
 *   getCssData({
 *     rootElement : document,
 *     include     : 'style,link[rel="stylesheet"]',
 *     exclude     : '[href="skip.css"]',
 *     filter      : /red/,
 *     skipDisabled: true,
 *     useCSSOM    : false,
 *     onBeforeSend(xhr, node, url) {
 *       // ...
 *     }
 *     onSuccess(cssText, node, url) {
 *       // ...
 *     }
 *     onError(xhr, node, url) {
 *       // ...
 *     },
 *     onComplete(cssText, cssArray, nodeArray) {
 *       // ...
 *     }
 *   });
 */


function getCssData(options) {
  var regex = {
    cssComments: /\/\*[\s\S]+?\*\//g,
    cssImports: /(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g
  };
  var settings = {
    rootElement: options.rootElement || document,
    include: options.include || 'style,link[rel="stylesheet"]',
    exclude: options.exclude || null,
    filter: options.filter || null,
    skipDisabled: options.skipDisabled !== false,
    useCSSOM: options.useCSSOM || false,
    onBeforeSend: options.onBeforeSend || Function.prototype,
    onSuccess: options.onSuccess || Function.prototype,
    onError: options.onError || Function.prototype,
    onComplete: options.onComplete || Function.prototype
  };
  var sourceNodes = Array.apply(null, settings.rootElement.querySelectorAll(settings.include)).filter(function (node) {
    return !matchesSelector(node, settings.exclude);
  });
  var cssArray = Array.apply(null, Array(sourceNodes.length)).map(function (x) {
    return null;
  });

  function handleComplete() {
    var isComplete = cssArray.indexOf(null) === -1;

    if (isComplete) {
      cssArray.reduce(function (skipIndices, value, i) {
        if (value === "") {
          skipIndices.push(i);
        }

        return skipIndices;
      }, []).reverse().forEach(function (skipIndex) {
        return [sourceNodes, cssArray].forEach(function (arr) {
          return arr.splice(skipIndex, 1);
        });
      });
      var cssText = cssArray.join("");
      settings.onComplete(cssText, cssArray, sourceNodes);
    }
  }

  function handleSuccess(cssText, cssIndex, node, sourceUrl) {
    var returnVal = settings.onSuccess(cssText, node, sourceUrl);
    cssText = returnVal !== undefined && Boolean(returnVal) === false ? "" : returnVal || cssText;
    resolveImports(cssText, node, sourceUrl, function (resolvedCssText, errorData) {
      if (cssArray[cssIndex] === null) {
        errorData.forEach(function (data) {
          return settings.onError(data.xhr, node, data.url);
        });

        if (!settings.filter || settings.filter.test(resolvedCssText)) {
          cssArray[cssIndex] = resolvedCssText;
        } else {
          cssArray[cssIndex] = "";
        }

        handleComplete();
      }
    });
  }

  function parseImportData(cssText, baseUrl) {
    var ignoreRules = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
    var importData = {};
    importData.rules = (cssText.replace(regex.cssComments, "").match(regex.cssImports) || []).filter(function (rule) {
      return ignoreRules.indexOf(rule) === -1;
    });
    importData.urls = importData.rules.map(function (rule) {
      return rule.replace(regex.cssImports, "$1");
    });
    importData.absoluteUrls = importData.urls.map(function (url) {
      return getFullUrl$1(url, baseUrl);
    });
    importData.absoluteRules = importData.rules.map(function (rule, i) {
      var oldUrl = importData.urls[i];
      var newUrl = getFullUrl$1(importData.absoluteUrls[i], baseUrl);
      return rule.replace(oldUrl, newUrl);
    });
    return importData;
  }

  function resolveImports(cssText, node, baseUrl, callbackFn) {
    var __errorData = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];

    var __errorRules = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : [];

    var importData = parseImportData(cssText, baseUrl, __errorRules);

    if (importData.rules.length) {
      getUrls(importData.absoluteUrls, {
        onBeforeSend: function onBeforeSend(xhr, url, urlIndex) {
          settings.onBeforeSend(xhr, node, url);
        },
        onSuccess: function onSuccess(cssText, url, urlIndex) {
          var returnVal = settings.onSuccess(cssText, node, url);
          cssText = returnVal === false ? "" : returnVal || cssText;
          var responseImportData = parseImportData(cssText, url, __errorRules);
          responseImportData.rules.forEach(function (rule, i) {
            cssText = cssText.replace(rule, responseImportData.absoluteRules[i]);
          });
          return cssText;
        },
        onError: function onError(xhr, url, urlIndex) {
          __errorData.push({
            xhr: xhr,
            url: url
          });

          __errorRules.push(importData.rules[urlIndex]);

          resolveImports(cssText, node, baseUrl, callbackFn, __errorData, __errorRules);
        },
        onComplete: function onComplete(responseArray) {
          responseArray.forEach(function (importText, i) {
            cssText = cssText.replace(importData.rules[i], importText);
          });
          resolveImports(cssText, node, baseUrl, callbackFn, __errorData, __errorRules);
        }
      });
    } else {
      callbackFn(cssText, __errorData);
    }
  }

  if (sourceNodes.length) {
    sourceNodes.forEach(function (node, i) {
      var linkHref = node.getAttribute("href");
      var linkRel = node.getAttribute("rel");
      var isLink = node.nodeName.toLowerCase() === "link" && linkHref && linkRel && linkRel.toLowerCase().indexOf("stylesheet") !== -1;
      var isSkip = settings.skipDisabled === false ? false : node.disabled;
      var isStyle = node.nodeName.toLowerCase() === "style";

      if (isLink && !isSkip) {
        var isURIScheme = linkHref.indexOf("data:text/css") !== -1;

        if (isURIScheme) {
          var cssText = decodeURIComponent(linkHref.substring(linkHref.indexOf(",") + 1));

          if (settings.useCSSOM) {
            cssText = Array.apply(null, node.sheet.cssRules).map(function (rule) {
              return rule.cssText;
            }).join("");
          }

          handleSuccess(cssText, i, node, location.href);
        } else {
          getUrls(linkHref, {
            mimeType: "text/css",
            onBeforeSend: function onBeforeSend(xhr, url, urlIndex) {
              settings.onBeforeSend(xhr, node, url);
            },
            onSuccess: function onSuccess(cssText, url, urlIndex) {
              var sourceUrl = getFullUrl$1(linkHref);
              handleSuccess(cssText, i, node, sourceUrl);
            },
            onError: function onError(xhr, url, urlIndex) {
              cssArray[i] = "";
              settings.onError(xhr, node, url);
              handleComplete();
            }
          });
        }
      } else if (isStyle && !isSkip) {
        var _cssText = node.textContent;

        if (settings.useCSSOM) {
          _cssText = Array.apply(null, node.sheet.cssRules).map(function (rule) {
            return rule.cssText;
          }).join("");
        }

        handleSuccess(_cssText, i, node, location.href);
      } else {
        cssArray[i] = "";
        handleComplete();
      }
    });
  } else {
    settings.onComplete("", []);
  }
}

function getFullUrl$1(url, base) {
  var d = document.implementation.createHTMLDocument("");
  var b = d.createElement("base");
  var a = d.createElement("a");
  d.head.appendChild(b);
  d.body.appendChild(a);
  b.href = base || document.baseURI || (document.querySelector("base") || {}).href || location.href;
  a.href = url;
  return a.href;
}

function matchesSelector(elm, selector) {
  var matches = elm.matches || elm.matchesSelector || elm.webkitMatchesSelector || elm.mozMatchesSelector || elm.msMatchesSelector || elm.oMatchesSelector;
  return matches.call(elm, selector);
}

var balancedMatch = balanced;

function balanced(a, b, str) {
  if (a instanceof RegExp) a = maybeMatch(a, str);
  if (b instanceof RegExp) b = maybeMatch(b, str);
  var r = range(a, b, str);
  return r && {
    start: r[0],
    end: r[1],
    pre: str.slice(0, r[0]),
    body: str.slice(r[0] + a.length, r[1]),
    post: str.slice(r[1] + b.length)
  };
}

function maybeMatch(reg, str) {
  var m = str.match(reg);
  return m ? m[0] : null;
}

balanced.range = range;

function range(a, b, str) {
  var begs, beg, left, right, result;
  var ai = str.indexOf(a);
  var bi = str.indexOf(b, ai + 1);
  var i = ai;

  if (ai >= 0 && bi > 0) {
    if (a === b) {
      return [ai, bi];
    }

    begs = [];
    left = str.length;

    while (i >= 0 && !result) {
      if (i == ai) {
        begs.push(i);
        ai = str.indexOf(a, i + 1);
      } else if (begs.length == 1) {
        result = [begs.pop(), bi];
      } else {
        beg = begs.pop();

        if (beg < left) {
          left = beg;
          right = bi;
        }

        bi = str.indexOf(b, i + 1);
      }

      i = ai < bi && ai >= 0 ? ai : bi;
    }

    if (begs.length) {
      result = [left, right];
    }
  }

  return result;
}

function parseCss(css) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var defaults = {
    preserveStatic: true,
    removeComments: false
  };

  var settings = _extends$W({}, defaults, options);

  var errors = [];

  function error(msg) {
    throw new Error("CSS parse error: ".concat(msg));
  }

  function match(re) {
    var m = re.exec(css);

    if (m) {
      css = css.slice(m[0].length);
      return m;
    }
  }

  function open() {
    return match(/^{\s*/);
  }

  function close() {
    return match(/^}/);
  }

  function whitespace() {
    match(/^\s*/);
  }

  function comment() {
    whitespace();

    if (css[0] !== "/" || css[1] !== "*") {
      return;
    }

    var i = 2;

    while (css[i] && (css[i] !== "*" || css[i + 1] !== "/")) {
      i++;
    }

    if (!css[i]) {
      return error("end of comment is missing");
    }

    var str = css.slice(2, i);
    css = css.slice(i + 2);
    return {
      type: "comment",
      comment: str
    };
  }

  function comments() {
    var cmnts = [];
    var c;

    while (c = comment()) {
      cmnts.push(c);
    }

    return settings.removeComments ? [] : cmnts;
  }

  function selector() {
    whitespace();

    while (css[0] === "}") {
      error("extra closing bracket");
    }

    var m = match(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);

    if (m) {
      var _selector = m[0].trim();

      var selectorItems;
      var hasComment = /\/\*/.test(_selector);

      if (hasComment) {
        _selector = _selector.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g, "");
      }

      var hasCommaInQuotes = /["']\w*,\w*["']/.test(_selector);

      if (hasCommaInQuotes) {
        _selector = _selector.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g, function (m) {
          return m.replace(/,/g, "â");
        });
      }

      var hasMultipleSelectors = /,/.test(_selector);

      if (hasMultipleSelectors) {
        selectorItems = _selector.split(/\s*(?![^(]*\)),\s*/);
      } else {
        selectorItems = [_selector];
      }

      if (hasCommaInQuotes) {
        selectorItems = selectorItems.map(function (s) {
          return s.replace(/\u200C/g, ",");
        });
      }

      return selectorItems;
    }
  }

  function declaration() {
    if (css[0] === "@") {
      return at_rule();
    }

    match(/^([;\s]*)+/);
    var comment_regexp = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;
    var prop = match(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);

    if (!prop) {
      return;
    }

    prop = prop[0].trim();

    if (!match(/^:\s*/)) {
      return error("property missing ':'");
    }

    var val = match(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/);
    var ret = {
      type: "declaration",
      property: prop.replace(comment_regexp, ""),
      value: val ? val[0].replace(comment_regexp, "").trim() : ""
    };
    match(/^[;\s]*/);
    return ret;
  }

  function declarations() {
    if (!open()) {
      return error("missing '{'");
    }

    var d;
    var decls = comments();

    while (d = declaration()) {
      decls.push(d);
      decls = decls.concat(comments());
    }

    if (!close()) {
      return error("missing '}'");
    }

    return decls;
  }

  function keyframe() {
    whitespace();
    var vals = [];
    var m;

    while (m = match(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/)) {
      vals.push(m[1]);
      match(/^,\s*/);
    }

    if (vals.length) {
      return {
        type: "keyframe",
        values: vals,
        declarations: declarations()
      };
    }
  }

  function at_keyframes() {
    var m = match(/^@([-\w]+)?keyframes\s*/);

    if (!m) {
      return;
    }

    var vendor = m[1];
    m = match(/^([-\w]+)\s*/);

    if (!m) {
      return error("@keyframes missing name");
    }

    var name = m[1];

    if (!open()) {
      return error("@keyframes missing '{'");
    }

    var frame;
    var frames = comments();

    while (frame = keyframe()) {
      frames.push(frame);
      frames = frames.concat(comments());
    }

    if (!close()) {
      return error("@keyframes missing '}'");
    }

    return {
      type: "keyframes",
      name: name,
      vendor: vendor,
      keyframes: frames
    };
  }

  function at_page() {
    var m = match(/^@page */);

    if (m) {
      var sel = selector() || [];
      return {
        type: "page",
        selectors: sel,
        declarations: declarations()
      };
    }
  }

  function at_page_margin_box() {
    var m = match(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);

    if (m) {
      var name = "".concat(m[1], "-").concat(m[2]) + (m[3] ? "-".concat(m[3]) : "");
      return {
        type: "page-margin-box",
        name: name,
        declarations: declarations()
      };
    }
  }

  function at_fontface() {
    var m = match(/^@font-face\s*/);

    if (m) {
      return {
        type: "font-face",
        declarations: declarations()
      };
    }
  }

  function at_supports() {
    var m = match(/^@supports *([^{]+)/);

    if (m) {
      return {
        type: "supports",
        supports: m[1].trim(),
        rules: rules()
      };
    }
  }

  function at_host() {
    var m = match(/^@host\s*/);

    if (m) {
      return {
        type: "host",
        rules: rules()
      };
    }
  }

  function at_media() {
    var m = match(/^@media([^{]+)*/);

    if (m) {
      return {
        type: "media",
        media: (m[1] || "").trim(),
        rules: rules()
      };
    }
  }

  function at_custom_m() {
    var m = match(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);

    if (m) {
      return {
        type: "custom-media",
        name: m[1].trim(),
        media: m[2].trim()
      };
    }
  }

  function at_document() {
    var m = match(/^@([-\w]+)?document *([^{]+)/);

    if (m) {
      return {
        type: "document",
        document: m[2].trim(),
        vendor: m[1] ? m[1].trim() : null,
        rules: rules()
      };
    }
  }

  function at_x() {
    var m = match(/^@(import|charset|namespace)\s*([^;]+);/);

    if (m) {
      return {
        type: m[1],
        name: m[2].trim()
      };
    }
  }

  function at_rule() {
    whitespace();

    if (css[0] === "@") {
      var ret = at_x() || at_fontface() || at_media() || at_keyframes() || at_supports() || at_document() || at_custom_m() || at_host() || at_page() || at_page_margin_box();

      if (ret && !settings.preserveStatic) {
        var hasVarFunc = false;

        if (ret.declarations) {
          hasVarFunc = ret.declarations.some(function (decl) {
            return /var\(/.test(decl.value);
          });
        } else {
          var arr = ret.keyframes || ret.rules || [];
          hasVarFunc = arr.some(function (obj) {
            return (obj.declarations || []).some(function (decl) {
              return /var\(/.test(decl.value);
            });
          });
        }

        return hasVarFunc ? ret : {};
      }

      return ret;
    }
  }

  function rule() {
    if (!settings.preserveStatic) {
      var balancedMatch$1 = balancedMatch("{", "}", css);

      if (balancedMatch$1) {
        var hasVarDecl = /:(?:root|host)(?![.:#(])/.test(balancedMatch$1.pre) && /--\S*\s*:/.test(balancedMatch$1.body);
        var hasVarFunc = /var\(/.test(balancedMatch$1.body);

        if (!hasVarDecl && !hasVarFunc) {
          css = css.slice(balancedMatch$1.end + 1);
          return {};
        }
      }
    }

    var sel = selector() || [];
    var decls = settings.preserveStatic ? declarations() : declarations().filter(function (decl) {
      var hasVarDecl = sel.some(function (s) {
        return /:(?:root|host)(?![.:#(])/.test(s);
      }) && /^--\S/.test(decl.property);
      var hasVarFunc = /var\(/.test(decl.value);
      return hasVarDecl || hasVarFunc;
    });

    if (!sel.length) {
      error("selector missing");
    }

    return {
      type: "rule",
      selectors: sel,
      declarations: decls
    };
  }

  function rules(core) {
    if (!core && !open()) {
      return error("missing '{'");
    }

    var node;
    var rules = comments();

    while (css.length && (core || css[0] !== "}") && (node = at_rule() || rule())) {
      if (node.type) {
        rules.push(node);
      }

      rules = rules.concat(comments());
    }

    if (!core && !close()) {
      return error("missing '}'");
    }

    return rules;
  }

  return {
    type: "stylesheet",
    stylesheet: {
      rules: rules(true),
      errors: errors
    }
  };
}

function parseVars(cssData) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var defaults = {
    parseHost: false,
    store: {},
    onWarning: function onWarning() {}
  };

  var settings = _extends$W({}, defaults, options);

  var reVarDeclSelectors = new RegExp(":".concat(settings.parseHost ? "host" : "root", "$"));

  if (typeof cssData === "string") {
    cssData = parseCss(cssData, settings);
  }

  cssData.stylesheet.rules.forEach(function (rule) {
    if (rule.type !== "rule" || !rule.selectors.some(function (s) {
      return reVarDeclSelectors.test(s);
    })) {
      return;
    }

    rule.declarations.forEach(function (decl, i) {
      var prop = decl.property;
      var value = decl.value;

      if (prop && prop.indexOf("--") === 0) {
        settings.store[prop] = value;
      }
    });
  });
  return settings.store;
}

function stringifyCss(tree) {
  var delim = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "";
  var cb = arguments.length > 2 ? arguments[2] : undefined;
  var renderMethods = {
    charset: function charset(node) {
      return "@charset " + node.name + ";";
    },
    comment: function comment(node) {
      return node.comment.indexOf("__CSSVARSPONYFILL") === 0 ? "/*" + node.comment + "*/" : "";
    },
    "custom-media": function customMedia(node) {
      return "@custom-media " + node.name + " " + node.media + ";";
    },
    declaration: function declaration(node) {
      return node.property + ":" + node.value + ";";
    },
    document: function document(node) {
      return "@" + (node.vendor || "") + "document " + node.document + "{" + visit(node.rules) + "}";
    },
    "font-face": function fontFace(node) {
      return "@font-face" + "{" + visit(node.declarations) + "}";
    },
    host: function host(node) {
      return "@host" + "{" + visit(node.rules) + "}";
    },
    import: function _import(node) {
      return "@import " + node.name + ";";
    },
    keyframe: function keyframe(node) {
      return node.values.join(",") + "{" + visit(node.declarations) + "}";
    },
    keyframes: function keyframes(node) {
      return "@" + (node.vendor || "") + "keyframes " + node.name + "{" + visit(node.keyframes) + "}";
    },
    media: function media(node) {
      return "@media " + node.media + "{" + visit(node.rules) + "}";
    },
    namespace: function namespace(node) {
      return "@namespace " + node.name + ";";
    },
    page: function page(node) {
      return "@page " + (node.selectors.length ? node.selectors.join(", ") : "") + "{" + visit(node.declarations) + "}";
    },
    "page-margin-box": function pageMarginBox(node) {
      return "@" + node.name + "{" + visit(node.declarations) + "}";
    },
    rule: function rule(node) {
      var decls = node.declarations;

      if (decls.length) {
        return node.selectors.join(",") + "{" + visit(decls) + "}";
      }
    },
    supports: function supports(node) {
      return "@supports " + node.supports + "{" + visit(node.rules) + "}";
    }
  };

  function visit(nodes) {
    var buf = "";

    for (var i = 0; i < nodes.length; i++) {
      var n = nodes[i];

      if (cb) {
        cb(n);
      }

      var txt = renderMethods[n.type](n);

      if (txt) {
        buf += txt;

        if (txt.length && n.selectors) {
          buf += delim;
        }
      }
    }

    return buf;
  }

  return visit(tree.stylesheet.rules);
}

function walkCss(node, fn) {
  node.rules.forEach(function (rule) {
    if (rule.rules) {
      walkCss(rule, fn);
      return;
    }

    if (rule.keyframes) {
      rule.keyframes.forEach(function (keyframe) {
        if (keyframe.type === "keyframe") {
          fn(keyframe.declarations, rule);
        }
      });
      return;
    }

    if (!rule.declarations) {
      return;
    }

    fn(rule.declarations, node);
  });
}

var VAR_PROP_IDENTIFIER = "--";
var VAR_FUNC_IDENTIFIER = "var";

function transformCss(cssData) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var defaults = {
    preserveStatic: true,
    preserveVars: false,
    variables: {},
    onWarning: function onWarning() {}
  };

  var settings = _extends$W({}, defaults, options);

  if (typeof cssData === "string") {
    cssData = parseCss(cssData, settings);
  }

  walkCss(cssData.stylesheet, function (declarations, node) {
    for (var i = 0; i < declarations.length; i++) {
      var decl = declarations[i];
      var type = decl.type;
      var prop = decl.property;
      var value = decl.value;

      if (type !== "declaration") {
        continue;
      }

      if (!settings.preserveVars && prop && prop.indexOf(VAR_PROP_IDENTIFIER) === 0) {
        declarations.splice(i, 1);
        i--;
        continue;
      }

      if (value.indexOf(VAR_FUNC_IDENTIFIER + "(") !== -1) {
        var resolvedValue = resolveValue(value, settings);

        if (resolvedValue !== decl.value) {
          resolvedValue = fixNestedCalc(resolvedValue);

          if (!settings.preserveVars) {
            decl.value = resolvedValue;
          } else {
            declarations.splice(i, 0, {
              type: type,
              property: prop,
              value: resolvedValue
            });
            i++;
          }
        }
      }
    }
  });
  return stringifyCss(cssData);
}

function fixNestedCalc(value) {
  var reCalcVal = /calc\(([^)]+)\)/g;
  (value.match(reCalcVal) || []).forEach(function (match) {
    var newVal = "calc".concat(match.split("calc").join(""));
    value = value.replace(match, newVal);
  });
  return value;
}

function resolveValue(value) {
  var settings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  var __recursiveFallback = arguments.length > 2 ? arguments[2] : undefined;

  if (value.indexOf("var(") === -1) {
    return value;
  }

  var valueData = balancedMatch("(", ")", value);

  function resolveFunc(value) {
    var name = value.split(",")[0].replace(/[\s\n\t]/g, "");
    var fallback = (value.match(/(?:\s*,\s*){1}(.*)?/) || [])[1];
    var match = Object.prototype.hasOwnProperty.call(settings.variables, name) ? String(settings.variables[name]) : undefined;
    var replacement = match || (fallback ? String(fallback) : undefined);
    var unresolvedFallback = __recursiveFallback || value;

    if (!match) {
      settings.onWarning('variable "'.concat(name, '" is undefined'));
    }

    if (replacement && replacement !== "undefined" && replacement.length > 0) {
      return resolveValue(replacement, settings, unresolvedFallback);
    } else {
      return "var(".concat(unresolvedFallback, ")");
    }
  }

  if (!valueData) {
    if (value.indexOf("var(") !== -1) {
      settings.onWarning('missing closing ")" in the value "'.concat(value, '"'));
    }

    return value;
  } else if (valueData.pre.slice(-3) === "var") {
    var isEmptyVarFunc = valueData.body.trim().length === 0;

    if (isEmptyVarFunc) {
      settings.onWarning("var() must contain a non-whitespace string");
      return value;
    } else {
      return valueData.pre.slice(0, -3) + resolveFunc(valueData.body) + resolveValue(valueData.post, settings);
    }
  } else {
    return valueData.pre + "(".concat(resolveValue(valueData.body, settings), ")") + resolveValue(valueData.post, settings);
  }
}

var isBrowser = typeof window !== "undefined";
var isNativeSupport = isBrowser && window.CSS && window.CSS.supports && window.CSS.supports("(--a: 0)");
var counters = {
  group: 0,
  job: 0
};
var defaults = {
  rootElement: isBrowser ? document : null,
  shadowDOM: false,
  include: "style,link[rel=stylesheet]",
  exclude: "",
  variables: {},
  onlyLegacy: true,
  preserveStatic: true,
  preserveVars: false,
  silent: false,
  updateDOM: true,
  updateURLs: true,
  watch: null,
  onBeforeSend: function onBeforeSend() {},
  onError: function onError() {},
  onWarning: function onWarning() {},
  onSuccess: function onSuccess() {},
  onComplete: function onComplete() {},
  onFinally: function onFinally() {}
};
var regex = {
  cssComments: /\/\*[\s\S]+?\*\//g,
  cssKeyframes: /@(?:-\w*-)?keyframes/,
  cssMediaQueries: /@media[^{]+\{([\s\S]+?})\s*}/g,
  cssUrls: /url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,
  cssVarDeclRules: /(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,
  cssVarDecls: /(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,
  cssVarFunc: /var\(\s*--[\w-]/,
  cssVars: /(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/
};
var variableStore = {
  dom: {},
  job: {},
  user: {}
};
var cssVarsIsRunning = false;
var cssVarsObserver = null;
var cssVarsSrcNodeCount = 0;
var debounceTimer = null;
var isShadowDOMReady = false;
/**
 * Fetches, parses, and transforms CSS custom properties from specified
 * <style> and <link> elements into static values, then appends a new <style>
 * element with static values to the DOM to provide CSS custom property
 * compatibility for legacy browsers. Also provides a single interface for
 * live updates of runtime values in both modern and legacy browsers.
 *
 * @preserve
 * @param {object}   [options] Options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes
 * @param {boolean}  [options.shadowDOM=false] Determines if shadow DOM <link>
 *                   and <style> nodes will be processed.
 * @param {string}   [options.include="style,link[rel=stylesheet]"] CSS selector
 *                   matching <link re="stylesheet"> and <style> nodes to
 *                   process
 * @param {string}   [options.exclude] CSS selector matching <link
 *                   rel="stylehseet"> and <style> nodes to exclude from those
 *                   matches by options.include
 * @param {object}   [options.variables] A map of custom property name/value
 *                   pairs. Property names can omit or include the leading
 *                   double-hyphen (â), and values specified will override
 *                   previous values
 * @param {boolean}  [options.onlyLegacy=true] Determines if the ponyfill will
 *                   only generate legacy-compatible CSS in browsers that lack
 *                   native support (i.e., legacy browsers)
 * @param {boolean}  [options.preserveStatic=true] Determines if CSS
 *                   declarations that do not reference a custom property will
 *                   be preserved in the transformed CSS
 * @param {boolean}  [options.preserveVars=false] Determines if CSS custom
 *                   property declarations will be preserved in the transformed
 *                   CSS
 * @param {boolean}  [options.silent=false] Determines if warning and error
 *                   messages will be displayed on the console
 * @param {boolean}  [options.updateDOM=true] Determines if the ponyfill will
 *                   update the DOM after processing CSS custom properties
 * @param {boolean}  [options.updateURLs=true] Determines if relative url()
 *                   paths will be converted to absolute urls in external CSS
 * @param {boolean}  [options.watch=false] Determines if a MutationObserver will
 *                   be created that will execute the ponyfill when a <link> or
 *                   <style> DOM mutation is observed
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments
 * @param {function} [options.onError] Callback after a CSS parsing error has
 *                   occurred or an XHR request has failed. Passes 1) an error
 *                   message, and 2) source node reference, 3) xhr, and 4 url as
 *                   arguments.
 * @param {function} [options.onWarning] Callback after each CSS parsing warning
 *                   has occurred. Passes 1) a warning message as an argument.
 * @param {function} [options.onSuccess] Callback after CSS data has been
 *                   collected from each node and before CSS custom properties
 *                   have been transformed. Allows modifying the CSS data before
 *                   it is transformed by returning any string value (or false
 *                   to skip). Passes 1) CSS text, 2) source node reference, and
 *                   3) the source URL as arguments.
 * @param {function} [options.onComplete] Callback after all CSS has been
 *                   processed, legacy-compatible CSS has been generated, and
 *                   (optionally) the DOM has been updated. Passes 1) a CSS
 *                   string with CSS variable values resolved, 2) an array of
 *                   output <style> node references that have been appended to
 *                   the DOM, 3) an object containing all custom properies names
 *                   and values, and 4) the ponyfill execution time in
 *                   milliseconds.
 * @param {function} [options.onFinally] Callback in modern and legacy browsers
 *                   after the ponyfill has finished all tasks. Passes 1) a
 *                   boolean indicating if the last ponyfill call resulted in a
 *                   style change, 2) a boolean indicating if the current
 *                   browser provides native support for CSS custom properties,
 *                   and 3) the ponyfill execution time in milliseconds.
 * @example
 *
 *   cssVars({
 *     rootElement   : document,
 *     shadowDOM     : false,
 *     include       : 'style,link[rel="stylesheet"]',
 *     exclude       : '',
 *     variables     : {},
 *     onlyLegacy    : true,
 *     preserveStatic: true,
 *     preserveVars  : false,
 *     silent        : false,
 *     updateDOM     : true,
 *     updateURLs    : true,
 *     watch         : false,
 *     onBeforeSend(xhr, node, url) {},
 *     onError(message, node, xhr, url) {},
 *     onWarning(message) {},
 *     onSuccess(cssText, node, url) {},
 *     onComplete(cssText, styleNode, cssVariables, benchmark) {},
 *     onFinally(hasChanged, hasNativeSupport, benchmark)
 *   });
 */

function cssVars() {
  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var msgPrefix = "cssVars(): ";

  var settings = _extends$W({}, defaults, options);

  function handleError(message, sourceNode, xhr, url) {
    if (!settings.silent && window.console) {
      console.error("".concat(msgPrefix).concat(message, "\n"), sourceNode);
    }

    settings.onError(message, sourceNode, xhr, url);
  }

  function handleWarning(message) {
    if (!settings.silent && window.console) {
      console.warn("".concat(msgPrefix).concat(message));
    }

    settings.onWarning(message);
  }

  function handleFinally(hasChanged) {
    settings.onFinally(Boolean(hasChanged), isNativeSupport, getTimeStamp() - settings.__benchmark);
  }

  if (!isBrowser) {
    return;
  }

  if (settings.watch) {
    settings.watch = defaults.watch;
    addMutationObserver(settings);
    cssVars(settings);
    return;
  } else if (settings.watch === false && cssVarsObserver) {
    cssVarsObserver.disconnect();
    cssVarsObserver = null;
  }

  if (!settings.__benchmark) {
    if (cssVarsIsRunning === settings.rootElement) {
      cssVarsDebounced(options);
      return;
    }

    var srcNodes = [].slice.call(settings.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));
    settings.__benchmark = getTimeStamp();
    settings.exclude = [cssVarsObserver ? '[data-cssvars]:not([data-cssvars=""])' : '[data-cssvars="out"]', "link[disabled]:not([data-cssvars])", settings.exclude].filter(function (selector) {
      return selector;
    }).join(",");
    settings.variables = fixVarNames(settings.variables);
    srcNodes.forEach(function (srcNode) {
      var hasStyleCache = srcNode.nodeName.toLowerCase() === "style" && srcNode.__cssVars.text;

      var hasStyleChanged = hasStyleCache && srcNode.textContent !== srcNode.__cssVars.text;

      if (hasStyleCache && hasStyleChanged) {
        srcNode.sheet && (srcNode.sheet.disabled = false);
        srcNode.setAttribute("data-cssvars", "");
      }
    });

    if (!cssVarsObserver) {
      var outNodes = [].slice.call(settings.rootElement.querySelectorAll('[data-cssvars="out"]'));
      outNodes.forEach(function (outNode) {
        var dataGroup = outNode.getAttribute("data-cssvars-group");
        var srcNode = dataGroup ? settings.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(dataGroup, '"]')) : null;

        if (!srcNode) {
          outNode.parentNode.removeChild(outNode);
        }
      });

      if (cssVarsSrcNodeCount && srcNodes.length < cssVarsSrcNodeCount) {
        cssVarsSrcNodeCount = srcNodes.length;
        variableStore.dom = {};
      }
    }
  }

  if (document.readyState !== "loading") {
    if (isNativeSupport && settings.onlyLegacy) {
      var hasVarChange = false;

      if (settings.updateDOM) {
        var targetElm = settings.rootElement.host || (settings.rootElement === document ? document.documentElement : settings.rootElement);
        Object.keys(settings.variables).forEach(function (key) {
          var varValue = settings.variables[key];
          hasVarChange = hasVarChange || varValue !== getComputedStyle(targetElm).getPropertyValue(key);
          targetElm.style.setProperty(key, varValue);
        });
      }

      handleFinally(hasVarChange);
    } else if (!isShadowDOMReady && (settings.shadowDOM || settings.rootElement.shadowRoot || settings.rootElement.host)) {
      getCssData({
        rootElement: defaults.rootElement,
        include: defaults.include,
        exclude: settings.exclude,
        skipDisabled: false,
        onSuccess: function onSuccess(cssText, node, url) {
          var isUserDisabled = (node.sheet || {}).disabled && !node.__cssVars;

          if (isUserDisabled) {
            return false;
          }

          cssText = cssText.replace(regex.cssComments, "").replace(regex.cssMediaQueries, "");
          cssText = (cssText.match(regex.cssVarDeclRules) || []).join("");
          return cssText || false;
        },
        onComplete: function onComplete(cssText, cssArray, nodeArray) {
          parseVars(cssText, {
            store: variableStore.dom,
            onWarning: handleWarning
          });
          isShadowDOMReady = true;
          cssVars(settings);
        }
      });
    } else {
      cssVarsIsRunning = settings.rootElement;
      getCssData({
        rootElement: settings.rootElement,
        include: settings.include,
        exclude: settings.exclude,
        skipDisabled: false,
        onBeforeSend: settings.onBeforeSend,
        onError: function onError(xhr, node, url) {
          var responseUrl = xhr.responseURL || getFullUrl(url, location.href);
          var statusText = xhr.statusText ? "(".concat(xhr.statusText, ")") : "Unspecified Error" + (xhr.status === 0 ? " (possibly CORS related)" : "");
          var errorMsg = "CSS XHR Error: ".concat(responseUrl, " ").concat(xhr.status, " ").concat(statusText);
          handleError(errorMsg, node, xhr, responseUrl);
        },
        onSuccess: function onSuccess(cssText, node, url) {
          var isUserDisabled = (node.sheet || {}).disabled && !node.__cssVars;

          if (isUserDisabled) {
            return false;
          }

          var isLink = node.nodeName.toLowerCase() === "link";
          var isStyleImport = node.nodeName.toLowerCase() === "style" && cssText !== node.textContent;
          var returnVal = settings.onSuccess(cssText, node, url);
          cssText = returnVal !== undefined && Boolean(returnVal) === false ? "" : returnVal || cssText;

          if (settings.updateURLs && (isLink || isStyleImport)) {
            cssText = fixRelativeCssUrls(cssText, url);
          }

          return cssText;
        },
        onComplete: function onComplete(cssText, cssArray) {
          var nodeArray = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];

          var currentVars = _extends$W({}, variableStore.dom, variableStore.user);

          var hasVarChange = false;
          variableStore.job = {};
          nodeArray.forEach(function (node, i) {
            var nodeCSS = cssArray[i];
            node.__cssVars = node.__cssVars || {};
            node.__cssVars.text = nodeCSS;

            if (regex.cssVars.test(nodeCSS)) {
              try {
                var cssTree = parseCss(nodeCSS, {
                  preserveStatic: settings.preserveStatic,
                  removeComments: true
                });
                parseVars(cssTree, {
                  parseHost: Boolean(settings.rootElement.host),
                  store: variableStore.dom,
                  onWarning: handleWarning
                });
                node.__cssVars.tree = cssTree;
              } catch (err) {
                handleError(err.message, node);
              }
            }
          });

          _extends$W(variableStore.job, variableStore.dom);

          if (settings.updateDOM) {
            _extends$W(variableStore.user, settings.variables);

            _extends$W(variableStore.job, variableStore.user);
          } else {
            _extends$W(variableStore.job, variableStore.user, settings.variables);

            _extends$W(currentVars, settings.variables);
          }

          hasVarChange = counters.job > 0 && Boolean(Object.keys(variableStore.job).length > Object.keys(currentVars).length || Boolean(Object.keys(currentVars).length && Object.keys(variableStore.job).some(function (key) {
            return variableStore.job[key] !== currentVars[key];
          })));

          if (hasVarChange) {
            resetCssNodes(settings.rootElement);
            cssVars(settings);
          } else {
            var outCssArray = [];
            var outNodeArray = [];
            var hasKeyframesWithVars = false;

            if (settings.updateDOM) {
              counters.job++;
            }

            nodeArray.forEach(function (node, i) {
              var isSkip = !node.__cssVars.tree;

              if (node.__cssVars.tree) {
                try {
                  transformCss(node.__cssVars.tree, _extends$W({}, settings, {
                    variables: variableStore.job,
                    onWarning: handleWarning
                  }));
                  var outCss = stringifyCss(node.__cssVars.tree);

                  if (settings.updateDOM) {
                    var nodeCSS = cssArray[i];
                    var hasCSSVarFunc = regex.cssVarFunc.test(nodeCSS);

                    if (!node.getAttribute("data-cssvars")) {
                      node.setAttribute("data-cssvars", "src");
                    }

                    if (outCss.length && hasCSSVarFunc) {
                      var dataGroup = node.getAttribute("data-cssvars-group") || ++counters.group;
                      var outCssNoSpaces = outCss.replace(/\s/g, "");
                      var outNode = settings.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(dataGroup, '"]')) || document.createElement("style");
                      hasKeyframesWithVars = hasKeyframesWithVars || regex.cssKeyframes.test(outCss);

                      if (settings.preserveStatic) {
                        node.sheet && (node.sheet.disabled = true);
                      }

                      if (!outNode.hasAttribute("data-cssvars")) {
                        outNode.setAttribute("data-cssvars", "out");
                      }

                      if (outCssNoSpaces === node.textContent.replace(/\s/g, "")) {
                        isSkip = true;

                        if (outNode && outNode.parentNode) {
                          node.removeAttribute("data-cssvars-group");
                          outNode.parentNode.removeChild(outNode);
                        }
                      } else if (outCssNoSpaces !== outNode.textContent.replace(/\s/g, "")) {
                        [node, outNode].forEach(function (n) {
                          n.setAttribute("data-cssvars-job", counters.job);
                          n.setAttribute("data-cssvars-group", dataGroup);
                        });
                        outNode.textContent = outCss;
                        outCssArray.push(outCss);
                        outNodeArray.push(outNode);

                        if (!outNode.parentNode) {
                          node.parentNode.insertBefore(outNode, node.nextSibling);
                        }
                      }
                    }
                  } else {
                    if (node.textContent.replace(/\s/g, "") !== outCss) {
                      outCssArray.push(outCss);
                    }
                  }
                } catch (err) {
                  handleError(err.message, node);
                }
              }

              if (isSkip) {
                node.setAttribute("data-cssvars", "skip");
              }

              if (!node.hasAttribute("data-cssvars-job")) {
                node.setAttribute("data-cssvars-job", counters.job);
              }
            });
            cssVarsSrcNodeCount = settings.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length;

            if (settings.shadowDOM) {
              var elms = [].concat(settings.rootElement).concat([].slice.call(settings.rootElement.querySelectorAll("*")));

              for (var i = 0, elm; elm = elms[i]; ++i) {
                if (elm.shadowRoot && elm.shadowRoot.querySelector("style")) {
                  var shadowSettings = _extends$W({}, settings, {
                    rootElement: elm.shadowRoot
                  });

                  cssVars(shadowSettings);
                }
              }
            }

            if (settings.updateDOM && hasKeyframesWithVars) {
              fixKeyframes(settings.rootElement);
            }

            cssVarsIsRunning = false;
            settings.onComplete(outCssArray.join(""), outNodeArray, JSON.parse(JSON.stringify(variableStore.job)), getTimeStamp() - settings.__benchmark);
            handleFinally(outNodeArray.length);
          }
        }
      });
    }
  } else {
    document.addEventListener("DOMContentLoaded", function init(evt) {
      cssVars(options);
      document.removeEventListener("DOMContentLoaded", init);
    });
  }
}

cssVars.reset = function () {
  counters.job = 0;
  counters.group = 0;
  cssVarsIsRunning = false;

  if (cssVarsObserver) {
    cssVarsObserver.disconnect();
    cssVarsObserver = null;
  }

  cssVarsSrcNodeCount = 0;
  debounceTimer = null;
  isShadowDOMReady = false;

  for (var prop in variableStore) {
    variableStore[prop] = {};
  }
};

function addMutationObserver(settings) {
  function isDisabled(node) {
    var isDisabledAttr = isLink(node) && node.hasAttribute("disabled");
    var isDisabledSheet = (node.sheet || {}).disabled;
    return isDisabledAttr || isDisabledSheet;
  }

  function isLink(node) {
    var isStylesheet = node.nodeName.toLowerCase() === "link" && (node.getAttribute("rel") || "").indexOf("stylesheet") !== -1;
    return isStylesheet;
  }

  function isStyle(node) {
    return node.nodeName.toLowerCase() === "style";
  }

  function isValidAttributeMutation(mutation) {
    var isValid = false;

    if (mutation.type === "attributes" && isLink(mutation.target) && !isDisabled(mutation.target)) {
      var isEnabledMutation = mutation.attributeName === "disabled";
      var isHrefMutation = mutation.attributeName === "href";
      var isSkipNode = mutation.target.getAttribute("data-cssvars") === "skip";
      var isSrcNode = mutation.target.getAttribute("data-cssvars") === "src";

      if (isEnabledMutation) {
        isValid = !isSkipNode && !isSrcNode;
      } else if (isHrefMutation) {
        if (isSkipNode) {
          mutation.target.setAttribute("data-cssvars", "");
        } else if (isSrcNode) {
          resetCssNodes(settings.rootElement, true);
        }

        isValid = true;
      }
    }

    return isValid;
  }

  function isValidStyleTextMutation(mutation) {
    var isValid = false;

    if (mutation.type === "childList") {
      var isStyleElm = isStyle(mutation.target);
      var isOutNode = mutation.target.getAttribute("data-cssvars") === "out";
      isValid = isStyleElm && !isOutNode;
    }

    return isValid;
  }

  function isValidAddMutation(mutation) {
    var isValid = false;

    if (mutation.type === "childList") {
      isValid = [].slice.call(mutation.addedNodes).some(function (node) {
        var isElm = node.nodeType === 1;
        var hasAttr = isElm && node.hasAttribute("data-cssvars");
        var isStyleWithVars = isStyle(node) && regex.cssVars.test(node.textContent);
        var isValid = !hasAttr && (isLink(node) || isStyleWithVars);
        return isValid && !isDisabled(node);
      });
    }

    return isValid;
  }

  function isValidRemoveMutation(mutation) {
    var isValid = false;

    if (mutation.type === "childList") {
      isValid = [].slice.call(mutation.removedNodes).some(function (node) {
        var isElm = node.nodeType === 1;
        var isOutNode = isElm && node.getAttribute("data-cssvars") === "out";
        var isSrcNode = isElm && node.getAttribute("data-cssvars") === "src";
        var isValid = isSrcNode;

        if (isSrcNode || isOutNode) {
          var dataGroup = node.getAttribute("data-cssvars-group");
          var orphanNode = settings.rootElement.querySelector('[data-cssvars-group="'.concat(dataGroup, '"]'));

          if (isSrcNode) {
            resetCssNodes(settings.rootElement, true);
          }

          if (orphanNode) {
            orphanNode.parentNode.removeChild(orphanNode);
          }
        }

        return isValid;
      });
    }

    return isValid;
  }

  if (!window.MutationObserver) {
    return;
  }

  if (cssVarsObserver) {
    cssVarsObserver.disconnect();
    cssVarsObserver = null;
  }

  cssVarsObserver = new MutationObserver(function (mutations) {
    var hasValidMutation = mutations.some(function (mutation) {
      return isValidAttributeMutation(mutation) || isValidStyleTextMutation(mutation) || isValidAddMutation(mutation) || isValidRemoveMutation(mutation);
    });

    if (hasValidMutation) {
      cssVars(settings);
    }
  });
  cssVarsObserver.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ["disabled", "href"],
    childList: true,
    subtree: true
  });
}

function cssVarsDebounced(settings) {
  var delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(function () {
    settings.__benchmark = null;
    cssVars(settings);
  }, delay);
}

function fixKeyframes(rootElement) {
  var animationNameProp = ["animation-name", "-moz-animation-name", "-webkit-animation-name"].filter(function (prop) {
    return getComputedStyle(document.body)[prop];
  })[0];

  if (animationNameProp) {
    var allNodes = [].slice.call(rootElement.querySelectorAll("*"));
    var keyframeNodes = [];
    var nameMarker = "__CSSVARSPONYFILL-KEYFRAMES__";

    for (var i = 0, len = allNodes.length; i < len; i++) {
      var node = allNodes[i];
      var animationName = getComputedStyle(node)[animationNameProp];

      if (animationName !== "none") {
        node.style[animationNameProp] += nameMarker;
        keyframeNodes.push(node);
      }
    }

    void document.body.offsetHeight;

    for (var _i = 0, _len = keyframeNodes.length; _i < _len; _i++) {
      var nodeStyle = keyframeNodes[_i].style;
      nodeStyle[animationNameProp] = nodeStyle[animationNameProp].replace(nameMarker, "");
    }
  }
}

function fixRelativeCssUrls(cssText, baseUrl) {
  var cssUrls = cssText.replace(regex.cssComments, "").match(regex.cssUrls) || [];
  cssUrls.forEach(function (cssUrl) {
    var oldUrl = cssUrl.replace(regex.cssUrls, "$1");
    var newUrl = getFullUrl(oldUrl, baseUrl);
    cssText = cssText.replace(cssUrl, cssUrl.replace(oldUrl, newUrl));
  });
  return cssText;
}

function fixVarNames() {
  var varObj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var reLeadingHyphens = /^-{2}/;
  return Object.keys(varObj).reduce(function (obj, value) {
    var key = reLeadingHyphens.test(value) ? value : "--".concat(value.replace(/^-+/, ""));
    obj[key] = varObj[value];
    return obj;
  }, {});
}

function getFullUrl(url) {
  var base = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : location.href;
  var d = document.implementation.createHTMLDocument("");
  var b = d.createElement("base");
  var a = d.createElement("a");
  d.head.appendChild(b);
  d.body.appendChild(a);
  b.href = base;
  a.href = url;
  return a.href;
}

function getTimeStamp() {
  return isBrowser && (window.performance || {}).now ? window.performance.now() : new Date().getTime();
}

function resetCssNodes(rootElement) {
  var resetDOMVariableStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var resetNodes = [].slice.call(rootElement.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));
  resetNodes.forEach(function (node) {
    return node.setAttribute("data-cssvars", "");
  });

  if (resetDOMVariableStore) {
    variableStore.dom = {};
  }
}

var n$2 = Symbol("@ts-pattern/matcher"),
    t$2 = "@ts-pattern/anonymous-select-key",
    e$4 = function (n) {
  return Boolean(n && "object" == typeof n);
},
    r$2 = function (t) {
  return t && !!t[n$2];
},
    u$2 = function t(u, i, c) {
  if (e$4(u)) {
    if (r$2(u)) {
      var o = u[n$2]().match(i),
          a = o.matched,
          f = o.selections;
      return a && f && Object.keys(f).forEach(function (n) {
        return c(n, f[n]);
      }), a;
    }

    if (!e$4(i)) return !1;
    if (Array.isArray(u)) return !!Array.isArray(i) && u.length === i.length && u.every(function (n, e) {
      return t(n, i[e], c);
    });
    if (u instanceof Map) return i instanceof Map && Array.from(u.keys()).every(function (n) {
      return t(u.get(n), i.get(n), c);
    });

    if (u instanceof Set) {
      if (!(i instanceof Set)) return !1;
      if (0 === u.size) return 0 === i.size;

      if (1 === u.size) {
        var s = Array.from(u.values())[0];
        return r$2(s) ? Array.from(i.values()).every(function (n) {
          return t(s, n, c);
        }) : i.has(s);
      }

      return Array.from(u.values()).every(function (n) {
        return i.has(n);
      });
    }

    return Object.keys(u).every(function (e) {
      var o,
          a = u[e];
      return (e in i || r$2(o = a) && "optional" === o[n$2]().matcherType) && t(a, i[e], c);
    });
  }

  return Object.is(i, u);
};

function h$2(t) {
  var e;
  return (e = {})[n$2] = function () {
    return {
      match: function (n) {
        return {
          matched: Boolean(t(n))
        };
      }
    };
  }, e;
}

h$2(function (n) {
  return !0;
});
h$2(function (n) {
  return "string" == typeof n;
});
h$2(function (n) {
  return "number" == typeof n;
});
h$2(function (n) {
  return "boolean" == typeof n;
});
h$2(function (n) {
  return "bigint" == typeof n;
});
h$2(function (n) {
  return "symbol" == typeof n;
});
h$2(function (n) {
  return null == n;
});

function K$1(n) {
  return new O$2(n, []);
}

var O$2 = /*#__PURE__*/function () {
  function n(n, t) {
    this.value = void 0, this.cases = void 0, this.value = n, this.cases = t;
  }

  var e = n.prototype;
  return e.with = function () {
    var e = [].slice.call(arguments),
        r = e[e.length - 1],
        i = [e[0]],
        c = [];
    return 3 === e.length && "function" == typeof e[1] ? (i.push(e[0]), c.push(e[1])) : e.length > 2 && i.push.apply(i, e.slice(1, e.length - 1)), new n(this.value, this.cases.concat([{
      match: function (n) {
        var e = {},
            r = Boolean(i.some(function (t) {
          return u$2(t, n, function (n, t) {
            e[n] = t;
          });
        }) && c.every(function (t) {
          return t(n);
        }));
        return {
          matched: r,
          value: r && Object.keys(e).length ? t$2 in e ? e[t$2] : e : n
        };
      },
      handler: r
    }]));
  }, e.when = function (t, e) {
    return new n(this.value, this.cases.concat([{
      match: function (n) {
        return {
          matched: Boolean(t(n)),
          value: n
        };
      },
      handler: e
    }]));
  }, e.otherwise = function (t) {
    return new n(this.value, this.cases.concat([{
      match: function (n) {
        return {
          matched: !0,
          value: n
        };
      },
      handler: t
    }])).run();
  }, e.exhaustive = function () {
    return this.run();
  }, e.run = function () {
    for (var n = this.value, t = void 0, e = 0; e < this.cases.length; e++) {
      var r = this.cases[e],
          u = r.match(this.value);

      if (u.matched) {
        n = u.value, t = r.handler;
        break;
      }
    }

    if (!t) {
      var i;

      try {
        i = JSON.stringify(this.value);
      } catch (n) {
        i = this.value;
      }

      throw new Error("Pattern matching error: no pattern matches value " + i);
    }

    return t(n, this.value);
  }, n;
}();

const USER_ACTIONS = {
  INIT_USER: 'INIT_USER',
  RESET_USER: 'RESET_USER',
  UPDATE_USER_INFO: 'UPDATE_USER_INFO'
};

var e$3 = function (t, n) {
  return e$3 = Object.setPrototypeOf || {
    __proto__: []
  } instanceof Array && function (e, t) {
    e.__proto__ = t;
  } || function (e, t) {
    for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]);
  }, e$3(t, n);
};

function t$1(t, n) {
  if ("function" != typeof n && null !== n) throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");

  function r() {
    this.constructor = t;
  }

  e$3(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r());
}

var n$1 = function () {
  return n$1 = Object.assign || function (e) {
    for (var t, n = 1, r = arguments.length; n < r; n++) for (var i in t = arguments[n]) Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i]);

    return e;
  }, n$1.apply(this, arguments);
};

function r$1(e, t) {
  var n = {};

  for (var r in e) Object.prototype.hasOwnProperty.call(e, r) && t.indexOf(r) < 0 && (n[r] = e[r]);

  if (null != e && "function" == typeof Object.getOwnPropertySymbols) {
    var i = 0;

    for (r = Object.getOwnPropertySymbols(e); i < r.length; i++) t.indexOf(r[i]) < 0 && Object.prototype.propertyIsEnumerable.call(e, r[i]) && (n[r[i]] = e[r[i]]);
  }

  return n;
}

function i$1(e, t, n, r) {
  return new (n || (n = Promise))(function (i, o) {
    function s(e) {
      try {
        c(r.next(e));
      } catch (e) {
        o(e);
      }
    }

    function a(e) {
      try {
        c(r.throw(e));
      } catch (e) {
        o(e);
      }
    }

    function c(e) {
      var t;
      e.done ? i(e.value) : (t = e.value, t instanceof n ? t : new n(function (e) {
        e(t);
      })).then(s, a);
    }

    c((r = r.apply(e, t || [])).next());
  });
}

function o$1(e, t) {
  var n,
      r,
      i,
      o,
      s = {
    label: 0,
    sent: function () {
      if (1 & i[0]) throw i[1];
      return i[1];
    },
    trys: [],
    ops: []
  };
  return o = {
    next: a(0),
    throw: a(1),
    return: a(2)
  }, "function" == typeof Symbol && (o[Symbol.iterator] = function () {
    return this;
  }), o;

  function a(a) {
    return function (c) {
      return function (a) {
        if (n) throw new TypeError("Generator is already executing.");

        for (; o && (o = 0, a[0] && (s = 0)), s;) try {
          if (n = 1, r && (i = 2 & a[0] ? r.return : a[0] ? r.throw || ((i = r.return) && i.call(r), 0) : r.next) && !(i = i.call(r, a[1])).done) return i;

          switch (r = 0, i && (a = [2 & a[0], i.value]), a[0]) {
            case 0:
            case 1:
              i = a;
              break;

            case 4:
              return s.label++, {
                value: a[1],
                done: !1
              };

            case 5:
              s.label++, r = a[1], a = [0];
              continue;

            case 7:
              a = s.ops.pop(), s.trys.pop();
              continue;

            default:
              if (!(i = s.trys, (i = i.length > 0 && i[i.length - 1]) || 6 !== a[0] && 2 !== a[0])) {
                s = 0;
                continue;
              }

              if (3 === a[0] && (!i || a[1] > i[0] && a[1] < i[3])) {
                s.label = a[1];
                break;
              }

              if (6 === a[0] && s.label < i[1]) {
                s.label = i[1], i = a;
                break;
              }

              if (i && s.label < i[2]) {
                s.label = i[2], s.ops.push(a);
                break;
              }

              i[2] && s.ops.pop(), s.trys.pop();
              continue;
          }

          a = t.call(e, s);
        } catch (e) {
          a = [6, e], r = 0;
        } finally {
          n = i = 0;
        }

        if (5 & a[0]) throw a[1];
        return {
          value: a[0] ? a[1] : void 0,
          done: !0
        };
      }([a, c]);
    };
  }
}

function s$2(e) {
  var t = "function" == typeof Symbol && Symbol.iterator,
      n = t && e[t],
      r = 0;
  if (n) return n.call(e);
  if (e && "number" == typeof e.length) return {
    next: function () {
      return e && r >= e.length && (e = void 0), {
        value: e && e[r++],
        done: !e
      };
    }
  };
  throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.");
}

function a$1(e, t) {
  var n = "function" == typeof Symbol && e[Symbol.iterator];
  if (!n) return e;
  var r,
      i,
      o = n.call(e),
      s = [];

  try {
    for (; (void 0 === t || t-- > 0) && !(r = o.next()).done;) s.push(r.value);
  } catch (e) {
    i = {
      error: e
    };
  } finally {
    try {
      r && !r.done && (n = o.return) && n.call(o);
    } finally {
      if (i) throw i.error;
    }
  }

  return s;
}

function c$1(e, t, n) {
  if (n || 2 === arguments.length) for (var r, i = 0, o = t.length; i < o; i++) !r && i in t || (r || (r = Array.prototype.slice.call(t, 0, i)), r[i] = t[i]);
  return e.concat(r || Array.prototype.slice.call(t));
}

"function" == typeof SuppressedError && SuppressedError;

var u$1,
    l$1 = "4.9.7",
    h$1 = function () {
  function e() {}

  return Object.defineProperty(e, "OS_VERSION", {
    get: function () {
      return "undefined" != typeof navigator && navigator.userAgent ? navigator.userAgent.replace(/,/g, ".") : "noAgent";
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e, "SDK_VERSION", {
    get: function () {
      return l$1;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e, "SDK_MAJOR_VERSION", {
    get: function () {
      return e.SDK_VERSION.split(".")[0];
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e, "DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL", {
    get: function () {
      return 100;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e, "INTERNAL_CALL", {
    get: function () {
      return "ic";
    },
    enumerable: !1,
    configurable: !0
  }), e;
}();

!function (e) {
  e[e.STAT_LOG_NOT_ALLOWED = 400108] = "STAT_LOG_NOT_ALLOWED", e[e.NON_AUTHORIZED = 400108] = "NON_AUTHORIZED", e[e.INVALID_TOKEN = 400111] = "INVALID_TOKEN", e[e.NOT_FOUND_IN_DATABASE = 400201] = "NOT_FOUND_IN_DATABASE", e[e.USER_AUTH_DEACTIVATED = 400300] = "USER_AUTH_DEACTIVATED", e[e.USER_AUTH_DELETED_OR_NOT_FOUND = 400301] = "USER_AUTH_DELETED_OR_NOT_FOUND", e[e.SESSION_TOKEN_EXPIRED = 400302] = "SESSION_TOKEN_EXPIRED", e[e.SESSION_KEY_EXPIRED = 400309] = "SESSION_KEY_EXPIRED", e[e.SESSION_REVOKED = 400310] = "SESSION_REVOKED", e[e.STAT_UPLOAD_NOT_ALLOWED = 403200] = "STAT_UPLOAD_NOT_ALLOWED", e[e.INTERNAL_SERVER_ERROR = 500901] = "INTERNAL_SERVER_ERROR", e[e.RATE_LIMIT_EXCEEDED = 500910] = "RATE_LIMIT_EXCEEDED", e[e.UNKNOWN_SERVER_ERROR = 900200] = "UNKNOWN_SERVER_ERROR", e[e.DEBUG_MODE_REQUIRED = 7e5] = "DEBUG_MODE_REQUIRED", e[e.LOST_INSTANCE = 700100] = "LOST_INSTANCE", e[e.CONNECTION_RENEW = 700102] = "CONNECTION_RENEW", e[e.INVALID_CONNECTION_STATE_TRANSITION = 700200] = "INVALID_CONNECTION_STATE_TRANSITION", e[e.INVALID_COMMAND = 700700] = "INVALID_COMMAND", e[e.UNKNOWN_ERROR = 77e4] = "UNKNOWN_ERROR", e[e.INVALID_INITIALIZATION = 800100] = "INVALID_INITIALIZATION", e[e.CONNECTION_REQUIRED = 800101] = "CONNECTION_REQUIRED", e[e.CONNECTION_CANCELED = 800102] = "CONNECTION_CANCELED", e[e.INVALID_PARAMETER = 800110] = "INVALID_PARAMETER", e[e.NOT_SUPPORTED_ERROR = 800111] = "NOT_SUPPORTED_ERROR", e[e.NETWORK_ERROR = 800120] = "NETWORK_ERROR", e[e.NETWORK_ROUTING_ERROR = 800121] = "NETWORK_ROUTING_ERROR", e[e.MALFORMED_DATA = 800130] = "MALFORMED_DATA", e[e.MALFORMED_ERROR_DATA = 800140] = "MALFORMED_ERROR_DATA", e[e.WRONG_CHANNEL_TYPE = 800150] = "WRONG_CHANNEL_TYPE", e[e.MARK_AS_READ_RATE_LIMIT_EXCEEDED = 800160] = "MARK_AS_READ_RATE_LIMIT_EXCEEDED", e[e.QUERY_IN_PROGRESS = 800170] = "QUERY_IN_PROGRESS", e[e.ACK_TIMEOUT = 800180] = "ACK_TIMEOUT", e[e.LOGIN_TIMEOUT = 800190] = "LOGIN_TIMEOUT", e[e.WEBSOCKET_CONNECTION_CLOSED = 800200] = "WEBSOCKET_CONNECTION_CLOSED", e[e.WEBSOCKET_CONNECTION_FAILED = 800210] = "WEBSOCKET_CONNECTION_FAILED", e[e.REQUEST_FAILED = 800220] = "REQUEST_FAILED", e[e.FILE_UPLOAD_CANCEL_FAILED = 800230] = "FILE_UPLOAD_CANCEL_FAILED", e[e.REQUEST_CANCELED = 800240] = "REQUEST_CANCELED", e[e.REQUEST_DUPLICATED = 800250] = "REQUEST_DUPLICATED", e[e.FILE_SIZE_LIMIT_EXCEEDED = 800260] = "FILE_SIZE_LIMIT_EXCEEDED", e[e.SESSION_TOKEN_REQUEST_FAILED = 800500] = "SESSION_TOKEN_REQUEST_FAILED", e[e.SESSION_TOKEN_REFRESHED = 800501] = "SESSION_TOKEN_REFRESHED", e[e.SESSION_TOKEN_REFRESH_FAILED = 800502] = "SESSION_TOKEN_REFRESH_FAILED", e[e.COLLECTION_DISPOSED = 800600] = "COLLECTION_DISPOSED", e[e.DATABASE_ERROR = 800700] = "DATABASE_ERROR";
}(u$1 || (u$1 = {}));

var d$1,
    _$1,
    f$4,
    p$2,
    E$1,
    g$2 = function (e) {
  return !(e instanceof v$2 && !e.shouldThrowOutside);
},
    v$2 = function (e) {
  function n(t) {
    var r = t.code,
        i = void 0 === r ? 0 : r,
        o = t.message,
        s = void 0 === o ? "" : o,
        a = e.call(this, s) || this;
    return a.shouldThrowOutside = !1, a.name = "SendbirdError", a.code = i, Object.setPrototypeOf(a, n.prototype), a;
  }

  return t$1(n, e), Object.defineProperty(n.prototype, "isInvalidTokenError", {
    get: function () {
      return this.code === u$1.INVALID_TOKEN;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "isSessionTokenExpiredError", {
    get: function () {
      return this.code === u$1.SESSION_TOKEN_EXPIRED;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "isSessionKeyExpiredError", {
    get: function () {
      return this.code === u$1.SESSION_KEY_EXPIRED;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "isSessionRevokedError", {
    get: function () {
      return this.code === u$1.SESSION_REVOKED;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "isUserAuthDeactivedError", {
    get: function () {
      return this.code === u$1.USER_AUTH_DEACTIVATED;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "isUserAuthDeletedOrNotFoundError", {
    get: function () {
      return this.code === u$1.USER_AUTH_DELETED_OR_NOT_FOUND;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "debugModeRequired", {
    get: function () {
      return new n({
        code: u$1.DEBUG_MODE_REQUIRED,
        message: "Cannot run this operation in production mode."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "lostInstance", {
    get: function () {
      return new n({
        code: u$1.LOST_INSTANCE,
        message: "Instance ID is missing. It should belong to an instance."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "invalidCommand", {
    get: function () {
      return new n({
        code: u$1.INVALID_COMMAND,
        message: "Cannot send invalid command."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "unknown", {
    get: function () {
      return new n({
        code: u$1.UNKNOWN_ERROR,
        message: "Unknown error occurred."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "connectionRenew", {
    get: function () {
      return new n({
        code: u$1.CONNECTION_RENEW,
        message: "Connection restarts."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "invalidConnectionStateTransition", {
    get: function () {
      return new n({
        code: u$1.INVALID_CONNECTION_STATE_TRANSITION,
        message: "Invalid connection state transition."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "connectionRequired", {
    get: function () {
      return new n({
        code: u$1.CONNECTION_REQUIRED,
        message: "Connection is required."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "connectionCanceled", {
    get: function () {
      return new n({
        code: u$1.CONNECTION_CANCELED,
        message: "Connection is canceled."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "invalidParameters", {
    get: function () {
      return new n({
        code: u$1.INVALID_PARAMETER,
        message: "Invalid parameters."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "notSupportedError", {
    get: function () {
      return new n({
        code: u$1.NOT_SUPPORTED_ERROR,
        message: "Given parameters are not supported."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "networkError", {
    get: function () {
      return new n({
        code: u$1.NETWORK_ERROR,
        message: "There was a network error."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "markAsReadAllRateLimitExceeded", {
    get: function () {
      return new n({
        code: u$1.MARK_AS_READ_RATE_LIMIT_EXCEEDED,
        message: "markAsRead rate limit exceeded."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "queryInProgress", {
    get: function () {
      return new n({
        code: u$1.QUERY_IN_PROGRESS,
        message: "Query in progress."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "noAckTimeout", {
    get: function () {
      return new n({
        code: u$1.ACK_TIMEOUT,
        message: "Command received no ack."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "loginTimeout", {
    get: function () {
      return new n({
        code: u$1.LOGIN_TIMEOUT,
        message: "Connection timeout."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "connectionClosed", {
    get: function () {
      return new n({
        code: u$1.WEBSOCKET_CONNECTION_CLOSED,
        message: "Connection is closed. Please reconnect."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "requestFailed", {
    get: function () {
      return new n({
        code: u$1.REQUEST_FAILED,
        message: "Request failed."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "fileUploadCanceled", {
    get: function () {
      return new n({
        code: u$1.FILE_UPLOAD_CANCEL_FAILED,
        message: "File upload has been canceled."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "requestCanceled", {
    get: function () {
      return new n({
        code: u$1.REQUEST_CANCELED,
        message: "Request has been canceled."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "sessionTokenRefreshFailed", {
    get: function () {
      return new n({
        code: u$1.SESSION_TOKEN_REFRESH_FAILED,
        message: "Failed to refresh the session key."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "sessionTokenRequestFailed", {
    get: function () {
      return new n({
        code: u$1.SESSION_TOKEN_REQUEST_FAILED,
        message: "Failed to get the session token."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "databaseError", {
    get: function () {
      return new n({
        code: u$1.DATABASE_ERROR,
        message: "Database error."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "fileSizeLimitExceededError", {
    get: function () {
      return new n({
        code: u$1.FILE_SIZE_LIMIT_EXCEEDED,
        message: "File size exceeds the file size limit."
      });
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype.throwOutside = function () {
    throw this.shouldThrowOutside = !0, this;
  }, n;
}(Error),
    b$2 = [u$1.CONNECTION_REQUIRED, u$1.NETWORK_ERROR, u$1.ACK_TIMEOUT, u$1.WEBSOCKET_CONNECTION_CLOSED, u$1.WEBSOCKET_CONNECTION_FAILED, u$1.FILE_UPLOAD_CANCEL_FAILED, u$1.REQUEST_CANCELED, u$1.INTERNAL_SERVER_ERROR, u$1.RATE_LIMIT_EXCEEDED, u$1.UNKNOWN_SERVER_ERROR],
    m$1 = [u$1.WEBSOCKET_CONNECTION_CLOSED, u$1.WEBSOCKET_CONNECTION_FAILED, u$1.CONNECTION_REQUIRED],
    y$2 = function (e, t) {
  if (e !== t) {
    var r = n$1({}, e),
        i = n$1({}, t);
    return (!r.hasOwnProperty("messageId") || !i.hasOwnProperty("messageId") || r.messageId === i.messageId) && (!r.hasOwnProperty("reqId") || !i.hasOwnProperty("reqId") || r.reqId === i.reqId) && (r.hasOwnProperty("messageId") && delete r.messageId, r.hasOwnProperty("reqId") && delete r.reqId, i.hasOwnProperty("messageId") && delete i.messageId, i.hasOwnProperty("reqId") && delete i.reqId, JSON.stringify(r) === JSON.stringify(i));
  }

  return !0;
},
    w$1 = function (e, t, n) {
  return void 0 === n && (n = !1), !(!n || null != t) || ("string" != typeof e ? "object" == typeof e ? N$1(e, t) : T$2(e, t) : typeof t === e);
},
    N$1 = function (e, t, n) {
  return void 0 === n && (n = !1), !(!n || null != t) || Object.values(e).includes(t);
},
    T$2 = function (e, t) {
  return t instanceof e;
},
    S$2 = function (e, t, n) {
  return void 0 === n && (n = !1), !(!n || null != t) || Array.isArray(t) && t.every(function (t) {
    return w$1(e, t);
  });
},
    A$1 = function (e) {
  return e > 0 && b$2.indexOf(e) >= 0;
},
    C$1 = function (e) {
  return e > 0 && m$1.indexOf(e) >= 0;
},
    k = function (e, t) {
  if (void 0 === t && (t = !1), t && null == e) return !0;
  var n = "object" == typeof e && null !== e && e.hasOwnProperty("name") && "string" == typeof e.name && e.hasOwnProperty("uri") && "string" == typeof e.uri && e.hasOwnProperty("type") && "string" == typeof e.type;

  if (!n) {
    if ("undefined" != typeof Blob) return e instanceof Blob;
    if ("undefined" != typeof File) return e instanceof File;
  }

  return n;
},
    O$1 = function (e, t) {
  if (e === t) return !0;
  if (null == e || null == t) return !1;
  if (e.length !== t.length) return !1;

  for (var n = c$1([], a$1(e), !1).sort(), r = c$1([], a$1(t), !1).sort(), i = 0; i < n.length; ++i) if (n[i] !== r[i]) return !1;

  return !0;
},
    I$2 = function () {
  function e(e) {
    var t = void 0 === e ? {} : e,
        n = t.useMemberInfoInMessage,
        r = void 0 === n || n,
        i = t.typingIndicatorInvalidateTime,
        o = void 0 === i ? 1e4 : i,
        s = t.typingIndicatorThrottle,
        a = void 0 === s ? 1e3 : s,
        c = t.websocketResponseTimeout,
        u = void 0 === c ? 1e4 : c,
        l = t.websocketPayloadDecompression,
        h = void 0 === l || l,
        d = t.sessionTokenRefreshTimeout,
        _ = void 0 === d ? 60 : d;

    this._useMemberInfoInMessage = !0, this._typingIndicatorInvalidateTime = 1e4, this._typingIndicatorThrottle = 1e3, this._websocketResponseTimeout = 1e4, this._sessionTokenRefreshTimeout = 60, this._useMemberInfoInMessage = r, this._typingIndicatorInvalidateTime = o, this._typingIndicatorThrottle = a, this._websocketResponseTimeout = u, this._sessionTokenRefreshTimeout = _, this.websocketPayloadDecompression = h;
  }

  return Object.defineProperty(e.prototype, "useMemberInfoInMessage", {
    get: function () {
      return this._useMemberInfoInMessage;
    },
    set: function (e) {
      w$1("boolean", e) && (this._useMemberInfoInMessage = e);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "typingIndicatorInvalidateTime", {
    get: function () {
      return this._typingIndicatorInvalidateTime;
    },
    set: function (e) {
      w$1("number", e) && (this._typingIndicatorInvalidateTime = e);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "typingIndicatorThrottle", {
    get: function () {
      return this._typingIndicatorThrottle;
    },
    set: function (e) {
      w$1("number", e) && e >= 1e3 && e <= 9e3 && (this._typingIndicatorThrottle = e);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "websocketResponseTimeout", {
    get: function () {
      return this._websocketResponseTimeout;
    },
    set: function (e) {
      w$1("number", e) && e >= 5e3 && e <= 3e4 && (this._websocketResponseTimeout = e);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "sessionTokenRefreshTimeout", {
    get: function () {
      return this._sessionTokenRefreshTimeout;
    },
    set: function (e) {
      w$1("number", e) && (e < 60 ? e = 60 : e > 1800 && (e = 1800), this._sessionTokenRefreshTimeout = e);
    },
    enumerable: !1,
    configurable: !0
  }), e;
}(),
    R$2 = {
  encrypt: function (e) {
    return e;
  },
  decrypt: function (e) {
    return e;
  }
},
    D$2 = function () {
  function e(e) {
    var t = e.store;
    this._preference = new Map(), this._store = t;
  }

  return e.prototype._savePreferenceKeys = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, this._store.set({
              key: this._keysAddress,
              value: c$1([], a$1(this._preference.keys()), !1)
            })];

          case 1:
            return e.sent(), [2];
        }
      });
    });
  }, e.prototype.init = function (e, t) {
    var n;
    return void 0 === t && (t = 1), i$1(this, void 0, void 0, function () {
      var r, i, a, c, u, l, h, d, _, f;

      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return this._version = t, this._keysAddress = e, r = "".concat(e, ".metadata.version"), [4, this._store.get(r)];

          case 1:
            return i = o.sent(), [4, this._store.get(e)];

          case 2:
            return a = null !== (n = o.sent()) && void 0 !== n ? n : [], !i || i.version < this._version ? [4, this._resetPreferenceData(a, r)] : [3, 4];

          case 3:
            return o.sent(), [3, 11];

          case 4:
            o.trys.push([4, 9, 10, 11]), c = s$2(a), u = c.next(), o.label = 5;

          case 5:
            return u.done ? [3, 8] : (l = u.value, [4, this._store.get(l)]);

          case 6:
            (h = o.sent()) && this._preference.set(l, h), o.label = 7;

          case 7:
            return u = c.next(), [3, 5];

          case 8:
            return [3, 11];

          case 9:
            return d = o.sent(), _ = {
              error: d
            }, [3, 11];

          case 10:
            try {
              u && !u.done && (f = c.return) && f.call(c);
            } finally {
              if (_) throw _.error;
            }

            return [7];

          case 11:
            return [2];
        }
      });
    });
  }, e.prototype._resetPreferenceData = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this._preference = new Map(), [4, this._store.removeMany(e)];

          case 1:
            return n.sent(), [4, this._store.set({
              key: t,
              value: {
                version: this._version
              }
            })];

          case 2:
            return n.sent(), [2];
        }
      });
    });
  }, e.prototype.get = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return [2, this._preference.get(e)];
      });
    });
  }, e.prototype.set = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = !this._preference.has(e), [4, this._store.set({
              key: e,
              value: t
            })];

          case 1:
            return r.sent(), this._preference.set(e, t), n ? [4, this._savePreferenceKeys()] : [3, 3];

          case 2:
            r.sent(), r.label = 3;

          case 3:
            return [2];
        }
      });
    });
  }, e.prototype.remove = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._store.remove(e)];

          case 1:
            return t.sent(), this._preference.delete(e), [4, this._savePreferenceKeys()];

          case 2:
            return t.sent(), [2];
        }
      });
    });
  }, e.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, this._store.removeMany(c$1([], a$1(this._preference.keys()), !1))];

          case 1:
            return e.sent(), this._preference.clear(), [4, this._savePreferenceKeys()];

          case 2:
            return e.sent(), [2];
        }
      });
    });
  }, e;
}(),
    L$2 = function () {
  function e(e) {
    var t = e.encryption,
        n = e.store,
        r = e.localCacheEnabled,
        i = e.localCacheConfig;
    this.store = n, this.preference = new D$2({
      store: n
    }), this.encryption = null != t ? t : R$2, this.localCacheEnabled = r, this.localCacheConfig = i;
  }

  return e.prototype.replaceStore = function (e) {
    this.store = e, this.preference = new D$2({
      store: e
    });
  }, e;
}();

!function (e) {
  e.SUCCESS = "success", e.PENDING = "pending", e.ERROR = "error";
}(d$1 || (d$1 = {})), function (e) {
  e.DEFAULT = "default", e.ALL = "all", e.MENTION_ONLY = "mention_only", e.OFF = "off";
}(_$1 || (_$1 = {})), function (e) {
  e.FCM = "gcm", e.APNS = "apns", e.UNKNOWN = "unknown";
}(f$4 || (f$4 = {})), function (e) {
  e.ALTERNATIVE = "alternative", e.DEFAULT = "default";
}(p$2 || (p$2 = {})), function (e) {
  e.CUSTOM = "custom", e.MESSAGE_COLLECTION_ACCESSED_AT = "messagecollection_accessed_at";
}(E$1 || (E$1 = {}));

var x,
    U$1,
    M$1,
    P$1,
    z,
    F,
    H$1,
    V,
    G,
    q,
    j = function () {
  function e(e) {
    var t = e.channel,
        n = e.cachedMessageCount;
    this._cachedMessageCount = 0, this._channel = t, this._cachedMessageCount = n;
  }

  return Object.defineProperty(e.prototype, "channel", {
    get: function () {
      return this._channel;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "cachedMessageCount", {
    get: function () {
      return this._cachedMessageCount;
    },
    enumerable: !1,
    configurable: !0
  }), e;
}(),
    K = function () {
  function e(e) {
    var t = void 0 === e ? {} : e,
        n = t.maxSize,
        r = void 0 === n ? 256 : n,
        i = t.clearOrder,
        o = void 0 === i ? E$1.MESSAGE_COLLECTION_ACCESSED_AT : i,
        s = t.customClearOrderComparator;
    this._clearOrderComparatorUseMessageCollectionAccessedAt = function (e, t) {
      return e.channel.messageCollectionLastAccessedAt === t.channel.messageCollectionLastAccessedAt ? e.channel.lastMessage && !t.channel.lastMessage ? 1 : !e.channel.lastMessage && t.channel.lastMessage ? -1 : e.channel.lastMessage || t.channel.lastMessage ? e.channel.lastMessage.createdAt - t.channel.lastMessage.createdAt : 0 : e.channel.messageCollectionLastAccessedAt > t.channel.messageCollectionLastAccessedAt ? 1 : -1;
    }, this._maxSize = Math.max(r, 64), s ? (this._clearOrder = o, this._customClearOrderComparator = s) : this._clearOrder = E$1.MESSAGE_COLLECTION_ACCESSED_AT;
  }

  return Object.defineProperty(e.prototype, "maxSize", {
    get: function () {
      return this._maxSize;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "clearOrder", {
    get: function () {
      return this._clearOrder;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "clearOrderComparator", {
    get: function () {
      var e;
      return this._clearOrder === E$1.MESSAGE_COLLECTION_ACCESSED_AT ? this._clearOrderComparatorUseMessageCollectionAccessedAt : null !== (e = this._customClearOrderComparator) && void 0 !== e ? e : this._clearOrderComparatorUseMessageCollectionAccessedAt;
    },
    enumerable: !1,
    configurable: !0
  }), e;
}(),
    B = function () {
  function e() {}

  return Object.defineProperty(e.prototype, "hasSession", {
    get: function () {
      return !!this.sessionKey;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.clear = function () {
    this.authToken = void 0, this.sessionKey = void 0;
  }, e;
}(),
    Z = function () {
  var e = new Date().getTime();
  return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (t) {
    var n = (e + 16 * Math.random()) % 16 | 0;
    return e = Math.floor(e / 16), ("x" === t ? n : 3 & n | 8).toString(16);
  });
},
    W = function () {
  function e(e) {
    var t = e.container;
    this._container = {}, this._container = t, this.key = Z();
  }

  return e.prototype._register = function (e, t, n) {
    var r;
    return e in this._container || (this._container[e] = new Map()), null === (r = this._container[e]) || void 0 === r || r.set(this.key, {
      occurence: t,
      handler: n
    }), this;
  }, e.prototype.on = function (e, t) {
    return this._register(e, -1, t);
  }, e.prototype.once = function (e, t) {
    return this._register(e, 1, t);
  }, e.prototype.close = function () {
    var e;

    for (var t in this._container) null === (e = this._container[t]) || void 0 === e || e.delete(this.key);
  }, e;
}(),
    Q = function () {
  function e() {
    this._container = {};
  }

  return e.prototype.on = function (e, t) {
    return new W({
      container: this._container
    }).on(e, t);
  }, e.prototype.once = function (e, t) {
    return new W({
      container: this._container
    }).once(e, t);
  }, e.prototype.dispatch = function (e, t) {
    var n,
        r,
        i = this._container[e];

    if (i) {
      var o = [];

      try {
        for (var a = s$2(i.keys()), c = a.next(); !c.done; c = a.next()) {
          var u = c.value,
              l = i.get(u);
          l.handler(t), l.occurence > 0 && (l.occurence--, 0 === l.occurence && o.push(u));
        }
      } catch (e) {
        n = {
          error: e
        };
      } finally {
        try {
          c && !c.done && (r = a.return) && r.call(a);
        } finally {
          if (n) throw n.error;
        }
      }

      o.forEach(function (e) {
        return i.delete(e);
      });
    }
  }, e;
}(),
    Y = function () {
  function e() {
    this._dispatcher = new Q();
  }

  return e.prototype.on = function (e) {
    return this._dispatcher.on("event", e);
  }, e.prototype.once = function (e) {
    return this._dispatcher.once("event", e);
  }, e.prototype.dispatch = function (e) {
    this._dispatcher.dispatch("event", e);
  }, e;
}(),
    X = function () {},
    J = function (e) {
  var t = {};
  return e && Object.keys(e).forEach(function (n) {
    void 0 === e[n] || Number.isNaN(e[n]) || null === e[n] || (t[n] = e[n]);
  }), t;
},
    $ = function (e) {
  if (null != e) {
    if ("object" == typeof e) {
      if (Array.isArray(e)) {
        var t = c$1([], a$1(e), !1);

        for (var n in t) t[n] = $(t[n]);

        return t;
      }

      for (var r in e) null === e[r] && delete e[r];

      return e;
    }

    return e;
  }
};

!function (e) {
  e.BASE = "base", e.GROUP = "group", e.OPEN = "open", e.FEED = "feed";
}(x || (x = {})), function (e) {
  e.OPERATOR = "operator", e.NONE = "none";
}(U$1 || (U$1 = {})), function (e) {
  e.MUTED = "muted", e.UNMUTED = "unmuted";
}(M$1 || (M$1 = {})), function (e) {
  e.BASE = "base", e.USER = "user", e.FILE = "file", e.ADMIN = "admin";
}(P$1 || (P$1 = {})), function (e) {
  e.ALL = "", e.USER = "MESG", e.FILE = "FILE", e.ADMIN = "ADMM";
}(z || (z = {})), function (e) {
  e.USER = "MESG", e.FILE = "FILE", e.ADMIN = "ADMM";
}(F || (F = {})), function (e) {
  e.USERS = "users", e.CHANNEL = "channel";
}(H$1 || (H$1 = {})), function (e) {
  e.ALL = "all", e.NONE = "none", e.ONLY_REPLY_TO_CHANNEL = "only_reply_to_channel";
}(V || (V = {})), function (e) {
  e.DEFAULT = "default", e.SUPPRESS = "suppress";
}(G || (G = {})), function (e) {
  e.PENDING = "pending", e.SCHEDULED = "scheduled", e.SUCCEEDED = "succeeded", e.FAILED = "failed", e.CANCELED = "canceled";
}(q || (q = {}));

var ee,
    te = "v3",
    ne = "/".concat(te, "/users"),
    re = "/".concat(te, "/storage/file"),
    ie = "/".concat(te, "/group_channels"),
    oe = "/".concat(te, "/sdk/group_channels"),
    se = "/".concat(te, "/open_channels"),
    ae = "/".concat(te, "/sdk/open_channels"),
    ce = "/".concat(te, "/search"),
    ue = "/".concat(te, "/report"),
    le$1 = "/".concat(te, "/emojis"),
    he$1 = "/".concat(te, "/emoji_categories"),
    de$1 = "/".concat(te, "/polls"),
    _e$1 = "/".concat(te, "/scheduled_messages"),
    fe$1 = "/".concat(te, "/sdk/ui_kit/configuration"),
    pe$1 = "/".concat(te, "/sdk/statistics"),
    ge$1 = function (e) {
  switch (e) {
    case x.FEED:
    case x.GROUP:
      return ie;

    case x.OPEN:
      return se;

    default:
      return null;
  }
},
    ve$1 = function (e) {
  switch (e) {
    case x.GROUP:
      return "".concat(ue, "/group_channels");

    case x.OPEN:
      return "".concat(ue, "/open_channels");

    default:
      return null;
  }
},
    be$1 = function (e, t, n) {
  var r, i;

  switch (e) {
    case H$1.CHANNEL:
      return !0;

    case H$1.USERS:
      if (t) try {
        for (var o = s$2(t), a = o.next(); !a.done; a = o.next()) {
          if (a.value === n) return !0;
        }
      } catch (e) {
        r = {
          error: e
        };
      } finally {
        try {
          a && !a.done && (i = o.return) && i.call(o);
        } finally {
          if (r) throw r.error;
        }
      }
  }

  return !1;
},
    me$1 = function (e, t, n) {
  var r,
      i,
      o,
      s,
      a = be$1(null !== (r = e.mentionType) && void 0 !== r ? r : null, null !== (i = e.mentionedUserIds) && void 0 !== i ? i : [], n),
      c = be$1(null !== (o = t.mentionType) && void 0 !== o ? o : null, null !== (s = t.mentionedUserIds) && void 0 !== s ? s : [], n);
  return !a && c ? 1 : a && !c ? -1 : 0;
},
    ye$1 = function (e, t, n) {
  var r,
      i = t || new FormData();

  for (var o in e) if (Object.prototype.hasOwnProperty.call(e, o)) {
    var s = e[o],
        a = n ? "".concat(n, "[").concat(o, "]") : o;
    k(s) ? i.append(a, s, null !== (r = s.name) && void 0 !== r ? r : "filename") : "object" != typeof s || null === s || Array.isArray(s) || s instanceof Blob ? i.append(a, String(s)) : i = ye$1(s, i, a);
  }

  return i;
};

!function (e) {
  e.GET = "GET", e.POST = "POST", e.PUT = "PUT", e.DELETE = "DELETE";
}(ee || (ee = {}));

var we$2,
    Ne$2 = function (e) {
  function n() {
    var t = null !== e && e.apply(this, arguments) || this;
    return t.params = {}, t.requireAuth = !0, t.headers = {}, t.requestId = Z(), t;
  }

  return t$1(n, e), n.prototype.encodeParams = function (e) {
    var t = this;
    return null == e || "" === e ? encodeURIComponent("") : Array.isArray(e) ? e.map(function (e) {
      return t.encodeParams(e);
    }).join(",") : "object" == typeof e ? encodeURIComponent(JSON.stringify(e)) : encodeURIComponent(String(e));
  }, Object.defineProperty(n.prototype, "query", {
    get: function () {
      var e = this,
          t = J(this.params);
      return "?".concat(Object.keys(t).map(function (n) {
        return "".concat(encodeURIComponent(n), "=").concat(e.encodeParams(t[n]));
      }).join("&"));
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "payload", {
    get: function () {
      var e = J(this.params);
      return Object.keys(e).some(function (t) {
        return k(e[t]);
      }) ? ye$1(e) : JSON.stringify(e);
    },
    enumerable: !1,
    configurable: !0
  }), n;
}(X),
    Te$2 = function (e) {
  function r(t, n) {
    var r = e.call(this) || this;
    return r._iid = t, r._payload = n, r;
  }

  return t$1(r, e), Object.defineProperty(r.prototype, "payload", {
    get: function () {
      return n$1({}, this._payload);
    },
    enumerable: !1,
    configurable: !0
  }), r.prototype.as = function (e) {
    return new e(this._iid, this.payload);
  }, r;
}(X),
    Se$1 = function (e) {
  function n(t) {
    var n = e.call(this) || this;
    return n.requestId = t, n;
  }

  return t$1(n, e), n;
}(X),
    Ae$1 = function (e) {
  function n(t) {
    var n = t.expires_in,
        r = t.reason,
        i = void 0 === r ? u$1.SESSION_KEY_EXPIRED : r,
        o = e.call(this) || this;

    switch (o.expiresIn = null != n ? n : 0, i) {
      case u$1.SESSION_KEY_EXPIRED:
      case u$1.SESSION_TOKEN_EXPIRED:
      case u$1.SESSION_REVOKED:
      case u$1.USER_AUTH_DEACTIVATED:
      case u$1.USER_AUTH_DELETED_OR_NOT_FOUND:
        o.error = new v$2({
          code: i
        });
    }

    return o;
  }

  return t$1(n, e), Object.defineProperty(n.prototype, "invalidateSessionToken", {
    get: function () {
      var e;
      return !!(null === (e = this.error) || void 0 === e ? void 0 : e.isSessionTokenExpiredError);
    },
    enumerable: !1,
    configurable: !0
  }), n;
}(X),
    Ce$2 = function (e) {
  function n(t) {
    var n = e.call(this) || this;
    return n.statLog = t, n;
  }

  return t$1(n, e), n;
}(X);

!function (e) {
  e.FEATURE_LOCALCACHE = "feature:local_cache", e.WEBSOCKET_CONNECT = "ws:connect", e.API_RESULT = "api:result";
}(we$2 || (we$2 = {}));

var ke$1,
    Oe$3,
    Ie$2,
    Re$2 = function () {
  function e(e) {
    var t = e.type,
        n = e.data,
        r = e.ts,
        i = void 0 === r ? Date.now() : r;
    this.type = t, this.createdAt = i, this.data = n;
  }

  return e.payloadify = function (e) {
    return J({
      stat_type: e.type,
      ts: e.createdAt,
      data: J(e.data)
    });
  }, e;
}(),
    De$3 = function () {
  return "undefined" == typeof document && "undefined" != typeof navigator && "ReactNative" == navigator.product;
},
    Le$1 = function () {
  return !("undefined" == typeof navigator || !/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent));
};

!function (e) {
  e.CHAT = "chat", e.CALLS = "calls", e.DESK = "desk", e.LIVE = "live", e.UIKIT_CHAT = "uikit-chat", e.UIKIT_LIVE = "uikit-live";
}(ke$1 || (ke$1 = {})), function (e) {
  e.ANDROID = "android", e.IOS = "ios", e.JS = "js", e.UNREAL = "unreal", e.UNITY = "unity", e.REACT_NATIVE = "react-native", e.FLUTTER = "flutter";
}(Oe$3 || (Oe$3 = {})), function (e) {
  e.ANDROID = "android", e.IOS = "ios", e.WEB = "web", e.MOBILE_WEB = "mobile_web", e.WINDOWS = "windows";
}(Ie$2 || (Ie$2 = {}));

var xe$2 = "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
    Ue$2 = function () {
  function e() {}

  return e.sendbirdSdkUserAgentWithExtension = function (e) {
    var t = De$3() ? Oe$3.REACT_NATIVE : Oe$3.JS,
        r = {
      main_sdk_info: "chat/".concat(t, "/").concat(h$1.SDK_VERSION),
      device_os_platform: Le$1() ? "mobile-web" : "web",
      os_version: h$1.OS_VERSION
    };

    if (e) {
      var i = e.sendbirdExtensions,
          o = e.deviceOS,
          s = e.customData,
          c = void 0 === s ? {} : s;
      o.version && (r.os_version = o.version), o.platform && (r.device_os_platform = o.platform), i.length > 0 && (r.extension_sdk_info = i.map(function (e) {
        var t = e.product,
            n = e.platform,
            r = e.version;
        return "".concat(t, "/").concat(n, "/").concat(r);
      }).join(",")), Object.keys(r).forEach(function (e) {
        return delete c[e];
      }), Object.keys(c).length > 0 && (r = n$1(n$1({}, r), c));
    }

    return Object.entries(r).map(function (e) {
      var t = a$1(e, 2),
          n = t[0],
          r = t[1];
      return "".concat(n, "=").concat(r);
    }).join("&");
  }, e.userAgentWithExtension = function (e) {
    var t = De$3() ? "reactnative" : "JS",
        n = e.sb_syncmanager ? "s".concat(e.sb_syncmanager) : "",
        r = e.sb_uikit ? "u".concat(e.sb_uikit) : "",
        i = e["device-os-platform"] ? "o".concat(e["device-os-platform"]) : Le$1() ? "omobile-web" : "oweb";
    return "".concat(t, "/c").concat(h$1.SDK_VERSION, "/").concat(n, "/").concat(r, "/").concat(i);
  }, e;
}(),
    Me$2 = function () {
  function e(e, t) {
    var n = t.auth,
        r = t.sdkState,
        i = t.dispatcher,
        o = t.logger,
        s = t.useFetchCompat,
        a = void 0 !== s && s,
        c = this;
    this._abortControl = new Map(), this._shouldImportFetchCompat = !1, this._iid = e, this._auth = n, this._sdkState = r, this._dispatcher = i, this._dispatcher.on(function (e) {
      e instanceof Se$1 && c.cancel(e.requestId);
    }), this._logger = o, this._shouldImportFetchCompat = a;
  }

  return e.prototype._createHeader = function (e, t) {
    var r = this._sdkState,
        i = r.appId,
        o = r.appVersion,
        s = r.sendbirdRuntimeEnvironment,
        a = n$1(n$1({}, e.headers), {
      SendBird: "JS,".concat(h$1.OS_VERSION, ",").concat(h$1.SDK_VERSION, ",").concat(i).concat(o ? ",".concat(o) : ""),
      "SB-User-Agent": Ue$2.userAgentWithExtension(this._sdkState.extensions),
      "Request-Sent-Timestamp": Date.now().toString(),
      "SB-SDK-User-Agent": Ue$2.sendbirdSdkUserAgentWithExtension(s)
    });
    return t || (a["Content-Type"] = "application/json; charset=utf-8"), e.requireAuth && this._auth.hasSession && (a["Session-Key"] = this._auth.sessionKey), this._auth && this._auth.authToken && (a["App-Id"] = i, a["Access-Token"] = this._auth.authToken), a;
  }, e.prototype._statLogApiResult = function (e, t, n) {
    this._dispatcher.dispatch(new Ce$2(new Re$2({
      type: we$2.API_RESULT,
      data: {
        endpoint: e.path,
        method: e.method,
        success: !n,
        latency: Date.now() - t,
        error_code: null == n ? void 0 : n.code,
        error_description: null == n ? void 0 : n.message
      }
    })));
  }, e.prototype.send = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a, c, u, l, h, d, _, f, p, E;

      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            t = e.path, n = e.method, r = ![ee.GET, ee.DELETE].includes(n), i = this._sdkState.api, s = "".concat(i.host).concat(t).concat(r ? "" : e.query), a = r ? e.payload : null, c = this._createHeader(e, a instanceof FormData ? a : void 0), u = new AbortController(), l = u.signal, this._abortControl.set(e.requestId, u), h = Date.now(), o.label = 1;

          case 1:
            return o.trys.push([1, 8,, 9]), this._shouldImportFetchCompat && (this._shouldImportFetchCompat = !1, ("undefined" != typeof globalThis && globalThis || "undefined" != typeof self && self || "undefined" != typeof global && global || {
              fetch: null
            }).fetch = null), "undefined" != typeof AbortController ? [3, 3] : [4, Promise.resolve().then(function () { return __bundle2aa1a987; })];

          case 2:
            o.sent(), o.label = 3;

          case 3:
            return "function" == typeof fetch ? [3, 5] : [4, Promise.resolve().then(function () { return __bundle40c7abbd; })];

          case 4:
            o.sent(), o.label = 5;

          case 5:
            return [4, fetch(s, {
              method: n,
              body: a,
              headers: c,
              signal: l
            })];

          case 6:
            return [4, (d = o.sent()).json()];

          case 7:
            if (_ = o.sent(), d.ok || d.redirected) return this._logger.debug("receive api response", e.requestId), this._statLogApiResult(e, h), [2, new Te$2(this._iid, _)];
            throw _ ? (((f = new v$2(_)).isSessionKeyExpiredError || f.isSessionTokenExpiredError) && this._dispatcher.dispatch(new Ae$1({
              reason: f.code
            })), this._statLogApiResult(e, h, f), f) : (f = v$2.requestFailed, this._statLogApiResult(e, h, f), f);

          case 8:
            throw p = o.sent(), this._statLogApiResult(e, h, p), p instanceof v$2 ? (this._logger.debug("fail api request", p), p) : "AbortError" === p.name ? v$2.requestCanceled : (E = v$2.networkError, this._logger.debug("fail api request", E), E);

          case 9:
            return [2];
        }
      });
    });
  }, e.prototype.cancel = function (e) {
    this._abortControl.has(e) && (this._abortControl.get(e).abort(), this._abortControl.delete(e));
  }, e.prototype.cancelAll = function () {
    var e, t;

    try {
      for (var n = s$2(this._abortControl.values()), r = n.next(); !r.done; r = n.next()) {
        r.value.abort();
      }
    } catch (t) {
      e = {
        error: t
      };
    } finally {
      try {
        r && !r.done && (t = n.return) && t.call(n);
      } finally {
        if (e) throw e.error;
      }
    }

    this._abortControl.clear();
  }, e;
}(),
    Pe$3 = function (e) {
  function n(t, n, r, i) {
    void 0 === i && (i = "");
    var o,
        s = this;
    return (s = e.call(this) || this)._iid = t, s.code = n, s.payload = r, s.requestId = null !== (o = r.req_id) && void 0 !== o ? o : i, s;
  }

  return t$1(n, e), n.createFromRawMessage = function (e, t) {
    var r = t.substring(0, 4),
        i = {};

    try {
      i = JSON.parse(t.substring(4));
    } catch (e) {
      r = "NOOP";
    } finally {
      return new n(e, r, i);
    }
  }, n.prototype.convertToMessage = function () {
    return "".concat(this.code).concat(JSON.stringify(this.payload), "\n");
  }, n.prototype.as = function (e) {
    return new e(this._iid, this.code, this.payload);
  }, n;
}(X),
    ze$2 = function () {};

function Fe$1(e) {
  let t = e.length;

  for (; --t >= 0;) e[t] = 0;
}

const He$3 = 256,
      Ve$2 = 286,
      Ge$1 = 30,
      qe$2 = 15,
      je$2 = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0]),
      Ke$2 = new Uint8Array([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13]),
      Be$2 = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7]),
      Ze$1 = new Uint8Array([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]),
      We$2 = new Array(576);
Fe$1(We$2);
const Qe$2 = new Array(60);
Fe$1(Qe$2);
const Ye$2 = new Array(512);
Fe$1(Ye$2);
const Xe$2 = new Array(256);
Fe$1(Xe$2);
const Je$2 = new Array(29);
Fe$1(Je$2);
const $e$1 = new Array(Ge$1);

function et$1(e, t, n, r, i) {
  this.static_tree = e, this.extra_bits = t, this.extra_base = n, this.elems = r, this.max_length = i, this.has_stree = e && e.length;
}

let tt$1, nt$1, rt$1;

function it$2(e, t) {
  this.dyn_tree = e, this.max_code = 0, this.stat_desc = t;
}

Fe$1($e$1);

const ot$2 = e => e < 256 ? Ye$2[e] : Ye$2[256 + (e >>> 7)],
      st$2 = (e, t) => {
  e.pending_buf[e.pending++] = 255 & t, e.pending_buf[e.pending++] = t >>> 8 & 255;
},
      at$2 = (e, t, n) => {
  e.bi_valid > 16 - n ? (e.bi_buf |= t << e.bi_valid & 65535, st$2(e, e.bi_buf), e.bi_buf = t >> 16 - e.bi_valid, e.bi_valid += n - 16) : (e.bi_buf |= t << e.bi_valid & 65535, e.bi_valid += n);
},
      ct$2 = (e, t, n) => {
  at$2(e, n[2 * t], n[2 * t + 1]);
},
      ut$2 = (e, t) => {
  let n = 0;

  do {
    n |= 1 & e, e >>>= 1, n <<= 1;
  } while (--t > 0);

  return n >>> 1;
},
      lt$2 = (e, t, n) => {
  const r = new Array(16);
  let i,
      o,
      s = 0;

  for (i = 1; i <= qe$2; i++) s = s + n[i - 1] << 1, r[i] = s;

  for (o = 0; o <= t; o++) {
    let t = e[2 * o + 1];
    0 !== t && (e[2 * o] = ut$2(r[t]++, t));
  }
},
      ht$2 = e => {
  let t;

  for (t = 0; t < Ve$2; t++) e.dyn_ltree[2 * t] = 0;

  for (t = 0; t < Ge$1; t++) e.dyn_dtree[2 * t] = 0;

  for (t = 0; t < 19; t++) e.bl_tree[2 * t] = 0;

  e.dyn_ltree[512] = 1, e.opt_len = e.static_len = 0, e.sym_next = e.matches = 0;
},
      dt$2 = e => {
  e.bi_valid > 8 ? st$2(e, e.bi_buf) : e.bi_valid > 0 && (e.pending_buf[e.pending++] = e.bi_buf), e.bi_buf = 0, e.bi_valid = 0;
},
      _t$2 = (e, t, n, r) => {
  const i = 2 * t,
        o = 2 * n;
  return e[i] < e[o] || e[i] === e[o] && r[t] <= r[n];
},
      ft$2 = (e, t, n) => {
  const r = e.heap[n];
  let i = n << 1;

  for (; i <= e.heap_len && (i < e.heap_len && _t$2(t, e.heap[i + 1], e.heap[i], e.depth) && i++, !_t$2(t, r, e.heap[i], e.depth));) e.heap[n] = e.heap[i], n = i, i <<= 1;

  e.heap[n] = r;
},
      pt$2 = (e, t, n) => {
  let r,
      i,
      o,
      s,
      a = 0;
  if (0 !== e.sym_next) do {
    r = 255 & e.pending_buf[e.sym_buf + a++], r += (255 & e.pending_buf[e.sym_buf + a++]) << 8, i = e.pending_buf[e.sym_buf + a++], 0 === r ? ct$2(e, i, t) : (o = Xe$2[i], ct$2(e, o + He$3 + 1, t), s = je$2[o], 0 !== s && (i -= Je$2[o], at$2(e, i, s)), r--, o = ot$2(r), ct$2(e, o, n), s = Ke$2[o], 0 !== s && (r -= $e$1[o], at$2(e, r, s)));
  } while (a < e.sym_next);
  ct$2(e, 256, t);
},
      Et$2 = (e, t) => {
  const n = t.dyn_tree,
        r = t.stat_desc.static_tree,
        i = t.stat_desc.has_stree,
        o = t.stat_desc.elems;
  let s,
      a,
      c,
      u = -1;

  for (e.heap_len = 0, e.heap_max = 573, s = 0; s < o; s++) 0 !== n[2 * s] ? (e.heap[++e.heap_len] = u = s, e.depth[s] = 0) : n[2 * s + 1] = 0;

  for (; e.heap_len < 2;) c = e.heap[++e.heap_len] = u < 2 ? ++u : 0, n[2 * c] = 1, e.depth[c] = 0, e.opt_len--, i && (e.static_len -= r[2 * c + 1]);

  for (t.max_code = u, s = e.heap_len >> 1; s >= 1; s--) ft$2(e, n, s);

  c = o;

  do {
    s = e.heap[1], e.heap[1] = e.heap[e.heap_len--], ft$2(e, n, 1), a = e.heap[1], e.heap[--e.heap_max] = s, e.heap[--e.heap_max] = a, n[2 * c] = n[2 * s] + n[2 * a], e.depth[c] = (e.depth[s] >= e.depth[a] ? e.depth[s] : e.depth[a]) + 1, n[2 * s + 1] = n[2 * a + 1] = c, e.heap[1] = c++, ft$2(e, n, 1);
  } while (e.heap_len >= 2);

  e.heap[--e.heap_max] = e.heap[1], ((e, t) => {
    const n = t.dyn_tree,
          r = t.max_code,
          i = t.stat_desc.static_tree,
          o = t.stat_desc.has_stree,
          s = t.stat_desc.extra_bits,
          a = t.stat_desc.extra_base,
          c = t.stat_desc.max_length;

    let u,
        l,
        h,
        d,
        _,
        f,
        p = 0;

    for (d = 0; d <= qe$2; d++) e.bl_count[d] = 0;

    for (n[2 * e.heap[e.heap_max] + 1] = 0, u = e.heap_max + 1; u < 573; u++) l = e.heap[u], d = n[2 * n[2 * l + 1] + 1] + 1, d > c && (d = c, p++), n[2 * l + 1] = d, l > r || (e.bl_count[d]++, _ = 0, l >= a && (_ = s[l - a]), f = n[2 * l], e.opt_len += f * (d + _), o && (e.static_len += f * (i[2 * l + 1] + _)));

    if (0 !== p) {
      do {
        for (d = c - 1; 0 === e.bl_count[d];) d--;

        e.bl_count[d]--, e.bl_count[d + 1] += 2, e.bl_count[c]--, p -= 2;
      } while (p > 0);

      for (d = c; 0 !== d; d--) for (l = e.bl_count[d]; 0 !== l;) h = e.heap[--u], h > r || (n[2 * h + 1] !== d && (e.opt_len += (d - n[2 * h + 1]) * n[2 * h], n[2 * h + 1] = d), l--);
    }
  })(e, t), lt$2(n, u, e.bl_count);
},
      gt$2 = (e, t, n) => {
  let r,
      i,
      o = -1,
      s = t[1],
      a = 0,
      c = 7,
      u = 4;

  for (0 === s && (c = 138, u = 3), t[2 * (n + 1) + 1] = 65535, r = 0; r <= n; r++) i = s, s = t[2 * (r + 1) + 1], ++a < c && i === s || (a < u ? e.bl_tree[2 * i] += a : 0 !== i ? (i !== o && e.bl_tree[2 * i]++, e.bl_tree[32]++) : a <= 10 ? e.bl_tree[34]++ : e.bl_tree[36]++, a = 0, o = i, 0 === s ? (c = 138, u = 3) : i === s ? (c = 6, u = 3) : (c = 7, u = 4));
},
      vt$2 = (e, t, n) => {
  let r,
      i,
      o = -1,
      s = t[1],
      a = 0,
      c = 7,
      u = 4;

  for (0 === s && (c = 138, u = 3), r = 0; r <= n; r++) if (i = s, s = t[2 * (r + 1) + 1], !(++a < c && i === s)) {
    if (a < u) do {
      ct$2(e, i, e.bl_tree);
    } while (0 != --a);else 0 !== i ? (i !== o && (ct$2(e, i, e.bl_tree), a--), ct$2(e, 16, e.bl_tree), at$2(e, a - 3, 2)) : a <= 10 ? (ct$2(e, 17, e.bl_tree), at$2(e, a - 3, 3)) : (ct$2(e, 18, e.bl_tree), at$2(e, a - 11, 7));
    a = 0, o = i, 0 === s ? (c = 138, u = 3) : i === s ? (c = 6, u = 3) : (c = 7, u = 4);
  }
};

let bt$2 = !1;

const mt$2 = (e, t, n, r) => {
  at$2(e, 0 + (r ? 1 : 0), 3), dt$2(e), st$2(e, n), st$2(e, ~n), n && e.pending_buf.set(e.window.subarray(t, t + n), e.pending), e.pending += n;
};

var yt$2 = (e, t, n, r) => {
  let i,
      o,
      s = 0;
  e.level > 0 ? (2 === e.strm.data_type && (e.strm.data_type = (e => {
    let t,
        n = 4093624447;

    for (t = 0; t <= 31; t++, n >>>= 1) if (1 & n && 0 !== e.dyn_ltree[2 * t]) return 0;

    if (0 !== e.dyn_ltree[18] || 0 !== e.dyn_ltree[20] || 0 !== e.dyn_ltree[26]) return 1;

    for (t = 32; t < He$3; t++) if (0 !== e.dyn_ltree[2 * t]) return 1;

    return 0;
  })(e)), Et$2(e, e.l_desc), Et$2(e, e.d_desc), s = (e => {
    let t;

    for (gt$2(e, e.dyn_ltree, e.l_desc.max_code), gt$2(e, e.dyn_dtree, e.d_desc.max_code), Et$2(e, e.bl_desc), t = 18; t >= 3 && 0 === e.bl_tree[2 * Ze$1[t] + 1]; t--);

    return e.opt_len += 3 * (t + 1) + 5 + 5 + 4, t;
  })(e), i = e.opt_len + 3 + 7 >>> 3, o = e.static_len + 3 + 7 >>> 3, o <= i && (i = o)) : i = o = n + 5, n + 4 <= i && -1 !== t ? mt$2(e, t, n, r) : 4 === e.strategy || o === i ? (at$2(e, 2 + (r ? 1 : 0), 3), pt$2(e, We$2, Qe$2)) : (at$2(e, 4 + (r ? 1 : 0), 3), ((e, t, n, r) => {
    let i;

    for (at$2(e, t - 257, 5), at$2(e, n - 1, 5), at$2(e, r - 4, 4), i = 0; i < r; i++) at$2(e, e.bl_tree[2 * Ze$1[i] + 1], 3);

    vt$2(e, e.dyn_ltree, t - 1), vt$2(e, e.dyn_dtree, n - 1);
  })(e, e.l_desc.max_code + 1, e.d_desc.max_code + 1, s + 1), pt$2(e, e.dyn_ltree, e.dyn_dtree)), ht$2(e), r && dt$2(e);
},
    wt$3 = {
  _tr_init: e => {
    bt$2 || ((() => {
      let e, t, n, r, i;
      const o = new Array(16);

      for (n = 0, r = 0; r < 28; r++) for (Je$2[r] = n, e = 0; e < 1 << je$2[r]; e++) Xe$2[n++] = r;

      for (Xe$2[n - 1] = r, i = 0, r = 0; r < 16; r++) for ($e$1[r] = i, e = 0; e < 1 << Ke$2[r]; e++) Ye$2[i++] = r;

      for (i >>= 7; r < Ge$1; r++) for ($e$1[r] = i << 7, e = 0; e < 1 << Ke$2[r] - 7; e++) Ye$2[256 + i++] = r;

      for (t = 0; t <= qe$2; t++) o[t] = 0;

      for (e = 0; e <= 143;) We$2[2 * e + 1] = 8, e++, o[8]++;

      for (; e <= 255;) We$2[2 * e + 1] = 9, e++, o[9]++;

      for (; e <= 279;) We$2[2 * e + 1] = 7, e++, o[7]++;

      for (; e <= 287;) We$2[2 * e + 1] = 8, e++, o[8]++;

      for (lt$2(We$2, 287, o), e = 0; e < Ge$1; e++) Qe$2[2 * e + 1] = 5, Qe$2[2 * e] = ut$2(e, 5);

      tt$1 = new et$1(We$2, je$2, 257, Ve$2, qe$2), nt$1 = new et$1(Qe$2, Ke$2, 0, Ge$1, qe$2), rt$1 = new et$1(new Array(0), Be$2, 0, 19, 7);
    })(), bt$2 = !0), e.l_desc = new it$2(e.dyn_ltree, tt$1), e.d_desc = new it$2(e.dyn_dtree, nt$1), e.bl_desc = new it$2(e.bl_tree, rt$1), e.bi_buf = 0, e.bi_valid = 0, ht$2(e);
  },
  _tr_stored_block: mt$2,
  _tr_flush_block: yt$2,
  _tr_tally: (e, t, n) => (e.pending_buf[e.sym_buf + e.sym_next++] = t, e.pending_buf[e.sym_buf + e.sym_next++] = t >> 8, e.pending_buf[e.sym_buf + e.sym_next++] = n, 0 === t ? e.dyn_ltree[2 * n]++ : (e.matches++, t--, e.dyn_ltree[2 * (Xe$2[n] + He$3 + 1)]++, e.dyn_dtree[2 * ot$2(t)]++), e.sym_next === e.sym_end),
  _tr_align: e => {
    at$2(e, 2, 3), ct$2(e, 256, We$2), (e => {
      16 === e.bi_valid ? (st$2(e, e.bi_buf), e.bi_buf = 0, e.bi_valid = 0) : e.bi_valid >= 8 && (e.pending_buf[e.pending++] = 255 & e.bi_buf, e.bi_buf >>= 8, e.bi_valid -= 8);
    })(e);
  }
};

var Nt$3 = (e, t, n, r) => {
  let i = 65535 & e | 0,
      o = e >>> 16 & 65535 | 0,
      s = 0;

  for (; 0 !== n;) {
    s = n > 2e3 ? 2e3 : n, n -= s;

    do {
      i = i + t[r++] | 0, o = o + i | 0;
    } while (--s);

    i %= 65521, o %= 65521;
  }

  return i | o << 16 | 0;
};

const Tt$3 = new Uint32Array((() => {
  let e,
      t = [];

  for (var n = 0; n < 256; n++) {
    e = n;

    for (var r = 0; r < 8; r++) e = 1 & e ? 3988292384 ^ e >>> 1 : e >>> 1;

    t[n] = e;
  }

  return t;
})());

var St$3 = (e, t, n, r) => {
  const i = Tt$3,
        o = r + n;
  e ^= -1;

  for (let n = r; n < o; n++) e = e >>> 8 ^ i[255 & (e ^ t[n])];

  return -1 ^ e;
},
    At$3 = {
  2: "need dictionary",
  1: "stream end",
  0: "",
  "-1": "file error",
  "-2": "stream error",
  "-3": "data error",
  "-4": "insufficient memory",
  "-5": "buffer error",
  "-6": "incompatible version"
},
    Ct$2 = {
  Z_NO_FLUSH: 0,
  Z_PARTIAL_FLUSH: 1,
  Z_SYNC_FLUSH: 2,
  Z_FULL_FLUSH: 3,
  Z_FINISH: 4,
  Z_BLOCK: 5,
  Z_TREES: 6,
  Z_OK: 0,
  Z_STREAM_END: 1,
  Z_NEED_DICT: 2,
  Z_ERRNO: -1,
  Z_STREAM_ERROR: -2,
  Z_DATA_ERROR: -3,
  Z_MEM_ERROR: -4,
  Z_BUF_ERROR: -5,
  Z_NO_COMPRESSION: 0,
  Z_BEST_SPEED: 1,
  Z_BEST_COMPRESSION: 9,
  Z_DEFAULT_COMPRESSION: -1,
  Z_FILTERED: 1,
  Z_HUFFMAN_ONLY: 2,
  Z_RLE: 3,
  Z_FIXED: 4,
  Z_DEFAULT_STRATEGY: 0,
  Z_BINARY: 0,
  Z_TEXT: 1,
  Z_UNKNOWN: 2,
  Z_DEFLATED: 8
};

const {
  _tr_init: kt$3,
  _tr_stored_block: Ot$3,
  _tr_flush_block: It$3,
  _tr_tally: Rt$3,
  _tr_align: Dt$3
} = wt$3,
      {
  Z_NO_FLUSH: Lt$3,
  Z_PARTIAL_FLUSH: xt$3,
  Z_FULL_FLUSH: Ut$3,
  Z_FINISH: Mt$2,
  Z_BLOCK: Pt$3,
  Z_OK: zt$3,
  Z_STREAM_END: Ft$3,
  Z_STREAM_ERROR: Ht$3,
  Z_DATA_ERROR: Vt$3,
  Z_BUF_ERROR: Gt$3,
  Z_DEFAULT_COMPRESSION: qt$3,
  Z_FILTERED: jt$3,
  Z_HUFFMAN_ONLY: Kt$3,
  Z_RLE: Bt$3,
  Z_FIXED: Zt$3,
  Z_DEFAULT_STRATEGY: Wt$3,
  Z_UNKNOWN: Qt$3,
  Z_DEFLATED: Yt$2
} = Ct$2,
      Xt$3 = 258,
      Jt$3 = 262,
      $t$3 = 42,
      en$3 = 113,
      tn$3 = 666,
      nn$3 = (e, t) => (e.msg = At$3[t], t),
      rn$3 = e => 2 * e - (e > 4 ? 9 : 0),
      on$3 = e => {
  let t = e.length;

  for (; --t >= 0;) e[t] = 0;
},
      sn$3 = e => {
  let t,
      n,
      r,
      i = e.w_size;
  t = e.hash_size, r = t;

  do {
    n = e.head[--r], e.head[r] = n >= i ? n - i : 0;
  } while (--t);

  t = i, r = t;

  do {
    n = e.prev[--r], e.prev[r] = n >= i ? n - i : 0;
  } while (--t);
};

let an$3 = (e, t, n) => (t << e.hash_shift ^ n) & e.hash_mask;

const cn$3 = e => {
  const t = e.state;
  let n = t.pending;
  n > e.avail_out && (n = e.avail_out), 0 !== n && (e.output.set(t.pending_buf.subarray(t.pending_out, t.pending_out + n), e.next_out), e.next_out += n, t.pending_out += n, e.total_out += n, e.avail_out -= n, t.pending -= n, 0 === t.pending && (t.pending_out = 0));
},
      un$3 = (e, t) => {
  It$3(e, e.block_start >= 0 ? e.block_start : -1, e.strstart - e.block_start, t), e.block_start = e.strstart, cn$3(e.strm);
},
      ln$3 = (e, t) => {
  e.pending_buf[e.pending++] = t;
},
      hn$3 = (e, t) => {
  e.pending_buf[e.pending++] = t >>> 8 & 255, e.pending_buf[e.pending++] = 255 & t;
},
      dn$3 = (e, t, n, r) => {
  let i = e.avail_in;
  return i > r && (i = r), 0 === i ? 0 : (e.avail_in -= i, t.set(e.input.subarray(e.next_in, e.next_in + i), n), 1 === e.state.wrap ? e.adler = Nt$3(e.adler, t, i, n) : 2 === e.state.wrap && (e.adler = St$3(e.adler, t, i, n)), e.next_in += i, e.total_in += i, i);
},
      _n$2 = (e, t) => {
  let n,
      r,
      i = e.max_chain_length,
      o = e.strstart,
      s = e.prev_length,
      a = e.nice_match;
  const c = e.strstart > e.w_size - Jt$3 ? e.strstart - (e.w_size - Jt$3) : 0,
        u = e.window,
        l = e.w_mask,
        h = e.prev,
        d = e.strstart + Xt$3;
  let _ = u[o + s - 1],
      f = u[o + s];
  e.prev_length >= e.good_match && (i >>= 2), a > e.lookahead && (a = e.lookahead);

  do {
    if (n = t, u[n + s] === f && u[n + s - 1] === _ && u[n] === u[o] && u[++n] === u[o + 1]) {
      o += 2, n++;

      do {} while (u[++o] === u[++n] && u[++o] === u[++n] && u[++o] === u[++n] && u[++o] === u[++n] && u[++o] === u[++n] && u[++o] === u[++n] && u[++o] === u[++n] && u[++o] === u[++n] && o < d);

      if (r = Xt$3 - (d - o), o = d - Xt$3, r > s) {
        if (e.match_start = t, s = r, r >= a) break;
        _ = u[o + s - 1], f = u[o + s];
      }
    }
  } while ((t = h[t & l]) > c && 0 != --i);

  return s <= e.lookahead ? s : e.lookahead;
},
      fn$2 = e => {
  const t = e.w_size;
  let n, r, i;

  do {
    if (r = e.window_size - e.lookahead - e.strstart, e.strstart >= t + (t - Jt$3) && (e.window.set(e.window.subarray(t, t + t - r), 0), e.match_start -= t, e.strstart -= t, e.block_start -= t, e.insert > e.strstart && (e.insert = e.strstart), sn$3(e), r += t), 0 === e.strm.avail_in) break;
    if (n = dn$3(e.strm, e.window, e.strstart + e.lookahead, r), e.lookahead += n, e.lookahead + e.insert >= 3) for (i = e.strstart - e.insert, e.ins_h = e.window[i], e.ins_h = an$3(e, e.ins_h, e.window[i + 1]); e.insert && (e.ins_h = an$3(e, e.ins_h, e.window[i + 3 - 1]), e.prev[i & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = i, i++, e.insert--, !(e.lookahead + e.insert < 3)););
  } while (e.lookahead < Jt$3 && 0 !== e.strm.avail_in);
},
      pn$2 = (e, t) => {
  let n,
      r,
      i,
      o = e.pending_buf_size - 5 > e.w_size ? e.w_size : e.pending_buf_size - 5,
      s = 0,
      a = e.strm.avail_in;

  do {
    if (n = 65535, i = e.bi_valid + 42 >> 3, e.strm.avail_out < i) break;
    if (i = e.strm.avail_out - i, r = e.strstart - e.block_start, n > r + e.strm.avail_in && (n = r + e.strm.avail_in), n > i && (n = i), n < o && (0 === n && t !== Mt$2 || t === Lt$3 || n !== r + e.strm.avail_in)) break;
    s = t === Mt$2 && n === r + e.strm.avail_in ? 1 : 0, Ot$3(e, 0, 0, s), e.pending_buf[e.pending - 4] = n, e.pending_buf[e.pending - 3] = n >> 8, e.pending_buf[e.pending - 2] = ~n, e.pending_buf[e.pending - 1] = ~n >> 8, cn$3(e.strm), r && (r > n && (r = n), e.strm.output.set(e.window.subarray(e.block_start, e.block_start + r), e.strm.next_out), e.strm.next_out += r, e.strm.avail_out -= r, e.strm.total_out += r, e.block_start += r, n -= r), n && (dn$3(e.strm, e.strm.output, e.strm.next_out, n), e.strm.next_out += n, e.strm.avail_out -= n, e.strm.total_out += n);
  } while (0 === s);

  return a -= e.strm.avail_in, a && (a >= e.w_size ? (e.matches = 2, e.window.set(e.strm.input.subarray(e.strm.next_in - e.w_size, e.strm.next_in), 0), e.strstart = e.w_size, e.insert = e.strstart) : (e.window_size - e.strstart <= a && (e.strstart -= e.w_size, e.window.set(e.window.subarray(e.w_size, e.w_size + e.strstart), 0), e.matches < 2 && e.matches++, e.insert > e.strstart && (e.insert = e.strstart)), e.window.set(e.strm.input.subarray(e.strm.next_in - a, e.strm.next_in), e.strstart), e.strstart += a, e.insert += a > e.w_size - e.insert ? e.w_size - e.insert : a), e.block_start = e.strstart), e.high_water < e.strstart && (e.high_water = e.strstart), s ? 4 : t !== Lt$3 && t !== Mt$2 && 0 === e.strm.avail_in && e.strstart === e.block_start ? 2 : (i = e.window_size - e.strstart, e.strm.avail_in > i && e.block_start >= e.w_size && (e.block_start -= e.w_size, e.strstart -= e.w_size, e.window.set(e.window.subarray(e.w_size, e.w_size + e.strstart), 0), e.matches < 2 && e.matches++, i += e.w_size, e.insert > e.strstart && (e.insert = e.strstart)), i > e.strm.avail_in && (i = e.strm.avail_in), i && (dn$3(e.strm, e.window, e.strstart, i), e.strstart += i, e.insert += i > e.w_size - e.insert ? e.w_size - e.insert : i), e.high_water < e.strstart && (e.high_water = e.strstart), i = e.bi_valid + 42 >> 3, i = e.pending_buf_size - i > 65535 ? 65535 : e.pending_buf_size - i, o = i > e.w_size ? e.w_size : i, r = e.strstart - e.block_start, (r >= o || (r || t === Mt$2) && t !== Lt$3 && 0 === e.strm.avail_in && r <= i) && (n = r > i ? i : r, s = t === Mt$2 && 0 === e.strm.avail_in && n === r ? 1 : 0, Ot$3(e, e.block_start, n, s), e.block_start += n, cn$3(e.strm)), s ? 3 : 1);
},
      En$2 = (e, t) => {
  let n, r;

  for (;;) {
    if (e.lookahead < Jt$3) {
      if (fn$2(e), e.lookahead < Jt$3 && t === Lt$3) return 1;
      if (0 === e.lookahead) break;
    }

    if (n = 0, e.lookahead >= 3 && (e.ins_h = an$3(e, e.ins_h, e.window[e.strstart + 3 - 1]), n = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart), 0 !== n && e.strstart - n <= e.w_size - Jt$3 && (e.match_length = _n$2(e, n)), e.match_length >= 3) {
      if (r = Rt$3(e, e.strstart - e.match_start, e.match_length - 3), e.lookahead -= e.match_length, e.match_length <= e.max_lazy_match && e.lookahead >= 3) {
        e.match_length--;

        do {
          e.strstart++, e.ins_h = an$3(e, e.ins_h, e.window[e.strstart + 3 - 1]), n = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart;
        } while (0 != --e.match_length);

        e.strstart++;
      } else e.strstart += e.match_length, e.match_length = 0, e.ins_h = e.window[e.strstart], e.ins_h = an$3(e, e.ins_h, e.window[e.strstart + 1]);
    } else r = Rt$3(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++;
    if (r && (un$3(e, !1), 0 === e.strm.avail_out)) return 1;
  }

  return e.insert = e.strstart < 2 ? e.strstart : 2, t === Mt$2 ? (un$3(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.sym_next && (un$3(e, !1), 0 === e.strm.avail_out) ? 1 : 2;
},
      gn$2 = (e, t) => {
  let n, r, i;

  for (;;) {
    if (e.lookahead < Jt$3) {
      if (fn$2(e), e.lookahead < Jt$3 && t === Lt$3) return 1;
      if (0 === e.lookahead) break;
    }

    if (n = 0, e.lookahead >= 3 && (e.ins_h = an$3(e, e.ins_h, e.window[e.strstart + 3 - 1]), n = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart), e.prev_length = e.match_length, e.prev_match = e.match_start, e.match_length = 2, 0 !== n && e.prev_length < e.max_lazy_match && e.strstart - n <= e.w_size - Jt$3 && (e.match_length = _n$2(e, n), e.match_length <= 5 && (e.strategy === jt$3 || 3 === e.match_length && e.strstart - e.match_start > 4096) && (e.match_length = 2)), e.prev_length >= 3 && e.match_length <= e.prev_length) {
      i = e.strstart + e.lookahead - 3, r = Rt$3(e, e.strstart - 1 - e.prev_match, e.prev_length - 3), e.lookahead -= e.prev_length - 1, e.prev_length -= 2;

      do {
        ++e.strstart <= i && (e.ins_h = an$3(e, e.ins_h, e.window[e.strstart + 3 - 1]), n = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart);
      } while (0 != --e.prev_length);

      if (e.match_available = 0, e.match_length = 2, e.strstart++, r && (un$3(e, !1), 0 === e.strm.avail_out)) return 1;
    } else if (e.match_available) {
      if (r = Rt$3(e, 0, e.window[e.strstart - 1]), r && un$3(e, !1), e.strstart++, e.lookahead--, 0 === e.strm.avail_out) return 1;
    } else e.match_available = 1, e.strstart++, e.lookahead--;
  }

  return e.match_available && (r = Rt$3(e, 0, e.window[e.strstart - 1]), e.match_available = 0), e.insert = e.strstart < 2 ? e.strstart : 2, t === Mt$2 ? (un$3(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.sym_next && (un$3(e, !1), 0 === e.strm.avail_out) ? 1 : 2;
};

function vn$2(e, t, n, r, i) {
  this.good_length = e, this.max_lazy = t, this.nice_length = n, this.max_chain = r, this.func = i;
}

const bn$2 = [new vn$2(0, 0, 0, 0, pn$2), new vn$2(4, 4, 8, 4, En$2), new vn$2(4, 5, 16, 8, En$2), new vn$2(4, 6, 32, 32, En$2), new vn$2(4, 4, 16, 16, gn$2), new vn$2(8, 16, 32, 32, gn$2), new vn$2(8, 16, 128, 128, gn$2), new vn$2(8, 32, 128, 256, gn$2), new vn$2(32, 128, 258, 1024, gn$2), new vn$2(32, 258, 258, 4096, gn$2)];

function mn$2() {
  this.strm = null, this.status = 0, this.pending_buf = null, this.pending_buf_size = 0, this.pending_out = 0, this.pending = 0, this.wrap = 0, this.gzhead = null, this.gzindex = 0, this.method = Yt$2, this.last_flush = -1, this.w_size = 0, this.w_bits = 0, this.w_mask = 0, this.window = null, this.window_size = 0, this.prev = null, this.head = null, this.ins_h = 0, this.hash_size = 0, this.hash_bits = 0, this.hash_mask = 0, this.hash_shift = 0, this.block_start = 0, this.match_length = 0, this.prev_match = 0, this.match_available = 0, this.strstart = 0, this.match_start = 0, this.lookahead = 0, this.prev_length = 0, this.max_chain_length = 0, this.max_lazy_match = 0, this.level = 0, this.strategy = 0, this.good_match = 0, this.nice_match = 0, this.dyn_ltree = new Uint16Array(1146), this.dyn_dtree = new Uint16Array(122), this.bl_tree = new Uint16Array(78), on$3(this.dyn_ltree), on$3(this.dyn_dtree), on$3(this.bl_tree), this.l_desc = null, this.d_desc = null, this.bl_desc = null, this.bl_count = new Uint16Array(16), this.heap = new Uint16Array(573), on$3(this.heap), this.heap_len = 0, this.heap_max = 0, this.depth = new Uint16Array(573), on$3(this.depth), this.sym_buf = 0, this.lit_bufsize = 0, this.sym_next = 0, this.sym_end = 0, this.opt_len = 0, this.static_len = 0, this.matches = 0, this.insert = 0, this.bi_buf = 0, this.bi_valid = 0;
}

const yn$2 = e => {
  if (!e) return 1;
  const t = e.state;
  return !t || t.strm !== e || t.status !== $t$3 && 57 !== t.status && 69 !== t.status && 73 !== t.status && 91 !== t.status && 103 !== t.status && t.status !== en$3 && t.status !== tn$3 ? 1 : 0;
},
      wn$2 = e => {
  if (yn$2(e)) return nn$3(e, Ht$3);
  e.total_in = e.total_out = 0, e.data_type = Qt$3;
  const t = e.state;
  return t.pending = 0, t.pending_out = 0, t.wrap < 0 && (t.wrap = -t.wrap), t.status = 2 === t.wrap ? 57 : t.wrap ? $t$3 : en$3, e.adler = 2 === t.wrap ? 0 : 1, t.last_flush = -2, kt$3(t), zt$3;
},
      Nn$2 = e => {
  const t = wn$2(e);
  var n;
  return t === zt$3 && ((n = e.state).window_size = 2 * n.w_size, on$3(n.head), n.max_lazy_match = bn$2[n.level].max_lazy, n.good_match = bn$2[n.level].good_length, n.nice_match = bn$2[n.level].nice_length, n.max_chain_length = bn$2[n.level].max_chain, n.strstart = 0, n.block_start = 0, n.lookahead = 0, n.insert = 0, n.match_length = n.prev_length = 2, n.match_available = 0, n.ins_h = 0), t;
},
      Tn$2 = (e, t, n, r, i, o) => {
  if (!e) return Ht$3;
  let s = 1;
  if (t === qt$3 && (t = 6), r < 0 ? (s = 0, r = -r) : r > 15 && (s = 2, r -= 16), i < 1 || i > 9 || n !== Yt$2 || r < 8 || r > 15 || t < 0 || t > 9 || o < 0 || o > Zt$3 || 8 === r && 1 !== s) return nn$3(e, Ht$3);
  8 === r && (r = 9);
  const a = new mn$2();
  return e.state = a, a.strm = e, a.status = $t$3, a.wrap = s, a.gzhead = null, a.w_bits = r, a.w_size = 1 << a.w_bits, a.w_mask = a.w_size - 1, a.hash_bits = i + 7, a.hash_size = 1 << a.hash_bits, a.hash_mask = a.hash_size - 1, a.hash_shift = ~~((a.hash_bits + 3 - 1) / 3), a.window = new Uint8Array(2 * a.w_size), a.head = new Uint16Array(a.hash_size), a.prev = new Uint16Array(a.w_size), a.lit_bufsize = 1 << i + 6, a.pending_buf_size = 4 * a.lit_bufsize, a.pending_buf = new Uint8Array(a.pending_buf_size), a.sym_buf = a.lit_bufsize, a.sym_end = 3 * (a.lit_bufsize - 1), a.level = t, a.strategy = o, a.method = n, Nn$2(e);
};

var Sn$2 = {
  deflateInit: (e, t) => Tn$2(e, t, Yt$2, 15, 8, Wt$3),
  deflateInit2: Tn$2,
  deflateReset: Nn$2,
  deflateResetKeep: wn$2,
  deflateSetHeader: (e, t) => yn$2(e) || 2 !== e.state.wrap ? Ht$3 : (e.state.gzhead = t, zt$3),
  deflate: (e, t) => {
    if (yn$2(e) || t > Pt$3 || t < 0) return e ? nn$3(e, Ht$3) : Ht$3;
    const n = e.state;
    if (!e.output || 0 !== e.avail_in && !e.input || n.status === tn$3 && t !== Mt$2) return nn$3(e, 0 === e.avail_out ? Gt$3 : Ht$3);
    const r = n.last_flush;

    if (n.last_flush = t, 0 !== n.pending) {
      if (cn$3(e), 0 === e.avail_out) return n.last_flush = -1, zt$3;
    } else if (0 === e.avail_in && rn$3(t) <= rn$3(r) && t !== Mt$2) return nn$3(e, Gt$3);

    if (n.status === tn$3 && 0 !== e.avail_in) return nn$3(e, Gt$3);

    if (n.status === $t$3 && 0 === n.wrap && (n.status = en$3), n.status === $t$3) {
      let t = Yt$2 + (n.w_bits - 8 << 4) << 8,
          r = -1;
      if (r = n.strategy >= Kt$3 || n.level < 2 ? 0 : n.level < 6 ? 1 : 6 === n.level ? 2 : 3, t |= r << 6, 0 !== n.strstart && (t |= 32), t += 31 - t % 31, hn$3(n, t), 0 !== n.strstart && (hn$3(n, e.adler >>> 16), hn$3(n, 65535 & e.adler)), e.adler = 1, n.status = en$3, cn$3(e), 0 !== n.pending) return n.last_flush = -1, zt$3;
    }

    if (57 === n.status) if (e.adler = 0, ln$3(n, 31), ln$3(n, 139), ln$3(n, 8), n.gzhead) ln$3(n, (n.gzhead.text ? 1 : 0) + (n.gzhead.hcrc ? 2 : 0) + (n.gzhead.extra ? 4 : 0) + (n.gzhead.name ? 8 : 0) + (n.gzhead.comment ? 16 : 0)), ln$3(n, 255 & n.gzhead.time), ln$3(n, n.gzhead.time >> 8 & 255), ln$3(n, n.gzhead.time >> 16 & 255), ln$3(n, n.gzhead.time >> 24 & 255), ln$3(n, 9 === n.level ? 2 : n.strategy >= Kt$3 || n.level < 2 ? 4 : 0), ln$3(n, 255 & n.gzhead.os), n.gzhead.extra && n.gzhead.extra.length && (ln$3(n, 255 & n.gzhead.extra.length), ln$3(n, n.gzhead.extra.length >> 8 & 255)), n.gzhead.hcrc && (e.adler = St$3(e.adler, n.pending_buf, n.pending, 0)), n.gzindex = 0, n.status = 69;else if (ln$3(n, 0), ln$3(n, 0), ln$3(n, 0), ln$3(n, 0), ln$3(n, 0), ln$3(n, 9 === n.level ? 2 : n.strategy >= Kt$3 || n.level < 2 ? 4 : 0), ln$3(n, 3), n.status = en$3, cn$3(e), 0 !== n.pending) return n.last_flush = -1, zt$3;

    if (69 === n.status) {
      if (n.gzhead.extra) {
        let t = n.pending,
            r = (65535 & n.gzhead.extra.length) - n.gzindex;

        for (; n.pending + r > n.pending_buf_size;) {
          let i = n.pending_buf_size - n.pending;
          if (n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex, n.gzindex + i), n.pending), n.pending = n.pending_buf_size, n.gzhead.hcrc && n.pending > t && (e.adler = St$3(e.adler, n.pending_buf, n.pending - t, t)), n.gzindex += i, cn$3(e), 0 !== n.pending) return n.last_flush = -1, zt$3;
          t = 0, r -= i;
        }

        let i = new Uint8Array(n.gzhead.extra);
        n.pending_buf.set(i.subarray(n.gzindex, n.gzindex + r), n.pending), n.pending += r, n.gzhead.hcrc && n.pending > t && (e.adler = St$3(e.adler, n.pending_buf, n.pending - t, t)), n.gzindex = 0;
      }

      n.status = 73;
    }

    if (73 === n.status) {
      if (n.gzhead.name) {
        let t,
            r = n.pending;

        do {
          if (n.pending === n.pending_buf_size) {
            if (n.gzhead.hcrc && n.pending > r && (e.adler = St$3(e.adler, n.pending_buf, n.pending - r, r)), cn$3(e), 0 !== n.pending) return n.last_flush = -1, zt$3;
            r = 0;
          }

          t = n.gzindex < n.gzhead.name.length ? 255 & n.gzhead.name.charCodeAt(n.gzindex++) : 0, ln$3(n, t);
        } while (0 !== t);

        n.gzhead.hcrc && n.pending > r && (e.adler = St$3(e.adler, n.pending_buf, n.pending - r, r)), n.gzindex = 0;
      }

      n.status = 91;
    }

    if (91 === n.status) {
      if (n.gzhead.comment) {
        let t,
            r = n.pending;

        do {
          if (n.pending === n.pending_buf_size) {
            if (n.gzhead.hcrc && n.pending > r && (e.adler = St$3(e.adler, n.pending_buf, n.pending - r, r)), cn$3(e), 0 !== n.pending) return n.last_flush = -1, zt$3;
            r = 0;
          }

          t = n.gzindex < n.gzhead.comment.length ? 255 & n.gzhead.comment.charCodeAt(n.gzindex++) : 0, ln$3(n, t);
        } while (0 !== t);

        n.gzhead.hcrc && n.pending > r && (e.adler = St$3(e.adler, n.pending_buf, n.pending - r, r));
      }

      n.status = 103;
    }

    if (103 === n.status) {
      if (n.gzhead.hcrc) {
        if (n.pending + 2 > n.pending_buf_size && (cn$3(e), 0 !== n.pending)) return n.last_flush = -1, zt$3;
        ln$3(n, 255 & e.adler), ln$3(n, e.adler >> 8 & 255), e.adler = 0;
      }

      if (n.status = en$3, cn$3(e), 0 !== n.pending) return n.last_flush = -1, zt$3;
    }

    if (0 !== e.avail_in || 0 !== n.lookahead || t !== Lt$3 && n.status !== tn$3) {
      let r = 0 === n.level ? pn$2(n, t) : n.strategy === Kt$3 ? ((e, t) => {
        let n;

        for (;;) {
          if (0 === e.lookahead && (fn$2(e), 0 === e.lookahead)) {
            if (t === Lt$3) return 1;
            break;
          }

          if (e.match_length = 0, n = Rt$3(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++, n && (un$3(e, !1), 0 === e.strm.avail_out)) return 1;
        }

        return e.insert = 0, t === Mt$2 ? (un$3(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.sym_next && (un$3(e, !1), 0 === e.strm.avail_out) ? 1 : 2;
      })(n, t) : n.strategy === Bt$3 ? ((e, t) => {
        let n, r, i, o;
        const s = e.window;

        for (;;) {
          if (e.lookahead <= Xt$3) {
            if (fn$2(e), e.lookahead <= Xt$3 && t === Lt$3) return 1;
            if (0 === e.lookahead) break;
          }

          if (e.match_length = 0, e.lookahead >= 3 && e.strstart > 0 && (i = e.strstart - 1, r = s[i], r === s[++i] && r === s[++i] && r === s[++i])) {
            o = e.strstart + Xt$3;

            do {} while (r === s[++i] && r === s[++i] && r === s[++i] && r === s[++i] && r === s[++i] && r === s[++i] && r === s[++i] && r === s[++i] && i < o);

            e.match_length = Xt$3 - (o - i), e.match_length > e.lookahead && (e.match_length = e.lookahead);
          }

          if (e.match_length >= 3 ? (n = Rt$3(e, 1, e.match_length - 3), e.lookahead -= e.match_length, e.strstart += e.match_length, e.match_length = 0) : (n = Rt$3(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++), n && (un$3(e, !1), 0 === e.strm.avail_out)) return 1;
        }

        return e.insert = 0, t === Mt$2 ? (un$3(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.sym_next && (un$3(e, !1), 0 === e.strm.avail_out) ? 1 : 2;
      })(n, t) : bn$2[n.level].func(n, t);
      if (3 !== r && 4 !== r || (n.status = tn$3), 1 === r || 3 === r) return 0 === e.avail_out && (n.last_flush = -1), zt$3;
      if (2 === r && (t === xt$3 ? Dt$3(n) : t !== Pt$3 && (Ot$3(n, 0, 0, !1), t === Ut$3 && (on$3(n.head), 0 === n.lookahead && (n.strstart = 0, n.block_start = 0, n.insert = 0))), cn$3(e), 0 === e.avail_out)) return n.last_flush = -1, zt$3;
    }

    return t !== Mt$2 ? zt$3 : n.wrap <= 0 ? Ft$3 : (2 === n.wrap ? (ln$3(n, 255 & e.adler), ln$3(n, e.adler >> 8 & 255), ln$3(n, e.adler >> 16 & 255), ln$3(n, e.adler >> 24 & 255), ln$3(n, 255 & e.total_in), ln$3(n, e.total_in >> 8 & 255), ln$3(n, e.total_in >> 16 & 255), ln$3(n, e.total_in >> 24 & 255)) : (hn$3(n, e.adler >>> 16), hn$3(n, 65535 & e.adler)), cn$3(e), n.wrap > 0 && (n.wrap = -n.wrap), 0 !== n.pending ? zt$3 : Ft$3);
  },
  deflateEnd: e => {
    if (yn$2(e)) return Ht$3;
    const t = e.state.status;
    return e.state = null, t === en$3 ? nn$3(e, Vt$3) : zt$3;
  },
  deflateSetDictionary: (e, t) => {
    let n = t.length;
    if (yn$2(e)) return Ht$3;
    const r = e.state,
          i = r.wrap;
    if (2 === i || 1 === i && r.status !== $t$3 || r.lookahead) return Ht$3;

    if (1 === i && (e.adler = Nt$3(e.adler, t, n, 0)), r.wrap = 0, n >= r.w_size) {
      0 === i && (on$3(r.head), r.strstart = 0, r.block_start = 0, r.insert = 0);
      let e = new Uint8Array(r.w_size);
      e.set(t.subarray(n - r.w_size, n), 0), t = e, n = r.w_size;
    }

    const o = e.avail_in,
          s = e.next_in,
          a = e.input;

    for (e.avail_in = n, e.next_in = 0, e.input = t, fn$2(r); r.lookahead >= 3;) {
      let e = r.strstart,
          t = r.lookahead - 2;

      do {
        r.ins_h = an$3(r, r.ins_h, r.window[e + 3 - 1]), r.prev[e & r.w_mask] = r.head[r.ins_h], r.head[r.ins_h] = e, e++;
      } while (--t);

      r.strstart = e, r.lookahead = 2, fn$2(r);
    }

    return r.strstart += r.lookahead, r.block_start = r.strstart, r.insert = r.lookahead, r.lookahead = 0, r.match_length = r.prev_length = 2, r.match_available = 0, e.next_in = s, e.input = a, e.avail_in = o, r.wrap = i, zt$3;
  },
  deflateInfo: "pako deflate (from Nodeca project)"
};

const An$2 = (e, t) => Object.prototype.hasOwnProperty.call(e, t);

var Cn$2 = {
  assign: function (e) {
    const t = Array.prototype.slice.call(arguments, 1);

    for (; t.length;) {
      const n = t.shift();

      if (n) {
        if ("object" != typeof n) throw new TypeError(n + "must be non-object");

        for (const t in n) An$2(n, t) && (e[t] = n[t]);
      }
    }

    return e;
  },
  flattenChunks: e => {
    let t = 0;

    for (let n = 0, r = e.length; n < r; n++) t += e[n].length;

    const n = new Uint8Array(t);

    for (let t = 0, r = 0, i = e.length; t < i; t++) {
      let i = e[t];
      n.set(i, r), r += i.length;
    }

    return n;
  }
};
let kn$2 = !0;

try {
  String.fromCharCode.apply(null, new Uint8Array(1));
} catch (e) {
  kn$2 = !1;
}

const On$2 = new Uint8Array(256);

for (let e = 0; e < 256; e++) On$2[e] = e >= 252 ? 6 : e >= 248 ? 5 : e >= 240 ? 4 : e >= 224 ? 3 : e >= 192 ? 2 : 1;

On$2[254] = On$2[254] = 1;
var In$2 = {
  string2buf: e => {
    if ("function" == typeof TextEncoder && TextEncoder.prototype.encode) return new TextEncoder().encode(e);
    let t,
        n,
        r,
        i,
        o,
        s = e.length,
        a = 0;

    for (i = 0; i < s; i++) n = e.charCodeAt(i), 55296 == (64512 & n) && i + 1 < s && (r = e.charCodeAt(i + 1), 56320 == (64512 & r) && (n = 65536 + (n - 55296 << 10) + (r - 56320), i++)), a += n < 128 ? 1 : n < 2048 ? 2 : n < 65536 ? 3 : 4;

    for (t = new Uint8Array(a), o = 0, i = 0; o < a; i++) n = e.charCodeAt(i), 55296 == (64512 & n) && i + 1 < s && (r = e.charCodeAt(i + 1), 56320 == (64512 & r) && (n = 65536 + (n - 55296 << 10) + (r - 56320), i++)), n < 128 ? t[o++] = n : n < 2048 ? (t[o++] = 192 | n >>> 6, t[o++] = 128 | 63 & n) : n < 65536 ? (t[o++] = 224 | n >>> 12, t[o++] = 128 | n >>> 6 & 63, t[o++] = 128 | 63 & n) : (t[o++] = 240 | n >>> 18, t[o++] = 128 | n >>> 12 & 63, t[o++] = 128 | n >>> 6 & 63, t[o++] = 128 | 63 & n);

    return t;
  },
  buf2string: (e, t) => {
    const n = t || e.length;
    if ("function" == typeof TextDecoder && TextDecoder.prototype.decode) return new TextDecoder().decode(e.subarray(0, t));
    let r, i;
    const o = new Array(2 * n);

    for (i = 0, r = 0; r < n;) {
      let t = e[r++];

      if (t < 128) {
        o[i++] = t;
        continue;
      }

      let s = On$2[t];
      if (s > 4) o[i++] = 65533, r += s - 1;else {
        for (t &= 2 === s ? 31 : 3 === s ? 15 : 7; s > 1 && r < n;) t = t << 6 | 63 & e[r++], s--;

        s > 1 ? o[i++] = 65533 : t < 65536 ? o[i++] = t : (t -= 65536, o[i++] = 55296 | t >> 10 & 1023, o[i++] = 56320 | 1023 & t);
      }
    }

    return ((e, t) => {
      if (t < 65534 && e.subarray && kn$2) return String.fromCharCode.apply(null, e.length === t ? e : e.subarray(0, t));
      let n = "";

      for (let r = 0; r < t; r++) n += String.fromCharCode(e[r]);

      return n;
    })(o, i);
  },
  utf8border: (e, t) => {
    (t = t || e.length) > e.length && (t = e.length);
    let n = t - 1;

    for (; n >= 0 && 128 == (192 & e[n]);) n--;

    return n < 0 || 0 === n ? t : n + On$2[e[n]] > t ? n : t;
  }
};

var Rn$2 = function () {
  this.input = null, this.next_in = 0, this.avail_in = 0, this.total_in = 0, this.output = null, this.next_out = 0, this.avail_out = 0, this.total_out = 0, this.msg = "", this.state = null, this.data_type = 2, this.adler = 0;
};

const Dn$2 = Object.prototype.toString,
      {
  Z_NO_FLUSH: Ln$2,
  Z_SYNC_FLUSH: xn$2,
  Z_FULL_FLUSH: Un$2,
  Z_FINISH: Mn$2,
  Z_OK: Pn$2,
  Z_STREAM_END: zn$2,
  Z_DEFAULT_COMPRESSION: Fn$2,
  Z_DEFAULT_STRATEGY: Hn$2,
  Z_DEFLATED: Vn$2
} = Ct$2;

function Gn$2(e) {
  this.options = Cn$2.assign({
    level: Fn$2,
    method: Vn$2,
    chunkSize: 16384,
    windowBits: 15,
    memLevel: 8,
    strategy: Hn$2
  }, e || {});
  let t = this.options;
  t.raw && t.windowBits > 0 ? t.windowBits = -t.windowBits : t.gzip && t.windowBits > 0 && t.windowBits < 16 && (t.windowBits += 16), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new Rn$2(), this.strm.avail_out = 0;
  let n = Sn$2.deflateInit2(this.strm, t.level, t.method, t.windowBits, t.memLevel, t.strategy);
  if (n !== Pn$2) throw new Error(At$3[n]);

  if (t.header && Sn$2.deflateSetHeader(this.strm, t.header), t.dictionary) {
    let e;
    if (e = "string" == typeof t.dictionary ? In$2.string2buf(t.dictionary) : "[object ArrayBuffer]" === Dn$2.call(t.dictionary) ? new Uint8Array(t.dictionary) : t.dictionary, n = Sn$2.deflateSetDictionary(this.strm, e), n !== Pn$2) throw new Error(At$3[n]);
    this._dict_set = !0;
  }
}

function qn$2(e, t) {
  const n = new Gn$2(t);
  if (n.push(e, !0), n.err) throw n.msg || At$3[n.err];
  return n.result;
}

Gn$2.prototype.push = function (e, t) {
  const n = this.strm,
        r = this.options.chunkSize;
  let i, o;
  if (this.ended) return !1;

  for (o = t === ~~t ? t : !0 === t ? Mn$2 : Ln$2, "string" == typeof e ? n.input = In$2.string2buf(e) : "[object ArrayBuffer]" === Dn$2.call(e) ? n.input = new Uint8Array(e) : n.input = e, n.next_in = 0, n.avail_in = n.input.length;;) if (0 === n.avail_out && (n.output = new Uint8Array(r), n.next_out = 0, n.avail_out = r), (o === xn$2 || o === Un$2) && n.avail_out <= 6) this.onData(n.output.subarray(0, n.next_out)), n.avail_out = 0;else {
    if (i = Sn$2.deflate(n, o), i === zn$2) return n.next_out > 0 && this.onData(n.output.subarray(0, n.next_out)), i = Sn$2.deflateEnd(this.strm), this.onEnd(i), this.ended = !0, i === Pn$2;

    if (0 !== n.avail_out) {
      if (o > 0 && n.next_out > 0) this.onData(n.output.subarray(0, n.next_out)), n.avail_out = 0;else if (0 === n.avail_in) break;
    } else this.onData(n.output);
  }

  return !0;
}, Gn$2.prototype.onData = function (e) {
  this.chunks.push(e);
}, Gn$2.prototype.onEnd = function (e) {
  e === Pn$2 && (this.result = Cn$2.flattenChunks(this.chunks)), this.chunks = [], this.err = e, this.msg = this.strm.msg;
};
var jn$2 = {
  Deflate: Gn$2,
  deflate: qn$2,
  deflateRaw: function (e, t) {
    return (t = t || {}).raw = !0, qn$2(e, t);
  },
  gzip: function (e, t) {
    return (t = t || {}).gzip = !0, qn$2(e, t);
  },
  constants: Ct$2
};
const Kn$2 = 16209;

var Bn$2 = function (e, t) {
  let n, r, i, o, s, a, c, u, l, h, d, _, f, p, E, g, v, b, m, y, w, N, T, S;

  const A = e.state;
  n = e.next_in, T = e.input, r = n + (e.avail_in - 5), i = e.next_out, S = e.output, o = i - (t - e.avail_out), s = i + (e.avail_out - 257), a = A.dmax, c = A.wsize, u = A.whave, l = A.wnext, h = A.window, d = A.hold, _ = A.bits, f = A.lencode, p = A.distcode, E = (1 << A.lenbits) - 1, g = (1 << A.distbits) - 1;

  e: do {
    _ < 15 && (d += T[n++] << _, _ += 8, d += T[n++] << _, _ += 8), v = f[d & E];

    t: for (;;) {
      if (b = v >>> 24, d >>>= b, _ -= b, b = v >>> 16 & 255, 0 === b) S[i++] = 65535 & v;else {
        if (!(16 & b)) {
          if (0 == (64 & b)) {
            v = f[(65535 & v) + (d & (1 << b) - 1)];
            continue t;
          }

          if (32 & b) {
            A.mode = 16191;
            break e;
          }

          e.msg = "invalid literal/length code", A.mode = Kn$2;
          break e;
        }

        m = 65535 & v, b &= 15, b && (_ < b && (d += T[n++] << _, _ += 8), m += d & (1 << b) - 1, d >>>= b, _ -= b), _ < 15 && (d += T[n++] << _, _ += 8, d += T[n++] << _, _ += 8), v = p[d & g];

        n: for (;;) {
          if (b = v >>> 24, d >>>= b, _ -= b, b = v >>> 16 & 255, !(16 & b)) {
            if (0 == (64 & b)) {
              v = p[(65535 & v) + (d & (1 << b) - 1)];
              continue n;
            }

            e.msg = "invalid distance code", A.mode = Kn$2;
            break e;
          }

          if (y = 65535 & v, b &= 15, _ < b && (d += T[n++] << _, _ += 8, _ < b && (d += T[n++] << _, _ += 8)), y += d & (1 << b) - 1, y > a) {
            e.msg = "invalid distance too far back", A.mode = Kn$2;
            break e;
          }

          if (d >>>= b, _ -= b, b = i - o, y > b) {
            if (b = y - b, b > u && A.sane) {
              e.msg = "invalid distance too far back", A.mode = Kn$2;
              break e;
            }

            if (w = 0, N = h, 0 === l) {
              if (w += c - b, b < m) {
                m -= b;

                do {
                  S[i++] = h[w++];
                } while (--b);

                w = i - y, N = S;
              }
            } else if (l < b) {
              if (w += c + l - b, b -= l, b < m) {
                m -= b;

                do {
                  S[i++] = h[w++];
                } while (--b);

                if (w = 0, l < m) {
                  b = l, m -= b;

                  do {
                    S[i++] = h[w++];
                  } while (--b);

                  w = i - y, N = S;
                }
              }
            } else if (w += l - b, b < m) {
              m -= b;

              do {
                S[i++] = h[w++];
              } while (--b);

              w = i - y, N = S;
            }

            for (; m > 2;) S[i++] = N[w++], S[i++] = N[w++], S[i++] = N[w++], m -= 3;

            m && (S[i++] = N[w++], m > 1 && (S[i++] = N[w++]));
          } else {
            w = i - y;

            do {
              S[i++] = S[w++], S[i++] = S[w++], S[i++] = S[w++], m -= 3;
            } while (m > 2);

            m && (S[i++] = S[w++], m > 1 && (S[i++] = S[w++]));
          }

          break;
        }
      }
      break;
    }
  } while (n < r && i < s);

  m = _ >> 3, n -= m, _ -= m << 3, d &= (1 << _) - 1, e.next_in = n, e.next_out = i, e.avail_in = n < r ? r - n + 5 : 5 - (n - r), e.avail_out = i < s ? s - i + 257 : 257 - (i - s), A.hold = d, A.bits = _;
};

const Zn$2 = 15,
      Wn$2 = new Uint16Array([3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0]),
      Qn$2 = new Uint8Array([16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78]),
      Yn$2 = new Uint16Array([1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 0, 0]),
      Xn$2 = new Uint8Array([16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64]);

var Jn$2 = (e, t, n, r, i, o, s, a) => {
  const c = a.bits;

  let u,
      l,
      h,
      d,
      _,
      f,
      p = 0,
      E = 0,
      g = 0,
      v = 0,
      b = 0,
      m = 0,
      y = 0,
      w = 0,
      N = 0,
      T = 0,
      S = null;

  const A = new Uint16Array(16),
        C = new Uint16Array(16);
  let k,
      O,
      I,
      R = null;

  for (p = 0; p <= Zn$2; p++) A[p] = 0;

  for (E = 0; E < r; E++) A[t[n + E]]++;

  for (b = c, v = Zn$2; v >= 1 && 0 === A[v]; v--);

  if (b > v && (b = v), 0 === v) return i[o++] = 20971520, i[o++] = 20971520, a.bits = 1, 0;

  for (g = 1; g < v && 0 === A[g]; g++);

  for (b < g && (b = g), w = 1, p = 1; p <= Zn$2; p++) if (w <<= 1, w -= A[p], w < 0) return -1;

  if (w > 0 && (0 === e || 1 !== v)) return -1;

  for (C[1] = 0, p = 1; p < Zn$2; p++) C[p + 1] = C[p] + A[p];

  for (E = 0; E < r; E++) 0 !== t[n + E] && (s[C[t[n + E]]++] = E);

  if (0 === e ? (S = R = s, f = 20) : 1 === e ? (S = Wn$2, R = Qn$2, f = 257) : (S = Yn$2, R = Xn$2, f = 0), T = 0, E = 0, p = g, _ = o, m = b, y = 0, h = -1, N = 1 << b, d = N - 1, 1 === e && N > 852 || 2 === e && N > 592) return 1;

  for (;;) {
    k = p - y, s[E] + 1 < f ? (O = 0, I = s[E]) : s[E] >= f ? (O = R[s[E] - f], I = S[s[E] - f]) : (O = 96, I = 0), u = 1 << p - y, l = 1 << m, g = l;

    do {
      l -= u, i[_ + (T >> y) + l] = k << 24 | O << 16 | I | 0;
    } while (0 !== l);

    for (u = 1 << p - 1; T & u;) u >>= 1;

    if (0 !== u ? (T &= u - 1, T += u) : T = 0, E++, 0 == --A[p]) {
      if (p === v) break;
      p = t[n + s[E]];
    }

    if (p > b && (T & d) !== h) {
      for (0 === y && (y = b), _ += g, m = p - y, w = 1 << m; m + y < v && (w -= A[m + y], !(w <= 0));) m++, w <<= 1;

      if (N += 1 << m, 1 === e && N > 852 || 2 === e && N > 592) return 1;
      h = T & d, i[h] = b << 24 | m << 16 | _ - o | 0;
    }
  }

  return 0 !== T && (i[_ + T] = p - y << 24 | 64 << 16 | 0), a.bits = b, 0;
};

const {
  Z_FINISH: $n$2,
  Z_BLOCK: er$2,
  Z_TREES: tr$2,
  Z_OK: nr$2,
  Z_STREAM_END: rr$1,
  Z_NEED_DICT: ir$1,
  Z_STREAM_ERROR: or$1,
  Z_DATA_ERROR: sr$2,
  Z_MEM_ERROR: ar$1,
  Z_BUF_ERROR: cr$1,
  Z_DEFLATED: ur$1
} = Ct$2,
      lr$1 = 16180,
      hr$1 = 16190,
      dr$1 = 16191,
      _r$1 = 16192,
      fr$1 = 16194,
      pr$1 = 16199,
      Er$1 = 16200,
      gr$1 = 16206,
      vr$1 = 16209,
      br$1 = e => (e >>> 24 & 255) + (e >>> 8 & 65280) + ((65280 & e) << 8) + ((255 & e) << 24);

function mr() {
  this.strm = null, this.mode = 0, this.last = !1, this.wrap = 0, this.havedict = !1, this.flags = 0, this.dmax = 0, this.check = 0, this.total = 0, this.head = null, this.wbits = 0, this.wsize = 0, this.whave = 0, this.wnext = 0, this.window = null, this.hold = 0, this.bits = 0, this.length = 0, this.offset = 0, this.extra = 0, this.lencode = null, this.distcode = null, this.lenbits = 0, this.distbits = 0, this.ncode = 0, this.nlen = 0, this.ndist = 0, this.have = 0, this.next = null, this.lens = new Uint16Array(320), this.work = new Uint16Array(288), this.lendyn = null, this.distdyn = null, this.sane = 0, this.back = 0, this.was = 0;
}

const yr$1 = e => {
  if (!e) return 1;
  const t = e.state;
  return !t || t.strm !== e || t.mode < lr$1 || t.mode > 16211 ? 1 : 0;
},
      wr$1 = e => {
  if (yr$1(e)) return or$1;
  const t = e.state;
  return e.total_in = e.total_out = t.total = 0, e.msg = "", t.wrap && (e.adler = 1 & t.wrap), t.mode = lr$1, t.last = 0, t.havedict = 0, t.flags = -1, t.dmax = 32768, t.head = null, t.hold = 0, t.bits = 0, t.lencode = t.lendyn = new Int32Array(852), t.distcode = t.distdyn = new Int32Array(592), t.sane = 1, t.back = -1, nr$2;
},
      Nr$1 = e => {
  if (yr$1(e)) return or$1;
  const t = e.state;
  return t.wsize = 0, t.whave = 0, t.wnext = 0, wr$1(e);
},
      Tr$1 = (e, t) => {
  let n;
  if (yr$1(e)) return or$1;
  const r = e.state;
  return t < 0 ? (n = 0, t = -t) : (n = 5 + (t >> 4), t < 48 && (t &= 15)), t && (t < 8 || t > 15) ? or$1 : (null !== r.window && r.wbits !== t && (r.window = null), r.wrap = n, r.wbits = t, Nr$1(e));
},
      Sr$1 = (e, t) => {
  if (!e) return or$1;
  const n = new mr();
  e.state = n, n.strm = e, n.window = null, n.mode = lr$1;
  const r = Tr$1(e, t);
  return r !== nr$2 && (e.state = null), r;
};

let Ar$1,
    Cr$1,
    kr$1 = !0;

const Or$1 = e => {
  if (kr$1) {
    Ar$1 = new Int32Array(512), Cr$1 = new Int32Array(32);
    let t = 0;

    for (; t < 144;) e.lens[t++] = 8;

    for (; t < 256;) e.lens[t++] = 9;

    for (; t < 280;) e.lens[t++] = 7;

    for (; t < 288;) e.lens[t++] = 8;

    for (Jn$2(1, e.lens, 0, 288, Ar$1, 0, e.work, {
      bits: 9
    }), t = 0; t < 32;) e.lens[t++] = 5;

    Jn$2(2, e.lens, 0, 32, Cr$1, 0, e.work, {
      bits: 5
    }), kr$1 = !1;
  }

  e.lencode = Ar$1, e.lenbits = 9, e.distcode = Cr$1, e.distbits = 5;
},
      Ir$1 = (e, t, n, r) => {
  let i;
  const o = e.state;
  return null === o.window && (o.wsize = 1 << o.wbits, o.wnext = 0, o.whave = 0, o.window = new Uint8Array(o.wsize)), r >= o.wsize ? (o.window.set(t.subarray(n - o.wsize, n), 0), o.wnext = 0, o.whave = o.wsize) : (i = o.wsize - o.wnext, i > r && (i = r), o.window.set(t.subarray(n - r, n - r + i), o.wnext), (r -= i) ? (o.window.set(t.subarray(n - r, n), 0), o.wnext = r, o.whave = o.wsize) : (o.wnext += i, o.wnext === o.wsize && (o.wnext = 0), o.whave < o.wsize && (o.whave += i))), 0;
};

var Rr$1 = {
  inflateReset: Nr$1,
  inflateReset2: Tr$1,
  inflateResetKeep: wr$1,
  inflateInit: e => Sr$1(e, 15),
  inflateInit2: Sr$1,
  inflate: (e, t) => {
    let n,
        r,
        i,
        o,
        s,
        a,
        c,
        u,
        l,
        h,
        d,
        _,
        f,
        p,
        E,
        g,
        v,
        b,
        m,
        y,
        w,
        N,
        T = 0;

    const S = new Uint8Array(4);
    let A, C;
    const k = new Uint8Array([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);
    if (yr$1(e) || !e.output || !e.input && 0 !== e.avail_in) return or$1;
    n = e.state, n.mode === dr$1 && (n.mode = _r$1), s = e.next_out, i = e.output, c = e.avail_out, o = e.next_in, r = e.input, a = e.avail_in, u = n.hold, l = n.bits, h = a, d = c, N = nr$2;

    e: for (;;) switch (n.mode) {
      case lr$1:
        if (0 === n.wrap) {
          n.mode = _r$1;
          break;
        }

        for (; l < 16;) {
          if (0 === a) break e;
          a--, u += r[o++] << l, l += 8;
        }

        if (2 & n.wrap && 35615 === u) {
          0 === n.wbits && (n.wbits = 15), n.check = 0, S[0] = 255 & u, S[1] = u >>> 8 & 255, n.check = St$3(n.check, S, 2, 0), u = 0, l = 0, n.mode = 16181;
          break;
        }

        if (n.head && (n.head.done = !1), !(1 & n.wrap) || (((255 & u) << 8) + (u >> 8)) % 31) {
          e.msg = "incorrect header check", n.mode = vr$1;
          break;
        }

        if ((15 & u) !== ur$1) {
          e.msg = "unknown compression method", n.mode = vr$1;
          break;
        }

        if (u >>>= 4, l -= 4, w = 8 + (15 & u), 0 === n.wbits && (n.wbits = w), w > 15 || w > n.wbits) {
          e.msg = "invalid window size", n.mode = vr$1;
          break;
        }

        n.dmax = 1 << n.wbits, n.flags = 0, e.adler = n.check = 1, n.mode = 512 & u ? 16189 : dr$1, u = 0, l = 0;
        break;

      case 16181:
        for (; l < 16;) {
          if (0 === a) break e;
          a--, u += r[o++] << l, l += 8;
        }

        if (n.flags = u, (255 & n.flags) !== ur$1) {
          e.msg = "unknown compression method", n.mode = vr$1;
          break;
        }

        if (57344 & n.flags) {
          e.msg = "unknown header flags set", n.mode = vr$1;
          break;
        }

        n.head && (n.head.text = u >> 8 & 1), 512 & n.flags && 4 & n.wrap && (S[0] = 255 & u, S[1] = u >>> 8 & 255, n.check = St$3(n.check, S, 2, 0)), u = 0, l = 0, n.mode = 16182;

      case 16182:
        for (; l < 32;) {
          if (0 === a) break e;
          a--, u += r[o++] << l, l += 8;
        }

        n.head && (n.head.time = u), 512 & n.flags && 4 & n.wrap && (S[0] = 255 & u, S[1] = u >>> 8 & 255, S[2] = u >>> 16 & 255, S[3] = u >>> 24 & 255, n.check = St$3(n.check, S, 4, 0)), u = 0, l = 0, n.mode = 16183;

      case 16183:
        for (; l < 16;) {
          if (0 === a) break e;
          a--, u += r[o++] << l, l += 8;
        }

        n.head && (n.head.xflags = 255 & u, n.head.os = u >> 8), 512 & n.flags && 4 & n.wrap && (S[0] = 255 & u, S[1] = u >>> 8 & 255, n.check = St$3(n.check, S, 2, 0)), u = 0, l = 0, n.mode = 16184;

      case 16184:
        if (1024 & n.flags) {
          for (; l < 16;) {
            if (0 === a) break e;
            a--, u += r[o++] << l, l += 8;
          }

          n.length = u, n.head && (n.head.extra_len = u), 512 & n.flags && 4 & n.wrap && (S[0] = 255 & u, S[1] = u >>> 8 & 255, n.check = St$3(n.check, S, 2, 0)), u = 0, l = 0;
        } else n.head && (n.head.extra = null);

        n.mode = 16185;

      case 16185:
        if (1024 & n.flags && (_ = n.length, _ > a && (_ = a), _ && (n.head && (w = n.head.extra_len - n.length, n.head.extra || (n.head.extra = new Uint8Array(n.head.extra_len)), n.head.extra.set(r.subarray(o, o + _), w)), 512 & n.flags && 4 & n.wrap && (n.check = St$3(n.check, r, _, o)), a -= _, o += _, n.length -= _), n.length)) break e;
        n.length = 0, n.mode = 16186;

      case 16186:
        if (2048 & n.flags) {
          if (0 === a) break e;
          _ = 0;

          do {
            w = r[o + _++], n.head && w && n.length < 65536 && (n.head.name += String.fromCharCode(w));
          } while (w && _ < a);

          if (512 & n.flags && 4 & n.wrap && (n.check = St$3(n.check, r, _, o)), a -= _, o += _, w) break e;
        } else n.head && (n.head.name = null);

        n.length = 0, n.mode = 16187;

      case 16187:
        if (4096 & n.flags) {
          if (0 === a) break e;
          _ = 0;

          do {
            w = r[o + _++], n.head && w && n.length < 65536 && (n.head.comment += String.fromCharCode(w));
          } while (w && _ < a);

          if (512 & n.flags && 4 & n.wrap && (n.check = St$3(n.check, r, _, o)), a -= _, o += _, w) break e;
        } else n.head && (n.head.comment = null);

        n.mode = 16188;

      case 16188:
        if (512 & n.flags) {
          for (; l < 16;) {
            if (0 === a) break e;
            a--, u += r[o++] << l, l += 8;
          }

          if (4 & n.wrap && u !== (65535 & n.check)) {
            e.msg = "header crc mismatch", n.mode = vr$1;
            break;
          }

          u = 0, l = 0;
        }

        n.head && (n.head.hcrc = n.flags >> 9 & 1, n.head.done = !0), e.adler = n.check = 0, n.mode = dr$1;
        break;

      case 16189:
        for (; l < 32;) {
          if (0 === a) break e;
          a--, u += r[o++] << l, l += 8;
        }

        e.adler = n.check = br$1(u), u = 0, l = 0, n.mode = hr$1;

      case hr$1:
        if (0 === n.havedict) return e.next_out = s, e.avail_out = c, e.next_in = o, e.avail_in = a, n.hold = u, n.bits = l, ir$1;
        e.adler = n.check = 1, n.mode = dr$1;

      case dr$1:
        if (t === er$2 || t === tr$2) break e;

      case _r$1:
        if (n.last) {
          u >>>= 7 & l, l -= 7 & l, n.mode = gr$1;
          break;
        }

        for (; l < 3;) {
          if (0 === a) break e;
          a--, u += r[o++] << l, l += 8;
        }

        switch (n.last = 1 & u, u >>>= 1, l -= 1, 3 & u) {
          case 0:
            n.mode = 16193;
            break;

          case 1:
            if (Or$1(n), n.mode = pr$1, t === tr$2) {
              u >>>= 2, l -= 2;
              break e;
            }

            break;

          case 2:
            n.mode = 16196;
            break;

          case 3:
            e.msg = "invalid block type", n.mode = vr$1;
        }

        u >>>= 2, l -= 2;
        break;

      case 16193:
        for (u >>>= 7 & l, l -= 7 & l; l < 32;) {
          if (0 === a) break e;
          a--, u += r[o++] << l, l += 8;
        }

        if ((65535 & u) != (u >>> 16 ^ 65535)) {
          e.msg = "invalid stored block lengths", n.mode = vr$1;
          break;
        }

        if (n.length = 65535 & u, u = 0, l = 0, n.mode = fr$1, t === tr$2) break e;

      case fr$1:
        n.mode = 16195;

      case 16195:
        if (_ = n.length, _) {
          if (_ > a && (_ = a), _ > c && (_ = c), 0 === _) break e;
          i.set(r.subarray(o, o + _), s), a -= _, o += _, c -= _, s += _, n.length -= _;
          break;
        }

        n.mode = dr$1;
        break;

      case 16196:
        for (; l < 14;) {
          if (0 === a) break e;
          a--, u += r[o++] << l, l += 8;
        }

        if (n.nlen = 257 + (31 & u), u >>>= 5, l -= 5, n.ndist = 1 + (31 & u), u >>>= 5, l -= 5, n.ncode = 4 + (15 & u), u >>>= 4, l -= 4, n.nlen > 286 || n.ndist > 30) {
          e.msg = "too many length or distance symbols", n.mode = vr$1;
          break;
        }

        n.have = 0, n.mode = 16197;

      case 16197:
        for (; n.have < n.ncode;) {
          for (; l < 3;) {
            if (0 === a) break e;
            a--, u += r[o++] << l, l += 8;
          }

          n.lens[k[n.have++]] = 7 & u, u >>>= 3, l -= 3;
        }

        for (; n.have < 19;) n.lens[k[n.have++]] = 0;

        if (n.lencode = n.lendyn, n.lenbits = 7, A = {
          bits: n.lenbits
        }, N = Jn$2(0, n.lens, 0, 19, n.lencode, 0, n.work, A), n.lenbits = A.bits, N) {
          e.msg = "invalid code lengths set", n.mode = vr$1;
          break;
        }

        n.have = 0, n.mode = 16198;

      case 16198:
        for (; n.have < n.nlen + n.ndist;) {
          for (; T = n.lencode[u & (1 << n.lenbits) - 1], E = T >>> 24, g = T >>> 16 & 255, v = 65535 & T, !(E <= l);) {
            if (0 === a) break e;
            a--, u += r[o++] << l, l += 8;
          }

          if (v < 16) u >>>= E, l -= E, n.lens[n.have++] = v;else {
            if (16 === v) {
              for (C = E + 2; l < C;) {
                if (0 === a) break e;
                a--, u += r[o++] << l, l += 8;
              }

              if (u >>>= E, l -= E, 0 === n.have) {
                e.msg = "invalid bit length repeat", n.mode = vr$1;
                break;
              }

              w = n.lens[n.have - 1], _ = 3 + (3 & u), u >>>= 2, l -= 2;
            } else if (17 === v) {
              for (C = E + 3; l < C;) {
                if (0 === a) break e;
                a--, u += r[o++] << l, l += 8;
              }

              u >>>= E, l -= E, w = 0, _ = 3 + (7 & u), u >>>= 3, l -= 3;
            } else {
              for (C = E + 7; l < C;) {
                if (0 === a) break e;
                a--, u += r[o++] << l, l += 8;
              }

              u >>>= E, l -= E, w = 0, _ = 11 + (127 & u), u >>>= 7, l -= 7;
            }

            if (n.have + _ > n.nlen + n.ndist) {
              e.msg = "invalid bit length repeat", n.mode = vr$1;
              break;
            }

            for (; _--;) n.lens[n.have++] = w;
          }
        }

        if (n.mode === vr$1) break;

        if (0 === n.lens[256]) {
          e.msg = "invalid code -- missing end-of-block", n.mode = vr$1;
          break;
        }

        if (n.lenbits = 9, A = {
          bits: n.lenbits
        }, N = Jn$2(1, n.lens, 0, n.nlen, n.lencode, 0, n.work, A), n.lenbits = A.bits, N) {
          e.msg = "invalid literal/lengths set", n.mode = vr$1;
          break;
        }

        if (n.distbits = 6, n.distcode = n.distdyn, A = {
          bits: n.distbits
        }, N = Jn$2(2, n.lens, n.nlen, n.ndist, n.distcode, 0, n.work, A), n.distbits = A.bits, N) {
          e.msg = "invalid distances set", n.mode = vr$1;
          break;
        }

        if (n.mode = pr$1, t === tr$2) break e;

      case pr$1:
        n.mode = Er$1;

      case Er$1:
        if (a >= 6 && c >= 258) {
          e.next_out = s, e.avail_out = c, e.next_in = o, e.avail_in = a, n.hold = u, n.bits = l, Bn$2(e, d), s = e.next_out, i = e.output, c = e.avail_out, o = e.next_in, r = e.input, a = e.avail_in, u = n.hold, l = n.bits, n.mode === dr$1 && (n.back = -1);
          break;
        }

        for (n.back = 0; T = n.lencode[u & (1 << n.lenbits) - 1], E = T >>> 24, g = T >>> 16 & 255, v = 65535 & T, !(E <= l);) {
          if (0 === a) break e;
          a--, u += r[o++] << l, l += 8;
        }

        if (g && 0 == (240 & g)) {
          for (b = E, m = g, y = v; T = n.lencode[y + ((u & (1 << b + m) - 1) >> b)], E = T >>> 24, g = T >>> 16 & 255, v = 65535 & T, !(b + E <= l);) {
            if (0 === a) break e;
            a--, u += r[o++] << l, l += 8;
          }

          u >>>= b, l -= b, n.back += b;
        }

        if (u >>>= E, l -= E, n.back += E, n.length = v, 0 === g) {
          n.mode = 16205;
          break;
        }

        if (32 & g) {
          n.back = -1, n.mode = dr$1;
          break;
        }

        if (64 & g) {
          e.msg = "invalid literal/length code", n.mode = vr$1;
          break;
        }

        n.extra = 15 & g, n.mode = 16201;

      case 16201:
        if (n.extra) {
          for (C = n.extra; l < C;) {
            if (0 === a) break e;
            a--, u += r[o++] << l, l += 8;
          }

          n.length += u & (1 << n.extra) - 1, u >>>= n.extra, l -= n.extra, n.back += n.extra;
        }

        n.was = n.length, n.mode = 16202;

      case 16202:
        for (; T = n.distcode[u & (1 << n.distbits) - 1], E = T >>> 24, g = T >>> 16 & 255, v = 65535 & T, !(E <= l);) {
          if (0 === a) break e;
          a--, u += r[o++] << l, l += 8;
        }

        if (0 == (240 & g)) {
          for (b = E, m = g, y = v; T = n.distcode[y + ((u & (1 << b + m) - 1) >> b)], E = T >>> 24, g = T >>> 16 & 255, v = 65535 & T, !(b + E <= l);) {
            if (0 === a) break e;
            a--, u += r[o++] << l, l += 8;
          }

          u >>>= b, l -= b, n.back += b;
        }

        if (u >>>= E, l -= E, n.back += E, 64 & g) {
          e.msg = "invalid distance code", n.mode = vr$1;
          break;
        }

        n.offset = v, n.extra = 15 & g, n.mode = 16203;

      case 16203:
        if (n.extra) {
          for (C = n.extra; l < C;) {
            if (0 === a) break e;
            a--, u += r[o++] << l, l += 8;
          }

          n.offset += u & (1 << n.extra) - 1, u >>>= n.extra, l -= n.extra, n.back += n.extra;
        }

        if (n.offset > n.dmax) {
          e.msg = "invalid distance too far back", n.mode = vr$1;
          break;
        }

        n.mode = 16204;

      case 16204:
        if (0 === c) break e;

        if (_ = d - c, n.offset > _) {
          if (_ = n.offset - _, _ > n.whave && n.sane) {
            e.msg = "invalid distance too far back", n.mode = vr$1;
            break;
          }

          _ > n.wnext ? (_ -= n.wnext, f = n.wsize - _) : f = n.wnext - _, _ > n.length && (_ = n.length), p = n.window;
        } else p = i, f = s - n.offset, _ = n.length;

        _ > c && (_ = c), c -= _, n.length -= _;

        do {
          i[s++] = p[f++];
        } while (--_);

        0 === n.length && (n.mode = Er$1);
        break;

      case 16205:
        if (0 === c) break e;
        i[s++] = n.length, c--, n.mode = Er$1;
        break;

      case gr$1:
        if (n.wrap) {
          for (; l < 32;) {
            if (0 === a) break e;
            a--, u |= r[o++] << l, l += 8;
          }

          if (d -= c, e.total_out += d, n.total += d, 4 & n.wrap && d && (e.adler = n.check = n.flags ? St$3(n.check, i, d, s - d) : Nt$3(n.check, i, d, s - d)), d = c, 4 & n.wrap && (n.flags ? u : br$1(u)) !== n.check) {
            e.msg = "incorrect data check", n.mode = vr$1;
            break;
          }

          u = 0, l = 0;
        }

        n.mode = 16207;

      case 16207:
        if (n.wrap && n.flags) {
          for (; l < 32;) {
            if (0 === a) break e;
            a--, u += r[o++] << l, l += 8;
          }

          if (4 & n.wrap && u !== (4294967295 & n.total)) {
            e.msg = "incorrect length check", n.mode = vr$1;
            break;
          }

          u = 0, l = 0;
        }

        n.mode = 16208;

      case 16208:
        N = rr$1;
        break e;

      case vr$1:
        N = sr$2;
        break e;

      case 16210:
        return ar$1;

      default:
        return or$1;
    }

    return e.next_out = s, e.avail_out = c, e.next_in = o, e.avail_in = a, n.hold = u, n.bits = l, (n.wsize || d !== e.avail_out && n.mode < vr$1 && (n.mode < gr$1 || t !== $n$2)) && Ir$1(e, e.output, e.next_out, d - e.avail_out), h -= e.avail_in, d -= e.avail_out, e.total_in += h, e.total_out += d, n.total += d, 4 & n.wrap && d && (e.adler = n.check = n.flags ? St$3(n.check, i, d, e.next_out - d) : Nt$3(n.check, i, d, e.next_out - d)), e.data_type = n.bits + (n.last ? 64 : 0) + (n.mode === dr$1 ? 128 : 0) + (n.mode === pr$1 || n.mode === fr$1 ? 256 : 0), (0 === h && 0 === d || t === $n$2) && N === nr$2 && (N = cr$1), N;
  },
  inflateEnd: e => {
    if (yr$1(e)) return or$1;
    let t = e.state;
    return t.window && (t.window = null), e.state = null, nr$2;
  },
  inflateGetHeader: (e, t) => {
    if (yr$1(e)) return or$1;
    const n = e.state;
    return 0 == (2 & n.wrap) ? or$1 : (n.head = t, t.done = !1, nr$2);
  },
  inflateSetDictionary: (e, t) => {
    const n = t.length;
    let r, i, o;
    return yr$1(e) ? or$1 : (r = e.state, 0 !== r.wrap && r.mode !== hr$1 ? or$1 : r.mode === hr$1 && (i = 1, i = Nt$3(i, t, n, 0), i !== r.check) ? sr$2 : (o = Ir$1(e, t, n, n), o ? (r.mode = 16210, ar$1) : (r.havedict = 1, nr$2)));
  },
  inflateInfo: "pako inflate (from Nodeca project)"
};

var Dr$1 = function () {
  this.text = 0, this.time = 0, this.xflags = 0, this.os = 0, this.extra = null, this.extra_len = 0, this.name = "", this.comment = "", this.hcrc = 0, this.done = !1;
};

const Lr$1 = Object.prototype.toString,
      {
  Z_NO_FLUSH: xr$1,
  Z_FINISH: Ur$1,
  Z_OK: Mr$1,
  Z_STREAM_END: Pr$1,
  Z_NEED_DICT: zr$1,
  Z_STREAM_ERROR: Fr$1,
  Z_DATA_ERROR: Hr$1,
  Z_MEM_ERROR: Vr$1
} = Ct$2;

function Gr$1(e) {
  this.options = Cn$2.assign({
    chunkSize: 65536,
    windowBits: 15,
    to: ""
  }, e || {});
  const t = this.options;
  t.raw && t.windowBits >= 0 && t.windowBits < 16 && (t.windowBits = -t.windowBits, 0 === t.windowBits && (t.windowBits = -15)), !(t.windowBits >= 0 && t.windowBits < 16) || e && e.windowBits || (t.windowBits += 32), t.windowBits > 15 && t.windowBits < 48 && 0 == (15 & t.windowBits) && (t.windowBits |= 15), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new Rn$2(), this.strm.avail_out = 0;
  let n = Rr$1.inflateInit2(this.strm, t.windowBits);
  if (n !== Mr$1) throw new Error(At$3[n]);
  if (this.header = new Dr$1(), Rr$1.inflateGetHeader(this.strm, this.header), t.dictionary && ("string" == typeof t.dictionary ? t.dictionary = In$2.string2buf(t.dictionary) : "[object ArrayBuffer]" === Lr$1.call(t.dictionary) && (t.dictionary = new Uint8Array(t.dictionary)), t.raw && (n = Rr$1.inflateSetDictionary(this.strm, t.dictionary), n !== Mr$1))) throw new Error(At$3[n]);
}

function qr$1(e, t) {
  const n = new Gr$1(t);
  if (n.push(e), n.err) throw n.msg || At$3[n.err];
  return n.result;
}

Gr$1.prototype.push = function (e, t) {
  const n = this.strm,
        r = this.options.chunkSize,
        i = this.options.dictionary;
  let o, s, a;
  if (this.ended) return !1;

  for (s = t === ~~t ? t : !0 === t ? Ur$1 : xr$1, "[object ArrayBuffer]" === Lr$1.call(e) ? n.input = new Uint8Array(e) : n.input = e, n.next_in = 0, n.avail_in = n.input.length;;) {
    for (0 === n.avail_out && (n.output = new Uint8Array(r), n.next_out = 0, n.avail_out = r), o = Rr$1.inflate(n, s), o === zr$1 && i && (o = Rr$1.inflateSetDictionary(n, i), o === Mr$1 ? o = Rr$1.inflate(n, s) : o === Hr$1 && (o = zr$1)); n.avail_in > 0 && o === Pr$1 && n.state.wrap > 0 && 0 !== e[n.next_in];) Rr$1.inflateReset(n), o = Rr$1.inflate(n, s);

    switch (o) {
      case Fr$1:
      case Hr$1:
      case zr$1:
      case Vr$1:
        return this.onEnd(o), this.ended = !0, !1;
    }

    if (a = n.avail_out, n.next_out && (0 === n.avail_out || o === Pr$1)) if ("string" === this.options.to) {
      let e = In$2.utf8border(n.output, n.next_out),
          t = n.next_out - e,
          i = In$2.buf2string(n.output, e);
      n.next_out = t, n.avail_out = r - t, t && n.output.set(n.output.subarray(e, e + t), 0), this.onData(i);
    } else this.onData(n.output.length === n.next_out ? n.output : n.output.subarray(0, n.next_out));

    if (o !== Mr$1 || 0 !== a) {
      if (o === Pr$1) return o = Rr$1.inflateEnd(this.strm), this.onEnd(o), this.ended = !0, !0;
      if (0 === n.avail_in) break;
    }
  }

  return !0;
}, Gr$1.prototype.onData = function (e) {
  this.chunks.push(e);
}, Gr$1.prototype.onEnd = function (e) {
  e === Mr$1 && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = Cn$2.flattenChunks(this.chunks)), this.chunks = [], this.err = e, this.msg = this.strm.msg;
};
var jr$1 = {
  Inflate: Gr$1,
  inflate: qr$1,
  inflateRaw: function (e, t) {
    return (t = t || {}).raw = !0, qr$1(e, t);
  },
  ungzip: qr$1,
  constants: Ct$2
};
const {
  Deflate: Kr$1,
  deflate: Br$1,
  deflateRaw: Zr$1,
  gzip: Wr$1
} = jn$2,
      {
  Inflate: Qr$1,
  inflate: Yr$1,
  inflateRaw: Xr$1,
  ungzip: Jr$1
} = jr$1;
var $r$1,
    ei$1 = {
  Deflate: Kr$1,
  deflate: Br$1,
  deflateRaw: Zr$1,
  gzip: Wr$1,
  Inflate: Qr$1,
  inflate: Yr$1,
  inflateRaw: Xr$1,
  ungzip: Jr$1,
  constants: Ct$2
};
!function (e) {
  e.CONNECTING = "CONNECTING", e.OPEN = "OPEN", e.CLOSED = "CLOSED";
}($r$1 || ($r$1 = {}));

var ti$1,
    ni$1 = function (e) {
  function n(t, n) {
    var r = n.sdkState,
        i = n.dispatcher,
        o = n.logger,
        s = e.call(this) || this;
    return s.lastActive = 0, s._iid = t, s._sdkState = r, s._dispatcher = i, s._logger = o, s;
  }

  return t$1(n, e), Object.defineProperty(n.prototype, "isOpen", {
    get: function () {
      return this.connectionState === $r$1.OPEN;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "connectionState", {
    get: function () {
      if (this._ws) switch (this._ws.readyState) {
        case 0:
          return $r$1.CONNECTING;

        case 1:
          return $r$1.OPEN;
      }
      return $r$1.CLOSED;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "ws", {
    get: function () {
      var e;
      return null !== (e = this._ws) && void 0 !== e ? e : null;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype._handleMessage = function (e) {
    var t = this;
    e.split("\n").forEach(function (e) {
      if (e) {
        var n = Pe$3.createFromRawMessage(t._iid, e);
        if (t._logger.debug("receive websocket event", n), "LOGI" === n.code) t.dispatch("message", n);else if ("PONG" === n.code) t.dispatch("pong");else if ("EXPR" === n.code) {
          if (n.payload) {
            var r = new Ae$1(n.payload);
            r.expiresIn >= 0 && t._dispatcher.dispatch(r);
          }
        } else "NOOP" === n.code || t.dispatch("message", n);
      }
    });
  }, n.prototype.connect = function (e) {
    var t = this;
    this._ws = new WebSocket(e), this._ws.onopen = function () {
      t._logger.debug("websocket open"), t.dispatch("open");
    }, this._ws.onmessage = function (e) {
      return i$1(t, void 0, void 0, function () {
        var t,
            n,
            r = this;
        return o$1(this, function (s) {
          return (null === (n = this._sdkState.websocket) || void 0 === n ? void 0 : n.compression) ? e.data instanceof Blob ? ((t = new FileReader()).readAsArrayBuffer(e.data), t.onloadend = function () {
            return i$1(r, void 0, void 0, function () {
              var e;
              return o$1(this, function (n) {
                switch (n.label) {
                  case 0:
                    return [4, (r = t.result, i$1(void 0, void 0, void 0, function () {
                      var e;
                      return o$1(this, function (t) {
                        return e = ei$1.ungzip(r), [2, String.fromCharCode.apply(null, e)];
                      });
                    }))];

                  case 1:
                    return e = n.sent(), this._handleMessage(e), [2];
                }

                var r;
              });
            });
          }) : "string" == typeof e.data && this._handleMessage(e.data) : this._handleMessage(e.data), [2];
        });
      });
    }, this._ws.onerror = function () {
      t._logger.debug("websocket error"), t.dispatch("error", v$2.networkError);
    }, this._ws.onclose = function () {
      t._logger.debug("websocket close"), t.dispatch("close");
    }, this.lastActive = Date.now();
  }, n.prototype.disconnect = function () {
    var e = this;
    return new Promise(function (t) {
      e._logger.debug("websocket disconnect"), e._ws && e.connectionState !== $r$1.CLOSED ? (e._ws.onopen = ze$2, e._ws.onmessage = ze$2, e._ws.onerror = ze$2, e._ws.onclose = function () {
        e.dispatch("close"), t();
      }, e._ws.close(), e._ws = void 0) : t();
    });
  }, n.prototype.send = function (e) {
    if (!this._ws) throw v$2.connectionClosed;
    "PING" !== e.code ? this.dispatch("ping-refresh") : this._logger.debug("send ping", e), this._ws.send(e.convertToMessage());
  }, n.prototype.error = function (e) {
    this._logger.debug("websocket error", e), this.dispatch("error", e);
  }, n;
}(Q),
    ri$1 = function (e) {
  function n(t) {
    var n,
        r = t.code,
        i = t.ackRequired,
        o = t.payload,
        s = void 0 === o ? {} : o,
        a = this;
    return (a = e.call(this) || this).code = r, a.payload = s, a.requestId = null !== (n = a.payload.req_id) && void 0 !== n ? n : Z(), a.ackRequired = i, a.payload.req_id = a.requestId, a;
  }

  return t$1(n, e), n.prototype.convertToMessage = function () {
    return "".concat(this.code).concat(JSON.stringify(this.payload), "\n");
  }, n;
}(X),
    ii$1 = function (e) {
  function n(t) {
    var n = t.all,
        r = t.feed,
        i = t.custom_types,
        o = t.ts,
        s = e.call(this) || this;
    return s.all = n, s.feed = r, s.customTypes = i, s.ts = o, s;
  }

  return t$1(n, e), n;
}(X),
    oi$1 = function () {
  var e = this;
  this.promise = new Promise(function (t, n) {
    e.resolve = t, e.reject = n;
  });
},
    si$1 = function () {
  function e(e, t) {
    var n = t.auth,
        r = t.sdkState,
        i = t.dispatcher,
        o = t.logger,
        s = t.useFetchCompat,
        a = void 0 !== s && s,
        c = this;
    this._ackStateMap = new Map(), this._sdkState = r, this._dispatcher = i, this._logger = o, this.apiClient = new Me$2(e, {
      auth: n,
      sdkState: r,
      dispatcher: i,
      logger: o,
      useFetchCompat: a
    }), this.websocketClient = new ni$1(e, {
      sdkState: r,
      dispatcher: i,
      logger: o
    }), this.websocketClient.on("message", function (e) {
      if (e.payload.unread_cnt && c._dispatcher.dispatch(new ii$1(e.payload.unread_cnt)), e.requestId) {
        if (c._ackStateMap.has(e.requestId)) {
          var t = c._ackStateMap.get(e.requestId);

          "EROR" !== e.code ? t.resolve(e) : t.reject(new v$2({
            code: e.payload.code,
            message: e.payload.message
          }));
        }
      } else c._dispatcher.dispatch(e);
    }).on("close", function () {
      c._ackStateMap.forEach(function (e) {
        e.reject(v$2.connectionClosed);
      }), c._ackStateMap.clear();
    });
  }

  return e.prototype._sendApiRequest = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this.apiClient.send(e)];

          case 1:
            return [2, t.sent()];
        }
      });
    });
  }, e.prototype._sendWebsocketRequest = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i = this;
      return o$1(this, function (o) {
        if (!this._sdkState.websocket) throw v$2.connectionRequired;

        if (t = new oi$1(), e.ackRequired) {
          r = function (r, o) {
            i._ackStateMap.has(e.requestId) && (i._ackStateMap.delete(e.requestId), n && (clearTimeout(n), n = null), r ? (i._logger.debug("fail websocket request", r), t.reject(r)) : (i._logger.debug("receive websocket ack", e.requestId), t.resolve(o)));
          };

          try {
            n = setTimeout(function () {
              return r(v$2.noAckTimeout);
            }, this._sdkState.websocket.responseTimeout), this._ackStateMap.set(e.requestId, {
              resolve: function (e) {
                return r(void 0, e);
              },
              reject: function (e) {
                return r(e);
              }
            }), this.websocketClient.send(e);
          } catch (e) {
            r(e);
          }
        } else try {
          this.websocketClient.send(e), t.resolve();
        } catch (e) {
          t.reject(e);
        }

        return [2, t.promise];
      });
    });
  }, e.prototype.send = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e instanceof Ne$2 ? [4, this._sendApiRequest(e)] : [3, 2];

          case 1:
          case 3:
            return [2, t.sent()];

          case 2:
            return e instanceof ri$1 ? [4, this._sendWebsocketRequest(e)] : [3, 4];

          case 4:
            throw v$2.invalidParameters;
        }
      });
    });
  }, e.prototype.cancel = function (e) {
    this.apiClient.cancel(e);
  }, e.prototype.cancelAll = function () {
    this.apiClient.cancelAll();
  }, e;
}();

!function (e) {
  e[e.NONE = 0] = "NONE", e[e.INITIALIZED = 1] = "INITIALIZED", e[e.CONNECTING = 2] = "CONNECTING", e[e.CONNECTED = 3] = "CONNECTED", e[e.RECONNECTING = 4] = "RECONNECTING", e[e.INTERNAL_DISCONNECTED = 5] = "INTERNAL_DISCONNECTED", e[e.EXTERNAL_DISCONNECTED = 6] = "EXTERNAL_DISCONNECTED", e[e.LOGOUT = 7] = "LOGOUT";
}(ti$1 || (ti$1 = {}));

var ai$1 = function (e) {
  function n(t) {
    var n = t.stateType,
        r = e.call(this) || this;
    return r.stateType = n, r;
  }

  return t$1(n, e), n;
}(X),
    ci$1 = function () {
  function e(e, t) {
    var n = t.auth,
        r = t.sdkState,
        s = t.dispatcher,
        a = t.logger,
        c = t.useFetchCompat,
        u = void 0 !== c && c,
        l = this;
    this._currentConnectionStateType = ti$1.INITIALIZED, this._lazyCallQueue = [], this.commandRouter = new si$1(e, {
      auth: n,
      sdkState: r,
      dispatcher: s,
      logger: a,
      useFetchCompat: u
    }), this._auth = n, this._logger = a, this._dispatcher = s, this._dispatcher.on(function (e) {
      if (e instanceof ai$1) {
        var t = e.stateType;

        switch (l._currentConnectionStateType = t, t) {
          case ti$1.CONNECTED:
            var n = l._lazyCallQueue;
            l._lazyCallQueue = [], n.forEach(function (e) {
              return i$1(l, void 0, void 0, function () {
                var t, n, r, i, s;
                return o$1(this, function (o) {
                  switch (o.label) {
                    case 0:
                      t = e.command, n = e.deferred, r = e.timeout, clearTimeout(r), o.label = 1;

                    case 1:
                      return o.trys.push([1, 3,, 4]), [4, this.send(t)];

                    case 2:
                      return i = o.sent(), n.resolve(i), [3, 4];

                    case 3:
                      return s = o.sent(), n.reject(s), [3, 4];

                    case 4:
                      return [2];
                  }
                });
              });
            });
            break;

          case ti$1.INITIALIZED:
          case ti$1.INTERNAL_DISCONNECTED:
          case ti$1.EXTERNAL_DISCONNECTED:
          case ti$1.LOGOUT:
            n = l._lazyCallQueue;
            l._lazyCallQueue = [], n.forEach(function (e) {
              return i$1(l, void 0, void 0, function () {
                var t, n;
                return o$1(this, function (r) {
                  return t = e.deferred, n = e.timeout, clearTimeout(n), this._auth && this._auth.hasSession ? t.reject(v$2.connectionClosed) : t.reject(v$2.connectionRequired), [2];
                });
              });
            });
        }
      }
    });
  }

  return Object.defineProperty(e.prototype, "isReady", {
    get: function () {
      return this._currentConnectionStateType === ti$1.CONNECTED;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "isLazyCallActivated", {
    get: function () {
      return this._currentConnectionStateType === ti$1.CONNECTING || this._currentConnectionStateType === ti$1.RECONNECTING;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.send = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r = this;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return e instanceof ri$1 ? this.isReady ? (this._logger.debug("send websocket request", e), [4, this.commandRouter.send(e)]) : [3, 2] : [3, 4];

          case 1:
          case 5:
            return [2, i.sent()];

          case 2:
            if (this.isLazyCallActivated) return this._logger.debug("wait websocket request", e), t = new oi$1(), this._lazyCallQueue.push({
              command: e,
              deferred: t,
              timeout: setTimeout(function () {
                return r.timeout(e.requestId);
              }, 1e4)
            }), [2, t.promise];
            throw this._logger.debug("fail websocket request"), v$2.connectionRequired;

          case 3:
          case 7:
            return [3, 9];

          case 4:
            return e instanceof Ne$2 ? this._auth.hasSession ? (this._logger.debug("send api request", e), [4, this.commandRouter.send(e)]) : [3, 6] : [3, 8];

          case 6:
            if (this.isLazyCallActivated) return this._logger.debug("wait api request", e), t = new oi$1(), this._lazyCallQueue.push({
              command: e,
              deferred: t,
              timeout: setTimeout(function () {
                return r.timeout(e.requestId);
              }, 1e4)
            }), [2, t.promise];
            throw n = v$2.connectionRequired, this._logger.debug("fail api request", n), n;

          case 8:
            throw v$2.invalidCommand;

          case 9:
            return [2];
        }
      });
    });
  }, e.prototype.forceSend = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this._logger.debug("send forced request", e), e instanceof ri$1 || e instanceof Ne$2 ? [4, this.commandRouter.send(e)] : [3, 2];

          case 1:
            return [2, t.sent()];

          case 2:
            throw v$2.invalidCommand;
        }
      });
    });
  }, e.prototype.timeout = function (e) {
    this._logger.debug("timeout request", e);

    var t = this._lazyCallQueue.findIndex(function (t) {
      return t.command.requestId === e;
    });

    t > -1 && (this._lazyCallQueue[t].deferred.reject(v$2.connectionRequired), this._lazyCallQueue.splice(t, 1));
  }, e.prototype.cancel = function (e) {
    this._logger.debug("cancel api request", e), this.commandRouter.cancel(e);
  }, e.prototype.cancelAll = function () {
    this._logger.debug("cancel all api requests"), this.commandRouter.cancelAll();
  }, e;
}(),
    ui$1 = "sendbird@devicetokens",
    li$1 = function () {
  function e(e) {
    var t = e.type,
        n = e.token;
    this.type = t, this.token = n;
  }

  return e.payloadify = function (e) {
    return J($({
      type: e.type,
      token: e.token
    }));
  }, e;
}(),
    hi$1 = function (e) {
  function n(t) {
    var n = t.userId,
        r = t.authToken,
        i = t.expiringSession,
        o = void 0 === i || i,
        s = e.call(this) || this;
    return s.path = "".concat(ne, "/").concat(n, "/session_key"), s.method = ee.POST, s.params = {
      token: r,
      expiring_session: !!o
    }, s.requireAuth = !1, s;
  }

  return t$1(n, e), n;
}(Ne$2),
    di$1 = function (e) {
  function n(t) {
    var n = t.authToken,
        r = t.expiringSession,
        i = void 0 === r || r,
        o = t.requestId,
        s = void 0 === o ? "" : o;
    return e.call(this, {
      code: "LOGI",
      payload: {
        token: n,
        expiring_session: i ? 1 : 0,
        req_id: s
      },
      ackRequired: !0
    }) || this;
  }

  return t$1(n, e), n;
}(ri$1),
    _i$1 = function (e) {
  function n(t, n) {
    var r = e.call(this, t, n) || this,
        i = n.key;
    return r.key = i, r;
  }

  return t$1(n, e), n;
}(Te$2),
    fi$1 = function (e) {
  function n(t, n, r) {
    var i,
        o = this;
    return (o = e.call(this, t, "LOGI", r) || this).error = null, o.newKey = null, o.newKey = null !== (i = r.new_key) && void 0 !== i ? i : null, o.error = r.error ? new v$2(r.error) : null, o;
  }

  return t$1(n, e), n;
}(Pe$3),
    pi$1 = function (e) {
  function n() {
    return null !== e && e.apply(this, arguments) || this;
  }

  return t$1(n, e), n;
}(X),
    Ei$1 = function (e) {
  return i$1(void 0, void 0, void 0, function () {
    return o$1(this, function (t) {
      return [2, new Promise(function (t) {
        return setTimeout(t, e);
      })];
    });
  });
},
    gi$1 = function () {
  function e() {}

  return e.prototype.calcTimeout = function () {
    return 0;
  }, e;
}(),
    vi$1 = function (e, t, n) {
  return void 0 === n && (n = new gi$1()), i$1(void 0, void 0, void 0, function () {
    var r, i, s, a, c, u;
    return o$1(this, function (o) {
      switch (o.label) {
        case 0:
          r = 0, i = null, s = function (e) {
            return i = null != e ? e : new Error("Halted");
          }, a = function () {
            r = 0;
          }, o.label = 1;

        case 1:
          if (!(-1 === t || r < t)) return [3, 9];
          o.label = 2;

        case 2:
          return o.trys.push([2, 4,, 8]), [4, e(s, a)];

        case 3:
          if (c = o.sent(), i) throw i;
          return [2, c];

        case 4:
          if (u = o.sent(), i) return [3, 6];
          if (++r === t) throw u;
          return [4, Ei$1(n.calcTimeout(r))];

        case 5:
          return o.sent(), [3, 7];

        case 6:
          throw i;

        case 7:
          return [3, 8];

        case 8:
          return [3, 1];

        case 9:
          throw "It should not happen.";
      }
    });
  });
},
    bi$1 = function (e) {
  return i$1(void 0, void 0, void 0, function () {
    var t;
    return o$1(this, function (n) {
      switch (n.label) {
        case 0:
          return n.trys.push([0, 2,, 3]), [4, e()];

        case 1:
          return n.sent(), [3, 3];

        case 2:
          if (!((t = n.sent()) instanceof v$2)) throw t;
          return t.throwOutside(), [3, 3];

        case 3:
          return [2];
      }
    });
  });
},
    mi$1 = function (e) {
  return i$1(void 0, void 0, void 0, function () {
    return o$1(this, function (t) {
      switch (t.label) {
        case 0:
          return t.trys.push([0, 2,, 3]), [4, e()];

        case 1:
        case 2:
          return t.sent(), [3, 3];

        case 3:
          return [2];
      }
    });
  });
},
    yi$1 = new WeakMap(),
    wi$1 = function (e) {
  function n(t) {
    var n = t.auth,
        r = t.cacheContext,
        i = t.sdkState,
        o = t.dispatcher,
        s = t.requestQueue,
        a = t.logger,
        c = e.call(this) || this;
    return c._currentConnectionStateType = ti$1.INITIALIZED, c._isRefreshingAuthToken = !1, c._isRefreshingSessionKey = !1, c.currentUser = null, c.auth = n, c._cacheContext = r, c._sdkState = i, c._dispatcher = o, c._requestQueue = s, c._logger = a, c._deviceTokens = [], c._dispatcher.on(function (e) {
      var t;

      if (e instanceof ai$1) {
        var n = e.stateType;
        c._currentConnectionStateType = n;
      } else e instanceof Ae$1 && c.handler && (e.invalidateSessionToken && (c.auth.authToken = void 0), e.error && (e.error.isSessionKeyExpiredError || e.error.isSessionTokenExpiredError) && (c._logger.debug("session expired"), (null === (t = c.handler) || void 0 === t ? void 0 : t.onSessionExpired) && c.handler.onSessionExpired(), c.refresh()));
    }), c;
  }

  return t$1(n, e), Object.defineProperty(n.prototype, "ekey", {
    get: function () {
      return yi$1.get(this);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "deviceTokens", {
    get: function () {
      return this._deviceTokens;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "deviceTokenLastDeletedAt", {
    get: function () {
      return this._deviceTokenLastDeletedAt;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype.indexOfDeviceToken = function (e, t) {
    return this._deviceTokens.findIndex(function (n) {
      return n.type === e && n.token === t;
    });
  }, n.prototype.hasDeviceToken = function (e, t) {
    return this.indexOfDeviceToken(e, t) >= 0;
  }, n.prototype.createRefreshWebsocketCommand = function (e, t) {
    return new di$1({
      authToken: e,
      expiringSession: !0,
      requestId: t
    });
  }, n.prototype._refreshSessionKeyByWebSocket = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return t = this.createRefreshWebsocketCommand(e), [4, this._requestQueue.forceSend(t)];

          case 1:
            if (n = o.sent(), r = n.as(fi$1), i = r.newKey, s = r.error) throw s;
            return this.auth.sessionKey = null != i ? i : this.auth.sessionKey, [2];
        }
      });
    });
  }, n.prototype._refreshSessionKeyByApi = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n = this;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return t = new hi$1({
              userId: this._sdkState.userId,
              authToken: e,
              expiringSession: !0
            }), [4, vi$1(function (e) {
              return i$1(n, void 0, void 0, function () {
                var n, r, i;
                return o$1(this, function (o) {
                  switch (o.label) {
                    case 0:
                      return o.trys.push([0, 2,, 3]), [4, this._requestQueue.forceSend(t)];

                    case 1:
                      return n = o.sent(), r = n.as(_i$1).key, this.auth.sessionKey = r, [3, 3];

                    case 2:
                      if (i = o.sent(), !this._isSessionRelatedError(i)) throw i;
                      return e(i), [3, 3];

                    case 3:
                      return [2];
                  }
                });
              });
            }, 3)];

          case 1:
            return r.sent(), [2];
        }
      });
    });
  }, n.prototype._refreshSessionKey = function (e, t) {
    return void 0 === t && (t = !0), i$1(this, void 0, void 0, function () {
      var n, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            if (this._currentConnectionStateType !== ti$1.CONNECTED) return [3, 10];
            o.label = 1;

          case 1:
            return o.trys.push([1, 3,, 10]), [4, this._refreshSessionKeyByWebSocket(e)];

          case 2:
            return o.sent(), this.complete(), [2];

          case 3:
            return n = o.sent(), this._isSessionRelatedError(n) && t ? [4, this._receiveNewAuthToken()] : [3, 9];

          case 4:
            return (i = o.sent()) ? (this.auth.authToken = i, [4, this._refreshSessionKey(this.auth.authToken, !1)]) : [3, 6];

          case 5:
            return o.sent(), this.complete(), [3, 8];

          case 6:
            return [4, this.clear()];

          case 7:
            o.sent(), this.close(), o.label = 8;

          case 8:
            return [2];

          case 9:
            return [3, 10];

          case 10:
            return o.trys.push([10, 12,, 22]), [4, this._refreshSessionKeyByApi(e)];

          case 11:
            return o.sent(), this.complete(), [3, 22];

          case 12:
            return r = o.sent(), this._isSessionRelatedError(r) ? t ? [4, this._receiveNewAuthToken()] : [3, 18] : [3, 20];

          case 13:
            return (i = o.sent()) ? (this.auth.authToken = i, [4, this._refreshSessionKeyByApi(this.auth.authToken)]) : [3, 15];

          case 14:
            return o.sent(), this.complete(), [3, 17];

          case 15:
            return [4, this.clear()];

          case 16:
            o.sent(), this.close(), o.label = 17;

          case 17:
            return [3, 19];

          case 18:
            throw r;

          case 19:
            return [3, 21];

          case 20:
            throw r;

          case 21:
            return [3, 22];

          case 22:
            return [2];
        }
      });
    });
  }, n.prototype._receiveNewAuthToken = function () {
    var e = this,
        t = new oi$1();
    return bi$1(function () {
      return i$1(e, void 0, void 0, function () {
        var e,
            n,
            r,
            i,
            s = this;
        return o$1(this, function (o) {
          return this._isRefreshingAuthToken = !0, this.auth.clear(), this.handler.onSessionTokenRequired ? (e = null, n = function () {
            e && (clearTimeout(e), e = null);
          }, r = function (e) {
            n(), s._isRefreshingAuthToken && (s._isRefreshingAuthToken = !1, s.dispatch("refresh-authtoken"), t.resolve(e));
          }, i = function (e) {
            n(), s._isRefreshingAuthToken && (s._isRefreshingAuthToken = !1, t.reject(e));
          }, e = setTimeout(function () {
            return i();
          }, 1e3 * this._sdkState.sessionTokenRefreshTimeout), this.handler.onSessionTokenRequired(r, i)) : t.resolve(null), [2];
        });
      });
    }), t.promise;
  }, n.prototype._isSessionRelatedError = function (e) {
    return e instanceof v$2 && (e.isSessionKeyExpiredError || e.isSessionTokenExpiredError || e.isSessionRevokedError);
  }, Object.defineProperty(n.prototype, "isSessionKeyRefreshing", {
    get: function () {
      return this._isRefreshingSessionKey;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "isRefreshingAuthToken", {
    get: function () {
      return this._isRefreshingAuthToken;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype.login = function (e) {
    var t;
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s, a, c, u;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return n = e.key, r = e.ekey, i = e.userProfile, s = e.deviceTokenLastDeletedAt, a = void 0 === s ? 0 : s, this.auth.sessionKey = n, yi$1.set(this, r), this._deviceTokenCacheEnabled = null === (t = null == i ? void 0 : i.appInfo) || void 0 === t ? void 0 : t.deviceTokenCache, c = this._cacheContext.preference, this._deviceTokenCacheEnabled ? [4, c.get(ui$1)] : [3, 5];

          case 1:
            return !(u = o.sent()) || u.lastDeletedAt < a ? (this._deviceTokens = [], this._deviceTokenLastDeletedAt = a, [4, this.saveDeviceToken()]) : [3, 3];

          case 2:
            return o.sent(), [3, 4];

          case 3:
            this._deviceTokens = u.tokens.map(function (e) {
              return new li$1(li$1.payloadify(e));
            }), this._deviceTokenLastDeletedAt = u.lastDeletedAt, o.label = 4;

          case 4:
            return [3, 7];

          case 5:
            return [4, c.remove(ui$1)];

          case 6:
            o.sent(), o.label = 7;

          case 7:
            return [2];
        }
      });
    });
  }, n.prototype.complete = function () {
    var e = this;
    this.dispatch("refresh"), bi$1(function () {
      return i$1(e, void 0, void 0, function () {
        var e;
        return o$1(this, function (t) {
          return this._logger.debug("session refreshed"), (null === (e = this.handler) || void 0 === e ? void 0 : e.onSessionRefreshed) && this.handler.onSessionRefreshed(), [2];
        });
      });
    });
  }, n.prototype.error = function (e) {
    var t = this;
    bi$1(function () {
      return i$1(t, void 0, void 0, function () {
        var t;
        return o$1(this, function (n) {
          return (null === (t = this.handler) || void 0 === t ? void 0 : t.onSessionError) && this.handler.onSessionError(e), [2];
        });
      });
    });
  }, n.prototype.close = function () {
    var e = this;
    this.dispatch("close"), bi$1(function () {
      return i$1(e, void 0, void 0, function () {
        var e;
        return o$1(this, function (t) {
          return this._logger.debug("session closed"), (null === (e = this.handler) || void 0 === e ? void 0 : e.onSessionClosed) && this.handler.onSessionClosed(), [2];
        });
      });
    });
  }, n.prototype.refresh = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            if (!this.handler) return [3, 10];
            if (this._isRefreshingSessionKey) return [3, 10];
            if (this._isRefreshingSessionKey = !0, this.auth.authToken) return [3, 7];
            n.label = 1;

          case 1:
            return n.trys.push([1, 6,, 7]), [4, this._receiveNewAuthToken()];

          case 2:
            return (e = n.sent()) ? (this._logger.debug("session refreshing.."), this.auth.authToken = e, [3, 5]) : [3, 3];

          case 3:
            return [4, this.clear()];

          case 4:
            return n.sent(), this._isRefreshingSessionKey = !1, [2];

          case 5:
            return [3, 7];

          case 6:
            throw n.sent(), t = v$2.sessionTokenRequestFailed, this._dispatcher.dispatch(new pi$1()), this.error(t), this._isRefreshingSessionKey = !1, t;

          case 7:
            return n.trys.push([7, 9,, 10]), [4, this._refreshSessionKey(this.auth.authToken)];

          case 8:
            return n.sent(), this._isRefreshingSessionKey = !1, [3, 10];

          case 9:
            throw n.sent(), t = v$2.sessionTokenRefreshFailed, this._dispatcher.dispatch(new pi$1()), this.error(t), this._isRefreshingSessionKey = !1, t;

          case 10:
            return [2];
        }
      });
    });
  }, n.prototype.setDeviceToken = function (e, t) {
    if (this._deviceTokenCacheEnabled && this.indexOfDeviceToken(e, t) < 0) return this._deviceTokens.push(new li$1({
      type: e,
      token: t
    })), !0;
    return !1;
  }, n.prototype.unsetDeviceToken = function (e, t) {
    if (this._deviceTokenCacheEnabled) {
      var n = this.indexOfDeviceToken(e, t);
      n >= 0 && this._deviceTokens.splice(n, 1);
    }
  }, n.prototype.unsetDeviceTokens = function (e) {
    this._deviceTokenCacheEnabled && (this._deviceTokens = e ? this._deviceTokens.filter(function (t) {
      return t.type !== e;
    }) : []);
  }, n.prototype.setDeviceTokenDeletedAt = function (e) {
    e > 0 && (this._deviceTokenLastDeletedAt = e);
  }, n.prototype.saveDeviceToken = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this._deviceTokenCacheEnabled ? [4, this._cacheContext.preference.set(ui$1, {
              tokens: this._deviceTokens,
              lastDeletedAt: this._deviceTokenLastDeletedAt
            })] : [3, 2];

          case 1:
            e.sent(), e.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this.currentUser = null, this.auth.clear(), this.close(), yi$1.delete(this), this._deviceTokens = [], this._deviceTokenLastDeletedAt = 0, [4, this.saveDeviceToken()];

          case 1:
            return e.sent(), [2];
        }
      });
    });
  }, n;
}(Q),
    Ni$1 = function () {
  function e() {
    this.type = ti$1.NONE, this.name = "none";
  }

  return e.prototype.run = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return [2];
      });
    });
  }, e.prototype.onConnect = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return [2];
      });
    });
  }, e.prototype.onReconnect = function (e, t) {
    return t.resetReconnectCount, i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return [2];
      });
    });
  }, e.prototype.onDisconnect = function (e, t) {
    return t.error, t.autoReconnect, i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return [2];
      });
    });
  }, e.prototype.onDisconnectWebSocket = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return [2];
      });
    });
  }, e.prototype.onLogout = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return [2];
      });
    });
  }, e;
}(),
    Ti$1 = function (e) {
  function n() {
    var t = null !== e && e.apply(this, arguments) || this;
    return t.type = ti$1.LOGOUT, t.name = "logout", t;
  }

  return t$1(n, e), n.prototype.run = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r = this;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return t = Date.now(), n = e.sdkState.userId, [4, e.logout()];

          case 1:
            return s.sent(), [4, e.changeState(new Ii$1(), t)];

          case 2:
            return s.sent(), bi$1(function () {
              return i$1(r, void 0, void 0, function () {
                return o$1(this, function (t) {
                  return e.connectionHandlers.forEach(function (e) {
                    e.onDisconnected && e.onDisconnected(n);
                  }), [2];
                });
              });
            }), [2];
        }
      });
    });
  }, n;
}(Ni$1),
    Si$1 = function (e) {
  function n() {
    var t = e.call(this) || this;
    return t.type = ti$1.EXTERNAL_DISCONNECTED, t.name = "externaldisconnected", t;
  }

  return t$1(n, e), n.prototype.run = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, e.disconnect()];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, n.prototype.onConnect = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = Date.now(), [4, e.disconnect()];

          case 1:
            return r.sent(), [4, e.changeState(new Oi$1({
              authToken: t
            }), n)];

          case 2:
            return r.sent(), [2];
        }
      });
    });
  }, n.prototype.onReconnect = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), [4, e.changeState(new Ci$1(), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.onLogout = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), [4, e.changeState(new Ti$1(), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n;
}(Ni$1),
    Ai$1 = function (e) {
  function n(t) {
    var n = t.autoReconnect,
        r = e.call(this) || this;
    return r.type = ti$1.INTERNAL_DISCONNECTED, r.name = "internaldisconnected", r._autoReconnect = !1, r._autoReconnect = n, r;
  }

  return t$1(n, e), n.prototype.run = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), [4, e.disconnect()];

          case 1:
            return n.sent(), this._autoReconnect ? [4, e.changeState(new Ci$1(), t)] : [3, 3];

          case 2:
            n.sent(), n.label = 3;

          case 3:
            return [2];
        }
      });
    });
  }, n.prototype.onConnect = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = Date.now(), [4, e.disconnect()];

          case 1:
            return r.sent(), [4, e.changeState(new Oi$1({
              authToken: t
            }), n)];

          case 2:
            return r.sent(), [2];
        }
      });
    });
  }, n.prototype.onReconnect = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), [4, e.changeState(new Ci$1(), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.onDisconnectWebSocket = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), [4, e.changeState(new Si$1(), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.onLogout = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), [4, e.changeState(new Ti$1(), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n;
}(Ni$1),
    Ci$1 = function (e) {
  function n() {
    var t = null !== e && e.apply(this, arguments) || this;
    return t.type = ti$1.RECONNECTING, t.name = "reconnecting", t._callbacks = [], t;
  }

  return t$1(n, e), n.prototype._halt = function (e) {
    this._haltConnect && (this._haltConnect(e), this._haltConnect = void 0);
  }, n.prototype._flushCallbacks = function (e) {
    this._haltConnect = void 0, this._resetConnect = void 0, this._callbacks.forEach(function (t) {
      return t(e);
    });
  }, n.prototype.run = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          s,
          a,
          c,
          l = this;
      return o$1(this, function (h) {
        switch (h.label) {
          case 0:
            t = Date.now(), n = new oi$1(), this._callbacks.push(function (e) {
              return e ? n.reject(e) : n.resolve();
            }), bi$1(function () {
              return i$1(l, void 0, void 0, function () {
                return o$1(this, function (t) {
                  return e.connectionHandlers.forEach(function (e) {
                    e.onReconnectStarted && e.onReconnectStarted();
                  }), [2];
                });
              });
            }), h.label = 1;

          case 1:
            return h.trys.push([1, 4,, 9]), r = e.sdkState.websocket, s = r.reconnectMaxRetry, a = r.reconnectRetryStrategy, [4, vi$1(function (t, n) {
              return i$1(l, void 0, void 0, function () {
                var r;
                return o$1(this, function (i) {
                  switch (i.label) {
                    case 0:
                      this._haltConnect = t, this._resetConnect = n, i.label = 1;

                    case 1:
                      return i.trys.push([1, 3,, 4]), [4, e.connect()];

                    case 2:
                      return i.sent(), [3, 4];

                    case 3:
                      if (r = i.sent(), e.clearLoginTimer(), r instanceof v$2 && r.code === u$1.CONNECTION_CANCELED) return t(r), [2];
                      throw r;

                    case 4:
                      return [2];
                  }
                });
              });
            }, s, a)];

          case 2:
            return h.sent(), [4, e.changeState(new ki$1(), t)];

          case 3:
            return h.sent(), bi$1(function () {
              return i$1(l, void 0, void 0, function () {
                return o$1(this, function (t) {
                  return this._flushCallbacks(), e.connectionHandlers.forEach(function (e) {
                    e.onReconnectSucceeded && e.onReconnectSucceeded();
                  }), [2];
                });
              });
            }), [3, 9];

          case 4:
            return c = h.sent(), g$2(c) ? [3, 7] : c instanceof v$2 ? c.code === u$1.CONNECTION_CANCELED ? [3, 6] : [4, e.changeState(new Ai$1({
              autoReconnect: !1
            }), t)] : [3, 6];

          case 5:
            h.sent(), h.label = 6;

          case 6:
            return bi$1(function () {
              return i$1(l, void 0, void 0, function () {
                return o$1(this, function (t) {
                  return this._flushCallbacks(c), e.connectionHandlers.forEach(function (e) {
                    e.onReconnectFailed && e.onReconnectFailed();
                  }), [2];
                });
              });
            }), [3, 8];

          case 7:
            throw c;

          case 8:
            return [3, 9];

          case 9:
            return [2, n.promise];
        }
      });
    });
  }, n.prototype.onConnect = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        return n = new oi$1(), this._halt(v$2.connectionCanceled), e.cancelConnectForRetry(), this._callbacks.push(function () {
          var r = Date.now();
          e.changeState(new Oi$1({
            authToken: t
          }), r).then(function () {
            n.resolve();
          }).catch(function (e) {
            n.reject(e);
          });
        }), [2, n.promise];
      });
    });
  }, n.prototype.onReconnect = function (e, t) {
    var n = t.resetReconnectCount,
        r = void 0 !== n && n;
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        return e = new oi$1(), this._resetConnect && r && this._resetConnect(), this._callbacks.push(function (t) {
          return t ? e.reject(t) : e.resolve();
        }), [2, e.promise];
      });
    });
  }, n.prototype.onDisconnect = function (e, t) {
    t.error;
    var n = t.autoReconnect,
        r = void 0 === n || n;
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), this._halt(v$2.connectionCanceled), [4, e.changeState(new Ai$1({
              autoReconnect: r
            }), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.onDisconnectWebSocket = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), this._halt(v$2.connectionCanceled), [4, e.changeState(new Si$1(), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.onLogout = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), this._halt(v$2.connectionCanceled), [4, e.changeState(new Ti$1(), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n;
}(Ni$1),
    ki$1 = function (e) {
  function n() {
    var t = null !== e && e.apply(this, arguments) || this;
    return t.type = ti$1.CONNECTED, t.name = "connected", t;
  }

  return t$1(n, e), n.prototype.onReconnect = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), [4, e.disconnect()];

          case 1:
            return n.sent(), [4, e.changeState(new Ci$1(), t)];

          case 2:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.onDisconnect = function (e, t) {
    var n = t.autoReconnect;
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return t = Date.now(), [4, e.changeState(new Ai$1({
              autoReconnect: n
            }), t)];

          case 1:
            return r.sent(), [2];
        }
      });
    });
  }, n.prototype.onDisconnectWebSocket = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), [4, e.changeState(new Si$1(), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.onLogout = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), [4, e.changeState(new Ti$1(), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n;
}(Ni$1),
    Oi$1 = function (e) {
  function n(t) {
    var n = t.authToken,
        r = e.call(this) || this;
    return r.type = ti$1.CONNECTING, r.name = "connecting", r._authToken = "", r._callbacks = [], r._authToken = n, r;
  }

  return t$1(n, e), n.prototype._halt = function (e) {
    this._haltConnect && (this._haltConnect(e), this._haltConnect = void 0);
  }, n.prototype._flushCallbacks = function (e) {
    this._haltConnect = void 0, this._callbacks.forEach(function (t) {
      return t(e);
    });
  }, n.prototype.run = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          s = this;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            t = Date.now(), n = new oi$1(), this._callbacks.push(function (e) {
              return e ? n.reject(e) : n.resolve();
            }), a.label = 1;

          case 1:
            return a.trys.push([1, 4,, 10]), [4, vi$1(function (t) {
              return i$1(s, void 0, void 0, function () {
                var n;
                return o$1(this, function (r) {
                  switch (r.label) {
                    case 0:
                      this._haltConnect = t, r.label = 1;

                    case 1:
                      return r.trys.push([1, 3,, 4]), [4, e.connect(this._authToken)];

                    case 2:
                      return r.sent(), [3, 4];

                    case 3:
                      if (n = r.sent(), e.clearLoginTimer(), n instanceof v$2 && n.code === u$1.CONNECTION_CANCELED) return t(n), [2];
                      throw n;

                    case 4:
                      return [2];
                  }
                });
              });
            }, e.sdkState.websocket.connectMaxRetry)];

          case 2:
            return a.sent(), [4, e.changeState(new ki$1(), t)];

          case 3:
            return a.sent(), bi$1(function () {
              return i$1(s, void 0, void 0, function () {
                return o$1(this, function (t) {
                  return this._flushCallbacks(), e.connectionHandlers.forEach(function (t) {
                    t.onConnected && t.onConnected(e.sdkState.userId);
                  }), [2];
                });
              });
            }), [3, 10];

          case 4:
            return r = a.sent(), g$2(r) ? [3, 8] : [4, e.disconnect()];

          case 5:
            return a.sent(), r instanceof v$2 ? r.code === u$1.CONNECTION_CANCELED ? [3, 7] : [4, e.changeState(new Ii$1(), t)] : [3, 7];

          case 6:
            a.sent(), a.label = 7;

          case 7:
            return bi$1(function () {
              return i$1(s, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._flushCallbacks(r), [2];
                });
              });
            }), [3, 9];

          case 8:
            throw r;

          case 9:
            return [3, 10];

          case 10:
            return [2, n.promise];
        }
      });
    });
  }, n.prototype.onConnect = function (e) {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        return e = new oi$1(), this._callbacks.push(function (t) {
          return t ? e.reject(t) : e.resolve();
        }), [2, e.promise];
      });
    });
  }, n.prototype.onDisconnect = function (e, t) {
    var n = t.error,
        r = void 0 === n ? null : n,
        s = t.autoReconnect,
        a = void 0 !== s && s;
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), this._halt(null != r ? r : v$2.connectionCanceled), e.hasSession ? [4, e.changeState(new Ai$1({
              autoReconnect: a
            }), t)] : [3, 2];

          case 1:
            return n.sent(), [3, 4];

          case 2:
            return [4, e.changeState(new Ti$1(), t)];

          case 3:
            n.sent(), n.label = 4;

          case 4:
            return [2];
        }
      });
    });
  }, n.prototype.onDisconnectWebSocket = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), this._halt(v$2.connectionCanceled), e.hasSession ? [4, e.changeState(new Si$1(), t)] : [3, 2];

          case 1:
            return n.sent(), [3, 4];

          case 2:
            return [4, e.changeState(new Ti$1(), t)];

          case 3:
            n.sent(), n.label = 4;

          case 4:
            return [2];
        }
      });
    });
  }, n.prototype.onLogout = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = Date.now(), this._halt(v$2.connectionCanceled), [4, e.changeState(new Ti$1(), t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n;
}(Ni$1),
    Ii$1 = function (e) {
  function n() {
    var t = null !== e && e.apply(this, arguments) || this;
    return t.type = ti$1.INITIALIZED, t.name = "initialized", t;
  }

  return t$1(n, e), n.prototype.onConnect = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = Date.now(), [4, e.changeState(new Oi$1({
              authToken: t
            }), n)];

          case 1:
            return r.sent(), [2];
        }
      });
    });
  }, n;
}(Ni$1),
    Ri$1 = function (e) {
  function n() {
    return e.call(this, {
      code: "PING",
      payload: {
        id: Date.now(),
        active: 1
      },
      ackRequired: !1
    }) || this;
  }

  return t$1(n, e), n;
}(ri$1),
    Di$1 = function () {
  function e(e) {
    var t = e.pingDelegate,
        n = e.sdkState,
        r = e.logger;
    this.pingDelegate = t, this.sdkState = n, this._logger = r;
  }

  return Object.defineProperty(e.prototype, "isWaiting", {
    get: function () {
      return !!this._pingTimeoutTimer;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.ping = function () {
    var e,
        t = this;
    if (!this.sdkState.websocket) throw v$2.connectionRequired;
    var n = new Ri$1();

    try {
      var r = null !== (e = this.sdkState.websocket.pongTimeout) && void 0 !== e ? e : 5e3;
      this._pingTimeoutTimer = setTimeout(function () {
        t._logger.debug("pinger.ping() timeout"), t.pingDelegate.error();
      }, r), this.pingDelegate.send(n), this._logger.debug("pinger.ping()");
    } catch (e) {
      this._logger.debug("pinger.ping() error", e), this._pingTimeoutTimer && (clearTimeout(this._pingTimeoutTimer), this._pingTimeoutTimer = void 0), this.pingDelegate.error();
    }

    return n;
  }, e.prototype.pong = function () {
    this._logger.debug("pinger.pong()"), this._pingTimeoutTimer && (clearTimeout(this._pingTimeoutTimer), this._pingTimeoutTimer = void 0);
  }, e.prototype.refreshTimer = function () {
    var e,
        t = this;
    if (!this.sdkState.websocket) throw v$2.connectionRequired;

    this._logger.debug("pinger.refreshTimer()");

    var n = null !== (e = this.sdkState.websocket.pingInterval) && void 0 !== e ? e : 15e3;
    this.stop(), this._pingTimer = setInterval(function () {
      t.ping();
    }, n);
  }, e.prototype.start = function () {
    this._logger.debug("pinger.start()"), this.refreshTimer(), this.ping();
  }, e.prototype.stop = function () {
    this._logger.debug("pinger.stop()"), this._pingTimer && (clearInterval(this._pingTimer), this._pingTimer = void 0), this._pingTimeoutTimer && (clearTimeout(this._pingTimeoutTimer), this._pingTimeoutTimer = void 0);
  }, e;
}(),
    Li$1 = function () {
  function e(e) {
    var t, n, r, i;
    this.isEnabled = null !== (t = e.enabled) && void 0 !== t && t, this.feedChannels = null !== (n = e.feed_channels) && void 0 !== n ? n : {}, this.templateListToken = null !== (r = e.template_list_token) && void 0 !== r ? r : null, this.settingsUpdatedAt = null !== (i = e.settings_updated_at) && void 0 !== i ? i : 0;
  }

  return e.payloadify = function (e) {
    return J($({
      enabled: e.isEnabled,
      feed_channels: e.feedChannels,
      template_list_token: e.templateListToken,
      settings_updated_at: e.settingsUpdatedAt
    }));
  }, e;
}(),
    xi$1 = function (e) {
  return "sendbird@".concat(e, "/changelog_include_chat_notifications");
},
    Ui$1 = function () {
  function e(e) {
    var t;
    this.lastUpdatedAt = null !== (t = e.last_updated_at) && void 0 !== t ? t : 0;
  }

  return e.payloadify = function (e) {
    return J($({
      last_updated_at: e.lastUpdatedAt
    }));
  }, e;
}(),
    Mi$1 = 1048576,
    Pi$1 = 5,
    zi$1 = function () {
  function e(e) {
    var t, n, r, i, o;
    void 0 === e && (e = {}), this.emojiHash = e.emoji_hash || "", this.uploadSizeLimit = e.file_upload_size_limit ? e.file_upload_size_limit * Mi$1 : Number.MAX_SAFE_INTEGER, this.useReaction = !!e.use_reaction, this.applicationAttributes = null !== (t = e.application_attributes) && void 0 !== t ? t : [], this.premiumFeatureList = null !== (n = e.premium_feature_list) && void 0 !== n ? n : [], this.deviceTokenCache = this.applicationAttributes.includes("sdk_device_token_cache"), this.enabledChannelMemberShipHistory = this.applicationAttributes.includes("channel_membership_history"), this.multipleFilesMessageFileCountLimit = null !== (r = e.multiple_file_send_max_size) && void 0 !== r ? r : 5, this.allowSdkStatsUpload = null === (i = e.allow_sdk_log_ingestion) || void 0 === i || i, this.uikitConfigInfo = new Ui$1(null !== (o = e.uikit_config) && void 0 !== o ? o : {}), this.notificationInfo = e.notifications ? new Li$1(e.notifications) : null;
  }

  return e.payloadify = function (e) {
    return J($({
      emoji_hash: e.emojiHash,
      file_upload_size_limit: e.uploadSizeLimit / Mi$1,
      application_attributes: e.applicationAttributes,
      premium_feature_list: e.premiumFeatureList,
      use_reaction: e.useReaction,
      allow_sdk_log_ingestion: e.allowSdkStatsUpload,
      uikit_config: e.uikitConfigInfo ? Ui$1.payloadify(e.uikitConfigInfo) : null,
      notifications: e.notificationInfo ? Li$1.payloadify(e.notificationInfo) : null
    }));
  }, e;
}(),
    Fi$1 = function () {
  function e(e) {
    this._iid = "", this._iid = e;
  }

  return e.payloadify = function (e) {
    return {};
  }, e;
}(),
    Hi$1 = function (e) {
  function n(t) {
    var n = t.userId,
        r = t.metadata,
        i = e.call(this) || this;
    return i.method = ee.POST, i.path = "".concat(ne, "/").concat(n, "/metadata"), i.params = {
      metadata: r
    }, i;
  }

  return t$1(n, e), n;
}(Ne$2),
    Vi$1 = function (e) {
  function n(t, n) {
    var r = e.call(this, t, n) || this;
    return r.metaData = n, r;
  }

  return t$1(n, e), n;
}(Te$2),
    Gi$1 = function (e) {
  function n(t) {
    var n = t.userId,
        r = t.metadata,
        i = t.upsert,
        o = e.call(this) || this;
    return o.method = ee.PUT, o.path = "".concat(ne, "/").concat(n, "/metadata"), o.params = {
      metadata: r,
      upsert: i
    }, o;
  }

  return t$1(n, e), n;
}(Ne$2),
    qi$1 = function (e) {
  function n(t, n) {
    var r = e.call(this, t, n) || this;
    return r.metadata = n, r;
  }

  return t$1(n, e), n;
}(Te$2),
    ji$1 = function (e) {
  function n(t) {
    var n = t.userId,
        r = t.metadataKey,
        i = e.call(this) || this;
    return i.method = ee.DELETE, i.path = "".concat(ne, "/").concat(n, "/metadata/").concat(r), i;
  }

  return t$1(n, e), n;
}(Ne$2);

!function (e) {
  function n() {
    return null !== e && e.apply(this, arguments) || this;
  }

  t$1(n, e);
}(Te$2);

var Ki$1 = function (e) {
  function n(t) {
    var n = t.userId,
        r = e.call(this) || this;
    return r.method = ee.DELETE, r.path = "".concat(ne, "/").concat(n, "/metadata"), r;
  }

  return t$1(n, e), n;
}(Ne$2);

!function (e) {
  function n() {
    return null !== e && e.apply(this, arguments) || this;
  }

  t$1(n, e);
}(Te$2);

var Bi$1,
    Zi$1 = function (e, t) {
  var n = JSON.parse(JSON.stringify(e));
  return n._iid && delete n._iid, t && t(n), n;
},
    Wi$1 = function (e, t) {
  var n = JSON.parse(JSON.stringify(e));
  return t && t(n), n;
},
    Qi$1 = function (e) {
  return {
    do: function (t) {
      e || t();
    },
    throw: function (t) {
      if (!e) throw t;
    }
  };
};

!function (e) {
  e.ONLINE = "online", e.OFFLINE = "offline", e.NON_AVAILABLE = "nonavailable";
}(Bi$1 || (Bi$1 = {}));

var Yi$1,
    Xi$1 = function (e) {
  function r(t, n) {
    var r,
        i,
        o,
        s,
        u,
        l,
        h,
        d,
        _,
        f,
        p,
        E,
        g = this;

    return (g = e.call(this, t) || this).userId = null !== (i = null !== (r = n.guest_id) && void 0 !== r ? r : n.user_id) && void 0 !== i ? i : "", g.nickname = null !== (s = null !== (o = n.nickname) && void 0 !== o ? o : n.name) && void 0 !== s ? s : "", g.plainProfileUrl = null !== (l = null !== (u = n.profile_url) && void 0 !== u ? u : n.image) && void 0 !== l ? l : "", g.requireAuth = null !== (h = n.require_auth_for_profile_image) && void 0 !== h && h, g.metaData = null !== (d = n.metadata) && void 0 !== d ? d : {}, g.connectionStatus = Bi$1.NON_AVAILABLE, N$1(Bi$1, n.is_online) ? g.connectionStatus = n.is_online : w$1("boolean", n.is_online) && (g.connectionStatus = n.is_online ? Bi$1.ONLINE : Bi$1.OFFLINE), g.isActive = null === (_ = n.is_active) || void 0 === _ || _, g.lastSeenAt = null !== (f = n.last_seen_at) && void 0 !== f ? f : null, g.preferredLanguages = n.preferred_languages ? c$1([], a$1(n.preferred_languages), !1) : null, g.friendDiscoveryKey = null !== (p = n.friend_discovery_key) && void 0 !== p ? p : null, g.friendName = null !== (E = n.friend_name) && void 0 !== E ? E : null, g;
  }

  return t$1(r, e), r.payloadify = function (t) {
    return J($(n$1(n$1({}, e.payloadify.call(this, t)), {
      user_id: t.userId,
      nickname: t.nickname,
      profile_url: t.plainProfileUrl,
      require_auth_for_profile_image: t.requireAuth,
      metadata: t.metaData,
      is_online: t.connectionStatus,
      is_active: t.isActive,
      last_seen_at: t.lastSeenAt,
      preferred_languages: t.preferredLanguages,
      friend_discovery_key: t.friendDiscoveryKey,
      friend_name: t.friendName
    })));
  }, Object.defineProperty(r.prototype, "profileUrl", {
    get: function () {
      var e = _o.of(this._iid).sessionManager;

      return this.requireAuth ? "".concat(this.plainProfileUrl, "?auth=").concat(e.ekey) : this.plainProfileUrl;
    },
    enumerable: !1,
    configurable: !0
  }), r.prototype.serialize = function () {
    return Zi$1(this);
  }, r.prototype._isValidMetaData = function (e) {
    return !Array.isArray(e) && Object.keys(e).length > 0 && Object.keys(e).map(function (t) {
      return e[t];
    }).every(function (e) {
      return w$1("string", e);
    });
  }, r.prototype._applyMetaData = function (e, t) {
    var n = this;
    void 0 === t && (t = !1), Object.keys(e).forEach(function (r) {
      t ? delete n.metaData[r] : n.metaData[r] = e[r];
    });
  }, r.prototype.createMetaData = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(this._isValidMetaData(e)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.sdkState, r = t.requestQueue, i = new Hi$1({
              userId: n.userId,
              metadata: e
            }), [4, r.send(i)];

          case 1:
            return s = o.sent(), a = s.as(Vi$1).metaData, this._applyMetaData(a), [2, this.metaData];
        }
      });
    });
  }, r.prototype.updateMetaData = function (e, t) {
    return void 0 === t && (t = !1), i$1(this, void 0, void 0, function () {
      var n, r, i, s, a, c;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(this._isValidMetaData(e)).throw(v$2.invalidParameters), n = _o.of(this._iid), r = n.sdkState, i = n.requestQueue, s = new Gi$1({
              userId: r.userId,
              metadata: e,
              upsert: t
            }), [4, i.send(s)];

          case 1:
            return a = o.sent(), c = a.as(qi$1).metadata, this._applyMetaData(c), [2, this.metaData];
        }
      });
    });
  }, r.prototype.deleteMetaData = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.sdkState, r = t.requestQueue, i = new ji$1({
              userId: n.userId,
              metadataKey: e
            }), [4, r.send(i)];

          case 1:
            return o.sent(), this._applyMetaData(((s = {})[e] = !0, s), !0), [2, this.metaData];
        }
      });
    });
  }, r.prototype.deleteAllMetaData = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, r = new Ki$1({
              userId: t.userId
            }), [4, n.send(r)];

          case 1:
            return i.sent(), this.metaData = {}, [2];
        }
      });
    });
  }, r;
}(Fi$1),
    Ji$1 = function (e) {
  function n(t) {
    var n = t.userProfile,
        r = e.call(this) || this;
    return r.userProfile = n, r;
  }

  return t$1(n, e), n;
}(X),
    $i$1 = function () {
  function e(e, t) {
    var n, r, i, o, s, a, c, u, l, h, d, _, f, p;

    this._iid = e, this.appInfo = new zi$1(t), this.user = new Xi$1(e, t), this.connectedAt = null !== (n = t.login_ts) && void 0 !== n ? n : 0, this.firstConnectedAt = 0, this.pingInterval = null !== (r = t.ping_interval) && void 0 !== r ? r : 15e3, this.pongTimeout = null !== (i = t.pong_timeout) && void 0 !== i ? i : 5e3, this.reconnectInterval = null !== (s = null === (o = t.reconnect) || void 0 === o ? void 0 : o.interval) && void 0 !== s ? s : 3e3, this.reconnectMaxInterval = null !== (c = null === (a = t.reconnect) || void 0 === a ? void 0 : a.max_interval) && void 0 !== c ? c : 6e4, this.reconnectRetryCount = null !== (l = null === (u = t.reconnect) || void 0 === u ? void 0 : u.retry_cnt) && void 0 !== l ? l : 5, this.reconnectIntervalMultiple = null !== (d = null === (h = t.reconnect) || void 0 === h ? void 0 : h.mul) && void 0 !== d ? d : 2, this.maxUnreadCountOnSuperGroup = null !== (_ = t.max_unread_cnt_on_super_group) && void 0 !== _ ? _ : 100, this.profileImageEncryption = !!t.profile_image_encryption, this.concurrentCallLimit = null !== (f = t.concurrent_call_limit) && void 0 !== f ? f : 5, this.backOffDelay = null !== (p = t.back_off_delay) && void 0 !== p ? p : 100;
  }

  return e.payloadify = function (e) {
    return J($(n$1(n$1(n$1({}, Xi$1.payloadify(e.user)), zi$1.payloadify(e.appInfo)), {
      login_ts: e.connectedAt,
      ping_interval: e.pingInterval,
      pong_timeout: e.pongTimeout,
      reconnect: {
        interval: e.reconnectInterval,
        max_interval: e.reconnectMaxInterval,
        retry_cnt: e.reconnectRetryCount,
        mul: e.reconnectIntervalMultiple
      },
      max_unread_cnt_on_super_group: e.maxUnreadCountOnSuperGroup,
      profile_image_encryption: e.profileImageEncryption,
      concurrent_call_limit: e.concurrentCallLimit,
      back_off_delay: e.backOffDelay
    })));
  }, e.prototype.apply = function () {
    var e = this.reconnectInterval,
        t = this.reconnectMaxInterval,
        n = this.reconnectIntervalMultiple,
        r = _o.of(this._iid);

    r.sdkState.websocket && (r.sdkState.websocket.pingInterval = 1e3 * this.pingInterval, r.sdkState.websocket.pongTimeout = 1e3 * this.pongTimeout, r.sdkState.websocket.reconnectMaxRetry = this.reconnectRetryCount, r.sdkState.websocket.reconnectRetryStrategy = {
      calcTimeout: function (r) {
        return r > 0 ? 1e3 * Math.min(e * Math.pow(n, r - 1), t) : 10;
      }
    }), r.appInfo = this.appInfo, r.sessionManager.currentUser = this.user, r.connectedAt = this.connectedAt, this.firstConnectedAt || (r.firstConnectedAt = this.connectedAt), r.maxSuperGroupChannelUnreadCount = this.maxUnreadCountOnSuperGroup, r.concurrentCallLimit = this.concurrentCallLimit, r.backOffDelay = this.backOffDelay, r.dispatcher.dispatch(new Ji$1({
      userProfile: this
    }));
  }, e;
}(),
    eo = function (e) {
  function r(t, n, r) {
    var i,
        o,
        s,
        a = this;
    return (a = e.call(this, t, n, r) || this).error = null, a.userProfile = new $i$1(t, r), a.deviceTokenLastDeletedAt = null !== (i = r.device_token_last_deleted_at) && void 0 !== i ? i : 0, a.key = null !== (o = r.key) && void 0 !== o ? o : "", a.ekey = null !== (s = r.ekey) && void 0 !== s ? s : "", a.error = r.error ? new v$2(r) : null, a;
  }

  return t$1(r, e), r.asError = function (e) {
    return new r("", "LOGI", n$1({
      user_id: "",
      error: !0
    }, e));
  }, r.prototype.applyTo = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.error ? [3, 4] : (t = _o.of(e)) ? [4, t.sessionManager.login(this)] : [3, 2];

          case 1:
            return n.sent(), this.userProfile.apply(), [3, 3];

          case 2:
            throw v$2.lostInstance;

          case 3:
            return [3, 5];

          case 4:
            throw this.error;

          case 5:
            return [2];
        }
      });
    });
  }, r;
}(Pe$3),
    to = function (e) {
  function r(t) {
    var r = t.request,
        i = void 0 === r || r,
        o = t.features,
        s = void 0 === o ? {} : o,
        a = t.options,
        c = void 0 === a ? {} : a,
        u = e.call(this) || this;
    return u.request = i, u.features = n$1({
      localCache: !0
    }, s), u.options = n$1({
      ingestion: !0
    }, c), u;
  }

  return t$1(r, e), r;
}(X),
    no = function (e) {
  function n(t, n) {
    var r,
        i = n.sdkState,
        o = n.cacheContext,
        s = n.connectionHandlers,
        a = n.sessionManager,
        c = n.websocketClient,
        u = n.dispatcher,
        l = n.logger,
        h = n.entryState,
        d = void 0 === h ? new Ii$1() : h,
        _ = this;

    return (_ = e.call(this) || this)._stateUpdatedAt = 0, _._connectingAt = 0, _._connectionRequestQueue = [], _._iid = t, _.sdkState = i, _.cacheContext = o, _.connectionHandlers = s, _._sessionManager = a, _._websocketClient = c, _._dispatcher = u, _._logger = l, _._currentState = d, (null === (r = _.sdkState.websocket) || void 0 === r ? void 0 : r.pingerDisabled) || (_._pinger = new Di$1({
      pingDelegate: {
        send: function (e) {
          return _._websocketClient.send(e);
        },
        error: function (e) {
          return _._websocketClient.error(e);
        }
      },
      sdkState: _.sdkState,
      logger: l
    })), _._websocketClient.on("open", function () {
      _._tryResolveConnectionRequest();
    }).on("message", function (e) {
      if ("LOGI" === e.code) _.clearLoginTimer(), _._dispatcher.dispatch(e.as(eo));
    }).on("ping-refresh", function () {
      var e;
      return null === (e = _._pinger) || void 0 === e ? void 0 : e.refreshTimer();
    }).on("pong", function () {
      var e;
      return null === (e = _._pinger) || void 0 === e ? void 0 : e.pong();
    }).on("error", function () {
      var e;
      return null === (e = _._pinger) || void 0 === e ? void 0 : e.stop();
    }).on("close", function () {
      _._logiProcessingTimer = setTimeout(function () {
        _._logiProcessingTimer = void 0, _._unresolvedLogi || _._rejectConnectionRequest(v$2.networkError);
      }, 500);
    }), _._dispatcher.on(function (e) {
      e instanceof eo && (_._unresolvedLogi = e, _._tryResolveConnectionRequest());
    }), _;
  }

  return t$1(n, e), Object.defineProperty(n.prototype, "currentState", {
    get: function () {
      return this._currentState;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "hasSession", {
    get: function () {
      return this._sessionManager.auth.hasSession;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype.changeState = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t >= this._stateUpdatedAt ? (this._currentState = e, this._stateUpdatedAt = t, this._dispatcher.dispatch(new ai$1({
              stateType: e.type
            })), this._logger.debug("connection state changes to ".concat(e.name)), [4, this._currentState.run(this)]) : [3, 2];

          case 1:
            return n.sent(), [2, !0];

          case 2:
            return [2, !1];
        }
      });
    });
  }, n.prototype._tryResolveConnectionRequest = function () {
    var e;
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return t = this._unresolvedLogi, this._websocketClient.isOpen && t ? (this._unresolvedLogi = void 0, t.error ? [3, 2] : [4, t.applyTo(this._iid)]) : [3, 3];

          case 1:
            return r.sent(), n = t.userProfile, this._enableStatLog({
              request: n.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish"),
              features: {
                localCache: n.appInfo.applicationAttributes.includes("allow_sdk_feature_local_cache_log_publish")
              },
              options: {
                ingestion: n.appInfo.allowSdkStatsUpload
              }
            }), this._statLogConnection(), null === (e = this._pinger) || void 0 === e || e.start(), this._connectionRequestQueue.forEach(function (e) {
              return e.resolve();
            }), this._connectionRequestQueue = [], this.sdkState.appState = "foreground", [3, 3];

          case 2:
            this._sessionManager.auth.authToken = void 0, (t.error.isSessionKeyExpiredError || t.error.isSessionTokenExpiredError) && this._dispatcher.dispatch(new Ae$1({
              reason: t.error.code
            })), this._rejectConnectionRequest(t.error), r.label = 3;

          case 3:
            return [2];
        }
      });
    });
  }, n.prototype._rejectConnectionRequest = function (e) {
    var t;

    if (null === (t = this._pinger) || void 0 === t || t.stop(), this.clearLoginTimer(), this._connectionRequestQueue.length > 0) {
      var n = this._connectionRequestQueue;
      this._connectionRequestQueue = [], n.forEach(function (t) {
        return t.reject(e);
      }), this._statLogConnection(e);
    }
  }, n.prototype._url = function (e) {
    var t, n;
    void 0 === e && (e = "");

    var r = this.sdkState,
        i = r.appId,
        o = r.appVersion,
        s = r.userId,
        a = r.extensions,
        c = r.sendbirdRuntimeEnvironment,
        u = this.cacheContext.localCacheEnabled,
        l = this._sessionManager.auth,
        d = null === (t = this.sdkState.websocket) || void 0 === t ? void 0 : t.compression,
        _ = !!(null !== (n = this.sdkState.extensions) && void 0 !== n ? n : {}).sb_uikit,
        f = Ue$2.userAgentWithExtension(a);

    return "".concat(this.sdkState.websocket.host, "/?p=JS&pv=").concat(encodeURIComponent(h$1.OS_VERSION), "&sv=").concat(encodeURIComponent(h$1.SDK_VERSION), "&ai=").concat(i).concat(o ? "&av=".concat(o) : "").concat(l.hasSession ? "&key=".concat(encodeURIComponent(l.sessionKey)) : "&user_id=".concat(encodeURIComponent(s), "&access_token=").concat(encodeURIComponent(e)), "&pmce=").concat(d ? 1 : 0, "&active=1&device_token_types=").concat(encodeURIComponent(["gcm", "huawei", "apns"].join(",")), "&SB-User-Agent=").concat(f, "&SB-SDK-User-Agent=").concat(encodeURIComponent(Ue$2.sendbirdSdkUserAgentWithExtension(c)), "&Request-Sent-Timestamp=").concat(Date.now().toString(), "&include_extra_data=").concat(encodeURIComponent(String(["premium_feature_list", "file_upload_size_limit", "application_attributes", "emoji_hash", "multiple_file_send_max_size", "notifications"]))).concat(this._sessionManager.handler ? "&expiring_session=1" : "", "&use_local_cache=").concat(u ? 1 : 0, "&include_poll_details=1").concat(_ ? "&uikit_config=1" : "");
  }, n.prototype._enableStatLog = function (e) {
    var t = e.request,
        n = e.features,
        r = e.options,
        i = void 0 === r ? {} : r;

    this._dispatcher.dispatch(new to({
      request: t,
      features: n,
      options: i
    }));
  }, n.prototype._statLogConnection = function (e) {
    var t;

    this._dispatcher.dispatch(new Ce$2(new Re$2({
      type: we$2.WEBSOCKET_CONNECT,
      data: {
        host_url: null === (t = this.sdkState.websocket) || void 0 === t ? void 0 : t.host,
        success: !e,
        latency: Date.now() - this._connectingAt,
        error_code: null == e ? void 0 : e.code,
        error_description: null == e ? void 0 : e.message
      }
    })));
  }, n.prototype.connect = function (e) {
    var t;
    return void 0 === e && (e = ""), i$1(this, void 0, void 0, function () {
      var n,
          r,
          i = this;
      return o$1(this, function (o) {
        return this._logiProcessingTimer && (clearTimeout(this._logiProcessingTimer), this._logiProcessingTimer = void 0, this._rejectConnectionRequest(v$2.connectionCanceled)), n = this._url(e), r = new oi$1(), this._connectionRequestQueue.push(r), 1 === this._connectionRequestQueue.length && (this._connectingAt = Date.now(), this._loginTimer = setTimeout(function () {
          i._loginTimer = void 0, i._rejectConnectionRequest(v$2.loginTimeout);
        }, null === (t = this.sdkState.websocket) || void 0 === t ? void 0 : t.responseTimeout), e && (this._sessionManager.auth.authToken = e), this._websocketClient.connect(n)), [2, r.promise];
      });
    });
  }, n.prototype.cancelConnectForRetry = function () {
    this._dispatcher.dispatch(eo.asError(v$2.connectionRenew));
  }, n.prototype.disconnect = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, this._websocketClient.disconnect()];

          case 1:
            return e.sent(), [2];
        }
      });
    });
  }, n.prototype.logout = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this.sdkState.userId = void 0, this._unresolvedLogi = void 0, [4, this._sessionManager.clear()];

          case 1:
            return e.sent(), [4, this.disconnect()];

          case 2:
            return e.sent(), [2];
        }
      });
    });
  }, n.prototype.clearLoginTimer = function () {
    this._loginTimer && (clearTimeout(this._loginTimer), this._loginTimer = void 0);
  }, n;
}(Q),
    ro = function () {
  function e(e, t) {
    var n = t.sdkState,
        r = t.cacheContext,
        i = t.connectionHandlers,
        o = t.sessionManager,
        s = t.websocketClient,
        a = t.dispatcher,
        c = t.logger,
        u = t.disableWebSocketCloseEventHandling,
        l = void 0 !== u && u;
    this._disableWebSocketCloseEventHandling = !1, this._externalCalledWebSocketClose = !1, this._logger = c, this._disableWebSocketCloseEventHandling = l, this._context = new no(e, {
      sdkState: n,
      cacheContext: r,
      connectionHandlers: i,
      sessionManager: o,
      websocketClient: s,
      dispatcher: a,
      logger: c
    }), this._sdkState = n, this._sessionManager = o, this._websocketClient = s;
  }

  return e.prototype._registerEventDispatcher = function () {
    var e = this;
    this._disableWebSocketCloseEventHandling || (this._clearEventDispatcher(), this._sessionEventDispatcherContext = this._sessionManager.on("refresh-authtoken", function () {
      e.isConnected || (e._logger.debug("try reconnect by session token refresh"), e.reconnect());
    }).on("refresh", function () {
      e.isConnecting || e.isConnected || (e._logger.debug("try reconnect by session key refresh"), e.reconnect());
    }), this._websocketEventDispatcherContext = this._websocketClient.on("close", function () {
      "foreground" !== e._sdkState.appState || e._externalCalledWebSocketClose || e._sessionManager.isRefreshingAuthToken || (e._logger.debug("try reconnect by websocket connection closed"), e.reconnect());
    }));
  }, e.prototype._clearEventDispatcher = function () {
    this._sessionEventDispatcherContext && (this._sessionEventDispatcherContext.close(), this._sessionEventDispatcherContext = void 0), this._websocketEventDispatcherContext && (this._websocketEventDispatcherContext.close(), this._websocketEventDispatcherContext = void 0);
  }, Object.defineProperty(e.prototype, "isConnected", {
    get: function () {
      return this._context.currentState.type === ti$1.CONNECTED;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "isConnecting", {
    get: function () {
      var e = this._context.currentState;
      return e.type === ti$1.CONNECTING || e.type === ti$1.RECONNECTING;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "websocketClient", {
    get: function () {
      return this._websocketClient;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.connect = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = this._context.currentState, this._externalCalledWebSocketClose = !1, [4, t.onConnect(this._context, e)];

          case 1:
            return n.sent(), this._registerEventDispatcher(), [2];
        }
      });
    });
  }, e.prototype.reconnect = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e = this._context.currentState, this._externalCalledWebSocketClose = !1, [4, e.onReconnect(this._context, {})];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, e.prototype.resetAndReconnect = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e = this._context.currentState, this._externalCalledWebSocketClose = !1, [4, e.onReconnect(this._context, {
              resetReconnectCount: !0
            })];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, e.prototype.background = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e = this._context.currentState, this._externalCalledWebSocketClose = !0, [4, e.onDisconnect(this._context, {
              autoReconnect: !1
            })];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, e.prototype.disconnect = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._context.currentState.onDisconnect(this._context, {
              error: e,
              autoReconnect: !0
            })];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, e.prototype.disconnectWebSocket = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e = this._context.currentState, this._externalCalledWebSocketClose = !0, [4, e.onDisconnectWebSocket(this._context)];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, e.prototype.logout = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e = this._context.currentState, this._clearEventDispatcher(), [4, e.onLogout(this._context)];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, e;
}(),
    io = function (e) {
  function n(t) {
    var n,
        r,
        i,
        o,
        s = t.type,
        a = t.data,
        c = t.ts,
        u = void 0 === c ? Date.now() : c,
        l = e.call(this, {
      type: s,
      data: a,
      ts: u
    }) || this;
    return l.date = new Date(u), l.key = "".concat((n = l.date, r = n.getFullYear(), i = String(n.getMonth() + 1).padStart(2, "0"), o = String(n.getDate()).padStart(2, "0"), "".concat(r).concat(i).concat(o)), "_").concat(s), l;
  }

  return t$1(n, e), n;
}(Re$2),
    oo = function (e) {
  function n(t) {
    var n = t.deviceId,
        r = t.statLogs,
        i = e.call(this) || this;
    return i.method = ee.POST, i.path = "".concat(pe$1), i.params = {
      device_id: n,
      log_entries: r.map(function (e) {
        return Re$2.payloadify(e);
      })
    }, i;
  }

  return t$1(n, e), n;
}(Ne$2),
    so = function (e, t) {
  var n, r;

  if (null !== e && null !== t) {
    var i = Object.keys(e),
        o = Object.keys(t),
        u = c$1([], a$1(new Set(c$1(c$1([], a$1(i), !1), a$1(o), !1))), !1),
        l = {};

    try {
      for (var h = s$2(u), d = h.next(); !d.done; d = h.next()) {
        var _ = d.value,
            f = typeof e[_],
            p = typeof t[_];
        "undefined" === f ? l[_] = t[_] : "undefined" === p ? l[_] = e[_] : f !== p ? l[_] = t[_] : "object" === f && e[_] && t[_] ? l[_] = so(e[_], t[_]) : l[_] = t[_];
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        d && !d.done && (r = h.return) && r.call(h);
      } finally {
        if (n) throw n.error;
      }
    }

    return l;
  }

  return t;
};

!function (e) {
  e[e.PENDING = 0] = "PENDING", e[e.COLLECT_ONLY = 1] = "COLLECT_ONLY", e[e.ENABLED = 2] = "ENABLED", e[e.DISABLED = 3] = "DISABLED";
}(Yi$1 || (Yi$1 = {}));

var ao,
    co = function (e) {
  function n(t) {
    var n = t.cacheContext,
        r = t.requestQueue,
        i = t.dispatcher,
        o = t.baseLimit,
        s = void 0 === o ? 100 : o,
        a = t.maxLimit,
        c = void 0 === a ? 1e3 : a,
        u = t.minLimit,
        l = void 0 === u ? 10 : u,
        h = e.call(this) || this;
    return h.queue = [], h.enabledState = Yi$1.PENDING, h.isFlushing = !1, h.generation = 1, h.lastFlushedAt = 0, h._collectRequestStat = !0, h._collectFeatureLocalCacheStat = !0, h.deviceId = Z(), h.cacheContext = n, h.requestQueue = r, h.dispatcher = i, h.baseLimit = s, h.limit = s, h.maxLimit = c, h.minLimit = l, h;
  }

  return t$1(n, e), Object.defineProperty(n.prototype, "isEnabled", {
    get: function () {
      return this.enabledState === Yi$1.ENABLED;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype._arrangeStat = function () {
    var e = [];
    this._collectRequestStat && e.push.apply(e, c$1([], a$1(this.queue.filter(function (e) {
      return e.type === we$2.API_RESULT || e.type === we$2.WEBSOCKET_CONNECT;
    })), !1)), this._collectFeatureLocalCacheStat && e.push.apply(e, c$1([], a$1(this.queue.filter(function (e) {
      return e.type === we$2.FEATURE_LOCALCACHE;
    })), !1)), this.queue = e;
  }, n.prototype._save = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this.enabledState !== Yi$1.ENABLED ? [3, 2] : [4, this.cacheContext.preference.set(this.key, {
              deviceId: this.deviceId,
              statLogs: this.queue.map(function (e) {
                return Re$2.payloadify(e);
              }),
              generation: this.generation++,
              lastFlushedAt: this.lastFlushedAt
            })];

          case 1:
            e.sent(), this.dispatch("save", c$1([], a$1(this.queue), !1)), e.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype._flush = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            if (!this.isEnabled) return [3, 10];
            if (this.isFlushing) return [3, 10];
            this.isFlushing = !0, o.label = 1;

          case 1:
            return o.trys.push([1, 5, 9, 10]), this._arrangeStat(), e = this.queue.filter(function (e) {
              if (e instanceof io) {
                var t = new Date(),
                    n = a$1([e.date.getFullYear(), t.getFullYear()], 2),
                    r = n[0],
                    i = n[1];
                if (r < i) return !0;

                if (r === i) {
                  var o = a$1([e.date.getMonth(), t.getMonth()], 2),
                      s = o[0],
                      c = o[1];
                  if (s < c) return !0;

                  if (s === c) {
                    var u = a$1([e.date.getDate(), t.getDate()], 2);
                    return u[0] < u[1];
                  }
                }
              }

              return !1;
            }), t = this.queue.filter(function (e) {
              return !(e instanceof io);
            }), (n = c$1(c$1([], a$1(e), !1), a$1(t), !1).slice(0, Math.min(this.limit, this.maxLimit))).length > 0 ? (r = new oo({
              deviceId: this.deviceId,
              statLogs: n
            }), [4, this.requestQueue.send(r)]) : [3, 4];

          case 2:
            return o.sent(), this.dispatch("flush", n), this.queue = c$1(c$1([], a$1(e), !1), a$1(t), !1).slice(n.length), [4, this._save()];

          case 3:
            o.sent(), o.label = 4;

          case 4:
            return this.limit = this.baseLimit, this.lastFlushedAt = Date.now(), [3, 10];

          case 5:
            return (i = o.sent()) instanceof v$2 ? i.code !== u$1.STAT_LOG_NOT_ALLOWED ? [3, 7] : [4, this.clear()] : [3, 8];

          case 6:
            return o.sent(), this.enabledState = Yi$1.DISABLED, [3, 8];

          case 7:
            i.code === u$1.STAT_UPLOAD_NOT_ALLOWED && (this.enabledState = Yi$1.COLLECT_ONLY), o.label = 8;

          case 8:
            return this.limit = this.limit + 20, [3, 10];

          case 9:
            return this.isFlushing = !1, [7];

          case 10:
            return [2];
        }
      });
    });
  }, n.prototype.init = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r = this;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return this.key = e, [4, this.cacheContext.preference.get(this.key)];

          case 1:
            return (t = i.sent()) ? (this.deviceId = t.deviceId, this.queue = t.statLogs.map(function (e) {
              return new Re$2({
                type: e.stat_type,
                ts: e.ts,
                data: e.data
              });
            }), this.generation = t.generation, this.lastFlushedAt = t.lastFlushedAt, Date.now() - this.lastFlushedAt >= 108e5 && this.queue.length >= this.minLimit ? (n = Math.min(Math.floor(18e4 * Math.random()), 100), [4, Ei$1(n)]) : [3, 4]) : [3, 4];

          case 2:
            return i.sent(), [4, this._flush()];

          case 3:
            i.sent(), i.label = 4;

          case 4:
            return this.commandEventContext || (this.commandEventContext = this.dispatcher.on(function (e) {
              if (e instanceof Ce$2) {
                var t = e.statLog;
                r.put(t);
              } else if (e instanceof to) {
                var n = e.request,
                    i = e.features,
                    o = e.options;
                r._collectRequestStat = n, r._collectFeatureLocalCacheStat = null == i ? void 0 : i.localCache, r._arrangeStat(), r._collectRequestStat || r._collectFeatureLocalCacheStat ? r.enabledState = o.ingestion ? Yi$1.ENABLED : Yi$1.COLLECT_ONLY : r.enabledState = Yi$1.DISABLED, r.isEnabled ? r.queue.length >= r.limit && r._flush() : r.clear();
              }
            })), [2];
        }
      });
    });
  }, n.prototype.put = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return this.enabledState === Yi$1.DISABLED ? [3, 3] : (e instanceof io ? this._collectFeatureLocalCacheStat && (t = a$1(this.queue.filter(function (t) {
              return t instanceof io && t.key === e.key;
            }), 1), (n = t[0]) ? n.data = so(n.data, e.data) : this.queue.push(e)) : this._collectRequestStat && this.queue.push(e), [4, this._save()]);

          case 1:
            return r.sent(), this.queue.length >= this.limit ? [4, this._flush()] : [3, 3];

          case 2:
            r.sent(), r.label = 3;

          case 3:
            return [2];
        }
      });
    });
  }, n.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this.queue = [], this.generation = 1, [4, this._save()];

          case 1:
            return e.sent(), [2];
        }
      });
    });
  }, n.prototype.close = function () {
    this.commandEventContext && (this.commandEventContext.close(), this.commandEventContext = void 0);
  }, n;
}(Q);

!function (e) {
  e[e.NONE = 0] = "NONE", e[e.VERBOSE = 1] = "VERBOSE", e[e.DEBUG = 2] = "DEBUG", e[e.INFO = 3] = "INFO", e[e.WARN = 4] = "WARN", e[e.ERROR = 5] = "ERROR";
}(ao || (ao = {}));

var uo,
    lo = function () {
  function e() {
    this.level = ao.WARN;
  }

  return e.prototype.verbose = function () {
    for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];

    this.level <= ao.VERBOSE && console.log.apply(console, c$1(["[verbose]"], a$1(e), !1));
  }, e.prototype.debug = function () {
    for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];

    this.level <= ao.DEBUG && console.log.apply(console, c$1(["[debug]"], a$1(e), !1));
  }, e.prototype.info = function () {
    for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];

    this.level <= ao.INFO && console.log.apply(console, c$1(["[info]"], a$1(e), !1));
  }, e.prototype.warn = function () {
    for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];

    this.level <= ao.WARN && console.warn.apply(console, c$1(["[warn]"], a$1(e), !1));
  }, e.prototype.error = function () {
    for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];

    this.level <= ao.ERROR && console.error.apply(console, c$1(["[error]"], a$1(e), !1));
  }, e;
}(),
    ho = {},
    _o = function () {
  function e(e, t) {
    var n, r, i, o, s, a, c, u, l, d;

    if (this.connectedAt = 0, this.firstConnectedAt = 0, this.connectionHandlers = new Map(), this.userEventHandlers = new Map(), !ho[e]) {
      ho[e] = this;

      var _ = null !== (n = t.options) && void 0 !== n ? n : new I$2(),
          f = this.sdkState = {
        appId: t.appId,
        appVersion: null !== (r = t.appVersion) && void 0 !== r ? r : "",
        appState: "foreground",
        userId: void 0,
        extensions: {},
        api: {
          host: null !== (i = t.apiHost) && void 0 !== i ? i : "https://api-".concat(t.appId, ".sendbird.com")
        },
        websocket: {
          host: null !== (o = t.websocketHost) && void 0 !== o ? o : "wss://ws-".concat(t.appId, ".sendbird.com"),
          pingerDisabled: !!t.noPingpong,
          pingInterval: void 0,
          pongTimeout: void 0,
          connectMaxRetry: 2,
          compression: !0,
          reconnectMaxRetry: -1,
          reconnectRetryStrategy: new gi$1(),
          responseTimeout: _.websocketResponseTimeout
        },
        sessionTokenRefreshTimeout: _.sessionTokenRefreshTimeout
      };

      this.appInfo = void 0, this.subscribedUnreadMessageCount = {
        all: 0,
        feed: 0,
        customTypes: {},
        ts: 0
      };
      var p = this.logger = new lo();
      this.logger.level = null !== (s = t.logLevel) && void 0 !== s ? s : ao.WARN, this.connectedAt = 0, this.firstConnectedAt = 0, this.connectionHandlers = new Map(), this.userEventHandlers = new Map();
      var E = this.cacheContext = new L$2({
        encryption: t.encryption,
        store: t.store,
        localCacheEnabled: null !== (a = t.localCacheEnabled) && void 0 !== a && a,
        localCacheConfig: null !== (c = t.localCacheConfig) && void 0 !== c ? c : new K()
      });
      this.debugMode = null !== (u = t.debugMode) && void 0 !== u && u, this.maxSuperGroupChannelUnreadCount = h$1.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL, this.useMemberInfoInMessage = _.useMemberInfoInMessage, this.typingIndicatorInvalidateTime = _.typingIndicatorInvalidateTime, this.typingIndicatorThrottle = _.typingIndicatorThrottle, this.concurrentCallLimit = void 0, this.backOffDelay = void 0;
      var g = this.dispatcher = new Y(),
          v = new B();
      this.requestQueue = new ci$1(e, {
        auth: v,
        sdkState: f,
        dispatcher: g,
        logger: p,
        useFetchCompat: t.useFetchCompat
      }), this.sessionManager = new wi$1({
        auth: v,
        cacheContext: E,
        sdkState: f,
        dispatcher: g,
        requestQueue: this.requestQueue,
        logger: p
      }), this.connectionManager = new ro(e, {
        sdkState: f,
        cacheContext: this.cacheContext,
        connectionHandlers: this.connectionHandlers,
        dispatcher: g,
        sessionManager: this.sessionManager,
        websocketClient: this.requestQueue.commandRouter.websocketClient,
        disableWebSocketCloseEventHandling: null !== (l = t.disableWebSocketCloseEventHandling) && void 0 !== l && l,
        logger: p
      }), this.statLogCollector = new co({
        cacheContext: this.cacheContext,
        requestQueue: this.requestQueue,
        dispatcher: g
      }), this.appStateToggleEnabled = null === (d = t.appStateToggleEnabled) || void 0 === d || d;
    }

    return ho[e];
  }

  return e.of = function (e) {
    if (ho[e]) return ho[e];
    throw v$2.lostInstance;
  }, e.clear = function (e) {
    ho[e] && delete ho[e];
  }, e.prototype.hasExtension = function (e) {
    return this.sdkState.extensions && this.sdkState.extensions[e];
  }, e;
}(),
    fo = function () {
  function e() {}

  return e.prototype.init = function (e, t) {
    var n = t.sdkState,
        r = t.dispatcher,
        i = t.sessionManager,
        o = t.requestQueue,
        s = t.logger;
    t.onlineDetector;
    var a = t.cacheContext;
    this._iid = e, this._cacheContext = a, this._sdkState = n, this._dispatcher = r, this._sessionManager = i, this._requestQueue = o, this._logger = s;
  }, e;
}();

!function (e) {
  e.OPEN = "open", e.CLOSED = "closed";
}(uo || (uo = {}));

var po,
    Eo = "removed",
    go = function (e) {
  switch (e) {
    case "open":
      return uo.OPEN;

    case "closed":
      return uo.CLOSED;

    default:
      return null;
  }
},
    vo = function (e) {
  return !e || !!e.text && w$1("string", e.text);
},
    bo = function (e) {
  function r(t, n) {
    var r,
        i,
        o,
        s,
        a,
        c,
        u,
        l = this;
    return (l = e.call(this, t) || this).pollId = 0, l.id = 0, l.text = null, l.voteCount = 0, l.createdBy = null, l.createdAt = 0, l.updatedAt = 0, l._lastVotedAt = 0, l.pollId = null !== (r = n.poll_id) && void 0 !== r ? r : 0, l.id = null !== (i = n.id) && void 0 !== i ? i : 0, l.text = null !== (o = n.text) && void 0 !== o ? o : null, l.voteCount = null !== (s = n.vote_count) && void 0 !== s ? s : 0, l.createdBy = null !== (a = n.created_by) && void 0 !== a ? a : null, l.createdAt = null !== (c = n.created_at) && void 0 !== c ? c : 0, l.updatedAt = null !== (u = n.updated_at) && void 0 !== u ? u : 0, l;
  }

  return t$1(r, e), r.payloadify = function (t) {
    return J($(n$1(n$1({}, e.payloadify.call(this, t)), {
      vote_count: t.voteCount,
      poll_id: t.pollId,
      text: t.text,
      created_at: t.createdAt,
      id: t.id,
      created_by: t.createdBy,
      updated_at: t.updatedAt
    })));
  }, r;
}(Fi$1),
    mo = function (e) {
  function r(t, n) {
    var r,
        i,
        o,
        s,
        a,
        c,
        u,
        l,
        h,
        d,
        _,
        f,
        p,
        E = this;

    return (E = e.call(this, t) || this).id = 0, E.title = null, E.createdAt = 0, E.updatedAt = 0, E.closeAt = -1, E.status = uo.CLOSED, E.messageId = 0, E.data = null, E.voterCount = -1, E.options = [], E.createdBy = null, E.allowUserSuggestion = !1, E.allowMultipleVotes = !1, E.votedPollOptionIds = [], E.id = null !== (r = n.id) && void 0 !== r ? r : 0, E.title = null !== (i = n.title) && void 0 !== i ? i : null, E.createdAt = null !== (o = n.created_at) && void 0 !== o ? o : 0, E.updatedAt = null !== (s = n.updated_at) && void 0 !== s ? s : 0, E.closeAt = null !== (a = n.close_at) && void 0 !== a ? a : -1, E.status = null !== (c = go(n.status)) && void 0 !== c ? c : uo.CLOSED, E.messageId = null !== (u = n.message_id) && void 0 !== u ? u : 0, E.data = null !== (l = n.data) && void 0 !== l ? l : null, E.voterCount = null !== (h = n.voter_count) && void 0 !== h ? h : -1, E.options = n.options ? n.options.map(function (e) {
      return new bo(E._iid, e);
    }) : [], E.createdBy = null !== (d = n.created_by) && void 0 !== d ? d : null, E.allowUserSuggestion = null !== (_ = n.allow_user_suggestion) && void 0 !== _ && _, E.allowMultipleVotes = null !== (f = n.allow_multiple_votes) && void 0 !== f && f, E.votedPollOptionIds = null !== (p = n.voted_option_ids) && void 0 !== p ? p : [], E;
  }

  return t$1(r, e), r.prototype._applyPollUpdatePayload = function (e) {
    var t,
        n,
        r,
        i,
        o,
        s,
        a,
        c,
        u = this;
    this.title = null !== (t = e.title) && void 0 !== t ? t : this.title, this.updatedAt = null !== (n = e.updated_at) && void 0 !== n ? n : this.updatedAt, this.closeAt = null !== (r = e.close_at) && void 0 !== r ? r : this.closeAt, this.status = null !== (i = go(e.status)) && void 0 !== i ? i : this.status, this.data = null !== (o = e.data) && void 0 !== o ? o : this.data, this.voterCount = null !== (s = e.voter_count) && void 0 !== s ? s : this.voterCount, e.options && (this.options = e.options.map(function (e) {
      return new bo(u._iid, e);
    }), this.votedPollOptionIds = e.options.filter(function (e) {
      return e.vote_count > 0;
    }).map(function (e) {
      return e.id;
    })), this.allowUserSuggestion = null !== (a = e.allow_user_suggestion) && void 0 !== a ? a : this.allowUserSuggestion, this.allowMultipleVotes = null !== (c = e.allow_multiple_votes) && void 0 !== c ? c : this.allowMultipleVotes;
  }, r.payloadify = function (t) {
    return J($(n$1(n$1({}, e.payloadify.call(this, t)), {
      id: t.id,
      title: t.title,
      created_at: t.createdAt,
      updated_at: t.updatedAt,
      close_at: t.closeAt,
      status: t.status,
      message_id: t.messageId,
      data: t.data,
      voter_count: t.voterCount,
      options: t.options.map(function (e) {
        return bo.payloadify(e);
      }),
      created_by: t.createdBy,
      allow_user_suggestion: t.allowUserSuggestion,
      allow_multiple_votes: t.allowMultipleVotes,
      voted_option_ids: t.votedPollOptionIds
    })));
  }, r.prototype.applyPollUpdateEvent = function (e) {
    var t = e._payload.poll;
    return !(!t || this.id !== t.id || t.updated_at < this.updatedAt) && (this._applyPollUpdatePayload(t), !0);
  }, r.prototype.applyPollVoteEvent = function (e) {
    if (this.id !== e.pollId) return !1;
    var t = this.options,
        n = t.map(function (e) {
      return e.id;
    }),
        r = e._payload,
        i = Math.floor(r.ts / 1e3);
    return r.updated_vote_counts.forEach(function (e) {
      var r = n.indexOf(e.option_id);

      if (r > -1) {
        var o = t[r];
        i >= o._lastVotedAt && (o.voteCount = e.vote_count, o._lastVotedAt = i);
      }
    }), r.req_id && r.voted_option_ids && (this.votedPollOptionIds = r.voted_option_ids), "number" == typeof r.voter_count && (this.voterCount = r.voter_count), !0;
  }, r.prototype.serialize = function () {
    return Zi$1(this);
  }, r;
}(Fi$1);

!function (e) {
  e.UNKNOWN = "UNKNOWN", e.EVENT_CHANNEL_CREATED = "EVENT_CHANNEL_CREATED", e.EVENT_CHANNEL_UPDATED = "EVENT_CHANNEL_UPDATED", e.EVENT_CHANNEL_DELETED = "EVENT_CHANNEL_DELETED", e.EVENT_CHANNEL_READ = "EVENT_CHANNEL_READ", e.EVENT_CHANNEL_DELIVERED = "EVENT_CHANNEL_DELIVERED", e.EVENT_CHANNEL_INVITED = "EVENT_CHANNEL_INVITED", e.EVENT_CHANNEL_JOINED = "EVENT_CHANNEL_JOINED", e.EVENT_CHANNEL_LEFT = "EVENT_CHANNEL_LEFT", e.EVENT_CHANNEL_ACCEPTED_INVITE = "EVENT_CHANNEL_ACCEPTED_INVITE", e.EVENT_CHANNEL_DECLINED_INVITE = "EVENT_CHANNEL_DECLINED_INVITE", e.EVENT_CHANNEL_OPERATOR_UPDATED = "EVENT_CHANNEL_OPERATOR_UPDATED", e.EVENT_CHANNEL_BANNED = "EVENT_CHANNEL_BANNED", e.EVENT_CHANNEL_UNBANNED = "EVENT_CHANNEL_UNBANNED", e.EVENT_CHANNEL_MUTED = "EVENT_CHANNEL_MUTED", e.EVENT_CHANNEL_UNMUTED = "EVENT_CHANNEL_UNMUTED", e.EVENT_CHANNEL_FROZEN = "EVENT_CHANNEL_FROZEN", e.EVENT_CHANNEL_UNFROZEN = "EVENT_CHANNEL_UNFROZEN", e.EVENT_CHANNEL_HIDDEN = "EVENT_CHANNEL_HIDDEN", e.EVENT_CHANNEL_UNHIDDEN = "EVENT_CHANNEL_UNHIDDEN", e.EVENT_CHANNEL_RESET_HISTORY = "EVENT_CHANNEL_RESET_HISTORY", e.EVENT_CHANNEL_TYPING_STATUS_UPDATE = "EVENT_CHANNEL_TYPING_STATUS_UPDATE", e.EVENT_CHANNEL_MEMBER_COUNT_UPDATED = "EVENT_CHANNEL_MEMBER_COUNT_UPDATED", e.EVENT_CHANNEL_METADATA_CREATED = "EVENT_CHANNEL_METADATA_CREATED", e.EVENT_CHANNEL_METADATA_UPDATED = "EVENT_CHANNEL_METADATA_UPDATED", e.EVENT_CHANNEL_METADATA_DELETED = "EVENT_CHANNEL_METADATA_DELETED", e.EVENT_CHANNEL_METACOUNTER_CREATED = "EVENT_CHANNEL_METACOUNTER_CREATED", e.EVENT_CHANNEL_METACOUNTER_UPDATED = "EVENT_CHANNEL_METACOUNTER_UPDATED", e.EVENT_CHANNEL_METACOUNTER_DELETED = "EVENT_CHANNEL_METACOUNTER_DELETED", e.EVENT_MESSAGE_SENT = "EVENT_MESSAGE_SENT", e.EVENT_MESSAGE_RECEIVED = "EVENT_MESSAGE_RECEIVED", e.EVENT_MESSAGE_UPDATED = "EVENT_MESSAGE_UPDATED", e.EVENT_PINNED_MESSAGE_UPDATED = "EVENT_PINNED_MESSAGE_UPDATED", e.REQUEST_CHANNEL = "REQUEST_CHANNEL", e.REQUEST_CHANNEL_CHANGELOGS = "REQUEST_CHANNEL_CHANGELOGS", e.REFRESH_CHANNEL = "REFRESH_CHANNEL", e.CHANNEL_LASTACCESSEDAT_UPDATED = "CHANNEL_LASTACCESSEDAT_UPDATED", e.SYNC_CHANNEL_BACKGROUND = "SYNC_CHANNEL_BACKGROUND", e.SYNC_CHANNEL_CHANGELOGS = "SYNC_CHANNEL_CHANGELOGS", e.EVENT_MESSAGE_SENT_SUCCESS = "EVENT_MESSAGE_SENT_SUCCESS", e.EVENT_MESSAGE_SENT_FAILED = "EVENT_MESSAGE_SENT_FAILED", e.EVENT_MESSAGE_SENT_PENDING = "EVENT_MESSAGE_SENT_PENDING", e.EVENT_MESSAGE_DELETED = "EVENT_MESSAGE_DELETED", e.EVENT_MESSAGE_READ = "EVENT_MESSAGE_READ", e.EVENT_MESSAGE_DELIVERED = "EVENT_MESSAGE_DELIVERED", e.EVENT_MESSAGE_REACTION_UPDATED = "EVENT_MESSAGE_REACTION_UPDATED", e.EVENT_MESSAGE_THREADINFO_UPDATED = "EVENT_MESSAGE_THREADINFO_UPDATED", e.EVENT_MESSAGE_OFFSET_UPDATED = "EVENT_MESSAGE_OFFSET_UPDATED", e.REQUEST_MESSAGE = "REQUEST_MESSAGE", e.EVENT_POLL_UPDATED = "EVENT_POLL_UPDATED", e.EVENT_POLL_VOTED = "EVENT_POLL_VOTED", e.SYNC_POLL_CHANGELOGS = "SYNC_POLL_CHANGELOGS", e.REQUEST_RESEND_MESSAGE = "REQUEST_RESEND_MESSAGE", e.REQUEST_THREADED_MESSAGE = "REQUEST_THREADED_MESSAGE", e.REQUEST_MESSAGE_CHANGELOGS = "REQUEST_MESSAGE_CHANGELOGS", e.SYNC_MESSAGE_FILL = "SYNC_MESSAGE_FILL", e.SYNC_MESSAGE_BACKGROUND = "SYNC_MESSAGE_BACKGROUND", e.SYNC_MESSAGE_CHANGELOGS = "SYNC_MESSAGE_CHANGELOGS", e.LOCAL_MESSAGE_PENDING_CREATED = "LOCAL_MESSAGE_PENDING_CREATED", e.LOCAL_MESSAGE_FAILED = "LOCAL_MESSAGE_FAILED", e.LOCAL_MESSAGE_CANCELED = "LOCAL_MESSAGE_CANCELED", e.LOCAL_MESSAGE_RESEND_STARTED = "LOCAL_MESSAGE_RESEND_STARTED";
}(po || (po = {}));

n$1({}, po);
    var wo = function (e) {
  return e.startsWith("EVENT_") || e.startsWith("LOCAL_MESSAGE_") || e === po.SYNC_MESSAGE_FILL || e === po.SYNC_MESSAGE_CHANGELOGS || e === po.SYNC_POLL_CHANGELOGS;
},
    No = function (e) {
  function n(t) {
    var n = t.messages,
        r = t.source,
        i = t.isWebSocketEventComing,
        o = void 0 !== i && i,
        s = e.call(this) || this;
    return s.messages = n, s.source = r, s.isWebSocketEventComing = o, s;
  }

  return t$1(n, e), n;
}(X),
    To = function (e) {
  function n(t) {
    var n = t.messageIds,
        r = t.source,
        i = t.isWebSocketEventComing,
        o = void 0 !== i && i,
        s = e.call(this) || this;
    return s.messageIds = n, s.source = r, s.isWebSocketEventComing = o, s;
  }

  return t$1(n, e), n;
}(X),
    So = function (e) {
  function n(t) {
    var n = t.reqId,
        r = t.source,
        i = e.call(this) || this;
    return i.reqId = n, i.source = r, i;
  }

  return t$1(n, e), n;
}(X),
    Ao = function (e) {
  function n(t) {
    var n = t.polls,
        r = t.source,
        i = e.call(this) || this;
    return i.polls = n, i.source = r, i;
  }

  return t$1(n, e), n;
}(X),
    Co = function (e) {
  function n(t) {
    var n = t.event,
        r = t.source,
        i = e.call(this) || this;
    return i.event = n, i.source = r, i;
  }

  return t$1(n, e), n;
}(X),
    ko = function (e) {
  function n(t) {
    var n = t.event,
        r = t.source,
        i = e.call(this) || this;
    return i.event = n, i.source = r, i;
  }

  return t$1(n, e), n;
}(X),
    Oo = function () {
  function e(e, t) {
    var n;
    this.limit = 20, this._isLoading = !1, this._hasNext = !0, this._token = "", this._iid = e, this.limit = null !== (n = t.limit) && void 0 !== n ? n : 20;
  }

  return Object.defineProperty(e.prototype, "hasNext", {
    get: function () {
      return this._hasNext;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "isLoading", {
    get: function () {
      return this._isLoading;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype._validate = function () {
    return w$1("number", this.limit) && this.limit > 0;
  }, e;
}(),
    Io = function (e) {
  function n(t, n, r, i) {
    var o = e.call(this, t, i) || this;
    return o.channelUrl = n, o.channelType = r, o;
  }

  return t$1(n, e), n.prototype._validate = function () {
    return e.prototype._validate.call(this) && w$1("string", this.channelUrl) && N$1(x, this.channelType);
  }, n;
}(Oo),
    Ro = function (e) {
  this.pollId = 0, this.messageId = 0, this.pollId = e.poll_id, this.messageId = e.message_id, this._payload = e;
},
    Do = function (e) {
  function n(t) {
    var n = t.title,
        r = t.optionTexts,
        i = t.data,
        o = t.allowUserSuggestion,
        s = t.allowMultipleVotes,
        a = t.closeAt,
        c = e.call(this) || this;
    return c.method = ee.POST, c.path = de$1, c.params = {
      title: n,
      options: r,
      data: i,
      allow_user_suggestion: o,
      allow_multiple_votes: s,
      close_at: a
    }, c;
  }

  return t$1(n, e), n;
}(Ne$2),
    Lo = function (e) {
  function n(t, n) {
    var r = e.call(this, t, n) || this;
    return r.poll = new mo(t, n), r;
  }

  return t$1(n, e), n;
}(Te$2),
    xo = function (e) {
  function n(t) {
    var n = t.channelUrl,
        r = t.channelType,
        i = t.pollId,
        o = e.call(this) || this;
    return o.method = ee.GET, o.path = "".concat(de$1, "/").concat(encodeURIComponent(i)), o.params = {
      channel_url: n,
      channel_type: r
    }, o;
  }

  return t$1(n, e), n;
}(Ne$2),
    Uo = function (e) {
  function n(t, n) {
    var r = e.call(this, t, n) || this;
    return r.poll = new mo(t, n), r;
  }

  return t$1(n, e), n;
}(Te$2),
    Mo = function (e) {
  function n(t) {
    var n = t.channelUrl,
        r = t.channelType,
        i = t.pollId,
        o = t.pollOptionId,
        s = e.call(this) || this;
    return s.method = ee.GET, s.path = "".concat(de$1, "/").concat(encodeURIComponent(i), "/options/").concat(encodeURIComponent(o)), s.params = {
      channel_url: n,
      channel_type: r
    }, s;
  }

  return t$1(n, e), n;
}(Ne$2),
    Po = function (e) {
  function n(t, n) {
    var r = e.call(this, t, n) || this;
    return r.pollOption = new bo(t, n), r;
  }

  return t$1(n, e), n;
}(Te$2),
    zo = function (e) {
  function n(t) {
    var n = t.channelType,
        r = t.channelUrl,
        i = t.timestamp,
        o = t.token,
        s = e.call(this) || this;
    return s.method = ee.GET, s.path = "".concat(ge$1(n), "/").concat(encodeURIComponent(r), "/polls/changelogs"), s.params = J({
      change_ts: i,
      token: o
    }), s;
  }

  return t$1(n, e), n;
}(Ne$2),
    Fo = function (e) {
  function n(t, n) {
    var r = e.call(this, t, n) || this;
    return r.updatedPolls = n.updated.map(function (e) {
      return function (e, t) {
        return new mo(e, t);
      }(t, e);
    }), r.deletedPollIds = n.deleted.map(function (e) {
      return e;
    }), r.hasMore = n.has_more, r.nextToken = n.next, r;
  }

  return t$1(n, e), n;
}(Te$2),
    Ho = {
  title: "",
  optionTexts: [],
  data: void 0,
  allowUserSuggestion: void 0,
  allowMultipleVotes: void 0,
  closeAt: -1
},
    Vo = function (e) {
  return w$1("string", e.title) && (t = e.optionTexts, S$2("string", t) && t.every(function (e) {
    return "" !== e.trim();
  })) && vo(e.data) && w$1("boolean", e.allowUserSuggestion, !0) && w$1("boolean", e.allowMultipleVotes, !0) && w$1("number", e.closeAt, !0);
  var t;
},
    Go = {
  channelUrl: "",
  channelType: x.BASE,
  pollId: 0,
  pollOptionId: 0
},
    qo = function (e) {
  return w$1("string", e.channelUrl) && "" !== e.channelUrl && N$1(x, e.channelType) && w$1("number", e.pollId) && e.pollId > 0 && w$1("number", e.pollOptionId) && e.pollOptionId > 0;
},
    jo = {
  channelUrl: "",
  channelType: x.BASE,
  pollId: 0
},
    Ko = function (e) {
  return w$1("string", e.channelUrl) && "" !== e.channelUrl && N$1(x, e.channelType) && w$1("number", e.pollId);
},
    Bo = {},
    Zo = function () {
  function e(e, t) {
    var n = t.sdkState,
        r = t.dispatcher,
        i = t.sessionManager,
        o = t.requestQueue,
        s = t.logger;
    this._iid = e, this._sdkState = n, this._sessionManager = i, this._requestQueue = o, this._dispatcher = r, this._logger = s, Bo[e] = this;
  }

  return e.of = function (e) {
    return Bo[e];
  }, e.prototype.buildPollFromSerializedData = function (e) {
    var t = Wi$1(e);
    return new mo(this._iid, mo.payloadify(t));
  }, e.prototype.get = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return Qi$1(Ko(e)).throw(v$2.invalidParameters), t = new xo(n$1({}, e)), [4, this._requestQueue.send(t)];

          case 1:
            return r = i.sent(), [2, r.as(Uo).poll];
        }
      });
    });
  }, e.prototype.create = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return Qi$1(Vo(e)).throw(v$2.invalidParameters), t = new Do(n$1({}, e)), [4, this._requestQueue.send(t)];

          case 1:
            return r = i.sent(), [2, r.as(Lo).poll];
        }
      });
    });
  }, e.prototype.getOption = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return Qi$1(qo(e)).throw(v$2.invalidParameters), t = new Mo(n$1({}, e)), [4, this._requestQueue.send(t)];

          case 1:
            return r = i.sent(), [2, r.as(Po).pollOption];
        }
      });
    });
  }, e.prototype.getPollChangeLogs = function (e, t, n, r) {
    return void 0 === r && (r = po.SYNC_POLL_CHANGELOGS), i$1(this, void 0, void 0, function () {
      var i, s, a, c, u, l, h;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return i = new zo($({
              channelType: t,
              channelUrl: e,
              timestamp: "number" == typeof n ? n : null,
              token: "string" == typeof n ? n : null
            })), [4, this._requestQueue.send(i)];

          case 1:
            return s = o.sent(), a = s.as(Fo), c = a.updatedPolls, u = a.deletedPollIds, l = a.hasMore, h = a.nextToken, c.length > 0 && this._dispatcher.dispatch(new Ao({
              polls: c,
              source: r
            })), [2, {
              updatedPolls: c,
              deletedPollIds: u,
              hasMore: l,
              token: h
            }];
        }
      });
    });
  }, e;
}(),
    Wo = function (e) {
  function n(t) {
    var n = t.channelUrl,
        r = t.channelType,
        i = t.token,
        o = t.limit,
        s = e.call(this) || this;
    return s.method = ee.GET, s.path = de$1, s.params = {
      channel_url: n,
      channel_type: r,
      token: i,
      limit: o
    }, s;
  }

  return t$1(n, e), n;
}(Ne$2),
    Qo = function (e) {
  function n(t, n) {
    var r,
        i = this;
    return (i = e.call(this, t, n) || this).polls = (null !== (r = n.polls) && void 0 !== r ? r : []).map(function (e) {
      return new mo(t, e);
    }), i.token = n.next, i;
  }

  return t$1(n, e), n;
}(Te$2),
    Yo = function (e) {
  function r(t, n) {
    return e.call(this, t, n.channelUrl, n.channelType, n) || this;
  }

  return t$1(r, e), r.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, t = new Wo(n$1(n$1({}, this), {
              token: this._token
            })), [4, e.send(t)]) : [3, 2] : [3, 5];

          case 1:
            return r = o.sent(), i = r.as(Qo), s = i.polls, a = i.token, this._token = a, this._hasNext = !!a, this._isLoading = !1, [2, s];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, r;
}(Io),
    Xo = function (e) {
  function n(t) {
    var n = t.channelUrl,
        r = t.channelType,
        i = t.pollId,
        o = t.pollOptionId,
        s = t.token,
        a = t.limit,
        c = e.call(this) || this;
    return c.method = ee.GET, c.path = "".concat(de$1, "/").concat(encodeURIComponent(i), "/options/").concat(encodeURIComponent(o), "/voters"), c.params = {
      channel_url: n,
      channel_type: r,
      token: s,
      limit: a
    }, c;
  }

  return t$1(n, e), n;
}(Ne$2),
    Jo = function (e) {
  function n(t, n) {
    var r,
        i = this;
    return (i = e.call(this, t, n) || this).voters = (null !== (r = n.voters) && void 0 !== r ? r : []).map(function (e) {
      return new Xi$1(t, e);
    }), i.token = n.next, i;
  }

  return t$1(n, e), n;
}(Te$2),
    $o = function (e) {
  function r(t, n) {
    var r = e.call(this, t, n.channelUrl, n.channelType, n) || this;
    return r.pollId = n.pollId, r.pollOptionId = n.pollOptionId, r;
  }

  return t$1(r, e), r.prototype._validate = function () {
    return e.prototype._validate.call(this) && w$1("number", this.pollId) && w$1("number", this.pollOptionId);
  }, r.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, t = new Xo(n$1(n$1({}, this), {
              pollId: this.pollId,
              pollOptionId: this.pollOptionId,
              token: this._token
            })), [4, e.send(t)]) : [3, 2] : [3, 5];

          case 1:
            return r = o.sent(), i = r.as(Jo), s = i.voters, a = i.token, this._token = a, this._hasNext = !!a, this._isLoading = !1, [2, s];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, r;
}(Io);

var Ee$1,
    Te$1 = function (i) {
  function s(e) {
    var s = i.call(this) || this;
    if (s.method = ee.POST, s.path = "".concat(re), s.params = J({
      file: e.file,
      channel_url: e.channelUrl
    }), e.thumbnailSizes) for (var a = 0; a < e.thumbnailSizes.length; a++) {
      var o = e.thumbnailSizes[a],
          u = o.maxWidth,
          c = o.maxHeight;
      s.params["thumbnail".concat(a + 1)] = "".concat(u, ",").concat(c);
    }
    return s.requestId = e.requestId, s;
  }

  return t$1(s, i), s;
}(Ne$2),
    we$1 = function (t) {
  function n(e, n) {
    var r,
        i,
        s,
        a = this;
    return (a = t.call(this, e, n) || this).url = n.url, a.fileSize = null !== (r = n.file_size) && void 0 !== r ? r : 0, a.thumbnailSizes = null !== (i = n.thumbnails) && void 0 !== i ? i : [], a.requireAuth = null !== (s = n.require_auth) && void 0 !== s && s, a;
  }

  return t$1(n, t), n;
}(Te$2),
    Me$1 = function (t) {
  function n(e, n) {
    var r,
        i,
        s,
        a = this;
    return (a = t.call(this, e) || this).replyCount = 0, a.lastRepliedAt = 0, a.updatedAt = 0, a.replyCount = null !== (r = n.reply_count) && void 0 !== r ? r : 0, a.mostRepliedUsers = n.most_replies && S$2("object", n.most_replies) ? n.most_replies.map(function (e) {
      return new Xi$1(a._iid, e);
    }) : [], a.lastRepliedAt = null !== (i = n.last_replied_at) && void 0 !== i ? i : 0, a.updatedAt = null !== (s = n.updated_at) && void 0 !== s ? s : 0, a;
  }

  return t$1(n, t), n.payloadify = function (e) {
    return J($(n$1(n$1({}, t.payloadify.call(this, e)), {
      reply_count: e.replyCount,
      most_replies: Array.isArray(e.mostRepliedUsers) ? e.mostRepliedUsers.map(function (e) {
        return Xi$1.payloadify(e);
      }) : [],
      last_replied_at: e.lastRepliedAt,
      updated_at: e.updatedAt
    })));
  }, n;
}(Fi$1);

!function (e) {
  e.ADD = "add", e.DELETE = "delete";
}(Ee$1 || (Ee$1 = {}));

var Se,
    Ae,
    Ne$1 = function (e) {
  this.messageId = 0, this.operation = null, this.updatedAt = 0;
  var t = w$1("string", e.msg_id) ? parseInt(e.msg_id) : e.msg_id,
      n = e.user_id,
      r = e.operation ? e.operation.toLowerCase() : null,
      i = e.reaction,
      s = e.updated_at;
  t && w$1("string", n) && w$1("string", r) && N$1(Ee$1, r) && w$1("string", i) && i && w$1("number", s) && (this.messageId = t, this.userId = n, this.key = i, this.operation = r, this.updatedAt = s);
},
    Ue$1 = function () {
  function e(e) {
    var t,
        n,
        r,
        i = e.key,
        s = null !== (r = c$1([], a$1(e.user_ids), !1)) && void 0 !== r ? r : [],
        a = e.updated_at;
    w$1("string", i) && i && S$2("string", s) && s.length > 0 && w$1("number", a) && (this.key = i, this.userIds = s, this.updatedAt = a);
    var o = {};

    try {
      for (var u = s$2(this.userIds), c = u.next(); !c.done; c = u.next()) {
        o[c.value] = this.updatedAt;
      }
    } catch (e) {
      t = {
        error: e
      };
    } finally {
      try {
        c && !c.done && (n = u.return) && n.call(u);
      } finally {
        if (t) throw t.error;
      }
    }

    this._version = o;
  }

  return Object.defineProperty(e.prototype, "isEmpty", {
    get: function () {
      return 0 === this.userIds.length;
    },
    enumerable: !1,
    configurable: !0
  }), e.payloadify = function (e) {
    return J($({
      key: e.key,
      user_ids: e.userIds,
      updated_at: e.updatedAt
    }));
  }, e.prototype.applyEvent = function (e) {
    if (e.key === this.key && this.updatedAt <= e.updatedAt) {
      if (!this._version[e.userId] || this._version[e.userId] <= e.updatedAt) {
        var t = this.userIds.indexOf(e.userId);

        switch (e.operation) {
          case Ee$1.ADD:
            t < 0 && this.userIds.push(e.userId);
            break;

          case Ee$1.DELETE:
            t >= 0 && this.userIds.splice(t, 1);
        }

        this._version[e.userId] = e.updatedAt;
      }

      this.updatedAt = Math.max(this.updatedAt, e.updatedAt);
    }
  }, e;
}(),
    Oe$2 = function () {
  function e(e) {
    this.key = e.key, this.value = S$2("string", e.value) ? c$1([], a$1(e.value), !1) : [];
  }

  return e.payloadify = function (e) {
    var t;
    return J($({
      key: e.key,
      value: null !== (t = e.value) && void 0 !== t ? t : []
    }));
  }, e;
}(),
    Ce$1 = function () {
  function e(e) {
    this.secureUrl = null, this.type = null, this.width = 0, this.height = 0, this.alt = null, this.url = e.url, e.secure_url && (this.secureUrl = e.secure_url), e.type && (this.type = e.type), e.width && (this.width = e.width), e.height && (this.height = e.height), e.alt && (this.alt = e.alt);
  }

  return e.payloadify = function (e) {
    var t, n;
    return J($({
      url: e.url,
      secure_url: e.secureUrl,
      type: e.type,
      width: null !== (t = e.width) && void 0 !== t ? t : 0,
      height: null !== (n = e.height) && void 0 !== n ? n : 0,
      alt: e.alt
    }));
  }, e;
}(),
    Pe$2 = function () {
  function e(e) {
    this.title = null, this.url = null, this.description = null, this.defaultImage = null, e["og:title"] && (this.title = e["og:title"]), e["og:url"] && (this.url = e["og:url"]), e["og:description"] && (this.description = e["og:description"]), e["og:image"] && (this.defaultImage = new Ce$1(e["og:image"]));
  }

  return e.payloadify = function (e) {
    return J($({
      "og:title": e.title,
      "og:url": e.url,
      "og:description": e.description,
      "og:image": e.defaultImage ? Ce$1.payloadify(e.defaultImage) : null
    }));
  }, e;
}(),
    ke = function () {
  function e(e) {
    var t, n;
    this.volume = 0, this.name = null !== (t = e.name) && void 0 !== t ? t : "default", this.volume = null !== (n = e.volume) && void 0 !== n ? n : 1;
  }

  return e.prototype.serialize = function () {
    return {
      name: this.name,
      volume: this.volume
    };
  }, e.payloadify = function (e) {
    return J($({
      name: e.name,
      volume: e.volume
    }));
  }, e;
}(),
    Re$1 = function (t) {
  function n(e, n) {
    var r,
        i = this;
    return (i = t.call(this, e, n) || this).isBlockedByMe = !1, i.role = N$1(U$1, n.role) ? n.role : U$1.NONE, i.isBlockedByMe = null !== (r = n.is_blocked_by_me) && void 0 !== r && r, i;
  }

  return t$1(n, t), n.payloadify = function (e) {
    return J($(n$1(n$1({}, t.payloadify.call(this, e)), {
      role: e.role,
      is_blocked_by_me: e.isBlockedByMe
    })));
  }, n;
}(Xi$1);

!function (e) {
  e.PENDING = "pending", e.SENT = "sent", e.FAILED = "failed", e.CANCELED = "canceled";
}(Se || (Se = {})), function (e) {
  e.PENDING = "pending", e.IN_QUEUE = "in_queue", e.SENT = "sent", e.FAILED = "failed", e.CANCELED = "canceled", e.REMOVED = "removed";
}(Ae || (Ae = {}));

var xe$1 = function (e) {
  switch (e) {
    case P$1.BASE:
      return "";

    case P$1.USER:
      return "MESG";

    case P$1.FILE:
      return "FILE";

    case P$1.ADMIN:
      return "ADMM";
  }
},
    Le = function (t) {
  function n(e, n) {
    var r,
        i,
        s,
        a,
        o,
        c,
        l,
        d,
        f,
        p,
        m,
        v,
        y,
        g,
        E,
        T,
        w = this;
    (w = t.call(this, e) || this).channelType = x.BASE, w.parentMessage = null, w.silent = !1, w.isOperatorMessage = !1, w.messageType = P$1.BASE, w.mentionType = null, w.threadInfo = null, w.reactions = [], w.metaArrays = [], w.appleCriticalAlertOptions = null, w.createdAt = 0, w.updatedAt = 0, w.scheduledInfo = null, w.extendedMessage = {}, w._isContinuousMessages = !1, w._scheduledStatus = null, w.messageId = null !== (i = null !== (r = n.msg_id) && void 0 !== r ? r : n.message_id) && void 0 !== i ? i : 0, w.channelUrl = n.channel_url, w.channelType = N$1(x, n.channel_type) ? n.channel_type : x.GROUP, n.channel && (n.channel.channel_url && (w.channelUrl = n.channel.channel_url), n.channel.channel_type && (w.channelType = n.channel.channel_type)), w.parentMessageId = null !== (s = "string" == typeof n.parent_message_id ? parseInt(n.parent_message_id) : n.parent_message_id) && void 0 !== s ? s : 0, w.data = null !== (a = n.data) && void 0 !== a ? a : "", w.customType = null !== (o = n.custom_type) && void 0 !== o ? o : "", w.mentionType = N$1(H$1, n.mention_type) ? n.mention_type : null, w.mentionedUsers = n.mentioned_users ? n.mentioned_users.map(function (e) {
      return new Xi$1(w._iid, e);
    }) : null, w.mentionedUserIds = null !== (c = n.mentioned_user_ids) && void 0 !== c ? c : null, w.mentionedUsers && !w.mentionedUserIds && (w.mentionedUserIds = w.mentionedUsers.map(function (e) {
      return e.userId;
    })), w.mentionedMessageTemplate = null !== (l = n.mentioned_message_template) && void 0 !== l ? l : "", w.threadInfo = n.thread_info ? new Me$1(w._iid, n.thread_info) : null, w.reactions = n.reactions ? n.reactions.map(function (e) {
      return new Ue$1(e);
    }) : [];
    var M = null !== (d = n.metaarray) && void 0 !== d ? d : {},
        S = null !== (f = n.metaarray_key_order) && void 0 !== f ? f : Object.keys(M).sort(function (e, t) {
      return e.localeCompare(t);
    });
    w.metaArrays = [];

    for (var A = 0; A < S.length; A++) {
      var N = S[A];
      w.metaArrays.push(new Oe$2({
        key: N,
        value: M[N] || []
      }));
    }

    return n.sorted_metaarray && (w.metaArrays = n.sorted_metaarray.map(function (e) {
      return new Oe$2(e);
    })), w.ogMetaData = n.og_tag ? new Pe$2(n.og_tag) : null, w.silent = null !== (p = n.silent) && void 0 !== p && p, w.isOperatorMessage = null !== (m = n.is_op_msg) && void 0 !== m && m, w.appleCriticalAlertOptions = n.apple_critical_alert_options ? new ke(n.apple_critical_alert_options) : null, w.createdAt = null !== (y = null !== (v = n.created_at) && void 0 !== v ? v : n.ts) && void 0 !== y ? y : 0, w.updatedAt = null !== (g = n.updated_at) && void 0 !== g ? g : 0, "number" == typeof n.scheduled_message_id && "number" == typeof n.scheduled_at && n.scheduled_status && (w.scheduledInfo = {
      scheduledMessageId: n.scheduled_message_id,
      scheduledAt: n.scheduled_at
    }, w._scheduledStatus = n.scheduled_status), w.extendedMessage = null !== (E = n.extended_message) && void 0 !== E ? E : {}, w._isContinuousMessages = null !== (T = n.is_continuous_messages) && void 0 !== T && T, w;
  }

  return t$1(n, t), n.payloadify = function (e) {
    var n, i, s, c;
    return J($(n$1(n$1({}, t.payloadify.call(this, e)), {
      channel_url: e.channelUrl,
      channel_type: e.channelType,
      message_id: e.messageId,
      type: xe$1(e.messageType),
      parent_message_id: e.parentMessageId,
      data: e.data,
      custom_type: e.customType,
      mention_type: e.mentionType,
      mentioned_user_ids: e.mentionedUserIds,
      mentioned_users: null === (n = e.mentionedUsers) || void 0 === n ? void 0 : n.map(function (e) {
        return Xi$1.payloadify(e);
      }),
      mentioned_message_template: e.mentionedMessageTemplate,
      thread_info: e.threadInfo ? Me$1.payloadify(e.threadInfo) : null,
      reactions: e.reactions.map(function (e) {
        return Ue$1.payloadify(e);
      }),
      sorted_metaarray: null === (i = e.metaArrays) || void 0 === i ? void 0 : i.map(function (e) {
        return Oe$2.payloadify(e);
      }),
      og_tag: e.ogMetaData ? Pe$2.payloadify(e.ogMetaData) : null,
      silent: e.silent,
      is_op_msg: e.isOperatorMessage,
      apple_critical_alert_options: e.appleCriticalAlertOptions ? ke.payloadify(e.appleCriticalAlertOptions) : null,
      created_at: e.createdAt,
      updated_at: e.updatedAt,
      scheduled_message_id: null === (s = e.scheduledInfo) || void 0 === s ? void 0 : s.scheduledMessageId,
      scheduled_at: null === (c = e.scheduledInfo) || void 0 === c ? void 0 : c.scheduledAt,
      scheduled_status: e._scheduledStatus,
      extended_message: e.extendedMessage
    })));
  }, n._getParentMessageInfoPayload = function (e) {
    return J($({
      type: xe$1(e.messageType),
      ts: e.createdAt,
      user: e.sender ? Re$1.payloadify(e.sender) : null,
      message: e.message,
      file: {
        url: e.plainUrl,
        name: e.name,
        type: e.type,
        require_auth: e.requireAuth
      }
    }));
  }, n.prototype.isIdentical = function (e) {
    return this.messageId === e.messageId;
  }, n.prototype.isEqual = function (e) {
    return y$2(this, e);
  }, n.prototype.isUserMessage = function () {
    return this.messageType === P$1.USER;
  }, n.prototype.isFileMessage = function () {
    return this.messageType === P$1.FILE && !Object.prototype.hasOwnProperty.call(this, "fileInfoList");
  }, n.prototype.isMultipleFilesMessage = function () {
    return this.messageType === P$1.FILE && Object.prototype.hasOwnProperty.call(this, "fileInfoList");
  }, n.prototype.isAdminMessage = function () {
    return this.messageType === P$1.ADMIN;
  }, n.prototype.serialize = function () {
    return Zi$1(this);
  }, n.prototype.getMetaArraysByKeys = function (e) {
    return this.metaArrays.filter(function (t) {
      return e.includes(t.key);
    });
  }, n.prototype.applyThreadInfoUpdateEvent = function (e) {
    return this.messageId === e.targetMessageId && (this.threadInfo = e.threadInfo), !1;
  }, n.prototype.applyReactionEvent = function (e) {
    if (this.messageId === e.messageId) {
      for (var t = !1, n = 0; n < this.reactions.length; n++) if (this.reactions[n].key === e.key) {
        this.reactions[n].applyEvent(e), this.reactions[n].isEmpty && this.reactions.splice(n, 1), t = !0;
        break;
      }

      t || "add" !== e.operation || this.reactions.push(new Ue$1(Ue$1.payloadify({
        key: e.key,
        userIds: [e.userId],
        updatedAt: e.updatedAt
      })));
    }
  }, n.prototype.applyParentMessage = function (e) {
    if (!this.parentMessage) return this.parentMessage = e, !0;

    if (this.parentMessageId === e.messageId) {
      var t = this.parentMessage.updatedAt;
      if (e.updatedAt >= t) return this.parentMessage = e, !0;
    }

    return !1;
  }, n;
}(Fi$1),
    De$2 = function (t) {
  function n(e, n) {
    var r,
        i,
        s,
        a,
        o = this;
    if ((o = t.call(this, e, n) || this).reqId = "", o.replyToChannel = !1, o.errorCode = 0, o.sender = n.user ? new Re$1(o._iid, n.user) : n.sender_id, o.reqId = null !== (i = null !== (r = n.req_id) && void 0 !== r ? r : n.request_id) && void 0 !== i ? i : "", o.replyToChannel = null !== (s = n.is_reply_to_channel) && void 0 !== s && s, n.request_state && N$1(q, n.request_state) && (o.sendingStatus = n.request_state), !o.sendingStatus) if (o.messageId > 0) o.sendingStatus = q.SUCCEEDED;else if (o.scheduledInfo) switch (n.scheduled_status && (o._scheduledStatus = n.scheduled_status), n.scheduled_status) {
      case Ae.SENT:
      case Ae.IN_QUEUE:
        o.sendingStatus = q.SUCCEEDED;
        break;

      case Ae.PENDING:
        o.sendingStatus = q.SCHEDULED;
        break;

      case Ae.FAILED:
      case Ae.REMOVED:
        o.sendingStatus = q.FAILED;
        break;

      case Ae.CANCELED:
        o.sendingStatus = q.CANCELED;
    } else o.sendingStatus = q.PENDING;
    return o.errorCode = null !== (a = n.error_code) && void 0 !== a ? a : 0, o;
  }

  return t$1(n, t), n.payloadify = function (e) {
    return J($(n$1(n$1({}, t.payloadify.call(this, e)), {
      user: Re$1.payloadify(e.sender),
      req_id: e.reqId,
      is_reply_to_channel: e.replyToChannel,
      request_state: e.sendingStatus,
      error_code: e.errorCode
    })));
  }, Object.defineProperty(n.prototype, "isResendable", {
    get: function () {
      return this.sendingStatus === q.FAILED && A$1(this.errorCode);
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype.isIdentical = function (e) {
    return this.messageId > 0 && e.messageId > 0 ? this.messageId === e.messageId : this.reqId === e.reqId;
  }, n;
}(Le),
    qe$1 = function () {
  function e(e) {
    var t, n;
    this.width = 0, this.height = 0, this.realWidth = 0, this.realHeight = 0, this.url = e.url, this.width = e.width, this.height = e.height, this.realWidth = null !== (t = e.real_width) && void 0 !== t ? t : e.width, this.realHeight = null !== (n = e.real_height) && void 0 !== n ? n : e.height;
  }

  return e.payloadify = function (e) {
    return J($({
      url: "",
      width: e.maxWidth,
      height: e.maxHeight,
      real_width: 0,
      real_height: 0
    }));
  }, Object.defineProperty(e.prototype, "plainUrl", {
    get: function () {
      return this.url.split("?auth=")[0];
    },
    enumerable: !1,
    configurable: !0
  }), e;
}(),
    Fe = {
  prevResultSize: 0,
  nextResultSize: 0,
  isInclusive: !1,
  reverse: !1,
  messageTypeFilter: z.ALL,
  customTypesFilter: void 0,
  senderUserIdsFilter: void 0,
  includeReactions: !1,
  includeMetaArray: !1,
  includeParentMessageInfo: !1
},
    ze$1 = function (e) {
  return w$1("number", e.prevResultSize) && w$1("number", e.nextResultSize) && w$1("boolean", e.isInclusive) && w$1("boolean", e.reverse) && w$1("string", e.messageTypeFilter) && N$1(z, e.messageTypeFilter) && S$2("string", e.customTypesFilter, !0) && S$2("string", e.senderUserIdsFilter, !0) && w$1("boolean", e.includeMetaArray) && w$1("boolean", e.includeReactions) && w$1("boolean", e.includeParentMessageInfo);
},
    Be$1 = function (t) {
  function n(e, n) {
    var i,
        s,
        u,
        c,
        l = this;

    if ((l = t.call(this, e, n) || this).translations = {}, l.message = null !== (i = n.message) && void 0 !== i ? i : "", l.messageType = P$1.ADMIN, l.translations = null !== (s = n.translations) && void 0 !== s ? s : {}, n.parent_message_info) {
      var d = n.parent_message_info;
      l.parentMessage = We$1(e, J($(n$1(n$1({}, d), {
        message_id: l.parentMessageId,
        channel_url: l.channelUrl,
        channel_type: l.channelType,
        file: d.file,
        url: null === (u = d.file) || void 0 === u ? void 0 : u.url,
        require_auth: null === (c = d.file) || void 0 === c ? void 0 : c.require_auth
      }))));
    }

    return l;
  }

  return t$1(n, t), n.payloadify = function (e) {
    return J($(n$1(n$1({}, t.payloadify.call(this, e)), {
      message: e.message,
      translations: e.translations,
      parent_message_info: e.parentMessage ? t._getParentMessageInfoPayload.call(this, e.parentMessage) : null
    })));
  }, n.prototype.getThreadedMessagesByTimestamp = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = n$1(n$1({}, Fe), t), Qi$1(this.messageId > 0 && w$1("number", e) && ze$1(n)).throw(v$2.invalidParameters), [4, Zi.of(this._iid).getThreadedMessagesByTimestamp(this, e, n)];

          case 1:
            return [2, r.sent()];
        }
      });
    });
  }, n;
}(Le),
    Ke$1 = function () {
  function e(e) {
    var t, n;
    this.detail = {}, this.type = null !== (t = e.type) && void 0 !== t ? t : "", this.vendor = null !== (n = e.vendor) && void 0 !== n ? n : "", e.detail && w$1("object", e.detail) && !Array.isArray(e.detail) && (this.detail = e.detail);
  }

  return e.payloadify = function (e) {
    return J($({
      type: e.type,
      vendor: e.vendor,
      detail: e.detail
    }));
  }, e;
}(),
    je$1 = function (t) {
  function n(e, n) {
    var i,
        s,
        u,
        c,
        l,
        d,
        h,
        f = this;
    if ((f = t.call(this, e, n) || this).message = "", f.messageParams = null, f.translations = {}, f.translationTargetLanguages = [], f.messageSurvivalSeconds = -1, f.plugins = [], f._poll = null, f.message = n.message, f.messageType = P$1.USER, f.translations = null !== (u = n.translations) && void 0 !== u ? u : {}, f.translationTargetLanguages = null !== (c = n.target_langs) && void 0 !== c ? c : [], 0 === Object.keys(f.translations).length && f.translationTargetLanguages.length > 0) try {
      for (var p = s$2(f.translationTargetLanguages), v = p.next(); !v.done; v = p.next()) {
        var y = v.value;
        f.translations[y] = "";
      }
    } catch (e) {
      i = {
        error: e
      };
    } finally {
      try {
        v && !v.done && (s = p.return) && s.call(p);
      } finally {
        if (i) throw i.error;
      }
    }

    if (f.messageSurvivalSeconds = null !== (l = n.message_survival_seconds) && void 0 !== l ? l : -1, f.plugins = n.plugins ? n.plugins.map(function (e) {
      return new Ke$1(e);
    }) : [], f._poll = n.poll ? new mo(f._iid, n.poll) : null, n.parent_message_info) {
      var g = n.parent_message_info;
      f.parentMessage = We$1(e, J($(n$1(n$1({}, g), {
        created_at: g.ts,
        message_id: f.parentMessageId,
        channel_url: f.channelUrl,
        channel_type: f.channelType,
        file: g.file,
        url: null === (d = g.file) || void 0 === d ? void 0 : d.url,
        require_auth: null === (h = g.file) || void 0 === h ? void 0 : h.require_auth
      }))));
    }

    return f;
  }

  return t$1(n, t), n.payloadify = function (e) {
    return J($(n$1(n$1({}, t.payloadify.call(this, e)), {
      message: e.message,
      translations: e.translations,
      message_survival_seconds: e.messageSurvivalSeconds,
      plugins: e.plugins.map(function (e) {
        return Ke$1.payloadify(e);
      }),
      poll: e._poll ? mo.payloadify(e._poll) : null,
      parent_message_info: e.parentMessage ? t._getParentMessageInfoPayload.call(this, e.parentMessage) : null
    })));
  }, n.prototype.getThreadedMessagesByTimestamp = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = n$1(n$1({}, Fe), t), Qi$1(this.messageId > 0 && w$1("number", e) && ze$1(n)).throw(v$2.invalidParameters), [4, Zi.of(this._iid).getThreadedMessagesByTimestamp(this, e, n)];

          case 1:
            return [2, r.sent()];
        }
      });
    });
  }, n.prototype.applyPoll = function (e) {
    return !(this._poll && this._poll.id === e.id && this._poll.updatedAt > e.updatedAt) && (this._poll = e, !0);
  }, Object.defineProperty(n.prototype, "poll", {
    get: function () {
      return this._poll;
    },
    enumerable: !1,
    configurable: !0
  }), n;
}(De$2),
    Qe$1 = function (t) {
  function n(e, n) {
    var r,
        i,
        s,
        a,
        u,
        c = this;
    (c = t.call(this, e) || this).plainUrl = "", c.fileName = null, c.mimeType = null, c.fileSize = 0, c.thumbnails = [], c._requireAuth = !1, c.plainUrl = null !== (r = n.url) && void 0 !== r ? r : "", c.fileName = null !== (i = n.file_name) && void 0 !== i ? i : null, c.mimeType = null !== (s = n.file_type) && void 0 !== s ? s : null, c.fileSize = null !== (a = n.file_size) && void 0 !== a ? a : 0, c._requireAuth = null !== (u = n.require_auth) && void 0 !== u && u;
    var l = _o.of(c._iid).sessionManager;
    return c.thumbnails = n.thumbnails ? n.thumbnails.map(function (e) {
      return new qe$1(n$1(n$1({}, e), {
        url: "".concat(e.url.split("?auth=")[0]).concat(c._requireAuth ? "?auth=".concat(l.ekey) : "")
      }));
    }) : [], c;
  }

  return t$1(n, t), n.payloadify = function (e) {
    var t;
    return J($({
      url: e.plainUrl,
      file_name: e.fileName,
      file_type: e.mimeType,
      file_size: e.fileSize,
      thumbnails: null === (t = e.thumbnails) || void 0 === t ? void 0 : t.map(function (e) {
        return {
          url: e.url,
          width: e.width,
          height: e.height,
          real_width: e.realWidth,
          real_height: e.realHeight
        };
      }),
      require_auth: e._requireAuth
    }));
  }, Object.defineProperty(n.prototype, "url", {
    get: function () {
      var e = _o.of(this._iid).sessionManager;
      return this._requireAuth ? "".concat(this.plainUrl, "?auth=").concat(e.ekey) : this.plainUrl;
    },
    enumerable: !1,
    configurable: !0
  }), n;
}(Fi$1),
    Ge = function (t) {
  function n(e, n) {
    var i,
        s,
        u,
        c,
        l,
        d = this;

    if ((d = t.call(this, e, n) || this).messageParams = null, d.fileInfoList = [], d.messageSurvivalSeconds = -1, d.messageType = P$1.FILE, d.fileInfoList = null !== (s = null === (i = n.files) || void 0 === i ? void 0 : i.map(function (t) {
      return new Qe$1(e, t);
    })) && void 0 !== s ? s : [], d.messageSurvivalSeconds = null !== (u = n.message_survival_seconds) && void 0 !== u ? u : -1, n.parent_message_info) {
      var h = n.parent_message_info;
      d.parentMessage = We$1(e, J($(n$1(n$1({}, h), {
        created_at: h.ts,
        message_id: d.parentMessageId,
        channel_url: d.channelUrl,
        channel_type: d.channelType,
        file: h.file,
        url: null === (c = h.file) || void 0 === c ? void 0 : c.url,
        require_auth: null === (l = h.file) || void 0 === l ? void 0 : l.require_auth
      }))));
    }

    return d;
  }

  return t$1(n, t), n.prototype.getThreadedMessagesByTimestamp = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = n$1(n$1({}, Fe), t), Qi$1(this.messageId > 0 && w$1("number", e) && ze$1(n)).throw(v$2.invalidParameters), [4, Zi.of(this._iid).getThreadedMessagesByTimestamp(this, e, n)];

          case 1:
            return [2, r.sent()];
        }
      });
    });
  }, n.payloadify = function (e) {
    return J($(n$1(n$1({}, t.payloadify.call(this, e)), {
      files: e.fileInfoList && e.fileInfoList && Array.isArray(e.fileInfoList) ? e.fileInfoList.map(function (e) {
        return Qe$1.payloadify(e);
      }) : null,
      message_survival_seconds: e.messageSurvivalSeconds,
      parent_message_info: e.parentMessage ? t._getParentMessageInfoPayload.call(this, e.parentMessage) : null
    })));
  }, n._isMultipleFilesMessagePayload = function (e) {
    var t = e.files;
    return Array.isArray(t) && t.length >= 2;
  }, n._isMultipleFilesMessageSerializedData = function (e) {
    var t = e.fileInfoList;
    return Array.isArray(t);
  }, n;
}(De$2),
    Ve$1 = function (e) {
  switch (e.messageType) {
    case P$1.USER:
      return je$1.payloadify(e);

    case P$1.FILE:
      return e.fileInfoList ? Ge.payloadify(e) : He$2.payloadify(e);

    case P$1.ADMIN:
      return Be$1.payloadify(e);

    default:
      throw v$2.unknown;
  }
},
    We$1 = function (e, t) {
  switch (t.type) {
    case "MESG":
      return new je$1(e, t);

    case "FILE":
      return Ge._isMultipleFilesMessagePayload(t) ? new Ge(e, t) : new He$2(e, t);

    case "ADMM":
    case "BRDM":
      return new Be$1(e, t);
  }

  throw v$2.unknown;
},
    He$2 = function (t) {
  function n(e, n) {
    var i,
        s,
        u,
        c,
        l,
        d,
        h,
        f,
        p,
        m,
        v,
        y,
        g,
        b,
        I = this;
    (I = t.call(this, e, n) || this).messageParams = null, I.plainUrl = "", I.requireAuth = !1, I.thumbnails = [], I.messageSurvivalSeconds = -1, I.messageType = P$1.FILE;
    var E = n.file;
    I.plainUrl = (null !== (s = null !== (i = null == E ? void 0 : E.url) && void 0 !== i ? i : n.url) && void 0 !== s ? s : "").split("?auth=")[0], I.name = null !== (c = null !== (u = null == E ? void 0 : E.name) && void 0 !== u ? u : n.name) && void 0 !== c ? c : "File", I.size = null !== (d = null !== (l = null == E ? void 0 : E.size) && void 0 !== l ? l : n.size) && void 0 !== d ? d : 0, I.data = null !== (f = null !== (h = null == E ? void 0 : E.data) && void 0 !== h ? h : n.custom) && void 0 !== f ? f : "", I.type = E ? null !== (p = E.type) && void 0 !== p ? p : "" : null !== (m = n.type) && void 0 !== m ? m : "";
    var T = _o.of(I._iid).sessionManager;

    if (I.requireAuth = null !== (v = n.require_auth) && void 0 !== v && v, I.thumbnails = n.thumbnails ? n.thumbnails.map(function (e) {
      return new qe$1(n$1(n$1({}, e), {
        url: "".concat(e.url.split("?auth=")[0]).concat(I.requireAuth ? "?auth=".concat(T.ekey) : "")
      }));
    }) : [], I.messageSurvivalSeconds = null !== (y = n.message_survival_seconds) && void 0 !== y ? y : -1, n.parent_message_info) {
      var w = n.parent_message_info;
      I.parentMessage = We$1(e, J($(n$1(n$1({}, w), {
        created_at: w.ts,
        message_id: I.parentMessageId,
        channel_url: I.channelUrl,
        channel_type: I.channelType,
        file: w.file,
        url: null === (g = w.file) || void 0 === g ? void 0 : g.url,
        require_auth: null === (b = w.file) || void 0 === b ? void 0 : b.require_auth
      }))));
    }

    return I;
  }

  return t$1(n, t), n.payloadify = function (e) {
    var n;
    return J($(n$1(n$1({}, t.payloadify.call(this, e)), {
      url: e.plainUrl,
      require_auth: e.requireAuth,
      file: {
        name: e.name,
        size: e.size,
        type: e.type,
        data: e.data
      },
      thumbnails: null === (n = e.thumbnails) || void 0 === n ? void 0 : n.map(function (e) {
        return {
          url: e.url,
          width: e.width,
          height: e.height,
          real_width: e.realWidth,
          real_height: e.realHeight
        };
      }),
      message_survival_seconds: e.messageSurvivalSeconds,
      parent_message_info: e.parentMessage ? t._getParentMessageInfoPayload.call(this, e.parentMessage) : null
    })));
  }, Object.defineProperty(n.prototype, "url", {
    get: function () {
      var e = _o.of(this._iid).sessionManager;
      return this.requireAuth ? "".concat(this.plainUrl, "?auth=").concat(e.ekey) : this.plainUrl;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype.getThreadedMessagesByTimestamp = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = n$1(n$1({}, Fe), t), Qi$1(this.messageId > 0 && w$1("number", e) && ze$1(n)).throw(v$2.invalidParameters), [4, Zi.of(this._iid).getThreadedMessagesByTimestamp(this, e, n)];

          case 1:
            return [2, r.sent()];
        }
      });
    });
  }, n;
}(De$2),
    Ye$1 = function (t) {
  function n(e) {
    var n,
        i,
        s,
        o = [];
    return e.mentionType === H$1.USERS && (e.mentionedUserIds ? o = e.mentionedUserIds : e.mentionedUsers && (o = e.mentionedUsers.map(function (e) {
      return e.userId;
    }))), t.call(this, {
      code: "FILE",
      ackRequired: !0,
      payload: J($({
        channel_url: e.channelUrl,
        files: e.files ? $e(e.files) : null,
        url: e.url,
        name: null !== (n = e.fileName) && void 0 !== n ? n : "",
        type: null !== (i = e.mimeType) && void 0 !== i ? i : "",
        size: null !== (s = e.fileSize) && void 0 !== s ? s : 0,
        custom: e.data,
        custom_type: e.customType,
        thumbnails: e.thumbnailSizes,
        require_auth: e.requireAuth,
        metaarray: e.metaArrays,
        mention_type: e.mentionType,
        mentioned_user_ids: o,
        push_option: e.pushNotificationDeliveryOption && e.pushNotificationDeliveryOption !== G.DEFAULT ? e.pushNotificationDeliveryOption : void 0,
        apple_critical_alert_options: e.appleCriticalAlertOptions ? ke.payloadify(e.appleCriticalAlertOptions) : null,
        silent: e.silent,
        reply_to_channel: e.isReplyToChannel,
        parent_message_id: e.parentMessageId ? e.parentMessageId : null,
        req_id: e.reqId,
        pin_message: e.isPinnedMessage
      }))
    }) || this;
  }

  return t$1(n, t), n;
}(ri$1),
    Je$1 = function (n) {
  function i(e) {
    var i,
        s,
        o = this;
    o = n.call(this) || this;
    var u = [];
    return e.mentionType === H$1.USERS && (e.mentionedUserIds ? u = e.mentionedUserIds : e.mentionedUsers && (u = e.mentionedUsers.map(function (e) {
      return e.userId;
    }))), o.method = ee.POST, o.path = "".concat(ge$1(e.channelType), "/").concat(encodeURIComponent(e.channelUrl), "/messages"), o.params = J($({
      message_type: P$1.FILE,
      user_id: e.userId,
      files: e.files ? $e(e.files) : null,
      url: e.fileUrl,
      mention_type: e.mentionType,
      mentioned_user_ids: u,
      file_name: e.fileName,
      file_size: e.fileSize,
      file_type: e.mimeType,
      data: e.data,
      custom_type: e.customType,
      thumbnails: null === (i = e.thumbnailSizes) || void 0 === i ? void 0 : i.map(function (e) {
        return qe$1.payloadify(e);
      }),
      require_auth: e.requireAuth,
      sorted_metaarray: null === (s = e.metaArrays) || void 0 === s ? void 0 : s.map(function (e) {
        return Oe$2.payloadify(e);
      }),
      push_option: e.pushNotificationDeliveryOption,
      parent_message_id: e.parentMessageId ? e.parentMessageId : null,
      apple_critical_alert_options: e.appleCriticalAlertOptions ? ke.payloadify(e.appleCriticalAlertOptions) : null,
      reply_to_channel: e.isReplyToChannel,
      req_id: e.reqId,
      pin_message: e.isPinnedMessage
    })), o;
  }

  return t$1(i, n), i;
}(Ne$2),
    Xe$1 = function (t) {
  function n(e, n, r) {
    var i,
        s,
        a,
        o,
        u = this;
    (u = t.call(this, e, "FILE", r) || this).message = r.files && r.files.length >= 2 ? new Ge(e, r) : new He$2(e, r);
    var c = _o.of(e).sdkState;
    return u.isMentioned = be$1(u.message.mentionType, null !== (a = null !== (i = u.message.mentionedUserIds) && void 0 !== i ? i : null === (s = u.message.mentionedUsers) || void 0 === s ? void 0 : s.map(function (e) {
      return e.userId;
    })) && void 0 !== a ? a : [], c.userId), u.forceUpdateLastMessage = null !== (o = r.force_update_last_message) && void 0 !== o && o, u;
  }

  return t$1(n, t), n;
}(Pe$3),
    Ze = function (t) {
  function n(e, n) {
    var r,
        i,
        s,
        a,
        o = this;
    (o = t.call(this, e, n) || this).message = n.files && n.files.length >= 2 ? new Ge(e, n) : new He$2(e, n);
    var u = _o.of(e).sdkState;
    return o.isMentioned = be$1(o.message.mentionType, null !== (s = null !== (r = o.message.mentionedUserIds) && void 0 !== r ? r : null === (i = o.message.mentionedUsers) || void 0 === i ? void 0 : i.map(function (e) {
      return e.userId;
    })) && void 0 !== s ? s : [], u.userId), o.forceUpdateLastMessage = null !== (a = n.force_update_last_message) && void 0 !== a && a, o;
  }

  return t$1(n, t), n;
}(Te$2);

function $e(e) {
  return e.map(function (e) {
    var t, n;
    return J($({
      url: e.fileUrl,
      file_name: e.fileName,
      file_type: e.mimeType,
      file_size: e.fileSize,
      thumbnails: null === (t = e.thumbnailSizes) || void 0 === t ? void 0 : t.map(function (e) {
        return qe$1.payloadify(e);
      }),
      require_auth: null === (n = e._uploadedMetaData) || void 0 === n ? void 0 : n.requireAuth
    }));
  });
}

var et;
!function (e) {
  e[e.PENDING = 0] = "PENDING", e[e.UPLOADING = 1] = "UPLOADING", e[e.UPLOADED = 2] = "UPLOADED", e[e.SENDING = 3] = "SENDING", e[e.FAILED = 4] = "FAILED";
}(et || (et = {}));

var tt = function () {
  function e(e, t) {
    var n = t.sdkState,
        r = t.dispatcher,
        i = t.requestQueue,
        s = t.onlineDetector,
        a = t.cacheContext,
        o = this;
    this._queueMap = new Map(), this._iid = e, this._sdkState = n, this._requestQueue = i, this._cacheContext = a, this._dispatcher = r, this._dispatcher.on(function (e) {
      e instanceof ai$1 && (o._connectionState = e.stateType);
    }), this._onlineDetector = s;
  }

  return Object.defineProperty(e.prototype, "_shouldSendThroughWebSocket", {
    get: function () {
      return this._connectionState === ti$1.CONNECTED || this._connectionState === ti$1.CONNECTING || this._connectionState === ti$1.RECONNECTING;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype._sendFileMessage = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return n = this._createSendFileMessageRequestParams(e, t), this._shouldSendThroughWebSocket ? (r = new Ye$1(n), [4, this._requestQueue.send(r)]) : [3, 2];

          case 1:
            return i = s.sent(), [2, i.as(Xe$1).message];

          case 2:
            return r = new Je$1(n$1(n$1({}, n), {
              userId: this._sdkState.userId
            })), [4, this._requestQueue.send(r)];

          case 3:
            return i = s.sent(), [2, i.as(Ze).message];
        }
      });
    });
  }, e.prototype._createSendFileMessageRequestParams = function (e, t) {
    var n = n$1(n$1({}, t.params), {
      channelUrl: e.url,
      channelType: e.channelType,
      reqId: t.requestId,
      url: ""
    });

    if (t.multipleFileUploadInfo) {
      var r = t.params;
      n.files = r.fileInfoList;
    } else {
      r = t.params;
      n.url = r.fileUrl, n.requireAuth = r.requireAuth;
    }

    return n;
  }, e.prototype._resolveMessageQueue = function (e) {
    var t;
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s, a, o, u, c, l, d, h, f, p;
      return o$1(this, function (v) {
        switch (v.label) {
          case 0:
            if (!(n = this._queueMap.get(e.url))) return [3, 21];
            if (n.isResolving) return [3, 20];
            n.isResolving = !0, r = [], i = !0, v.label = 1;

          case 1:
            v.trys.push([1, 15, 16, 17]), s = s$2(n.messageQueue), a = s.next(), v.label = 2;

          case 2:
            if (a.done) return [3, 14];

            switch (o = a.value, o.state) {
              case et.PENDING:
              case et.UPLOADING:
                return [3, 3];

              case et.UPLOADED:
                return [3, 4];

              case et.FAILED:
                return [3, 12];
            }

            return [3, 13];

          case 3:
            return i = !1, r.push(o), [3, 13];

          case 4:
            if (!i) return [3, 10];
            v.label = 5;

          case 5:
            return v.trys.push([5, 8,, 9]), o.state = et.SENDING, [4, this._sendFileMessage(e, o)];

          case 6:
            return u = v.sent(), o.deferred.resolve(u), [4, Ei$1(100)];

          case 7:
            return v.sent(), [3, 9];

          case 8:
            return c = v.sent(), o.deferred.reject(c), [3, 9];

          case 9:
            return [3, 11];

          case 10:
            r.push(o), v.label = 11;

          case 11:
            return [3, 13];

          case 12:
            return l = null !== (t = o.error) && void 0 !== t ? t : v$2.unknown, o.deferred.reject(l.code === u$1.REQUEST_CANCELED ? v$2.fileUploadCanceled : l), [3, 13];

          case 13:
            return a = s.next(), [3, 2];

          case 14:
            return [3, 17];

          case 15:
            return d = v.sent(), f = {
              error: d
            }, [3, 17];

          case 16:
            try {
              a && !a.done && (p = s.return) && p.call(s);
            } finally {
              if (f) throw f.error;
            }

            return [7];

          case 17:
            return h = n.isResolveRequestPending, n.messageQueue = r, n.isResolving = !1, n.isResolveRequestPending = !1, h ? [4, this._resolveMessageQueue(e)] : [3, 19];

          case 18:
            v.sent(), v.label = 19;

          case 19:
            return [3, 21];

          case 20:
            n.isResolveRequestPending = !0, v.label = 21;

          case 21:
            return [2];
        }
      });
    });
  }, e.prototype._uploadNextPendingItem = function (e) {
    var t;
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s, a, o, u, c, l;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            return (n = this._queueMap.get(e.url)) && (r = n.messageQueue.find(function (e) {
              return e.state === et.PENDING;
            })) ? r.multipleFileUploadInfo ? (i = r.multipleFileUploadInfo, s = i.uploadIndex, a = i.uploadCount, o = i.requestHandler, l = r.params, u = l.fileInfoList[s], !k(u.file) || (null === (t = u._uploadedMetaData) || void 0 === t ? void 0 : t.isUploaded) ? [3, 2] : [4, this._tryUploadNextItemAndUpdateItemState(e, n, r)]) : [3, 4] : [3, 9];

          case 1:
            return d.sent(), [3, 3];

          case 2:
            r.state = s < a - 1 ? et.PENDING : et.UPLOADED, d.label = 3;

          case 3:
            return c = s, null == o || o._triggerOnFileUploaded(r.requestId, c, u, r.error), r.multipleFileUploadInfo.uploadIndex++, [3, 7];

          case 4:
            return l = r.params, k(l.file) ? [4, this._tryUploadNextItemAndUpdateItemState(e, n, r)] : [3, 6];

          case 5:
            return d.sent(), [3, 7];

          case 6:
            l.thumbnailSizes = [], r.state = et.UPLOADED, d.label = 7;

          case 7:
            return this._uploadNextPendingItem(e), [4, this._resolveMessageQueue(e)];

          case 8:
            d.sent(), d.label = 9;

          case 9:
            return [2];
        }
      });
    });
  }, e.prototype._tryUploadNextItemAndUpdateItemState = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      var r, i, s, a, o, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return [4, this._onlineDetector.isOnline()];

          case 1:
            if (r = c.sent(), !_o.of(this._iid).sessionManager.currentUser || !r) return n.error = v$2.connectionRequired, n.state = et.FAILED, [2];
            if (!(t.uploadQueue.length < 6)) return [3, 9];
            n.state = et.UPLOADING, t.uploadQueue.push(n), c.label = 2;

          case 2:
            return c.trys.push([2, 7,, 8]), n.multipleFileUploadInfo ? (i = n.multipleFileUploadInfo, s = i.uploadIndex, a = i.uploadCount, o = n.params, [4, this._uploadNextFileForMultipleFilesItemAndUpdateParams(e, n, o)]) : [3, 4];

          case 3:
            return c.sent(), n.state = s < a - 1 ? et.PENDING : et.UPLOADED, [3, 6];

          case 4:
            return o = n.params, [4, this._uploadNextFileForSingleFileItemAndUpdateParams(e, n, o)];

          case 5:
            c.sent(), n.state = et.UPLOADED, c.label = 6;

          case 6:
            return [3, 8];

          case 7:
            return u = c.sent(), n.error = u.code === u$1.REQUEST_FAILED ? new v$2({
              code: u$1.NETWORK_ERROR,
              message: "Failed to upload a file."
            }) : u, n.state = et.FAILED, [3, 8];

          case 8:
            this._dequeueUploadItem(t, n), c.label = 9;

          case 9:
            return [2];
        }
      });
    });
  }, e.prototype._dequeueUploadItem = function (e, t) {
    var n = e.uploadQueue.findIndex(function (e) {
      return e.requestId === t.requestId;
    });
    n >= 0 && e.uploadQueue.splice(n, 1);
  }, e.prototype._uploadNextFileForSingleFileItemAndUpdateParams = function (e, t, n) {
    var r, i, s;
    return i$1(this, void 0, void 0, function () {
      var a, o, u, c, l, d, h, f, p, m;
      return o$1(this, function (v) {
        switch (v.label) {
          case 0:
            return a = new Te$1({
              file: n.file,
              channelUrl: e.url,
              thumbnailSizes: n.thumbnailSizes,
              requestId: t.requestId
            }), [4, this._requestQueue.send(a)];

          case 1:
            return o = v.sent(), u = o.as(we$1), c = u.url, l = u.fileSize, d = void 0 === l ? n.fileSize : l, h = u.thumbnailSizes, f = void 0 === h ? n.thumbnailSizes : h, p = u.requireAuth, m = void 0 !== p && p, n.fileName = null !== (r = n.fileName) && void 0 !== r ? r : n.file.name, n.mimeType = null !== (i = n.mimeType) && void 0 !== i ? i : n.file.type, n.fileSize = null !== (s = n.fileSize) && void 0 !== s ? s : n.file.size, n.fileUrl = c, n.fileSize = d, n.thumbnailSizes = f, n.requireAuth = m, [2];
        }
      });
    });
  }, e.prototype._uploadNextFileForMultipleFilesItemAndUpdateParams = function (e, t, n) {
    var r, i, s;
    return i$1(this, void 0, void 0, function () {
      var a, u, c, l, d, h, f, p, m, v, y, _;

      return o$1(this, function (g) {
        switch (g.label) {
          case 0:
            return a = t.multipleFileUploadInfo.uploadIndex, u = n.fileInfoList[a], c = new Te$1({
              file: u.file,
              channelUrl: e.url,
              thumbnailSizes: u.thumbnailSizes,
              requestId: t.requestId
            }), [4, this._requestQueue.send(c)];

          case 1:
            return l = g.sent(), d = l.as(we$1), h = d.url, f = d.fileSize, p = void 0 === f ? u.fileSize : f, m = d.thumbnailSizes, v = void 0 === m ? u.thumbnailSizes : m, y = d.requireAuth, _ = void 0 !== y && y, u.fileName = null !== (r = u.fileName) && void 0 !== r ? r : u.file.name, u.mimeType = null !== (i = u.mimeType) && void 0 !== i ? i : u.file.type, u.fileSize = null !== (s = u.fileSize) && void 0 !== s ? s : u.file.size, u.file = void 0, u.fileUrl = h, u.fileSize = p, u.thumbnailSizes = v, u._uploadedMetaData = n$1(n$1({}, u._uploadedMetaData), {
              requireAuth: _,
              isUploaded: !0
            }), [2];
        }
      });
    });
  }, e.prototype.request = function (e, t, n, r) {
    return i$1(this, void 0, void 0, function () {
      var i, s, a, o, u;
      return o$1(this, function (c) {
        return this._queueMap.has(e.url) || (i = {
          messageQueue: [],
          uploadQueue: [],
          isResolving: !1,
          isResolveRequestPending: !1
        }, this._queueMap.set(e.url, i)), s = this._queueMap.get(e.url), a = new oi$1(), o = {
          requestId: t,
          params: n,
          state: et.PENDING,
          deferred: a
        }, function (e) {
          return "fileInfoList" in e;
        }(n) && (u = {
          uploadIndex: 0,
          uploadCount: n.fileInfoList.length,
          requestHandler: r
        }, o.multipleFileUploadInfo = u), s.messageQueue.push(o), this._uploadNextPendingItem(e), [2, a.promise];
      });
    });
  }, e.prototype.cancel = function (e, t) {
    var n,
        r,
        i = this._queueMap.get(e.url);

    if (i) {
      var s = t ? [i.messageQueue.find(function (e) {
        return e.requestId === t;
      })] : c$1([], a$1(i.messageQueue), !1);

      try {
        for (var a = s$2(s), o = a.next(); !o.done; o = a.next()) {
          var u = o.value;
          if (u) switch (u.state) {
            case et.PENDING:
              u.state = et.FAILED, u.error = v$2.requestCanceled, this._resolveMessageQueue(e);
              break;

            case et.UPLOADING:
              this._requestQueue.cancel(u.requestId);

          }
        }
      } catch (e) {
        n = {
          error: e
        };
      } finally {
        try {
          o && !o.done && (r = a.return) && r.call(a);
        } finally {
          if (n) throw n.error;
        }
      }
    }
  }, e;
}();

var nt,
    rt = {
  prevResultSize: 0,
  nextResultSize: 0,
  isInclusive: !1,
  reverse: !1,
  messageTypeFilter: z.ALL,
  customTypesFilter: void 0,
  senderUserIdsFilter: void 0,
  replyType: V.NONE,
  includeReactions: !1,
  includeMetaArray: !1,
  includeParentMessageInfo: !1,
  includeThreadInfo: !1,
  showSubchannelMessagesOnly: !1
},
    it$1 = function (e) {
  return w$1("number", e.prevResultSize) && w$1("number", e.nextResultSize) && w$1("boolean", e.isInclusive) && w$1("boolean", e.reverse) && w$1("string", e.messageTypeFilter) && N$1(z, e.messageTypeFilter) && S$2("string", e.customTypesFilter, !0) && S$2("string", e.senderUserIdsFilter, !0) && N$1(V, e.replyType) && w$1("boolean", e.includeMetaArray) && w$1("boolean", e.includeReactions) && w$1("boolean", e.includeParentMessageInfo) && w$1("boolean", e.includeThreadInfo) && w$1("boolean", e.showSubchannelMessagesOnly);
},
    st$1 = {
  replyType: V.NONE,
  includeReactions: !1,
  includeThreadInfo: !1,
  includeMetaArray: !1,
  includeParentMessageInfo: !1
},
    at$1 = function (e) {
  return N$1(V, e.replyType) && w$1("boolean", e.includeReactions) && w$1("boolean", e.includeMetaArray) && w$1("boolean", e.includeParentMessageInfo) && w$1("boolean", e.includeThreadInfo);
},
    ot$1 = function (n) {
  function r(e) {
    var r = e.channelType,
        i = e.channelUrl,
        s = e.messageId,
        a = e.includeMetaArray,
        o = e.includeReactions,
        u = e.includeThreadInfo,
        c = e.includeParentMessageInfo,
        l = n.call(this) || this;
    return l.method = ee.GET, l.path = "".concat(ge$1(r), "/").concat(encodeURIComponent(i), "/messages/").concat(encodeURIComponent(s)), l.params = {
      is_sdk: !0,
      with_sorted_meta_array: a,
      include_reactions: o,
      include_thread_info: u,
      include_parent_message_info: c,
      include_poll_details: !0
    }, l;
  }

  return t$1(r, n), r;
}(Ne$2),
    ut$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.message = n ? We$1(e, n$1({}, n)) : null, r;
  }

  return t$1(n, t), n;
}(Te$2),
    ct$1 = function (n) {
  function i(e) {
    var i = e.channelType,
        s = e.channelUrl,
        o = e.timestamp,
        u = e.token,
        c = e.prevResultSize,
        l = e.nextResultSize,
        d = e.isInclusive,
        h = e.reverse,
        f = e.messageTypeFilter,
        p = e.customTypesFilter,
        m = e.senderUserIdsFilter,
        v = e.replyType,
        y = e.includeMetaArray,
        _ = e.includeReactions,
        g = e.parentMessageId,
        b = e.includeThreadInfo,
        I = e.includeParentMessageInfo,
        E = e.showSubchannelMessagesOnly,
        T = e.checkingContinuousMessages,
        w = n.call(this) || this;
    return w.method = ee.GET, w.path = "".concat(ge$1(i), "/").concat(encodeURIComponent(s), "/messages"), w.params = J($({
      is_sdk: !0,
      prev_limit: c,
      next_limit: l,
      include: d,
      reverse: h,
      message_ts: o,
      message_id: u,
      message_type: null != f ? f : null,
      custom_types: p,
      sender_ids: m,
      include_reply_type: v,
      with_sorted_meta_array: y,
      include_reactions: _,
      parent_message_id: g,
      include_thread_info: b,
      include_parent_message_info: I,
      show_subchannel_message_only: E,
      include_poll_details: !0,
      checking_continuous_messages: T
    })), w;
  }

  return t$1(i, n), i;
}(Ne$2),
    lt$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.messages = n.messages.map(function (t) {
      return We$1(e, t);
    }), r;
  }

  return t$1(n, t), n;
}(Te$2),
    dt$1 = function (n) {
  function r(e) {
    var r = e.channelType,
        i = e.channelUrl,
        s = e.timestamp,
        a = e.token,
        o = e.replyType,
        u = e.includeMetaArray,
        c = e.includeReactions,
        l = e.includeThreadInfo,
        d = e.includeParentMessageInfo,
        h = n.call(this) || this;
    return h.method = ee.GET, h.path = "".concat(ge$1(r), "/").concat(encodeURIComponent(i), "/messages/changelogs"), h.params = {
      change_ts: s,
      token: a,
      with_sorted_meta_array: u,
      include_reactions: c,
      include_thread_info: l,
      include_reply_type: o,
      include_parent_message_info: d,
      include_poll_details: !0
    }, h;
  }

  return t$1(r, n), r;
}(Ne$2),
    ht$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.updatedMessages = n.updated.map(function (t) {
      return We$1(e, t);
    }), r.deletedMessagesInfo = n.deleted.map(function (e) {
      return {
        messageId: e.message_id,
        deletedAt: e.deleted_at
      };
    }), r.hasMore = n.has_more, r.nextToken = n.next, r;
  }

  return t$1(n, t), n;
}(Te$2),
    ft$1 = function (n) {
  function r(e) {
    var r = e.channelUrl,
        i = e.scheduledMessageId,
        s = n.call(this) || this;
    return s.method = ee.GET, s.path = "".concat(ie, "/").concat(encodeURIComponent(r), "/scheduled_messages/").concat(encodeURIComponent(i)), s.params = {}, s;
  }

  return t$1(r, n), r;
}(Ne$2),
    pt$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.message = n ? We$1(e, n$1({}, n)) : null, r;
  }

  return t$1(n, t), n;
}(Te$2);

!function (e) {
  e.MUTED = "muted", e.BANNED = "banned";
}(nt || (nt = {}));

var mt$1,
    vt$1 = function () {
  function e(e) {
    var t, n, r, i;
    this.restrictionType = null, N$1(nt, e.restriction_type) && (this.restrictionType = e.restriction_type), this.description = null !== (t = e.description) && void 0 !== t ? t : null, this.endAt = null !== (r = null !== (n = e.end_at) && void 0 !== n ? n : e.muted_end_at) && void 0 !== r ? r : -1, this.remainingDuration = null !== (i = e.remaining_duration) && void 0 !== i ? i : -1;
  }

  return e.payloadify = function (e) {
    return J($({
      restriction_type: e.restrictionType,
      description: e.description,
      end_at: e.endAt,
      remaining_duration: e.remainingDuration
    }));
  }, e;
}(),
    yt$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.restrictionInfo = new vt$1(n), r;
  }

  return t$1(n, t), n.payloadify = function (e) {
    return J($(n$1(n$1({}, t.payloadify.call(this, e)), vt$1.payloadify(e.restrictionInfo))));
  }, n;
}(Xi$1),
    _t$1 = function (t) {
  function n(e, n) {
    var r,
        i = this;
    return (i = t.call(this, e, n) || this).isMuted = !1, i.isMuted = null !== (r = n.is_muted) && void 0 !== r && r, i;
  }

  return t$1(n, t), n;
}(Xi$1),
    gt$1 = function () {
  function e() {
    this._onPending = ze$2, this._onFailed = ze$2, this._onSucceeded = ze$2;
  }

  return e.prototype._trigger = function (e) {
    switch (null == e ? void 0 : e.sendingStatus) {
      case q.PENDING:
        0 === e.errorCode && this._onPending(e);
        break;

      case q.SCHEDULED:
      case q.SUCCEEDED:
        this._onSucceeded(e);

    }
  }, e.prototype._triggerFailed = function (e, t) {
    switch (null == t ? void 0 : t.sendingStatus) {
      case q.FAILED:
      case q.CANCELED:
        this._onFailed(e, t.scheduledInfo ? null : t);

    }
  }, e.prototype.onPending = function (e) {
    return this._onPending = e, this;
  }, e.prototype.onFailed = function (e) {
    return this._onFailed = e, this;
  }, e.prototype.onSucceeded = function (e) {
    return this._onSucceeded = e, this;
  }, e;
}(),
    bt$1 = {
  data: void 0,
  customType: void 0,
  mentionType: H$1.USERS,
  mentionedUserIds: void 0,
  mentionedUsers: void 0,
  mentionedMessageTemplate: void 0,
  metaArrays: void 0,
  parentMessageId: void 0,
  isReplyToChannel: !1,
  pushNotificationDeliveryOption: void 0,
  appleCriticalAlertOptions: void 0,
  isPinnedMessage: !1
},
    It$2 = function (e) {
  return w$1("string", e.data, !0) && w$1("string", e.customType, !0) && N$1(H$1, e.mentionType) && S$2("string", e.mentionedUserIds, !0) && S$2(Xi$1, e.mentionedUsers, !0) && w$1("string", e.mentionedMessageTemplate, !0) && S$2(Oe$2, e.metaArrays, !0) && w$1("number", e.parentMessageId, !0) && w$1("boolean", e.isReplyToChannel) && N$1(G, e.pushNotificationDeliveryOption, !0) && w$1(ke, e.appleCriticalAlertOptions, !0) && w$1("boolean", e.isPinnedMessage, !0);
},
    Et$1 = function (e) {
  return {
    isReplyToChannel: e.isReplyToChannel,
    pushNotificationDeliveryOption: e.pushNotificationDeliveryOption,
    pollId: e.pollId
  };
},
    Tt$2 = n$1(n$1({}, bt$1), {
  message: "",
  translationTargetLanguages: void 0,
  pollId: void 0
}),
    wt$2 = function (e) {
  return It$2(e) && w$1("string", e.message) && S$2("string", e.translationTargetLanguages, !0) && w$1("number", e.pollId, !0);
};

!function (e) {
  e.FILE = "file", e.BLOB = "blob", e.BLOB_LIKE_OBJECT = "blobLikeObject", e.URL = "url";
}(mt$1 || (mt$1 = {}));

var Mt$1,
    St$2 = function (e) {
  return "undefined" != typeof window && "Blob" in window && "undefined" != typeof Blob && e instanceof Blob;
},
    At$2 = function (e) {
  return e === mt$1.BLOB || e === mt$1.FILE;
},
    Nt$2 = function (e) {
  return {
    file: e.file,
    fileKey: e.fileKey,
    fileType: e.fileType,
    isReplyToChannel: e.isReplyToChannel,
    pushNotificationDeliveryOption: e.pushNotificationDeliveryOption
  };
},
    Ut$2 = n$1(n$1({}, bt$1), {
  file: void 0,
  fileKey: void 0,
  fileUrl: void 0,
  fileName: void 0,
  fileType: void 0,
  fileSize: void 0,
  mimeType: void 0,
  thumbnailSizes: void 0,
  requireAuth: !1
}),
    Ot$2 = function (e) {
  return It$2(e) && (k(e.file) || w$1("string", e.fileUrl)) && w$1("string", e.fileName, !0) && w$1("string", e.mimeType, !0) && w$1("number", e.fileSize, !0) && (null === e.thumbnailSizes || void 0 === e.thumbnailSizes || Array.isArray(e.thumbnailSizes) && e.thumbnailSizes.every(function (e) {
    return w$1("object", e) && e.maxWidth > 0 && e.maxHeight > 0;
  }));
},
    Ct$1 = {
  data: void 0,
  customType: void 0,
  mentionType: H$1.USERS,
  mentionedUserIds: void 0,
  mentionedUsers: void 0,
  mentionedMessageTemplate: void 0,
  metaArrays: void 0,
  pushNotificationDeliveryOption: void 0,
  appleCriticalAlertOptions: void 0
},
    Pt$2 = function (e) {
  return w$1("string", e.data, !0) && w$1("string", e.customType, !0) && N$1(H$1, e.mentionType) && S$2("string", e.mentionedUserIds, !0) && S$2(Xi$1, e.mentionedUsers, !0) && w$1("string", e.mentionedMessageTemplate, !0) && S$2(Oe$2, e.metaArrays, !0) && N$1(G, e.pushNotificationDeliveryOption, !0) && w$1(ke, e.appleCriticalAlertOptions, !0);
},
    kt$2 = n$1(n$1({}, Ct$1), {
  message: void 0,
  translationTargetLanguages: void 0,
  pollId: void 0
}),
    Rt$2 = function (e) {
  return Pt$2(e) && w$1("string", e.message, !0) && S$2("string", e.translationTargetLanguages, !0) && w$1("number", e.pollId, !0);
},
    xt$2 = n$1({}, Ct$1),
    Lt$2 = function (n) {
  function r(e) {
    var r = e.channelUrl,
        i = e.channelType,
        s = e.token,
        a = e.limit,
        o = n.call(this) || this;
    return o.method = ee.GET, o.path = "".concat(ge$1(i), "/").concat(encodeURIComponent(r), "/operators"), o.params = {
      token: s,
      limit: a
    }, o;
  }

  return t$1(r, n), r;
}(Ne$2),
    Dt$2 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.operators = n.operators.map(function (t) {
      return new Xi$1(e, t);
    }), r.token = n.next, r;
  }

  return t$1(n, t), n;
}(Te$2),
    qt$2 = function (t) {
  function n(e, n, r, i) {
    return t.call(this, e, n, r, i) || this;
  }

  return t$1(n, t), n.prototype._validate = function () {
    return t.prototype._validate.call(this);
  }, n.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s, a;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : (e = [], this._hasNext ? (this._isLoading = !0, t = _o.of(this._iid).requestQueue, n = new Lt$2(n$1(n$1({}, this), {
              channelUrl: this.channelUrl,
              token: this._token
            })), [4, t.send(n)]) : [3, 2]) : [3, 5];

          case 1:
            return r = u.sent(), i = r.as(Dt$2), s = i.operators, a = i.token, this._token = a, this._hasNext = !!a, this._isLoading = !1, [2, s];

          case 2:
            return [2, e];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, n;
}(Io),
    Ft$2 = function (t) {
  function n(e, n, r, i) {
    var s,
        a,
        o,
        u,
        c,
        l,
        d,
        h,
        f,
        p,
        m = this;
    return (m = t.call(this, e, n, r, i) || this).reverse = !1, m.messageTypeFilter = z.ALL, m.customTypesFilter = null, m.senderUserIdsFilter = null, m.replyType = V.NONE, m.includeMetaArray = !1, m.includeReactions = !1, m.includeParentMessageInfo = !1, m.includeThreadInfo = !1, m.showSubchannelMessagesOnly = !1, m._edge = Number.MAX_SAFE_INTEGER, m.reverse = null !== (s = i.reverse) && void 0 !== s && s, m.messageTypeFilter = null !== (a = i.messageTypeFilter) && void 0 !== a ? a : z.ALL, m.customTypesFilter = null !== (o = i.customTypesFilter) && void 0 !== o ? o : null, m.senderUserIdsFilter = null !== (u = i.senderUserIdsFilter) && void 0 !== u ? u : null, m.replyType = null !== (c = i.replyType) && void 0 !== c ? c : V.NONE, m.includeMetaArray = null !== (l = i.includeMetaArray) && void 0 !== l && l, m.includeReactions = null !== (d = i.includeReactions) && void 0 !== d && d, m.includeParentMessageInfo = null !== (h = i.includeParentMessageInfo) && void 0 !== h && h, m.includeThreadInfo = null !== (f = i.includeThreadInfo) && void 0 !== f && f, m.showSubchannelMessagesOnly = null !== (p = i.showSubchannelMessagesOnly) && void 0 !== p && p, m;
  }

  return t$1(n, t), n.prototype._validate = function () {
    return t.prototype._validate.call(this) && w$1("boolean", this.reverse) && N$1(z, this.messageTypeFilter) && N$1(V, this.replyType) && S$2("string", this.customTypesFilter, !0) && S$2("string", this.senderUserIdsFilter, !0) && w$1("boolean", this.includeMetaArray) && w$1("boolean", this.includeReactions) && w$1("boolean", this.includeParentMessageInfo) && w$1("boolean", this.includeThreadInfo) && w$1("boolean", this.showSubchannelMessagesOnly);
  }, n.prototype.load = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, [4, Zi.of(this._iid).getMessagesByTimestamp(this.channelUrl, this.channelType, this._edge, $({
              prevResultSize: this.limit,
              nextResultSize: 0,
              isInclusive: !1,
              reverse: this.reverse,
              messageTypeFilter: this.messageTypeFilter,
              customTypesFilter: this.customTypesFilter,
              replyType: this.replyType,
              senderUserIdsFilter: this.senderUserIdsFilter,
              includeReactions: this.includeReactions,
              includeMetaArray: this.includeMetaArray,
              includeParentMessageInfo: this.includeParentMessageInfo,
              includeThreadInfo: this.includeThreadInfo,
              showSubchannelMessagesOnly: this.showSubchannelMessagesOnly
            }))]) : [3, 2] : [3, 5];

          case 1:
            return e = t.sent(), this._edge = Math.min.apply(Math, c$1([Number.MAX_SAFE_INTEGER], a$1(e.map(function (e) {
              return e.createdAt;
            })), !1)), this._hasNext = e.length >= this.limit, this._isLoading = !1, [2, e];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, n;
}(Io),
    zt$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.limit,
        o = e.token;
    return (r = n.call(this) || this).method = ee.GET, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/mute"), r.params = {
      limit: a,
      token: o
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    Bt$2 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    r.mutedUsers = [];
    var i = n.next,
        s = n.muted_list;
    return r.token = i, s && s.length > 0 && (r.mutedUsers = s.map(function (t) {
      return new yt$1(e, t);
    })), r;
  }

  return t$1(n, t), n;
}(Te$2),
    Kt$2 = function (t) {
  function n(e, n, r, i) {
    return t.call(this, e, n, r, i) || this;
  }

  return t$1(n, t), n.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, t = new zt$2(n$1(n$1({}, this), {
              token: this._token
            })), [4, e.send(t)]) : [3, 2] : [3, 5];

          case 1:
            return n = a.sent(), r = n.as(Bt$2), i = r.mutedUsers, s = r.token, this._token = s, this._hasNext = !!s, this._isLoading = !1, [2, i];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, n;
}(Io),
    jt$2 = function (n) {
  function i(e) {
    var i = this,
        s = e.channelUrl,
        a = e.channelType,
        o = e.limit,
        u = e.token;
    return (i = n.call(this) || this).method = ee.GET, i.path = "".concat(ge$1(a), "/").concat(encodeURIComponent(s), "/ban"), i.params = J({
      limit: o,
      token: u
    }), i;
  }

  return t$1(i, n), i;
}(Ne$2),
    Qt$2 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    r.bannedUsers = [];
    var i = n.next,
        s = n.banned_list;
    return r.token = i, s && s.length > 0 && (r.bannedUsers = s.map(function (t) {
      return new yt$1(e, t.user);
    })), r;
  }

  return t$1(n, t), n;
}(Te$2),
    Gt$2 = function (t) {
  function n(e, n, r, i) {
    return t.call(this, e, n, r, i) || this;
  }

  return t$1(n, t), n.prototype._validate = function () {
    return t.prototype._validate.call(this);
  }, n.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, t = new jt$2(n$1(n$1({}, this), {
              token: this._token
            })), [4, e.send(t)]) : [3, 2] : [3, 5];

          case 1:
            return n = a.sent(), r = n.as(Qt$2), i = r.bannedUsers, s = r.token, this._token = s, this._hasNext = !!s, this._isLoading = !1, [2, i];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, n;
}(Io);

!function (e) {
  e.SPAM = "spam", e.HARASSING = "harassing", e.SUSPICIOUS = "suspicious", e.INAPPROPRIATE = "inappropriate";
}(Mt$1 || (Mt$1 = {}));

var Vt$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.operatorUserIds;
    return (r = n.call(this) || this).method = ee.POST, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/operators"), r.params = {
      operator_ids: a
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var Wt$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.operatorUserIds;
    return (r = n.call(this) || this).method = ee.DELETE, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/operators"), r.params = {
      operator_ids: a
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n(e, n) {
    return t.call(this, e, n) || this;
  }

  t$1(n, t);
}(Te$2);

var Ht$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.userId;
    return (r = n.call(this) || this).method = ee.GET, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/mute/").concat(a), r;
  }

  return t$1(r, n), r;
}(Ne$2),
    Yt$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    r.isMuted = !1, r.startAt = 0, r.endAt = 0;
    var i = n.is_muted,
        s = n.start_at,
        a = n.end_at,
        o = n.remaining_duration,
        u = n.description;
    return r.isMuted = i, r.startAt = s, r.endAt = a, r.remainingDuration = o, r.description = u, r;
  }

  return t$1(n, t), n;
}(Te$2),
    Jt$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.keys;
    return (r = n.call(this) || this).method = ee.GET, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/metadata"), r.params = {
      keys: a,
      include_ts: !0
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    Xt$2 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this,
        i = n.metadata,
        s = n.ts;
    return r.metadata = i, r.ts = s, r;
  }

  return t$1(n, t), n;
}(Te$2),
    Zt$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.metadata;
    return (r = n.call(this) || this).method = ee.POST, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/metadata"), r.params = {
      metadata: a,
      include_ts: !0
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    $t$2 = function (t) {
  function n(e, n) {
    var r,
        i,
        s = this;
    return (s = t.call(this, e, n) || this).metaData = null !== (r = n.metadata) && void 0 !== r ? r : {}, s.ts = null !== (i = n.ts) && void 0 !== i ? i : null, s;
  }

  return t$1(n, t), n;
}(Te$2),
    en$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.metadata,
        o = e.upsert;
    return (r = n.call(this) || this).method = ee.PUT, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/metadata"), r.params = {
      metadata: a,
      include_ts: !0,
      upsert: null != o && o
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    tn$2 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this,
        i = n.metadata,
        s = n.ts;
    return r.metadata = i, r.ts = s, r;
  }

  return t$1(n, t), n;
}(Te$2),
    nn$2 = function (t) {
  function n(e, n, r) {
    var i = t.call(this, e, "SYEV", r) || this;
    return r.data && (i.created = r.data.created, i.updated = r.data.updated, i.deleted = r.data.deleted), i;
  }

  return t$1(n, t), n;
}(Pe$3),
    rn$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.key;
    return (r = n.call(this) || this).method = ee.DELETE, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/metadata/").concat(a), r.params = {
      include_ts: !0
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    sn$2 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this,
        i = n.ts;
    return r.ts = i, r;
  }

  return t$1(n, t), n;
}(Te$2),
    an$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType;
    return (r = n.call(this) || this).method = ee.DELETE, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/metadata"), r.params = {
      include_ts: !0
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    on$2 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this,
        i = n.ts;
    return r.ts = i, r;
  }

  return t$1(n, t), n;
}(Te$2),
    un$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.keys;
    return (r = n.call(this) || this).method = ee.GET, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/metacounter"), r.params = {
      keys: a
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    cn$2 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.metaCounter = n, r;
  }

  return t$1(n, t), n;
}(Te$2),
    ln$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.metaCounter;
    return (r = n.call(this) || this).method = ee.POST, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/metacounter"), r.params = {
      metacounter: a
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    dn$2 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.metaCounter = n, r;
  }

  return t$1(n, t), n;
}(Te$2),
    hn$2 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.metaCounter,
        o = e.upsert,
        u = void 0 !== o && o,
        c = e.mode,
        l = void 0 === c ? "set" : c;
    return (r = n.call(this) || this).method = ee.PUT, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/metacounter"), r.params = {
      metacounter: a,
      upsert: u,
      mode: l
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    fn$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.metaCounter = n, r;
  }

  return t$1(n, t), n;
}(Te$2),
    pn$1 = function (t) {
  function n(e, n, r) {
    var i = t.call(this, e, "SYEV", r) || this;
    return r.data && (i.created = r.data.created, i.updated = r.data.updated, i.deleted = r.data.deleted), i;
  }

  return t$1(n, t), n;
}(Pe$3),
    mn$1 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.key;
    return (r = n.call(this) || this).method = ee.DELETE, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/metacounter/").concat(a), r.params = {}, r;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n(e, n) {
    return t.call(this, e, n) || this;
  }

  t$1(n, t);
}(Te$2);

var vn$1 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType;
    return (r = n.call(this) || this).method = ee.DELETE, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/metacounter"), r.params = {}, r;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var yn$1 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.userId,
        o = e.seconds,
        u = e.description;
    return (r = n.call(this) || this).method = ee.POST, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/mute"), r.params = {
      user_id: a,
      seconds: o,
      description: u
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n(e, n) {
    return t.call(this, e, n) || this;
  }

  t$1(n, t);
}(Te$2);

var _n$1 = function (t) {
  function n(e, n, r) {
    var i = t.call(this, e, "SYEV", r) || this;
    return i.user = new yt$1(e, r.data), i;
  }

  return t$1(n, t), n;
}(Pe$3),
    gn$1 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.userId;
    return (r = n.call(this) || this).method = ee.DELETE, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/mute/").concat(encodeURIComponent(a)), r;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var bn$1 = function (t) {
  function n(e, n, r) {
    var i = t.call(this, e, "SYEV", r) || this;
    return i.user = new yt$1(e, r.data), i;
  }

  return t$1(n, t), n;
}(Pe$3),
    In$1 = function (n) {
  function i(e) {
    var i = this,
        s = e.channelUrl,
        a = e.channelType,
        o = e.userId,
        u = e.seconds,
        c = e.description;
    return (i = n.call(this) || this).method = ee.POST, i.path = "".concat(ge$1(a), "/").concat(encodeURIComponent(s), "/ban"), i.params = J({
      user_id: o,
      seconds: u,
      description: c
    }), i;
  }

  return t$1(i, n), i;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var En$1 = function (t) {
  function n(e, n, r) {
    var i = t.call(this, e, "SYEV", r) || this;
    return i.user = new yt$1(e, r.data), r.data.member_count && (i.memberCount = r.data.member_count), r.data.joined_member_count && (i.joinedMemberCount = r.data.joined_member_count), i;
  }

  return t$1(n, t), n;
}(Pe$3),
    Tn$1 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.userId;
    return (r = n.call(this) || this).method = ee.DELETE, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/ban/").concat(encodeURIComponent(a)), r;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var wn$1 = function (t) {
  function n(e, n, r) {
    var i = t.call(this, e, "SYEV", r) || this;
    return i.user = new yt$1(e, r.data), i;
  }

  return t$1(n, t), n;
}(Pe$3),
    Mn$1 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.freezing;
    return (r = n.call(this) || this).method = ee.PUT, r.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(i), "/freeze"), r.params = {
      freeze: a
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var Sn$1 = function (t) {
  function n(e, n, r) {
    var i = t.call(this, e, "SYEV", r) || this;
    return i.freeze = r.data.freeze, i;
  }

  return t$1(n, t), n;
}(Pe$3),
    An$1 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.category,
        o = e.userId,
        u = e.description;
    return (r = n.call(this) || this).method = ee.POST, r.path = "".concat(ve$1(s), "/").concat(encodeURIComponent(i)), r.params = {
      report_category: a,
      reporting_user_id: o,
      report_description: u
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    Nn$1 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.category,
        o = e.userId,
        u = e.offendingUserId,
        c = e.description;
    return (r = n.call(this) || this).method = ee.POST, r.path = "".concat(ue, "/users/").concat(u), r.params = {
      channel_url: i,
      channel_type: s === x.OPEN ? "open_channels" : "group_channels",
      report_category: a,
      reporting_user_id: o,
      report_description: c
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    Un$1 = function (n) {
  function r(e) {
    var r = this,
        i = e.channelUrl,
        s = e.channelType,
        a = e.category,
        o = e.userId,
        u = e.offendingUserId,
        c = e.messageId,
        l = e.description;
    return (r = n.call(this) || this).method = ee.POST, r.path = "".concat(ve$1(s), "/").concat(encodeURIComponent(i), "/messages/").concat(c), r.params = {
      report_category: a,
      reporting_user_id: o,
      report_description: l,
      offending_user_id: u
    }, r;
  }

  return t$1(r, n), r;
}(Ne$2),
    On$1 = function (t) {
  function n(e) {
    var n = [];
    return e.mentionType === H$1.USERS && (e.mentionedUserIds ? n = e.mentionedUserIds : e.mentionedUsers && (n = e.mentionedUsers.map(function (e) {
      return e.userId;
    }))), t.call(this, {
      code: "MESG",
      ackRequired: !0,
      payload: J($({
        channel_url: e.channelUrl,
        message: e.message,
        data: e.data,
        custom_type: e.customType,
        metaarray: e.metaArrays,
        mention_type: e.mentionType,
        mentioned_user_ids: n,
        mentioned_message_template: e.mentionedMessageTemplate,
        target_langs: e.translationTargetLanguages,
        push_option: e.pushNotificationDeliveryOption && e.pushNotificationDeliveryOption !== G.DEFAULT ? e.pushNotificationDeliveryOption : void 0,
        apple_critical_alert_options: e.appleCriticalAlertOptions,
        silent: e.silent,
        reply_to_channel: e.isReplyToChannel,
        parent_message_id: e.parentMessageId ? e.parentMessageId : null,
        req_id: e.reqId,
        poll_id: e.pollId,
        pin_message: e.isPinnedMessage
      }))
    }) || this;
  }

  return t$1(n, t), n;
}(ri$1),
    Cn$1 = function (t) {
  function n(e, n, r) {
    var i,
        s,
        a,
        o,
        u = this;
    (u = t.call(this, e, "MESG", r) || this).message = new je$1(e, r);
    var c = _o.of(e).sdkState;
    return u.isMentioned = be$1(u.message.mentionType, null !== (a = null !== (i = u.message.mentionedUserIds) && void 0 !== i ? i : null === (s = u.message.mentionedUsers) || void 0 === s ? void 0 : s.map(function (e) {
      return e.userId;
    })) && void 0 !== a ? a : [], c.userId), u.forceUpdateLastMessage = null !== (o = r.force_update_last_message) && void 0 !== o && o, u;
  }

  return t$1(n, t), n;
}(Pe$3),
    Pn$1 = function (t) {
  function n(e) {
    var n = null;
    return e.mentionType === H$1.USERS && (e.mentionedUserIds ? n = e.mentionedUserIds : e.mentionedUsers && (n = e.mentionedUsers.map(function (e) {
      return e.userId;
    }))), t.call(this, {
      code: "MEDI",
      ackRequired: !0,
      payload: J($({
        channel_url: e.channelUrl,
        msg_id: e.messageId,
        message: e.message,
        data: e.data,
        custom_type: e.customType,
        metaarray: e.metaArrayParams,
        mention_type: e.mentionType,
        mentioned_user_ids: n,
        mentioned_message_template: e.mentionedMessageTemplate,
        apple_critical_alert_options: e.appleCriticalAlertOptions ? ke.payloadify(e.appleCriticalAlertOptions) : null,
        poll_id: e.pollId
      }))
    }) || this;
  }

  return t$1(n, t), n;
}(ri$1),
    kn$1 = function (t) {
  function n(e, n, r) {
    var i,
        s,
        o,
        u,
        c,
        l = this;
    (l = t.call(this, e, "MEDI", r) || this).message = new je$1(e, r);
    var d = _o.of(e).sdkState;
    return l.mentionCountChange = me$1({
      mentionType: null === (i = r.old_values) || void 0 === i ? void 0 : i.mention_type,
      mentionedUserIds: null !== (o = null === (s = r.old_values) || void 0 === s ? void 0 : s.mentioned_user_ids) && void 0 !== o ? o : []
    }, $({
      mentionType: l.message.mentionType,
      mentionedUserIds: null !== (u = l.message.mentionedUserIds) && void 0 !== u ? u : null === (c = l.message.mentionedUsers) || void 0 === c ? void 0 : c.map(function (e) {
        return e.userId;
      })
    }), d.userId), l;
  }

  return t$1(n, t), n;
}(Pe$3),
    Rn$1 = function (t) {
  function n(e) {
    var n = null;
    return e.mentionType === H$1.USERS && (e.mentionedUserIds ? n = e.mentionedUserIds : e.mentionedUsers && (n = e.mentionedUsers.map(function (e) {
      return e.userId;
    }))), t.call(this, {
      code: "FEDI",
      ackRequired: !0,
      payload: J($({
        channel_url: e.channelUrl,
        msg_id: e.messageId,
        data: e.data,
        custom_type: e.customType,
        metaarray: e.metaArrayParams,
        mention_type: e.mentionType,
        mentioned_user_ids: n,
        apple_critical_alert_options: e.appleCriticalAlertOptions
      }))
    }) || this;
  }

  return t$1(n, t), n;
}(ri$1),
    xn$1 = function (t) {
  function n(e, n, r) {
    var i,
        s,
        o,
        u,
        c,
        l = this;
    (l = t.call(this, e, "FEDI", r) || this).message = new He$2(e, r);
    var d = _o.of(e).sdkState;
    return l.mentionCountChange = me$1({
      mentionType: null === (i = r.old_values) || void 0 === i ? void 0 : i.mention_type,
      mentionedUserIds: null !== (o = null === (s = r.old_values) || void 0 === s ? void 0 : s.mentioned_user_ids) && void 0 !== o ? o : []
    }, $({
      mentionType: l.message.mentionType,
      mentionedUserIds: null !== (u = l.message.mentionedUserIds) && void 0 !== u ? u : null === (c = l.message.mentionedUsers) || void 0 === c ? void 0 : c.map(function (e) {
        return e.userId;
      })
    }), d.userId), l;
  }

  return t$1(n, t), n;
}(Pe$3),
    Ln$1 = function (n) {
  function r(e) {
    var r = n.call(this) || this;
    return r.method = ee.DELETE, r.path = "".concat(ge$1(e.channelType), "/").concat(e.channelUrl, "/messages/").concat(e.messageId), r;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var Dn$1 = function (t) {
  function n(e, n, r) {
    var i = t.call(this, e, "DELM", r) || this;
    return i.channelUrl = r.channel_url, i.channelType = r.channel_type, i.messageId = Number(r.msg_id), i;
  }

  return t$1(n, t), n;
}(Pe$3),
    qn$1 = function (n) {
  function r(e) {
    var r = e.channelType,
        i = e.channelUrl,
        s = e.messageId,
        a = e.reactionKey,
        o = n.call(this) || this;
    return o.method = ee.POST, o.path = "".concat(ge$1(r), "/").concat(encodeURIComponent(i), "/messages/").concat(s, "/reactions"), o.params = {
      reaction: a
    }, o;
  }

  return t$1(r, n), r;
}(Ne$2),
    Fn$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.reactionEvent = new Ne$1(n), r;
  }

  return t$1(n, t), n;
}(Te$2),
    zn$1 = function (n) {
  function r(e) {
    var r = e.channelType,
        i = e.channelUrl,
        s = e.messageId,
        a = e.reactionKey,
        o = n.call(this) || this;
    return o.method = ee.DELETE, o.path = "".concat(ge$1(r), "/").concat(encodeURIComponent(i), "/messages/").concat(s, "/reactions"), o.params = {
      reaction: a
    }, o;
  }

  return t$1(r, n), r;
}(Ne$2),
    Bn$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.reactionEvent = new Ne$1(n$1({}, n)), r;
  }

  return t$1(n, t), n;
}(Te$2),
    Kn$1 = function (n) {
  function r(e) {
    var r = e.channelType,
        i = e.channelUrl,
        s = e.messageId,
        a = e.translationTargetLanguages,
        o = n.call(this) || this;
    return o.method = ee.POST, o.path = "".concat(ge$1(r), "/").concat(encodeURIComponent(i), "/messages/").concat(encodeURIComponent(s), "/translation"), o.params = {
      target_langs: a
    }, o;
  }

  return t$1(r, n), r;
}(Ne$2),
    jn$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.message = new je$1(e, n), r;
  }

  return t$1(n, t), n;
}(Te$2),
    Qn$1 = function (n) {
  function i(e) {
    var i,
        s = this;
    s = n.call(this) || this;
    var o = [];
    e.mentionType === H$1.USERS && (e.mentionedUserIds ? o = e.mentionedUserIds : e.mentionedUsers && (o = e.mentionedUsers.map(function (e) {
      return e.userId;
    })));
    var u = e.channelType,
        c = e.channelUrl;
    return s.method = ee.POST, s.path = "".concat(ge$1(u), "/").concat(encodeURIComponent(c), "/scheduled_messages"), s.params = J($({
      req_id: e.reqId,
      scheduled_at: e.scheduledAt,
      message_type: F.USER,
      message: e.message,
      custom_type: e.customType,
      data: e.data,
      mention_type: e.mentionType,
      mentioned_user_ids: o,
      sorted_metaarray: null === (i = e.metaArrays) || void 0 === i ? void 0 : i.map(function (e) {
        return Oe$2.payloadify(e);
      }),
      apple_critical_alert_options: e.appleCriticalAlertOptions ? ke.payloadify(e.appleCriticalAlertOptions) : null,
      target_langs: e.translationTargetLanguages,
      push_option: e.pushNotificationDeliveryOption
    })), s;
  }

  return t$1(i, n), i;
}(Ne$2),
    Gn$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.message = new je$1(e, n), r;
  }

  return t$1(n, t), n;
}(Te$2),
    Vn$1 = function (n) {
  function r(e) {
    var r,
        i = this;
    i = n.call(this) || this;
    var s = [];
    e.mentionType === H$1.USERS && (e.mentionedUserIds ? s = e.mentionedUserIds : e.mentionedUsers && (s = e.mentionedUsers.map(function (e) {
      return e.userId;
    })));
    var o = e.channelType,
        u = e.channelUrl;
    return i.method = ee.POST, i.path = "".concat(ge$1(o), "/").concat(encodeURIComponent(u), "/scheduled_messages"), i.params = $({
      req_id: e.reqId,
      scheduled_at: e.scheduledAt,
      message_type: F.FILE,
      url: e.fileUrl,
      file_name: e.fileName,
      file_size: e.fileSize,
      file_type: e.mimeType,
      thumbnails: e.thumbnailSizes ? e.thumbnailSizes.map(function (e) {
        return qe$1.payloadify(e);
      }) : [],
      custom_type: e.customType,
      data: e.data,
      require_auth: e.requireAuth,
      mention_type: e.mentionType,
      mentioned_user_ids: s,
      sorted_metaarray: null === (r = e.metaArrays) || void 0 === r ? void 0 : r.map(function (e) {
        return Oe$2.payloadify(e);
      }),
      apple_critical_alert_options: e.appleCriticalAlertOptions ? ke.payloadify(e.appleCriticalAlertOptions) : null,
      push_option: e.pushNotificationDeliveryOption
    }), i;
  }

  return t$1(r, n), r;
}(Ne$2),
    Wn$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.message = new He$2(e, n), r;
  }

  return t$1(n, t), n;
}(Te$2),
    Hn$1 = function (n) {
  function r(e) {
    var r = e.pollId,
        i = e.title,
        s = e.data,
        a = e.allowUserSuggestion,
        o = e.allowMultipleVotes,
        u = e.closeAt,
        c = n.call(this) || this;
    return c.method = ee.PUT, c.path = "".concat(de$1, "/").concat(encodeURIComponent(r)), c.params = {
      title: i,
      data: s,
      allow_user_suggestion: a,
      allow_multiple_votes: o,
      close_at: u
    }, c;
  }

  return t$1(r, n), r;
}(Ne$2),
    Yn$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.poll = new mo(e, n), r;
  }

  return t$1(n, t), n;
}(Te$2),
    Jn$1 = function (n) {
  function r(e) {
    var r = e.pollId,
        i = n.call(this) || this;
    return i.method = ee.DELETE, i.path = "".concat(de$1, "/").concat(encodeURIComponent(r)), i;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var Xn$1 = function (n) {
  function r(e) {
    var r = e.pollId,
        i = n.call(this) || this;
    return i.method = ee.PUT, i.path = "".concat(de$1, "/").concat(encodeURIComponent(r), "/close"), i;
  }

  return t$1(r, n), r;
}(Ne$2),
    Zn$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.poll = new mo(e, n), r;
  }

  return t$1(n, t), n;
}(Te$2),
    $n$1 = function (n) {
  function r(e) {
    var r = e.channelUrl,
        i = e.channelType,
        s = e.pollId,
        a = e.optionText,
        o = n.call(this) || this;
    return o.method = ee.POST, o.path = "".concat(de$1, "/").concat(encodeURIComponent(s), "/options"), o.params = {
      channel_url: r,
      channel_type: i,
      text: a
    }, o;
  }

  return t$1(r, n), r;
}(Ne$2),
    er$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.poll = new mo(e, n), r;
  }

  return t$1(n, t), n;
}(Te$2),
    tr$1 = function (n) {
  function r(e) {
    var r = e.pollId,
        i = e.pollOptionId,
        s = e.optionText,
        a = n.call(this) || this;
    return a.method = ee.PUT, a.path = "".concat(de$1, "/").concat(encodeURIComponent(r), "/options/").concat(encodeURIComponent(i)), a.params = {
      text: s
    }, a;
  }

  return t$1(r, n), r;
}(Ne$2),
    nr$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.poll = new mo(e, n), r;
  }

  return t$1(n, t), n;
}(Te$2),
    rr = function (n) {
  function r(e) {
    var r = e.pollId,
        i = e.pollOptionId,
        s = n.call(this) || this;
    return s.method = ee.DELETE, s.path = "".concat(de$1, "/").concat(encodeURIComponent(r), "/options/").concat(encodeURIComponent(i)), s;
  }

  return t$1(r, n), r;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var ir,
    sr$1 = function (t) {
  function n(e) {
    var n = e.reqId,
        i = e.channelType,
        s = e.channelUrl,
        a = e.pollId,
        o = e.pollOptionIds;
    return t.call(this, {
      code: "VOTE",
      ackRequired: !0,
      payload: J({
        req_id: n,
        channel_type: i === x.OPEN ? "open_channels" : "group_channels",
        channel_url: s,
        poll_id: a,
        option_ids: o
      })
    }) || this;
  }

  return t$1(n, t), n;
}(ri$1),
    ar = function (t) {
  function n(e, n, r) {
    var i = t.call(this, e, "VOTE", r) || this;
    return i.event = new Ro(r), i.channelUrl = r.channel_url, i.channelType = r.channel_type, i;
  }

  return t$1(n, t), n;
}(Pe$3),
    or = 100,
    ur = "GroupChannel",
    cr = "url",
    lr = 100,
    dr = "Message",
    hr = "messageId",
    fr = "Poll",
    pr = "pollId",
    vr = "FeedChannel",
    yr = "url",
    _r = n$1(n$1({}, bt$1), {
  fileInfoList: []
}),
    gr = function (e) {
  return (k(e.file) || w$1("string", e.fileUrl)) && w$1("string", e.fileName, !0) && w$1("string", e.mimeType, !0) && w$1("number", e.fileSize, !0) && (void 0 === e.thumbnailSizes || Array.isArray(e.thumbnailSizes) && e.thumbnailSizes.every(function (e) {
    return e.maxWidth > 0 && e.maxHeight > 0;
  }));
},
    br = function (t) {
  function n() {
    var e = null !== t && t.apply(this, arguments) || this;
    return e._onFileUploaded = ze$2, e;
  }

  return t$1(n, t), n.prototype._triggerOnFileUploaded = function (e, t, n, r) {
    this._onFileUploaded(e, t, n, r);
  }, n.prototype.onFileUploaded = function (e) {
    return this._onFileUploaded = e, this;
  }, n.prototype.onPending = function (e) {
    return t.prototype.onPending.call(this, e), this;
  }, n.prototype.onFailed = function (e) {
    return t.prototype.onFailed.call(this, e), this;
  }, n.prototype.onSucceeded = function (e) {
    return t.prototype.onSucceeded.call(this, e), this;
  }, n;
}(gt$1),
    Ir = 2,
    Er = function (t) {
  function n(e, n) {
    var r,
        i,
        s,
        a,
        o,
        c,
        l = this;
    return (l = t.call(this, e) || this)._name = "", l._createdAt = 0, l.channelType = x.BASE, l.coverUrl = "", l.customType = "", l.data = "", l.isFrozen = !1, l.isEphemeral = !1, l.creator = null, l._messageCollectionLastAccessedAt = 0, l._url = n.channel_url, l._name = null !== (r = n.name) && void 0 !== r ? r : "", l._createdAt = 1e3 * n.created_at, l.coverUrl = null !== (i = n.cover_url) && void 0 !== i ? i : "", l.customType = null !== (s = n.custom_type) && void 0 !== s ? s : "", l.data = null !== (a = n.data) && void 0 !== a ? a : "", l.isFrozen = null !== (o = n.freeze) && void 0 !== o && o, l.isEphemeral = null !== (c = n.is_ephemeral) && void 0 !== c && c, l.creator = n.created_by ? new Xi$1(l._iid, n.created_by) : null, n.metadata && Object.keys(n.metadata).length > 0 && n.ts && (l._cachedMetaData = new Map(), Object.keys(n.metadata).forEach(function (e) {
      l._cachedMetaData.set(e, {
        value: n.metadata[e],
        isRemoved: !1,
        updatedAt: n.ts
      });
    })), l;
  }

  return t$1(n, t), Object.defineProperty(n.prototype, "url", {
    get: function () {
      return this._url;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "name", {
    get: function () {
      return this._name;
    },
    set: function (e) {
      this._name = e;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "createdAt", {
    get: function () {
      return this._createdAt;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype.toJSON = function () {
    return n$1(n$1({}, this), {
      url: this._url,
      name: this._name,
      createdAt: this._createdAt
    });
  }, n.payloadify = function (e) {
    return J($(n$1(n$1({}, t.payloadify.call(this, e)), {
      channel_url: e.url,
      name: e.name,
      cover_url: e.coverUrl,
      custom_type: e.customType,
      data: e.data,
      freeze: e.isFrozen,
      is_ephemeral: e.isEphemeral,
      created_by: e.creator ? Xi$1.payloadify(e.creator) : null,
      created_at: e.createdAt / 1e3
    })));
  }, n.prototype.isGroupChannel = function () {
    return this.channelType === x.GROUP;
  }, n.prototype.isOpenChannel = function () {
    return this.channelType === x.OPEN;
  }, n.prototype.isFeedChannel = function () {
    return this.channelType === x.FEED;
  }, Object.defineProperty(n.prototype, "cachedMetaData", {
    get: function () {
      var e = {};
      return this._cachedMetaData ? (this._cachedMetaData.forEach(function (t, n) {
        t.isRemoved || (e[n] = t.value);
      }), e) : e;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "messageCollectionLastAccessedAt", {
    get: function () {
      return this._messageCollectionLastAccessedAt;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype._updateMessageCollectionLastAccessedAt = function () {
    this._messageCollectionLastAccessedAt = Date.now();
  }, n.prototype._update = function (e) {
    var t = J(e);
    Object.assign(this, t);
  }, n.prototype._upsertCachedMetaData = function (e, t) {
    var n = this;
    Object.keys(e).forEach(function (r) {
      n._cachedMetaData || (n._cachedMetaData = new Map());

      var i = n._cachedMetaData.get(r);

      (!i || i.updatedAt <= t) && n._cachedMetaData.set(r, {
        value: e[r],
        isRemoved: !1,
        updatedAt: t
      });
    });
  }, n.prototype._updateCachedMetaData = function (e, t) {
    var n = this;
    this._cachedMetaData ? this._cachedMetaData.forEach(function (r, i) {
      var s;
      r.updatedAt <= t && n._cachedMetaData.set(i, {
        value: null !== (s = e[i]) && void 0 !== s ? s : r.value,
        isRemoved: !e[i],
        updatedAt: t
      });
    }) : (this._cachedMetaData = new Map(), Object.keys(e).forEach(function (r) {
      n._cachedMetaData.set(r, {
        value: e[r],
        isRemoved: !1,
        updatedAt: t
      });
    }));
  }, n.prototype._removeFromCachedMetaData = function (e, t) {
    var n = this;
    this._cachedMetaData && e.forEach(function (e) {
      var r = n._cachedMetaData.get(e);

      r && r.updatedAt < t && (r.isRemoved = !0, r.updatedAt = t);
    });
  }, n.prototype._runIfHandleableWithGroupChannel = function (e) {
    this.isGroupChannel() ? e(this) : this.isFeedChannel() && e(this.groupChannel);
  }, n.prototype._generateRequestId = function () {
    return "rq-".concat(Z());
  }, n.prototype.isIdentical = function (e) {
    return e && this.url === e.url;
  }, n.prototype.isEqual = function (e) {
    return y$2(this, e);
  }, n.prototype.createOperatorListQuery = function (e) {
    return void 0 === e && (e = {}), new qt$2(this._iid, this.url, this.channelType, e);
  }, n.prototype.createMutedUserListQuery = function (e) {
    return void 0 === e && (e = {}), new Kt$2(this._iid, this.url, this.channelType, e);
  }, n.prototype.createBannedUserListQuery = function (e) {
    return void 0 === e && (e = {}), new Gt$2(this._iid, this.url, this.channelType, e);
  }, n.prototype.createPreviousMessageListQuery = function (e) {
    return void 0 === e && (e = {}), new Ft$2(this._iid, this.url, this.channelType, e);
  }, n.prototype.addOperators = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid).requestQueue, n = new Vt$2({
              channelUrl: this.url,
              channelType: this.channelType,
              operatorUserIds: e
            }), [4, t.send(n)];

          case 1:
            return r.sent(), [2];
        }
      });
    });
  }, n.prototype.removeOperators = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid).requestQueue, n = new Wt$2({
              channelUrl: this.url,
              channelType: this.channelType,
              operatorUserIds: e
            }), [4, t.send(n)];

          case 1:
            return r.sent(), [2];
        }
      });
    });
  }, n.prototype.getMyMutedInfo = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s, a, o, u, c, l;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, r = new Ht$2({
              channelUrl: this.url,
              channelType: this.channelType,
              userId: t.userId
            }), [4, n.send(r)];

          case 1:
            return i = d.sent(), s = i.as(Yt$1), a = s.isMuted, o = s.startAt, u = s.endAt, c = s.remainingDuration, l = s.description, [2, {
              isMuted: a,
              startAt: o,
              endAt: u,
              remainingDuration: c,
              description: l
            }];
        }
      });
    });
  }, n.prototype.getMetaData = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid).requestQueue, n = new Jt$2({
              channelUrl: this.url,
              channelType: this.channelType,
              keys: e
            }), [4, t.send(n)];

          case 1:
            return r = o.sent(), i = r.as(Xt$2), s = i.metadata, a = i.ts, this._upsertCachedMetaData(s, a), [2, s];
        }
      });
    });
  }, n.prototype.getAllMetaData = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, t = new Jt$2({
              channelUrl: this.url,
              channelType: this.channelType,
              keys: []
            }), [4, e.send(t)];

          case 1:
            return n = a.sent(), r = n.as(Xt$2), i = r.metadata, s = r.ts, this._updateCachedMetaData(i, s), [2, i];
        }
      });
    });
  }, n.prototype.createMetaData = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return t = _o.of(this._iid).requestQueue, n = new Zt$2({
              channelUrl: this.url,
              channelType: this.channelType,
              metadata: e
            }), [4, t.send(n)];

          case 1:
            return r = s.sent(), i = r.as($t$2).metaData, this._upsertCachedMetaData(i, 0), [2, i];
        }
      });
    });
  }, n.prototype.updateMetaData = function (e, t) {
    return void 0 === t && (t = !1), i$1(this, void 0, void 0, function () {
      var n, r, i, s, a, o;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return n = _o.of(this._iid).requestQueue, r = new en$2({
              channelUrl: this.url,
              channelType: this.channelType,
              metadata: e,
              upsert: t
            }), [4, n.send(r)];

          case 1:
            return i = u.sent(), s = i.as(tn$2), a = s.metadata, o = s.ts, this._upsertCachedMetaData(a, o), [2, a];
        }
      });
    });
  }, n.prototype.deleteMetaData = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid).requestQueue, n = new rn$2({
              channelUrl: this.url,
              channelType: this.channelType,
              key: e
            }), [4, t.send(n)];

          case 1:
            return r = s.sent(), i = r.as(sn$2).ts, this._removeFromCachedMetaData([e], i), [2];
        }
      });
    });
  }, n.prototype.deleteAllMetaData = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, t = new an$2({
              channelUrl: this.url,
              channelType: this.channelType
            }), [4, e.send(t)];

          case 1:
            return n = i.sent(), r = n.as(on$2).ts, this._removeFromCachedMetaData(c$1([], a$1(this._cachedMetaData.keys()), !1), r), [2];
        }
      });
    });
  }, n.prototype.getMetaCounters = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid).requestQueue, n = new un$2({
              channelUrl: this.url,
              channelType: this.channelType,
              keys: e
            }), [4, t.send(n)];

          case 1:
            return r = i.sent(), [2, r.as(cn$2).metaCounter];
        }
      });
    });
  }, n.prototype.getAllMetaCounters = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, t = new un$2({
              channelUrl: this.url,
              channelType: this.channelType,
              keys: []
            }), [4, e.send(t)];

          case 1:
            return n = r.sent(), [2, n.as(cn$2).metaCounter];
        }
      });
    });
  }, n.prototype.createMetaCounters = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return t = _o.of(this._iid).requestQueue, n = new ln$2({
              channelUrl: this.url,
              channelType: this.channelType,
              metaCounter: e
            }), [4, t.send(n)];

          case 1:
            return r = i.sent(), [2, r.as(dn$2).metaCounter];
        }
      });
    });
  }, n.prototype.updateMetaCounters = function (e, t) {
    return void 0 === t && (t = !1), i$1(this, void 0, void 0, function () {
      var n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return n = _o.of(this._iid).requestQueue, r = new hn$2({
              channelUrl: this.url,
              channelType: this.channelType,
              metaCounter: e,
              upsert: t
            }), [4, n.send(r)];

          case 1:
            return i = s.sent(), [2, i.as(fn$1).metaCounter];
        }
      });
    });
  }, n.prototype.increaseMetaCounters = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return t = _o.of(this._iid).requestQueue, n = new hn$2({
              channelUrl: this.url,
              channelType: this.channelType,
              metaCounter: e,
              upsert: !1,
              mode: "increase"
            }), [4, t.send(n)];

          case 1:
            return r = i.sent(), [2, r.as(fn$1).metaCounter];
        }
      });
    });
  }, n.prototype.decreaseMetaCounters = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return t = _o.of(this._iid).requestQueue, n = new hn$2({
              channelUrl: this.url,
              channelType: this.channelType,
              metaCounter: e,
              upsert: !1,
              mode: "decrease"
            }), [4, t.send(n)];

          case 1:
            return r = i.sent(), [2, r.as(fn$1).metaCounter];
        }
      });
    });
  }, n.prototype.deleteMetaCounter = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid).requestQueue, n = new mn$1({
              channelUrl: this.url,
              channelType: this.channelType,
              key: e
            }), [4, t.send(n)];

          case 1:
            return r.sent(), [2];
        }
      });
    });
  }, n.prototype.deleteAllMetaCounters = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, t = new vn$1({
              channelUrl: this.url,
              channelType: this.channelType
            }), [4, e.send(t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.muteUser = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (r) {
        return [2, this.muteUserWithUserId(e.userId, t, n)];
      });
    });
  }, n.prototype.muteUserWithUserId = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      var r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(w$1("string", e) && w$1("number", t, !0) && w$1("string", n, !0)).throw(v$2.invalidParameters), r = _o.of(this._iid).requestQueue, i = new yn$1({
              channelUrl: this.url,
              channelType: this.channelType,
              userId: e,
              seconds: t,
              description: n
            }), [4, r.send(i)];

          case 1:
            return s.sent(), [2];
        }
      });
    });
  }, n.prototype.unmuteUser = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return [2, this.unmuteUserWithUserId(e.userId)];
      });
    });
  }, n.prototype.unmuteUserWithUserId = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid).requestQueue, n = new gn$1({
              channelUrl: this.url,
              channelType: this.channelType,
              userId: e
            }), [4, t.send(n)];

          case 1:
            return r.sent(), [2];
        }
      });
    });
  }, n.prototype.banUser = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (r) {
        return [2, this.banUserWithUserId(e.userId, t, n)];
      });
    });
  }, n.prototype.banUserWithUserId = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      var r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(w$1("string", e) && w$1("number", t, !0) && w$1("string", n, !0)).throw(v$2.invalidParameters), r = _o.of(this._iid).requestQueue, i = new In$1({
              channelUrl: this.url,
              channelType: this.channelType,
              userId: e,
              seconds: t,
              description: n
            }), [4, r.send(i)];

          case 1:
            return s.sent(), [2];
        }
      });
    });
  }, n.prototype.unbanUser = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return [2, this.unbanUserWithUserId(e.userId)];
      });
    });
  }, n.prototype.unbanUserWithUserId = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid).requestQueue, n = new Tn$1({
              channelUrl: this.url,
              channelType: this.channelType,
              userId: e
            }), [4, t.send(n)];

          case 1:
            return r.sent(), [2];
        }
      });
    });
  }, n.prototype.freeze = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, t = new Mn$1({
              channelUrl: this.url,
              channelType: this.channelType,
              freezing: !0
            }), [4, e.send(t)];

          case 1:
            return n.sent(), this.isFrozen = !0, [2];
        }
      });
    });
  }, n.prototype.unfreeze = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, t = new Mn$1({
              channelUrl: this.url,
              channelType: this.channelType,
              freezing: !1
            }), [4, e.send(t)];

          case 1:
            return n.sent(), this.isFrozen = !1, [2];
        }
      });
    });
  }, n.prototype.getMessagesByMessageId = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = n$1(n$1({}, rt), t), Qi$1(w$1("number", e) && it$1(n)).throw(v$2.invalidParameters), [4, Zi.of(this._iid).getMessagesByMessageId(this.url, this.channelType, e, n)];

          case 1:
            return [2, r.sent()];
        }
      });
    });
  }, n.prototype.getMessagesByTimestamp = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = n$1(n$1({}, rt), t), Qi$1(w$1("number", e) && it$1(n)).throw(v$2.invalidParameters), [4, Zi.of(this._iid).getMessagesByTimestamp(this.url, this.channelType, e, n)];

          case 1:
            return [2, r.sent()];
        }
      });
    });
  }, n.prototype.getMessageChangeLogsSinceTimestamp = function (e, t) {
    return void 0 === t && (t = {}), i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = n$1(n$1({}, st$1), t), Qi$1(w$1("number", e) && at$1(n)).throw(v$2.invalidParameters), [4, Zi.of(this._iid).getMessageChangelogs(this.url, this.channelType, e, n)];

          case 1:
            return [2, r.sent()];
        }
      });
    });
  }, n.prototype.getMessageChangeLogsSinceToken = function (e, t) {
    return void 0 === t && (t = {}), i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return n = n$1(n$1({}, st$1), t), Qi$1(w$1("string", e) && at$1(n)).throw(v$2.invalidParameters), [4, Zi.of(this._iid).getMessageChangelogs(this.url, this.channelType, e, n)];

          case 1:
            return [2, r.sent()];
        }
      });
    });
  }, n.prototype._createPendingSendableMessagePayload = function (e, t, n) {
    var i,
        s = _o.of(this._iid).sessionManager;
    return J($({
      channel_url: this.url,
      channel_type: this.channelType,
      msg_id: 0,
      parent_message_id: e.parentMessageId,
      data: e.data,
      custom_type: e.customType,
      mention_type: e.mentionType,
      sorted_metaarray: e.metaArrays ? e.metaArrays.map(function (e) {
        return Oe$2.payloadify(e);
      }) : null,
      apple_critical_alert_options: e.appleCriticalAlertOptions ? ke.payloadify(e.appleCriticalAlertOptions) : null,
      created_at: n,
      user: s.currentUser ? Re$1.payloadify(s.currentUser) : null,
      req_id: t,
      request_state: q.PENDING,
      mentioned_user_ids: e.mentionedUserIds,
      mentioned_users: null === (i = e.mentionedUsers) || void 0 === i ? void 0 : i.map(function (e) {
        return Xi$1.payloadify(e);
      })
    }));
  }, n.prototype._createPendingUserMessage = function (e, t, n) {
    var i,
        s,
        a = {};
    if (e.translationTargetLanguages) try {
      for (var u = s$2(e.translationTargetLanguages), c = u.next(); !c.done; c = u.next()) {
        a[c.value] = "";
      }
    } catch (e) {
      i = {
        error: e
      };
    } finally {
      try {
        c && !c.done && (s = u.return) && s.call(u);
      } finally {
        if (i) throw i.error;
      }
    }
    var l = J(n$1(n$1({}, this._createPendingSendableMessagePayload(e, t, n)), {
      type: P$1.USER,
      message: e.message,
      translations: a
    })),
        d = new je$1(this._iid, l);
    return d.messageParams = e, d;
  }, n.prototype._createPendingScheduledUserMessage = function (e, t, n) {
    var r = this._createPendingUserMessage(e, t, n);

    return r.scheduledInfo = {
      scheduledMessageId: 0,
      scheduledAt: e.scheduledAt,
      scheduledMessageParams: e
    }, r;
  }, n.prototype._createPendingFileMessage = function (e, t, n) {
    var i,
        s,
        a,
        u,
        c,
        l,
        d = J(n$1(n$1({}, this._createPendingSendableMessagePayload(e, t, n)), {
      type: P$1.FILE,
      url: e.fileUrl,
      file: {
        name: null !== (i = e.fileName) && void 0 !== i ? i : null === (s = e.file) || void 0 === s ? void 0 : s.name,
        size: null !== (a = e.fileSize) && void 0 !== a ? a : null === (u = e.file) || void 0 === u ? void 0 : u.size,
        type: null !== (c = e.mimeType) && void 0 !== c ? c : null === (l = e.file) || void 0 === l ? void 0 : l.type,
        data: e.data
      },
      thumbnails: e.thumbnailSizes ? e.thumbnailSizes.map(function (e) {
        return {
          url: "",
          width: e.maxWidth,
          height: e.maxHeight
        };
      }) : []
    })),
        h = new He$2(this._iid, d);
    return h.messageParams = e, h;
  }, n.prototype._createPendingMultipleFilesMessage = function (e, t, n) {
    var i = J(n$1(n$1({}, this._createPendingSendableMessagePayload(e, t, n)), {
      type: P$1.FILE
    })),
        s = new Ge(this._iid, i);
    return s.messageParams = e, s;
  }, n.prototype._createPendingScheduledFileMessage = function (e, t, n) {
    var r = this._createPendingFileMessage(e, t, n);

    return r.scheduledInfo = {
      scheduledMessageId: 0,
      scheduledAt: e.scheduledAt,
      scheduledMessageParams: e
    }, r;
  }, n.prototype._markMessageAsFailed = function (e, t, n) {
    void 0 === n && (n = !1), e.errorCode = t.code, t.code === u$1.REQUEST_CANCELED || t.code === u$1.FILE_UPLOAD_CANCEL_FAILED ? e.sendingStatus = q.CANCELED : n || (e.sendingStatus = q.FAILED);
  }, n.prototype.sendUserMessage = function (e) {
    var t = n$1(n$1({}, Tt$2), e);
    return Qi$1(wt$2(t)).throw(v$2.invalidParameters), this._sendUserMessage(t);
  }, n.prototype._sendUserMessage = function (e, t, n) {
    var r = this;
    void 0 === n && (n = !1);
    var i = _o.of(this._iid),
        s = i.dispatcher,
        a = i.requestQueue,
        u = null != t ? t : this._generateRequestId(),
        c = Date.now(),
        l = new gt$1();
    return u || (u = this._generateRequestId()), Ei$1(2).then(function () {
      var t = r._createPendingUserMessage(e, u, c);

      s.dispatch(new No({
        messages: [t],
        source: n ? po.LOCAL_MESSAGE_RESEND_STARTED : po.EVENT_MESSAGE_SENT_PENDING
      })), bi$1(function () {
        return i$1(r, void 0, void 0, function () {
          return o$1(this, function (e) {
            return [2, l._trigger(t)];
          });
        });
      });
      var i = new On$1(n$1(n$1({}, e), {
        channelUrl: r.url,
        channelType: r.channelType,
        reqId: u
      }));
      a.send(i).then(function (e) {
        var t = e.as(Cn$1).message;
        s.dispatch(new No({
          messages: [t],
          source: po.EVENT_MESSAGE_SENT_SUCCESS
        })), bi$1(function () {
          return i$1(r, void 0, void 0, function () {
            return o$1(this, function (e) {
              return [2, l._trigger(t)];
            });
          });
        });
      }).catch(function (t) {
        if (g$2(t)) throw t;
        Ei$1(2).then(function () {
          var n = r._createPendingUserMessage(e, u, c),
              i = _o.of(r._iid).cacheContext.localCacheEnabled && C$1(t.code);

          r._markMessageAsFailed(n, t, i), s.dispatch(new No({
            messages: [n],
            source: n.sendingStatus === q.PENDING ? po.REQUEST_RESEND_MESSAGE : po.EVENT_MESSAGE_SENT_FAILED
          })), bi$1(function () {
            return i$1(r, void 0, void 0, function () {
              return o$1(this, function (e) {
                return [2, l._triggerFailed(t, n)];
              });
            });
          });
        });
      });
    }), l;
  }, n.prototype._autoResendUserMessage = function (e) {
    return Qi$1(e instanceof je$1 && !!e.messageParams).throw(v$2.invalidParameters), this._sendUserMessage(e.messageParams, e.reqId);
  }, n.prototype.resendUserMessage = function (e) {
    var t;
    return i$1(this, void 0, void 0, function () {
      var n, i;
      return o$1(this, function (s) {
        return Qi$1(e instanceof je$1 && !e.scheduledInfo).throw(v$2.invalidParameters), n = new oi$1(), i = null !== (t = e.messageParams) && void 0 !== t ? t : function (e) {
          var t;
          return J($({
            data: e.data,
            customType: e.customType,
            mentionType: e.mentionType,
            mentionedUsers: e.mentionedUsers,
            mentionedUserIds: e.mentionedUserIds,
            mentionedMessageTemplate: e.mentionedMessageTemplate,
            metaArrays: e.metaArrays,
            pollId: null === (t = e.poll) || void 0 === t ? void 0 : t.id,
            parentMessageId: e.parentMessageId,
            appleCriticalAlertOptions: e.appleCriticalAlertOptions,
            message: e.message,
            translationTargetLanguages: Object.keys(e.translations)
          }));
        }(e), this._sendUserMessage(i, e.reqId, !0).onFailed(function (e) {
          return n.reject(e);
        }).onSucceeded(function (e) {
          return n.resolve(e);
        }), [2, n.promise];
      });
    });
  }, n.prototype.updateUserMessage = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return n = n$1(n$1({}, kt$2), t), Qi$1(w$1("number", e) && Rt$2(n)).throw(v$2.invalidParameters), r = _o.of(this._iid).requestQueue, i = new Pn$1(n$1({
              channelType: this.channelType,
              channelUrl: this.url,
              messageId: e
            }, n)), [4, r.send(i)];

          case 1:
            return s = a.sent(), [2, s.as(kn$1).message];
        }
      });
    });
  }, n.prototype.copyUserMessage = function (e, t) {
    var r, i, s;
    return i$1(this, void 0, void 0, function () {
      var u, c;
      return o$1(this, function (l) {
        return Qi$1(e instanceof n && t instanceof je$1 && t.sendingStatus === q.SUCCEEDED && this.url === t.channelUrl && !t.scheduledInfo).throw(v$2.invalidParameters), Qi$1(!t.poll).throw(v$2.notSupportedError), u = new oi$1(), c = null !== (r = t.messageParams) && void 0 !== r ? r : $(n$1(n$1({}, t), {
          mentionType: t.mentionType,
          mentionedUserIds: null !== (i = t.mentionedUserIds) && void 0 !== i ? i : null === (s = t.mentionedUsers) || void 0 === s ? void 0 : s.map(function (e) {
            return e.userId;
          }),
          translationTargetLanguages: Object.keys(t.translations),
          pushNotificationDeliveryOption: G.DEFAULT,
          parentMessageId: null,
          isReplyToChannel: !1,
          isPinnedMessage: !1
        })), e._sendUserMessage(c).onSucceeded(function (e) {
          u.resolve(e);
        }).onFailed(function (e) {
          return u.reject(e);
        }), [2, u.promise];
      });
    });
  }, n.prototype.translateUserMessage = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(e instanceof je$1 && e.messageId > 0 && S$2("string", t)).throw(v$2.invalidParameters), n = _o.of(this._iid).requestQueue, r = new Kn$1({
              channelType: this.channelType,
              channelUrl: this.url,
              messageId: e.messageId,
              translationTargetLanguages: t
            }), [4, n.send(r)];

          case 1:
            return i = s.sent(), [2, i.as(jn$1).message];
        }
      });
    });
  }, n.prototype._createScheduledUserMessage = function (e, t) {
    var n = this,
        r = _o.of(this._iid).requestQueue,
        i = Date.now(),
        s = this._generateRequestId();

    Ei$1(2).then(function () {
      var r = n._createPendingScheduledUserMessage(e, s, i);

      bi$1(function () {
        return i$1(n, void 0, void 0, function () {
          return o$1(this, function (e) {
            return [2, t._trigger(r)];
          });
        });
      });
    });
    var a = new Qn$1(n$1({
      reqId: s,
      channelType: this.channelType,
      channelUrl: this.url
    }, e));
    r.send(a).then(function (e) {
      var r = e.as(Gn$1).message;
      bi$1(function () {
        return i$1(n, void 0, void 0, function () {
          return o$1(this, function (e) {
            return [2, t._trigger(r)];
          });
        });
      });
    }).catch(function (r) {
      if (g$2(r)) throw r;
      Ei$1(2).then(function () {
        var a = n._createPendingScheduledUserMessage(e, s, i);

        n._markMessageAsFailed(a, r), bi$1(function () {
          return i$1(n, void 0, void 0, function () {
            return o$1(this, function (e) {
              return [2, t._trigger(a)];
            });
          });
        });
      });
    });
  }, n.prototype.sendFileMessage = function (e) {
    var t = n$1(n$1({}, Ut$2), e);
    return Qi$1(Ot$2(t)).throw(v$2.invalidParameters), this._sendFileMessage(t);
  }, n.prototype.sendMultipleFilesMessage = function (e) {
    var t,
        n = n$1(n$1({}, _r), e),
        r = _o.of(this._iid);
    Qi$1(function (e, t) {
      return void 0 === t && (t = Pi$1), It$2(e) && Array.isArray(e.fileInfoList) && e.fileInfoList.length >= 2 && e.fileInfoList.length <= t && e.fileInfoList.every(function (e) {
        return gr(e);
      });
    }(n, null === (t = r.appInfo) || void 0 === t ? void 0 : t.multipleFilesMessageFileCountLimit)).throw(v$2.invalidParameters);
    var i = !!e.fileInfoList.find(function (e) {
      var t = r.appInfo.uploadSizeLimit;
      return e.file instanceof Blob && e.file.size > t || e.fileSize > t;
    });
    return Qi$1(!i).throw(v$2.fileSizeLimitExceededError), this._sendMultipleFilesMessage(n);
  }, n.prototype._sendFileMessage = function (e, t, n) {
    var r = this;
    void 0 === n && (n = !1);
    var i = _o.of(this._iid).dispatcher,
        s = Zi.of(this._iid).fileMessageQueue,
        a = null != t ? t : this._generateRequestId(),
        o = Date.now(),
        u = new gt$1();
    return a || (a = this._generateRequestId()), Ei$1(2).then(function () {
      var t = r._createPendingFileMessage(e, a, o);

      i.dispatch(new No({
        messages: [t],
        source: n ? po.LOCAL_MESSAGE_RESEND_STARTED : po.EVENT_MESSAGE_SENT_PENDING
      })), bi$1(function () {
        return i$1(r, void 0, void 0, function () {
          return o$1(this, function (e) {
            return [2, u._trigger(t)];
          });
        });
      }), s.request(r, a, e).then(function (e) {
        i.dispatch(new No({
          messages: [e],
          source: po.EVENT_MESSAGE_SENT_SUCCESS
        })), bi$1(function () {
          return i$1(r, void 0, void 0, function () {
            return o$1(this, function (t) {
              return [2, u._trigger(e)];
            });
          });
        });
      }).catch(function (t) {
        if (g$2(t)) throw t;
        Ei$1(2).then(function () {
          var n = r._createPendingFileMessage(e, a, o),
              s = _o.of(r._iid).cacheContext.localCacheEnabled && C$1(t.code);

          r._markMessageAsFailed(n, t, s), i.dispatch(new No({
            messages: [n],
            source: n.sendingStatus === q.PENDING ? po.REQUEST_RESEND_MESSAGE : t.code === u$1.FILE_UPLOAD_CANCEL_FAILED ? po.LOCAL_MESSAGE_CANCELED : po.EVENT_MESSAGE_SENT_FAILED
          })), bi$1(function () {
            return i$1(r, void 0, void 0, function () {
              return o$1(this, function (e) {
                return [2, u._triggerFailed(t, n)];
              });
            });
          });
        });
      });
    }), u;
  }, n.prototype._autoResendFileMessage = function (e) {
    Qi$1(e instanceof He$2 && !!e.messageParams).throw(v$2.invalidParameters);
    var t = _o.of(this._iid).logger;
    return t.debug("autoResendFileMessage pending", e), this._sendFileMessage(e.messageParams, e.reqId).onFailed(function (e) {
      t.debug("autoResendFileMessage failed", e);
    }).onSucceeded(function (e) {
      t.debug("autoResendFileMessage success", e);
    });
  }, n.prototype._sendMultipleFilesMessage = function (e, t) {
    var n = this,
        r = _o.of(this._iid).dispatcher,
        i = Zi.of(this._iid).fileMessageQueue,
        s = null != t ? t : this._generateRequestId(),
        a = Date.now(),
        o = new br();
    return s || (s = this._generateRequestId()), Ei$1(2).then(function () {
      var t = n._createPendingMultipleFilesMessage(e, s, a);

      r.dispatch(new No({
        messages: [t],
        source: po.EVENT_MESSAGE_SENT_PENDING
      })), bi$1(function () {
        return i$1(n, void 0, void 0, function () {
          return o$1(this, function (e) {
            return [2, o._trigger(t)];
          });
        });
      }), i.request(n, s, e, o).then(function (e) {
        r.dispatch(new No({
          messages: [e],
          source: po.EVENT_MESSAGE_SENT_SUCCESS
        })), bi$1(function () {
          return i$1(n, void 0, void 0, function () {
            return o$1(this, function (t) {
              return [2, o._trigger(e)];
            });
          });
        });
      }).catch(function (t) {
        if (g$2(t)) throw t;
        Ei$1(2).then(function () {
          var i = n._createPendingMultipleFilesMessage(e, s, a);

          n._markMessageAsFailed(i, t), r.dispatch(new No({
            messages: [i],
            source: po.EVENT_MESSAGE_SENT_FAILED
          })), bi$1(function () {
            return i$1(n, void 0, void 0, function () {
              return o$1(this, function (e) {
                return [2, o._triggerFailed(t, i)];
              });
            });
          });
        });
      });
    }), o;
  }, n.prototype._createScheduledFileMessage = function (e, t, n, r) {
    var i = this,
        s = _o.of(this._iid).requestQueue,
        a = new Vn$1(n$1(n$1({
      reqId: n,
      channelType: this.channelType,
      channelUrl: this.url
    }, e), {
      fileUrl: e.fileUrl,
      requireAuth: e.requireAuth
    }));
    s.send(a).then(function (e) {
      var n = e.as(Wn$1).message;
      bi$1(function () {
        return i$1(i, void 0, void 0, function () {
          return o$1(this, function (e) {
            return [2, t._trigger(n)];
          });
        });
      });
    }).catch(function (s) {
      if (g$2(s)) throw s;
      Ei$1(2).then(function () {
        var a = i._createPendingScheduledFileMessage(e, n, r);

        i._markMessageAsFailed(a, s), bi$1(function () {
          return i$1(i, void 0, void 0, function () {
            return o$1(this, function (e) {
              return [2, t._triggerFailed(s, a)];
            });
          });
        });
      });
    });
  }, n.prototype.sendFileMessages = function (e) {
    var t, n;
    Qi$1(e.every(function (e) {
      return Ot$2(n$1(n$1({}, Ut$2), e));
    })).throw(v$2.invalidParameters);
    var r = new gt$1();

    try {
      for (var i = s$2(e), s = i.next(); !s.done; s = i.next()) {
        var a = s.value;
        this.sendFileMessage(a).onPending(function (e) {
          return r._trigger(e);
        }).onFailed(function (e, t) {
          return r._triggerFailed(e, t);
        }).onSucceeded(function (e) {
          return r._trigger(e);
        });
      }
    } catch (e) {
      t = {
        error: e
      };
    } finally {
      try {
        s && !s.done && (n = i.return) && n.call(i);
      } finally {
        if (t) throw t.error;
      }
    }

    return r;
  }, n.prototype.resendFileMessage = function (e, t) {
    var n;
    return i$1(this, void 0, void 0, function () {
      var i, s, o;
      return o$1(this, function (u) {
        return i = Boolean(e.url) || k(t) || k(null === (n = e.messageParams) || void 0 === n ? void 0 : n.file), Qi$1(e instanceof He$2 && i && !e.scheduledInfo).throw(v$2.invalidParameters), s = new oi$1(), o = function (e, t) {
          var n;
          return e.messageParams ? (!e.url && k(t) && (e.messageParams.file = t), e.messageParams) : J($({
            data: e.data,
            customType: e.customType,
            mentionType: e.mentionType,
            mentionedUsers: e.mentionedUsers,
            mentionedUserIds: e.mentionedUserIds,
            metaArrays: e.metaArrays,
            parentMessageId: e.parentMessageId,
            appleCriticalAlertOptions: e.appleCriticalAlertOptions,
            file: t,
            fileUrl: e.url,
            fileName: e.name,
            fileSize: e.size,
            mimeType: e.type,
            thumbnailSizes: null === (n = e.thumbnails) || void 0 === n ? void 0 : n.map(function (e) {
              return {
                maxWidth: e.width,
                maxHeight: e.height
              };
            })
          }));
        }(e, t), this._sendFileMessage(o, e.reqId, !0).onFailed(function (e) {
          return s.reject(e);
        }).onSucceeded(function (e) {
          return s.resolve(e);
        }), [2, s.promise];
      });
    });
  }, n.prototype.updateFileMessage = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return n = n$1(n$1({}, xt$2), t), Qi$1(w$1("number", e) && function (e) {
              return Pt$2(e);
            }(n)).throw(v$2.invalidParameters), r = _o.of(this._iid).requestQueue, i = new Rn$1(n$1({
              channelType: this.channelType,
              channelUrl: this.url,
              messageId: e
            }, n)), [4, r.send(i)];

          case 1:
            return s = a.sent(), [2, s.as(xn$1).message];
        }
      });
    });
  }, n.prototype.cancelUploadingFileMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), Zi.of(this._iid).fileMessageQueue.cancel(this, e), [2, !0];
      });
    });
  }, n.prototype.copyFileMessage = function (e, t) {
    var r, i, s;
    return i$1(this, void 0, void 0, function () {
      var u, c;
      return o$1(this, function (l) {
        return Qi$1(e instanceof n && t instanceof He$2 && t.sendingStatus === q.SUCCEEDED && this.url === t.channelUrl && !t.scheduledInfo).throw(v$2.invalidParameters), u = new oi$1(), c = $(n$1(n$1({}, t), {
          fileUrl: t.url,
          fileName: t.name,
          fileSize: t.size,
          mimeType: t.type,
          mentionType: t.mentionType,
          mentionedUserIds: null !== (r = t.mentionedUserIds) && void 0 !== r ? r : null === (i = t.mentionedUsers) || void 0 === i ? void 0 : i.map(function (e) {
            return e.userId;
          }),
          pushNotificationDeliveryOption: G.DEFAULT,
          parentMessageId: null,
          isReplyToChannel: !1,
          thumbnailSizes: null === (s = t.thumbnails) || void 0 === s ? void 0 : s.map(function (e) {
            return {
              maxWidth: e.width,
              maxHeight: e.height
            };
          }),
          requireAuth: t.requireAuth,
          isPinnedMessage: !1
        })), e._sendFileMessage(c).onSucceeded(function (e) {
          return u.resolve(e);
        }).onFailed(function (e) {
          return u.reject(e);
        }), [2, u.promise];
      });
    });
  }, n.prototype.deleteMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return Qi$1(e instanceof Le).throw(v$2.invalidParameters), e.messageId > 0 ? (t = _o.of(this._iid).requestQueue, n = new Ln$1({
              channelType: this.channelType,
              channelUrl: this.url,
              messageId: e.messageId
            }), [4, t.send(n)]) : [3, 2];

          case 1:
            r.sent(), r.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.addReaction = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(e instanceof Le && e.messageId > 0 && w$1("string", t)).throw(v$2.invalidParameters), n = _o.of(this._iid).requestQueue, r = new qn$1({
              channelType: this.channelType,
              channelUrl: this.url,
              messageId: e.messageId,
              reactionKey: t
            }), [4, n.send(r)];

          case 1:
            return i = s.sent(), [2, i.as(Fn$1).reactionEvent];
        }
      });
    });
  }, n.prototype.deleteReaction = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(e instanceof Le && e.messageId > 0 && w$1("string", t)).throw(v$2.invalidParameters), n = _o.of(this._iid).requestQueue, r = new zn$1({
              channelType: this.channelType,
              channelUrl: this.url,
              messageId: e.messageId,
              reactionKey: t
            }), [4, n.send(r)];

          case 1:
            return i = s.sent(), [2, i.as(Bn$1).reactionEvent];
        }
      });
    });
  }, n.prototype._updateUserMessageMetaArray = function (e, t, n, r) {
    return i$1(this, void 0, void 0, function () {
      var i, s, a, o, u, c;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            return i = _o.of(this._iid), s = i.dispatcher, a = i.requestQueue, o = new Pn$1({
              channelType: this.channelType,
              channelUrl: this.url,
              messageId: e,
              metaArrayParams: {
                array: t,
                mode: n,
                upsert: r
              }
            }), [4, a.send(o)];

          case 1:
            return u = l.sent(), c = u.as(kn$1).message, s.dispatch(new No({
              messages: [c],
              source: po.EVENT_MESSAGE_UPDATED
            })), [2, c];
        }
      });
    });
  }, n.prototype._updateFileMessageMetaArray = function (e, t, n, r) {
    return i$1(this, void 0, void 0, function () {
      var i, s, a, o, u, c;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            return i = _o.of(this._iid), s = i.dispatcher, a = i.requestQueue, o = new Rn$1({
              channelType: this.channelType,
              channelUrl: this.url,
              messageId: e,
              metaArrayParams: {
                array: t,
                mode: n,
                upsert: r
              }
            }), [4, a.send(o)];

          case 1:
            return u = l.sent(), c = u.as(xn$1).message, s.dispatch(new No({
              messages: [c],
              source: po.EVENT_MESSAGE_UPDATED
            })), [2, c];
        }
      });
    });
  }, n.prototype.createMessageMetaArrayKeys = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        return Qi$1(e instanceof Le && e.messageId > 0 && S$2("string", t)).throw(v$2.invalidParameters), n = t.map(function (e) {
          return new Oe$2({
            key: e
          });
        }), e instanceof He$2 ? [2, this._updateFileMessageMetaArray(e.messageId, n, "add", !0)] : [2, this._updateUserMessageMetaArray(e.messageId, n, "add", !0)];
      });
    });
  }, n.prototype.deleteMessageMetaArrayKeys = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (r) {
        return Qi$1(e instanceof Le && e.messageId > 0 && S$2("string", t)).throw(v$2.invalidParameters), n = t.map(function (e) {
          return new Oe$2({
            key: e
          });
        }), e instanceof He$2 ? [2, this._updateFileMessageMetaArray(e.messageId, n, "remove", !0)] : [2, this._updateUserMessageMetaArray(e.messageId, n, "remove", !0)];
      });
    });
  }, n.prototype.addMessageMetaArrayValues = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        return Qi$1(e instanceof Le && e.messageId > 0 && t.every(function (e) {
          return e instanceof Oe$2;
        })).throw(v$2.invalidParameters), e instanceof He$2 ? [2, this._updateFileMessageMetaArray(e.messageId, t, "add", !0)] : [2, this._updateUserMessageMetaArray(e.messageId, t, "add", !0)];
      });
    });
  }, n.prototype.removeMessageMetaArrayValues = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        return Qi$1(e instanceof Le && e.messageId > 0 && t.every(function (e) {
          return e instanceof Oe$2;
        })).throw(v$2.invalidParameters), e instanceof He$2 ? [2, this._updateFileMessageMetaArray(e.messageId, t, "remove", !0)] : [2, this._updateUserMessageMetaArray(e.messageId, t, "remove", !0)];
      });
    });
  }, n.prototype.report = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return Qi$1(N$1(Mt$1, e) && w$1("string", t)).throw(v$2.invalidParameters), n = _o.of(this._iid), r = n.sdkState, i = n.requestQueue, s = new An$1({
              channelUrl: this.url,
              channelType: this.channelType,
              userId: r.userId,
              category: e,
              description: t
            }), [4, i.send(s)];

          case 1:
            return a.sent(), [2];
        }
      });
    });
  }, n.prototype.reportUser = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      var r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(e instanceof Xi$1 && N$1(Mt$1, t) && w$1("string", n)).throw(v$2.invalidParameters), r = _o.of(this._iid), i = r.sdkState, s = r.requestQueue, a = new Nn$1({
              channelUrl: this.url,
              channelType: this.channelType,
              userId: i.userId,
              offendingUserId: e.userId,
              category: t,
              description: n
            }), [4, s.send(a)];

          case 1:
            return o.sent(), [2];
        }
      });
    });
  }, n.prototype.reportMessage = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      var r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(e instanceof De$2 && N$1(Mt$1, t) && w$1("string", n)).throw(v$2.invalidParameters), r = _o.of(this._iid), i = r.sdkState, s = r.requestQueue, a = new Un$1({
              channelUrl: this.url,
              channelType: this.channelType,
              userId: i.userId,
              offendingUserId: e.sender.userId,
              messageId: e.messageId,
              category: t,
              description: n
            }), [4, s.send(a)];

          case 1:
            return o.sent(), [2];
        }
      });
    });
  }, n.prototype.updatePoll = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(w$1("number", e) && function (e) {
              return w$1("string", e.title, !0) && vo(e.data) && w$1("boolean", e.allowUserSuggestion, !0) && w$1("boolean", e.allowMultipleVotes, !0) && w$1("number", e.closeAt, !0);
            }(t)).throw(v$2.invalidParameters), n = _o.of(this._iid).requestQueue, r = new Hn$1(n$1({
              pollId: e
            }, t)), [4, n.send(r)];

          case 1:
            return i = s.sent(), [2, i.as(Yn$1).poll];
        }
      });
    });
  }, n.prototype.deletePoll = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return t = w$1("number", e), Qi$1(t).throw(v$2.invalidParameters), n = _o.of(this._iid).requestQueue, r = new Jn$1({
              pollId: e
            }), [4, n.send(r)];

          case 1:
            return i.sent(), [2];
        }
      });
    });
  }, n.prototype.closePoll = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return t = w$1("number", e), Qi$1(t).throw(v$2.invalidParameters), n = _o.of(this._iid).requestQueue, r = new Xn$1({
              pollId: e
            }), [4, n.send(r)];

          case 1:
            return i = s.sent(), [2, i.as(Zn$1).poll];
        }
      });
    });
  }, n.prototype.addPollOption = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return n = w$1("number", e) && w$1("string", t) && "" !== t.trim(), Qi$1(n).throw(v$2.invalidParameters), r = _o.of(this._iid).requestQueue, i = new $n$1({
              channelUrl: this.url,
              channelType: this.channelType,
              pollId: e,
              optionText: t
            }), [4, r.send(i)];

          case 1:
            return s = a.sent(), [2, s.as(er$1).poll];
        }
      });
    });
  }, n.prototype.updatePollOption = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      var r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return r = w$1("number", e) && w$1("number", t) && w$1("string", n) && "" !== n.trim(), Qi$1(r).throw(v$2.invalidParameters), i = _o.of(this._iid).requestQueue, s = new tr$1({
              pollId: e,
              pollOptionId: t,
              optionText: n
            }), [4, i.send(s)];

          case 1:
            return a = o.sent(), [2, a.as(nr$1).poll];
        }
      });
    });
  }, n.prototype.deletePollOption = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return n = w$1("number", e) && w$1("number", t), Qi$1(n).throw(v$2.invalidParameters), r = _o.of(this._iid).requestQueue, i = new rr({
              pollId: e,
              pollOptionId: t
            }), [4, r.send(i)];

          case 1:
            return s.sent(), [2];
        }
      });
    });
  }, n.prototype.votePoll = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s, a, o, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return n = w$1("number", e) && S$2("number", t), Qi$1(n).throw(v$2.invalidParameters), r = _o.of(this._iid), i = r.requestQueue, s = r.dispatcher, a = new sr$1({
              reqId: this._generateRequestId(),
              channelUrl: this.url,
              channelType: this.channelType,
              pollId: e,
              pollOptionIds: t
            }), [4, i.send(a)];

          case 1:
            return o = c.sent(), u = o.as(ar).event, s.dispatch(new ko({
              event: u,
              source: po.EVENT_POLL_VOTED
            })), [2, u];
        }
      });
    });
  }, n.prototype.getPollChangeLogsSinceTimestamp = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return Qi$1(w$1("number", e)).throw(v$2.invalidParameters), [4, Zo.of(this._iid).getPollChangeLogs(this.url, this.channelType, e)];

          case 1:
            return [2, t.sent()];
        }
      });
    });
  }, n.prototype.getPollChangeLogsSinceToken = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return Qi$1(w$1("string", e, !0)), [4, Zo.of(this._iid).getPollChangeLogs(this.url, this.channelType, e)];

          case 1:
            return [2, t.sent()];
        }
      });
    });
  }, n.prototype.createPollListQuery = function (e) {
    return void 0 === e && (e = 10), new Yo(this._iid, {
      channelUrl: this.url,
      channelType: this.channelType,
      limit: e
    });
  }, n.prototype.createPollVoterListQuery = function (e, t, n) {
    return void 0 === n && (n = 20), new $o(this._iid, {
      channelUrl: this.url,
      channelType: this.channelType,
      pollId: e,
      pollOptionId: t,
      limit: n
    });
  }, n;
}(Fi$1),
    Tr = function (t) {
  function n(e) {
    void 0 === e && (e = {});
    var n = t.call(this) || this;
    return Object.keys(e).forEach(function (t) {
      n.hasOwnProperty(t) && (n[t] = e[t]);
    }), n;
  }

  return t$1(n, t), n;
}(function () {
  this.onConnected = ze$2, this.onReconnectStarted = ze$2, this.onReconnectSucceeded = ze$2, this.onReconnectFailed = ze$2, this.onDisconnected = ze$2;
}),
    wr = function (t) {
  function n(e) {
    void 0 === e && (e = {});
    var n = t.call(this) || this;
    return Object.keys(e).forEach(function (t) {
      n.hasOwnProperty(t) && (n[t] = e[t]);
    }), n;
  }

  return t$1(n, t), n;
}(function () {
  this.onSessionExpired = ze$2, this.onSessionTokenRequired = function (e) {
    return e(null);
  }, this.onSessionError = ze$2, this.onSessionRefreshed = ze$2, this.onSessionClosed = ze$2;
}),
    Mr = function (t) {
  function n(e) {
    void 0 === e && (e = {});
    var n = t.call(this) || this;
    return Object.keys(e).forEach(function (t) {
      n.hasOwnProperty(t) && (n[t] = e[t]);
    }), n;
  }

  return t$1(n, t), n;
}(function () {
  this.onFriendsDiscovered = ze$2, this.onTotalUnreadMessageCountChanged = ze$2, this.onTotalUnreadMessageCountUpdated = ze$2;
}),
    Sr = function (n) {
  function i(e) {
    var i = e.limit,
        s = e.token,
        a = e.userIdsFilter,
        o = e.metaDataKeyFilter,
        u = e.metaDataValuesFilter,
        c = e.nicknameStartsWithFilter,
        l = n.call(this) || this;
    return l.method = ee.GET, l.path = ne, l.params = J({
      limit: i,
      token: s,
      user_ids: a,
      metadatakey: o,
      metadatavalues_in: u,
      nickname_startswith: c
    }), l;
  }

  return t$1(i, n), i;
}(Ne$2),
    Ar = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.users = n.users.map(function (t) {
      return new Xi$1(e, t);
    }), r.next = n.next, r;
  }

  return t$1(n, t), n;
}(Te$2),
    Nr = function (t) {
  function n(e, n) {
    var r,
        i,
        s,
        a = this;
    return (a = t.call(this, e, n) || this).userIdsFilter = null, a.metaDataKeyFilter = null, a.metaDataValuesFilter = null, a.nicknameStartsWithFilter = null, a.userIdsFilter = null !== (r = n.userIdsFilter) && void 0 !== r ? r : null, a.metaDataKeyFilter = null !== (i = n.metaDataKeyFilter) && void 0 !== i ? i : null, a.metaDataValuesFilter = null !== (s = n.metaDataValuesFilter) && void 0 !== s ? s : null, a.nicknameStartsWithFilter = n.nicknameStartsWithFilter || null, a;
  }

  return t$1(n, t), n.prototype._validate = function () {
    return t.prototype._validate.call(this) && S$2("string", this.userIdsFilter, !0) && w$1("string", this.metaDataKeyFilter, !0) && S$2("string", this.metaDataValuesFilter, !0) && w$1("string", this.metaDataKeyFilter, !0);
  }, n.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, t = new Sr($(n$1(n$1({}, this), {
              token: this._token
            }))), [4, e.send(t)]) : [3, 2] : [3, 5];

          case 1:
            return n = u.sent(), r = n.as(Ar), i = r.users, s = r.next, this._token = s, this._hasNext = !!s, this._isLoading = !1, [2, i];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, n;
}(Oo),
    Ur = function (n) {
  function i(e) {
    var i = e.userId,
        s = e.limit,
        a = e.token,
        o = e.userIdsFilter,
        u = n.call(this) || this;
    return u.method = ee.GET, u.path = "".concat(ne, "/").concat(i, "/block"), u.params = J({
      limit: s,
      token: a,
      user_ids: o
    }), u;
  }

  return t$1(i, n), i;
}(Ne$2),
    Or = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.users = n.users.map(function (t) {
      return new Xi$1(e, t);
    }), r.next = n.next, r;
  }

  return t$1(n, t), n;
}(Te$2),
    Cr = function (t) {
  function n(e, n) {
    var r,
        i = this;
    return (i = t.call(this, e, n) || this).userIdsFilter = null, i.userIdsFilter = null !== (r = n.userIdsFilter) && void 0 !== r ? r : null, i;
  }

  return t$1(n, t), n.prototype._validate = function () {
    return t.prototype._validate.call(this) && S$2("string", this.userIdsFilter, !0);
  }, n.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s, u, c;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, r = new Ur($(n$1(n$1({}, this), {
              userId: t.userId,
              token: this._token
            }))), [4, n.send(r)]) : [3, 2] : [3, 5];

          case 1:
            return i = l.sent(), s = i.as(Or), u = s.users, c = s.next, this._token = c, this._hasNext = !!c, this._isLoading = !1, [2, u];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, n;
}(Oo),
    Pr = function (n) {
  function r(e) {
    var r = e.userId,
        i = e.limit,
        s = e.token,
        a = n.call(this) || this;
    return a.method = ee.GET, a.path = "".concat(ne, "/").concat(encodeURIComponent(r), "/friends"), a.params = {
      limit: i,
      token: s
    }, a;
  }

  return t$1(r, n), r;
}(Ne$2),
    kr = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.hasMore = n.has_more, r.users = n.users.map(function (t) {
      return new Xi$1(e, t);
    }), r.next = n.next, r;
  }

  return t$1(n, t), n;
}(Te$2),
    Rr = function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  return t$1(n, t), n.prototype._validate = function () {
    return t.prototype._validate.call(this);
  }, n.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s, a, u, c;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, r = new Pr(n$1(n$1({}, this), {
              userId: t.userId,
              token: this._token
            })), [4, n.send(r)]) : [3, 2] : [3, 5];

          case 1:
            return i = l.sent(), s = i.as(kr), a = s.users, u = s.hasMore, c = s.next, this._token = c, this._hasNext = u, this._isLoading = !1, [2, a];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, n;
}(Oo),
    xr = {},
    Lr = function () {
  function e(e) {
    var t = e.dbname,
        n = e.itemSizeLimit,
        r = void 0 === n ? 1048576 : n,
        i = e.cacheLimit,
        s = void 0 === i ? 256 : i,
        a = e.blockHashBase,
        o = void 0 === a ? 2 : a,
        u = e.blockHashMultiplier,
        c = void 0 === u ? 10 : u,
        l = e.blockHashConstant,
        d = void 0 === l ? 11 : l,
        h = e.transactionApplyDelay,
        f = void 0 === h ? 200 : h,
        p = e.disableLogger,
        m = void 0 !== p && p;
    return xr[t] || (this.itemSizeLimit = r, this.cacheLimit = s, this.blockHashBase = o, this.blockHashMultiplier = c, this.blockHashConstant = d, this.transactionApplyDelay = f, this.disableLogger = m, xr[t] = this), xr[t];
  }

  return e.get = function (e) {
    return xr[e];
  }, e;
}();

!function (e) {
  e[e.UNKNOWN_ERROR = 6e7] = "UNKNOWN_ERROR", e[e.STORE_NOT_DEFINED = 61001e3] = "STORE_NOT_DEFINED", e[e.STORE_NOT_AVAILABLE = 61001001] = "STORE_NOT_AVAILABLE", e[e.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING = 61001002] = "STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING", e[e.STORE_IS_FULL = 61001003] = "STORE_IS_FULL", e[e.STORE_NOT_INITIALIZED = 61001004] = "STORE_NOT_INITIALIZED", e[e.STORE_INVALID_KEY_TYPE = 61002e3] = "STORE_INVALID_KEY_TYPE", e[e.STORE_BROKEN_INTEGRITY = 61002001] = "STORE_BROKEN_INTEGRITY", e[e.STORE_BROKEN_BLOB = 61002002] = "STORE_BROKEN_BLOB", e[e.STORE_ENCRYPTION_INVALID = 61002003] = "STORE_ENCRYPTION_INVALID", e[e.STORE_ITEM_SIZE_LIMIT_EXCEEDED = 61017e3] = "STORE_ITEM_SIZE_LIMIT_EXCEEDED", e[e.STORE_READ_FAILED = 61017001] = "STORE_READ_FAILED", e[e.STORE_WRITE_FAILED = 61017002] = "STORE_WRITE_FAILED", e[e.DATABASE_SCHEMA_NOT_ON_UPGRADE = 62002e3] = "DATABASE_SCHEMA_NOT_ON_UPGRADE", e[e.COLLECTION_NOT_READY = 63001e3] = "COLLECTION_NOT_READY", e[e.COLLECTION_KEY_NOT_MATCH = 63002e3] = "COLLECTION_KEY_NOT_MATCH", e[e.COLLECTION_QUERY_NOT_VALID = 63002001] = "COLLECTION_QUERY_NOT_VALID", e[e.COLLECTION_KEY_NOT_FOUND = 63004e3] = "COLLECTION_KEY_NOT_FOUND", e[e.COLLECTION_KEY_NOT_GIVEN = 63004001] = "COLLECTION_KEY_NOT_GIVEN", e[e.COLLECTION_INSERT_DUPLICATE = 63009e3] = "COLLECTION_INSERT_DUPLICATE", e[e.COLLECTION_WRITE_FAILED = 63017e3] = "COLLECTION_WRITE_FAILED", e[e.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED = 63017001] = "COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED", e[e.INDEX_TABLE_IS_REQUIRED = 65001e3] = "INDEX_TABLE_IS_REQUIRED", e[e.INDEX_TYPE_NOT_MATCH = 65002e3] = "INDEX_TYPE_NOT_MATCH", e[e.COMPARE_TYPE_NOT_MATCH = 69002001] = "COMPARE_TYPE_NOT_MATCH", e[e.CIRCULAR_REFERENCE_FOUND = 69002002] = "CIRCULAR_REFERENCE_FOUND";
}(ir || (ir = {}));

var Dr,
    qr = function (t) {
  function n(e) {
    var r = e.code,
        i = void 0 === r ? ir.UNKNOWN_ERROR : r,
        s = e.message,
        a = void 0 === s ? "Unknown error occurred." : s,
        o = t.call(this, a) || this;
    return o.code = i, Object.setPrototypeOf(o, n.prototype), o;
  }

  return t$1(n, t), Object.defineProperty(n, "storeNotDefined", {
    get: function () {
      return new n({
        code: ir.STORE_NOT_DEFINED,
        message: "Store is not defined. Specify the store on NestDB()"
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeNotAvailable", {
    get: function () {
      return new n({
        code: ir.STORE_NOT_AVAILABLE,
        message: "Store is not available. Check your environment settings."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeNotAvailableInPrivateBrowsing", {
    get: function () {
      return new n({
        code: ir.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,
        message: "Store is not available because it is in private browsing."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeIsFull", {
    get: function () {
      return new n({
        code: ir.STORE_IS_FULL,
        message: "Store is full."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeNotInitialized", {
    get: function () {
      return new n({
        code: ir.STORE_NOT_INITIALIZED,
        message: "Store is not initialized."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeKeyTypeIsInvalid", {
    get: function () {
      return new n({
        code: ir.STORE_INVALID_KEY_TYPE,
        message: "Store key should be string type."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeBrokenIntegrity", {
    get: function () {
      return new n({
        code: ir.STORE_BROKEN_INTEGRITY,
        message: "Data should be in a store but it does not. Integrity is broken."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeBrokenBlob", {
    get: function () {
      return new n({
        code: ir.STORE_BROKEN_BLOB,
        message: "Data should be in a store but it does not. Blob data is broken."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeEncryptionInvalid", {
    get: function () {
      return new n({
        code: ir.STORE_ENCRYPTION_INVALID,
        message: "Encryption algorithm has changed. All the store should reset."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeItemSizeExceeded", {
    get: function () {
      return new n({
        code: ir.STORE_ITEM_SIZE_LIMIT_EXCEEDED,
        message: "The size of the item exceeds the limit that the store allows."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeReadFailed", {
    get: function () {
      return new n({
        code: ir.STORE_READ_FAILED,
        message: "Failed to read from store."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "storeWriteFailed", {
    get: function () {
      return new n({
        code: ir.STORE_WRITE_FAILED,
        message: "Failed to write to store."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "databaseSchemaNotOnUpgrade", {
    get: function () {
      return new n({
        code: ir.DATABASE_SCHEMA_NOT_ON_UPGRADE,
        message: "Committing schema is not allowed when upgrade is not running."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "collectionNotReady", {
    get: function () {
      return new n({
        code: ir.COLLECTION_NOT_READY,
        message: "Collection is not ready due to an error during initialization."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "collectionKeyNotMatch", {
    get: function () {
      return new n({
        code: ir.COLLECTION_KEY_NOT_MATCH,
        message: "keyName of collection could not change."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "collectionQueryNotValid", {
    get: function () {
      return new n({
        code: ir.COLLECTION_QUERY_NOT_VALID,
        message: "Query parameter is not a valid format."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "collectionInsertDuplicate", {
    get: function () {
      return new n({
        code: ir.COLLECTION_INSERT_DUPLICATE,
        message: "The key already exists."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "collectionKeyNotFound", {
    get: function () {
      return new n({
        code: ir.COLLECTION_KEY_NOT_FOUND,
        message: "The key is not found."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "collectionKeyNotGiven", {
    get: function () {
      return new n({
        code: ir.COLLECTION_KEY_NOT_GIVEN,
        message: "The item should contain [keyName] property."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "collectionWriteFailed", {
    get: function () {
      return new n({
        code: ir.COLLECTION_WRITE_FAILED,
        message: "Failed to write an item."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "collectionItemSizeExceeded", {
    get: function () {
      return new n({
        code: ir.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,
        message: "The size of the item exceeds the limit that a collection allows."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "indexTableIsRequired", {
    get: function () {
      return new n({
        code: ir.INDEX_TABLE_IS_REQUIRED,
        message: "Index table is required."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "indexTypesNotMatch", {
    get: function () {
      return new n({
        code: ir.INDEX_TYPE_NOT_MATCH,
        message: "Indexed column should have primitive type."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "compareTypesNotMatch", {
    get: function () {
      return new n({
        code: ir.COMPARE_TYPE_NOT_MATCH,
        message: "Values to compare have different types."
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n, "circularReferenceFound", {
    get: function () {
      return new n({
        code: ir.CIRCULAR_REFERENCE_FOUND,
        message: "Cannot handle circular referenced object."
      });
    },
    enumerable: !1,
    configurable: !0
  }), n;
}(Error);

!function (e) {
  e.INIT = "init", e.READY = "ready", e.CLOSED = "closed";
}(Dr || (Dr = {}));

var Fr,
    zr = function (e, t) {
  if (void 0 === t && (t = new WeakMap()), "object" == typeof e && null !== e) {
    if (t.has(e)) throw qr.circularReferenceFound;
    t.set(e, !0);
    var n = void 0;
    if (Array.isArray(e)) n = e.map(function (e) {
      return zr(e, t);
    });else if (e instanceof RegExp) n = e;else if (e instanceof Date) n = e;else for (var r in n = {}, e) n[r] = zr(e[r], t);
    return t.delete(e), n;
  }

  return e;
},
    Br = function (e, t) {
  if (null == t) return 1;
  if (null == e) return -1;
  if (typeof e != typeof t) throw qr.compareTypesNotMatch;
  var n = 0;

  switch (typeof e) {
    case "boolean":
    case "number":
      n = e - t;
      break;

    case "string":
      n = e.localeCompare(t);
  }

  return n;
},
    Kr = function (e, t) {
  for (var n = 0, r = 0; r < e.length; r++) n = e.charCodeAt(r) + (n << 6) + (n << 16) - n;

  return (n >>> 0) % t;
},
    jr = function (e) {
  return new Promise(function (t) {
    setTimeout(function () {
      return t();
    }, e);
  });
},
    Qr = function (e, t) {
  if (!t) return !1;

  if ("function" != typeof e) {
    for (var n in e) {
      if (["/and", "&&"].includes(n)) {
        if (e[n].some(function (e) {
          return !Qr(e, t);
        })) return !1;
      } else if (["/or", "||"].includes(n)) {
        if (e[n].every(function (e) {
          return !Qr(e, t);
        })) return !1;
      } else if ("/where" === n) {
        if (!(0, e[n])(t)) return !1;
      } else {
        var r = n;

        if ("object" == typeof e[r]) {
          var i = e[r];

          for (var s in i) switch (s) {
            case "/eq":
            case "=":
              if ((a = t[r]) !== (o = i[s])) return !1;
              break;

            case "/neq":
            case "!=":
              if ((a = t[r]) === (o = i[s])) return !1;
              break;

            case "/gt":
            case ">":
              var a = t[r],
                  o = i[s];
              if (!(Br(a, o) > 0)) return !1;
              break;

            case "/gte":
            case ">=":
              a = t[r], o = i[s];
              if (!(Br(a, o) >= 0)) return !1;
              break;

            case "/lt":
            case "<":
              a = t[r], o = i[s];
              if (!(Br(a, o) < 0)) return !1;
              break;

            case "/lte":
            case "<=":
              a = t[r], o = i[s];
              if (!(Br(a, o) <= 0)) return !1;
              break;

            case "/in":
              a = t[r];
              if (!(o = i[s]).includes(a)) return !1;
              break;

            case "/nin":
              a = t[r];
              if ((o = i[s]).includes(a)) return !1;
              break;

            case "/contain":
              a = t[r], o = i[s];
              if (!a.includes(o)) return !1;
              break;

            case "/regex":
              a = t[r];
              if (!(o = i[s]).test(a)) return !1;
              break;

            case "/where":
              a = t[r];
              if (!(0, i[s])(a)) return !1;
          }
        } else if ("function" == typeof e[r]) {
          if (!e[r](t[r])) return !1;
        } else if (e[r] !== t[r]) return !1;
      }
    }

    return !0;
  }

  return e(t);
},
    Gr = function () {},
    Vr = function () {
  return Promise.resolve();
},
    Wr = function (e) {
  return e;
},
    Hr = function (e, t) {
  t();
};

!function (e) {
  e[e.FORWARD = 0] = "FORWARD", e[e.BACKWARD = 1] = "BACKWARD";
}(Fr || (Fr = {}));

var Yr,
    Jr,
    Xr,
    Zr = function () {
  function e(e) {
    var t = e.initialPrevValue,
        n = void 0 === t ? null : t,
        r = e.initialNextValue,
        i = void 0 === r ? null : r,
        s = e.iterator,
        a = e.map,
        o = void 0 === a ? Wr : a,
        u = e.backward,
        c = void 0 === u ? Vr : u,
        l = e.forward,
        d = void 0 === l ? Vr : l,
        h = e.complete,
        f = void 0 === h ? Gr : h;
    this._prevValue = n, this._nextValue = i, this._error = null, this._map = o, this._backward = c, this._forward = d, this._iterator = s, this._complete = f;
  }

  return Object.defineProperty(e.prototype, "prevValue", {
    get: function () {
      return this._map(this._prevValue);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "nextValue", {
    get: function () {
      return this._map(this._nextValue);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "error", {
    get: function () {
      return this._error;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "hasPrevious", {
    get: function () {
      return !!this._prevValue;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "hasNext", {
    get: function () {
      return !!this._nextValue;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.prev = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            if (!this.hasPrevious) return [3, 6];
            r.label = 1;

          case 1:
            return r.trys.push([1, 3,, 4]), e = this._prevValue, t = this, [4, this._backward()];

          case 2:
            return t._prevValue = r.sent() || null, this._nextValue = e, [3, 4];

          case 3:
            return n = r.sent(), this._error = n, [3, 4];

          case 4:
            return [4, this._iterator(this)];

          case 5:
            return [2, r.sent()];

          case 6:
            this._complete(), r.label = 7;

          case 7:
            return [2];
        }
      });
    });
  }, e.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            if (!this.hasNext) return [3, 6];
            r.label = 1;

          case 1:
            return r.trys.push([1, 3,, 4]), e = this._nextValue, t = this, [4, this._forward()];

          case 2:
            return t._nextValue = r.sent() || null, this._prevValue = e, [3, 4];

          case 3:
            return n = r.sent(), this._error = n, [3, 4];

          case 4:
            return [4, this._iterator(this)];

          case 5:
            return [2, r.sent()];

          case 6:
            this._complete(), r.label = 7;

          case 7:
            return [2];
        }
      });
    });
  }, e.prototype.stop = function () {
    this._prevValue = null, this._nextValue = null, this._complete();
  }, e;
}(),
    $r = function () {
  function e(e) {
    var t = e.condition,
        n = void 0 === t ? {} : t,
        r = e.backward,
        i = void 0 !== r && r,
        s = e.blockManager,
        a = e.indexer;
    this.condition = n, this.backward = i, this._blockManager = s, this._indexer = a;
  }

  return e.prototype.findOptimizedStartPosition = function () {
    var e = this,
        t = ["=", "/eq", ">", ">=", "/gt", "/gte"],
        n = ["=", "/eq", "<", "<=", "/lt", "/lte"];

    if (this.backward) {
      var r = this._indexer.origin.length - 1;
      if ("function" != typeof this.condition) for (var i in this._indexer.fields) {
        var s = this._indexer.fields[i],
            a = 1;
        if ("-" === s[0] && (s = s.slice(1), a = -1), this.condition[s]) if ("object" == typeof this.condition[s]) {
          var o = a > 0 ? n : t;

          for (var u in this.condition[s]) if (o.includes(u)) for (var c = r; c >= 0; c--) if (a * Br(this._indexer.origin[c].columnValues[i], this.condition[s][u]) <= 0) {
            r = c;
            break;
          }
        } else for (c = r; c >= 0; c--) if (a * Br(this._indexer.origin[c].columnValues[i], this.condition[s]) <= 0) {
          r = c;
          break;
        }
      }
      return Math.min(r + 1, this._indexer.origin.length - 1);
    }

    var l = 0;
    if ("function" != typeof this.condition) for (var d = function (r) {
      var i = h._indexer.fields[r],
          s = 1;
      if ("-" === i[0] && (i = i.slice(1), s = -1), h.condition[i]) if ("object" == typeof h.condition[i]) Object.keys(h.condition[i]).forEach(function (a) {
        if ((s > 0 ? t : n).includes(a)) for (var o = l; o < e._indexer.origin.length; o++) if (s * Br(e._indexer.origin[o].columnValues[r], e.condition[i][a]) >= 0) {
          l = o;
          break;
        }
      });else for (var a = l; a < h._indexer.origin.length; a++) if (s * Br(h._indexer.origin[a].columnValues[r], h.condition[i]) >= 0) {
        l = a;
        break;
      }
    }, h = this, i = 0; i < this._indexer.fields.length; i++) d(i);
    return Math.max(l - 1, 0);
  }, e.prototype.each = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i,
          s,
          a,
          o,
          u = this;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            if (t = this.findOptimizedStartPosition(), n = 0, this.backward && this._indexer.origin[t] && (n = this._indexer.origin[t].keys.length - 1), r = function () {
              if (u._indexer.origin[t]) {
                if (!u._indexer.origin[t].keys[++n]) {
                  if (!u._indexer.origin[++t]) return !1;
                  n = 0;
                }

                return !0;
              }

              return !1;
            }, i = function () {
              if (u._indexer.origin[t]) {
                if (!u._indexer.origin[t].keys[--n]) {
                  if (!u._indexer.origin[--t]) return !1;
                  n = u._indexer.origin[t].keys.length - 1;
                }

                return !0;
              }

              return !1;
            }, s = null, !this._indexer.origin[t]) return [3, 4];
            a = this.backward ? i : r, c.label = 1;

          case 1:
            return [4, this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])];

          case 2:
            if ((o = c.sent()) && Qr(this.condition, o)) return s = o, [3, 4];
            c.label = 3;

          case 3:
            if (a()) return [3, 1];
            c.label = 4;

          case 4:
            return [4, new Promise(function (a) {
              var o = new Zr({
                initialNextValue: zr(s),
                iterator: e,
                forward: function () {
                  return i$1(u, void 0, void 0, function () {
                    var e, s;
                    return o$1(this, function (a) {
                      switch (a.label) {
                        case 0:
                          e = this.backward ? i : r, a.label = 1;

                        case 1:
                          return e() ? [4, this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])] : [3, 3];

                        case 2:
                          return (s = a.sent()) && Qr(this.condition, s) ? [2, zr(s)] : [3, 1];

                        case 3:
                          return [2, null];
                      }
                    });
                  });
                },
                backward: function () {
                  return i$1(u, void 0, void 0, function () {
                    var e, s;
                    return o$1(this, function (a) {
                      switch (a.label) {
                        case 0:
                          e = this.backward ? r : i, a.label = 1;

                        case 1:
                          return e() ? [4, this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])] : [3, 3];

                        case 2:
                          return (s = a.sent()) && Qr(this.condition, s) ? [2, zr(s)] : [3, 1];

                        case 3:
                          return [2, null];
                      }
                    });
                  });
                },
                complete: a
              });
              e(o);
            })];

          case 5:
            return [2, c.sent()];
        }
      });
    });
  }, e;
}(),
    ei = function () {
  function e(e) {
    var t = e.condition,
        n = void 0 === t ? {} : t,
        r = e.backward,
        i = void 0 !== r && r,
        s = e.mutex,
        a = e.blockManager,
        o = e.indexer;
    this._mutex = s, this._iterator = new $r({
      condition: n,
      backward: i,
      blockManager: a,
      indexer: o
    });
  }

  return e.prototype.fetch = function (e) {
    return void 0 === e && (e = {}), i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i,
          s = this;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            if (t = Math.max(e.offset || 0, 0), 0 === (n = "number" == typeof e.limit ? e.limit : Number.MAX_SAFE_INTEGER)) return [2, []];
            if (n < 0) throw qr.collectionQueryNotValid;
            a.label = 1;

          case 1:
            return a.trys.push([1, 4,, 5]), r = [], [4, this._mutex.lock()];

          case 2:
            return a.sent(), [4, this._iterator.each(function (e) {
              return i$1(s, void 0, void 0, function () {
                return o$1(this, function (i) {
                  return e.error ? e.stop() : e.hasNext ? 0 === t ? (r.push(e.nextValue), 0 < n && n <= r.length ? e.stop() : e.next()) : (t--, e.next()) : e.stop(), [2];
                });
              });
            })];

          case 3:
            return a.sent(), this._mutex.unlock(), [2, r];

          case 4:
            throw i = a.sent(), this._mutex.unlock(), i;

          case 5:
            return [2];
        }
      });
    });
  }, e.prototype.count = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t,
          n = this;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return r.trys.push([0, 3,, 4]), e = 0, [4, this._mutex.lock()];

          case 1:
            return r.sent(), [4, this._iterator.each(function (t) {
              return i$1(n, void 0, void 0, function () {
                return o$1(this, function (n) {
                  return t.error ? t.stop() : t.hasNext ? (e++, t.next()) : t.stop(), [2];
                });
              });
            })];

          case 2:
            return r.sent(), this._mutex.unlock(), [2, e];

          case 3:
            throw t = r.sent(), this._mutex.unlock(), t;

          case 4:
            return [2];
        }
      });
    });
  }, e;
}(),
    ti = function (e) {
  return "".concat("nest", "@").concat(e);
},
    ni = function (e, t) {
  return "".concat(ti(e), "/").concat(t);
},
    ri = function (e, t) {
  return "".concat(ni(e, t), ".metadata");
},
    ii = function (e, t) {
  return "".concat(ni(e, t), "/block.");
},
    si = function (e, t) {
  return "".concat(ni(e, t), "/blob.");
},
    ai = function () {
  function e(e) {
    var t = e.dbname,
        n = e.collectionName,
        r = e.store;
    this.dbname = t, this.collectionName = n, this.store = r;
  }

  return e.prototype.get = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a, o, u, c;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            return [4, this.store.get(e)];

          case 1:
            return (t = l.sent()) ? (n = t.data, r = t.type, "undefined" == typeof fetch ? [3, 4] : [4, fetch(n)]) : [3, 5];

          case 2:
            return [4, l.sent().blob()];

          case 3:
            return [2, l.sent()];

          case 4:
            for (i = [], s = atob(n.split(",")[1]), a = 0; a < s.length; a += 512) {
              for (o = s.slice(a, a + 512), u = new Array(o.length), c = 0; c < o.length; c++) u[c] = o.charCodeAt(c);

              i.push(new Uint8Array(u));
            }

            return [2, new Blob(i, {
              type: r
            })];

          case 5:
            return [2, null];
        }
      });
    });
  }, e.prototype.save = function (e, t) {
    return void 0 === t && (t = "".concat(Date.now())), i$1(this, void 0, void 0, function () {
      var n,
          r,
          i,
          s,
          a = this;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return [4, new Promise(function (n) {
              var r = function (e, t, n, r) {
                return void 0 === r && (r = 0), "".concat(si(e, t)).concat(n, ".").concat(r);
              }(a.dbname, a.collectionName, t),
                  i = new FileReader();

              i.onload = function () {
                n({
                  blobId: r,
                  data: i.result,
                  type: e.type
                });
              }, i.readAsDataURL(e);
            })];

          case 1:
            return n = o.sent(), r = n.blobId, i = n.data, s = n.type, [4, this.store.set({
              key: r,
              value: {
                data: i,
                type: s
              }
            })];

          case 2:
            return o.sent(), [2, r];
        }
      });
    });
  }, e.prototype.remove = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this.store.remove(e)];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, e.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t,
          n = this;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return e = si(this.dbname, this.collectionName), [4, this.store.getAllKeys()];

          case 1:
            return t = r.sent(), [4, Promise.all(t.filter(function (t) {
              return t.startsWith(e);
            }).map(function (e) {
              return i$1(n, void 0, void 0, function () {
                return o$1(this, function (t) {
                  switch (t.label) {
                    case 0:
                      return [4, this.store.remove(e)];

                    case 1:
                      return [2, t.sent()];
                  }
                });
              });
            }))];

          case 2:
            return r.sent(), [2];
        }
      });
    });
  }, e;
}();

!function (e) {
  e[e.COMMIT = 0] = "COMMIT", e[e.WRITE = 1] = "WRITE", e[e.ERROR = 2] = "ERROR";
}(Yr || (Yr = {})), function (e) {
  e.PENDING = "pending", e.PERSISTENT = "persistent", e.VOLATILE = "volatile";
}(Jr || (Jr = {})), function (e) {
  e[e.NO_CACHE = 0] = "NO_CACHE", e[e.DEFAULT = 1] = "DEFAULT", e[e.PERSISTENT = 2] = "PERSISTENT";
}(Xr || (Xr = {}));

var oi,
    ui,
    ci = [Jr.PENDING, Jr.VOLATILE],
    li = {},
    di = function () {
  function e(e) {
    var t = e.dbname,
        n = e.limit,
        r = void 0 === n ? 256 : n;
    return li[t] || (this.dbname = t, this._items = [], this._limit = r, li[t] = this), li[t];
  }

  return e.get = function (e) {
    return li[e];
  }, Object.defineProperty(e.prototype, "items", {
    get: function () {
      return this._items;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.find = function (e, t, n) {
    return void 0 === n && (n = Xr.DEFAULT), i$1(this, void 0, void 0, function () {
      var r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return (r = this.get(t)) ? [3, 2] : [4, e.get(t)];

          case 1:
            return (i = s.sent()) && (r = {
              key: t,
              value: i,
              state: n === Xr.PERSISTENT ? Jr.PERSISTENT : Jr.VOLATILE
            }, this.put(r)), [3, 3];

          case 2:
            n === Xr.PERSISTENT && (r.state = Jr.PERSISTENT), s.label = 3;

          case 3:
            return [2, r];
        }
      });
    });
  }, e.prototype.get = function (e, t) {
    void 0 === t && (t = Xr.DEFAULT);

    var n = this._items.map(function (e) {
      return e.key;
    }).indexOf(e);

    if (n > -1) {
      var r = this._items[n];
      return t === Xr.PERSISTENT && (r.state = Jr.PERSISTENT), t !== Xr.NO_CACHE && this.put(r), r;
    }

    return null;
  }, e.prototype.put = function (e) {
    var t, n;

    if (this._limit > 0) {
      var r = this._items.map(function (e) {
        return e.key;
      }).indexOf(e.key);

      if (r > -1) ci.includes(this._items[r].state) && ci.includes(e.state) ? (this._items.splice(r, 1), this._items.push(e)) : (this._items[r].state = e.state, this._items[r].value = e.value);else {
        this._items.push(e);

        var i = this._items.filter(function (e) {
          return e.state === Jr.VOLATILE;
        }),
            s = i.length - this._limit;

        if (s > 0) {
          var a = [];

          try {
            for (var o = s$2(this._items), u = o.next(); !u.done; u = o.next()) {
              var c = u.value;
              c.state === Jr.VOLATILE && s > 0 ? s-- : a.push(c);
            }
          } catch (e) {
            t = {
              error: e
            };
          } finally {
            try {
              u && !u.done && (n = o.return) && n.call(o);
            } finally {
              if (t) throw t.error;
            }
          }

          this._items = a;
        }
      }
    }
  }, e.prototype.remove = function (e) {
    var t = this._items.map(function (e) {
      return e.key;
    }).indexOf(e);

    t > -1 && this._items.splice(t, 1);
  }, e.prototype.clearByCondition = function (e) {
    this._items = this._items.filter(function (t) {
      return !e(t);
    });
  }, e.prototype.clear = function (e) {
    void 0 === e && (e = !1), this._items = e ? [] : this._items.filter(function (e) {
      return e.state !== Jr.VOLATILE;
    });
  }, e;
}(),
    hi = function () {
  function e(e) {
    var t = e.dbname,
        n = e.collectionName,
        r = e.store;
    this._requests = [], this._onCommit = new Map(), this._onWrite = new Map(), this._onError = new Map(), this.dbname = t, this.collectionName = n, this.metadataKey = function (e, t) {
      return "".concat(ni(e, t), "/trans.metadata");
    }(t, n), this.recordsetKey = function (e, t) {
      return "".concat(ni(e, t), "/trans.recordset");
    }(t, n), this._store = r;
  }

  return Object.defineProperty(e.prototype, "generation", {
    get: function () {
      return this._metadata ? this._metadata.generation : 0;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "requestCount", {
    get: function () {
      return this._requests.length;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype._getReducedRecordset = function (e) {
    return void 0 === e && (e = []), i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._store.get(this.recordsetKey)];

          case 1:
            return (t = n.sent() || []).push.apply(t, c$1([], a$1(e), !1)), [2, this._reduceRecordSet(t)];
        }
      });
    });
  }, e.prototype._reduceRecordSet = function (e) {
    for (var t = [], n = {}, r = e.length - 1; r >= 0; r--) {
      for (var i = e[r], s = [], a = i.requests.length - 1; a >= 0; a--) {
        var o = i.requests[a],
            u = o.data;
        n[u.key] || (s.unshift(o), n[u.key] = !0);
      }

      s.length > 0 && (i.requests = s, t.unshift(i));
    }

    return t;
  }, e.prototype._applyRecord = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s, a, u, c, l, d;
      return o$1(this, function (h) {
        switch (h.label) {
          case 0:
            n = di.get(this.dbname), r = t.generation, i = t.requests, s = null, h.label = 1;

          case 1:
            return h.trys.push([1, 3,, 4]), [4, this._store.setMany(i.map(function (e) {
              return n$1(n$1({}, e.data), {
                generation: r
              });
            }))];

          case 2:
            for (a = h.sent(), u = 0; u < i.length; u++) a[u] instanceof Error && (s || (s = a[u]), c = i[u].data, n.put(n$1(n$1({}, c), {
              state: Jr.PERSISTENT
            })));

            return [3, 4];

          case 3:
            return l = h.sent(), s = l, [3, 4];

          case 4:
            return s ? [3, 6] : (d = e.filter(function (e) {
              return e.generation !== r;
            }), [4, this._store.set({
              key: this.recordsetKey,
              value: d
            })]);

          case 5:
            return h.sent(), this._onWrite.forEach(function (e) {
              e(i.map(function (e) {
                return e.data;
              }));
            }), [3, 7];

          case 6:
            this._onError.forEach(function (e) {
              s && e(s);
            }), h.label = 7;

          case 7:
            return [2];
        }
      });
    });
  }, e.prototype.init = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s, a, o;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return e = this, [4, this._store.get(this.metadataKey)];

          case 1:
            return e._metadata = u.sent() || {
              generation: 1
            }, [4, this._getReducedRecordset()];

          case 2:
            t = u.sent(), u.label = 3;

          case 3:
            u.trys.push([3, 8, 9, 10]), n = s$2(t), r = n.next(), u.label = 4;

          case 4:
            return r.done ? [3, 7] : (i = r.value, [4, this._applyRecord(t, i)]);

          case 5:
            u.sent(), u.label = 6;

          case 6:
            return r = n.next(), [3, 4];

          case 7:
            return [3, 10];

          case 8:
            return s = u.sent(), a = {
              error: s
            }, [3, 10];

          case 9:
            try {
              r && !r.done && (o = n.return) && o.call(n);
            } finally {
              if (a) throw a.error;
            }

            return [7];

          case 10:
            return [2];
        }
      });
    });
  }, e.prototype.on = function (e, t, n) {
    switch (e) {
      case Yr.COMMIT:
        this._onCommit.set(t, n);

        break;

      case Yr.WRITE:
        this._onWrite.set(t, n);

        break;

      case Yr.ERROR:
        this._onError.set(t, n);

    }
  }, e.prototype.requestWrite = function (e, t) {
    this._requests.push({
      data: e,
      options: t
    }), di.get(this.dbname).put(n$1({
      state: Jr.PENDING
    }, e));
  }, e.prototype.requestMultipleWrite = function (e, t) {
    var n,
        r,
        i = di.get(this.dbname);

    try {
      for (var s = s$2(e), a = s.next(); !a.done; a = s.next()) {
        var u = a.value;
        this._requests.push({
          data: u,
          options: t
        }), i.put(n$1({
          state: Jr.PENDING
        }, u));
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        a && !a.done && (r = s.return) && r.call(s);
      } finally {
        if (n) throw n.error;
      }
    }
  }, e.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return di.get(this.dbname).clearByCondition(function (e) {
          return e.state === Jr.PENDING;
        }), this._requests = [], [2];
      });
    });
  }, e.prototype.commit = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t,
          n,
          r,
          i,
          s,
          a,
          u,
          c,
          l,
          d,
          h,
          f = this;
      return o$1(this, function (p) {
        switch (p.label) {
          case 0:
            if (!((e = this._requests).length > 0)) return [3, 4];

            for (t = [], n = {}, u = e.length - 1; u >= 0; u--) r = e[u], l = r.data, n[l.key] || (n[l.key] = !0, t.unshift(r));

            return i = {
              generation: this.generation,
              requests: t
            }, [4, this._getReducedRecordset([i])];

          case 1:
            return s = p.sent(), [4, this._store.set({
              key: this.recordsetKey,
              value: s
            })];

          case 2:
            return p.sent(), this._metadata.generation++, [4, this._store.set({
              key: this.metadataKey,
              value: this._metadata
            })];

          case 3:
            for (p.sent(), a = di.get(this.dbname), u = 0; u < t.length; u++) c = t[u], l = c.data, d = c.options, a.put(n$1(n$1({}, l), {
              state: d && d.persistent ? Jr.PERSISTENT : Jr.VOLATILE
            }));

            this._requests = [], this._onCommit.forEach(function (t) {
              t(e.map(function (e) {
                return e.data;
              }));
            }), h = Lr.get(this.dbname), setTimeout(function () {
              try {
                f._applyRecord(s, i);
              } catch (e) {
                f._onError.forEach(function (t) {
                  return t(e);
                });
              }
            }, h.transactionApplyDelay), p.label = 4;

          case 4:
            return [2];
        }
      });
    });
  }, e;
}(),
    fi = function () {
  function e(e) {
    var t = e.blockId,
        n = e.keyName,
        r = e.items,
        i = void 0 === r ? [] : r,
        s = e.limit;
    this.blockId = t, this.keyName = n, this.limit = s, this._items = c$1([], a$1(i), !1);
  }

  return e.createFromCacheItem = function (t) {
    return t ? new e(t.value) : null;
  }, Object.defineProperty(e.prototype, "isEmpty", {
    get: function () {
      return 0 === this._items.length;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "items", {
    get: function () {
      return this._items;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.serialize = function () {
    return {
      blockId: this.blockId,
      keyName: this.keyName,
      limit: this.limit,
      items: this._items
    };
  }, e.prototype.getItemByKey = function (e) {
    var t = this,
        n = this._items.find(function (n) {
      var r = n[t.keyName];
      return e === r;
    });

    return null != n ? n : null;
  }, e.prototype.has = function (e) {
    var t = this;
    return this._items.map(function (e) {
      return e[t.keyName];
    }).includes(e);
  }, e.prototype.add = function (e) {
    var t = this,
        n = this._items.map(function (e) {
      return e[t.keyName];
    }).indexOf(e[this.keyName]);

    return n < 0 ? this._items.length < this.limit && (this._items.push(e), !0) : (this._items[n] = e, !0);
  }, e.prototype.remove = function (e) {
    for (var t in this._items) if (this._items[t][this.keyName] === e) return this._items.splice(parseInt(t), 1), !0;

    return !1;
  }, e.prototype.clear = function () {
    this._items = [];
  }, e;
}(),
    pi = function () {
  function e(e) {
    var t = e.dbname,
        n = e.collectionName,
        r = e.metadata,
        i = e.hashFunction,
        s = void 0 === i ? Kr : i,
        a = e.transaction,
        o = e.store;
    this.dbname = t, this.collectionName = n, this.hashFunction = s, this.metadata = r, this._transaction = a, this._store = o;
  }

  return Object.defineProperty(e.prototype, "keyName", {
    get: function () {
      return this.metadata.keyName;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.createBlockId = function (e, t) {
    return void 0 === t && (t = this.metadata.blockLevel), n = this.dbname, r = this.collectionName, i = t, s = "".concat(function (e, t, n) {
      var r = n.base * Math.pow(n.multiplier, t) + n.constant;
      return (n.hashFunction || Kr)(e, r);
    }(e, t, {
      hashFunction: this.hashFunction,
      base: this.metadata.blockHashBase,
      multiplier: this.metadata.blockHashMultiplier,
      constant: this.metadata.blockHashConstant
    })), "".concat(ii(n, r)).concat(i, ".").concat(s);
    var n, r, i, s;
  }, e.prototype._findBlock = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            t = di.get(this.dbname), n = this.metadata.blockLevel, a.label = 1;

          case 1:
            return n > 0 ? (r = this.createBlockId(e, n), [4, t.find(this._store, r)]) : [3, 4];

          case 2:
            if ((i = a.sent()) && (s = fi.createFromCacheItem(i), null == s ? void 0 : s.getItemByKey(e))) return [2, s];
            a.label = 3;

          case 3:
            return n--, [3, 1];

          case 4:
            return [2, null];
        }
      });
    });
  }, e.prototype.getFromBlock = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._findBlock(e)];

          case 1:
            return [2, (t = n.sent()) ? t.getItemByKey(e) : null];
        }
      });
    });
  }, e.prototype.putToBlock = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return n = Lr.get(this.dbname), r = this.createBlockId(e), i = Math.floor(this._store.itemSizeLimit / n.itemSizeLimit), [4, di.get(this.dbname).find(this._store, r)];

          case 1:
            return s = o.sent(), (null == (a = s ? fi.createFromCacheItem(s) : new fi({
              blockId: r,
              keyName: this.keyName,
              items: [],
              limit: i
            })) ? void 0 : a.add(t)) ? (this._transaction.requestWrite({
              key: a.blockId,
              value: a.serialize()
            }), [2, !0]) : [2, !1];
        }
      });
    });
  }, e.prototype.removeFromBlock = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._findBlock(e)];

          case 1:
            return (t = n.sent()) && t.remove(e) ? (this._transaction.requestWrite({
              key: t.blockId,
              value: t.serialize()
            }), [2, !0]) : [2, !1];
        }
      });
    });
  }, e.prototype.clearAllBlocks = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return e = ii(this.dbname, this.collectionName), [4, this._store.getAllKeys()];

          case 1:
            return t = r.sent(), n = t.filter(function (t) {
              return t.startsWith(e);
            }), [4, this._store.removeMany(n)];

          case 2:
            return r.sent(), [4, this._transaction.clear()];

          case 3:
            return r.sent(), di.get(this.dbname).clearByCondition(function (t) {
              return t.key.startsWith(e);
            }), [2];
        }
      });
    });
  }, e;
}(),
    mi = {},
    vi = function () {
  function e(e) {
    var t = e.dbname,
        n = e.collectionName,
        r = e.keyName,
        i = e.fields,
        s = e.transaction,
        a = e.store,
        o = this;
    this._origin = [], this._table = [];

    var u = function (e, t, n) {
      return "".concat(ni(e, t), "/index.").concat(n);
    }(t, n, i.join(">"));

    return mi[u] || (this.dbname = t, this.collectionName = n, this.keyName = r, this.fields = i, this.indexerKey = u, this._transaction = s, this._store = a, this._transaction.on(Yr.COMMIT, this.indexerKey, function () {
      return o.commit();
    }), this._transaction.on(Yr.ERROR, this.indexerKey, function () {
      return o.abort();
    })), mi[u];
  }

  return e.createKey = function (e) {
    return e.join(">");
  }, e.parseKey = function (e) {
    return e.split(">");
  }, e.clearIndexerMap = function () {
    for (var e in mi) delete mi[e];
  }, e.prototype._addItem = function (e) {
    var t = e[this.keyName],
        n = this.getColumnValues(e),
        r = a$1(this.indexOf(n), 2),
        i = r[0];
    return r[1] ? !this._table[i].keys.includes(t) && (this._table[i].keys.push(t), !0) : (this._table.splice(i, 0, {
      columnValues: n,
      keys: [t]
    }), !0);
  }, e.prototype._removeItem = function (e) {
    var t = e[this.keyName],
        n = this.getColumnValues(e),
        r = a$1(this.indexOf(n), 2),
        i = r[0];

    if (r[1]) {
      var s = this._table[i].keys.indexOf(t);

      if (s > -1) return this._table[i].keys.splice(s, 1), 0 === this._table[i].keys.length && this._table.splice(i, 1), !0;
    }

    return !1;
  }, Object.defineProperty(e.prototype, "origin", {
    get: function () {
      return this._origin;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "table", {
    get: function () {
      return this._table;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.getColumnValues = function (e) {
    var t,
        n,
        r,
        i,
        s = [];

    try {
      for (var a = s$2(this.fields), o = a.next(); !o.done; o = a.next()) {
        var u = o.value;
        if ("-" === u[0] && (u = u.slice(1)), r = e[u], i = void 0, i = typeof r, null !== r && "undefined" !== i && "boolean" !== i && "number" !== i && "string" !== i) throw qr.indexTypesNotMatch;
        s.push(e[u]);
      }
    } catch (e) {
      t = {
        error: e
      };
    } finally {
      try {
        o && !o.done && (n = a.return) && n.call(a);
      } finally {
        if (t) throw t.error;
      }
    }

    return s;
  }, e.prototype.diff = function (e, t) {
    for (var n in this.fields) {
      var r = "-" === this.fields[n][0] ? -1 : 1,
          i = Br(e[n], t[n]);
      if (0 !== i) return r * i;
    }

    return 0;
  }, e.prototype.indexOf = function (e) {
    if (this._table.length > 0) {
      for (var t = 0, n = this._table.length - 1; t <= n;) {
        var r = Math.floor((t + n) / 2),
            i = this.diff(e, this._table[r].columnValues);
        if (i > 0) t = r + 1;else {
          if (!(i < 0)) return [r, !0];
          n = r - 1;
        }
      }

      return [t, !1];
    }

    return [0, !1];
  }, e.prototype.ensure = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s, a, o, u, c, l, d, h, f, p, v, y;
      return o$1(this, function (_) {
        switch (_.label) {
          case 0:
            return [4, (e = di.get(this.dbname)).find(this._store, this.indexerKey, Xr.PERSISTENT)];

          case 1:
            return (t = _.sent()) ? [3, 11] : (n = ii(this.dbname, this.collectionName), [4, this._store.getAllKeys()]);

          case 2:
            r = _.sent(), _.label = 3;

          case 3:
            _.trys.push([3, 8, 9, 10]), i = s$2(r), s = i.next(), _.label = 4;

          case 4:
            return s.done ? [3, 7] : (a = s.value).startsWith(n) ? [4, e.find(this._store, a, Xr.NO_CACHE)] : [3, 6];

          case 5:
            if (o = _.sent(), u = fi.createFromCacheItem(o)) try {
              for (v = void 0, c = s$2(u.items), l = c.next(); !l.done; l = c.next()) d = l.value, this._addItem(d);
            } catch (e) {
              v = {
                error: e
              };
            } finally {
              try {
                l && !l.done && (y = c.return) && y.call(c);
              } finally {
                if (v) throw v.error;
              }
            }
            _.label = 6;

          case 6:
            return s = i.next(), [3, 4];

          case 7:
            return [3, 10];

          case 8:
            return h = _.sent(), f = {
              error: h
            }, [3, 10];

          case 9:
            try {
              s && !s.done && (p = i.return) && p.call(i);
            } finally {
              if (f) throw f.error;
            }

            return [7];

          case 10:
            return this._transaction.requestWrite({
              key: this.indexerKey,
              value: this._table
            }, {
              persistent: !0
            }), [3, 12];

          case 11:
            this._origin = t.value, this._table = zr(this._origin), _.label = 12;

          case 12:
            return mi[this.indexerKey] = this, [2];
        }
      });
    });
  }, e.prototype.drop = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return di.get(this.dbname).remove(this.indexerKey), [4, this._store.remove(this.indexerKey)];

          case 1:
            return e.sent(), delete mi[this.indexerKey], [2];
        }
      });
    });
  }, e.prototype.addItem = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return this._addItem(e) && this._transaction.requestWrite({
          key: this.indexerKey,
          value: this._table
        }, {
          persistent: !0
        }), [2];
      });
    });
  }, e.prototype.removeItem = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return this._removeItem(e) && this._transaction.requestWrite({
          key: this.indexerKey,
          value: this._table
        }, {
          persistent: !0
        }), [2];
      });
    });
  }, e.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return this._table = [], this._transaction.requestWrite({
          key: this.indexerKey,
          value: this._table
        }, {
          persistent: !0
        }), [2];
      });
    });
  }, e.prototype.commit = function () {
    this._origin = this._table, this._table = zr(this._origin);
  }, e.prototype.abort = function () {
    this._table = zr(this._origin);
  }, e;
}(),
    yi = function () {
  return "undefined" != typeof document && "undefined" != typeof navigator && "ReactNative" !== navigator.product;
},
    _i = function () {
  var e = new Date().getTime();
  return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (t) {
    var n = (e + 16 * Math.random()) % 16 | 0;
    return e = Math.floor(e / 16), ("x" === t ? n : 3 & n | 8).toString(16);
  });
};

!function (e) {
  e[e.PROCESSING = 0] = "PROCESSING", e[e.DONE = 1] = "DONE";
}(oi || (oi = {})), function (e) {
  e.NEWNODE = "newnode", e.REMOVENODE = "removenode", e.CLAIM_HOST = "claimhost", e.SYNC_HOST = "synchost", e.REQUEST_LOCK = "requestlock", e.ACQUIRE_LOCK = "acquirelock", e.RELEASE_LOCK = "releaselock";
}(ui || (ui = {}));

var gi,
    bi = {},
    Ii = function () {
  function e(e, t) {
    void 0 === t && (t = {});
    var n = this;
    return this._state = oi.PROCESSING, this._queue = [], this._activationQueue = [], bi[e] && !t.forceCreate || (this.nodeId = _i(), this.key = e, yi() && (t.startAsInvisible ? this.registerNode() : "visible" === document.visibilityState ? this.claimHost() : this.registerNode(), document.addEventListener("visibilitychange", function () {
      "visible" === document.visibilityState && n.claimHost();
    }), window.addEventListener("message", function (e) {
      var t,
          r,
          i = e.data,
          s = i.nodeId,
          a = i.requestId,
          o = i.key,
          u = i.op,
          c = i.data;
      if (s !== n.nodeId && o === n.key) switch (u) {
        case ui.NEWNODE:
          n._sendSync();

          break;

        case ui.CLAIM_HOST:
          n._sendSync(), n._hostId = s;
          break;

        case ui.SYNC_HOST:
          if (!n.isInSync) {
            n._activationTimeout && clearTimeout(n._activationTimeout);

            var l = c,
                d = l.currentItemRequestId,
                h = l.queue,
                f = function (e) {
              var t = n._queue.findIndex(function (t) {
                return t.requestId === e.requestId;
              });

              t < 0 && n._requestLock({
                nodeId: e.nodeId,
                requestId: e.requestId,
                key: n.key,
                op: ui.REQUEST_LOCK,
                ts: e.ts
              });
            };

            try {
              for (var p = s$2(h), v = p.next(); !v.done; v = p.next()) {
                f(v.value);
              }
            } catch (e) {
              t = {
                error: e
              };
            } finally {
              try {
                v && !v.done && (r = p.return) && r.call(p);
              } finally {
                if (t) throw t.error;
              }
            }

            n._currentItem = n._queue.find(function (e) {
              return e.requestId === d;
            }), n._completeSync();
          }

          break;

        case ui.REMOVENODE:
          n._queue = n._queue.filter(function (e) {
            return e.nodeId !== i.nodeId;
          }), n._currentItem && n._currentItem.nodeId === i.nodeId && (n._currentItem = void 0, n._acquire(n._queue[0]));
          break;

        case ui.REQUEST_LOCK:
          n._requestLock(i);

          break;

        case ui.ACQUIRE_LOCK:
          var y = n._queue.find(function (e) {
            return e.requestId === a;
          });

          n._acquire(y);

          break;

        case ui.RELEASE_LOCK:
          n._release(a);

      }
    }), window.addEventListener("beforeunload", function () {
      n._send(ui.REMOVENODE);
    })), bi[e] = this), bi[e];
  }

  return Object.defineProperty(e.prototype, "locked", {
    get: function () {
      return !!this._currentItem;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "isHost", {
    get: function () {
      return this._hostId === this.nodeId;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "isInSync", {
    get: function () {
      return this._state == oi.DONE;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype._send = function (e, t) {
    var n;
    void 0 === t && (t = {});
    var r = {
      nodeId: this.nodeId,
      requestId: null !== (n = null == t ? void 0 : t.requestId) && void 0 !== n ? n : _i(),
      key: this.key,
      op: e,
      data: t.data,
      ts: Date.now()
    };
    return yi() && window.postMessage(r, "*"), r;
  }, e.prototype._acquire = function (e) {
    e ? (this._currentItem = e, this._currentItem.onAcquired && this._currentItem.onAcquired(e.requestId)) : this._currentItem = void 0;
  }, e.prototype._release = function (e) {
    if (this._currentItem && this._currentItem.requestId === e) {
      var t = this._currentItem;
      this._currentItem = void 0, t.nodeId === this.nodeId && this._send(ui.RELEASE_LOCK, {
        requestId: t.requestId
      });

      var n = this._queue.findIndex(function (t) {
        return t.requestId === e;
      });

      n > -1 && this._queue.splice(n, 1), t.onReleased && t.onReleased(e);
    }
  }, e.prototype._requestLock = function (e) {
    var t = this;
    return new Promise(function (n) {
      var r = {
        nodeId: e.nodeId,
        requestId: e.requestId,
        ts: e.ts,
        onAcquired: function (e) {
          t.isHost && t._send(ui.ACQUIRE_LOCK, {
            requestId: e
          }), n();
        },
        onReleased: function () {
          t._acquire(t._queue[0]);
        }
      },
          i = !1;

      for (var s in t._queue) if (t._queue[s].ts > r.ts) {
        t._queue.splice(parseInt(s), 0, r), i = !0;
        break;
      }

      i || t._queue.push(r), t._currentItem || t._acquire(t._queue[0]);
    });
  }, e.prototype._sendSync = function () {
    var e;
    this.isHost && this._send(ui.SYNC_HOST, {
      data: {
        currentItemRequestId: null === (e = this._currentItem) || void 0 === e ? void 0 : e.requestId,
        queue: this._queue.map(function (e) {
          return {
            nodeId: e.nodeId,
            requestId: e.requestId,
            ts: e.ts
          };
        })
      }
    });
  }, e.prototype._waitUntilSyncCompleted = function () {
    return i$1(this, void 0, void 0, function () {
      var e = this;
      return o$1(this, function (t) {
        return this.isHost && !this.isInSync ? [2, new Promise(function (t) {
          e._activationQueue.push(t);
        })] : [2];
      });
    });
  }, e.prototype._waitSync = function () {
    var e = this;
    this.isInSync || (this._activationTimeout = setTimeout(function () {
      e._completeSync();
    }, 8));
  }, e.prototype._completeSync = function () {
    this.isInSync || (this._state = oi.DONE, this._activationQueue.forEach(function (e) {
      return e();
    }), this._activationQueue = []);
  }, e.prototype.registerNode = function () {
    this._send(ui.NEWNODE), this._waitSync();
  }, e.prototype.claimHost = function () {
    this._hostId = this.nodeId, this._send(ui.CLAIM_HOST), this._waitSync();
  }, e.prototype.lock = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._waitUntilSyncCompleted()];

          case 1:
            return t.sent(), e = this._send(ui.REQUEST_LOCK), [4, this._requestLock(e)];

          case 2:
            return t.sent(), [2];
        }
      });
    });
  }, e.prototype.unlock = function () {
    var e;
    (null === (e = this._currentItem) || void 0 === e ? void 0 : e.requestId) && this._release(this._currentItem.requestId);
  }, e;
}(),
    Ei = function () {
  function e(e) {
    var t = e.dbname,
        n = e.collectionName,
        r = e.keyName,
        i = e.keyHash,
        s = e.indexes,
        a = e.store,
        o = this;
    this._state = Dr.INIT, this._indexers = [], this.dbname = t, this.name = n, this.keyName = r, this.indexes = c$1([[r]], a$1(s.filter(function (e) {
      return vi.createKey(e) !== o.keyName;
    })), !1), this._keyHash = i, this._store = a, this._mutex = new Ii(function (e, t) {
      return "".concat(ni(e, t), ".lock");
    }(t, n)), this._blobContainer = new ai({
      dbname: t,
      collectionName: n,
      store: a
    }), this._transaction = new hi({
      dbname: t,
      collectionName: n,
      store: a
    });
  }

  return e.metadataOf = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      var r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return r = ri(e, t), [4, n.get(r)];

          case 1:
            return [2, i.sent()];
        }
      });
    });
  }, Object.defineProperty(e.prototype, "state", {
    get: function () {
      return this._state;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "isReady", {
    get: function () {
      return this._state === Dr.READY;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.init = function () {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i,
          s,
          a,
          o,
          u,
          c,
          l,
          d,
          h,
          v,
          y,
          _ = this;

      return o$1(this, function (g) {
        switch (g.label) {
          case 0:
            return [4, this._mutex.lock()];

          case 1:
            g.sent(), g.label = 2;

          case 2:
            return g.trys.push([2, 9,, 10]), t = Lr.get(this.dbname), [4, e.metadataOf(this.dbname, this.name, this._store)];

          case 3:
            return n = g.sent(), this._metadata = n || {
              keyName: this.keyName,
              blockLevel: 1,
              blockHashBase: t.blockHashBase,
              blockHashMultiplier: t.blockHashMultiplier,
              blockHashConstant: t.blockHashConstant,
              indexes: this.indexes
            }, [4, this._transaction.init()];

          case 4:
            g.sent(), this._blockManager = new pi({
              dbname: this.dbname,
              collectionName: this.name,
              hashFunction: this._keyHash,
              metadata: this._metadata,
              transaction: this._transaction,
              store: this._store
            }), r = c$1([], a$1(this.indexes), !1), i = [], s = r.map(function (e) {
              return vi.createKey(e);
            }), a = n ? n.indexes.map(function (e) {
              return vi.createKey(e);
            }) : [];

            try {
              for (o = s$2(a), u = o.next(); !u.done; u = o.next()) c = u.value, s.includes(c) || i.push(vi.parseKey(c));
            } catch (e) {
              v = {
                error: e
              };
            } finally {
              try {
                u && !u.done && (y = o.return) && y.call(o);
              } finally {
                if (v) throw v.error;
              }
            }

            return (l = []).push.apply(l, c$1([], a$1(r.map(function (e) {
              var t = new vi({
                dbname: _.dbname,
                collectionName: _.name,
                keyName: _.keyName,
                fields: e,
                transaction: _._transaction,
                store: _._store
              });
              return _._indexers.push(t), t.ensure();
            })), !1)), l.push.apply(l, c$1([], a$1(i.map(function (e) {
              return new vi({
                dbname: _.dbname,
                collectionName: _.name,
                keyName: _.keyName,
                fields: e,
                transaction: _._transaction,
                store: _._store
              }).drop();
            })), !1)), [4, Promise.all(l)];

          case 5:
            return g.sent(), [4, this._transaction.commit()];

          case 6:
            return g.sent(), s.sort().join(",") === a.sort().join(",") ? [3, 8] : (d = ri(this.dbname, this.name), this._metadata.indexes = r, [4, this._store.set({
              key: d,
              value: this._metadata
            })]);

          case 7:
            g.sent(), g.label = 8;

          case 8:
            return this._state = Dr.READY, this._mutex.unlock(), [3, 10];

          case 9:
            throw h = g.sent(), this._mutex.unlock(), h;

          case 10:
            return [2];
        }
      });
    });
  }, e.prototype.close = function () {
    this._state = Dr.CLOSED;
  }, e.prototype._hasPropertyOfKeyName = function (e) {
    var t = e[this.keyName];
    return "string" == typeof t && !!t;
  }, e.prototype._getIndexerBy = function (e) {
    var t, n;
    void 0 === e && (e = null), e || (e = [this.keyName]);
    var r = vi.createKey(e);

    try {
      for (var i = s$2(this._indexers), s = i.next(); !s.done; s = i.next()) {
        var a = s.value;
        if (r === vi.createKey(a.fields)) return a;
      }
    } catch (e) {
      t = {
        error: e
      };
    } finally {
      try {
        s && !s.done && (n = i.return) && n.call(i);
      } finally {
        if (t) throw t.error;
      }
    }

    throw qr.indexTableIsRequired;
  }, e.prototype._upgradeBlockLevel = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e = ri(this.dbname, this.name), this._metadata.blockLevel++, [4, this._store.set({
              key: e,
              value: this._metadata
            })];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, e.prototype._requestInsert = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return t = e[this.keyName], [4, this._blockManager.getFromBlock(t)];

          case 1:
            return o.sent() ? [3, 13] : [4, this._blockManager.putToBlock(t, e)];

          case 2:
            return o.sent() ? [3, 5] : [4, this._upgradeBlockLevel()];

          case 3:
            return o.sent(), [4, this._blockManager.putToBlock(t, e)];

          case 4:
            o.sent(), o.label = 5;

          case 5:
            o.trys.push([5, 10, 11, 12]), n = s$2(this._indexers), r = n.next(), o.label = 6;

          case 6:
            return r.done ? [3, 9] : [4, r.value.addItem(e)];

          case 7:
            o.sent(), o.label = 8;

          case 8:
            return r = n.next(), [3, 6];

          case 9:
            return [3, 12];

          case 10:
            return i = o.sent(), s = {
              error: i
            }, [3, 12];

          case 11:
            try {
              r && !r.done && (a = n.return) && a.call(n);
            } finally {
              if (s) throw s.error;
            }

            return [7];

          case 12:
            return [3, 14];

          case 13:
            throw qr.collectionInsertDuplicate;

          case 14:
            return [2];
        }
      });
    });
  }, e.prototype._requestUpsert = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a, o, u, c, l, d, h, f;
      return o$1(this, function (p) {
        switch (p.label) {
          case 0:
            return t = e[this.keyName], [4, this._blockManager.getFromBlock(t)];

          case 1:
            return (n = p.sent()) ? [3, 13] : [4, this._blockManager.putToBlock(t, e)];

          case 2:
            return p.sent() ? [3, 5] : [4, this._upgradeBlockLevel()];

          case 3:
            return p.sent(), [4, this._blockManager.putToBlock(t, e)];

          case 4:
            p.sent(), p.label = 5;

          case 5:
            p.trys.push([5, 10, 11, 12]), r = s$2(this._indexers), i = r.next(), p.label = 6;

          case 6:
            return i.done ? [3, 9] : [4, (u = i.value).addItem(e)];

          case 7:
            p.sent(), p.label = 8;

          case 8:
            return i = r.next(), [3, 6];

          case 9:
            return [3, 12];

          case 10:
            return s = p.sent(), l = {
              error: s
            }, [3, 12];

          case 11:
            try {
              i && !i.done && (d = r.return) && d.call(r);
            } finally {
              if (l) throw l.error;
            }

            return [7];

          case 12:
            return [3, 23];

          case 13:
            return [4, this._blockManager.putToBlock(t, e)];

          case 14:
            p.sent(), p.label = 15;

          case 15:
            p.trys.push([15, 21, 22, 23]), a = s$2(this._indexers), o = a.next(), p.label = 16;

          case 16:
            return o.done ? [3, 20] : 0 === (u = o.value).diff(u.getColumnValues(n), u.getColumnValues(e)) ? [3, 19] : [4, u.removeItem(n)];

          case 17:
            return p.sent(), [4, u.addItem(e)];

          case 18:
            p.sent(), p.label = 19;

          case 19:
            return o = a.next(), [3, 16];

          case 20:
            return [3, 23];

          case 21:
            return c = p.sent(), h = {
              error: c
            }, [3, 23];

          case 22:
            try {
              o && !o.done && (f = a.return) && f.call(a);
            } finally {
              if (h) throw h.error;
            }

            return [7];

          case 23:
            return [2];
        }
      });
    });
  }, e.prototype._requestUpdate = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a, o, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return t = e[this.keyName], [4, this._blockManager.getFromBlock(t)];

          case 1:
            return (n = c.sent()) ? [4, this._blockManager.putToBlock(t, e)] : [3, 11];

          case 2:
            c.sent(), c.label = 3;

          case 3:
            c.trys.push([3, 9, 10, 11]), r = s$2(this._indexers), i = r.next(), c.label = 4;

          case 4:
            return i.done ? [3, 8] : 0 === (s = i.value).diff(s.getColumnValues(n), s.getColumnValues(e)) ? [3, 7] : [4, s.removeItem(n)];

          case 5:
            return c.sent(), [4, s.addItem(e)];

          case 6:
            c.sent(), c.label = 7;

          case 7:
            return i = r.next(), [3, 4];

          case 8:
            return [3, 11];

          case 9:
            return a = c.sent(), o = {
              error: a
            }, [3, 11];

          case 10:
            try {
              i && !i.done && (u = r.return) && u.call(r);
            } finally {
              if (o) throw o.error;
            }

            return [7];

          case 11:
            return [2];
        }
      });
    });
  }, e.prototype._requestRemove = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return [4, this._blockManager.getFromBlock(e)];

          case 1:
            return (t = o.sent()) ? [4, this._blockManager.removeFromBlock(e)] : [3, 10];

          case 2:
            o.sent(), o.label = 3;

          case 3:
            o.trys.push([3, 8, 9, 10]), n = s$2(this._indexers), r = n.next(), o.label = 4;

          case 4:
            return r.done ? [3, 7] : [4, r.value.removeItem(t)];

          case 5:
            o.sent(), o.label = 6;

          case 6:
            return r = n.next(), [3, 4];

          case 7:
            return [3, 10];

          case 8:
            return i = o.sent(), s = {
              error: i
            }, [3, 10];

          case 9:
            try {
              r && !r.done && (a = n.return) && a.call(n);
            } finally {
              if (s) throw s.error;
            }

            return [7];

          case 10:
            return [2];
        }
      });
    });
  }, e.prototype._requestClear = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return [4, this._blockManager.clearAllBlocks()];

          case 1:
            s.sent(), s.label = 2;

          case 2:
            s.trys.push([2, 7, 8, 9]), e = s$2(this._indexers), t = e.next(), s.label = 3;

          case 3:
            return t.done ? [3, 6] : [4, t.value.clear()];

          case 4:
            s.sent(), s.label = 5;

          case 5:
            return t = e.next(), [3, 3];

          case 6:
            return [3, 9];

          case 7:
            return n = s.sent(), r = {
              error: n
            }, [3, 9];

          case 8:
            try {
              t && !t.done && (i = e.return) && i.call(e);
            } finally {
              if (r) throw r.error;
            }

            return [7];

          case 9:
            return [2];
        }
      });
    });
  }, e.prototype.getByKey = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return this.isReady ? [4, this._mutex.lock()] : [3, 6];

          case 1:
            r.sent(), r.label = 2;

          case 2:
            return r.trys.push([2, 4,, 5]), [4, this._blockManager.getFromBlock(e)];

          case 3:
            return t = r.sent(), this._mutex.unlock(), [2, zr(t)];

          case 4:
            throw n = r.sent(), this._mutex.unlock(), n;

          case 5:
            return [3, 7];

          case 6:
            throw qr.collectionNotReady;

          case 7:
            return [2];
        }
      });
    });
  }, e.prototype.query = function (e) {
    if (void 0 === e && (e = {}), this.isReady) return new ei({
      condition: e.where,
      mutex: this._mutex,
      blockManager: this._blockManager,
      indexer: this._getIndexerBy(e.index),
      backward: !!e.backward
    });
    throw qr.collectionNotReady;
  }, e.prototype.insertOne = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.isReady ? [4, this._mutex.lock()] : [3, 8];

          case 1:
            n.sent(), n.label = 2;

          case 2:
            if (n.trys.push([2, 5,, 7]), !this._hasPropertyOfKeyName(e)) throw qr.collectionKeyNotGiven;
            return [4, this._requestInsert(zr(e))];

          case 3:
            return n.sent(), [4, this._transaction.commit()];

          case 4:
            return n.sent(), this._mutex.unlock(), [2, e];

          case 5:
            return t = n.sent(), [4, this._transaction.clear()];

          case 6:
            throw n.sent(), this._mutex.unlock(), t;

          case 7:
            return [3, 9];

          case 8:
            throw qr.collectionNotReady;

          case 9:
            return [2];
        }
      });
    });
  }, e.prototype.insertMany = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i,
          s,
          a,
          o,
          u = this;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return this.isReady ? [4, this._mutex.lock()] : [3, 15];

          case 1:
            c.sent(), c.label = 2;

          case 2:
            if (c.trys.push([2, 12,, 14]), e.some(function (e) {
              return !u._hasPropertyOfKeyName(e);
            })) throw qr.collectionKeyNotGiven;
            c.label = 3;

          case 3:
            c.trys.push([3, 8, 9, 10]), t = s$2(e), n = t.next(), c.label = 4;

          case 4:
            return n.done ? [3, 7] : (r = n.value, [4, this._requestInsert(zr(r))]);

          case 5:
            c.sent(), c.label = 6;

          case 6:
            return n = t.next(), [3, 4];

          case 7:
            return [3, 10];

          case 8:
            return i = c.sent(), a = {
              error: i
            }, [3, 10];

          case 9:
            try {
              n && !n.done && (o = t.return) && o.call(t);
            } finally {
              if (a) throw a.error;
            }

            return [7];

          case 10:
            return [4, this._transaction.commit()];

          case 11:
            return c.sent(), this._mutex.unlock(), [2, e];

          case 12:
            return s = c.sent(), [4, this._transaction.clear()];

          case 13:
            throw c.sent(), this._mutex.unlock(), s;

          case 14:
            return [3, 16];

          case 15:
            throw qr.collectionNotReady;

          case 16:
            return [2];
        }
      });
    });
  }, e.prototype.upsertOne = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.isReady ? [4, this._mutex.lock()] : [3, 8];

          case 1:
            n.sent(), n.label = 2;

          case 2:
            if (n.trys.push([2, 5,, 7]), !this._hasPropertyOfKeyName(e)) throw qr.collectionKeyNotGiven;
            return [4, this._requestUpsert(zr(e))];

          case 3:
            return n.sent(), [4, this._transaction.commit()];

          case 4:
            return n.sent(), this._mutex.unlock(), [2, e];

          case 5:
            return t = n.sent(), [4, this._transaction.clear()];

          case 6:
            throw n.sent(), this._mutex.unlock(), t;

          case 7:
            return [3, 9];

          case 8:
            throw qr.collectionNotReady;

          case 9:
            return [2];
        }
      });
    });
  }, e.prototype.upsertMany = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i,
          s,
          a,
          o,
          u = this;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return this.isReady ? [4, this._mutex.lock()] : [3, 15];

          case 1:
            c.sent(), c.label = 2;

          case 2:
            if (c.trys.push([2, 12,, 14]), e.some(function (e) {
              return !u._hasPropertyOfKeyName(e);
            })) throw qr.collectionKeyNotGiven;
            c.label = 3;

          case 3:
            c.trys.push([3, 8, 9, 10]), t = s$2(e), n = t.next(), c.label = 4;

          case 4:
            return n.done ? [3, 7] : (r = n.value, [4, this._requestUpsert(zr(r))]);

          case 5:
            c.sent(), c.label = 6;

          case 6:
            return n = t.next(), [3, 4];

          case 7:
            return [3, 10];

          case 8:
            return i = c.sent(), a = {
              error: i
            }, [3, 10];

          case 9:
            try {
              n && !n.done && (o = t.return) && o.call(t);
            } finally {
              if (a) throw a.error;
            }

            return [7];

          case 10:
            return [4, this._transaction.commit()];

          case 11:
            return c.sent(), this._mutex.unlock(), [2, e];

          case 12:
            return s = c.sent(), [4, this._transaction.clear()];

          case 13:
            throw c.sent(), this._mutex.unlock(), s;

          case 14:
            return [3, 16];

          case 15:
            throw qr.collectionNotReady;

          case 16:
            return [2];
        }
      });
    });
  }, e.prototype.update = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.isReady ? [4, this._mutex.lock()] : [3, 8];

          case 1:
            n.sent(), n.label = 2;

          case 2:
            if (n.trys.push([2, 5,, 7]), !this._hasPropertyOfKeyName(e)) throw qr.collectionKeyNotGiven;
            return [4, this._requestUpdate(zr(e))];

          case 3:
            return n.sent(), [4, this._transaction.commit()];

          case 4:
            return n.sent(), this._mutex.unlock(), [2, e];

          case 5:
            return t = n.sent(), [4, this._transaction.clear()];

          case 6:
            throw n.sent(), this._mutex.unlock(), t;

          case 7:
            return [3, 9];

          case 8:
            throw qr.collectionNotReady;

          case 9:
            return [2];
        }
      });
    });
  }, e.prototype.updateIf = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n,
          r,
          i,
          s,
          a,
          o,
          u,
          c,
          l,
          d,
          h,
          f,
          p,
          v,
          y = this;
      return o$1(this, function (_) {
        switch (_.label) {
          case 0:
            return this.isReady ? [4, this._mutex.lock()] : [3, 16];

          case 1:
            _.sent(), _.label = 2;

          case 2:
            return _.trys.push([2, 13,, 15]), n = e.where, r = void 0 === n ? {} : n, i = e.index, s = void 0 === i ? null : i, a = e.backward, o = void 0 !== a && a, u = [], [4, new $r({
              condition: r,
              blockManager: this._blockManager,
              backward: o,
              indexer: this._getIndexerBy(s)
            }).each(function (e) {
              return i$1(y, void 0, void 0, function () {
                var n, i;
                return o$1(this, function (s) {
                  if (e.error) throw e.stop(), e.error;

                  if (e.hasNext) {
                    if (n = e.nextValue, Qr(r, n) && t.set) {
                      if ("function" != typeof t.set) for (i in t.set) n[i] = t.set[i];else t.set(n);
                      u.push(n);
                    }

                    e.next();
                  } else e.stop();

                  return [2];
                });
              });
            })];

          case 3:
            _.sent(), _.label = 4;

          case 4:
            _.trys.push([4, 9, 10, 11]), c = s$2(u), l = c.next(), _.label = 5;

          case 5:
            return l.done ? [3, 8] : (d = l.value, [4, this._requestUpdate(zr(d))]);

          case 6:
            _.sent(), _.label = 7;

          case 7:
            return l = c.next(), [3, 5];

          case 8:
            return [3, 11];

          case 9:
            return h = _.sent(), p = {
              error: h
            }, [3, 11];

          case 10:
            try {
              l && !l.done && (v = c.return) && v.call(c);
            } finally {
              if (p) throw p.error;
            }

            return [7];

          case 11:
            return [4, this._transaction.commit()];

          case 12:
            return _.sent(), this._mutex.unlock(), [2, u];

          case 13:
            return f = _.sent(), [4, this._transaction.clear()];

          case 14:
            throw _.sent(), this._mutex.unlock(), f;

          case 15:
            return [3, 17];

          case 16:
            throw this._transaction.clear(), qr.collectionNotReady;

          case 17:
            return [2];
        }
      });
    });
  }, e.prototype.remove = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.isReady ? [4, this._mutex.lock()] : [3, 8];

          case 1:
            n.sent(), n.label = 2;

          case 2:
            return n.trys.push([2, 5,, 7]), [4, this._requestRemove(e)];

          case 3:
            return n.sent(), [4, this._transaction.commit()];

          case 4:
            return n.sent(), this._mutex.unlock(), [3, 7];

          case 5:
            return t = n.sent(), [4, this._transaction.clear()];

          case 6:
            throw n.sent(), this._mutex.unlock(), t;

          case 7:
            return [3, 9];

          case 8:
            throw qr.collectionNotReady;

          case 9:
            return [2];
        }
      });
    });
  }, e.prototype.removeIf = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i,
          s,
          a,
          o,
          u,
          c,
          l,
          d,
          h,
          f,
          p,
          v = this;
      return o$1(this, function (y) {
        switch (y.label) {
          case 0:
            return this.isReady ? [4, this._mutex.lock()] : [3, 15];

          case 1:
            y.sent(), y.label = 2;

          case 2:
            return y.trys.push([2, 13,, 14]), t = e.where, n = void 0 === t ? {} : t, r = e.index, i = void 0 === r ? null : r, s = e.backward, a = void 0 !== s && s, o = [], [4, new $r({
              condition: n,
              blockManager: this._blockManager,
              backward: a,
              indexer: this._getIndexerBy(i)
            }).each(function (e) {
              return i$1(v, void 0, void 0, function () {
                var t, r;
                return o$1(this, function (i) {
                  if (e.error) throw e.stop(), e.error;
                  return e.hasNext ? (t = e.nextValue, Qr(n, t) && (r = t[this.keyName], o.push(r)), e.next()) : e.stop(), [2];
                });
              });
            })];

          case 3:
            y.sent(), y.label = 4;

          case 4:
            y.trys.push([4, 9, 10, 11]), u = s$2(o), c = u.next(), y.label = 5;

          case 5:
            return c.done ? [3, 8] : (l = c.value, [4, this._requestRemove(l)]);

          case 6:
            y.sent(), y.label = 7;

          case 7:
            return c = u.next(), [3, 5];

          case 8:
            return [3, 11];

          case 9:
            return d = y.sent(), f = {
              error: d
            }, [3, 11];

          case 10:
            try {
              c && !c.done && (p = u.return) && p.call(u);
            } finally {
              if (f) throw f.error;
            }

            return [7];

          case 11:
            return [4, this._transaction.commit()];

          case 12:
            return y.sent(), this._mutex.unlock(), [2, o];

          case 13:
            throw h = y.sent(), this._mutex.unlock(), h;

          case 14:
            return [3, 16];

          case 15:
            throw this._transaction.clear(), qr.collectionNotReady;

          case 16:
            return [2];
        }
      });
    });
  }, e.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this.isReady ? [4, this._mutex.lock()] : [3, 8];

          case 1:
            t.sent(), t.label = 2;

          case 2:
            return t.trys.push([2, 5,, 7]), [4, this._requestClear()];

          case 3:
            return t.sent(), [4, this._transaction.commit()];

          case 4:
            return t.sent(), this._mutex.unlock(), [3, 7];

          case 5:
            return e = t.sent(), [4, this._transaction.clear()];

          case 6:
            throw t.sent(), this._mutex.unlock(), e;

          case 7:
            return [3, 9];

          case 8:
            throw qr.collectionNotReady;

          case 9:
            return [2];
        }
      });
    });
  }, e.prototype.getBlob = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._blobContainer.get(e)];

          case 1:
            return [2, t.sent()];
        }
      });
    });
  }, e.prototype.saveBlob = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._blobContainer.save(e, t)];

          case 1:
            return [2, n.sent()];
        }
      });
    });
  }, e.prototype.removeBlob = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._blobContainer.remove(e)];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, e.prototype.removeAllBlobs = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, this._blobContainer.clear()];

          case 1:
            return e.sent(), [2];
        }
      });
    });
  }, e;
}(),
    Ti = "[NESTDB]",
    wi = !0,
    Mi = function () {
  function e() {}

  return e.off = function () {
    wi = !1;
  }, e.log = function () {
    for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];

    wi && console.log.apply(console, c$1(["".concat(Ti, "[LOG]")], a$1(e), !1));
  }, e.warning = function () {
    for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];

    wi && console.warn.apply(console, c$1(["".concat(Ti, "[WARNING]")], a$1(e), !1));
  }, e.error = function () {
    for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];

    wi && console.error.apply(console, c$1(["".concat(Ti, "[ERROR]")], a$1(e), !1));
  }, e;
}(),
    Si = [{}, {
  a: 700400,
  n: "error"
}],
    Ai = function () {
  function e(e) {
    var t, n, r;
    this.encryption = null !== (t = e.encryption) && void 0 !== t ? t : R$2, this.itemSizeLimit = null !== (n = e.itemSizeLimit) && void 0 !== n ? n : 4194304, this.metadataBuffer = null !== (r = e.metadataBuffer) && void 0 !== r ? r : 256;
  }

  return Object.defineProperty(e.prototype, "_encryptionCheckKey", {
    get: function () {
      return "".concat(this.dbname, ".encrypt");
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "_reservedKeys", {
    get: function () {
      return [this._encryptionCheckKey];
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype._getRawKey = function (e, t) {
    return void 0 === t && (t = ""), "".concat(e).concat(t);
  }, e.prototype._generateShardPostfixArray = function (e) {
    return void 0 === e && (e = 1), c$1([], a$1(Array(e).keys()), !1);
  }, e.prototype._shardify = function (e) {
    var t = this,
        n = e.key,
        r = e.value,
        i = JSON.stringify(this.encryption.encrypt(r)),
        s = Math.ceil(i.length / this.adjustedItemSizeLimit);
    return this._generateShardPostfixArray(s).map(function (e) {
      var r = {
        key: t._getRawKey(n, ".".concat(e)),
        data: i.substring(e * t.adjustedItemSizeLimit, (e + 1) * t.adjustedItemSizeLimit)
      };
      return 0 === e && (r.metadata = {
        shards: s
      }), r;
    });
  }, e.prototype._resetIfEncryptionChanged = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t,
          n,
          r,
          i,
          s,
          a,
          o,
          u,
          c = this;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            return [4, this.get(this._encryptionCheckKey)];

          case 1:
            if (e = l.sent(), t = {
              encrypted: Si.map(function (e) {
                var t;
                return null === (t = c.encryption) || void 0 === t ? void 0 : t.encrypt(e);
              })
            }, !(e && e.encrypted && Array.isArray(e.encrypted))) return [3, 5];

            for (i in n = e.encrypted, r = [], n) r.push(i);

            s = 0, l.label = 2;

          case 2:
            return s < r.length ? (i = r[s]) in n ? (a = i, o = JSON.stringify(e.encrypted[a]), u = JSON.stringify(t.encrypted[a]), o === u ? [3, 4] : (Mi.warning("Encryption algorithm has changed. Stored data would be cleared."), [4, this.clear()])) : [3, 4] : [3, 5];

          case 3:
            return l.sent(), [3, 5];

          case 4:
            return s++, [3, 2];

          case 5:
            return [4, this.set({
              key: this._encryptionCheckKey,
              value: t
            })];

          case 6:
            return l.sent(), [2];
        }
      });
    });
  }, Object.defineProperty(e.prototype, "adjustedItemSizeLimit", {
    get: function () {
      return Math.max(this.itemSizeLimit - this.metadataBuffer, 4);
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.usage = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s, a, o, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return e = 0, [4, this._getAllRawKeys()];

          case 1:
            t = c.sent(), c.label = 2;

          case 2:
            c.trys.push([2, 7, 8, 9]), n = s$2(t), r = n.next(), c.label = 3;

          case 3:
            return r.done ? [3, 6] : (i = r.value, [4, this._getRaw(i)]);

          case 4:
            (s = c.sent()) && (e += JSON.stringify(s).length), c.label = 5;

          case 5:
            return r = n.next(), [3, 3];

          case 6:
            return [3, 9];

          case 7:
            return a = c.sent(), o = {
              error: a
            }, [3, 9];

          case 8:
            try {
              r && !r.done && (u = n.return) && u.call(n);
            } finally {
              if (o) throw o.error;
            }

            return [7];

          case 9:
            return [2, e];
        }
      });
    });
  }, e.prototype.getAllKeys = function () {
    return i$1(this, void 0, void 0, function () {
      var e = this;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._getAllRawKeys()];

          case 1:
            return [2, t.sent().filter(function (e) {
              return e.endsWith(".0");
            }).map(function (e) {
              return e.replace(/\.0$/, "");
            }).filter(function (t) {
              return !e._reservedKeys.includes(t);
            })];
        }
      });
    });
  }, e.prototype.get = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i,
          s,
          a,
          o = this;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return t = this._getRawKey(e, ".0"), [4, this._getRaw(t)];

          case 1:
            if (!(n = u.sent())) return [3, 7];
            u.label = 2;

          case 2:
            return u.trys.push([2, 6,, 7]), r = n.data, (null == (i = n.metadata) ? void 0 : i.shards) && i.shards > 1 ? [4, Promise.all(this._generateShardPostfixArray(null == i ? void 0 : i.shards).map(function (t) {
              return i$1(o, void 0, void 0, function () {
                var n, i;
                return o$1(this, function (s) {
                  switch (s.label) {
                    case 0:
                      return t > 0 ? (n = this._getRawKey(e, ".".concat(t)), [4, this._getRaw(n)]) : [3, 2];

                    case 1:
                      if (!(i = s.sent())) throw qr.storeBrokenIntegrity;
                      return [2, i.data];

                    case 2:
                      return [2, r];
                  }
                });
              });
            }))] : [3, 4];

          case 3:
            return a = u.sent(), [3, 5];

          case 4:
            a = [r], u.label = 5;

          case 5:
            return s = a, [2, this.encryption.decrypt(JSON.parse(s.join("")))];

          case 6:
            return u.sent(), [2, null];

          case 7:
            return [2, null];
        }
      });
    });
  }, e.prototype.set = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = this._shardify(e), [4, this._setRaw(t)];

          case 1:
            return n.sent(), [2, n$1({}, e.value)];
        }
      });
    });
  }, e.prototype.setMany = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n = this;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return t = [], [4, this._setRaw(t.concat.apply(t, c$1([], a$1(e.map(function (e) {
              return n._shardify(e);
            })), !1)))];

          case 1:
            return r.sent(), [2, e.map(function (e) {
              return e.value;
            })];
        }
      });
    });
  }, e.prototype.remove = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i = this;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return t = this._getRawKey(e, ".0"), [4, this._getRaw(t)];

          case 1:
            return (n = s.sent()) ? (r = n.metadata, [4, this._removeRaw(this._generateShardPostfixArray(null == r ? void 0 : r.shards).map(function (t) {
              return i._getRawKey(e, ".".concat(t));
            }))]) : [3, 3];

          case 2:
            return s.sent(), [2, !0];

          case 3:
            return [2, !1];
        }
      });
    });
  }, e.prototype.removeMany = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i,
          s,
          a,
          o,
          u,
          c,
          l = this;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            t = [], n = function (e) {
              var n, i, s;
              return o$1(this, function (a) {
                switch (a.label) {
                  case 0:
                    return n = r._getRawKey(e, ".0"), [4, r._getRaw(n)];

                  case 1:
                    return (i = a.sent()) && (s = i.metadata, t.push.apply(t, c$1([], a$1(r._generateShardPostfixArray(null == s ? void 0 : s.shards).map(function (t) {
                      return l._getRawKey(e, ".".concat(t));
                    })), !1))), [2];
                }
              });
            }, r = this, d.label = 1;

          case 1:
            d.trys.push([1, 6, 7, 8]), i = s$2(e), s = i.next(), d.label = 2;

          case 2:
            return s.done ? [3, 5] : (a = s.value, [5, n(a)]);

          case 3:
            d.sent(), d.label = 4;

          case 4:
            return s = i.next(), [3, 2];

          case 5:
            return [3, 8];

          case 6:
            return o = d.sent(), u = {
              error: o
            }, [3, 8];

          case 7:
            try {
              s && !s.done && (c = i.return) && c.call(i);
            } finally {
              if (u) throw u.error;
            }

            return [7];

          case 8:
            return t.length > 0 ? [4, this._removeRaw(t)] : [3, 10];

          case 9:
            d.sent(), d.label = 10;

          case 10:
            return [2, e];
        }
      });
    });
  }, e;
}(),
    Ni = {},
    Ui = function (t) {
  function n(e) {
    void 0 === e && (e = {});
    var n,
        r = this;
    r = t.call(this, n$1(n$1({}, e), {
      itemSizeLimit: null !== (n = e.itemSizeLimit) && void 0 !== n ? n : 4194304
    })) || this;
    var i = e.delay,
        s = void 0 === i ? 1 : i;
    return r.delay = s, r.observer = {}, r;
  }

  return t$1(n, t), Object.defineProperty(n.prototype, "rawData", {
    get: function () {
      return Ni[this.dbname];
    },
    set: function (e) {
      Ni[this.dbname] = e;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype._getAllRawKeys = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        if (Ni[this.dbname]) return [2, Object.keys(Ni[this.dbname])];
        throw qr.storeNotAvailable;
      });
    });
  }, n.prototype._getRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return Ni[this.dbname] ? [4, jr(this.delay)] : [3, 2];

          case 1:
            return t.sent(), [2, Ni[this.dbname][e] ? n$1({
              key: e
            }, Ni[this.dbname][e]) : null];

          case 2:
            throw qr.storeNotAvailable;
        }
      });
    });
  }, n.prototype._setRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a, o, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return Ni[this.dbname] ? [4, jr(this.delay)] : [3, 2];

          case 1:
            c.sent();

            try {
              for (t = s$2(e), n = t.next(); !n.done; n = t.next()) r = n.value, i = r.key, s = r.data, a = r.metadata, Ni[this.dbname][i] = Object.freeze({
                data: s,
                metadata: a
              });
            } catch (e) {
              o = {
                error: e
              };
            } finally {
              try {
                n && !n.done && (u = t.return) && u.call(t);
              } finally {
                if (o) throw o.error;
              }
            }

            return [3, 3];

          case 2:
            throw qr.storeNotAvailable;

          case 3:
            return [2];
        }
      });
    });
  }, n.prototype._removeRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return Ni[this.dbname] ? [4, jr(this.delay)] : [3, 2];

          case 1:
            a.sent();

            try {
              for (t = s$2(e), n = t.next(); !n.done; n = t.next()) r = n.value, Ni[this.dbname][r] && delete Ni[this.dbname][r];
            } catch (e) {
              i = {
                error: e
              };
            } finally {
              try {
                n && !n.done && (s = t.return) && s.call(t);
              } finally {
                if (i) throw i.error;
              }
            }

            return [3, 3];

          case 2:
            throw qr.storeNotAvailable;

          case 3:
            return [2];
        }
      });
    });
  }, n.prototype.observe = function (e, t, n) {
    var r = this;
    this.observer[e] || (this.observer[e] = {}), t.forEach(function (t) {
      return r.observer[e][t] = n;
    });
  }, n.prototype.checkAvailability = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return [2];
      });
    });
  }, n.prototype.init = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this.dbname = e, Ni[this.dbname] || (Ni[this.dbname] = {}), [4, this._resetIfEncryptionChanged()];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, n.prototype.set = function (e) {
    return i$1(this, void 0, void 0, function () {
      var n, r;
      return o$1(this, function (i) {
        if ((n = this.observer[e.key]) && "function" == typeof n.set && (r = n.set())) throw r;
        return [2, t.prototype.set.call(this, e)];
      });
    });
  }, n.prototype.setMany = function (e) {
    return i$1(this, void 0, void 0, function () {
      var n, r, i, s, a, o, u;
      return o$1(this, function (c) {
        try {
          for (n = s$2(e), r = n.next(); !r.done; r = n.next()) if (i = r.value, (s = this.observer[i.key]) && "function" == typeof s.set && (a = s.set())) throw a;
        } catch (e) {
          o = {
            error: e
          };
        } finally {
          try {
            r && !r.done && (u = n.return) && u.call(n);
          } finally {
            if (o) throw o.error;
          }
        }

        return [2, t.prototype.setMany.call(this, e)];
      });
    });
  }, n.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, jr(this.delay)];

          case 1:
            return e.sent(), Ni[this.dbname] = {}, [2];
        }
      });
    });
  }, n;
}(Ai),
    Oi = "NestDBStore";

!function (e) {
  e[e.UNINITIALIZED = 0] = "UNINITIALIZED", e[e.OPENING = 1] = "OPENING", e[e.OPEN = 2] = "OPEN", e[e.CLOSED = 3] = "CLOSED";
}(gi || (gi = {}));

var Ci = function (t) {
  function n(e) {
    void 0 === e && (e = {});
    var n,
        r = this;
    return (r = t.call(this, n$1(n$1({}, e), {
      itemSizeLimit: null !== (n = e.itemSizeLimit) && void 0 !== n ? n : 104857600
    })) || this)._storeName = Oi, r._state = gi.UNINITIALIZED, r._openJobQueue = [], r._window = "undefined" != typeof window ? window : void 0, r._indexedDb = r._window ? r._window.indexedDB || r._window.mozIndexedDB || r._window.webkitIndexedDB || r._window.msIndexedDB : void 0, r;
  }

  return t$1(n, t), Object.defineProperty(n.prototype, "state", {
    get: function () {
      return this._state;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype._openDatabase = function (e) {
    var t = this;
    return new Promise(function (n, r) {
      if (t._indexedDb) {
        t._state = gi.OPENING;

        var i = t._indexedDb.open(e);

        i.addEventListener("upgradeneeded", function (e) {
          e.target.result.createObjectStore(Oi, {
            keyPath: "key"
          });
        }), i.addEventListener("success", function (r) {
          t._state = gi.OPEN, t._database = r.target.result, t._openJobQueue.forEach(function (e) {
            return e();
          }), t._openJobQueue = [], t._database.onclose = function () {
            t._database = void 0, t._state = gi.OPENING, setTimeout(function () {
              t._openDatabase(e);
            }, 5);
          }, n(t._database);
        }), i.addEventListener("error", function (e) {
          t._state = gi.UNINITIALIZED, r(e.target.error);
        });
      } else r(qr.storeNotAvailable);
    });
  }, n.prototype._getObjectStore = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this._database ? [2, this._database.transaction(this._storeName, e).objectStore(this._storeName)] : [3, 1];

          case 1:
            switch (this._state) {
              case gi.UNINITIALIZED:
              case gi.OPEN:
                return [3, 2];

              case gi.OPENING:
              case gi.CLOSED:
                return [3, 3];
            }

            return [3, 4];

          case 2:
            throw qr.storeNotInitialized;

          case 3:
            return [2, new Promise(function (n) {
              t._openJobQueue.push(function () {
                return n(t._getObjectStore(e));
              });
            })];

          case 4:
            return [4, this._getObjectStore(e)];

          case 5:
            return [2, n.sent()];
        }
      });
    });
  }, n.prototype._getAllRawKeys = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._getObjectStore("readonly")];

          case 1:
            return e = t.sent(), [4, new Promise(function (t, n) {
              var r = e.getAllKeys();
              r.addEventListener("success", function (e) {
                t(e.target.result);
              }), r.addEventListener("error", function (e) {
                return n(e.target.error);
              });
            })];

          case 2:
            return [2, t.sent()];
        }
      });
    });
  }, n.prototype._getRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._getObjectStore("readonly")];

          case 1:
            return t = n.sent(), [4, new Promise(function (n, r) {
              var i = t.get(e);
              i.addEventListener("success", function (e) {
                var t;
                n(null === (t = null == e ? void 0 : e.target) || void 0 === t ? void 0 : t.result);
              }), i.addEventListener("error", function (e) {
                return r(e.target.error);
              });
            })];

          case 2:
            return [2, n.sent()];
        }
      });
    });
  }, n.prototype._setRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._getObjectStore("readwrite")];

          case 1:
            return t = n.sent(), [4, Promise.all(e.map(function (e) {
              return new Promise(function (n, r) {
                var i = t.put(e);
                i.addEventListener("success", function (e) {
                  n(e.target.result);
                }), i.addEventListener("error", function () {
                  r("Failed to write.");
                });
              });
            }))];

          case 2:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype._removeRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._getObjectStore("readwrite")];

          case 1:
            return t = n.sent(), [4, Promise.all(e.map(function (e) {
              return new Promise(function (n, r) {
                var i = t.delete(e);
                i.addEventListener("success", function () {
                  return n(e);
                }), i.addEventListener("error", function (e) {
                  return r(e.target.error);
                });
              });
            }))];

          case 2:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype._triggerDatabaseClose = function () {
    this._database && this._database.onclose && this._database.onclose(new Event("dummy"));
  }, n.prototype.checkAvailability = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            if (!((null == (e = "undefined" != typeof window ? window : null) ? void 0 : e.indexedDB) || (null == e ? void 0 : e.mozIndexedDB) || (null == e ? void 0 : e.webkitIndexedDB) || (null == e ? void 0 : e.msIndexedDB))) return [3, 6];
            if (this._indexedDb = e.indexedDB || e.mozIndexedDB || e.webkitIndexedDB || e.msIndexedDB, !this._window || !yi()) return [3, 4];
            if (!(yi() && navigator.userAgent && navigator.userAgent.includes("Edge/"))) return [3, 1];
            if (!this._window.indexedDB && (e.PointerEvent || e.MSPointerEvent)) throw qr.storeNotAvailableInPrivateBrowsing;
            return [3, 3];

          case 1:
            return [4, new Promise(function (e, n) {
              if (t._indexedDb) try {
                var r = t._indexedDb.open("_testMozilla");

                r.onerror = function () {
                  return n(qr.storeNotAvailableInPrivateBrowsing);
                }, r.onsuccess = function () {
                  return e();
                };
              } catch (e) {
                n(qr.storeNotAvailableInPrivateBrowsing);
              } else n(qr.storeNotAvailable);
            })];

          case 2:
            n.sent(), n.label = 3;

          case 3:
            return [3, 5];

          case 4:
            throw qr.storeNotAvailable;

          case 5:
            return [3, 7];

          case 6:
            throw qr.storeNotAvailable;

          case 7:
            return [2];
        }
      });
    });
  }, n.prototype.init = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this.dbname = e, [4, this.checkAvailability()];

          case 1:
            return t.sent(), [4, this._openDatabase(e)];

          case 2:
            return t.sent(), [4, this._resetIfEncryptionChanged()];

          case 3:
            return t.sent(), [2];
        }
      });
    });
  }, n.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._getObjectStore("readwrite")];

          case 1:
            return e = t.sent(), [4, new Promise(function (t, n) {
              var r = e.clear();
              r.addEventListener("success", function () {
                return t();
              }), r.addEventListener("error", function (e) {
                return n(e.target.error);
              });
            })];

          case 2:
            return [2, t.sent()];
        }
      });
    });
  }, n;
}(Ai),
    Pi = function (t) {
  function n(e) {
    var n = this,
        r = e.AsyncStorage,
        i = e.itemSizeLimit,
        s = void 0 === i ? 6291456 : i,
        a = r$1(e, ["AsyncStorage", "itemSizeLimit"]);
    return (n = t.call(this, n$1(n$1({}, a), {
      itemSizeLimit: s
    })) || this)._asyncStorage = r, n;
  }

  return t$1(n, t), n.prototype._isBelonging = function (e) {
    return e.startsWith("".concat(this.dbname, "/"));
  }, n.prototype._getActualKey = function (e) {
    return "".concat(this.dbname, "/").concat(e);
  }, n.prototype._getAllRawKeys = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._asyncStorage.getAllKeys()];

          case 1:
            return e = n.sent(), [2, e.filter(function (e) {
              return t._isBelonging(e);
            }).map(function (e) {
              return e.substring("".concat(t.dbname, "/").length);
            })];
        }
      });
    });
  }, n.prototype._getRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._asyncStorage.getItem(this._getActualKey(e))];

          case 1:
            return [2, (t = n.sent()) ? JSON.parse(t) : null];
        }
      });
    });
  }, n.prototype._setRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a, o;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            t = [];

            try {
              for (n = s$2(e), r = n.next(); !r.done; r = n.next()) i = r.value, s = i.key, i.data.length <= this.adjustedItemSizeLimit && t.push([this._getActualKey(s), JSON.stringify(i)]);
            } catch (e) {
              a = {
                error: e
              };
            } finally {
              try {
                r && !r.done && (o = n.return) && o.call(n);
              } finally {
                if (a) throw a.error;
              }
            }

            return [4, this._asyncStorage.multiSet(t)];

          case 1:
            return u.sent(), [2];
        }
      });
    });
  }, n.prototype._removeRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._asyncStorage.multiRemove(e.map(function (e) {
              return t._getActualKey(e);
            }))];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.checkAvailability = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        if (!this._asyncStorage) throw qr.storeNotAvailable;
        return [2];
      });
    });
  }, n.prototype.init = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this.dbname = e, [4, this._resetIfEncryptionChanged()];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, n.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this.getAllKeys()];

          case 1:
            return e = t.sent(), [4, this.removeMany(e)];

          case 2:
            return t.sent(), [2];
        }
      });
    });
  }, n;
}(Ai);

!function (t) {
  function n(e) {
    var n,
        r = this;
    return (r = t.call(this, n$1(n$1({}, e), {
      itemSizeLimit: null !== (n = e.itemSizeLimit) && void 0 !== n ? n : 6291456
    })) || this)._mmkv = e.MMKV, r;
  }

  t$1(n, t), n.prototype._isBelonging = function (e) {
    return e.startsWith("".concat(this.dbname, "/"));
  }, n.prototype._getActualKey = function (e) {
    return "".concat(this.dbname, "/").concat(e);
  }, n.prototype._getAllRawKeys = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._mmkv.getAllKeys()];

          case 1:
            return e = n.sent(), [2, e.filter(function (e) {
              return t._isBelonging(e);
            }).map(function (e) {
              return e.substring("".concat(t.dbname, "/").length);
            })];
        }
      });
    });
  }, n.prototype._getRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._mmkv.getString(this._getActualKey(e))];

          case 1:
            return [2, (t = n.sent()) ? JSON.parse(t) : null];
        }
      });
    });
  }, n.prototype._setRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a;
      return o$1(this, function (o) {
        try {
          for (t = s$2(e), n = t.next(); !n.done; n = t.next()) r = n.value, i = r.key, r.data.length <= this.adjustedItemSizeLimit && this._mmkv.set(this._getActualKey(i), JSON.stringify(r));
        } catch (e) {
          s = {
            error: e
          };
        } finally {
          try {
            n && !n.done && (a = t.return) && a.call(t);
          } finally {
            if (s) throw s.error;
          }
        }

        return [2];
      });
    });
  }, n.prototype._removeRaw = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s;
      return o$1(this, function (a) {
        try {
          for (t = s$2(e), n = t.next(); !n.done; n = t.next()) r = n.value, this._mmkv.delete(this._getActualKey(r));
        } catch (e) {
          i = {
            error: e
          };
        } finally {
          try {
            n && !n.done && (s = t.return) && s.call(t);
          } finally {
            if (i) throw i.error;
          }
        }

        return [2];
      });
    });
  }, n.prototype.checkAvailability = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        if (!this._mmkv) throw qr.storeNotAvailable;
        return [2];
      });
    });
  }, n.prototype.init = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this.dbname = e, [4, this._resetIfEncryptionChanged()];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, n.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this.getAllKeys()];

          case 1:
            return e = t.sent(), [4, this.removeMany(e)];

          case 2:
            return t.sent(), [2];
        }
      });
    });
  };
}(Ai);
var ki;
!function (e) {
  e.INIT = "INIT", e.OPENING = "OPENING", e.OPENED = "OPENED", e.CLOSED = "CLOSED";
}(ki || (ki = {}));

var Ri,
    xi = function () {
  function e(e) {
    var t = e.name,
        n = e.version,
        r = e.store,
        i = e.config;
    this.name = t, this._version = n, this._state = ki.INIT, this._config = i || new Lr({
      dbname: t
    }), this._store = r, this._event = {
      success: Gr,
      error: Gr,
      storeReplaced: Gr,
      upgrade: Hr
    }, this._collections = new Map(), this._globalMutex = new Ii("".concat(this.name, ".lock")), this._config.disableLogger && Mi.off(), new di({
      dbname: t,
      limit: this._config.cacheLimit
    });
  }

  return Object.defineProperty(e.prototype, "version", {
    get: function () {
      return this._version;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "state", {
    get: function () {
      return this._state;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "store", {
    get: function () {
      return this._store;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.estimateUsage = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, (t = this._store, i$1(void 0, void 0, void 0, function () {
              return o$1(this, function (e) {
                switch (e.label) {
                  case 0:
                    return [4, t.usage()];

                  case 1:
                    return [2, e.sent()];
                }
              });
            }))];

          case 1:
            return [2, e.sent()];
        }

        var t;
      });
    });
  }, e.prototype.commitSchema = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this._state !== ki.OPENING ? [3, 2] : [4, Promise.all(e.map(function (e) {
              return i$1(t, void 0, void 0, function () {
                var t, n, r, i, s;
                return o$1(this, function (a) {
                  switch (a.label) {
                    case 0:
                      return t = e.collectionName, n = e.keyName, r = e.index, i = void 0 === r ? [] : r, this._collections.has(t) || this._collections.set(t, new Ei({
                        dbname: this.name,
                        collectionName: t,
                        keyName: n,
                        indexes: i,
                        store: this._store
                      })), (s = this._collections.get(t)) ? [4, s.init()] : [3, 2];

                    case 1:
                      a.sent(), a.label = 2;

                    case 2:
                      return [2];
                  }
                });
              });
            }))];

          case 1:
            return n.sent(), [3, 3];

          case 2:
            throw qr.databaseSchemaNotOnUpgrade;

          case 3:
            return [2];
        }
      });
    });
  }, e.prototype.open = function () {
    var e;
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i,
          s = this;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return [4, this._globalMutex.lock()];

          case 1:
            if (a.sent(), this._state === ki.OPENED) return [3, 12];
            this._state = ki.OPENING, a.label = 2;

          case 2:
            return a.trys.push([2, 5,, 12]), [4, this._store.init(this.name)];

          case 3:
            return a.sent(), o = this.name, t = "".concat(ti(o), ".metadata"), n = {
              version: 0,
              collectionNames: []
            }, [4, this._store.get(t)];

          case 4:
            return r = null !== (e = a.sent()) && void 0 !== e ? e : n, [2, new Promise(function (e, n) {
              var i = function (e) {
                r.version < s._version ? s._event.upgrade(r.version, function (n) {
                  return i$1(s, void 0, void 0, function () {
                    var i;
                    return o$1(this, function (s) {
                      switch (s.label) {
                        case 0:
                          if (n) return [3, 5];
                          r.version++, r.collectionNames = Array.from(this._collections.keys()), s.label = 1;

                        case 1:
                          return s.trys.push([1, 3,, 4]), [4, this._store.set({
                            key: t,
                            value: r
                          })];

                        case 2:
                          return s.sent(), e({
                            continued: !0
                          }), [3, 4];

                        case 3:
                          return i = s.sent(), e({
                            continued: !1,
                            err: i
                          }), [3, 4];

                        case 4:
                          return [3, 6];

                        case 5:
                          e({
                            continued: !1,
                            err: n
                          }), s.label = 6;

                        case 6:
                          return [2];
                      }
                    });
                  });
                }) : e({
                  continued: !1
                });
              },
                  a = function (t) {
                var o = t.continued,
                    u = void 0 !== o && o,
                    c = t.err,
                    l = void 0 === c ? null : c;
                if (u) setTimeout(function () {
                  return i(a);
                }, 10);else if (l) Mi.error(l.message), s._globalMutex.unlock(), s._event.error(l), n(l);else {
                  var d = [];
                  r.collectionNames.forEach(function (e) {
                    var t = s._collections.get(e);

                    t && t.state === Dr.READY || d.push(i$1(s, void 0, void 0, function () {
                      var t, n;
                      return o$1(this, function (r) {
                        switch (r.label) {
                          case 0:
                            return [4, Ei.metadataOf(this.name, e, this._store)];

                          case 1:
                            return (t = r.sent()) ? (n = new Ei({
                              dbname: this.name,
                              collectionName: e,
                              keyName: t.keyName,
                              indexes: t.indexes,
                              store: this._store
                            }), this._collections.set(e, n), [4, n.init()]) : [3, 3];

                          case 2:
                            r.sent(), r.label = 3;

                          case 3:
                            return [2];
                        }
                      });
                    }));
                  }), Promise.all(d).then(function () {
                    s._state = ki.OPENED, s._globalMutex.unlock(), s._event.success(), e();
                  }).catch(function (e) {
                    Mi.error(e.message), s._globalMutex.unlock(), s._event.error(e), n(e);
                  });
                }
              };

              i(a);
            })];

          case 5:
            switch (i = a.sent(), i.code) {
              case ir.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:
                return [3, 6];

              case ir.STORE_NOT_AVAILABLE:
                return [3, 8];
            }

            return [3, 10];

          case 6:
            return Mi.warning("Access to the local storage is not allowed. Switched to MemoryStore automatically."), this._store = new Ui({}), this._globalMutex.unlock(), this._event.error(i), this._event.storeReplaced(this._store), [4, this.open()];

          case 7:
            return a.sent(), [3, 11];

          case 8:
            return Mi.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."), this._store = new Ui({}), this._globalMutex.unlock(), this._event.error(i), this._event.storeReplaced(this._store), [4, this.open()];

          case 9:
            return a.sent(), [3, 11];

          case 10:
            throw Mi.error(i.message), this._globalMutex.unlock(), this._event.error(i), i;

          case 11:
            return [3, 12];

          case 12:
            return [2];
        }

        var o;
      });
    });
  }, e.prototype.close = function () {
    this._collections.forEach(function (e) {
      return e.close();
    }), this._state = ki.CLOSED;
  }, e.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, Promise.all(Array.from(this._collections.values()).map(function (e) {
              return e.clear();
            }))];

          case 1:
            return e.sent(), [2];
        }
      });
    });
  }, e.prototype.reset = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.close(), (e = di.get(this.name)) && e.clearByCondition(function (e) {
              return e.key.startsWith(ti(t.name));
            }), [4, this._store.clear()];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, e.prototype.on = function (e, t) {
    this._event[e] = t;
  }, e.prototype.off = function (e) {
    if ("function" == typeof this._event[e]) if ("upgrade" === e) this._event[e] = Hr;else this._event[e] = Gr;
  }, e.prototype.collection = function (e) {
    var t = this._collections.get(e);

    if (t) return t;
    throw qr.collectionNotReady;
  }, e;
}(),
    Li = function () {
  function e() {
    this.messageTypeFilter = z.ALL, this.customTypesFilter = null, this.senderUserIdsFilter = null, this.replyType = V.NONE;
  }

  return e.prototype.clone = function () {
    var t = new e(),
        n = JSON.parse(JSON.stringify(this));
    return Object.keys(n).forEach(function (e) {
      t[e] = n[e];
    }), t;
  }, e.prototype.match = function (e) {
    switch (this.messageTypeFilter) {
      case z.USER:
        if (e.messageType !== P$1.USER) return !1;
        break;

      case z.FILE:
        if (e.messageType !== P$1.FILE) return !1;
        break;

      case z.ADMIN:
        if (e.messageType !== P$1.ADMIN) return !1;
    }

    if (this.customTypesFilter && this.customTypesFilter.length > 0 && !this.customTypesFilter.includes(e.customType)) return !1;

    if (this.senderUserIdsFilter && this.senderUserIdsFilter.length > 0) {
      if (!(e instanceof De$2)) return !1;
      if (!this.senderUserIdsFilter.includes(e.sender.userId)) return !1;
    }

    switch (this.replyType) {
      case V.NONE:
        if (e.parentMessageId > 0) return !1;
        break;

      case V.ONLY_REPLY_TO_CHANNEL:
        if (e instanceof De$2 && e.parentMessageId > 0 && !e.replyToChannel) return !1;
    }

    return !0;
  }, e;
}();

!function (e) {
  e.CHANNEL_LATEST = "channel_latest", e.NEWEST_CHILD_MESSAGE = "newest_child_message";
}(Ri || (Ri = {}));

var Di,
    qi = function (e) {
  switch (e) {
    case Ri.CHANNEL_LATEST:
      return ["channelUrl", "-createdAt", "-messageId"];

    case Ri.NEWEST_CHILD_MESSAGE:
      return ["channelUrl", "-parentMessageId", "-createdAt", "-messageId"];
  }
},
    Fi = n$1(n$1({}, Tt$2), {
  scheduledAt: void 0
}),
    zi = function (e) {
  return wt$2(e) && w$1("number", e.scheduledAt, !0);
},
    Bi = n$1(n$1({}, bt$1), {
  scheduledAt: 0,
  file: void 0,
  fileUrl: void 0,
  fileName: void 0,
  mimeType: void 0,
  fileSize: void 0,
  thumbnailSizes: void 0,
  requireAuth: !1
}),
    Ki = function (e) {
  return It$2(e) && w$1("number", e.scheduledAt) && (k(e.file) || w$1("string", e.fileUrl)) && w$1("string", e.fileName, !0) && w$1("string", e.mimeType, !0) && w$1("number", e.fileSize, !0) && (null === e.thumbnailSizes || void 0 === e.thumbnailSizes || e.thumbnailSizes.every(function (e) {
    return w$1("object", e) && e.maxWidth > 0 && e.maxHeight > 0;
  }));
},
    ji = "UnsentMessage",
    Qi = "reqId",
    Gi = {},
    Vi = function (t) {
  function n(e) {
    var n = t.call(this, e) || this;
    return n._mutex = new Ii("unsendmessagecache.lock"), Gi[e] = n, n;
  }

  return t$1(n, t), Object.defineProperty(n.prototype, "_cacheContext", {
    get: function () {
      return _o.of(this._iid).cacheContext;
    },
    enumerable: !1,
    configurable: !0
  }), n.of = function (e, t) {
    return void 0 === t && (t = !1), Gi[e] && !t || (Gi[e] = new n(e)), Gi[e];
  }, Object.defineProperty(n.prototype, "collection", {
    get: function () {
      var e = this._cacheContext.nestdb,
          t = null == e ? void 0 : e.collection(ji);
      if (!t) throw v$2.databaseError;
      return t;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "localCacheEnabled", {
    get: function () {
      return this._cacheContext.localCacheEnabled && !!this.collection;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype._serialize = function (e) {
    if (e.messageId > 0) throw v$2.invalidParameters;
    var t,
        n = n$1({}, e.serialize());
    return e instanceof je$1 ? (e.messageParams && (n.messageParams = Et$1(e.messageParams)), e.scheduledInfo && e.scheduledInfo.scheduledMessageParams && (n.scheduledInfo.scheduledMessageParams = (t = e.scheduledInfo.scheduledMessageParams, n$1(n$1({}, Et$1(t)), {
      scheduledAt: t.scheduledAt
    })))) : e instanceof He$2 ? (e.messageParams && (n.messageParams = Nt$2(e.messageParams)), e.scheduledInfo && e.scheduledInfo.scheduledMessageParams && (n.scheduledInfo.scheduledMessageParams = function (e) {
      return n$1(n$1({}, Nt$2(e)), {
        scheduledAt: e.scheduledAt
      });
    }(e.scheduledInfo.scheduledMessageParams))) : e instanceof Ge && e.messageParams && (n.messageParams = function (e) {
      return J({
        fileInfoList: e.fileInfoList,
        isReplyToChannel: e.isReplyToChannel,
        pushNotificationDeliveryOption: e.pushNotificationDeliveryOption
      });
    }(e.messageParams)), n;
  }, n.prototype._deserialize = function (e) {
    return e = n$1(n$1({}, e), {
      messageId: parseInt(e.messageId)
    }), Zi.of(this._iid).buildMessageFromSerializedData(e);
  }, n.prototype._deserializeWithMessageCreateParams = function (e) {
    var t, n, r;
    return i$1(this, void 0, void 0, function () {
      var i,
          s,
          a,
          o,
          u,
          c,
          l = this;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            return i = Zi.of(this._iid), s = this._deserialize(e), e.messageParams ? s instanceof je$1 ? (o = e.messageParams, s.messageParams = i.buildUserMessageCreateParamsFromSerializedData(o, s), [3, 6]) : [3, 1] : [3, 6];

          case 1:
            return s instanceof He$2 ? (o = e.messageParams).fileKey && "string" == typeof o.fileKey && At$2(null !== (t = o.fileType) && void 0 !== t ? t : "") ? (a = o, [4, this.collection.getBlob(o.fileKey)]) : [3, 3] : [3, 4];

          case 2:
            a.file = null !== (n = d.sent()) && void 0 !== n ? n : void 0, d.label = 3;

          case 3:
            return s.messageParams = i.buildFileMessageCreateParamsFromSerializedData(o, s), [3, 6];

          case 4:
            return s instanceof Ge && (o = e.messageParams) && o.fileInfoList ? (s.messageParams = i.buildMultipleFilesMessageCreateParamsFromSerializedData(o, s), [4, Promise.all(s.messageParams.fileInfoList.map(function (e) {
              return i$1(l, void 0, void 0, function () {
                var t, n, r, i, s;
                return o$1(this, function (a) {
                  switch (a.label) {
                    case 0:
                      return "string" == typeof (null === (n = e._uploadedMetaData) || void 0 === n ? void 0 : n.fileKey) && At$2(null !== (i = null === (r = e._uploadedMetaData) || void 0 === r ? void 0 : r.fileType) && void 0 !== i ? i : "") ? (t = e, [4, this.collection.getBlob(e._uploadedMetaData.fileKey)]) : [3, 2];

                    case 1:
                      t.file = null !== (s = a.sent()) && void 0 !== s ? s : void 0, a.label = 2;

                    case 2:
                      return [2];
                  }
                });
              });
            }))]) : [3, 6];

          case 5:
            d.sent(), d.label = 6;

          case 6:
            return s.scheduledInfo && e.scheduledInfo && e.scheduledInfo.scheduledMessageParams ? s instanceof je$1 ? (u = e.scheduledInfo.scheduledMessageParams, s.scheduledInfo.scheduledMessageParams = i.buildScheduledUserMessageCreateParamsFromSerializedData(u, s), [3, 10]) : [3, 7] : [3, 10];

          case 7:
            return s instanceof He$2 ? (u = e.scheduledInfo.scheduledMessageParams).fileKey && "string" == typeof u.fileKey && "string" == typeof u.fileType && At$2(u.fileType) ? (c = u, [4, this.collection.getBlob(u.fileKey)]) : [3, 9] : [3, 10];

          case 8:
            c.file = null !== (r = d.sent()) && void 0 !== r ? r : void 0, d.label = 9;

          case 9:
            s.scheduledInfo.scheduledMessageParams = i.buildScheduledFileMessageCreateParamsFromSerializedData(u, s), d.label = 10;

          case 10:
            return [2, s];
        }
      });
    });
  }, n.prototype._getFileInfoBlobKey = function (e, t) {
    return "".concat(e, ".").concat(t);
  }, n.prototype.get = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.localCacheEnabled ? [4, this.collection.getByKey("".concat(e))] : [3, 2];

          case 1:
            if (t = n.sent()) return [2, this._deserializeWithMessageCreateParams(t)];
            n.label = 2;

          case 2:
            return [2, void 0];
        }
      });
    });
  }, n.prototype.fetch = function (e) {
    var t = e.channelUrl,
        n = e.filter,
        r = void 0 === n ? new Li() : n,
        i = e.order,
        s = void 0 === i ? Ri.CHANNEL_LATEST : i,
        a = e.sendingStatus,
        o = e.backward,
        u = void 0 !== o && o,
        c = e.parentMessageId;
    return i$1(this, void 0, void 0, function () {
      var e,
          n,
          i,
          o,
          l = this;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            return this.localCacheEnabled ? (e = qi(s), n = {
              "/where": function (e) {
                return !!(s !== Ri.NEWEST_CHILD_MESSAGE || c && 0 !== e.parentMessageId && e.parentMessageId === c) && r.match(l._deserialize(e));
              }
            }, t && (n.channelUrl = t), a && (n.sendingStatus = a), i = {
              where: n,
              index: e,
              backward: u
            }, [4, this.collection.query(i)]) : [3, 3];

          case 1:
            return [4, d.sent().fetch({})];

          case 2:
            return o = d.sent(), [2, Promise.all(o.map(function (e) {
              return i$1(l, void 0, void 0, function () {
                return o$1(this, function (t) {
                  switch (t.label) {
                    case 0:
                      return [4, this._deserializeWithMessageCreateParams(e)];

                    case 1:
                      return [2, t.sent()];
                  }
                });
              });
            }))];

          case 3:
            return [2, []];
        }
      });
    });
  }, n.prototype.getAllChildMessages = function (e, t) {
    return void 0 === t && (t = new Li()), i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this.fetch({
              filter: t,
              order: Ri.NEWEST_CHILD_MESSAGE,
              channelUrl: e.channelUrl,
              backward: !1,
              parentMessageId: e.messageId
            })];

          case 1:
            return [2, n.sent()];
        }
      });
    });
  }, n.prototype.upsert = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.localCacheEnabled ? [4, Promise.all(e.map(function (e) {
              return i$1(t, void 0, void 0, function () {
                var t;
                return o$1(this, function (n) {
                  switch (n.label) {
                    case 0:
                      return e instanceof He$2 || e instanceof Ge ? [4, this._mutex.lock()] : [3, 4];

                    case 1:
                      return n.sent(), [4, this.saveBlob(e)];

                    case 2:
                      return n.sent(), [4, this._mutex.unlock()];

                    case 3:
                      n.sent(), n.label = 4;

                    case 4:
                      return t = this._serialize(e), [4, this.collection.upsertOne(t)];

                    case 5:
                      return n.sent(), [2];
                  }
                });
              });
            }))] : [3, 2];

          case 1:
            n.sent(), n.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.upsertChildMessages = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.localCacheEnabled ? [4, Promise.all(e.map(function (e) {
              return i$1(t, void 0, void 0, function () {
                var t;
                return o$1(this, function (n) {
                  switch (n.label) {
                    case 0:
                      return t = [], e.threadInfo && e.threadInfo.replyCount > 0 ? [4, this.getAllChildMessages(e)] : [3, 2];

                    case 1:
                      t = n.sent(), n.label = 2;

                    case 2:
                      return t.length > 0 ? (t.forEach(function (t) {
                        return t.applyParentMessage(e);
                      }), [4, this.upsert(t)]) : [3, 4];

                    case 3:
                      n.sent(), n.label = 4;

                    case 4:
                      return [2];
                  }
                });
              });
            }))] : [3, 2];

          case 1:
            n.sent(), n.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.remove = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            if (!this.localCacheEnabled) return [3, 8];
            o.label = 1;

          case 1:
            o.trys.push([1, 6, 7, 8]), t = s$2(e), n = t.next(), o.label = 2;

          case 2:
            return n.done ? [3, 5] : (r = n.value, [4, this.collection.remove(r)]);

          case 3:
            o.sent(), o.label = 4;

          case 4:
            return n = t.next(), [3, 2];

          case 5:
            return [3, 8];

          case 6:
            return i = o.sent(), s = {
              error: i
            }, [3, 8];

          case 7:
            try {
              n && !n.done && (a = t.return) && a.call(t);
            } finally {
              if (s) throw s.error;
            }

            return [7];

          case 8:
            return [2];
        }
      });
    });
  }, n.prototype.removeMessagesOfChannel = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this.localCacheEnabled ? [4, this.collection.removeIf({
              where: {
                channelUrl: e
              }
            })] : [3, 2];

          case 1:
            t.sent(), t.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this.localCacheEnabled ? [4, this.collection.clear()] : [3, 2];

          case 1:
            e.sent(), e.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.saveBlob = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          i = this;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return e instanceof He$2 ? e.messageParams && (r = e.messageParams).file && St$2(r.file) ? [4, this.collection.saveBlob(r.file, e.reqId)] : [3, 2] : [3, 5];

          case 1:
            n = s.sent(), r.fileKey = n, r.fileType = mt$1.BLOB, s.label = 2;

          case 2:
            return e.scheduledInfo && e.scheduledInfo.scheduledMessageParams && (t = e.scheduledInfo.scheduledMessageParams).file && St$2(t.file) ? [4, this.collection.saveBlob(t.file, e.reqId)] : [3, 4];

          case 3:
            n = s.sent(), t.fileKey = n, t.fileType = mt$1.BLOB, s.label = 4;

          case 4:
            return [3, 7];

          case 5:
            return e instanceof Ge && (r = e.messageParams) && r.fileInfoList && Array.isArray(r.fileInfoList) ? [4, Promise.all(r.fileInfoList.map(function (t, n) {
              return i$1(i, void 0, void 0, function () {
                var r;
                return o$1(this, function (i) {
                  switch (i.label) {
                    case 0:
                      return t.file && St$2(t.file) ? [4, this.collection.saveBlob(t.file, this._getFileInfoBlobKey(e.reqId, n))] : [3, 2];

                    case 1:
                      r = i.sent(), t._uploadedMetaData || (t._uploadedMetaData = {}), t._uploadedMetaData.fileKey = r, t._uploadedMetaData.fileType = mt$1.BLOB, i.label = 2;

                    case 2:
                      return [2];
                  }
                });
              });
            }))] : [3, 7];

          case 6:
            s.sent(), s.label = 7;

          case 7:
            return [2];
        }
      });
    });
  }, n;
}(Fi$1),
    Wi = {},
    Hi = function (t) {
  function n(e) {
    var n = t.call(this, e) || this;
    return Wi[e] = n, n;
  }

  return t$1(n, t), Object.defineProperty(n.prototype, "_sdkState", {
    get: function () {
      return _o.of(this._iid).sdkState;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "_cacheContext", {
    get: function () {
      return _o.of(this._iid).cacheContext;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "_unsentMessageCache", {
    get: function () {
      return Vi.of(this._iid);
    },
    enumerable: !1,
    configurable: !0
  }), n.of = function (e, t) {
    return void 0 === t && (t = !1), Wi[e] && !t || (Wi[e] = new n(e)), Wi[e];
  }, Object.defineProperty(n.prototype, "collection", {
    get: function () {
      var e = this._cacheContext.nestdb;
      return Qi$1(!!e).throw(v$2.databaseError), e.collection(dr);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "localCacheEnabled", {
    get: function () {
      return this._cacheContext.localCacheEnabled && !!this.collection;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype._serialize = function (e) {
    return n$1(n$1({}, e.serialize()), {
      messageId: "".concat(e.messageId)
    });
  }, n.prototype._deserialize = function (e) {
    return e = n$1(n$1({}, e), {
      messageId: parseInt(e.messageId)
    }), Zi.of(this._iid).buildMessageFromSerializedData(e);
  }, n.prototype.get = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.localCacheEnabled ? [4, this.collection.getByKey("".concat(e))] : [3, 2];

          case 1:
            if (t = n.sent()) return [2, this._deserialize(t)];
            n.label = 2;

          case 2:
            return [2, void 0];
        }
      });
    });
  }, n.prototype.fetch = function (e) {
    var t = e.channelUrl,
        n = e.token,
        r = e.limit,
        i = void 0 === r ? 100 : r,
        s = e.filter,
        a = void 0 === s ? new Li() : s,
        o = e.order,
        u = void 0 === o ? Ri.CHANNEL_LATEST : o,
        c = e.backward,
        l = void 0 !== c && c,
        d = e.parentMessageId,
        h = e.isPollOnly,
        f = void 0 !== h && h,
        p = e.exactMatch,
        m = void 0 !== p && p,
        v = e.inclusive,
        y = void 0 === v || v;
    return i$1(this, void 0, void 0, function () {
      var e,
          r,
          s,
          o = this;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return this.localCacheEnabled ? (e = qi(u), r = {
              where: {
                channelUrl: t,
                "/where": function (e) {
                  if (n) switch (u) {
                    case Ri.CHANNEL_LATEST:
                      if (m && e.createdAt !== n) return !1;

                      if (l) {
                        if (y && e.createdAt < n || !y && e.createdAt <= n) return !1;
                      } else if (y && e.createdAt > n || !y && e.createdAt >= n) return !1;

                      break;

                    case Ri.NEWEST_CHILD_MESSAGE:
                      if (!d || 0 === e.parentMessageId || e.parentMessageId !== d) return !1;
                  }
                  return !(f && !e._poll) && a.match(o._deserialize(e));
                }
              },
              index: e,
              backward: l
            }, [4, this.collection.query(r)]) : [3, 3];

          case 1:
            return [4, c.sent().fetch({
              limit: null != i ? i : void 0
            })];

          case 2:
            return s = c.sent(), [2, Promise.all(s.map(function (e) {
              return i$1(o, void 0, void 0, function () {
                return o$1(this, function (t) {
                  return [2, this._deserialize(e)];
                });
              });
            }))];

          case 3:
            return [2, []];
        }
      });
    });
  }, n.prototype.getAllChildMessages = function (e, t) {
    return void 0 === t && (t = new Li()), i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this.fetch({
              channelUrl: e.channelUrl,
              token: Date.now(),
              limit: null,
              backward: !1,
              filter: t,
              order: Ri.NEWEST_CHILD_MESSAGE,
              parentMessageId: e.messageId
            })];

          case 1:
            return [2, n.sent()];
        }
      });
    });
  }, n.prototype.upsert = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n = this;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return this.localCacheEnabled ? [4, this.saveBlobs(e)] : [3, 5];

          case 1:
            return r.sent(), t = e.map(function (e) {
              return n._serialize(e);
            }), [4, this.collection.upsertMany(t)];

          case 2:
            return r.sent(), [4, this.upsertChildMessages(e)];

          case 3:
            return r.sent(), [4, this._unsentMessageCache.upsertChildMessages(e)];

          case 4:
            r.sent(), r.label = 5;

          case 5:
            return [2];
        }
      });
    });
  }, n.prototype.upsertChildMessages = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.localCacheEnabled ? [4, Promise.all(e.map(function (e) {
              return i$1(t, void 0, void 0, function () {
                var t, n;
                return o$1(this, function (r) {
                  switch (r.label) {
                    case 0:
                      return t = [], (null === (n = e.threadInfo) || void 0 === n ? void 0 : n.replyCount) && e.threadInfo.replyCount > 0 ? [4, this.getAllChildMessages(e)] : [3, 2];

                    case 1:
                      t = r.sent(), r.label = 2;

                    case 2:
                      return t.length > 0 ? (t.forEach(function (t) {
                        return t.applyParentMessage(e);
                      }), [4, this.upsert(t)]) : [3, 4];

                    case 3:
                      r.sent(), r.label = 4;

                    case 4:
                      return [2];
                  }
                });
              });
            }))] : [3, 2];

          case 1:
            n.sent(), n.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.remove = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            if (!this.localCacheEnabled) return [3, 8];
            o.label = 1;

          case 1:
            o.trys.push([1, 6, 7, 8]), t = s$2(e), n = t.next(), o.label = 2;

          case 2:
            return n.done ? [3, 5] : (r = n.value, [4, this.collection.remove("".concat(r))]);

          case 3:
            o.sent(), o.label = 4;

          case 4:
            return n = t.next(), [3, 2];

          case 5:
            return [3, 8];

          case 6:
            return i = o.sent(), s = {
              error: i
            }, [3, 8];

          case 7:
            try {
              n && !n.done && (a = t.return) && a.call(t);
            } finally {
              if (s) throw s.error;
            }

            return [7];

          case 8:
            return [2];
        }
      });
    });
  }, n.prototype.removeMessagesOfChannel = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.localCacheEnabled ? [4, this.collection.removeIf({
              where: {
                channelUrl: e
              },
              index: qi(Ri.CHANNEL_LATEST)
            })] : [3, 6];

          case 1:
            return n.sent(), [4, (t = this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId, "@groupchannel/").concat(e, "/message/sync"))];

          case 2:
            return n.sent(), [4, t.remove("sendbird:".concat(this._sdkState.userId, "@groupchannel/").concat(e, "/message/sync.meta"))];

          case 3:
            return n.sent(), [4, t.remove("sendbird:".concat(this._sdkState.userId, "@groupchannel/").concat(e, "/message/changelogs"))];

          case 4:
            return n.sent(), [4, t.remove("sendbird:".concat(this._sdkState.userId, "@groupchannel/").concat(e, "/message/changelogs.meta"))];

          case 5:
            n.sent(), n.label = 6;

          case 6:
            return [2];
        }
      });
    });
  }, n.prototype.removeUnderOffset = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this.localCacheEnabled ? [4, this.collection.removeIf({
              where: {
                channelUrl: e,
                createdAt: {
                  "<": t
                }
              },
              index: qi(Ri.CHANNEL_LATEST)
            })] : [3, 2];

          case 1:
            n.sent(), n.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this.localCacheEnabled ? [4, this.collection.clear()] : [3, 2];

          case 1:
            e.sent(), e.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.countBetween = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      var r,
          i = this;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return this.localCacheEnabled ? (r = qi(Ri.CHANNEL_LATEST), [4, this.collection.query({
              where: {
                channelUrl: e,
                "/where": function (e) {
                  var r = i._deserialize(e);

                  return n.includes(r.createdAt) && t.match(r);
                }
              },
              index: r
            }).count()]) : [3, 2];

          case 1:
            return [2, s.sent()];

          case 2:
            return [2, 0];
        }
      });
    });
  }, n.prototype.saveBlobs = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t = this;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, Promise.all(e.map(function (e) {
              return i$1(t, void 0, void 0, function () {
                var t, n;
                return o$1(this, function (r) {
                  switch (r.label) {
                    case 0:
                      return e instanceof He$2 && e.messageParams && (t = e.messageParams).file && St$2(t.file) ? [4, this.collection.saveBlob(t.file, e.reqId)] : [3, 2];

                    case 1:
                      n = r.sent(), t.fileKey = n, r.label = 2;

                    case 2:
                      return [2];
                  }
                });
              });
            }))];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype._getGroupChannelPreferenceSize = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, s, a;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return t = 0, [4, (n = this._cacheContext.preference).get("sendbird:".concat(this._sdkState.userId, "@groupchannel/").concat(e, "/message/sync"))];

          case 1:
            return r = o.sent(), [4, n.get("sendbird:".concat(this._sdkState.userId, "@groupchannel/").concat(e, "/message/sync.meta"))];

          case 2:
            return i = o.sent(), [4, n.get("sendbird:".concat(this._sdkState.userId, "@groupchannel/").concat(e, "/message/changelogs"))];

          case 3:
            return s = o.sent(), [4, n.get("sendbird:".concat(this._sdkState.userId, "@groupchannel/").concat(e, "/message/changelogs.meta"))];

          case 4:
            return a = o.sent(), r && (t += JSON.stringify(r).length), i && (t += JSON.stringify(i).length), s && (t += JSON.stringify(s).length), a && (t += JSON.stringify(a).length), [2, t];
        }
      });
    });
  }, n;
}(Fi$1),
    Yi = {},
    Ji = function (t) {
  function n(e) {
    var n = t.call(this, e) || this;
    return n._observers = new Map(), n._dispatcherContext = n._dispatcher.on(function (e) {
      return i$1(n, void 0, void 0, function () {
        var t,
            n,
            r,
            i,
            s,
            a,
            o,
            u,
            c,
            l,
            d,
            h,
            f,
            p,
            m = this;
        return o$1(this, function (v) {
          switch (v.label) {
            case 0:
              return e instanceof No ? (t = e.messages, f = e.source, s = e.isWebSocketEventComing, n = t.filter(function (e) {
                return e.messageId > 0;
              }), r = t.filter(function (e) {
                return 0 === e.messageId;
              }), n.length > 0 ? [4, mi$1(function () {
                return i$1(m, void 0, void 0, function () {
                  return o$1(this, function (e) {
                    switch (e.label) {
                      case 0:
                        return [4, this._messageCache.upsert(n)];

                      case 1:
                        return e.sent(), [4, this._unsentMessageCache.remove(n.map(function (e) {
                          return e instanceof De$2 ? e.reqId : null;
                        }).filter(function (e) {
                          return null !== e;
                        }))];

                      case 2:
                        return e.sent(), [2];
                    }
                  });
                });
              })] : [3, 2]) : [3, 5];

            case 1:
              v.sent(), s || this._broadcastUpdateEvent(n, f), v.label = 2;

            case 2:
              return r.length > 0 ? [4, mi$1(function () {
                return i$1(m, void 0, void 0, function () {
                  return o$1(this, function (e) {
                    switch (e.label) {
                      case 0:
                        return [4, this._unsentMessageCache.upsert(r)];

                      case 1:
                        return e.sent(), [2];
                    }
                  });
                });
              })] : [3, 4];

            case 3:
              v.sent(), s || this._broadcastUpdateEvent(r, f), v.label = 4;

            case 4:
              return [3, 21];

            case 5:
              return e instanceof To ? (i = e.messageIds, f = e.source, s = e.isWebSocketEventComing, [4, mi$1(function () {
                return i$1(m, void 0, void 0, function () {
                  return o$1(this, function (e) {
                    switch (e.label) {
                      case 0:
                        return [4, this._messageCache.remove(i)];

                      case 1:
                        return e.sent(), [2];
                    }
                  });
                });
              })]) : [3, 7];

            case 6:
              return v.sent(), s || this._broadcastRemoveEvent(i, f), [3, 21];

            case 7:
              return e instanceof So ? (a = e.reqId, f = e.source, [4, mi$1(function () {
                return i$1(m, void 0, void 0, function () {
                  return o$1(this, function (e) {
                    switch (e.label) {
                      case 0:
                        return [4, this._unsentMessageCache.remove([a])];

                      case 1:
                        return e.sent(), [2];
                    }
                  });
                });
              })]) : [3, 9];

            case 8:
              return v.sent(), this._broadcastRemoveUnsentEvent(a, f), [3, 21];

            case 9:
              return e instanceof Ao ? (o = e.polls, f = e.source, this._cacheContext.localCacheEnabled ? (u = o.map(function (e) {
                return e.messageId;
              }), [4, Promise.all(u.map(function (e) {
                return m._messageCache.get(e);
              }))]) : [3, 12]) : [3, 13];

            case 10:
              return (c = v.sent().filter(function (e) {
                return e;
              })).length > 0 && o.forEach(function (e) {
                var t = c.find(function (t) {
                  return t.messageId === e.messageId;
                });
                t && t.applyPoll(e);
              }), [4, mi$1(function () {
                return i$1(m, void 0, void 0, function () {
                  return o$1(this, function (e) {
                    switch (e.label) {
                      case 0:
                        return [4, this._messageCache.upsert(c)];

                      case 1:
                        return [2, e.sent()];
                    }
                  });
                });
              })];

            case 11:
              v.sent(), v.label = 12;

            case 12:
              return this._broadcastPollChangeLogEvent(o, f), [3, 21];

            case 13:
              return e instanceof Co ? (l = e.event, f = e.source, [4, this._messageCache.get(l.messageId)]) : [3, 17];

            case 14:
              return (d = v.sent()) && d.isUserMessage() && d.poll && d.poll.applyPollUpdateEvent(l) ? [4, mi$1(function () {
                return i$1(m, void 0, void 0, function () {
                  return o$1(this, function (e) {
                    switch (e.label) {
                      case 0:
                        return [4, this._messageCache.upsert([d])];

                      case 1:
                        return [2, e.sent()];
                    }
                  });
                });
              })] : [3, 16];

            case 15:
              v.sent(), v.label = 16;

            case 16:
              return this._broadcastPollUpdateEvent(l, f), [3, 21];

            case 17:
              return e instanceof ko ? (h = e.event, f = e.source, [4, this._messageCache.get(h.messageId)]) : [3, 21];

            case 18:
              return (p = v.sent()) && p.isUserMessage() && p.poll && p.poll.applyPollVoteEvent(h) ? [4, mi$1(function () {
                return i$1(m, void 0, void 0, function () {
                  return o$1(this, function (e) {
                    switch (e.label) {
                      case 0:
                        return [4, this._messageCache.upsert([p])];

                      case 1:
                        return [2, e.sent()];
                    }
                  });
                });
              })] : [3, 20];

            case 19:
              v.sent(), v.label = 20;

            case 20:
              this._broadcastPollVoteEvent(h, f), v.label = 21;

            case 21:
              return [2];
          }
        });
      });
    }), n;
  }

  return t$1(n, t), Object.defineProperty(n.prototype, "_cacheContext", {
    get: function () {
      return _o.of(this._iid).cacheContext;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "_dispatcher", {
    get: function () {
      return _o.of(this._iid).dispatcher;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "_messageCache", {
    get: function () {
      return Hi.of(this._iid);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "_unsentMessageCache", {
    get: function () {
      return Vi.of(this._iid);
    },
    enumerable: !1,
    configurable: !0
  }), n.of = function (e, t) {
    var r;
    return void 0 === t && (t = !1), Yi[e] && !t || (Yi[e] && (null === (r = Yi[e]._dispatcherContext) || void 0 === r || r.close()), Yi[e] = new n(e)), Yi[e];
  }, n.prototype._broadcastUpdateEvent = function (e, t) {
    var n, r;

    try {
      for (var i = s$2(this._observers.values()), s = i.next(); !s.done; s = i.next()) {
        var a = s.value;
        a.onUpdate && a.onUpdate(e, t);
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        s && !s.done && (r = i.return) && r.call(i);
      } finally {
        if (n) throw n.error;
      }
    }
  }, n.prototype._broadcastPollChangeLogEvent = function (e, t) {
    var n, r;

    try {
      for (var i = s$2(this._observers.values()), s = i.next(); !s.done; s = i.next()) {
        var a = s.value;
        a.onPollChangeLogUpdate && a.onPollChangeLogUpdate(e, t);
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        s && !s.done && (r = i.return) && r.call(i);
      } finally {
        if (n) throw n.error;
      }
    }
  }, n.prototype._broadcastPollUpdateEvent = function (e, t) {
    var n, r;

    try {
      for (var i = s$2(this._observers.values()), s = i.next(); !s.done; s = i.next()) {
        var a = s.value;
        a.onPollUpdate && a.onPollUpdate(e, t);
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        s && !s.done && (r = i.return) && r.call(i);
      } finally {
        if (n) throw n.error;
      }
    }
  }, n.prototype._broadcastPollVoteEvent = function (e, t) {
    var n, r;

    try {
      for (var i = s$2(this._observers.values()), s = i.next(); !s.done; s = i.next()) {
        var a = s.value;
        a.onPollVote && a.onPollVote(e, t);
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        s && !s.done && (r = i.return) && r.call(i);
      } finally {
        if (n) throw n.error;
      }
    }
  }, n.prototype._broadcastRemoveEvent = function (e, t) {
    var n, r;

    try {
      for (var i = s$2(this._observers.values()), s = i.next(); !s.done; s = i.next()) {
        var a = s.value;
        a.onRemove && a.onRemove(e, t);
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        s && !s.done && (r = i.return) && r.call(i);
      } finally {
        if (n) throw n.error;
      }
    }
  }, n.prototype._broadcastRemoveUnsentEvent = function (e, t) {
    var n, r;

    try {
      for (var i = s$2(this._observers.values()), s = i.next(); !s.done; s = i.next()) {
        var a = s.value;
        a.onRemoveUnsent && a.onRemoveUnsent(e, t);
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        s && !s.done && (r = i.return) && r.call(i);
      } finally {
        if (n) throw n.error;
      }
    }
  }, n.prototype.subscribe = function (e, t) {
    this._observers.set(e, t);
  }, n.prototype.unsubscribe = function (e) {
    this._observers.delete(e);
  }, n.prototype.unsubscribeAll = function () {
    this._observers.clear();
  }, n;
}(Fi$1),
    Xi = {},
    Zi = function () {
  function e(e, t) {
    var n = t.sdkState,
        r = t.dispatcher,
        i = t.requestQueue,
        s = t.onlineDetector,
        a = t.cacheContext;
    this._iid = e, this._sdkState = n, this._requestQueue = i, this._dispatcher = r, this._cacheContext = a, Hi.of(e), Vi.of(e), Ji.of(e), this.fileMessageQueue = new tt(e, {
      sdkState: n,
      dispatcher: r,
      requestQueue: i,
      onlineDetector: s,
      cacheContext: a
    }), Xi[e] = this;
  }

  return e.of = function (e) {
    return Xi[e];
  }, e.prototype.buildMessageFromSerializedData = function (e) {
    var t = Wi$1(e);

    switch (t.messageType) {
      case P$1.USER:
        return new je$1(this._iid, je$1.payloadify(t));

      case P$1.FILE:
        return Ge._isMultipleFilesMessageSerializedData(t) ? new Ge(this._iid, Ge.payloadify(t)) : new He$2(this._iid, He$2.payloadify(t));

      case P$1.ADMIN:
        return new Be$1(this._iid, Be$1.payloadify(t));
    }

    throw v$2.invalidParameters;
  }, e.prototype.buildUserMessageCreateParamsFromSerializedData = function (e, t) {
    return J($({
      data: t.data,
      customType: t.customType,
      mentionType: t.mentionType,
      mentionedUserIds: t.mentionedUserIds,
      mentionedUsers: t.mentionedUsers,
      mentionedMessageTemplate: t.mentionedMessageTemplate,
      metaArrays: t.metaArrays,
      parentMessageId: t.parentMessageId,
      isReplyToChannel: e.isReplyToChannel,
      pushNotificationDeliveryOption: e.pushNotificationDeliveryOption,
      appleCriticalAlertOptions: t.appleCriticalAlertOptions,
      reqId: t.reqId,
      message: t.message,
      translationTargetLanguages: Object.keys(t.translations),
      pollId: e.pollId
    }));
  }, e.prototype.buildFileMessageCreateParamsFromSerializedData = function (e, t) {
    var n;
    return J($({
      data: t.data,
      customType: t.customType,
      mentionType: t.mentionType,
      mentionedUserIds: t.mentionedUserIds,
      mentionedUsers: t.mentionedUsers,
      mentionedMessageTemplate: t.mentionedMessageTemplate,
      metaArrays: t.metaArrays,
      parentMessageId: t.parentMessageId,
      isReplyToChannel: e.isReplyToChannel,
      pushNotificationDeliveryOption: e.pushNotificationDeliveryOption,
      appleCriticalAlertOptions: t.appleCriticalAlertOptions,
      reqId: t.reqId,
      file: e.file,
      fileKey: e.fileKey,
      fileUrl: t.plainUrl,
      fileName: t.name,
      fileSize: t.size,
      mimeType: t.type,
      thumbnailSizes: null === (n = t.thumbnails) || void 0 === n ? void 0 : n.map(function (e) {
        return {
          maxWidth: e.width,
          maxHeight: e.height
        };
      }),
      fileType: e.fileType,
      requireAuth: t.requireAuth
    }));
  }, e.prototype.buildMultipleFilesMessageCreateParamsFromSerializedData = function (e, t) {
    return J({
      data: t.data,
      customType: t.customType,
      mentionType: t.mentionType,
      mentionedUserIds: t.mentionedUserIds,
      mentionedUsers: t.mentionedUsers,
      mentionedMessageTemplate: t.mentionedMessageTemplate,
      metaArrays: t.metaArrays,
      parentMessageId: t.parentMessageId,
      isReplyToChannel: e.isReplyToChannel,
      pushNotificationDeliveryOption: e.pushNotificationDeliveryOption,
      appleCriticalAlertOptions: t.appleCriticalAlertOptions,
      reqId: t.reqId,
      fileInfoList: e.fileInfoList
    });
  }, e.prototype.buildScheduledUserMessageCreateParamsFromSerializedData = function (e, t) {
    return n$1(n$1({}, this.buildUserMessageCreateParamsFromSerializedData(e, t)), {
      scheduledAt: e.scheduledAt
    });
  }, e.prototype.buildScheduledFileMessageCreateParamsFromSerializedData = function (e, t) {
    return n$1(n$1({}, this.buildFileMessageCreateParamsFromSerializedData(e, t)), {
      scheduledAt: e.scheduledAt
    });
  }, e.prototype.buildSenderFromSerializedData = function (e) {
    var t = Wi$1(e);
    return new Re$1(this._iid, Re$1.payloadify(t));
  }, e.prototype.getMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return t = new ot$1(e), [4, this._requestQueue.send(t)];

          case 1:
            return n = r.sent(), [2, n.as(ut$1).message];
        }
      });
    });
  }, e.prototype.getScheduledMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return t = new ft$1(e), [4, this._requestQueue.send(t)];

          case 1:
            return n = r.sent(), [2, n.as(pt$1).message];
        }
      });
    });
  }, e.prototype.getMessagesByMessageId = function (e, t, n, r, i) {
    return void 0 === i && (i = po.REQUEST_MESSAGE), i$1(this, void 0, void 0, function () {
      var s, a, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return s = new ct$1(n$1(n$1({
              channelType: t,
              channelUrl: e,
              token: String(n)
            }, rt), r)), [4, this._requestQueue.send(s)];

          case 1:
            return a = c.sent(), u = a.as(lt$1).messages, this._dispatcher.dispatch(new No({
              messages: u,
              source: i
            })), [2, u];
        }
      });
    });
  }, e.prototype.getMessagesByTimestamp = function (e, t, n, r, i) {
    return void 0 === i && (i = po.REQUEST_MESSAGE), i$1(this, void 0, void 0, function () {
      var s, a, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return s = new ct$1(n$1(n$1({
              channelType: t,
              channelUrl: e,
              timestamp: n
            }, rt), r)), [4, this._requestQueue.send(s)];

          case 1:
            return a = c.sent(), u = a.as(lt$1).messages, this._dispatcher.dispatch(new No({
              messages: u,
              source: i
            })), [2, u];
        }
      });
    });
  }, e.prototype._getMessagesByTimestampForCollection = function (e, t, n, r, i, s) {
    return void 0 === i && (i = po.REQUEST_MESSAGE), i$1(this, void 0, void 0, function () {
      var a, u, c, l;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            return a = new ct$1(n$1(n$1(n$1({
              channelType: t,
              channelUrl: e,
              timestamp: n
            }, rt), r), {
              checkingContinuousMessages: s
            })), [4, this._requestQueue.send(a)];

          case 1:
            return u = d.sent(), c = u.payload, l = u.as(lt$1).messages, this._dispatcher.dispatch(new No({
              messages: l,
              source: i
            })), [2, {
              messages: l,
              isContinuousMessages: c
            }];
        }
      });
    });
  }, e.prototype.getThreadedMessagesByTimestamp = function (e, t, n, r) {
    return void 0 === r && (r = po.REQUEST_THREADED_MESSAGE), i$1(this, void 0, void 0, function () {
      var i, s, a, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return i = new ct$1(n$1(n$1(n$1({
              channelUrl: e.channelUrl,
              channelType: e.channelType,
              timestamp: t
            }, Fe), n), {
              replyType: V.ALL,
              parentMessageId: e.messageId,
              includeThreadInfo: !0
            })), [4, this._requestQueue.send(i)];

          case 1:
            return s = c.sent(), a = s.as(lt$1).messages, (u = a.slice(1)).forEach(function (t) {
              t.parentMessage = e;
            }), this._dispatcher.dispatch(new No({
              messages: u,
              source: r
            })), [2, {
              parentMessage: a[0],
              threadedMessages: u
            }];
        }
      });
    });
  }, e.prototype.getMessageChangelogs = function (e, t, n, i, s) {
    return void 0 === s && (s = po.REQUEST_MESSAGE_CHANGELOGS), i$1(this, void 0, void 0, function () {
      var u, c, l, d, h, f, p, m;
      return o$1(this, function (v) {
        switch (v.label) {
          case 0:
            return u = new dt$1(J($(n$1(n$1({
              channelType: t,
              channelUrl: e,
              timestamp: "number" == typeof n ? n : null,
              token: "string" == typeof n ? n : null
            }, st$1), i)))), [4, this._requestQueue.send(u)];

          case 1:
            return c = v.sent(), l = c.as(ht$1), d = l.updatedMessages, h = l.deletedMessagesInfo, f = l.hasMore, p = l.nextToken, m = h.map(function (e) {
              return e.messageId;
            }), d.length > 0 && this._dispatcher.dispatch(new No({
              messages: d,
              source: s
            })), m.length > 0 && this._dispatcher.dispatch(new To({
              messageIds: m,
              source: s
            })), [2, {
              updatedMessages: d,
              deletedMessageIds: m,
              hasMore: f,
              token: p
            }];
        }
      });
    });
  }, e;
}(),
    $i = function (t) {
  function n(e, n) {
    var r = t.call(this, e) || this;
    r.targetMessageId = 0;
    var i = n.thread_info,
        s = n.parent_message_id,
        a = n.channel_url,
        o = n.channel_type;
    return i && w$1("object", i) && w$1("number", s) && w$1("string", a) && w$1("string", o) && (r.threadInfo = new Me$1(e, i), r.targetMessageId = s, r.channelUrl = a, r.channelType = o), r;
  }

  return t$1(n, t), n;
}(Fi$1),
    es$1 = {
  channelUrl: "",
  channelType: x.BASE,
  messageId: 0,
  includeReactions: !1,
  includeMetaArray: !1,
  includeParentMessageInfo: !1,
  includeThreadInfo: !1
},
    ts$1 = function (n) {
  function r(e) {
    var r = e.channelCustomType,
        i = e.keyword,
        s = e.limit,
        a = e.reverse,
        o = e.exactMatch,
        u = e.channelUrl,
        c = e.order,
        l = e.messageTimestampFrom,
        d = e.messageTimestampTo,
        h = e.advancedQuery,
        f = e.targetFields,
        p = e.nextToken,
        m = n.call(this) || this;
    return m.method = ee.GET, m.path = "".concat(ce, "/messages"), m.params = {
      custom_type: r,
      query: i,
      limit: s,
      reverse: a,
      exact_match: o,
      channel_url: u,
      message_ts_from: l,
      message_ts_to: d,
      sort_field: c,
      advanced_query: h,
      target_fields: f,
      after: p
    }, m;
  }

  return t$1(r, n), r;
}(Ne$2),
    ns$1 = function (t) {
  function n(e, n) {
    var r = t.call(this, e, n) || this;
    return r.messages = n.results.map(function (t) {
      return We$1(e, t);
    }), r.hasNext = n.has_next, r.nextToken = n.end_cursor, r.totalCount = n.total_count, r;
  }

  return t$1(n, t), n;
}(Te$2);

!function (e) {
  e.SCORE = "score", e.TIMESTAMP = "ts";
}(Di || (Di = {}));

var rs = function (t) {
  function n(e, n) {
    var r,
        i,
        s,
        a,
        o,
        u,
        c,
        l,
        d,
        h = this;
    return (h = t.call(this, e, n) || this).keyword = "", h.reverse = !1, h.exactMatch = !1, h.channelUrl = "", h.channelCustomType = "", h.messageTimestampFrom = null, h.messageTimestampTo = null, h.order = Di.SCORE, h.advancedQuery = !1, h.targetFields = null, h._nextToken = "", h.totalCount = -1, h.keyword = n.keyword, h.reverse = null !== (r = n.reverse) && void 0 !== r && r, h.exactMatch = null !== (i = n.exactMatch) && void 0 !== i && i, h.channelUrl = null !== (s = n.channelUrl) && void 0 !== s ? s : "", h.channelCustomType = null !== (a = n.channelCustomType) && void 0 !== a ? a : "", h.messageTimestampFrom = null !== (o = n.messageTimestampFrom) && void 0 !== o ? o : null, h.messageTimestampTo = null !== (u = n.messageTimestampTo) && void 0 !== u ? u : null, h.order = null !== (c = n.order) && void 0 !== c ? c : Di.SCORE, h.advancedQuery = null !== (l = n.advancedQuery) && void 0 !== l && l, h.targetFields = null !== (d = n.targetFields) && void 0 !== d ? d : null, h;
  }

  return t$1(n, t), n.prototype._validate = function () {
    return t.prototype._validate.call(this) && w$1("string", this.keyword) && this.keyword.length > 0 && w$1("boolean", this.reverse) && w$1("boolean", this.exactMatch) && w$1("string", this.channelUrl) && w$1("string", this.channelCustomType) && (w$1("number", this.messageTimestampFrom) || null === this.messageTimestampFrom) && (w$1("number", this.messageTimestampTo) || null === this.messageTimestampTo) && N$1(Di, this.order) && w$1("boolean", this.advancedQuery) && S$2("string", this.targetFields, !0);
  }, n.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i, s, u, c;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, t = new ts$1($(n$1(n$1({}, this), {
              nextToken: this._nextToken ? this._nextToken : null
            }))), [4, e.send(t)]) : [3, 2] : [3, 5];

          case 1:
            return n = l.sent(), r = n.as(ns$1), i = r.messages, s = r.hasNext, u = r.nextToken, c = r.totalCount, this._nextToken = u, this._hasNext = s, this._isLoading = !1, this.totalCount = c, [2, i];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, n;
}(Oo),
    is$1 = {
  channelUrl: "",
  scheduledMessageId: 0
},
    ss$1 = function (t) {
  function n() {
    var e = null !== t && t.apply(this, arguments) || this;
    return e.name = "message", e;
  }

  return t$1(n, t), n.prototype.init = function (e, n) {
    var r = n.sdkState,
        i = n.dispatcher,
        s = n.sessionManager,
        a = n.requestQueue,
        o = n.logger,
        u = n.onlineDetector,
        c = n.cacheContext;
    t.prototype.init.call(this, e, {
      sdkState: r,
      dispatcher: i,
      sessionManager: s,
      requestQueue: a,
      logger: o,
      onlineDetector: u,
      cacheContext: c
    }), this._manager = new Zi(e, {
      sdkState: r,
      dispatcher: i,
      requestQueue: a,
      onlineDetector: u,
      cacheContext: c
    });
  }, n.prototype.buildMessageFromSerializedData = function (e) {
    return this._manager.buildMessageFromSerializedData(e);
  }, n.prototype.buildSenderFromSerializedData = function (e) {
    return this._manager.buildSenderFromSerializedData(e);
  }, n.prototype.getMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        return t = n$1(n$1({}, es$1), e), Qi$1(function (e) {
          return w$1("string", e.channelUrl) && N$1(x, e.channelType) && w$1("number", e.messageId) && w$1("boolean", e.includeReactions, !0) && w$1("boolean", e.includeMetaArray, !0) && w$1("boolean", e.includeParentMessageInfo, !0) && w$1("boolean", e.includeThreadInfo, !0);
        }(t)).throw(v$2.invalidParameters), [2, this._manager.getMessage(t)];
      });
    });
  }, n.prototype.getScheduledMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        return t = n$1(n$1({}, is$1), e), Qi$1(function (e) {
          return w$1("string", e.channelUrl) && "" !== e.channelUrl && w$1("number", e.scheduledMessageId) && e.scheduledMessageId > 0;
        }(t)).throw(v$2.invalidParameters), [2, this._manager.getScheduledMessage(t)];
      });
    });
  }, n;
}(fo);

var s$1 = function (s, i) {
  this.pollId = 0, this.messageId = 0, this.pollId = i.poll.id, this.messageId = i.poll.message_id, this._iid = s, this._payload = i;
};

var f$3 = function (t) {
  function n() {
    var e = null !== t && t.apply(this, arguments) || this;
    return e.name = "poll", e;
  }

  return t$1(n, t), n.prototype.init = function (e, r) {
    var n = r.sdkState,
        o = r.dispatcher,
        i = r.sessionManager,
        s = r.requestQueue,
        l = r.logger,
        u = r.onlineDetector,
        c = r.cacheContext;
    t.prototype.init.call(this, e, {
      sdkState: n,
      dispatcher: o,
      sessionManager: i,
      requestQueue: s,
      logger: l,
      onlineDetector: u,
      cacheContext: c
    }), this._manager = new Zo(e, {
      sdkState: n,
      dispatcher: o,
      sessionManager: i,
      requestQueue: s,
      logger: l,
      onlineDetector: u,
      cacheContext: c
    });
  }, n.prototype.create = function (t) {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (a) {
        return e = n$1(n$1({}, Ho), t), Qi$1(Vo(e)).throw(v$2.invalidParameters), [2, this._manager.create(e)];
      });
    });
  }, n.prototype.get = function (t) {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (a) {
        return e = n$1(n$1({}, jo), t), Qi$1(Ko(e)).throw(v$2.invalidParameters), [2, this._manager.get(e)];
      });
    });
  }, n.prototype.getOption = function (t) {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (a) {
        return e = n$1(n$1({}, Go), t), Qi$1(qo(e)).throw(v$2.invalidParameters), [2, this._manager.getOption(e)];
      });
    });
  }, n.prototype.buildPollFromSerializedData = function (t) {
    return this._manager.buildPollFromSerializedData(t);
  }, n;
}(fo);

var g$1, f$2, E;
!function (e) {
  e.LATEST_LAST_MESSAGE = "latest_last_message", e.CHRONOLOGICAL = "chronological", e.CHANNEL_NAME_ALPHABETICAL = "channel_name_alphabetical", e.METADATA_VALUE_ALPHABETICAL = "metadata_value_alphabetical";
}(g$1 || (g$1 = {})), function (e) {
  e.CHRONOLOGICAL = "chronological", e.CHANNEL_NAME_ALPHABETICAL = "channel_name_alphabetical", e.METADATA_VALUE_ALPHABETICAL = "metadata_value_alphabetical";
}(f$2 || (f$2 = {})), function (e) {
  e.CREATED_AT = "created_at", e.SCHEDULED_AT = "scheduled_at";
}(E || (E = {}));

var p$1,
    C = function (e) {
  switch (e) {
    case g$1.LATEST_LAST_MESSAGE:
      return ["-lastMessageUpdatedAt", "-createdAt", "syncIndex"];

    case g$1.CHRONOLOGICAL:
      return ["-createdAt", "syncIndex"];

    case g$1.CHANNEL_NAME_ALPHABETICAL:
      return ["name"];

    default:
      return ["-lastMessageUpdatedAt", "-createdAt", "syncIndex"];
  }
},
    L$1 = function (t) {
  function s(e) {
    var s = e.message,
        n = t.call(this) || this;
    return n.message = s, n;
  }

  return t$1(s, t), s;
}(X),
    R$1 = {},
    I$1 = function () {
  function e(e, t) {
    var s = t.localCacheEnabled,
        n = t.dispatcher,
        r = t.sdkState,
        a = t.logger,
        u = this;
    this._iid = e, R$1[e] = this, this._localCacheEnabled = s, this._isProcessingAutoResend = !1, this._autoResendQueue = [], this._dispatcher = n, this._logger = a, this._sdkState = r, this._localCacheEnabled && n.on(function (e) {
      if (e instanceof ai$1) switch (e.stateType) {
        case ti$1.CONNECTED:
          u._isProcessingAutoResend || u.processAutoResendRegisteredPendingMessages().then(function () {
            return u._processNextAutoResend();
          });
          break;

        case ti$1.INTERNAL_DISCONNECTED:
        case ti$1.EXTERNAL_DISCONNECTED:
          u._isProcessingAutoResend = !1;
      }
    });
  }

  return e.of = function (e) {
    return R$1[e];
  }, e.prototype.processNonAutoResendRegisteredPendingMessages = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, s, a, i, o;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._fetchAllCachedPendingMessages()];

          case 1:
            e = n.sent();

            try {
              for (t = s$2(e), s = t.next(); !s.done; s = t.next()) 0 === (a = s.value).errorCode && (this._logger.debug("cached pending message is not auto-resend registered. changing its sending status to failed: ", a.reqId), a.sendingStatus = q.FAILED, a.errorCode = u$1.ACK_TIMEOUT, this._dispatcher.dispatch(new No({
                messages: [a],
                source: po.LOCAL_MESSAGE_FAILED
              })));
            } catch (e) {
              i = {
                error: e
              };
            } finally {
              try {
                s && !s.done && (o = t.return) && o.call(t);
              } finally {
                if (i) throw i.error;
              }
            }

            return [2];
        }
      });
    });
  }, e.prototype.processAutoResendRegisteredPendingMessages = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, s, i, o, c, l, _;

      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._fetchAllCachedPendingMessages()];

          case 1:
            e = n.sent();

            try {
              for (t = s$2(e), s = t.next(); !s.done; s = t.next()) (i = s.value).errorCode && C$1(i.errorCode) && (o = new Date().getTime(), c = i.createdAt + 2592e5, o <= c ? this._autoResendQueue.map(function (e) {
                return e.reqId;
              }).indexOf(i.reqId) < 0 && this._autoResendQueue.push(i) : (this._logger.debug("auto-resend registered pending messaged expired. expiration date: ", new Date(c).toLocaleString()), i.sendingStatus = q.FAILED, this._dispatcher.dispatch(new No({
                messages: [i],
                source: po.LOCAL_MESSAGE_FAILED
              }))));
            } catch (e) {
              l = {
                error: e
              };
            } finally {
              try {
                s && !s.done && (_ = t.return) && _.call(t);
              } finally {
                if (l) throw l.error;
              }
            }

            return [2];
        }
      });
    });
  }, e.prototype.completeCurrentAndProcessNextAutoResend = function (e) {
    if (this._localCacheEnabled && (e.sendingStatus === q.SUCCEEDED || e.sendingStatus === q.FAILED && !C$1(e.errorCode))) {
      var t = this.indexOf(e);
      t >= 0 && this._autoResendQueue.splice(t, 1), 0 === t && this._processNextAutoResend();
    }
  }, e.prototype._fetchAllCachedPendingMessages = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return (e = Vi.of(this._iid)) ? [4, e.fetch({
              sendingStatus: q.PENDING,
              backward: !0
            })] : [3, 2];

          case 1:
            return t = s.sent(), [3, 3];

          case 2:
            t = [], s.label = 3;

          case 3:
            return [2, t];
        }
      });
    });
  }, e.prototype.indexOf = function (e) {
    return this._autoResendQueue.length > 0 ? this._autoResendQueue.map(function (e) {
      return e.reqId;
    }).indexOf(e.reqId) : -1;
  }, e.prototype._isNotInQueue = function (e) {
    return -1 === this._autoResendQueue.map(function (e) {
      return e.reqId;
    }).indexOf(e.reqId);
  }, e.prototype._processNextAutoResend = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        if (this._localCacheEnabled && "foreground" === this._sdkState.appState) try {
          this._autoResendQueue.length > 0 ? (this._isProcessingAutoResend || (this._logger.debug("auto-resend queue started."), this._isProcessingAutoResend = !0), e = this._autoResendQueue[0], this._dispatcher.dispatch(new L$1({
            message: e
          })), this._logger.debug("processing auto-resend for message request id: ", e.reqId)) : (this._logger.debug("auto-resend queue finished."), this._isProcessingAutoResend = !1);
        } catch (e) {
          this._logger.warn("process auto-resend error: ", e), this._isProcessingAutoResend = !1;
        }
        return [2];
      });
    });
  }, e;
}();

!function (e) {
  e[e.USER_BLOCK = 20001] = "USER_BLOCK", e[e.USER_UNBLOCK = 2e4] = "USER_UNBLOCK", e[e.FRIEND_DISCOVERED = 20900] = "FRIEND_DISCOVERED";
}(p$1 || (p$1 = {}));

var S$1 = function () {
  function e(e) {
    this.category = e.cat, this.data = e.data;
  }

  return e.getDataAsUserBlockEvent = function (e, t) {
    var s = t.data,
        n = s.blocker,
        r = s.blockee;
    return {
      blocker: new Xi$1(e, n),
      blockee: new Xi$1(e, r)
    };
  }, e.getDataAsFriendDiscoveredEvent = function (e, t) {
    var s = t.data.friend_discoveries;
    return {
      friendDiscoveries: Array.isArray(s) ? s.map(function (t) {
        return new Xi$1(e, t);
      }) : []
    };
  }, e;
}(),
    N = function (t) {
  function s(e, s) {
    var n = s.userId,
        r = t.call(this) || this;
    return r._iid = e, r.userId = n, r;
  }

  return t$1(s, t), s;
}(X),
    v$1 = function (t) {
  function s() {
    return t.call(this) || this;
  }

  return t$1(s, t), s;
}(X),
    D$1 = function (t) {
  function s(e, s, n) {
    var r = t.call(this, e, "USEV", n) || this;
    return r.event = new S$1(n), r;
  }

  return t$1(s, t), s;
}(Pe$3);

var e$2 = function (e) {
  return ["-lastMessageUpdatedAt", "-createdAt", "syncIndex"];
};

var it = function (e) {
  this.key = e.key, this.url = e.url;
},
    ot = function (e) {
  this.id = e.id, this.name = e.name, this.url = e.url, this.emojis = e.emojis ? e.emojis.map(function (e) {
    return new it(e);
  }) : [];
},
    st = function (e) {
  this.emojiHash = e.emoji_hash || "", this.emojiCategories = e.emoji_categories ? e.emoji_categories.map(function (e) {
    return new ot(e);
  }) : [];
},
    at = {
  profileImage: void 0,
  profileUrl: void 0,
  nickname: void 0
},
    ut = function (e) {
  return {
    v2: e.commitSchema([{
      collectionName: ur,
      keyName: cr,
      index: [C(g$1.LATEST_LAST_MESSAGE), C(g$1.CHRONOLOGICAL), C(g$1.CHANNEL_NAME_ALPHABETICAL)]
    }, {
      collectionName: dr,
      keyName: hr,
      index: [qi(Ri.CHANNEL_LATEST), qi(Ri.NEWEST_CHILD_MESSAGE)]
    }, {
      collectionName: ji,
      keyName: Qi,
      index: [qi(Ri.CHANNEL_LATEST), qi(Ri.NEWEST_CHILD_MESSAGE)]
    }, {
      collectionName: fr,
      keyName: pr
    }]),
    v3: e.commitSchema([{
      collectionName: vr,
      keyName: yr,
      index: [e$2()]
    }])
  };
},
    ct = function (e, t) {
  return function (n, r) {
    switch (n) {
      case 1:
        e.clear().then(function () {
          t.clear().then(function () {
            ut(e).v2.then(function () {
              return r();
            }).catch(function (e) {
              return r(e);
            });
          }).catch(function (e) {
            return r(e);
          });
        }).catch(function (e) {
          return r(e);
        });
        break;

      case 2:
        ut(e).v3.then(function () {
          return r();
        }).catch(function (e) {
          return r(e);
        });
        break;

      default:
        r();
    }
  };
},
    dt = function () {
  return "undefined" != typeof document ? document.visibilityState : "visible";
},
    lt = function (e) {
  function t(t) {
    var n = t.getVisibilityState,
        r = void 0 === n ? dt : n,
        i = t.initialState,
        o = void 0 === i ? "visible" : i,
        s = t.isEnabled,
        a = void 0 === s || s,
        u = t.pauseCheckDelay,
        c = void 0 === u ? 3e4 : u,
        d = e.call(this) || this;
    return d._pauseCheckDelay = 3e4, d._currentState = "visible", d._getVisibilityState = r, d._pauseCheckDelay = c, d._currentState = o, d._isEnabled = a, d._boundToggleState = d._toggleState.bind(d), d;
  }

  return t$1(t, e), Object.defineProperty(t.prototype, "currentState", {
    get: function () {
      return this._currentState;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "isAvailable", {
    get: function () {
      return "undefined" != typeof window && !!window.addEventListener && !!window.removeEventListener;
    },
    enumerable: !1,
    configurable: !0
  }), t.prototype._toggleState = function () {
    var e = this,
        t = this._getVisibilityState();

    "hidden" !== t ? "hidden" === this._currentState && (this._pauseDelayTimer && (clearTimeout(this._pauseDelayTimer), this._pauseDelayTimer = void 0), this.dispatch("resume")) : "hidden" !== this._currentState && (this._pauseDelayTimer = setTimeout(function () {
      e._pauseDelayTimer = void 0, e.dispatch("pause");
    }, this._pauseCheckDelay)), this._currentState = t;
  }, t.prototype.start = function () {
    this._isEnabled && this.isAvailable && (this._boundToggleState = this._toggleState.bind(this), window.addEventListener("visibilitychange", this._boundToggleState, {
      capture: !0
    }));
  }, t.prototype.stop = function () {
    this._isEnabled && this.isAvailable && this._boundToggleState && window.removeEventListener("visibilitychange", this._boundToggleState, {
      capture: !0
    });
  }, t;
}(Q),
    ht = function () {
  function e(e) {
    var t = e.logger,
        n = e.connectionDelegate,
        r = void 0 === n ? null : n,
        i = this;
    this._onlineWorker = function () {
      var e;
      return null === (e = i.connectionDelegate) || void 0 === e ? void 0 : e.reconnect();
    }, this._offlineWorker = function () {
      var e;
      return null === (e = i.connectionDelegate) || void 0 === e ? void 0 : e.disconnect();
    }, this.unsubscribes = [], this._onlineListener = function (e) {
      if (i.isAvailableOnWeb) return window.addEventListener("online", e), function () {
        return window.removeEventListener("online", e, !1);
      };
    }, this._offlineListener = function (e) {
      if (i.isAvailableOnWeb) return window.addEventListener("offline", e), function () {
        return window.removeEventListener("offline", e, !1);
      };
    }, this.logger = t, r && (this.connectionDelegate = r);
  }

  return Object.defineProperty(e.prototype, "isAvailableOnWeb", {
    get: function () {
      return "undefined" != typeof window && !!window.addEventListener && "ononline" in window && "onoffline" in window && "undefined" != typeof navigator && void 0 !== navigator.onLine;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.setOnlineListener = function (e) {
    Boolean(e) && "function" == typeof e && (this._onlineListener = e);
  }, e.prototype.setOfflineListener = function (e) {
    Boolean(e) && "function" == typeof e && (this._offlineListener = e);
  }, e.prototype.start = function () {
    this.unsubscribes = [this._onlineListener(this._onlineWorker), this._offlineListener(this._offlineWorker)];
  }, e.prototype.stop = function () {
    var e = this;
    this.unsubscribes.forEach(function (t) {
      try {
        null == t || t();
      } catch (t) {
        e.logger.warn(t.message);
      }
    }), this.unsubscribes = [];
  }, e.prototype.isOnline = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return this.isAvailableOnWeb ? [2, navigator.onLine] : [2, new Promise(function (e) {
          fetch("https://www.google.com", {
            method: ee.GET,
            mode: "no-cors"
          }).then(function () {
            return e(!0);
          }).catch(function () {
            return e(!1);
          });
        })];
      });
    });
  }, e;
}(),
    ft = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.nickname,
        i = t.profileUrl,
        o = t.profileImage,
        s = t.preferredLanguages,
        a = e.call(this) || this;
    return a.method = ee.PUT, a.path = "".concat(ne, "/").concat(encodeURIComponent(n)), a.params = J($({
      nickname: r,
      profile_url: i,
      profile_file: o,
      preferred_languages: s
    })), a;
  }

  return t$1(t, e), t;
}(Ne$2),
    pt = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.user = new Xi$1(t, n$1({}, n)), r;
  }

  return t$1(t, e), t;
}(Te$2),
    vt = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.token,
        i = e.call(this) || this;
    return i.method = ee.POST, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push/apns"), i.params = {
      apns_device_token: r,
      always_push: !0
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.token = n.token, r.type = n.type ? f$4[n.type.toLowerCase()] : f$4.UNKNOWN, r.user = new Xi$1(t, n.user), r;
  }

  t$1(t, e);
}(Te$2);

var gt = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.token,
        i = e.call(this) || this;
    return i.method = ee.POST, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push/gcm"), i.params = {
      gcm_reg_token: r,
      always_push: !0
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.token = n.token, r.type = n.type ? f$4[n.type.toLowerCase()] : f$4.UNKNOWN, r.user = new Xi$1(t, n.user), r;
  }

  t$1(t, e);
}(Te$2);

var _t = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.token,
        i = e.call(this) || this;
    return i.method = ee.DELETE, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push/apns/").concat(encodeURIComponent(r)), i;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.token = n.token, r.user = new Xi$1(t, n.user), r.lastDeletedAt = n.device_token_last_deleted_at, r;
  }

  t$1(t, e);
}(Te$2);

var mt = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.token,
        i = e.call(this) || this;
    return i.method = ee.DELETE, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push/gcm/").concat(encodeURIComponent(r)), i;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.token = n.token, r.user = new Xi$1(t, n.user), r.lastDeletedAt = n.device_token_last_deleted_at, r;
  }

  t$1(t, e);
}(Te$2);

var bt = function (e) {
  function t(t) {
    var n = t.userId,
        r = e.call(this) || this;
    return r.method = ee.DELETE, r.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push/apns"), r;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.type = n.type ? f$4[n.type.toLowerCase()] : f$4.UNKNOWN, r.user = new Xi$1(t, n.user), r.lastDeletedAt = n.device_token_last_deleted_at, r;
  }

  t$1(t, e);
}(Te$2);

var yt = function (e) {
  function t(t) {
    var n = t.userId,
        r = e.call(this) || this;
    return r.method = ee.DELETE, r.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push/gcm"), r;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.type = n.type ? f$4[n.type.toLowerCase()] : f$4.UNKNOWN, r.user = new Xi$1(t, n.user), r.lastDeletedAt = n.device_token_last_deleted_at, r;
  }

  t$1(t, e);
}(Te$2);

var wt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.type,
        i = t.token,
        o = t.ts,
        s = e.call(this) || this;
    return s.method = ee.GET, s.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push/").concat(encodeURIComponent(r), "/device_tokens"), s.params = {
      created_ts: o,
      token: i
    }, s;
  }

  return t$1(t, e), t;
}(Ne$2),
    It$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.pushTokens = {
      type: n.type ? f$4[n.type.toLowerCase()] : f$4.UNKNOWN,
      deviceTokens: n.device_tokens,
      hasMore: n.has_more,
      token: n.token
    }, r;
  }

  return t$1(t, e), t;
}(Te$2),
    kt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = e.call(this) || this;
    return r.method = ee.GET, r.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/channel_invitation_preference"), r;
  }

  return t$1(t, e), t;
}(Ne$2),
    Ct = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.autoAccept = n.auto_accept, r;
  }

  return t$1(t, e), t;
}(Te$2),
    St$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.willAutoAccept,
        i = e.call(this) || this;
    return i.method = ee.PUT, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/channel_invitation_preference"), i.params = {
      auto_accept: r
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2),
    Tt$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.autoAccept = n.auto_accept, r;
  }

  return t$1(t, e), t;
}(Te$2),
    Et = function (e) {
  function t(t) {
    var n = t.userId,
        r = e.call(this) || this;
    return r.method = ee.GET, r.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push_preference"), r;
  }

  return t$1(t, e), t;
}(Ne$2),
    Pt$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.preference = {
      doNotDisturbOn: n.do_not_disturb,
      startHour: n.start_hour,
      startMin: n.start_min,
      endHour: n.end_hour,
      endMin: n.end_min,
      timezone: n.timezone
    }, r;
  }

  return t$1(t, e), t;
}(Te$2),
    Ut$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.doNotDisturbOn,
        i = t.startHour,
        o = t.startMin,
        s = t.endHour,
        a = t.endMin,
        u = t.timezone,
        l = e.call(this) || this;
    return l.method = ee.PUT, l.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push_preference"), l.params = {
      do_not_disturb: r,
      start_hour: i,
      start_min: o,
      end_hour: s,
      end_min: a,
      timezone: u
    }, l;
  }

  return t$1(t, e), t;
}(Ne$2),
    Dt$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.preference = {
      doNotDisturbOn: n.do_not_disturb,
      startHour: n.start_hour,
      startMin: n.start_min,
      endHour: n.end_hour,
      endMin: n.end_min,
      timezone: n.timezone
    }, r;
  }

  return t$1(t, e), t;
}(Te$2),
    Ot$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = e.call(this) || this;
    return r.method = ee.GET, r.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push_preference"), r;
  }

  return t$1(t, e), t;
}(Ne$2),
    At$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.snoozePeriod = {
      isSnoozeOn: n.snooze_enabled
    }, "number" == typeof n.snooze_start_ts && (r.snoozePeriod.startTs = n.snooze_start_ts), "number" == typeof n.snooze_end_ts && (r.snoozePeriod.endTs = n.snooze_end_ts), r;
  }

  return t$1(t, e), t;
}(Te$2),
    Lt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.snoozeOn,
        i = t.startTs,
        o = t.endTs,
        s = e.call(this) || this;
    return s.method = ee.PUT, s.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push_preference"), s.params = {
      snooze_enabled: r,
      snooze_start_ts: i,
      snooze_end_ts: o
    }, s;
  }

  return t$1(t, e), t;
}(Ne$2),
    Nt$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.snoozePeriod = {
      isSnoozeOn: n.snooze_enabled
    }, "number" == typeof n.snooze_start_ts && (r.snoozePeriod.startTs = n.snooze_start_ts), "number" == typeof n.snooze_end_ts && (r.snoozePeriod.endTs = n.snooze_end_ts), r;
  }

  return t$1(t, e), t;
}(Te$2),
    Mt = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.blockedUserId,
        i = e.call(this) || this;
    return i.method = ee.POST, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/block"), i.params = {
      target_id: r
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.user = new Xi$1(t, n), r;
  }

  t$1(t, e);
}(Te$2);

var Rt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.unblockedUserId,
        i = e.call(this) || this;
    return i.method = ee.DELETE, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/block/").concat(encodeURIComponent(r)), i;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t() {
    return null !== e && e.apply(this, arguments) || this;
  }

  t$1(t, e);
}(Te$2);

var zt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = e.call(this) || this;
    return r.method = ee.GET, r.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push_preference"), r;
  }

  return t$1(t, e), t;
}(Ne$2),
    Qt$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.pushTriggerOption = n.push_trigger_option, r;
  }

  return t$1(t, e), t;
}(Te$2),
    jt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.pushTriggerOption,
        i = e.call(this) || this;
    return i.method = ee.PUT, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push_preference"), i.params = {
      push_trigger_option: r
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2),
    qt$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.pushTriggerOption = n.push_trigger_option, r;
  }

  return t$1(t, e), t;
}(Te$2),
    Ft$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = e.call(this) || this;
    return r.method = ee.GET, r.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push/template"), r;
  }

  return t$1(t, e), t;
}(Ne$2),
    Ht$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.name = n.name, r;
  }

  return t$1(t, e), t;
}(Te$2),
    xt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.templateName,
        i = e.call(this) || this;
    return i.method = ee.PUT, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push/template"), i.params = {
      name: r
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2),
    Gt$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.name = n.name, r;
  }

  return t$1(t, e), t;
}(Te$2),
    Wt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.token,
        i = e.call(this) || this;
    return i.method = ee.GET, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/friends/changelogs"), i.params = {
      token: r
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2),
    Bt$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.changelogs = {
      addedUsers: n.added.map(function (e) {
        return new Xi$1(t, e);
      }),
      updatedUsers: n.updated.map(function (e) {
        return new Xi$1(t, e);
      }),
      deletedUserIds: n.deleted,
      hasMore: n.has_more,
      token: n.next
    }, r;
  }

  return t$1(t, e), t;
}(Te$2),
    Kt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.discoveries,
        i = e.call(this) || this;
    return i.method = ee.PUT, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/friend_discoveries"), i.params = {
      friend_discoveries: r.map(function (e) {
        return {
          friend_discovery_key: e.friendDiscoveryKey,
          friend_name: e.friendName
        };
      })
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2),
    Vt$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.friendDiscoveryRequestId = n.friend_discovery_request_id, r;
  }

  return t$1(t, e), t;
}(Te$2),
    Jt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.discoveryKeys,
        i = e.call(this) || this;
    return i.method = ee.DELETE, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/friend_discoveries"), i.params = {
      friend_discovery_keys: r
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t() {
    return null !== e && e.apply(this, arguments) || this;
  }

  t$1(t, e);
}(Te$2);

var Xt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.userIds,
        i = e.call(this) || this;
    return i.method = ee.POST, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/friends"), i.params = {
      user_ids: r
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2),
    Yt = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.users = n.users.map(function (e) {
      return new Xi$1(t, e);
    }), r;
  }

  return t$1(t, e), t;
}(Te$2),
    Zt$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.userIds,
        i = e.call(this) || this;
    return i.method = ee.DELETE, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/friends"), i.params = {
      user_ids: r
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t() {
    return null !== e && e.apply(this, arguments) || this;
  }

  t$1(t, e);
}(Te$2);

var $t$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = e.call(this) || this;
    return r.method = ee.GET, r.path = "".concat(ne, "/").concat(n, "/allow_friend_discovery"), r.params = {}, r;
  }

  return t$1(t, e), t;
}(Ne$2),
    en$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.allowFriendDiscovery = n.allow_friend_discovery, r;
  }

  return t$1(t, e), t;
}(Te$2),
    tn$1 = function (e) {
  function t(t) {
    var n = t.userId,
        r = t.allowFriendDiscovery,
        i = e.call(this) || this;
    return i.method = ee.PUT, i.path = "".concat(ne, "/").concat(n, "/allow_friend_discovery"), i.params = {
      allow_friend_discovery: r
    }, i;
  }

  return t$1(t, e), t;
}(Ne$2);

!function (e) {
  function t() {
    return null !== e && e.apply(this, arguments) || this;
  }

  t$1(t, e);
}(Te$2);

var nn$1,
    rn$1 = function (e) {
  function t() {
    var t = e.call(this) || this;
    return t.method = ee.GET, t.path = he$1, t;
  }

  return t$1(t, e), t;
}(Ne$2),
    on$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.emojiContainer = new st(n), r;
  }

  return t$1(t, e), t;
}(Te$2),
    sn$1 = function (e) {
  function t(t) {
    var n = t.categoryId,
        r = e.call(this) || this;
    return r.method = ee.GET, r.path = "".concat(he$1, "/").concat(n), r;
  }

  return t$1(t, e), t;
}(Ne$2),
    an$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.emojiCategory = new ot(n), r;
  }

  return t$1(t, e), t;
}(Te$2),
    un$1 = function (e) {
  function t(t) {
    var n = t.key,
        r = e.call(this) || this;
    return r.method = ee.GET, r.path = "".concat(le$1, "/").concat(n), r;
  }

  return t$1(t, e), t;
}(Ne$2),
    cn$1 = function (e) {
  function t(t, n) {
    var r = e.call(this, t, n) || this;
    return r.emoji = new it(n), r;
  }

  return t$1(t, e), t;
}(Te$2),
    dn$1 = function (e) {
  function t() {
    var t = e.call(this) || this;
    return t.method = ee.GET, t.path = "".concat(fe$1), t;
  }

  return t$1(t, e), t;
}(Ne$2),
    ln$1 = function (e) {
  function t(t, n) {
    var r,
        i = this,
        o = null != n ? n : {};
    return (i = e.call(this, t, n) || this).uikitConfiguration = {
      string: JSON.stringify(o),
      json: o
    }, i.updatedAt = null !== (r = null == n ? void 0 : n.updated_at) && void 0 !== r ? r : 0, i;
  }

  return t$1(t, e), t;
}(Te$2),
    hn$1 = function () {
  function t(e, t, n) {
    var r = this;
    this._storeInitialized = !1, this._iid = e, this.options = t;
    var i = _o.of(e),
        s = i.sdkState,
        u = i.cacheContext,
        c = i.dispatcher,
        d = i.sessionManager,
        l = i.requestQueue,
        h = i.logger,
        f = i.userEventHandlers,
        p = i.appStateToggleEnabled;
    this._onlineDetector = new ht({
      logger: h,
      connectionDelegate: {
        reconnect: function () {
          var t = _o.of(e),
              n = t.sdkState,
              r = t.connectionManager,
              i = t.sessionManager;
          i.auth.hasSession ? "foreground" === n.appState && r.resetAndReconnect() : r.connect(i.auth.authToken);
        },
        disconnect: function () {
          _o.of(e).connectionManager.disconnect();
        }
      }
    });
    var v = new I$1(e, {
      localCacheEnabled: u.localCacheEnabled,
      dispatcher: c,
      sdkState: s,
      logger: h
    });
    n.forEach(function (t) {
      t.init(e, {
        sdkState: s,
        cacheContext: u,
        dispatcher: c,
        sessionManager: d,
        requestQueue: l,
        logger: h,
        onlineDetector: r._onlineDetector
      }), r[t.name] = t;
    }), this._appStateChangeDetector = new lt({
      isEnabled: p
    }), this._appStateChangeDetector.on("resume", function () {
      h.debug("the page resumes from freeze"), r.setForegroundState();
    }).on("pause", function () {
      h.debug("the page freezes"), r.setBackgroundState();
    }), c.on(function (t) {
      var n;

      if (t instanceof ai$1) {
        if (t.stateType === ti$1.CONNECTED) v.processNonAutoResendRegisteredPendingMessages();
      } else if (t instanceof Pe$3) {
        if ("USEV" === t.code) {
          var i = t.as(D$1).event;

          if (i.category === p$1.FRIEND_DISCOVERED) {
            var c = S$1.getDataAsFriendDiscoveredEvent(e, i).friendDiscoveries;
            bi$1(function () {
              return i$1(r, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return [2, f.forEach(function (e) {
                    e.onFriendsDiscovered && e.onFriendsDiscovered(c);
                  })];
                });
              });
            });
          }
        }
      } else if (t instanceof ii$1) {
        var d = _o.of(r._iid).subscribedUnreadMessageCount,
            l = !1,
            p = t.ts;

        if ("number" == typeof p && p > d.ts) {
          if (d.all !== t.all && (l = !0), d.all = t.all >= 0 ? t.all : 0, t.customTypes) for (var g in t.customTypes) d.customTypes[g] !== t.customTypes[g] && (l = !0), d.customTypes[g] = t.customTypes[g];
          l = l && d.ts > 0, d.ts = p;
        }

        l && bi$1(function () {
          return i$1(r, void 0, void 0, function () {
            return o$1(this, function (e) {
              return [2, f.forEach(function (e) {
                e.onTotalUnreadMessageCountChanged && e.onTotalUnreadMessageCountChanged({
                  groupChannelCount: d.all,
                  feedChannelCount: d.feed,
                  customTypeUnreadCount: d.customTypes
                }), e.onTotalUnreadMessageCountUpdated && e.onTotalUnreadMessageCountUpdated(d.all, d.customTypes);
              })];
            });
          });
        });
      } else t instanceof Ji$1 ? (u.preference.set(r._getUserProfileCacheKey(s.userId), $i$1.payloadify(t.userProfile)), (null === (n = t.userProfile.appInfo.notificationInfo) || void 0 === n ? void 0 : n.isEnabled) && u.preference.set(xi$1(r.appId), {
        value: !0
      })) : t instanceof Ae$1 && t.error && (t.error.isSessionRevokedError || t.error.isUserAuthDeactivedError || t.error.isUserAuthDeletedOrNotFoundError) && (h.debug("session revoked."), r.disconnect());
    });
  }

  return t.init = function (e) {
    var n = e.appId,
        r = e.appVersion,
        i = e.modules,
        o = void 0 === i ? [] : i,
        s = e.options,
        a = void 0 === s ? new I$2() : s,
        u = e.debugMode,
        c = void 0 !== u && u,
        d = e.customApiHost,
        l = e.customWebSocketHost,
        h = e.newInstance,
        f = void 0 !== h && h,
        p = e.logLevel,
        v = e.localCacheEnabled,
        g = void 0 !== v && v,
        _ = e.localCacheConfig,
        m = void 0 === _ ? new K() : _,
        b = e.localCacheEncryption,
        y = e.useAsyncStorageStore,
        w = void 0 === y ? null : y,
        I = e.appStateToggleEnabled,
        k = void 0 === I || I;

    if (!nn$1 || f) {
      var C = "su-".concat(Z()),
          S = null != b ? b : {
        encrypt: function (e) {
          return e;
        },
        decrypt: function (e) {
          return e;
        }
      },
          T = new Ui({
        encryption: S
      });
      c || (T = De$3() ? w ? new Pi({
        AsyncStorage: w,
        encryption: S
      }) : new Ui({
        encryption: S
      }) : new Ci({
        encryption: S
      })), new _o(C, {
        appId: n,
        appVersion: r,
        options: a,
        apiHost: null != d ? d : "https://api-".concat(n, ".sendbird.com"),
        websocketHost: null != l ? l : "wss://ws-".concat(n, ".sendbird.com"),
        store: T,
        encryption: S,
        logLevel: p,
        localCacheEnabled: g,
        localCacheConfig: m,
        debugMode: c,
        appStateToggleEnabled: k
      });
      var E = [new ss$1(), new f$3()],
          P = new t(C, a, c$1(c$1([], a$1(o), !1), a$1(E), !1));
      return nn$1 || (nn$1 = P), P;
    }

    return nn$1;
  }, Object.defineProperty(t, "instance", {
    get: function () {
      return nn$1;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t, "version", {
    get: function () {
      return l$1;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "appId", {
    get: function () {
      return _o.of(this._iid).sdkState.appId;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "appInfo", {
    get: function () {
      var e = _o.of(this._iid).appInfo;
      return null != e ? e : null;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "appVersion", {
    get: function () {
      var e;
      return null !== (e = _o.of(this._iid).sdkState.appVersion) && void 0 !== e ? e : "";
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "debugMode", {
    get: function () {
      return !!_o.of(this._iid).debugMode;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "logLevel", {
    get: function () {
      return _o.of(this._iid).logger.level;
    },
    set: function (e) {
      _o.of(this._iid).logger.level = e;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "isCacheEnabled", {
    get: function () {
      return _o.of(this._iid).cacheContext.localCacheEnabled;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "localCacheConfig", {
    get: function () {
      var e = _o.of(this._iid).cacheContext;
      return e.localCacheEnabled ? e.localCacheConfig : null;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "ekey", {
    get: function () {
      return _o.of(this._iid).sessionManager.ekey;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "currentUser", {
    get: function () {
      var e;
      return null !== (e = _o.of(this._iid).sessionManager.currentUser) && void 0 !== e ? e : null;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "connectionState", {
    get: function () {
      var e = _o.of(this._iid).connectionManager;
      return e.isConnected ? $r$1.OPEN : e.isConnecting ? $r$1.CONNECTING : $r$1.CLOSED;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "lastConnectedAt", {
    get: function () {
      var e = _o.of(this._iid),
          t = e.connectedAt;
      return e.connectionManager.isConnected ? t : 0;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "fcmPushToken", {
    get: function () {
      var e;
      return null !== (e = this._fcmPushToken) && void 0 !== e ? e : null;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "apnsPushToken", {
    get: function () {
      var e;
      return null !== (e = this._apnsPushToken) && void 0 !== e ? e : null;
    },
    enumerable: !1,
    configurable: !0
  }), t.prototype._getNestDBVersion = function () {
    return 3;
  }, t.prototype._getCurrentPreferenceVersion = function () {
    return 1;
  }, t.prototype._getPreferenceCacheKey = function (e) {
    return "sendbird@".concat(this.appId, "/").concat(e, ".pref");
  }, t.prototype._getUserProfileCacheKey = function (e) {
    return "sendbird@".concat(this.appId, "/").concat(e, ".profile");
  }, t.prototype.getMemoryStoreForDebugging = function () {
    var e = _o.of(this._iid),
        t = e.debugMode,
        n = e.cacheContext;
    if (t) return n.store instanceof Ui ? n.store : null;
    throw v$2.debugModeRequired;
  }, t.prototype.addExtension = function (e, t) {
    var n = _o.of(this._iid).sdkState;
    ["sb_uikit", "sb_syncmanager", "device-os-platform"].indexOf(e) > -1 && n.extensions && (n.extensions[e] = t);
  }, t.prototype.addSendbirdExtensions = function (e, t, n) {
    var r,
        i,
        o = _o.of(this._iid),
        s = o.logger,
        a = o.sdkState,
        u = new RegExp(xe$2);
    if (0 === e.length) return s.debug("sb.addSendbirdExtensions() has failed because the given sendbirdExtensions is empty."), !1;
    if (e.find(function (e) {
      return !u.test(e.version);
    })) return s.debug("sb.addSendbirdExtensions() has failed because the given version did not satisfy the SemVer specification."), !1;
    if (n) try {
      for (var c = s$2(Object.entries(n)), d = c.next(); !d.done; d = c.next()) {
        var l = a$1(d.value, 2),
            h = l[0],
            f = l[1];
        if (/&|=/.test(h) || /&|=/.test(f)) return s.debug("sb.addSendbirdExtensions() has failed because the given customData includes at least one invalid character: = or &."), !1;
      }
    } catch (e) {
      r = {
        error: e
      };
    } finally {
      try {
        d && !d.done && (i = c.return) && i.call(c);
      } finally {
        if (r) throw r.error;
      }
    }
    return a.sendbirdRuntimeEnvironment = {
      sendbirdExtensions: e,
      deviceOS: t,
      customData: n
    }, !0;
  }, t.prototype.setOnlineListener = function (e) {
    this._onlineDetector.setOnlineListener(e);
  }, t.prototype.setOfflineListener = function (e) {
    this._onlineDetector.setOfflineListener(e);
  }, t.prototype._safeInitializeStore = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            t = _o.of(this._iid).cacheContext, n.label = 1;

          case 1:
            return n.trys.push([1, 3,, 5]), [4, t.store.init(e)];

          case 2:
            return n.sent(), this._storeInitialized = !0, [3, 5];

          case 3:
            return n.sent(), t.replaceStore(new Ui()), [4, this._safeInitializeStore(e)];

          case 4:
            return n.sent(), [3, 5];

          case 5:
            return [2];
        }
      });
    });
  }, t.prototype.initializeCache = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, o, s, u, c, d;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return t = _o.of(this._iid), n = t.sdkState, r = t.cacheContext, i = t.connectionManager, o = t.dispatcher, s = t.logger, n.userId && n.userId === e ? [3, 10] : [4, i.logout()];

          case 1:
            if (a.sent(), u = "sendbird@".concat(n.appId, "/").concat(e, ".db"), !r.localCacheEnabled) return [3, 8];
            a.label = 2;

          case 2:
            return a.trys.push([2, 5,, 7]), r.nestdb && r.nestdb.state !== ki.CLOSED && r.nestdb.name === u ? [3, 4] : ((c = r.nestdb = new xi({
              name: "sendbird@".concat(n.appId, "/").concat(e, ".db"),
              version: this._getNestDBVersion(),
              store: r.store
            })).on("upgrade", ct(c, r.store)), c.on("storeReplaced", function (e) {
              r.replaceStore(e), r.localCacheEnabled = !1, c.on("upgrade", ct(c, r.store));
            }), [4, c.open()]);

          case 3:
            a.sent(), this._storeInitialized = !0, o.dispatch(new N(this._iid, {
              userId: e
            })), a.label = 4;

          case 4:
            return n.userId = e, [3, 7];

          case 5:
            return d = a.sent(), s.warn("Nest DB Open Failed. ", d), [4, this._safeInitializeStore(u)];

          case 6:
            throw a.sent(), n.userId = e, v$2.databaseError;

          case 7:
            return [3, 10];

          case 8:
            return [4, this._safeInitializeStore(u)];

          case 9:
            a.sent(), n.userId = e, a.label = 10;

          case 10:
            return [2];
        }
      });
    });
  }, t.prototype.getCacheDataSize = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return (e = _o.of(this._iid).cacheContext).localCacheEnabled && e.nestdb ? [4, e.nestdb.estimateUsage()] : [3, 2];

          case 1:
            return [2, t.sent()];

          case 2:
            return [2, 0];
        }
      });
    });
  }, t.prototype.clearCachedData = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return (e = _o.of(this._iid).cacheContext).localCacheEnabled && e.nestdb ? [4, e.nestdb.clear()] : [3, 2];

          case 1:
            t.sent(), t.label = 2;

          case 2:
            return this._storeInitialized ? [4, e.preference.clear()] : [3, 4];

          case 3:
            t.sent(), t.label = 4;

          case 4:
            return [2];
        }
      });
    });
  }, t.prototype.clearCachedMessages = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r = this;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), t = Hi.of(this._iid), n = Vi.of(this._iid), t && n ? [4, Promise.all(e.map(function (e) {
              return i$1(r, void 0, void 0, function () {
                return o$1(this, function (r) {
                  switch (r.label) {
                    case 0:
                      return [4, t.removeMessagesOfChannel(e)];

                    case 1:
                      return r.sent(), [4, n.removeMessagesOfChannel(e)];

                    case 2:
                      return r.sent(), [2];
                  }
                });
              });
            }))] : [3, 2];

          case 1:
            i.sent(), i.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, t.prototype.connect = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var r, i, o, s, u, c, d;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            Qi$1(w$1("string", e) && w$1("string", t, !0)).throw(v$2.invalidParameters), r = _o.of(this._iid), i = r.sdkState, o = r.cacheContext, s = r.connectionManager, u = r.statLogCollector, a.label = 1;

          case 1:
            return a.trys.push([1, 3,, 4]), [4, this.initializeCache(e)];

          case 2:
            return a.sent(), _o.of(this._iid).dispatcher.dispatch(new v$1()), [3, 4];

          case 3:
            return a.sent(), c = _o.of(this._iid).logger, o.localCacheEnabled = !1, c.warn("Cache initialization failed - cache is not available."), [3, 4];

          case 4:
            return [4, o.preference.init(this._getPreferenceCacheKey(e), this._getCurrentPreferenceVersion())];

          case 5:
            return a.sent(), [4, o.preference.get(this._getUserProfileCacheKey(e))];

          case 6:
            return (d = a.sent()) && new $i$1(this._iid, d).apply(), [4, u.init("sendbird@".concat(i.appId, "/").concat(e, ".statlog"))];

          case 7:
            a.sent(), a.label = 8;

          case 8:
            return a.trys.push([8,, 10, 11]), [4, s.connect(t)];

          case 9:
            return a.sent(), [3, 11];

          case 10:
            return this._onlineDetector.start(), this._appStateChangeDetector.start(), [7];

          case 11:
            return [2, this.currentUser];
        }
      });
    });
  }, t.prototype.reconnect = function () {
    var e = _o.of(this._iid),
        t = e.connectionManager,
        n = e.sdkState,
        r = e.sessionManager.auth.hasSession;
    return r && (this._appStateChangeDetector.start(), this._onlineDetector.start(), t.resetAndReconnect().then(function () {
      n.appState = "foreground";
    }).catch(function () {})), r;
  }, t.prototype.disconnect = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return e = _o.of(this._iid), t = e.connectionManager, n = e.requestQueue, this._appStateChangeDetector.stop(), this._onlineDetector.stop(), n.cancelAll(), [4, t.logout()];

          case 1:
            return r.sent(), [4, this.clearCachedData()];

          case 2:
            return r.sent(), [2];
        }
      });
    });
  }, t.prototype.disconnectWebSocket = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return e = _o.of(this._iid), t = e.connectionManager, n = e.requestQueue, this._appStateChangeDetector.stop(), this._onlineDetector.stop(), n.cancelAll(), [4, t.disconnectWebSocket()];

          case 1:
            return r.sent(), [2];
        }
      });
    });
  }, t.prototype.setBackgroundState = function () {
    var e = _o.of(this._iid),
        t = e.connectionManager,
        n = e.sdkState,
        r = e.logger;
    "foreground" === n.appState && (n.appState = "background", r.debug("going background state"), t.background());
  }, t.prototype.setForegroundState = function () {
    var e = _o.of(this._iid),
        t = e.connectionManager,
        n = e.sdkState,
        r = e.logger;
    "background" === n.appState && (n.appState = "foreground", r.debug("going foreground state"), t.resetAndReconnect());
  }, t.prototype.setSessionHandler = function (e) {
    Qi$1(e instanceof wr).throw(v$2.invalidParameters), _o.of(this._iid).sessionManager.handler = e;
  }, t.prototype.addUserEventHandler = function (e, t) {
    Qi$1(w$1("string", e) && t instanceof Mr).throw(v$2.invalidParameters), _o.of(this._iid).userEventHandlers.set(e, t);
  }, t.prototype.removeUserEventHandler = function (e) {
    _o.of(this._iid).userEventHandlers.delete(e);
  }, t.prototype.removeAllUserEventHandler = function () {
    _o.of(this._iid).userEventHandlers.clear();
  }, t.prototype.addConnectionHandler = function (e, t) {
    Qi$1(w$1("string", e) && t instanceof Tr).throw(v$2.invalidParameters), _o.of(this._iid).connectionHandlers.set(e, t);
  }, t.prototype.removeConnectionHandler = function (e) {
    _o.of(this._iid).connectionHandlers.delete(e);
  }, t.prototype.removeAllConnectionHandler = function () {
    _o.of(this._iid).connectionHandlers.clear();
  }, t.prototype.createApplicationUserListQuery = function (e) {
    return void 0 === e && (e = {}), new Nr(this._iid, e);
  }, t.prototype.createBlockedUserListQuery = function (e) {
    return void 0 === e && (e = {}), new Cr(this._iid, e);
  }, t.prototype.createFriendListQuery = function (e) {
    return void 0 === e && (e = {}), new Rr(this._iid, e);
  }, t.prototype.createMessageSearchQuery = function (e) {
    return new rs(this._iid, e);
  }, t.prototype.createPollListQuery = function (e) {
    return new Yo(this._iid, n$1({}, e));
  }, t.prototype.createPollVoterListQuery = function (e) {
    return new $o(this._iid, n$1({}, e));
  }, t.prototype.buildUserFromSerializedData = function (e) {
    var t = Wi$1(e);
    return new Xi$1(this._iid, Xi$1.payloadify(t));
  }, t.prototype.updateCurrentUserInfo = function (t) {
    return void 0 === t && (t = {}), i$1(this, void 0, void 0, function () {
      var r, i, o, s, u, c, d;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return r = n$1(n$1({}, at), t), Qi$1(function (t) {
              return k(t.profileImage, !0) && w$1("string", t.profileUrl, !0) && w$1("string", t.nickname, !0);
            }(r)).throw(v$2.invalidParameters), this.currentUser ? (i = _o.of(this._iid), o = i.sdkState, s = i.requestQueue, u = new ft(n$1({
              userId: o.userId
            }, r)), [4, s.send(u)]) : [3, 2];

          case 1:
            return c = a.sent(), d = c.as(pt).user, this.currentUser && (r.nickname && (this.currentUser.nickname = d.nickname), (r.profileUrl || r.profileImage) && (this.currentUser.plainProfileUrl = d.profileUrl)), [2, d];

          case 2:
            throw v$2.connectionRequired;
        }
      });
    });
  }, t.prototype.updateCurrentUserInfoWithPreferredLanguages = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, o, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), this.currentUser ? (t = _o.of(this._iid), n = t.sdkState, r = t.requestQueue, i = new ft({
              userId: n.userId,
              preferredLanguages: e
            }), [4, r.send(i)]) : [3, 2];

          case 1:
            return o = a.sent(), s = o.as(pt).user, this.currentUser && (this.currentUser.preferredLanguages = s.preferredLanguages), [2, s];

          case 2:
            throw v$2.connectionRequired;
        }
      });
    });
  }, t.prototype.registerFCMPushTokenForCurrentUser = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          r,
          i,
          s,
          u,
          c = this;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            if (Qi$1(w$1("string", e)).throw(v$2.invalidParameters), !this.currentUser) return [3, 6];
            d.label = 1;

          case 1:
            return d.trys.push([1, 4,, 5]), t = _o.of(this._iid), r = t.sessionManager, i = t.sdkState, s = t.requestQueue, r.hasDeviceToken(f$4.FCM, e) ? [2, d$1.SUCCESS] : (u = new gt({
              userId: i.userId,
              token: e
            }), [4, s.send(u)]);

          case 2:
            return d.sent(), [4, mi$1(function () {
              return i$1(c, void 0, void 0, function () {
                return o$1(this, function (t) {
                  switch (t.label) {
                    case 0:
                      return r.setDeviceToken(f$4.FCM, e), [4, r.saveDeviceToken()];

                    case 1:
                      return t.sent(), [2];
                  }
                });
              });
            })];

          case 3:
            return d.sent(), this._fcmPushToken = "", [2, d$1.SUCCESS];

          case 4:
            return d.sent(), [2, d$1.ERROR];

          case 5:
            return [3, 7];

          case 6:
            return this._fcmPushToken = e, [2, d$1.PENDING];

          case 7:
            return [2];
        }
      });
    });
  }, t.prototype.unregisterFCMPushTokenForCurrentUser = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          r,
          i,
          s,
          u,
          c,
          d = this;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            if (Qi$1(w$1("string", e)).throw(v$2.invalidParameters), !this.currentUser) return [3, 6];
            l.label = 1;

          case 1:
            return l.trys.push([1, 4,, 5]), t = _o.of(this._iid), r = t.sessionManager, i = t.sdkState, s = t.requestQueue, u = new mt({
              userId: i.userId,
              token: e
            }), [4, s.send(u)];

          case 2:
            return c = l.sent().lastDeletedAt, [4, mi$1(function () {
              return i$1(d, void 0, void 0, function () {
                return o$1(this, function (t) {
                  switch (t.label) {
                    case 0:
                      return r.unsetDeviceToken(f$4.FCM, e), r.setDeviceTokenDeletedAt(c), [4, r.saveDeviceToken()];

                    case 1:
                      return t.sent(), [2];
                  }
                });
              });
            })];

          case 3:
            return l.sent(), this._fcmPushToken = "", [2, d$1.SUCCESS];

          case 4:
            return l.sent(), [2, d$1.ERROR];

          case 5:
            return [3, 7];

          case 6:
            return this._fcmPushToken = e, [2, d$1.PENDING];

          case 7:
            return [2];
        }
      });
    });
  }, t.prototype.unregisterFCMPushTokenAllForCurrentUser = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t,
          n,
          r,
          i,
          s,
          u = this;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return this.currentUser ? (e = _o.of(this._iid), t = e.sessionManager, n = e.sdkState, r = e.requestQueue, i = new yt({
              userId: n.userId
            }), [4, r.send(i)]) : [3, 3];

          case 1:
            return s = c.sent().lastDeletedAt, [4, mi$1(function () {
              return i$1(u, void 0, void 0, function () {
                return o$1(this, function (e) {
                  switch (e.label) {
                    case 0:
                      return t.unsetDeviceTokens(f$4.FCM), t.setDeviceTokenDeletedAt(s), [4, t.saveDeviceToken()];

                    case 1:
                      return e.sent(), [2];
                  }
                });
              });
            })];

          case 2:
            c.sent(), c.label = 3;

          case 3:
            return [2];
        }
      });
    });
  }, t.prototype.registerAPNSPushTokenForCurrentUser = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          r,
          i,
          s,
          u,
          c = this;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            if (Qi$1(w$1("string", e)).throw(v$2.invalidParameters), !this.currentUser) return [3, 6];
            d.label = 1;

          case 1:
            return d.trys.push([1, 4,, 5]), t = _o.of(this._iid), r = t.sessionManager, i = t.sdkState, s = t.requestQueue, r.hasDeviceToken(f$4.APNS, e) ? [2, d$1.SUCCESS] : (u = new vt({
              userId: i.userId,
              token: e
            }), [4, s.send(u)]);

          case 2:
            return d.sent(), [4, mi$1(function () {
              return i$1(c, void 0, void 0, function () {
                return o$1(this, function (t) {
                  switch (t.label) {
                    case 0:
                      return r.setDeviceToken(f$4.APNS, e), [4, r.saveDeviceToken()];

                    case 1:
                      return t.sent(), [2];
                  }
                });
              });
            })];

          case 3:
            return d.sent(), this._apnsPushToken = "", [2, d$1.SUCCESS];

          case 4:
            return d.sent(), [2, d$1.ERROR];

          case 5:
            return [3, 7];

          case 6:
            return this._apnsPushToken = e, [2, d$1.PENDING];

          case 7:
            return [2];
        }
      });
    });
  }, t.prototype.unregisterAPNSPushTokenForCurrentUser = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t,
          r,
          i,
          s,
          u,
          c,
          d = this;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            if (Qi$1(w$1("string", e)).throw(v$2.invalidParameters), !this.currentUser) return [3, 6];
            l.label = 1;

          case 1:
            return l.trys.push([1, 4,, 5]), t = _o.of(this._iid), r = t.sessionManager, i = t.sdkState, s = t.requestQueue, u = new _t({
              userId: i.userId,
              token: e
            }), [4, s.send(u)];

          case 2:
            return c = l.sent().lastDeletedAt, [4, mi$1(function () {
              return i$1(d, void 0, void 0, function () {
                return o$1(this, function (t) {
                  switch (t.label) {
                    case 0:
                      return r.unsetDeviceToken(f$4.APNS, e), r.setDeviceTokenDeletedAt(c), [4, r.saveDeviceToken()];

                    case 1:
                      return t.sent(), [2];
                  }
                });
              });
            })];

          case 3:
            return l.sent(), this._apnsPushToken = "", [2, d$1.SUCCESS];

          case 4:
            return l.sent(), [2, d$1.ERROR];

          case 5:
            return [3, 7];

          case 6:
            return this._apnsPushToken = e, [2, d$1.PENDING];

          case 7:
            return [2];
        }
      });
    });
  }, t.prototype.unregisterAPNSPushTokenAllForCurrentUser = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t,
          n,
          r,
          i,
          s,
          u = this;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return this.currentUser ? (e = _o.of(this._iid), t = e.sessionManager, n = e.sdkState, r = e.requestQueue, i = new bt({
              userId: n.userId
            }), [4, r.send(i)]) : [3, 3];

          case 1:
            return s = c.sent().lastDeletedAt, [4, mi$1(function () {
              return i$1(u, void 0, void 0, function () {
                return o$1(this, function (e) {
                  switch (e.label) {
                    case 0:
                      return t.unsetDeviceTokens(f$4.APNS), t.setDeviceTokenDeletedAt(s), [4, t.saveDeviceToken()];

                    case 1:
                      return e.sent(), [2];
                  }
                });
              });
            })];

          case 2:
            c.sent(), c.label = 3;

          case 3:
            return [2];
        }
      });
    });
  }, t.prototype.getChannelInvitationPreference = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, r = new kt$1({
              userId: t.userId
            }), [4, n.send(r)];

          case 1:
            return i = o.sent(), [2, {
              autoAccept: i.as(Ct).autoAccept
            }];
        }
      });
    });
  }, t.prototype.setChannelInvitationPreference = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, r, i, o, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return Qi$1(w$1("boolean", e)).throw(v$2.invalidParameters), t = _o.of(this._iid), r = t.sdkState, i = t.requestQueue, o = new St$1({
              userId: r.userId,
              willAutoAccept: e
            }), [4, i.send(o)];

          case 1:
            return s = a.sent(), [2, {
              autoAccept: s.as(Tt$1).autoAccept
            }];
        }
      });
    });
  }, t.prototype.getDoNotDisturb = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, r = new Et({
              userId: t.userId
            }), [4, n.send(r)];

          case 1:
            return i = o.sent(), [2, i.as(Pt$1).preference];
        }
      });
    });
  }, t.prototype.setDoNotDisturb = function (e, t, r, i, s, u) {
    return void 0 === t && (t = 0), void 0 === r && (r = 0), void 0 === i && (i = 0), void 0 === s && (s = 0), void 0 === u && (u = ""), i$1(this, void 0, void 0, function () {
      var o, c, d, l, h;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return Qi$1(w$1("boolean", e) && w$1("number", t) && w$1("number", r) && w$1("number", i) && w$1("number", s) && w$1("string", u)).throw(v$2.invalidParameters), o = _o.of(this._iid), c = o.sdkState, d = o.requestQueue, l = new Ut$1({
              userId: c.userId,
              doNotDisturbOn: e,
              startHour: t,
              startMin: r,
              endHour: i,
              endMin: s,
              timezone: u
            }), [4, d.send(l)];

          case 1:
            return h = a.sent(), [2, h.as(Dt$1).preference];
        }
      });
    });
  }, t.prototype.getSnoozePeriod = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, r = new Ot$1({
              userId: t.userId
            }), [4, n.send(r)];

          case 1:
            return i = o.sent(), [2, i.as(At$1).snoozePeriod];
        }
      });
    });
  }, t.prototype.setSnoozePeriod = function (e, t, r) {
    return void 0 === t && (t = 0), void 0 === r && (r = 0), i$1(this, void 0, void 0, function () {
      var i, o, s, u, c;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return Qi$1(w$1("boolean", e) && w$1("number", t) && w$1("number", r)).throw(v$2.invalidParameters), i = _o.of(this._iid), o = i.sdkState, s = i.requestQueue, u = new Lt$1({
              userId: o.userId,
              snoozeOn: e,
              startTs: t,
              endTs: r
            }), [4, s.send(u)];

          case 1:
            return c = a.sent(), [2, c.as(Nt$1).snoozePeriod];
        }
      });
    });
  }, t.prototype.getMyPushTokensByToken = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var r, i, o, s, u, c, d, l, h, f, p, v;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return Qi$1(w$1("string", e) && N$1(f$4, t)).throw(v$2.invalidParameters), r = _o.of(this._iid), i = r.sdkState, o = r.requestQueue, s = r.sessionManager, u = new wt$1({
              userId: i.userId,
              type: t,
              token: e
            }), [4, o.send(u)];

          case 1:
            c = a.sent(), d = c.as(It$1).pushTokens;

            try {
              for (l = s$2(d.deviceTokens), h = l.next(); !h.done; h = l.next()) f = h.value, s.setDeviceToken(d.type, f);
            } catch (e) {
              p = {
                error: e
              };
            } finally {
              try {
                h && !h.done && (v = l.return) && v.call(l);
              } finally {
                if (p) throw p.error;
              }
            }

            return [4, s.saveDeviceToken()];

          case 2:
            return a.sent(), [2, d];
        }
      });
    });
  }, t.prototype.getPushTriggerOption = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, r = new zt$1({
              userId: t.userId
            }), [4, n.send(r)];

          case 1:
            return [2, i.sent().as(Qt$1).pushTriggerOption];
        }
      });
    });
  }, t.prototype.setPushTriggerOption = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(N$1(_$1, e)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.sdkState, r = t.requestQueue, i = new jt$1({
              userId: n.userId,
              pushTriggerOption: e
            }), [4, r.send(i)];

          case 1:
            return [2, o.sent().as(qt$1).pushTriggerOption];
        }
      });
    });
  }, t.prototype.getPushTemplate = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, r = new Ft$1({
              userId: t.userId
            }), [4, n.send(r)];

          case 1:
            return [2, i.sent().as(Ht$1).name];
        }
      });
    });
  }, t.prototype.setPushTemplate = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(N$1(p$2, e)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.sdkState, r = t.requestQueue, i = new xt$1({
              userId: n.userId,
              templateName: e
            }), [4, r.send(i)];

          case 1:
            return [2, o.sent().as(Gt$1).name];
        }
      });
    });
  }, t.prototype.blockUser = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, r, i, o;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(e instanceof Xi$1 || w$1("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid), r = t.sdkState, i = t.requestQueue, o = new Mt({
              userId: r.userId,
              blockedUserId: e instanceof Xi$1 ? e.userId : e
            }), [4, i.send(o)];

          case 1:
            return s.sent(), [2];
        }
      });
    });
  }, t.prototype.blockUserWithUserId = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return [2, this.blockUser(e)];
      });
    });
  }, t.prototype.unblockUser = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, r, i, o;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(e instanceof Xi$1 || w$1("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid), r = t.sdkState, i = t.requestQueue, o = new Rt$1({
              userId: r.userId,
              unblockedUserId: e instanceof Xi$1 ? e.userId : e
            }), [4, i.send(o)];

          case 1:
            return s.sent(), [2];
        }
      });
    });
  }, t.prototype.unblockUserWithUserId = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return [2, this.unblockUser(e)];
      });
    });
  }, t.prototype.getFriendChangeLogsByToken = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, r, i, o, s;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid), r = t.sdkState, i = t.requestQueue, o = new Wt$1({
              userId: r.userId,
              token: e
            }), [4, i.send(o)];

          case 1:
            return s = a.sent(), [2, s.as(Bt$1).changelogs];
        }
      });
    });
  }, t.prototype.getAllowFriendDiscovery = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, r = new $t$1({
              userId: t.userId
            }), [4, n.send(r)];

          case 1:
            return i = o.sent(), [2, i.as(en$1).allowFriendDiscovery];
        }
      });
    });
  }, t.prototype.setAllowFriendDiscovery = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, r, i, o;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(w$1("boolean", e)).throw(v$2.invalidParameters), t = _o.of(this._iid), r = t.sdkState, i = t.requestQueue, o = new tn$1({
              userId: r.userId,
              allowFriendDiscovery: e
            }), [4, i.send(o)];

          case 1:
            return s.sent(), [2, e];
        }
      });
    });
  }, t.prototype.uploadFriendDiscoveries = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, o;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return t = _o.of(this._iid), n = t.sdkState, r = t.requestQueue, i = new Kt$1({
              userId: n.userId,
              discoveries: e
            }), [4, r.send(i)];

          case 1:
            return o = s.sent(), [2, o.as(Vt$1).friendDiscoveryRequestId];
        }
      });
    });
  }, t.prototype.deleteFriendDiscovery = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return [2, this.deleteFriendDiscoveries([e])];
      });
    });
  }, t.prototype.deleteFriendDiscoveries = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.sdkState, r = t.requestQueue, i = new Jt$1({
              userId: n.userId,
              discoveryKeys: e
            }), [4, r.send(i)];

          case 1:
            return o.sent(), [2];
        }
      });
    });
  }, t.prototype.addFriends = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, o;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.sdkState, r = t.requestQueue, i = new Xt$1({
              userId: n.userId,
              userIds: e
            }), [4, r.send(i)];

          case 1:
            return o = s.sent(), [2, o.as(Yt).users];
        }
      });
    });
  }, t.prototype.deleteFriend = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return [2, this.deleteFriends([e])];
      });
    });
  }, t.prototype.deleteFriends = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.sdkState, r = t.requestQueue, i = new Zt$1({
              userId: n.userId,
              userIds: e
            }), [4, r.send(i)];

          case 1:
            return o.sent(), [2];
        }
      });
    });
  }, t.prototype.getAllEmoji = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, t = new rn$1(), [4, e.send(t)];

          case 1:
            return n = r.sent(), [2, n.as(on$1).emojiContainer];
        }
      });
    });
  }, t.prototype.getEmojiCategory = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return t = _o.of(this._iid).requestQueue, n = new sn$1({
              categoryId: e
            }), [4, t.send(n)];

          case 1:
            return r = i.sent(), [2, r.as(an$1).emojiCategory];
        }
      });
    });
  }, t.prototype.getEmoji = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return t = _o.of(this._iid).requestQueue, n = new un$1({
              key: e
            }), [4, t.send(n)];

          case 1:
            return r = i.sent(), [2, r.as(cn$1).emoji];
        }
      });
    });
  }, t.prototype.getUIKitConfiguration = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return e = _o.of(this._iid), Qi$1(e.hasExtension("sb_uikit")).throw(v$2.notSupportedError), t = e.requestQueue, n = new dn$1(), [4, t.send(n)];

          case 1:
            return r = i.sent(), [2, r.as(ln$1).uikitConfiguration];
        }
      });
    });
  }, t;
}();

/* eslint-disable no-bitwise */

/* eslint-disable eqeqeq */

/* eslint-disable no-mixed-operators */
// https://stackoverflow.com/a/2117523
// used mainly for dom key generation
const uuidv4 = () => 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
  const r = Math.random() * 16 | 0;
  const v = c === 'x' ? r : r & 0x3 | 0x8;
  return v.toString(16);
});

var U;
!function (e) {
  e[e.NONE = 0] = "NONE", e[e.CHANNEL_ENTER = 10102] = "CHANNEL_ENTER", e[e.CHANNEL_EXIT = 10103] = "CHANNEL_EXIT", e[e.USER_CHANNEL_MUTE = 10201] = "USER_CHANNEL_MUTE", e[e.USER_CHANNEL_UNMUTE = 10200] = "USER_CHANNEL_UNMUTE", e[e.USER_CHANNEL_BAN = 10601] = "USER_CHANNEL_BAN", e[e.USER_CHANNEL_UNBAN = 10600] = "USER_CHANNEL_UNBAN", e[e.CHANNEL_FREEZE = 10701] = "CHANNEL_FREEZE", e[e.CHANNEL_UNFREEZE = 10700] = "CHANNEL_UNFREEZE", e[e.TYPING_START = 10900] = "TYPING_START", e[e.TYPING_END = 10901] = "TYPING_END", e[e.CHANNEL_JOIN = 1e4] = "CHANNEL_JOIN", e[e.CHANNEL_LEAVE = 10001] = "CHANNEL_LEAVE", e[e.CHANNEL_OPERATOR_UPDATE = 10002] = "CHANNEL_OPERATOR_UPDATE", e[e.CHANNEL_INVITE = 10020] = "CHANNEL_INVITE", e[e.CHANNEL_ACCEPT_INVITE = 10021] = "CHANNEL_ACCEPT_INVITE", e[e.CHANNEL_DECLINE_INVITE = 10022] = "CHANNEL_DECLINE_INVITE", e[e.CHANNEL_PROP_CHANGED = 11e3] = "CHANNEL_PROP_CHANGED", e[e.CHANNEL_DELETED = 12e3] = "CHANNEL_DELETED", e[e.CHANNEL_META_DATA_CHANGED = 11100] = "CHANNEL_META_DATA_CHANGED", e[e.CHANNEL_META_COUNTERS_CHANGED = 11200] = "CHANNEL_META_COUNTERS_CHANGED", e[e.CHANNEL_HIDE = 13e3] = "CHANNEL_HIDE", e[e.CHANNEL_UNHIDE = 13001] = "CHANNEL_UNHIDE", e[e.PINNED_MESSAGE_CHANGED = 11300] = "PINNED_MESSAGE_CHANGED";
}(U || (U = {}));

var b$1 = function () {
  function t(e) {
    var t;
    this.channelUrl = e.channel_url, this.channelType = e.channel_type, this.category = e.cat, this.data = null !== (t = e.data) && void 0 !== t ? t : {}, this.ts = e.ts;
  }

  return Object.defineProperty(t.prototype, "isGroupChannelEvent", {
    get: function () {
      return this.channelType === x.GROUP;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "isOpenChannelEvent", {
    get: function () {
      return this.channelType === x.OPEN;
    },
    enumerable: !1,
    configurable: !0
  }), t;
}(),
    T$1 = function (e) {
  function n(t, n, s) {
    var r = e.call(this, t, "SYEV", s) || this;
    return r.event = new b$1(s), r;
  }

  return t$1(n, e), n;
}(Pe$3),
    M = function (e) {
  function n(t, n, r) {
    var o = e.call(this, t, n, r) || this,
        a = r.data.operators,
        i = void 0 === a ? [] : a;
    return o.operators = i.map(function (e) {
      return new Xi$1(o._iid, e);
    }), o;
  }

  return t$1(n, e), n;
}(T$1),
    H = function () {
  function e(e) {
    var t = e.top,
        n = void 0 === t ? Number.MAX_SAFE_INTEGER : t,
        s = e.bottom,
        r = void 0 === s ? 0 : s;
    this.top = n, this.bottom = r;
  }

  return e.prototype.includes = function () {
    for (var e = this, t = [], n = 0; n < arguments.length; n++) t[n] = arguments[n];

    return t.every(function (t) {
      return e.top <= t && t <= e.bottom;
    });
  }, e.prototype.overlap = function (e) {
    return this.includes(e.top) || this.includes(e.bottom);
  }, e.prototype.intersect = function () {
    for (var e = this, t = [], n = 0; n < arguments.length; n++) t[n] = arguments[n];

    return t.some(function (t) {
      return e.top <= t && t <= e.bottom;
    });
  }, e.prototype.extends = function () {
    for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t];

    this.top = Math.min.apply(Math, c$1([this.top], a$1(e), !1)), this.bottom = Math.max.apply(Math, c$1([this.bottom], a$1(e), !1));
  }, e;
}(),
    L = function (e) {
  function n(t, n) {
    var s = e.call(this, t) || this;
    return s._logger = n.logger, s._sdkState = n.sdkState, s._sessionManager = n.sessionManager, s._requestQueue = n.requestQueue, s._dispatcher = n.dispatcher, s._cacheContext = n.cacheContext, s._channelType = n.channelType, s;
  }

  return t$1(n, e), Object.defineProperty(n.prototype, "_messageCache", {
    get: function () {
      return Hi.of(this._iid);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "_unsentMessageCache", {
    get: function () {
      return Vi.of(this._iid);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "_messageBroadcast", {
    get: function () {
      return Ji.of(this._iid);
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype.subscribeMessageEvent = function (e, t) {
    this._messageBroadcast.subscribe(e, t);
  }, n.prototype.unsubscribeMessageEvent = function (e) {
    this._messageBroadcast.unsubscribe(e);
  }, n.prototype.getMessageFromCache = function (e) {
    var t;
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._messageCache.get(e)];

          case 1:
            return [2, null !== (t = n.sent()) && void 0 !== t ? t : null];
        }
      });
    });
  }, n.prototype.getExactlyMatchingMessagesForTokenFromCache = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return [4, this._messageCache.fetch({
              channelUrl: e,
              token: t,
              filter: n,
              exactMatch: !0
            })];

          case 1:
            return [2, s.sent()];
        }
      });
    });
  }, n.prototype.getMessagesFromCache = function (e, t, n, s, r, o) {
    return void 0 === r && (r = lr), void 0 === o && (o = !0), i$1(this, void 0, void 0, function () {
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return [4, this._messageCache.fetch({
              channelUrl: e,
              token: t,
              limit: r,
              filter: s,
              backward: "next" === n,
              inclusive: o
            })];

          case 1:
            return [2, a.sent()];
        }
      });
    });
  }, n.prototype.getPollMessagesFromCache = function (e, t, n, s) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return [4, this._messageCache.fetch({
              channelUrl: e,
              token: t,
              limit: s,
              filter: n,
              backward: !1,
              isPollOnly: !0
            })];

          case 1:
            return [2, r.sent()];
        }
      });
    });
  }, n.prototype.getCachedMessageCountBetween = function (e, t, n, s) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return [4, this._messageCache.countBetween(e, t, new H({
              top: n,
              bottom: s
            }))];

          case 1:
            return [2, r.sent()];
        }
      });
    });
  }, n.prototype.getUnsentMessagesFromCache = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._unsentMessageCache.fetch({
              channelUrl: e,
              filter: t
            })];

          case 1:
            return [2, n.sent()];
        }
      });
    });
  }, n.prototype.removeFailedMessageFromCache = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._unsentMessageCache.remove([e])];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, n;
}(Fi$1),
    y$1 = function (e) {
  function n(t, n, s) {
    var r,
        o,
        a,
        i,
        u = this;
    (u = e.call(this, t, "ADMM", s) || this).message = new Be$1(t, s);
    var l = _o.of(t).sdkState;
    return u.isMentioned = be$1(u.message.mentionType, null !== (a = null !== (r = u.message.mentionedUserIds) && void 0 !== r ? r : null === (o = u.message.mentionedUsers) || void 0 === o ? void 0 : o.map(function (e) {
      return e.userId;
    })) && void 0 !== a ? a : [], l.userId), u.forceUpdateLastMessage = null !== (i = s.force_update_last_message) && void 0 !== i && i, u;
  }

  return t$1(n, e), n;
}(Pe$3),
    I = function (e) {
  function n(t, n, s) {
    var r,
        o,
        a,
        i,
        u,
        h = this;
    (h = e.call(this, t, "AEDI", s) || this).message = new Be$1(t, s);
    var N = _o.of(t).sdkState;
    return h.mentionCountChange = me$1({
      mentionType: null === (r = s.old_values) || void 0 === r ? void 0 : r.mention_type,
      mentionedUserIds: null !== (a = null === (o = s.old_values) || void 0 === o ? void 0 : o.mentioned_user_ids) && void 0 !== a ? a : []
    }, $({
      mentionType: h.message.mentionType,
      mentionedUserIds: null !== (i = h.message.mentionedUserIds) && void 0 !== i ? i : null === (u = h.message.mentionedUsers) || void 0 === u ? void 0 : u.map(function (e) {
        return e.userId;
      })
    }), N.userId), h;
  }

  return t$1(n, e), n;
}(Pe$3),
    D = function (e) {
  function n(t, n, s) {
    var r = e.call(this, t, "MRCT", s) || this;
    return r.channelUrl = s.channel_url, r.channelType = s.channel_type, r.event = new Ne$1(s), r;
  }

  return t$1(n, e), n;
}(Pe$3),
    R = function (e) {
  function n(t, n, s) {
    var r = e.call(this, t, "MTHD", s) || this;
    return r.event = new $i(t, s), r;
  }

  return t$1(n, e), n;
}(Pe$3),
    P = function (e) {
  function n(t, n, s) {
    var r = e.call(this, t, "MCNT", s) || this;
    return r.groupChannelMemberCounts = s.group_channels.map(function (e) {
      return {
        channelUrl: e.channel_url,
        memberCount: e.member_count,
        joinedMemberCount: e.joined_member_count,
        updatedAt: e.ts
      };
    }), r.openChannelMemberCounts = s.open_channels.map(function (e) {
      return {
        channelUrl: e.channel_url,
        participantCount: e.participant_count,
        updatedAt: e.ts
      };
    }), r;
  }

  return t$1(n, e), n;
}(Pe$3),
    O = function (e) {
  function n(t, n, s) {
    var r = e.call(this, t, "PEDI", s) || this;
    return r.event = new s$1(t, s), r.status = go(s.poll.status) || s.poll.status, r.channelUrl = s.channel_url, r.channelType = s.channel_type, r;
  }

  return t$1(n, e), n;
}(Pe$3),
    S = function () {
  this.onUserMuted = ze$2, this.onUserUnmuted = ze$2, this.onUserBanned = ze$2, this.onUserUnbanned = ze$2, this.onChannelChanged = ze$2, this.onChannelDeleted = ze$2, this.onChannelFrozen = ze$2, this.onChannelUnfrozen = ze$2, this.onOperatorUpdated = ze$2, this.onChannelMemberCountChanged = ze$2, this.onMetaDataCreated = ze$2, this.onMetaDataUpdated = ze$2, this.onMetaDataDeleted = ze$2, this.onMetaCounterCreated = ze$2, this.onMetaCounterUpdated = ze$2, this.onMetaCounterDeleted = ze$2, this.onMessageReceived = ze$2, this.onMessageUpdated = ze$2, this.onMessageDeleted = ze$2, this.onMentionReceived = ze$2, this.onReactionUpdated = ze$2, this.onThreadInfoUpdated = ze$2;
};

var le = function (r) {
  function a() {
    var e = null !== r && r.apply(this, arguments) || this;
    return e._channels = new Map(), e._enteredChannelUrls = [], e;
  }

  return t$1(a, r), Object.defineProperty(a.prototype, "enteredChannels", {
    get: function () {
      var e = this;
      return this._enteredChannelUrls.map(function (n) {
        return e._channels.get(n);
      }).filter(function (e) {
        return !!e;
      });
    },
    enumerable: !1,
    configurable: !0
  }), a.prototype.isEnteredChannel = function (e) {
    return this._enteredChannelUrls.includes(e);
  }, a.prototype.enter = function (e) {
    this._enteredChannelUrls.indexOf(e) < 0 && this._enteredChannelUrls.push(e);
  }, a.prototype.exit = function (e) {
    var n = this._enteredChannelUrls.indexOf(e);

    n >= 0 && this._enteredChannelUrls.splice(n, 1);
  }, a.prototype.exitAll = function () {
    this._enteredChannelUrls = [];
  }, a.prototype.get = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        return [2, this._channels.get(e)];
      });
    });
  }, a.prototype.upsert = function (e) {
    return i$1(this, void 0, void 0, function () {
      var n,
          r = this;
      return o$1(this, function (t) {
        return n = [], e.forEach(function (e) {
          if (r._channels.has(e.url)) {
            var t = r._channels.get(e.url);

            Object.assign(t, e), n.push(t);
          } else r._channels.set(e.url, e), n.push(e);
        }), [2, n];
      });
    });
  }, a.prototype.remove = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        return this._channels.delete(e), this.exit(e), [2];
      });
    });
  }, a.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return this._channels.clear(), this._enteredChannelUrls = [], [2];
      });
    });
  }, a;
}(Fi$1),
    he = {
  channelUrl: void 0,
  name: void 0,
  coverUrlOrImage: void 0,
  data: void 0,
  customType: void 0,
  operatorUserIds: void 0,
  isEphemeral: void 0
},
    de = function (n) {
  function t(e) {
    var t = e.channelUrl,
        r = e.isInternalCall,
        a = n.call(this) || this;
    return a.method = ee.GET, a.path = "".concat(r ? ae : se, "/").concat(encodeURIComponent(t)), a;
  }

  return t$1(t, n), t;
}(Ne$2),
    pe = function (n) {
  function t(e, t) {
    var r = n.call(this, e, t) || this;
    return r.channel = new Pe$1(e, t), r;
  }

  return t$1(t, n), t;
}(Te$2),
    fe = function (n) {
  function t(e) {
    var t = this,
        r = e.channelUrl,
        a = e.coverUrlOrImage,
        u = e.name,
        l = e.data,
        h = e.customType,
        f = e.operatorUserIds,
        C = e.isEphemeral;
    return (t = n.call(this) || this).method = ee.POST, t.path = se, t.params = J($({
      channel_url: r,
      cover_url: w$1("string", a) ? a : null,
      cover_file: k(a) ? a : null,
      name: u,
      data: l,
      custom_type: h,
      operators: f,
      is_ephemeral: C
    })), t;
  }

  return t$1(t, n), t;
}(Ne$2);

!function (n) {
  function t(e, t) {
    var r = n.call(this, e, t) || this;
    return r.channel = new Pe$1(e, t), r;
  }

  t$1(t, n);
}(Te$2);

var Ce = function (n) {
  function t(e) {
    var t = e.channelUrl;
    return n.call(this, {
      code: "ENTR",
      payload: {
        channel_url: t
      },
      ackRequired: !0
    }) || this;
  }

  return t$1(t, n), t;
}(ri$1),
    ve = function (n) {
  function t(e, t, r) {
    var a,
        o,
        i = this;
    return i = n.call(this, e, "SYEV", r) || this, r.data && (i.participantCount = null !== (a = r.data.participant_count) && void 0 !== a ? a : 0, i.user = new Xi$1(e, r.data), i.ts = null !== (o = r.data.edge_ts) && void 0 !== o ? o : 0), i;
  }

  return t$1(t, n), t;
}(T$1),
    _e = function (n) {
  function t(e) {
    var t = e.channelUrl;
    return n.call(this, {
      code: "EXIT",
      payload: {
        channel_url: t
      },
      ackRequired: !0
    }) || this;
  }

  return t$1(t, n), t;
}(ri$1),
    ye = function (n) {
  function t(e, t, r) {
    var a,
        o,
        i = this;
    return i = n.call(this, e, "EXIT", r) || this, r.data && (i.participantCount = null !== (a = r.data.participant_count) && void 0 !== a ? a : 0, i.user = new Xi$1(e, r.data), i.ts = null !== (o = r.data.edge_ts) && void 0 !== o ? o : 0), i;
  }

  return t$1(t, n), t;
}(T$1),
    Ue = {},
    me = function (r) {
  function s(e, a) {
    var o = r.call(this, e, n$1(n$1({}, a), {
      channelType: x.OPEN
    })) || this;
    return o.subscribeChannelEvent = ze$2, o.unsubscribeChannelEvent = ze$2, o.refreshChannel = function () {
      return i$1(o, void 0, void 0, function () {
        return o$1(this, function (e) {
          return [2, ze$2()];
        });
      });
    }, o._openChannelCache = new le(e), o._openChannelHandlers = new Map(), o._dispatcher.on(function (e) {
      var n, t;
      if (e instanceof Pe$3) o._handleEvent(e);else if (e instanceof ai$1 && e.stateType === ti$1.CONNECTED) {
        var r = o._openChannelCache.enteredChannels;

        try {
          for (var a = s$2(r), i = a.next(); !i.done; i = a.next()) {
            i.value.enter();
          }
        } catch (e) {
          n = {
            error: e
          };
        } finally {
          try {
            i && !i.done && (t = a.return) && t.call(a);
          } finally {
            if (n) throw n.error;
          }
        }
      }
    }), Ue[e] || (Ue[e] = o), o;
  }

  return t$1(s, r), s.of = function (e) {
    return Ue[e];
  }, s.prototype.buildOpenChannelFromSerializedData = function (e) {
    var n = Wi$1(e);
    return new Pe$1(this._iid, Pe$1.payloadify(n));
  }, s.prototype.getChannelFromCache = function (e) {
    var r;
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._openChannelCache.get(e)];

          case 1:
            return [2, null !== (r = n.sent()) && void 0 !== r ? r : null];
        }
      });
    });
  }, s.prototype.upsertChannelsToCache = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._openChannelCache.upsert(e)];

          case 1:
            return [2, n.sent()];
        }
      });
    });
  }, s.prototype.removeChannelsFromCache = function (e) {
    return i$1(this, void 0, void 0, function () {
      var n, r, a, o, i, s;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            t.trys.push([0, 5, 6, 7]), n = s$2(e), r = n.next(), t.label = 1;

          case 1:
            return r.done ? [3, 4] : (a = r.value, [4, this._openChannelCache.remove(a)]);

          case 2:
            t.sent(), t.label = 3;

          case 3:
            return r = n.next(), [3, 1];

          case 4:
            return [3, 7];

          case 5:
            return o = t.sent(), i = {
              error: o
            }, [3, 7];

          case 6:
            try {
              r && !r.done && (s = n.return) && s.call(n);
            } finally {
              if (i) throw i.error;
            }

            return [7];

          case 7:
            return [2];
        }
      });
    });
  }, s.prototype.setEnteredToCache = function (e) {
    this._openChannelCache.enter(e.url);
  }, s.prototype.setExitedToCache = function (e) {
    this._openChannelCache.exit(e.url);
  }, s.prototype._handleEvent = function (e) {
    return i$1(this, void 0, void 0, function () {
      var r,
          a,
          o,
          i,
          s,
          u,
          c,
          l,
          h,
          d,
          p,
          f,
          C,
          v,
          _,
          U$1,
          m,
          g,
          E,
          D$1,
          O$1,
          x$1,
          I$1,
          A,
          L,
          R$1,
          Y,
          Z,
          $,
          ee,
          ce,
          le,
          he,
          de,
          pe,
          fe,
          Ce,
          _e,
          Ue,
          me,
          ge,
          Ee,
          we,
          Te,
          Me,
          be,
          Ne,
          Pe,
          De,
          Oe,
          He,
          xe,
          Ie,
          Ae,
          Le,
          Re,
          Fe,
          ke,
          Se,
          qe,
          ze,
          Qe,
          Ke,
          Ve,
          We,
          Be,
          Ge,
          je,
          Xe = this;

      return o$1(this, function (Ye) {
        switch (Ye.label) {
          case 0:
            switch (Ye.trys.push([0, 57,, 58]), e.code) {
              case "MESG":
              case "FILE":
              case "ADMM":
              case "BRDM":
                return [3, 1];

              case "MEDI":
              case "FEDI":
              case "AEDI":
                return [3, 4];

              case "DELM":
                return [3, 7];

              case "MRCT":
                return [3, 10];

              case "MTHD":
                return [3, 13];

              case "MCNT":
                return [3, 16];

              case "PEDI":
                return [3, 27];

              case "VOTE":
                return [3, 30];

              case "SYEV":
                return [3, 33];
            }

            return [3, 56];

          case 1:
            return i = null, "MESG" === e.code ? i = e.as(Cn$1) : "FILE" === e.code ? i = e.as(Xe$1) : "ADMM" !== e.code && "BRDM" != e.code || (i = e.as(y$1)), i ? (r = i.message, a = i.isMentioned, r.channelType !== x.OPEN ? [3, 3] : [4, this.getChannel(r.channelUrl, !0)]) : [3, 3];

          case 2:
            o = Ye.sent(), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                var e, n, i, s, u;
                return o$1(this, function (t) {
                  try {
                    for (e = s$2(this._openChannelHandlers.values()), n = e.next(); !n.done; n = e.next()) i = n.value, this._openChannelCache.isEnteredChannel(o.url) && (i.onMessageReceived && i.onMessageReceived(o, r), a && i.onMentionReceived && i.onMentionReceived(o, r));
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      n && !n.done && (u = e.return) && u.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            }), Ye.label = 3;

          case 3:
            return [3, 56];

          case 4:
            return i = null, "MEDI" === e.code ? i = e.as(kn$1) : "FEDI" === e.code ? i = e.as(xn$1) : "AEDI" === e.code && (i = e.as(I)), i ? (s = i.message, u = i.mentionCountChange, s.channelType !== x.OPEN ? [3, 6] : [4, this.getChannel(s.channelUrl, !0)]) : [3, 6];

          case 5:
            c = Ye.sent(), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                var e, n, r, a, o;
                return o$1(this, function (t) {
                  try {
                    for (e = s$2(this._openChannelHandlers.values()), n = e.next(); !n.done; n = e.next()) r = n.value, this._openChannelCache.isEnteredChannel(c.url) && (r.onMessageUpdated && r.onMessageUpdated(c, s), u > 0 && r.onMentionReceived && r.onMentionReceived(c, s));
                  } catch (e) {
                    a = {
                      error: e
                    };
                  } finally {
                    try {
                      n && !n.done && (o = e.return) && o.call(e);
                    } finally {
                      if (a) throw a.error;
                    }
                  }

                  return [2];
                });
              });
            }), Ye.label = 6;

          case 6:
            return [3, 56];

          case 7:
            return l = e.as(Dn$1), ce = l.channelUrl, le = l.channelType, h = l.messageId, le !== x.OPEN ? [3, 9] : [4, this.getChannel(ce, !0)];

          case 8:
            d = Ye.sent(), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                var e, n, r, a, o;
                return o$1(this, function (t) {
                  try {
                    for (e = s$2(this._openChannelHandlers.values()), n = e.next(); !n.done; n = e.next()) r = n.value, this._openChannelCache.isEnteredChannel(d.url) && r.onMessageDeleted && r.onMessageDeleted(d, h);
                  } catch (e) {
                    a = {
                      error: e
                    };
                  } finally {
                    try {
                      n && !n.done && (o = e.return) && o.call(e);
                    } finally {
                      if (a) throw a.error;
                    }
                  }

                  return [2];
                });
              });
            }), Ye.label = 9;

          case 9:
            return [3, 56];

          case 10:
            return p = e.as(D), ce = p.channelUrl, le = p.channelType, f = p.event, le !== x.OPEN ? [3, 12] : [4, this.getChannel(ce, !0)];

          case 11:
            C = Ye.sent(), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                var e, n, r, a, o;
                return o$1(this, function (t) {
                  try {
                    for (e = s$2(this._openChannelHandlers.values()), n = e.next(); !n.done; n = e.next()) r = n.value, this._openChannelCache.isEnteredChannel(C.url) && r.onReactionUpdated && r.onReactionUpdated(C, f);
                  } catch (e) {
                    a = {
                      error: e
                    };
                  } finally {
                    try {
                      n && !n.done && (o = e.return) && o.call(e);
                    } finally {
                      if (a) throw a.error;
                    }
                  }

                  return [2];
                });
              });
            }), Ye.label = 12;

          case 12:
            return [3, 56];

          case 13:
            return (v = e.as(R).event).channelType !== x.OPEN ? [3, 15] : [4, this.getChannel(v.channelUrl, !0)];

          case 14:
            _ = Ye.sent(), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                var e, n, r, a, o;
                return o$1(this, function (t) {
                  try {
                    for (e = s$2(this._openChannelHandlers.values()), n = e.next(); !n.done; n = e.next()) r = n.value, this._openChannelCache.isEnteredChannel(_.url) && r.onThreadInfoUpdated && r.onThreadInfoUpdated(_, v);
                  } catch (e) {
                    a = {
                      error: e
                    };
                  } finally {
                    try {
                      n && !n.done && (o = e.return) && o.call(e);
                    } finally {
                      if (a) throw a.error;
                    }
                  }

                  return [2];
                });
              });
            }), Ye.label = 15;

          case 15:
            return [3, 56];

          case 16:
            U$1 = e.as(P).openChannelMemberCounts, m = [], Ye.label = 17;

          case 17:
            Ye.trys.push([17, 22, 23, 24]), g = s$2(U$1), E = g.next(), Ye.label = 18;

          case 18:
            return E.done ? [3, 21] : (D$1 = E.value, ce = D$1.channelUrl, ge = D$1.participantCount, O$1 = D$1.updatedAt, [4, this.getChannelFromCache(ce)]);

          case 19:
            (x$1 = Ye.sent()) && x$1._updateParticipantCount(ge, O$1) && m.push(x$1), Ye.label = 20;

          case 20:
            return E = g.next(), [3, 18];

          case 21:
            return [3, 24];

          case 22:
            return I$1 = Ye.sent(), Ge = {
              error: I$1
            }, [3, 24];

          case 23:
            try {
              E && !E.done && (je = g.return) && je.call(g);
            } finally {
              if (Ge) throw Ge.error;
            }

            return [7];

          case 24:
            return m.length > 0 ? [4, this.upsertChannelsToCache(m)] : [3, 26];

          case 25:
            A = Ye.sent(), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                var e, n, r, a, o;
                return o$1(this, function (t) {
                  try {
                    for (e = s$2(this._openChannelHandlers.values()), n = e.next(); !n.done; n = e.next()) (r = n.value).onChannelMemberCountChanged && r.onChannelMemberCountChanged(A);
                  } catch (e) {
                    a = {
                      error: e
                    };
                  } finally {
                    try {
                      n && !n.done && (o = e.return) && o.call(e);
                    } finally {
                      if (a) throw a.error;
                    }
                  }

                  return [2];
                });
              });
            }), Ye.label = 26;

          case 26:
            return [3, 56];

          case 27:
            return L = e.as(O), R$1 = L.event, Y = L.status, ce = L.channelUrl, le = L.channelType, ce && le === x.OPEN ? [4, this.getChannel(ce, !0)] : [3, 29];

          case 28:
            Z = Ye.sent(), this._dispatcher.dispatch(new Co({
              event: R$1,
              source: po.EVENT_POLL_UPDATED
            })), bi$1(Y === Eo ? function () {
              return i$1(Xe, void 0, void 0, function () {
                var e, n, r, a, o;
                return o$1(this, function (t) {
                  try {
                    for (e = s$2(this._openChannelHandlers.values()), n = e.next(); !n.done; n = e.next()) (r = n.value).onPollDeleted && r.onPollDeleted(Z, R$1.pollId);
                  } catch (e) {
                    a = {
                      error: e
                    };
                  } finally {
                    try {
                      n && !n.done && (o = e.return) && o.call(e);
                    } finally {
                      if (a) throw a.error;
                    }
                  }

                  return [2];
                });
              });
            } : function () {
              return i$1(Xe, void 0, void 0, function () {
                var e, n, r, a, o;
                return o$1(this, function (t) {
                  try {
                    for (e = s$2(this._openChannelHandlers.values()), n = e.next(); !n.done; n = e.next()) (r = n.value).onPollUpdated && r.onPollUpdated(Z, R$1);
                  } catch (e) {
                    a = {
                      error: e
                    };
                  } finally {
                    try {
                      n && !n.done && (o = e.return) && o.call(e);
                    } finally {
                      if (a) throw a.error;
                    }
                  }

                  return [2];
                });
              });
            }), Ye.label = 29;

          case 29:
            return [3, 56];

          case 30:
            return $ = e.as(ar), ee = $.event, ce = $.channelUrl, le = $.channelType, ce && le === x.OPEN ? [4, this.getChannel(ce, !0)] : [3, 32];

          case 31:
            he = Ye.sent(), this._dispatcher.dispatch(new ko({
              event: ee,
              source: po.EVENT_POLL_VOTED
            })), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                var e, n, r, a, o;
                return o$1(this, function (t) {
                  try {
                    for (e = s$2(this._openChannelHandlers.values()), n = e.next(); !n.done; n = e.next()) (r = n.value).onPollVoted && r.onPollVoted(he, ee);
                  } catch (e) {
                    a = {
                      error: e
                    };
                  } finally {
                    try {
                      n && !n.done && (o = e.return) && o.call(e);
                    } finally {
                      if (a) throw a.error;
                    }
                  }

                  return [2];
                });
              });
            }), Ye.label = 32;

          case 32:
            return [3, 56];

          case 33:
            if (!(de = e.as(T$1).event).isOpenChannelEvent) return [3, 55];

            switch (de.category) {
              case U.CHANNEL_ENTER:
                return [3, 34];

              case U.CHANNEL_EXIT:
                return [3, 36];

              case U.CHANNEL_OPERATOR_UPDATE:
                return [3, 38];

              case U.USER_CHANNEL_MUTE:
              case U.USER_CHANNEL_UNMUTE:
                return [3, 40];

              case U.USER_CHANNEL_BAN:
              case U.USER_CHANNEL_UNBAN:
                return [3, 42];

              case U.CHANNEL_FREEZE:
              case U.CHANNEL_UNFREEZE:
                return [3, 44];

              case U.CHANNEL_DELETED:
                return [3, 46];

              case U.CHANNEL_PROP_CHANGED:
                return [3, 49];

              case U.CHANNEL_META_DATA_CHANGED:
                return [3, 51];

              case U.CHANNEL_META_COUNTERS_CHANGED:
                return [3, 53];
            }

            return [3, 55];

          case 34:
            return [4, this.getChannel(de.channelUrl, !0)];

          case 35:
            return pe = Ye.sent(), fe = e.as(ve), ge = fe.participantCount, Ce = fe.user, _e = pe._updateParticipantCount(ge, de.ts), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._openChannelHandlers.forEach(function (e) {
                    e.onUserEntered && e.onUserEntered(pe, Ce), _e && e.onChannelParticipantCountChanged && e.onChannelParticipantCountChanged(pe);
                  }), [2];
                });
              });
            }), [3, 55];

          case 36:
            return [4, this.getChannel(de.channelUrl, !0)];

          case 37:
            return Ue = Ye.sent(), me = e.as(ye), ge = me.participantCount, Ee = me.user, we = Ue._updateParticipantCount(ge, de.ts), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._openChannelHandlers.forEach(function (e) {
                    e.onUserExited && e.onUserExited(Ue, Ee), we && e.onChannelParticipantCountChanged && e.onChannelParticipantCountChanged(Ue);
                  }), [2];
                });
              });
            }), [3, 55];

          case 38:
            return [4, this.getChannel(de.channelUrl, !0)];

          case 39:
            return Te = Ye.sent(), Me = e.as(M).operators, Te.operators = Me, this.upsertChannelsToCache([Te]), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._openChannelHandlers.forEach(function (e) {
                    e.onOperatorUpdated && e.onOperatorUpdated(Te, Me);
                  }), [2];
                });
              });
            }), [3, 55];

          case 40:
            return [4, this.getChannel(de.channelUrl, !0)];

          case 41:
            return be = Ye.sent(), Ne = de.category === U.USER_CHANNEL_MUTE, Pe = e.as(Ne ? _n$1 : bn$1).user, bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._openChannelHandlers.forEach(function (e) {
                    Ne ? e.onUserMuted && e.onUserMuted(be, Pe) : e.onUserUnmuted && e.onUserUnmuted(be, Pe);
                  }), [2];
                });
              });
            }), [3, 55];

          case 42:
            return [4, this.getChannel(de.channelUrl, !0)];

          case 43:
            return De = Ye.sent(), Oe = de.category === U.USER_CHANNEL_BAN, He = e.as(Oe ? En$1 : wn$1).user, bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._openChannelHandlers.forEach(function (e) {
                    Oe ? e.onUserBanned && e.onUserBanned(De, He) : e.onUserUnbanned && e.onUserUnbanned(De, He);
                  }), [2];
                });
              });
            }), [3, 55];

          case 44:
            return [4, this.getChannel(de.channelUrl, !0)];

          case 45:
            return xe = Ye.sent(), Ie = e.as(Sn$1).freeze, xe.isFrozen = Ie, this.upsertChannelsToCache([xe]), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._openChannelHandlers.forEach(function (e) {
                    Ie ? e.onChannelFrozen && e.onChannelFrozen(xe) : e.onChannelUnfrozen && e.onChannelUnfrozen(xe);
                  }), [2];
                });
              });
            }), [3, 55];

          case 46:
            return [4, this.getChannel(de.channelUrl, !0)];

          case 47:
            return Ae = Ye.sent(), [4, this.removeChannelsFromCache([Ae.url])];

          case 48:
            return Ye.sent(), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._openChannelHandlers.forEach(function (e) {
                    e.onChannelDeleted && e.onChannelDeleted(Ae.url, Ae.channelType);
                  }), [2];
                });
              });
            }), [3, 55];

          case 49:
            return [4, this.getChannelWithoutCache(de.channelUrl, !0)];

          case 50:
            return Le = Ye.sent(), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._openChannelHandlers.forEach(function (e) {
                    e.onChannelChanged && e.onChannelChanged(Le);
                  }), [2];
                });
              });
            }), [3, 55];

          case 51:
            return [4, this.getChannel(de.channelUrl, !0)];

          case 52:
            return Re = Ye.sent(), Fe = e.as(nn$2), ke = Fe.created, Se = Fe.updated, qe = Fe.deleted, ke && Re._upsertCachedMetaData(ke, de.ts), Se && Re._upsertCachedMetaData(Se, de.ts), qe && Re._removeFromCachedMetaData(qe, de.ts), bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._openChannelHandlers.forEach(function (e) {
                    ke && e.onMetaDataCreated && e.onMetaDataCreated(Re, ke), Se && e.onMetaDataUpdated && e.onMetaDataUpdated(Re, Se), qe && e.onMetaDataDeleted && e.onMetaDataDeleted(Re, qe);
                  }), [2];
                });
              });
            }), [3, 55];

          case 53:
            return [4, this.getChannel(de.channelUrl, !0)];

          case 54:
            return ze = Ye.sent(), Qe = e.as(pn$1), Ke = Qe.created, Ve = Qe.updated, We = Qe.deleted, bi$1(function () {
              return i$1(Xe, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._openChannelHandlers.forEach(function (e) {
                    Ke && e.onMetaCounterCreated && e.onMetaCounterCreated(ze, Ke), Ve && e.onMetaCounterUpdated && e.onMetaCounterUpdated(ze, Ve), We && e.onMetaCounterDeleted && e.onMetaCounterDeleted(ze, We);
                  }), [2];
                });
              });
            }), [3, 55];

          case 55:
            return [3, 56];

          case 56:
            return [3, 58];

          case 57:
            if (Be = Ye.sent(), g$2(Be)) throw Be;
            return [3, 58];

          case 58:
            return [2];
        }
      });
    });
  }, s.prototype.addHandler = function (e, n) {
    this._openChannelHandlers.set(e, n);
  }, s.prototype.removeHandler = function (e) {
    this._openChannelHandlers.delete(e);
  }, s.prototype.clearHandler = function () {
    this._openChannelHandlers.clear();
  }, s.prototype.getChannel = function (e, r) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            Qi$1(w$1("string", e)).throw(v$2.invalidParameters), t.label = 1;

          case 1:
            return t.trys.push([1, 3,, 4]), [4, this.getChannelFromCache(e)];

          case 2:
            return (n = t.sent()) ? [2, n] : [3, 4];

          case 3:
            return t.sent(), [3, 4];

          case 4:
            return [4, this.getChannelWithoutCache(e)];

          case 5:
            return [2, t.sent()];
        }
      });
    });
  }, s.prototype.getChannelWithoutCache = function (e, r) {
    return void 0 === r && (r = !1), i$1(this, void 0, void 0, function () {
      var n, a, i;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), n = new de({
              channelUrl: e,
              isInternalCall: r
            }), [4, this._requestQueue.send(n)];

          case 1:
            return a = t.sent(), i = a.as(pe).channel, [4, this.upsertChannelsToCache([i])];

          case 2:
            return [2, t.sent()[0]];
        }
      });
    });
  }, s.prototype.createChannel = function (e) {
    return i$1(this, void 0, void 0, function () {
      var n, r, s, u;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return n = n$1(n$1({}, he), e), Qi$1(function (e) {
              return S$2("string", e.operatorUserIds, !0) && (w$1("string", e.coverUrlOrImage, !0) || k(e.coverUrlOrImage, !0)) && w$1("string", e.name, !0) && w$1("string", e.data, !0) && w$1("string", e.customType, !0) && (w$1("string", e.channelUrl) && /^\w+$/.test(e.channelUrl) || null === e.channelUrl || void 0 === e.channelUrl) && w$1("boolean", e.isEphemeral, !0);
            }(n)).throw(v$2.invalidParameters), r = new fe(n), [4, this._requestQueue.send(r)];

          case 1:
            return s = t.sent(), u = s.as(pe).channel, this.upsertChannelsToCache([u]), [2, u];
        }
      });
    });
  }, s;
}(L),
    ge = {
  name: void 0,
  coverUrlOrImage: void 0,
  data: void 0,
  customType: void 0,
  operatorUserIds: void 0
},
    Ee = function (n) {
  function t(e) {
    var t = this,
        r = e.channelUrl,
        a = e.token,
        o = e.limit;
    return (t = n.call(this) || this).method = ee.GET, t.path = "".concat(se, "/").concat(encodeURIComponent(r), "/participants"), t.params = {
      token: a,
      limit: o
    }, t;
  }

  return t$1(t, n), t;
}(Ne$2),
    we = function (n) {
  function t(e, t) {
    var r = n.call(this, e, t) || this;
    r.participants = [];
    var a = t.next,
        o = t.participants;
    return r.token = a, r.participants = o.map(function (n) {
      return new _t$1(e, n);
    }), r;
  }

  return t$1(t, n), t;
}(Te$2),
    Te = function (r) {
  function a(e, n, t) {
    return r.call(this, e, n, x.OPEN, t) || this;
  }

  return t$1(a, r), a.prototype._validate = function () {
    return r.prototype._validate.call(this);
  }, a.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, n, r, a, o, i;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, n = new Ee(n$1(n$1({}, this), {
              token: this._token
            })), [4, e.send(n)]) : [3, 2] : [3, 5];

          case 1:
            return r = t.sent(), a = r.as(we), o = a.participants, i = a.token, this._token = i, this._hasNext = !!i, this._isLoading = !1, [2, o];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, a;
}(Io),
    Me = function (n) {
  function t(e) {
    var t = this,
        r = e.channelUrl,
        a = e.coverUrlOrImage,
        u = e.name,
        l = e.data,
        h = e.customType,
        f = e.operatorUserIds;
    return (t = n.call(this) || this).method = ee.PUT, t.path = "".concat(se, "/").concat(encodeURIComponent(r)), t.params = J($({
      cover_url: w$1("string", a) ? a : null,
      cover_file: k(a) ? a : null,
      name: u,
      data: l,
      custom_type: h,
      operators: f
    })), t;
  }

  return t$1(t, n), t;
}(Ne$2),
    be = function (n) {
  function t(e, t) {
    var r = n.call(this, e, t) || this;
    return r.channel = new Pe$1(e, t), r;
  }

  return t$1(t, n), t;
}(Te$2),
    Ne = function (n) {
  function t(e) {
    var t = this,
        r = e.channelUrl;
    return (t = n.call(this) || this).method = ee.DELETE, t.path = "".concat(se, "/").concat(encodeURIComponent(r)), t;
  }

  return t$1(t, n), t;
}(Ne$2);

!function (n) {
  function t(e, t) {
    return n.call(this, e, t) || this;
  }

  t$1(t, n);
}(Te$2);

var Pe$1 = function (r) {
  function s(e, n) {
    var t,
        a = this;
    return (a = r.call(this, e, n) || this)._lastParticipantCountUpdated = 0, a.participantCount = 0, a.operators = [], a.channelType = x.OPEN, a.participantCount = null !== (t = n.participant_count) && void 0 !== t ? t : 0, a.operators = Array.isArray(n.operators) ? n.operators.map(function (n) {
      return new Xi$1(e, n);
    }) : [], a;
  }

  return t$1(s, r), s.payloadify = function (e) {
    return J($(n$1(n$1({}, Er.payloadify(e)), {
      participant_count: e.participantCount,
      operators: e.operators.map(function (e) {
        return Xi$1.payloadify(e);
      })
    })));
  }, s.prototype.serialize = function () {
    return Zi$1(this);
  }, s.prototype.isOperator = function (e) {
    return e instanceof Xi$1 ? this.isOperator(e.userId) : this.operators.some(function (n) {
      return n.userId === e;
    });
  }, s.prototype._updateParticipantCount = function (e, n) {
    return n > this._lastParticipantCountUpdated && (this.participantCount = e, this._lastParticipantCountUpdated = n, !0);
  }, s.prototype.createParticipantListQuery = function (e) {
    return new Te(this._iid, this.url, e);
  }, s.prototype.refresh = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, me.of(this._iid).getChannelWithoutCache(this.url)];

          case 1:
            return [2, e.sent()];
        }
      });
    });
  }, s.prototype.enter = function () {
    return i$1(this, void 0, void 0, function () {
      var e, n, r, a, o, i;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, n = new Ce({
              channelUrl: this.url
            }), [4, e.send(n)];

          case 1:
            return r = t.sent(), a = r.as(ve), o = a.participantCount, i = a.ts, this._updateParticipantCount(o, i), me.of(this._iid).setEnteredToCache(this), [2];
        }
      });
    });
  }, s.prototype.exit = function () {
    return i$1(this, void 0, void 0, function () {
      var e, n, r, a, o, i;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, n = new _e({
              channelUrl: this.url
            }), [4, e.send(n)];

          case 1:
            return r = t.sent(), a = r.as(ye), o = a.participantCount, i = a.ts, this._updateParticipantCount(o, i), me.of(this._iid).setExitedToCache(this), Zi.of(this._iid).fileMessageQueue.cancel(this), [2];
        }
      });
    });
  }, s.prototype.updateChannel = function (e) {
    return i$1(this, void 0, void 0, function () {
      var n, r, s, u, c;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return n = n$1(n$1({}, ge), e), Qi$1(function (e) {
              return S$2("string", e.operatorUserIds, !0) && (w$1("string", e.coverUrlOrImage) || k(e.coverUrlOrImage) || null === e.coverUrlOrImage) && w$1("string", e.name, !0) && w$1("string", e.data, !0) && w$1("string", e.customType, !0);
            }(n)).throw(v$2.invalidParameters), r = _o.of(this._iid).requestQueue, s = new Me(n$1({
              channelUrl: this.url
            }, n)), [4, r.send(s)];

          case 1:
            return u = t.sent(), c = u.as(be).channel, this._update(c), [4, me.of(this._iid).upsertChannelsToCache([c])];

          case 2:
            return t.sent(), [2, this];
        }
      });
    });
  }, s.prototype.updateChannelWithOperatorUserIds = function (e, r, a, o, i) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (t) {
        return n = n$1(n$1({}, ge), {
          name: e,
          coverUrlOrImage: r,
          data: a,
          operatorUserIds: o,
          customType: i
        }), [2, this.updateChannel(n)];
      });
    });
  }, s.prototype.delete = function () {
    return i$1(this, void 0, void 0, function () {
      var e, n;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, n = new Ne({
              channelUrl: this.url
            }), [4, e.send(n)];

          case 1:
            return t.sent(), [4, me.of(this._iid).removeChannelsFromCache([this.url])];

          case 2:
            return t.sent(), [2];
        }
      });
    });
  }, s.prototype.sendUserMessage = function (e) {
    return Qi$1(!e.isPinnedMessage).throw(v$2.notSupportedError), r.prototype.sendUserMessage.call(this, e);
  }, s.prototype.sendFileMessage = function (e) {
    return Qi$1(!e.isPinnedMessage).throw(v$2.notSupportedError), r.prototype.sendFileMessage.call(this, e);
  }, s;
}(Er),
    De$1 = function (n) {
  function t(e) {
    void 0 === e && (e = {});
    var t = n.call(this) || this;
    return Object.keys(e).forEach(function (n) {
      t.hasOwnProperty(n) && (t[n] = e[n]);
    }), t;
  }

  return t$1(t, n), t;
}(function (n) {
  function t() {
    var e = null !== n && n.apply(this, arguments) || this;
    return e.onUserEntered = ze$2, e.onUserExited = ze$2, e.onChannelParticipantCountChanged = ze$2, e.onPollUpdated = ze$2, e.onPollVoted = ze$2, e.onPollDeleted = ze$2, e;
  }

  return t$1(t, n), t;
}(S)),
    Oe$1 = function (n) {
  function t(e) {
    var t = this,
        r = e.token,
        a = e.limit,
        o = e.nameKeyword,
        i = e.urlKeyword,
        u = e.customTypes,
        l = e.includeFrozen,
        h = e.includeMetaData;
    return (t = n.call(this) || this).method = ee.GET, t.path = se, t.params = J({
      token: r,
      limit: a,
      name_contains: o,
      url_contains: i,
      custom_types: u,
      show_frozen: l,
      show_metadata: h
    }), t;
  }

  return t$1(t, n), t;
}(Ne$2),
    He$1 = function (n) {
  function t(e, t) {
    var r = n.call(this, e, t) || this;
    r.channels = [];
    var a = t.next,
        o = t.channels,
        i = t.ts;
    return r.token = a, o && o.length > 0 && (r.channels = o.map(function (n) {
      return new Pe$1(e, n);
    })), r.ts = "number" == typeof i ? i : null, r;
  }

  return t$1(t, n), t;
}(Te$2),
    xe = function (r) {
  function i(e, n) {
    var t,
        a,
        o,
        i,
        s,
        u = this;
    return (u = r.call(this, e, n) || this).includeFrozen = !0, u.includeMetaData = !0, u.nameKeyword = null, u.urlKeyword = null, u.customTypes = null, u.includeFrozen = null === (t = n.includeFrozen) || void 0 === t || t, u.includeMetaData = null === (a = n.includeMetaData) || void 0 === a || a, u.nameKeyword = null !== (o = n.nameKeyword) && void 0 !== o ? o : null, u.urlKeyword = null !== (i = n.urlKeyword) && void 0 !== i ? i : null, u.customTypes = null !== (s = n.customTypes) && void 0 !== s ? s : null, u;
  }

  return t$1(i, r), i.prototype._validate = function () {
    return r.prototype._validate.call(this) && w$1("boolean", this.includeFrozen) && w$1("boolean", this.includeMetaData) && w$1("string", this.nameKeyword, !0) && w$1("string", this.urlKeyword, !0) && S$2("string", this.customTypes, !0);
  }, i.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, n, r, a, o, i;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 4] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, n = new Oe$1($(n$1(n$1({}, this), {
              token: this._token
            }))), [4, e.send(n)]) : [3, 3] : [3, 6];

          case 1:
            return r = t.sent(), a = r.as(He$1), o = a.channels, i = a.token, this._token = i, this._hasNext = !!i, [4, me.of(this._iid).upsertChannelsToCache(o)];

          case 2:
            return t.sent(), this._isLoading = !1, [2, o];

          case 3:
            return [2, []];

          case 4:
            throw v$2.queryInProgress;

          case 5:
            return [3, 7];

          case 6:
            throw v$2.invalidParameters;

          case 7:
            return [2];
        }
      });
    });
  }, i;
}(Oo),
    Ie$1 = function (r) {
  function a() {
    var e = null !== r && r.apply(this, arguments) || this;
    return e.name = "openChannel", e;
  }

  return t$1(a, r), a.prototype.init = function (e, n) {
    var t = n.sdkState,
        a = n.dispatcher,
        o = n.sessionManager,
        i = n.requestQueue,
        s = n.logger,
        u = n.onlineDetector,
        c = n.cacheContext;
    r.prototype.init.call(this, e, {
      sdkState: t,
      dispatcher: a,
      sessionManager: o,
      requestQueue: i,
      logger: s,
      onlineDetector: u,
      cacheContext: c
    }), this._manager = new me(e, {
      sdkState: t,
      dispatcher: a,
      requestQueue: i,
      logger: s,
      cacheContext: c,
      sessionManager: o
    });
  }, a.prototype.createOpenChannelListQuery = function (e) {
    return void 0 === e && (e = {}), new xe(this._iid, e);
  }, a.prototype.addOpenChannelHandler = function (e, n) {
    this._manager.addHandler(e, n);
  }, a.prototype.removeOpenChannelHandler = function (e) {
    this._manager.removeHandler(e);
  }, a.prototype.removeAllOpenChannelHandlers = function () {
    this._manager.clearHandler();
  }, a.prototype.buildOpenChannelFromSerializedData = function (e) {
    return this._manager.buildOpenChannelFromSerializedData(e);
  }, a.prototype.getChannel = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        return [2, this._manager.getChannel(e)];
      });
    });
  }, a.prototype.getChannelWithoutCache = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        return [2, this._manager.getChannelWithoutCache(e)];
      });
    });
  }, a.prototype.createChannel = function (e) {
    return void 0 === e && (e = {}), i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        return [2, this._manager.createChannel(e)];
      });
    });
  }, a.prototype.createChannelWithOperatorUserIds = function (e, r, a, o, i) {
    return i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (t) {
        return (n = n$1({}, he)).name = e, n.coverUrlOrImage = r, n.data = a, n.operatorUserIds = o, n.customType = i, [2, this._manager.createChannel(n)];
      });
    });
  }, a;
}(fo);

var Nt;
!function (e) {
  e.NONE = "none", e.JOINED = "joined", e.INVITED = "invited", e.LEFT = "left";
}(Nt || (Nt = {}));

var Ut,
    St,
    Tt,
    At,
    It,
    wt,
    Dt,
    Lt,
    Rt = function (i) {
  function o(e, t) {
    var n = i.call(this, e, t) || this;
    return n.state = null, n.role = null, n.isMuted = !1, n.isBlockedByMe = !1, n.isBlockingMe = !1, n.state = N$1(Nt, t.state) ? t.state : null, n.role = N$1(U$1, t.role) ? t.role : null, "boolean" == typeof t.is_muted && (n.isMuted = t.is_muted), "boolean" == typeof t.is_blocked_by_me && (n.isBlockedByMe = t.is_blocked_by_me), "boolean" == typeof t.is_blocking_me && (n.isBlockingMe = t.is_blocking_me), n;
  }

  return t$1(o, i), o.payloadify = function (e) {
    return J($(n$1(n$1({}, i.payloadify.call(this, e)), {
      state: e.state,
      role: e.role,
      is_muted: e.isMuted,
      is_blocked_by_me: e.isBlockedByMe,
      is_blocking_me: e.isBlockingMe
    })));
  }, o;
}(yt$1),
    Pt = function (t) {
  function n(e, n) {
    var s,
        r,
        a = this;
    return (a = t.call(this, e) || this).channelUrl = null !== (s = n.channel_url) && void 0 !== s ? s : "", a.channelType = null !== (r = n.channel_type) && void 0 !== r ? r : x.GROUP, a.reader = new Xi$1(a._iid, n.user), a.readAt = n.ts, a;
  }

  return t$1(n, t), n;
}(Fi$1);

!function (e) {
  e.ALL = "all", e.PUBLIC = "public", e.PRIVATE = "private";
}(Ut || (Ut = {})), function (e) {
  e.ALL = "all", e.JOINED = "joined_only", e.INVITED = "invited_only", e.INVITED_BY_FRIEND = "invited_by_friend", e.INVITED_BY_NON_FRIEND = "invited_by_non_friend";
}(St || (St = {})), function (e) {
  e.ALL = "all", e.SUPER = "super", e.NON_SUPER = "nonsuper", e.BROADCAST_ONLY = "broadcast_only", e.EXCLUSIVE_ONLY = "exclusive_only";
}(Tt || (Tt = {})), function (e) {
  e.ALL = "all", e.UNREAD_MESSAGE = "unread_message";
}(At || (At = {})), function (e) {
  e.ALL = "all", e.UNHIDDEN = "unhidden_only", e.HIDDEN = "hidden_only", e.HIDDEN_ALLOW_AUTO_UNHIDE = "hidden_allow_auto_unhide", e.HIDDEN_PREVENT_AUTO_UNHIDE = "hidden_prevent_auto_unhide";
}(It || (It = {})), function (e) {
  e.ALL = "all", e.OPERATOR = "operator", e.NONOPERATOR = "nonoperator";
}(wt || (wt = {})), function (e) {
  e.AND = "AND", e.OR = "OR";
}(Dt || (Dt = {})), function (e) {
  e.MEMBER_NICKNAME = "member_nickname", e.CHANNEL_NAME = "channel_name";
}(Lt || (Lt = {}));

var kt,
    Ot = function () {
  function e() {
    this._searchFilter = null, this._userIdsFilter = null, this.includeEmpty = !1, this.nicknameContainsFilter = null, this.nicknameStartsWithFilter = null, this.nicknameExactMatchFilter = null, this.channelNameContainsFilter = "", this.myMemberStateFilter = St.ALL, this.customTypesFilter = null, this.channelUrlsFilter = null, this.superChannelFilter = Tt.ALL, this.publicChannelFilter = Ut.ALL, this.customTypeStartsWithFilter = null, this.unreadChannelFilter = At.ALL, this.hiddenChannelFilter = It.UNHIDDEN, this.includeFrozen = !0;
  }

  return e.prototype._isFriend = function (e) {
    return !(!e || !e.friendDiscoveryKey && !e.friendName);
  }, Object.defineProperty(e.prototype, "searchFilter", {
    get: function () {
      return this._searchFilter;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.setSearchFilter = function (e, t) {
    Array.isArray(e) && 0 !== e.length && "string" == typeof t && t && (this._searchFilter = {
      query: t,
      fields: e
    });
  }, Object.defineProperty(e.prototype, "userIdsFilter", {
    get: function () {
      return this._userIdsFilter;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.setUserIdsFilter = function (e, t, n) {
    void 0 === n && (n = Dt.AND), this._userIdsFilter = {
      userIds: e,
      includeMode: t,
      queryType: n
    };
  }, e.prototype.clone = function () {
    var t,
        n = new e();
    this.searchFilter && n.setSearchFilter(this.searchFilter.fields, null !== (t = this.searchFilter.query) && void 0 !== t ? t : void 0), this.userIdsFilter && n.setUserIdsFilter(this.userIdsFilter.userIds, this.userIdsFilter.includeMode, this.userIdsFilter.queryType);
    var s = JSON.parse(JSON.stringify(this));
    return Object.keys(s).forEach(function (e) {
      n[e] = s[e];
    }), n;
  }, e.prototype.match = function (e, t) {
    if (this._searchFilter) {
      var n = this._searchFilter,
          s = n.query,
          r = n.fields;
      if (s && r && r.length > 0 && !r.some(function (t) {
        switch (t) {
          case Lt.CHANNEL_NAME:
            return e.name.toLowerCase().includes(s.toLowerCase());

          case Lt.MEMBER_NICKNAME:
            return e.members.some(function (e) {
              return e.nickname.toLowerCase().includes(s.toLowerCase());
            });

          default:
            return !0;
        }
      })) return !1;
    }

    if (this._userIdsFilter) {
      var a = this._userIdsFilter,
          i = a.userIds,
          o = a.includeMode,
          u = a.queryType,
          l = e.members.map(function (e) {
        return e.userId;
      });

      if (o) {
        if (i.length > 0) switch (u) {
          case Dt.AND:
            if (i.some(function (e) {
              return !l.includes(e);
            })) return !1;
            break;

          case Dt.OR:
            if (i.every(function (e) {
              return !l.includes(e);
            })) return !1;
        }
      } else {
        if (i.includes(t) || i.push(t), e.members.length > i.length) return !1;
        if (!O$1(i, l)) return !1;
      }
    }

    if (!this.includeEmpty && !e.lastMessage) return !1;
    if (!this.includeFrozen && e.isFrozen) return !1;
    if (this.customTypesFilter && this.customTypesFilter.length > 0 && !this.customTypesFilter.includes(e.customType)) return !1;
    if (this.customTypeStartsWithFilter && !new RegExp("^".concat(this.customTypeStartsWithFilter)).test(e.customType)) return !1;
    if (this.channelNameContainsFilter && !e.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase())) return !1;

    if (this.nicknameContainsFilter) {
      var h = this.nicknameContainsFilter.toLowerCase();
      if (!e.members.some(function (e) {
        return e.userId !== t && e.nickname.toLowerCase().includes(h);
      })) return !1;
    }

    if (this.nicknameStartsWithFilter) {
      var d = this.nicknameStartsWithFilter.toLowerCase();
      if (!e.members.some(function (e) {
        return e.userId !== t && e.nickname.toLowerCase().startsWith(d);
      })) return !1;
    }

    if (this.nicknameExactMatchFilter) {
      var _ = this.nicknameExactMatchFilter.toLowerCase();

      if (!e.members.some(function (e) {
        return e.userId !== t && e.nickname.toLowerCase() != _;
      })) return !1;
    }

    if (this.channelUrlsFilter && this.channelUrlsFilter.length > 0 && !this.channelUrlsFilter.includes(e.url)) return !1;
    if (this.myMemberStateFilter) switch (this.myMemberStateFilter) {
      case St.JOINED:
        if ("joined" !== e.myMemberState) return !1;
        break;

      case St.INVITED:
        if ("invited" !== e.myMemberState) return !1;
        break;

      case St.INVITED_BY_FRIEND:
        if ("invited" !== e.myMemberState || !this._isFriend(e.inviter)) return !1;
        break;

      case St.INVITED_BY_NON_FRIEND:
        if ("invited" !== e.myMemberState || this._isFriend(e.inviter)) return !1;
    }
    if (this.hiddenChannelFilter) switch (this.hiddenChannelFilter) {
      case It.UNHIDDEN:
        if (e.isHidden || "unhidden" !== e.hiddenState) return !1;
        break;

      case It.HIDDEN:
        if (!e.isHidden) return !1;
        break;

      case It.HIDDEN_ALLOW_AUTO_UNHIDE:
        if (!e.isHidden || "hidden_allow_auto_unhide" !== e.hiddenState) return !1;
        break;

      case It.HIDDEN_PREVENT_AUTO_UNHIDE:
        if (!e.isHidden || "hidden_prevent_auto_unhide" !== e.hiddenState) return !1;
    }
    if (this.unreadChannelFilter && this.unreadChannelFilter === At.UNREAD_MESSAGE) if (0 === e.unreadMessageCount) return !1;
    if (this.publicChannelFilter) switch (this.publicChannelFilter) {
      case Ut.PUBLIC:
        if (!e.isPublic) return !1;
        break;

      case Ut.PRIVATE:
        if (e.isPublic) return !1;
    }
    if (this.superChannelFilter) switch (this.superChannelFilter) {
      case Tt.SUPER:
        if (!e.isSuper) return !1;
        break;

      case Tt.NON_SUPER:
        if (e.isSuper) return !1;
    }
    return !0;
  }, e;
}(),
    Ft = function (t) {
  function n(e, n) {
    var s = n.sdkState,
        r = n.cacheContext,
        a = t.call(this, e) || this;
    return a._channels = new Map(), a._sdkState = s, a._cacheContext = r, a;
  }

  return t$1(n, t), Object.defineProperty(n.prototype, "collection", {
    get: function () {
      var e = this._cacheContext.nestdb;
      return Qi$1(!!e).throw(v$2.databaseError), e.collection(ur);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "localCacheEnabled", {
    get: function () {
      return this._cacheContext.localCacheEnabled && !!this.collection;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype._serialize = function (e, t) {
    return void 0 === t && (t = 0), n$1(n$1({}, e.serialize()), {
      lastMessageUpdatedAt: e.lastMessage ? e.lastMessage.createdAt : 0,
      syncIndex: t
    });
  }, n.prototype._deserialize = function (e) {
    return Yn.of(this._iid).buildGroupChannelFromSerializedData(e);
  }, Object.defineProperty(n.prototype, "channels", {
    get: function () {
      return c$1([], a$1(this._channels.values()), !1);
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype.isCachedInMemory = function (e) {
    return this._channels.has(e);
  }, n.prototype.filterOffsetChanged = function (e) {
    var t = this;
    return e.filter(function (e) {
      if (t._channels.has(e.url)) return t._channels.get(e.url).messageOffsetTimestamp < e.messageOffsetTimestamp;
    });
  }, n.prototype.get = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return this._channels.has(e) ? [3, 3] : this.localCacheEnabled ? [4, this.collection.getByKey(e)] : [3, 2];

          case 1:
            if (t = s.sent()) return n = this._deserialize(t), this._channels.set(e, n), [2, n];
            s.label = 2;

          case 2:
            return [2, void 0];

          case 3:
            return [2, this._channels.get(e)];
        }
      });
    });
  }, n.prototype.fetch = function (e) {
    var t = e.token,
        n = e.limit,
        s = void 0 === n ? or : n,
        r = e.backward,
        a = void 0 !== r && r,
        i = e.filter,
        o = void 0 === i ? new Ot() : i,
        u = e.order,
        c = void 0 === u ? g$1.LATEST_LAST_MESSAGE : u,
        l = e.borderlineChannelUrl;
    return i$1(this, void 0, void 0, function () {
      var e,
          n,
          r,
          i,
          u = this;
      return o$1(this, function (h) {
        switch (h.label) {
          case 0:
            return this.localCacheEnabled ? (e = C(c), n = {
              where: function (e) {
                if (t) switch (c) {
                  case g$1.CHANNEL_NAME_ALPHABETICAL:
                    if (!a && e.name.localeCompare(t) < 0 || a && e.name.localeCompare(t) > 0) return !1;
                    if (l && l === e.url) return !1;
                    break;

                  case g$1.CHRONOLOGICAL:
                    if (!a && e.createdAt > t || a && e.createdAt < t) return !1;
                    if (l && l === e.url) return !1;
                    break;

                  case g$1.LATEST_LAST_MESSAGE:
                    if (!a && e.lastMessageUpdatedAt > t || a && e.lastMessageUpdatedAt < t) return !1;
                    if (l && l === e.url) return !1;
                }
                return o.match(u._deserialize(e), u._sdkState.userId);
              },
              index: e,
              backward: a
            }, [4, this.collection.query(n)]) : [3, 3];

          case 1:
            return [4, h.sent().fetch({
              limit: s
            })];

          case 2:
            return r = h.sent(), (i = r.map(function (e) {
              return u._deserialize(e);
            })).forEach(function (e) {
              u._channels.has(e.url) || u._channels.set(e.url, e);
            }), [2, i];

          case 3:
            return [2, []];
        }
      });
    });
  }, n.prototype.upsert = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n,
          s,
          r,
          a = this;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            if (n = [], e.forEach(function (e) {
              if (a._channels.has(e.url)) {
                var s = a._channels.get(e.url);

                s._pinnedMessagesUpdatedAt < e._pinnedMessagesUpdatedAt && (s._pinnedMessagesUpdatedAt = e._pinnedMessagesUpdatedAt), e.cachedMetaData && t && (s._updateCachedMetaData(e.cachedMetaData, t), Object.assign(e, {
                  _cachedMetaData: void 0
                })), s._update(e), n.push(s);
              } else a._channels.set(e.url, e), n.push(e);
            }), !this.localCacheEnabled) return [3, 2];

            for (r in s = [], n) s.push(this._serialize(n[r], parseInt(r)));

            return [4, this.collection.upsertMany(s)];

          case 1:
            i.sent(), i.label = 2;

          case 2:
            return [2, n];
        }
      });
    });
  }, n.prototype.remove = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, s, r, a, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            o.trys.push([0, 5, 6, 7]), t = s$2(e), n = t.next(), o.label = 1;

          case 1:
            return n.done ? [3, 4] : (s = n.value, this._channels.delete(s), this.localCacheEnabled ? [4, this.collection.remove(s)] : [3, 3]);

          case 2:
            o.sent(), o.label = 3;

          case 3:
            return n = t.next(), [3, 1];

          case 4:
            return [3, 7];

          case 5:
            return r = o.sent(), a = {
              error: r
            }, [3, 7];

          case 6:
            try {
              n && !n.done && (i = t.return) && i.call(t);
            } finally {
              if (a) throw a.error;
            }

            return [7];

          case 7:
            return [2];
        }
      });
    });
  }, n.prototype.clear = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this.clearMemoryCache(), this.localCacheEnabled ? [4, this.collection.clear()] : [3, 2];

          case 1:
            e.sent(), e.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.clearMemoryCache = function () {
    this._channels.clear();
  }, n.prototype._setBlockStateOfAllChannels = function (e, t, n) {
    return i$1(this, void 0, void 0, function () {
      var s, r, a, i, o, u, c, l, h, d, _, p, v, g, E, C, y, M, b;

      return o$1(this, function (f) {
        switch (f.label) {
          case 0:
            if (s = [], e === this._sdkState.userId) try {
              for (r = s$2(this._channels.values()), a = r.next(); !a.done; a = r.next()) {
                l = a.value;

                try {
                  for (g = void 0, i = s$2(l.members), o = i.next(); !o.done; o = i.next()) if ((_ = o.value).userId === t) {
                    _.isBlockedByMe = n, s.push(l);
                    break;
                  }
                } catch (e) {
                  g = {
                    error: e
                  };
                } finally {
                  try {
                    o && !o.done && (E = i.return) && E.call(i);
                  } finally {
                    if (g) throw g.error;
                  }
                }
              }
            } catch (e) {
              p = {
                error: e
              };
            } finally {
              try {
                a && !a.done && (v = r.return) && v.call(r);
              } finally {
                if (p) throw p.error;
              }
            } else if (t === this._sdkState.userId) try {
              for (u = s$2(this._channels.values()), c = u.next(); !c.done; c = u.next()) {
                l = c.value;

                try {
                  for (M = void 0, h = s$2(l.members), d = h.next(); !d.done; d = h.next()) if ((_ = d.value).userId === e) {
                    _.isBlockingMe = n, s.push(l);
                    break;
                  }
                } catch (e) {
                  M = {
                    error: e
                  };
                } finally {
                  try {
                    d && !d.done && (b = h.return) && b.call(h);
                  } finally {
                    if (M) throw M.error;
                  }
                }
              }
            } catch (e) {
              C = {
                error: e
              };
            } finally {
              try {
                c && !c.done && (y = u.return) && y.call(u);
              } finally {
                if (C) throw C.error;
              }
            }
            return s.length > 0 ? [4, this.upsert(s)] : [3, 2];

          case 1:
            f.sent(), f.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, n.prototype.block = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._setBlockStateOfAllChannels(e, t, !0)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.unblock = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._setBlockStateOfAllChannels(e, t, !1)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, n.prototype.markAsRead = function (e, t) {
    return void 0 === t && (t = c$1([], a$1(this._channels.keys()), !1)), i$1(this, void 0, void 0, function () {
      var n, s, r, a, i, o, u, c;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            n = [], l.label = 1;

          case 1:
            l.trys.push([1, 6, 7, 8]), s = s$2(t), r = s.next(), l.label = 2;

          case 2:
            return r.done ? [3, 5] : (a = r.value, [4, this.get(a)]);

          case 3:
            (null == (i = l.sent()) ? void 0 : i._updateUnreadMemberState(this._sdkState.userId, e)) && (i._updateUnreadCount(0, 0), n.push(i)), l.label = 4;

          case 4:
            return r = s.next(), [3, 2];

          case 5:
            return [3, 8];

          case 6:
            return o = l.sent(), u = {
              error: o
            }, [3, 8];

          case 7:
            try {
              r && !r.done && (c = s.return) && c.call(s);
            } finally {
              if (u) throw u.error;
            }

            return [7];

          case 8:
            return n.length > 0 ? [4, this.upsert(n)] : [3, 10];

          case 9:
            l.sent(), l.label = 10;

          case 10:
            return [2];
        }
      });
    });
  }, n;
}(Fi$1),
    xt = {
  invitedUserIds: void 0,
  channelUrl: void 0,
  coverUrl: void 0,
  coverImage: void 0,
  isDistinct: void 0,
  isSuper: void 0,
  isBroadcast: void 0,
  isExclusive: void 0,
  isPublic: void 0,
  isDiscoverable: void 0,
  isStrict: void 0,
  isEphemeral: void 0,
  accessCode: void 0,
  name: void 0,
  data: void 0,
  customType: void 0,
  operatorUserIds: void 0,
  messageSurvivalSeconds: void 0
},
    Ht = function (e) {
  return S$2("string", e.invitedUserIds, !0) && w$1("string", e.channelUrl, !0) && w$1("string", e.coverUrl, !0) && (k(e.coverImage) || w$1("string", e.coverImage, !0)) && w$1("boolean", e.isDistinct, !0) && w$1("boolean", e.isSuper, !0) && w$1("boolean", e.isBroadcast, !0) && w$1("boolean", e.isExclusive, !0) && w$1("boolean", e.isPublic, !0) && w$1("boolean", e.isStrict, !0) && w$1("boolean", e.isDiscoverable, !0) && w$1("boolean", e.isEphemeral, !0) && w$1("string", e.accessCode, !0) && w$1("string", e.name, !0) && w$1("string", e.data, !0) && w$1("string", e.customType, !0) && S$2("string", e.operatorUserIds, !0) && w$1("number", e.messageSurvivalSeconds, !0);
},
    Gt = {
  customTypes: void 0,
  includeEmpty: !1,
  includeFrozen: !0,
  includeChatNotification: !1
},
    Vt = function (e) {
  return S$2("string", e.customTypes, !0) && w$1("boolean", e.includeEmpty) && w$1("boolean", e.includeFrozen) && w$1("boolean", e.includeChatNotification);
},
    Bt = {
  myMemberStateFilter: St.ALL
},
    qt = function (e) {
  return N$1(St, e.myMemberStateFilter);
};

!function (e) {
  e.GROUP_CHANNEL_UNREAD_MENTION_COUNT = "group_channel_unread_mention_count", e.NONSUPER_UNREAD_MENTION_COUNT = "non_super_group_channel_unread_mention_count", e.SUPER_UNREAD_MENTION_COUNT = "super_group_channel_unread_mention_count", e.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT = "group_channel_unread_message_count", e.NONSUPER_UNREAD_MESSAGE_COUNT = "non_super_group_channel_unread_message_count", e.SUPER_UNREAD_MESSAGE_COUNT = "super_group_channel_unread_message_count", e.GROUP_CHANNEL_INVITATION_COUNT = "group_channel_invitation_count", e.NONSUPER_INVITATION_COUNT = "non_super_group_channel_invitation_count", e.SUPER_INVITATION_COUNT = "super_group_channel_invitation_count";
}(kt || (kt = {}));

var Wt = {
  keys: []
},
    jt = {
  channelCustomTypesFilter: void 0,
  superChannelFilter: Tt.ALL
},
    zt = function (e) {
  return S$2("string", e.channelCustomTypesFilter, !0) && N$1(Tt, e.superChannelFilter);
},
    Qt = {
  channelUrl: void 0,
  scheduledStatus: void 0,
  messageTypeFilter: z.ALL
};
    n$1({}, po);
    var Kt = function (e) {
  return e.startsWith("EVENT_") || e === po.SYNC_CHANNEL_CHANGELOGS || e === po.REFRESH_CHANNEL;
},
    Jt = function (t) {
  function n(e) {
    var n = e.channels,
        s = e.source,
        r = e.isWebSocketEventComing,
        a = void 0 !== r && r,
        i = e.data,
        o = void 0 === i ? null : i,
        u = e.ts,
        c = t.call(this) || this;
    return c.channels = n, c.source = s, c.isWebSocketEventComing = a, c.data = o, c.ts = u, c;
  }

  return t$1(n, t), n;
}(X),
    Xt = function (t) {
  function n(e) {
    var n = e.channelUrls,
        s = e.source,
        r = e.isWebSocketEventComing,
        a = void 0 !== r && r,
        i = t.call(this) || this;
    return i.channelUrls = n, i.source = s, i.isWebSocketEventComing = a, i;
  }

  return t$1(n, t), n;
}(X),
    Zt = function () {
  function e(e) {
    var t = e.groupChannelCache,
        n = e.messageCache,
        s = e.unsentMessageCache,
        r = e.dispatcher,
        a = this;
    this._observers = new Map(), r.on(function (e) {
      return i$1(a, void 0, void 0, function () {
        var r,
            a,
            i,
            o,
            u,
            c,
            l,
            h,
            d,
            _,
            v,
            g,
            E,
            C,
            y = this;

        return o$1(this, function (M) {
          switch (M.label) {
            case 0:
              if (!(e instanceof Jt)) return [3, 10];
              r = e.channels, v = e.source, g = e.isWebSocketEventComing, a = e.data, i = r.filter(function (e) {
                return e instanceof sr;
              }), o = t.filterOffsetChanged(i), M.label = 1;

            case 1:
              M.trys.push([1, 6, 7, 8]), u = s$2(o), c = u.next(), M.label = 2;

            case 2:
              return c.done ? [3, 5] : (l = c.value, [4, n.removeUnderOffset(l.url, l.messageOffsetTimestamp)]);

            case 3:
              M.sent(), M.label = 4;

            case 4:
              return c = u.next(), [3, 2];

            case 5:
              return [3, 8];

            case 6:
              return h = M.sent(), E = {
                error: h
              }, [3, 8];

            case 7:
              try {
                c && !c.done && (C = u.return) && C.call(u);
              } finally {
                if (E) throw E.error;
              }

              return [7];

            case 8:
              return [4, t.upsert(i, e.ts)];

            case 9:
              return d = M.sent(), g || this._broadcastUpdateEvent(d, v, a), [3, 15];

            case 10:
              return e instanceof Xt ? (_ = e.channelUrls, v = e.source, g = e.isWebSocketEventComing, [4, t.remove(_)]) : [3, 13];

            case 11:
              return M.sent(), [4, mi$1(function () {
                return i$1(y, void 0, void 0, function () {
                  var e, t, r, a, i, o;
                  return o$1(this, function (u) {
                    switch (u.label) {
                      case 0:
                        u.trys.push([0, 6, 7, 8]), e = s$2(_), t = e.next(), u.label = 1;

                      case 1:
                        return t.done ? [3, 5] : (r = t.value, [4, n.removeMessagesOfChannel(r)]);

                      case 2:
                        return u.sent(), [4, s.removeMessagesOfChannel(r)];

                      case 3:
                        u.sent(), u.label = 4;

                      case 4:
                        return t = e.next(), [3, 1];

                      case 5:
                        return [3, 8];

                      case 6:
                        return a = u.sent(), i = {
                          error: a
                        }, [3, 8];

                      case 7:
                        try {
                          t && !t.done && (o = e.return) && o.call(e);
                        } finally {
                          if (i) throw i.error;
                        }

                        return [7];

                      case 8:
                        return [2];
                    }
                  });
                });
              })];

            case 12:
              return M.sent(), g || this._broadcastRemoveEvent(_, v), [3, 15];

            case 13:
              return e instanceof N ? [4, t.fetch({
                token: Number.MAX_SAFE_INTEGER,
                limit: Number.MAX_SAFE_INTEGER
              })] : [3, 15];

            case 14:
              M.sent(), M.label = 15;

            case 15:
              return [2];
          }
        });
      });
    });
  }

  return e.prototype._broadcastUpdateEvent = function (e, t, n) {
    var s, r;

    try {
      for (var a = s$2(this._observers.values()), i = a.next(); !i.done; i = a.next()) {
        var o = i.value;
        o.onUpdate && o.onUpdate(e, t, n);
      }
    } catch (e) {
      s = {
        error: e
      };
    } finally {
      try {
        i && !i.done && (r = a.return) && r.call(a);
      } finally {
        if (s) throw s.error;
      }
    }
  }, e.prototype._broadcastRemoveEvent = function (e, t) {
    var n, s;

    try {
      for (var r = s$2(this._observers.values()), a = r.next(); !a.done; a = r.next()) {
        var i = a.value;
        i.onRemove && i.onRemove(e, t);
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        a && !a.done && (s = r.return) && s.call(r);
      } finally {
        if (n) throw n.error;
      }
    }
  }, e.prototype.subscribe = function (e, t) {
    this._observers.set(e, t);
  }, e.prototype.unsubscribe = function (e) {
    this._observers.delete(e);
  }, e.prototype.unsubscribeAll = function () {
    this._observers.clear();
  }, e;
}(),
    $t = function (r) {
  function a(e) {
    var a = e.userId,
        i = e.ts,
        o = e.token,
        u = e.filter,
        c = e.includeChatNotification,
        l = void 0 !== c && c,
        h = r.call(this) || this,
        d = n$1(n$1({}, Gt), u),
        _ = d.customTypes,
        p = d.includeEmpty,
        f = d.includeFrozen;
    return h.method = ee.GET, h.path = "".concat(ne, "/").concat(encodeURIComponent(a), "/my_group_channels/changelogs"), h.params = J($({
      show_delivery_receipt: !0,
      show_member: !0,
      show_read_receipt: !0,
      change_ts: i || null,
      token: o,
      custom_types: _,
      show_empty: p,
      show_frozen: f,
      include_chat_notification: l
    })), h;
  }

  return t$1(a, r), a;
}(Ne$2),
    en = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.updatedChannels = n.updated.map(function (t) {
      return new sr(e, Object.assign(t, {
        ts: n.ts
      }));
    }), s.deletedChannelUrls = n.deleted, s.hasMore = n.has_more, s.token = n.next, s.ts = n.ts, s;
  }

  return t$1(n, t), n;
}(Te$2),
    tn = function (t) {
  function n(e) {
    var n = e.channelUrl,
        s = e.isInternalCall,
        r = t.call(this) || this;
    return r.method = ee.GET, r.path = "".concat(s ? oe : ie, "/").concat(encodeURIComponent(n)), r.params = {
      show_member: !0,
      show_read_receipt: !0,
      show_delivery_receipt: !0
    }, r;
  }

  return t$1(n, t), n;
}(Ne$2),
    nn = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.channel = new sr(e, n), s;
  }

  return t$1(n, t), n;
}(Te$2),
    sn = {
  includeEmpty: !1,
  includeFrozen: !0,
  includeMetaData: !0,
  includeChatNotification: !1,
  channelUrlsFilter: void 0,
  customTypesFilter: void 0,
  customTypeStartsWithFilter: void 0,
  nicknameContainsFilter: void 0,
  nicknameStartsWithFilter: void 0,
  nicknameExactMatchFilter: void 0,
  channelNameContainsFilter: void 0,
  myMemberStateFilter: St.ALL,
  unreadChannelFilter: At.ALL,
  superChannelFilter: Tt.ALL,
  publicChannelFilter: Ut.ALL,
  hiddenChannelFilter: It.ALL,
  userIdsFilter: {
    userIds: [],
    includeMode: !0,
    queryType: Dt.AND
  },
  searchFilter: {
    query: void 0,
    fields: []
  },
  metadataKey: void 0,
  metadataValues: void 0,
  metadataOrderKeyFilter: void 0,
  metadataValueStartsWith: void 0,
  order: g$1.LATEST_LAST_MESSAGE
},
    rn = function (n) {
  function s(e) {
    var s = this,
        r = e.userId,
        a = e.token,
        i = e.limit,
        o = e.order,
        u = e.includeEmpty,
        c = e.myMemberStateFilter,
        l = e.superChannelFilter,
        h = e.publicChannelFilter,
        d = e.unreadChannelFilter,
        _ = e.nicknameContainsFilter,
        p = e.nicknameStartsWithFilter,
        f = e.nicknameExactMatchFilter,
        m = e.channelNameContainsFilter,
        v = e.channelUrlsFilter,
        g = e.customTypesFilter,
        E = e.customTypeStartsWithFilter,
        C = e.hiddenChannelFilter,
        y = e.metadataOrderKeyFilter,
        M = e.metadataKey,
        b = e.metadataValues,
        S = e.metadataValueStartsWith,
        T = e.includeFrozen,
        A = e.includeMetaData,
        I = e.searchFilter,
        w = e.userIdsFilter,
        D = e.includeChatNotification,
        L = void 0 !== D && D;
    return (s = n.call(this) || this).method = ee.GET, s.path = "".concat(ne, "/").concat(encodeURIComponent(r), "/my_group_channels"), s.params = J({
      token: a,
      limit: i,
      order: null != o ? o : sn.order,
      show_member: !0,
      show_read_receipt: !0,
      show_delivery_receipt: !0,
      show_empty: null != u ? u : sn.includeEmpty,
      member_state_filter: null != c ? c : sn.myMemberStateFilter,
      super_mode: null != l ? l : sn.superChannelFilter,
      public_mode: null != h ? h : sn.publicChannelFilter,
      unread_filter: null != d ? d : sn.unreadChannelFilter,
      members_nickname_contains: _,
      members_nickname_startswith: p,
      members_nickname: f,
      name_contains: m,
      channel_urls: v,
      custom_types: g,
      custom_type_startswith: E,
      hidden_mode: C,
      metadata_order_key: y,
      metadata_key: M,
      metadata_values: b,
      metadata_value_startswith: S,
      show_frozen: T,
      show_metadata: A,
      include_chat_notification: L
    }), I && I.query && I.fields && (s.params.search_query = I.query, s.params.search_fields = I.fields), w && w.userIds && w.userIds.length > 0 && (w.includeMode ? (s.params.members_include_in = w.userIds, s.params.query_type = w.queryType.toUpperCase()) : s.params.members_exactly_in = w.userIds), s;
  }

  return t$1(s, n), s;
}(Ne$2),
    an = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    s.channels = [];
    var r = n.next,
        a = n.channels,
        i = n.ts;
    return s.token = r, a && a.length > 0 && (s.channels = a.map(function (t) {
      return t.ts = i, new sr(e, t);
    })), s.ts = null != i ? i : 0, s;
  }

  return t$1(n, t), n;
}(Te$2),
    on = function (t) {
  function n(e) {
    var n = e.userId,
        s = e.filter,
        r = t.call(this) || this,
        a = s.myMemberStateFilter;
    return r.method = ee.GET, r.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/group_channel_count"), r.params = {
      state: null != a ? a : St.ALL
    }, r;
  }

  return t$1(n, t), n;
}(Ne$2),
    un = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.groupChannelCount = n.group_channel_count, s;
  }

  return t$1(n, t), n;
}(Te$2),
    cn = function (n) {
  function s(e) {
    var s = e.userId,
        r = e.filter,
        a = n.call(this) || this,
        i = r.keys;
    return a.method = ee.GET, a.path = "".concat(ne, "/").concat(encodeURIComponent(s), "/unread_item_count"), a.params = J({
      item_keys: i
    }), a;
  }

  return t$1(s, n), s;
}(Ne$2),
    ln = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return "number" == typeof n[kt.GROUP_CHANNEL_UNREAD_MENTION_COUNT] && (s.groupChannelUnreadMentionCount = n[kt.GROUP_CHANNEL_UNREAD_MENTION_COUNT]), "number" == typeof n[kt.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT] && (s.groupChannelUnreadMessageCount = n[kt.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]), "number" == typeof n[kt.GROUP_CHANNEL_INVITATION_COUNT] && (s.groupChannelInvitationCount = n[kt.GROUP_CHANNEL_INVITATION_COUNT]), "number" == typeof n[kt.SUPER_UNREAD_MENTION_COUNT] && (s.superGroupChannelUnreadMentionCount = n[kt.SUPER_UNREAD_MENTION_COUNT]), "number" == typeof n[kt.SUPER_UNREAD_MESSAGE_COUNT] && (s.superGroupChannelUnreadMessageCount = n[kt.SUPER_UNREAD_MESSAGE_COUNT]), "number" == typeof n[kt.SUPER_INVITATION_COUNT] && (s.superGroupChannelInvitationCount = n[kt.SUPER_INVITATION_COUNT]), "number" == typeof n[kt.NONSUPER_UNREAD_MENTION_COUNT] && (s.nonSuperGroupChannelUnreadMentionCount = n[kt.NONSUPER_UNREAD_MENTION_COUNT]), "number" == typeof n[kt.NONSUPER_UNREAD_MESSAGE_COUNT] && (s.nonSuperGroupChannelUnreadMessageCount = n[kt.NONSUPER_UNREAD_MESSAGE_COUNT]), "number" == typeof n[kt.NONSUPER_INVITATION_COUNT] && (s.nonSuperGroupChannelInvitationCount = n[kt.NONSUPER_INVITATION_COUNT]), s;
  }

  return t$1(n, t), n;
}(Te$2),
    hn = function (t) {
  function n(e) {
    var n = e.userId,
        s = t.call(this) || this;
    return s.method = ee.GET, s.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/unread_channel_count"), s;
  }

  return t$1(n, t), n;
}(Ne$2),
    dn = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.unreadCount = n.unread_count, s;
  }

  return t$1(n, t), n;
}(Te$2),
    _n = function (t) {
  function n(e) {
    var n = e.userId,
        s = e.filter,
        r = e.includeFeedChannel,
        a = void 0 !== r && r,
        i = t.call(this) || this,
        o = s.channelCustomTypesFilter,
        u = s.superChannelFilter;
    return i.method = ee.GET, i.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/unread_message_count"), i.params = {
      super_mode: null != u ? u : Tt.ALL,
      custom_types: o,
      include_feed_channel: a
    }, i;
  }

  return t$1(n, t), n;
}(Ne$2),
    pn = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.unreadCount = n.unread_count, s.unreadFeedCount = n.unread_feed_count, s;
  }

  return t$1(n, t), n;
}(Te$2),
    fn = function (t) {
  function n(e) {
    var n = e.channelUrl,
        s = e.scheduledStatus,
        r = e.messageTypeFilter,
        a = t.call(this) || this;
    return a.method = ee.GET, a.path = "".concat(_e$1, "/count"), a.params = {
      channel_url: n,
      status: vn(s)
    }, r && (a.params.message_type = r), a;
  }

  return t$1(n, t), n;
}(Ne$2),
    mn = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.count = n.count, s;
  }

  return t$1(n, t), n;
}(Te$2),
    vn = function (e) {
  if (!e) return [];
  var t = [];
  return e.forEach(function (e) {
    switch (e) {
      case Se.PENDING:
        t.push(Ae.PENDING);
        break;

      case Se.SENT:
        t.push(Ae.IN_QUEUE), t.push(Ae.SENT);
        break;

      case Se.CANCELED:
        t.push(Ae.CANCELED);
        break;

      case Se.FAILED:
        t.push(Ae.FAILED);
    }
  }), t;
},
    gn = function (n) {
  function s(e) {
    var s = this,
        r = e.userId,
        a = e.channelUrl,
        i = e.coverUrl,
        o = e.coverImage,
        u = e.isDistinct,
        c = e.isSuper,
        l = e.isBroadcast,
        h = e.isPublic,
        p = e.isExclusive,
        f = e.isDiscoverable,
        m = e.isStrict,
        v = e.isEphemeral,
        g = e.accessCode,
        E = e.name,
        C = e.data,
        y = e.customType,
        M = e.messageSurvivalSeconds,
        b = e.invitedUserIds,
        U = e.operatorUserIds;
    return (s = n.call(this) || this).method = ee.POST, s.path = ie, s.params = J({
      user_ids: c$1([r], a$1(null != b ? b : []), !1).filter(function (e, t, n) {
        return t === n.indexOf(e);
      }),
      channel_url: a,
      cover_url: i,
      cover_file: o,
      is_distinct: u,
      is_super: c,
      is_broadcast: l,
      is_exclusive: p,
      is_public: h,
      is_discoverable: f,
      strict: m,
      is_ephemeral: v,
      access_code: g,
      name: E,
      data: C,
      custom_type: y,
      operator_ids: U,
      message_survival_seconds: M
    }), s;
  }

  return t$1(s, n), s;
}(Ne$2),
    En = function (t) {
  function n(e, n) {
    var s,
        r = this;
    return (r = t.call(this, e, n) || this).channel = new sr(e, n), r.isCreated = null === (s = n.is_created) || void 0 === s || s, r;
  }

  return t$1(n, t), n;
}(Te$2),
    Cn = function (t) {
  function n(e) {
    var n = e.userId,
        s = e.channelUrls,
        r = t.call(this) || this;
    return r.method = ee.PUT, r.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/mark_as_read_all"), r.params = {
      channel_urls: s
    }, r;
  }

  return t$1(n, t), n;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var yn = function (t) {
  function n(e) {
    var n = this,
        s = e.channelUrl,
        r = e.userId,
        a = e.accessCode;
    return (n = t.call(this) || this).method = ee.PUT, n.path = "".concat(ie, "/").concat(encodeURIComponent(s), "/join"), n.params = {
      user_id: r,
      access_code: a
    }, n;
  }

  return t$1(n, t), n;
}(Ne$2),
    Mn = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.channel = new sr(e, n), s;
  }

  return t$1(n, t), n;
}(Te$2),
    bn = function (t) {
  function n(e, n, s) {
    var r = t.call(this, e, n, s) || this,
        a = s.data,
        i = a.member_count,
        o = void 0 === i ? 0 : i,
        u = a.joined_member_count,
        c = void 0 === u ? 0 : u,
        l = a.users,
        h = void 0 === l ? null : l;
    return r.memberCount = o, r.joinedMemberCount = c, r.members = Array.isArray(h) ? h.map(function (t) {
      return new Rt(e, t);
    }) : [new Rt(e, s.data)], r;
  }

  return t$1(n, t), n;
}(T$1),
    Nn = function (t) {
  function n(e) {
    var n = this,
        s = e.channelUrl,
        r = e.userId,
        a = e.shouldRemoveOperatorStatus;
    return (n = t.call(this) || this).method = ee.PUT, n.path = "".concat(ie, "/").concat(encodeURIComponent(s), "/leave"), n.params = {
      user_id: r,
      should_remove_operator_status: a
    }, n;
  }

  return t$1(n, t), n;
}(Ne$2);

!function (t) {
  function n(e, n) {
    return t.call(this, e, n) || this;
  }

  t$1(n, t);
}(Te$2);

var Un = function (t) {
  function n(e, n, s) {
    var r = t.call(this, e, n, s) || this,
        a = s.data,
        i = a.member_count,
        o = void 0 === i ? 0 : i,
        u = a.joined_member_count,
        c = void 0 === u ? 0 : u;
    return r.memberCount = o, r.joinedMemberCount = c, r.member = new Rt(r._iid, s.data), r;
  }

  return t$1(n, t), n;
}(T$1),
    Sn = function (t) {
  function n(e) {
    var n = this,
        s = e.channelUrl,
        r = e.userIds;
    return (n = t.call(this) || this).method = ee.POST, n.path = "".concat(ie, "/").concat(encodeURIComponent(s), "/invite"), n.params = {
      user_ids: r
    }, n;
  }

  return t$1(n, t), n;
}(Ne$2),
    Tn = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.channel = new sr(e, n), s;
  }

  return t$1(n, t), n;
}(Te$2),
    An = function (t) {
  function n(e, n, s) {
    var r = t.call(this, e, n, s) || this;
    r.inviter = null;

    var a = s.data,
        i = a.member_count,
        u = void 0 === i ? 0 : i,
        c = a.joined_member_count,
        l = void 0 === c ? 0 : c,
        h = a.inviter,
        d = a.invitees,
        _ = void 0 === d ? [] : d;

    return r.memberCount = u, r.joinedMemberCount = l, h && Object.keys(h).length > 0 && (r.inviter = new Xi$1(e, h)), r.invitees = _.map(function (t) {
      return new Rt(e, t);
    }), r;
  }

  return t$1(n, t), n;
}(T$1),
    In = function (t) {
  function n(e) {
    var n = this,
        s = e.channelUrl,
        r = e.userId;
    return (n = t.call(this) || this).method = ee.PUT, n.path = "".concat(ie, "/").concat(encodeURIComponent(s), "/decline"), n.params = {
      user_id: r
    }, n;
  }

  return t$1(n, t), n;
}(Ne$2);

!function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.channel = new sr(e, n), s.channel.myMemberState = Nt.NONE, s;
  }

  t$1(n, t);
}(Te$2);

var wn = function (t) {
  function n(e, n, s) {
    var r = t.call(this, e, n, s) || this,
        a = s.data,
        i = a.member_count,
        u = a.joined_member_count,
        c = a.inviter,
        l = a.invitee;
    return r.memberCount = null != i ? i : 0, r.joinedMemberCount = null != u ? u : 0, r.inviter = new Xi$1(e, c), r.invitee = new Rt(e, l), r;
  }

  return t$1(n, t), n;
}(T$1),
    Dn = {
  hidePreviousMessages: !1,
  allowAutoUnhide: !0
},
    Ln = function (t) {
  function n(e) {
    var n = this,
        s = e.channelUrl,
        r = e.userId,
        a = e.hidePreviousMessages,
        i = e.allowAutoUnhide;
    return (n = t.call(this) || this).method = ee.PUT, n.path = "".concat(ie, "/").concat(encodeURIComponent(s), "/hide"), n.params = {
      user_id: r,
      hide_previous_messages: null != a ? a : Dn.hidePreviousMessages,
      allow_auto_unhide: null != i ? i : Dn.allowAutoUnhide
    }, n;
  }

  return t$1(n, t), n;
}(Ne$2),
    Rn = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this,
        r = n.ts_message_offset;
    return s.messageOffsetTimestamp = r, s;
  }

  return t$1(n, t), n;
}(Te$2),
    Pn = function (t) {
  function n(e, n, s) {
    var r,
        a,
        i,
        o = this;
    return (o = t.call(this, e, "SYEV", s) || this).allowAutoUnhide = null, o.hidePreviousMessages = null, o.messageOffsetTimestamp = null, s.data && (o.allowAutoUnhide = null !== (r = s.data.allow_auto_unhide) && void 0 !== r ? r : null, o.hidePreviousMessages = null !== (a = s.data.hide_previous_messages) && void 0 !== a ? a : null), o.messageOffsetTimestamp = null !== (i = s.ts_message_offset) && void 0 !== i ? i : null, o;
  }

  return t$1(n, t), n;
}(Pe$3),
    kn = function (t) {
  function n(e) {
    var n = e.channelUrl,
        s = e.time;
    return t.call(this, {
      code: "TPST",
      ackRequired: !1,
      payload: {
        channel_url: n,
        time: s
      }
    }) || this;
  }

  return t$1(n, t), n;
}(ri$1),
    On = function (t) {
  function n(e, n, s) {
    var r = t.call(this, e, "SYEV", s) || this;
    return r.user = new Xi$1(e, s.data), r;
  }

  return t$1(n, t), n;
}(Pe$3),
    Fn = function (t) {
  function n(e) {
    var n = e.channelUrl,
        s = e.time;
    return t.call(this, {
      code: "TPEN",
      ackRequired: !1,
      payload: {
        channel_url: n,
        time: s
      }
    }) || this;
  }

  return t$1(n, t), n;
}(ri$1),
    xn = function (t) {
  function n(e, n, s) {
    var r = t.call(this, e, "SYEV", s) || this;
    return r.user = new Xi$1(e, s.data), r;
  }

  return t$1(n, t), n;
}(Pe$3),
    Hn = function (t) {
  function n(e) {
    var n = e.channelUrl,
        s = e.messageId;
    return t.call(this, {
      code: "MACK",
      ackRequired: !1,
      payload: {
        channel_url: n,
        msg_id: s
      }
    }) || this;
  }

  return t$1(n, t), n;
}(ri$1),
    Gn = function (t) {
  function a(e, n) {
    var s,
        r,
        a,
        i,
        o,
        u,
        c,
        l,
        h,
        d,
        _,
        p,
        f,
        m,
        v,
        g,
        E,
        C,
        y,
        M,
        b,
        N,
        U,
        S = this;

    return (S = t.call(this, e, n) || this).includeEmpty = !1, S.includeFrozen = !0, S.includeMetaData = !0, S.includeChatNotification = !1, S.channelUrlsFilter = null, S.customTypesFilter = null, S.customTypeStartsWithFilter = null, S.nicknameContainsFilter = null, S.nicknameStartsWithFilter = null, S.nicknameExactMatchFilter = null, S.channelNameContainsFilter = "", S.myMemberStateFilter = St.ALL, S.unreadChannelFilter = At.ALL, S.superChannelFilter = Tt.ALL, S.publicChannelFilter = Ut.ALL, S.hiddenChannelFilter = It.UNHIDDEN, S.searchFilter = {
      fields: [],
      query: null
    }, S.userIdsFilter = {
      userIds: [],
      includeMode: !0,
      queryType: Dt.AND
    }, S.metadataKey = null, S.metadataValues = null, S.metadataOrderKeyFilter = null, S.metadataValueStartsWith = null, S.order = g$1.LATEST_LAST_MESSAGE, S.includeEmpty = null !== (s = n.includeEmpty) && void 0 !== s && s, S.includeFrozen = null === (r = n.includeFrozen) || void 0 === r || r, S.includeMetaData = null === (a = n.includeMetaData) || void 0 === a || a, S.includeChatNotification = null !== (i = n.includeChatNotification) && void 0 !== i && i, S.channelUrlsFilter = null !== (o = n.channelUrlsFilter) && void 0 !== o ? o : null, S.customTypesFilter = null !== (u = n.customTypesFilter) && void 0 !== u ? u : null, S.customTypeStartsWithFilter = null !== (c = n.customTypeStartsWithFilter) && void 0 !== c ? c : "", S.nicknameContainsFilter = null !== (l = n.nicknameContainsFilter) && void 0 !== l ? l : null, S.nicknameStartsWithFilter = null !== (h = n.nicknameStartsWithFilter) && void 0 !== h ? h : null, S.nicknameExactMatchFilter = null !== (d = n.nicknameExactMatchFilter) && void 0 !== d ? d : null, S.channelNameContainsFilter = null !== (_ = n.channelNameContainsFilter) && void 0 !== _ ? _ : "", S.myMemberStateFilter = null !== (p = n.myMemberStateFilter) && void 0 !== p ? p : St.ALL, S.unreadChannelFilter = null !== (f = n.unreadChannelFilter) && void 0 !== f ? f : At.ALL, S.superChannelFilter = null !== (m = n.superChannelFilter) && void 0 !== m ? m : Tt.ALL, S.publicChannelFilter = null !== (v = n.publicChannelFilter) && void 0 !== v ? v : Ut.ALL, S.hiddenChannelFilter = null !== (g = n.hiddenChannelFilter) && void 0 !== g ? g : It.UNHIDDEN, S.searchFilter = null !== (E = n.searchFilter) && void 0 !== E ? E : {
      fields: [],
      query: null
    }, S.userIdsFilter = null !== (C = n.userIdsFilter) && void 0 !== C ? C : {
      userIds: [],
      includeMode: !0,
      queryType: Dt.AND
    }, S.metadataKey = null !== (y = n.metadataKey) && void 0 !== y ? y : null, S.metadataValues = null !== (M = n.metadataValues) && void 0 !== M ? M : null, S.metadataOrderKeyFilter = null !== (b = n.metadataOrderKeyFilter) && void 0 !== b ? b : null, S.metadataValueStartsWith = null !== (N = n.metadataValueStartsWith) && void 0 !== N ? N : null, S.order = null !== (U = n.order) && void 0 !== U ? U : g$1.LATEST_LAST_MESSAGE, S;
  }

  return t$1(a, t), a.prototype._validate = function () {
    return t.prototype._validate.call(this) && w$1("boolean", this.includeEmpty) && w$1("boolean", this.includeFrozen) && w$1("boolean", this.includeMetaData) && w$1("string", this.channelNameContainsFilter) && S$2("string", this.channelUrlsFilter, !0) && S$2("string", this.customTypesFilter, !0) && w$1("string", this.customTypeStartsWithFilter) && w$1("string", this.nicknameContainsFilter, !0) && w$1("string", this.nicknameStartsWithFilter, !0) && w$1("string", this.nicknameExactMatchFilter, !0) && N$1(St, this.myMemberStateFilter) && N$1(Tt, this.superChannelFilter) && N$1(Ut, this.publicChannelFilter) && N$1(At, this.unreadChannelFilter) && N$1(It, this.hiddenChannelFilter) && S$2(Lt, this.searchFilter.fields) && w$1("string", this.searchFilter.query, !0) && S$2("string", this.userIdsFilter.userIds) && w$1("boolean", this.userIdsFilter.includeMode) && N$1(Dt, this.userIdsFilter.queryType) && N$1(g$1, this.order) && w$1("string", this.metadataOrderKeyFilter, !0) && w$1("string", this.metadataKey, !0) && S$2("string", this.metadataValues, !0) && w$1("string", this.metadataValueStartsWith, !0);
  }, a.prototype.serialize = function () {
    return Zi$1(this);
  }, a.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, r;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, [4, Yn.of(this._iid).getMyGroupChannels(this._token, $(n$1({}, this)), this.limit)]) : [3, 2] : [3, 5];

          case 1:
            return e = a.sent(), t = e.channels, r = e.token, this._token = r, this._hasNext = !!r, this._isLoading = !1, [2, t];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, a;
}(Oo),
    Vn = function (t) {
  function n(e, n, r) {
    var a,
        i = this;
    return (i = t.call(this, e, "SYEV", r) || this).pinnedMessageIds = [], i.latestPinnedMessage = null, i.ts = 0, r.data && (i.pinnedMessageIds = null !== (a = r.data.pinned_message_ids) && void 0 !== a ? a : [], i.latestPinnedMessage = r.data.latest_pinned_message ? We$1(e, n$1({}, r.data.latest_pinned_message)) : null), i.ts = r.ts, i;
  }

  return t$1(n, t), n;
}(Pe$3),
    Bn = function (t) {
  function n(e) {
    var n = e.channelUrl;
    return t.call(this, {
      code: "READ",
      ackRequired: !0,
      payload: {
        channel_url: n
      }
    }) || this;
  }

  return t$1(n, t), n;
}(ri$1),
    qn = function (t) {
  function n(e, n, s) {
    var r = t.call(this, e, "READ", s) || this;
    return r.readStatus = new Pt(e, s), r;
  }

  return t$1(n, t), n;
}(Pe$3),
    Wn = function (n) {
  function s(e) {
    var s = e.channelUrl,
        r = e.userId,
        a = n.call(this) || this;
    return (a = n.call(this) || this).method = ee.PUT, a.path = "".concat(ie, "/").concat(encodeURIComponent(s), "/messages/mark_as_delivered"), a.params = J({
      userId: r
    }), a;
  }

  return t$1(s, n), s;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var jn,
    zn = function (t) {
  function n(e, n, s) {
    var r = t.call(this, e, "DLVR", s) || this;
    return r.channelUrl = s.channel_url, r.deliveredStateUpdate = s.updated, r;
  }

  return t$1(n, t), n;
}(Pe$3),
    Qn = {},
    Yn = function (o) {
  function u(e, t) {
    var n,
        r = this;
    return (r = o.call(this, e, n$1(n$1({}, t), {
      channelType: x.GROUP
    })) || this)._leftChannels = new Map(), r._disableMack = !1, r._markAsReadAllLastSentAt = 0, r._disableMack = null !== (n = t.disableMack) && void 0 !== n && n, r._groupChannelHandlers = new Map(), r._groupChannelCache = new Ft(r._iid, {
      sdkState: t.sdkState,
      cacheContext: t.cacheContext
    }), r._groupChannelBroadcast = new Zt({
      dispatcher: t.dispatcher,
      groupChannelCache: r._groupChannelCache,
      messageCache: Hi.of(r._iid),
      unsentMessageCache: Vi.of(r._iid)
    }), setInterval(function () {
      var e,
          t,
          n = function (e) {
        e.invalidateTypingStatus() && (r._dispatcher.dispatch(new Jt({
          channels: [e],
          source: po.EVENT_CHANNEL_TYPING_STATUS_UPDATE
        })), r._groupChannelHandlers.forEach(function (t) {
          t.onTypingStatusUpdated && t.onTypingStatusUpdated(e);
        }));
      };

      try {
        for (var s = s$2(r._groupChannelCache.channels), a = s.next(); !a.done; a = s.next()) {
          n(a.value);
        }
      } catch (t) {
        e = {
          error: t
        };
      } finally {
        try {
          a && !a.done && (t = s.return) && t.call(s);
        } finally {
          if (e) throw e.error;
        }
      }
    }, 1e3), r._dispatcher.on(function (e) {
      e instanceof Pe$3 ? r._handleEvent(e) : e instanceof L$1 ? i$1(r, void 0, void 0, function () {
        var t, n;
        return o$1(this, function (s) {
          switch (s.label) {
            case 0:
              return t = e.message, [4, this.getChannel(t.channelUrl, !0)];

            case 1:
              return n = s.sent(), t instanceof je$1 ? n._autoResendUserMessage(t) : t instanceof He$2 && n._autoResendFileMessage(t), [2];
          }
        });
      }) : e instanceof v$1 && r.reduceDBSize();
    }), Qn[e] || (Qn[e] = r), r;
  }

  return t$1(u, o), u.of = function (e) {
    return Qn[e] || (Qn[e] = new u(e, _o.of(e))), Qn[e];
  }, u.clear = function (e) {
    Qn[e] && delete Qn[e];
  }, Object.defineProperty(u.prototype, "handlers", {
    get: function () {
      return c$1([], a$1(this._groupChannelHandlers.values()), !1);
    },
    enumerable: !1,
    configurable: !0
  }), u.prototype.buildGroupChannelFromSerializedData = function (e) {
    var t = Wi$1(e);
    return new sr(this._iid, sr.payloadify(t));
  }, u.prototype.buildGroupChannelListQueryFromSerializedData = function (e) {
    var t = Wi$1(e);
    return new Gn(this._iid, t);
  }, u.prototype.buildMemberFromSerializedData = function (e) {
    var t = Wi$1(e);
    return new Rt(this._iid, Rt.payloadify(t));
  }, u.prototype.getChannelFromCache = function (e) {
    var t;
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return [4, this._groupChannelCache.get(e)];

          case 1:
            return [2, null !== (t = n.sent()) && void 0 !== t ? t : null];
        }
      });
    });
  }, u.prototype.getChannelsFromCache = function (e, t, n, s, r) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return [4, this._groupChannelCache.fetch({
              token: e,
              filter: t,
              order: n,
              limit: s,
              borderlineChannelUrl: r
            })];

          case 1:
            return [2, a.sent()];
        }
      });
    });
  }, u.prototype.upsertChannelsToCache = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._groupChannelCache.upsert(e)];

          case 1:
            return [2, t.sent()];
        }
      });
    });
  }, u.prototype.removeChannelsFromCache = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._groupChannelCache.remove(e)];

          case 1:
            return t.sent(), [2];
        }
      });
    });
  }, u.prototype.clearChannelsFromCache = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, this._groupChannelCache.clear()];

          case 1:
            return e.sent(), [2];
        }
      });
    });
  }, u.prototype.reduceDBSize = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s, r, a, i, o, u, c, l, h, d, _, p;

      return o$1(this, function (f) {
        switch (f.label) {
          case 0:
            return e = Hi.of(this._iid), t = _o.of(this._iid).cacheContext, n = t.localCacheConfig, s = t.nestdb, t.localCacheEnabled && s && s.state == ki.OPENED ? (r = 1024 * n.maxSize * 1024, [4, s.estimateUsage()]) : [2];

          case 1:
            if ((a = f.sent()) < r) return [2];
            i = [], o = this._groupChannelCache.channels, u = {}, d = 0, f.label = 2;

          case 2:
            return d < o.length ? [4, this.getMessagesFromCache(o[d].url, 0, "prev", new Li())] : [3, 5];

          case 3:
            c = f.sent(), u[o[d].url] = JSON.stringify(c).length, l = new j({
              channel: o[d],
              cachedMessageCount: c.length
            }), i.push(l), f.label = 4;

          case 4:
            return d++, [3, 2];

          case 5:
            h = i.sort(n.clearOrderComparator), d = 0, f.label = 6;

          case 6:
            return d < h.length ? [4, e.removeMessagesOfChannel(h[d].channel.url)] : [3, 10];

          case 7:
            return f.sent(), [4, e._getGroupChannelPreferenceSize(h[d].channel.url)];

          case 8:
            if (_ = f.sent(), p = u[h[d].channel.url] + _, (a -= p) < r) return [3, 10];
            f.label = 9;

          case 9:
            return d++, [3, 6];

          case 10:
            return [2];
        }
      });
    });
  }, u.prototype._handleEvent = function (e) {
    var t;
    return i$1(this, void 0, void 0, function () {
      var n,
          s,
          r,
          o,
          u,
          c,
          l,
          h,
          d,
          _,
          v,
          g,
          E,
          C,
          M$2,
          N,
          U$2,
          S,
          T,
          A,
          I$1,
          w,
          D$2,
          L,
          R$1,
          P$1,
          O$1,
          F,
          j,
          Q,
          Y,
          K,
          J,
          X,
          Z,
          $,
          ee,
          te,
          ne,
          se,
          re,
          ae,
          ie,
          oe,
          ue,
          ce,
          le,
          he,
          de,
          _e,
          pe,
          fe,
          me,
          ve,
          ge,
          Ee,
          Ce,
          ye,
          Me,
          Fe,
          xe,
          He,
          Ge,
          Ve,
          Be,
          qe,
          We,
          je,
          ze,
          Qe,
          Ye,
          Ke,
          Je,
          Xe,
          Ze,
          $e,
          et,
          tt,
          nt,
          st,
          rt,
          at,
          it,
          ot,
          ut,
          dt,
          pt,
          bt,
          Ut,
          St,
          Tt,
          At,
          It,
          wt,
          Dt,
          Lt,
          Rt,
          Pt,
          kt,
          Ot,
          Ft,
          xt,
          Ht,
          Gt,
          Vt,
          Bt,
          qt,
          Wt,
          jt,
          zt,
          Qt,
          Yt,
          Kt,
          Zt,
          $t,
          en,
          tn,
          nn,
          sn,
          rn,
          an,
          on,
          un,
          cn,
          ln,
          hn,
          dn,
          _n,
          pn,
          fn,
          mn,
          vn,
          gn,
          En,
          Cn,
          yn,
          Mn,
          Nn,
          Sn = this;

      return o$1(this, function (Tn) {
        switch (Tn.label) {
          case 0:
            switch (Tn.trys.push([0, 80,, 81]), e.code) {
              case "MESG":
              case "FILE":
              case "ADMM":
              case "BRDM":
                return [3, 1];

              case "MEDI":
              case "FEDI":
              case "AEDI":
                return [3, 4];

              case "DELM":
                return [3, 7];

              case "READ":
                return [3, 10];

              case "DLVR":
                return [3, 13];

              case "MRCT":
                return [3, 15];

              case "MTHD":
                return [3, 19];

              case "MCNT":
                return [3, 23];

              case "PEDI":
                return [3, 32];

              case "VOTE":
                return [3, 35];

              case "SYEV":
                return [3, 38];

              case "USEV":
                return [3, 78];
            }

            return [3, 79];

          case 1:
            return h = null, "MESG" === e.code ? h = e.as(Cn$1) : "FILE" === e.code ? h = e.as(Xe$1) : "ADMM" !== e.code && "BRDM" != e.code || (h = e.as(y$1)), h ? (n = h.message, s = h.isMentioned, r = h.forceUpdateLastMessage, n.channelType !== x.GROUP ? [3, 3] : (this._disableMack || mi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e;
                return o$1(this, function (t) {
                  return e = new Hn(n), this._requestQueue.send(e), [2];
                });
              });
            }), R$1 = this._groupChannelCache.isCachedInMemory(n.channelUrl), g = n instanceof De$2 && n.sender.userId === this._sdkState.userId, [4, this.getChannel(n.channelUrl, !0)])) : [3, 3];

          case 2:
            if ((o = Tn.sent()).hiddenState === Zs.HIDDEN_ALLOW_AUTO_UNHIDE && (o.hiddenState = Zs.UNHIDDEN), n instanceof De$2) {
              u = _o.of(this._iid).useMemberInfoInMessage;

              try {
                for (c = s$2(o.members), l = c.next(); !l.done; l = c.next()) if ((Tt = l.value).userId === n.sender.userId) {
                  u || (n.sender.nickname = Tt.nickname, n.sender.plainProfileUrl = Tt.plainProfileUrl, n.sender.metaData = Tt.metaData, n.sender.isBlockedByMe = Tt.isBlockedByMe);
                  break;
                }
              } catch (e) {
                pn = {
                  error: e
                };
              } finally {
                try {
                  l && !l.done && (fn = c.return) && fn.call(c);
                } finally {
                  if (pn) throw pn.error;
                }
              }

              !u && s && (null === (t = n.mentionedUsers) || void 0 === t || t.forEach(function (e) {
                var t, n;

                try {
                  for (var s = s$2(o.members), r = s.next(); !r.done; r = s.next()) {
                    var a = r.value;

                    if (e.userId === a.userId) {
                      e.nickname = a.nickname, e.plainProfileUrl = a.plainProfileUrl, e.metaData = a.metaData;
                      break;
                    }
                  }
                } catch (e) {
                  t = {
                    error: e
                  };
                } finally {
                  try {
                    r && !r.done && (n = s.return) && n.call(s);
                  } finally {
                    if (t) throw t.error;
                  }
                }
              })), g && (M$2 = this._sessionManager.currentUser) && (M$2.nickname = n.sender.nickname, M$2.plainProfileUrl = n.sender.plainProfileUrl, M$2.metaData = n.sender.metaData);
            }

            n.silent && !g || (o.isEphemeral || R$1) && ((!o.lastMessage || o.lastMessage.createdAt < n.createdAt) && (o.lastMessage = n), g || o._updateUnreadCount(o.unreadMessageCount + 1, o.unreadMentionCount + (s ? 1 : 0))), r && (!o.lastMessage || o.lastMessage.createdAt < n.createdAt) && (o.lastMessage = n), this._dispatcher.dispatch(new Jt({
              channels: [o],
              source: po.EVENT_MESSAGE_RECEIVED
            })), n.silent && !g || bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onChannelChanged && n.onChannelChanged(o);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            }), this._dispatcher.dispatch(new No({
              messages: [n],
              source: po.EVENT_MESSAGE_RECEIVED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, r, a, i;
                return o$1(this, function (u) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (r = t.value).onMessageReceived && r.onMessageReceived(o, n), s && r.onMentionReceived && r.onMentionReceived(o, n);
                  } catch (e) {
                    a = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (i = e.return) && i.call(e);
                    } finally {
                      if (a) throw a.error;
                    }
                  }

                  return [2];
                });
              });
            }), Tn.label = 3;

          case 3:
            return [3, 79];

          case 4:
            return h = null, "MEDI" === e.code ? h = e.as(kn$1) : "FEDI" === e.code ? h = e.as(xn$1) : "AEDI" === e.code && (h = e.as(I)), h ? (d = h.message, _ = h.mentionCountChange, d.channelType !== x.GROUP ? [3, 6] : (R$1 = this._groupChannelCache.isCachedInMemory(d.channelUrl), [4, this.getChannel(d.channelUrl, !0)])) : [3, 6];

          case 5:
            v = Tn.sent(), g = d instanceof De$2 && d.sender.userId === this._sdkState.userId, E = !1, g ? (C = d.sender, (M$2 = this._sessionManager.currentUser) && (M$2.nickname = C.nickname, M$2.plainProfileUrl = C.plainProfileUrl, M$2.metaData = C.metaData)) : v.isReadMessage(d) || 0 !== _ && !d.silent && R$1 && (v._updateUnreadCount(v.unreadMessageCount, v.unreadMentionCount + _), E = !0), !v.lastMessage || v.lastMessage.createdAt < d.createdAt ? (v.lastMessage = d, E = !0) : v.lastMessage.isIdentical(d) && (R$1 ? v.lastMessage.updatedAt < d.updatedAt && (v.lastMessage = d, E = !0) : E = !0), N = !1, v.lastPinnedMessage && v.lastPinnedMessage.messageId === d.messageId && (v.lastPinnedMessage = d, E = !0, N = !0), E && (this._dispatcher.dispatch(new Jt({
              channels: [v],
              source: N ? po.EVENT_PINNED_MESSAGE_UPDATED : po.EVENT_MESSAGE_UPDATED
            })), d.silent && !g || bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onChannelChanged && n.onChannelChanged(v);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            }), N && bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onPinnedMessageUpdated && n.onPinnedMessageUpdated(v);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            })), this._dispatcher.dispatch(new No({
              messages: [d],
              source: po.EVENT_MESSAGE_UPDATED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onMessageUpdated && n.onMessageUpdated(v, d), 0 !== _ && n.onMentionReceived && n.onMentionReceived(v, d);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            }), Tn.label = 6;

          case 6:
            return [3, 79];

          case 7:
            return U$2 = e.as(Dn$1), he = U$2.channelUrl, de = U$2.channelType, S = U$2.messageId, de !== x.GROUP ? [3, 9] : [4, this.getChannel(he, !0)];

          case 8:
            T = Tn.sent(), this._dispatcher.dispatch(new To({
              messageIds: [S],
              source: po.EVENT_MESSAGE_DELETED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onMessageDeleted && n.onMessageDeleted(T, S);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            }), Tn.label = 9;

          case 9:
            return [3, 79];

          case 10:
            return (A = e.as(qn).readStatus).channelType !== x.GROUP ? [3, 12] : (R$1 = this._groupChannelCache.isCachedInMemory(A.channelUrl), [4, this.getChannel(A.channelUrl, !0)]);

          case 11:
            I$1 = Tn.sent(), R$1 && I$1._updateUnreadMemberState(A.reader.userId, A.readAt), A.reader.userId === this._sdkState.userId ? R$1 ? (I$1.unreadMessageCount > 0 || I$1.unreadMentionCount > 0) && (I$1._updateUnreadCount(0, 0), this._dispatcher.dispatch(new Jt({
              channels: [I$1],
              source: po.EVENT_CHANNEL_READ
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onChannelChanged && n.onChannelChanged(I$1);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            })) : 0 !== I$1.unreadMessageCount && 0 !== I$1.unreadMentionCount || (this._dispatcher.dispatch(new Jt({
              channels: [I$1],
              source: po.EVENT_CHANNEL_READ
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onChannelChanged && n.onChannelChanged(I$1);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            })) : (this._dispatcher.dispatch(new Jt({
              channels: [I$1],
              source: po.EVENT_CHANNEL_READ
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onUnreadMemberStatusUpdated && n.onUnreadMemberStatusUpdated(I$1);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            })), Tn.label = 12;

          case 12:
            return [3, 79];

          case 13:
            return w = e.as(zn), he = w.channelUrl, D$2 = w.deliveredStateUpdate, L = void 0 === D$2 ? {} : D$2, R$1 = this._groupChannelCache.isCachedInMemory(he), [4, this.getChannel(he, !0)];

          case 14:
            if (P$1 = Tn.sent(), R$1) for (O$1 in L) P$1._updateUndeliveredMemberState(O$1, L[O$1]);
            return Object.keys(L).some(function (e) {
              return e !== Sn._sdkState.userId;
            }) && (this._dispatcher.dispatch(new Jt({
              channels: [P$1],
              source: po.EVENT_CHANNEL_DELIVERED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onUndeliveredMemberStatusUpdated && n.onUndeliveredMemberStatusUpdated(P$1);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            })), [3, 79];

          case 15:
            return F = e.as(D), he = F.channelUrl, de = F.channelType, j = F.event, de !== x.GROUP ? [3, 18] : [4, this.getChannel(he, !0)];

          case 16:
            return Q = Tn.sent(), [4, this.getMessageFromCache(j.messageId)];

          case 17:
            (J = Tn.sent()) && (J.applyReactionEvent(j), this._dispatcher.dispatch(new No({
              messages: [J],
              source: po.EVENT_MESSAGE_REACTION_UPDATED
            }))), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onReactionUpdated && n.onReactionUpdated(Q, j);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            }), Tn.label = 18;

          case 18:
            return [3, 79];

          case 19:
            return (Y = e.as(R).event).channelType !== x.GROUP ? [3, 22] : [4, this.getChannel(Y.channelUrl, !0)];

          case 20:
            return K = Tn.sent(), [4, this.getMessageFromCache(Y.targetMessageId)];

          case 21:
            (J = Tn.sent()) && (J.applyThreadInfoUpdateEvent(Y), this._dispatcher.dispatch(new No({
              messages: [J],
              source: po.EVENT_MESSAGE_THREADINFO_UPDATED
            }))), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onThreadInfoUpdated && n.onThreadInfoUpdated(K, Y);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            }), Tn.label = 22;

          case 22:
            return [3, 79];

          case 23:
            X = e.as(P).groupChannelMemberCounts, Z = [], Tn.label = 24;

          case 24:
            Tn.trys.push([24, 29, 30, 31]), $ = s$2(X), ee = $.next(), Tn.label = 25;

          case 25:
            return ee.done ? [3, 28] : (te = ee.value, he = te.channelUrl, nt = te.memberCount, st = te.joinedMemberCount, ne = te.updatedAt, [4, this.getChannelFromCache(he)]);

          case 26:
            (se = Tn.sent()) && se._setLatestMemberCount(nt, st, ne) && Z.push(se), Tn.label = 27;

          case 27:
            return ee = $.next(), [3, 25];

          case 28:
            return [3, 31];

          case 29:
            return re = Tn.sent(), mn = {
              error: re
            }, [3, 31];

          case 30:
            try {
              ee && !ee.done && (vn = $.return) && vn.call($);
            } finally {
              if (mn) throw mn.error;
            }

            return [7];

          case 31:
            return Z.length > 0 && (this._dispatcher.dispatch(new Jt({
              channels: Z,
              source: po.EVENT_CHANNEL_MEMBER_COUNT_UPDATED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onChannelMemberCountChanged && n.onChannelMemberCountChanged(Z);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            })), [3, 79];

          case 32:
            return ae = e.as(O), ie = ae.event, oe = ae.status, he = ae.channelUrl, de = ae.channelType, he && de === x.GROUP ? [4, this.getChannel(he, !0)] : [3, 34];

          case 33:
            ue = Tn.sent(), this._dispatcher.dispatch(new Co({
              event: ie,
              source: po.EVENT_POLL_UPDATED
            })), bi$1(oe === Eo ? function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onPollDeleted && n.onPollDeleted(ue, ie.pollId);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            } : function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onPollUpdated && n.onPollUpdated(ue, ie);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            }), Tn.label = 34;

          case 34:
            return [3, 79];

          case 35:
            return ce = e.as(ar), le = ce.event, he = ce.channelUrl, de = ce.channelType, he && de === x.GROUP ? [4, this.getChannel(he, !0)] : [3, 37];

          case 36:
            _e = Tn.sent(), this._dispatcher.dispatch(new ko({
              event: le,
              source: po.EVENT_POLL_VOTED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onPollVoted && n.onPollVoted(_e, le);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            }), Tn.label = 37;

          case 37:
            return [3, 79];

          case 38:
            if (!(pe = e.as(T$1).event).isGroupChannelEvent) return [3, 77];

            switch (pe.category) {
              case U.CHANNEL_JOIN:
                return [3, 39];

              case U.CHANNEL_LEAVE:
                return [3, 41];

              case U.CHANNEL_OPERATOR_UPDATE:
                return [3, 45];

              case U.CHANNEL_INVITE:
                return [3, 47];

              case U.CHANNEL_DECLINE_INVITE:
                return [3, 49];

              case U.TYPING_START:
              case U.TYPING_END:
                return [3, 51];

              case U.USER_CHANNEL_MUTE:
              case U.USER_CHANNEL_UNMUTE:
                return [3, 53];

              case U.USER_CHANNEL_BAN:
                return [3, 55];

              case U.USER_CHANNEL_UNBAN:
                return [3, 59];

              case U.CHANNEL_FREEZE:
              case U.CHANNEL_UNFREEZE:
                return [3, 61];

              case U.CHANNEL_HIDE:
                return [3, 63];

              case U.CHANNEL_UNHIDE:
                return [3, 65];

              case U.CHANNEL_DELETED:
                return [3, 67];

              case U.CHANNEL_PROP_CHANGED:
                return [3, 69];

              case U.CHANNEL_META_DATA_CHANGED:
                return [3, 71];

              case U.CHANNEL_META_COUNTERS_CHANGED:
                return [3, 73];

              case U.PINNED_MESSAGE_CHANGED:
                return [3, 75];
            }

            return [3, 77];

          case 39:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 40:
            return fe = Tn.sent(), me = e.as(bn), ve = me.memberCount, ge = me.joinedMemberCount, Ee = me.members, Ce = !1, Ee.forEach(function (e) {
              fe.isExclusive || fe.isSuper || fe.isBroadcast ? Ce = Ce || fe._setLatestMemberCount(ve, ge, pe.ts) : (e.state = Nt.JOINED, fe.addMember(e, pe.ts), Sn._updateJoinedMemberCount(fe)), e.userId === Sn._sdkState.userId && (fe.myMemberState = Nt.JOINED);
            }), this._dispatcher.dispatch(new Jt({
              channels: [fe],
              source: po.EVENT_CHANNEL_JOINED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    var t, n;

                    try {
                      for (var s = s$2(Ee), r = s.next(); !r.done; r = s.next()) {
                        var a = r.value;
                        e.onUserJoined && e.onUserJoined(fe, a);
                      }
                    } catch (e) {
                      t = {
                        error: e
                      };
                    } finally {
                      try {
                        r && !r.done && (n = s.return) && n.call(s);
                      } finally {
                        if (t) throw t.error;
                      }
                    }

                    fe.isBroadcast && Ce && e.onChannelMemberCountChanged && e.onChannelMemberCountChanged([fe]);
                  }), [2];
                });
              });
            }), [3, 77];

          case 41:
            return (At = this._leftChannels.get(pe.channelUrl)) ? (Me = At.channel, [3, 44]) : [3, 42];

          case 42:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 43:
            Me = Tn.sent(), Tn.label = 44;

          case 44:
            return ye = Me, Fe = e.as(Un), nt = Fe.memberCount, st = Fe.joinedMemberCount, xe = Fe.member, He = !1, Ge = _o.of(this._iid).appInfo, ye.isExclusive || ye.isSuper || ye.isBroadcast ? He = ye._setLatestMemberCount(nt, st, pe.ts) : ((null == Ge ? void 0 : Ge.enabledChannelMemberShipHistory) ? ((Ve = ye.members.find(function (e) {
              return e.userId === Ve.userId;
            })) && (Ve.state = Nt.LEFT), ye.memberCount = nt) : ye.removeMember(xe), this._updateJoinedMemberCount(ye)), xe.userId === this._sdkState.userId ? (ye.myMemberState = Nt.NONE, ye.invitedAt = 0, ye.joinedAt = 0, ye._updateUnreadCount(0, 0), ye.isPublic ? this._dispatcher.dispatch(new Jt({
              channels: [ye],
              source: po.EVENT_CHANNEL_LEFT
            })) : (this._markAsLeave(ye), this._dispatcher.dispatch(new Xt({
              channelUrls: [ye.url],
              source: po.EVENT_CHANNEL_LEFT
            })))) : this._dispatcher.dispatch(new Jt({
              channels: [ye],
              source: po.EVENT_CHANNEL_LEFT
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onUserLeft && e.onUserLeft(ye, xe), ye.isBroadcast && He && e.onChannelMemberCountChanged && e.onChannelMemberCountChanged([ye]);
                  }), [2];
                });
              });
            }), [3, 77];

          case 45:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 46:
            Be = Tn.sent(), qe = e.as(M).operators, We = qe.map(function (e) {
              return e.userId;
            });

            try {
              for (je = s$2(Be.members), ze = je.next(); !ze.done; ze = je.next()) (Tt = ze.value).role = We.includes(Tt.userId) ? U$1.OPERATOR : U$1.NONE;
            } catch (e) {
              gn = {
                error: e
              };
            } finally {
              try {
                ze && !ze.done && (En = je.return) && En.call(je);
              } finally {
                if (gn) throw gn.error;
              }
            }

            return Be.myRole = We.includes(this._sdkState.userId) ? U$1.OPERATOR : U$1.NONE, this._dispatcher.dispatch(new Jt({
              channels: [Be],
              source: po.EVENT_CHANNEL_OPERATOR_UPDATED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onOperatorUpdated && e.onOperatorUpdated(Be, qe);
                  }), [2];
                });
              });
            }), [3, 77];

          case 47:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 48:
            Qe = Tn.sent(), Ye = e.as(An), nt = Ye.memberCount, st = Ye.joinedMemberCount, Ke = Ye.inviter, (Je = Ye.invitees).forEach(function (e) {
              return e.state = Nt.INVITED;
            });

            try {
              for (Xe = s$2(Je), Ze = Xe.next(); !Ze.done; Ze = Xe.next()) $e = Ze.value, Qe.isExclusive || Qe.isSuper || Qe.isBroadcast ? Qe._setLatestMemberCount(nt, st, pe.ts) : Qe.addMember($e, pe.ts), this._sdkState.userId === $e.userId && (Qe.hiddenState = Zs.UNHIDDEN, Qe.myMemberState !== Nt.JOINED && (Qe.myMemberState = Nt.INVITED), Qe.invitedAt = pe.ts);
            } catch (e) {
              Cn = {
                error: e
              };
            } finally {
              try {
                Ze && !Ze.done && (yn = Xe.return) && yn.call(Xe);
              } finally {
                if (Cn) throw Cn.error;
              }
            }

            return this._dispatcher.dispatch(new Jt({
              channels: [Qe],
              source: po.EVENT_CHANNEL_INVITED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onUserReceivedInvitation && e.onUserReceivedInvitation(Qe, Ke, Je);
                  }), [2];
                });
              });
            }), [3, 77];

          case 49:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 50:
            return et = Tn.sent(), tt = e.as(wn), nt = tt.memberCount, st = tt.joinedMemberCount, rt = tt.inviter, at = tt.invitee, et.isExclusive || et.isSuper || et.isBroadcast ? et._setLatestMemberCount(nt, st, pe.ts) : et.removeMember(at), this._sdkState.userId === at.userId ? (et.invitedAt = 0, et.myMemberState = Nt.NONE, et.isPublic ? this._dispatcher.dispatch(new Jt({
              channels: [et],
              source: po.EVENT_CHANNEL_DECLINED_INVITE
            })) : this._dispatcher.dispatch(new Xt({
              channelUrls: [et.url],
              source: po.EVENT_CHANNEL_DECLINED_INVITE
            }))) : this._dispatcher.dispatch(new Jt({
              channels: [et],
              source: po.EVENT_CHANNEL_DECLINED_INVITE
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onUserDeclinedInvitation && e.onUserDeclinedInvitation(et, rt, at);
                  }), [2];
                });
              });
            }), [3, 77];

          case 51:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 52:
            return it = Tn.sent(), ot = pe.category === U.TYPING_START, ut = e.as(ot ? On : xn).user, it._updateTypingStatus(ut, ot ? pe.ts : 0), this._dispatcher.dispatch(new Jt({
              channels: [it],
              source: po.EVENT_CHANNEL_TYPING_STATUS_UPDATE
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onTypingStatusUpdated && e.onTypingStatusUpdated(it);
                  }), [2];
                });
              });
            }), [3, 77];

          case 53:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 54:
            dt = Tn.sent(), pt = pe.category === U.USER_CHANNEL_MUTE, (bt = e.as(pt ? _n$1 : bn$1).user).userId === this._sdkState.userId && (dt.myMutedState = pt ? M$1.MUTED : M$1.UNMUTED, dt._myMutedRemainingTime = bt.restrictionInfo.remainingDuration);

            try {
              for (Ut = s$2(dt.members), St = Ut.next(); !St.done; St = Ut.next()) if ((Tt = St.value).userId === bt.userId) {
                Tt.isMuted = pt;
                break;
              }
            } catch (e) {
              Mn = {
                error: e
              };
            } finally {
              try {
                St && !St.done && (Nn = Ut.return) && Nn.call(Ut);
              } finally {
                if (Mn) throw Mn.error;
              }
            }

            return this._dispatcher.dispatch(new Jt({
              channels: [dt],
              source: pt ? po.EVENT_CHANNEL_MUTED : po.EVENT_CHANNEL_UNMUTED,
              data: bt.userId
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    pt ? e.onUserMuted && e.onUserMuted(dt, bt) : e.onUserUnmuted && e.onUserUnmuted(dt, bt);
                  }), [2];
                });
              });
            }), [3, 77];

          case 55:
            return (At = this._leftChannels.get(pe.channelUrl)) ? (wt = At.channel, [3, 58]) : [3, 56];

          case 56:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 57:
            wt = Tn.sent(), Tn.label = 58;

          case 58:
            return It = wt, this._markAsLeave(It), Dt = e.as(En$1).user, Dt.userId === this._sdkState.userId && this._dispatcher.dispatch(new Xt({
              channelUrls: [It.url],
              source: po.EVENT_CHANNEL_BANNED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onUserBanned && e.onUserBanned(It, Dt);
                  }), [2];
                });
              });
            }), [3, 77];

          case 59:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 60:
            return Lt = Tn.sent(), Rt = e.as(wn$1).user, Rt.userId === this._sdkState.userId && this._dispatcher.dispatch(new Xt({
              channelUrls: [Lt.url],
              source: po.EVENT_CHANNEL_UNBANNED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onUserUnbanned && e.onUserUnbanned(Lt, Rt);
                  }), [2];
                });
              });
            }), [3, 77];

          case 61:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 62:
            return Pt = Tn.sent(), kt = e.as(Sn$1).freeze, Pt.isFrozen = kt, this._dispatcher.dispatch(new Jt({
              channels: [Pt],
              source: kt ? po.EVENT_CHANNEL_FROZEN : po.EVENT_CHANNEL_UNFROZEN
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    kt ? e.onChannelFrozen && e.onChannelFrozen(Pt) : e.onChannelUnfrozen && e.onChannelUnfrozen(Pt);
                  }), [2];
                });
              });
            }), [3, 77];

          case 63:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 64:
            return Ot = Tn.sent(), Ft = e.as(Pn), xt = Ft.allowAutoUnhide, Ht = Ft.hidePreviousMessages, Gt = Ft.messageOffsetTimestamp, null !== xt && (Ot.hiddenState = xt ? Zs.HIDDEN_ALLOW_AUTO_UNHIDE : Zs.HIDDEN_PREVENT_AUTO_UNHIDE), null !== Ht && Ht && Ot._updateUnreadCount(0, 0), null !== Gt && (Ot.messageOffsetTimestamp = Gt), this._dispatcher.dispatch(new Jt({
              channels: [Ot],
              source: po.EVENT_CHANNEL_HIDDEN
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onChannelHidden && e.onChannelHidden(Ot);
                  }), [2];
                });
              });
            }), [3, 77];

          case 65:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 66:
            return (Vt = Tn.sent()).hiddenState = Zs.UNHIDDEN, this._dispatcher.dispatch(new Jt({
              channels: [Vt],
              source: po.EVENT_CHANNEL_UNHIDDEN
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onChannelChanged && e.onChannelChanged(Vt);
                  }), [2];
                });
              });
            }), [3, 77];

          case 67:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 68:
            return Bt = Tn.sent(), this._dispatcher.dispatch(new Xt({
              channelUrls: [pe.channelUrl],
              source: po.EVENT_CHANNEL_DELETED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onChannelDeleted && e.onChannelDeleted(Bt.url, Bt.channelType);
                  }), [2];
                });
              });
            }), [3, 77];

          case 69:
            return [4, this.getChannelWithoutCache(pe.channelUrl, !0)];

          case 70:
            return qt = Tn.sent(), this._dispatcher.dispatch(new Jt({
              channels: [qt],
              source: po.EVENT_CHANNEL_UPDATED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onChannelChanged && e.onChannelChanged(qt);
                  }), [2];
                });
              });
            }), [3, 77];

          case 71:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 72:
            return Wt = Tn.sent(), jt = e.as(nn$2), zt = jt.created, Qt = jt.updated, Yt = jt.deleted, zt && (Wt._upsertCachedMetaData(zt, pe.ts), this._dispatcher.dispatch(new Jt({
              channels: [Wt],
              source: po.EVENT_CHANNEL_METADATA_CREATED
            }))), Qt && (Wt._upsertCachedMetaData(Qt, pe.ts), this._dispatcher.dispatch(new Jt({
              channels: [Wt],
              source: po.EVENT_CHANNEL_METADATA_UPDATED
            }))), Yt && (Wt._removeFromCachedMetaData(Yt, pe.ts), this._dispatcher.dispatch(new Jt({
              channels: [Wt],
              source: po.EVENT_CHANNEL_METADATA_DELETED
            }))), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    zt && e.onMetaDataCreated && e.onMetaDataCreated(Wt, zt), Qt && e.onMetaDataUpdated && e.onMetaDataUpdated(Wt, Qt), Yt && e.onMetaDataDeleted && e.onMetaDataDeleted(Wt, Yt);
                  }), [2];
                });
              });
            }), [3, 77];

          case 73:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 74:
            return Kt = Tn.sent(), Zt = e.as(pn$1), $t = Zt.created, en = Zt.updated, tn = Zt.deleted, $t && this._dispatcher.dispatch(new Jt({
              channels: [Kt],
              source: po.EVENT_CHANNEL_METACOUNTER_CREATED
            })), en && this._dispatcher.dispatch(new Jt({
              channels: [Kt],
              source: po.EVENT_CHANNEL_METACOUNTER_UPDATED
            })), tn && this._dispatcher.dispatch(new Jt({
              channels: [Kt],
              source: po.EVENT_CHANNEL_METACOUNTER_DELETED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    $t && e.onMetaCounterCreated && e.onMetaCounterCreated(Kt, $t), en && e.onMetaCounterUpdated && e.onMetaCounterUpdated(Kt, en), tn && e.onMetaCounterDeleted && e.onMetaCounterDeleted(Kt, tn);
                  }), [2];
                });
              });
            }), [3, 77];

          case 75:
            return [4, this.getChannel(pe.channelUrl, !0)];

          case 76:
            return nn = Tn.sent(), sn = e.as(Vn), rn = sn.pinnedMessageIds, an = sn.latestPinnedMessage, (on = sn.ts) > nn._pinnedMessagesUpdatedAt && (nn.pinnedMessageIds = rn, nn.lastPinnedMessage = an, nn._pinnedMessagesUpdatedAt = on, this._dispatcher.dispatch(new Jt({
              channels: [nn],
              source: po.EVENT_PINNED_MESSAGE_UPDATED
            })), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                var e, t, n, s, r;
                return o$1(this, function (a) {
                  try {
                    for (e = s$2(this._groupChannelHandlers.values()), t = e.next(); !t.done; t = e.next()) (n = t.value).onChannelChanged && n.onChannelChanged(nn);
                  } catch (e) {
                    s = {
                      error: e
                    };
                  } finally {
                    try {
                      t && !t.done && (r = e.return) && r.call(e);
                    } finally {
                      if (s) throw s.error;
                    }
                  }

                  return [2];
                });
              });
            }), bi$1(function () {
              return i$1(Sn, void 0, void 0, function () {
                return o$1(this, function (e) {
                  return this._groupChannelHandlers.forEach(function (e) {
                    e.onPinnedMessageUpdated && e.onPinnedMessageUpdated(nn);
                  }), [2];
                });
              });
            })), [3, 77];

          case 77:
            return [3, 79];

          case 78:
            switch ((un = e.as(D$1).event).category) {
              case p$1.USER_BLOCK:
                cn = S$1.getDataAsUserBlockEvent(this._iid, un), hn = cn.blocker, dn = cn.blockee, this._groupChannelCache.block(hn.userId, dn.userId);
                break;

              case p$1.USER_UNBLOCK:
                ln = S$1.getDataAsUserBlockEvent(this._iid, un), hn = ln.blocker, dn = ln.blockee, this._groupChannelCache.unblock(hn.userId, dn.userId);
            }

            return [3, 79];

          case 79:
            return [3, 81];

          case 80:
            if (_n = Tn.sent(), g$2(_n)) throw _n;
            return [3, 81];

          case 81:
            return [2];
        }
      });
    });
  }, u.prototype._markAsLeave = function (e) {
    var t,
        n = this,
        s = null !== (t = this._leftChannels.get(e.url)) && void 0 !== t ? t : {
      channel: e,
      ref: 0
    };
    s.ref++, this._leftChannels.set(e.url, s), setTimeout(function () {
      s.ref--, 0 === s.ref && n._leftChannels.delete(e.url);
    }, 1e4);
  }, u.prototype.addHandler = function (e, t) {
    this._groupChannelHandlers.set(e, t);
  }, u.prototype.removeHandler = function (e) {
    this._groupChannelHandlers.delete(e);
  }, u.prototype.clearHandler = function () {
    this._groupChannelHandlers.clear();
  }, u.prototype.subscribeChannelEvent = function (e, t) {
    this._groupChannelBroadcast.subscribe(e, t);
  }, u.prototype.unsubscribeChannelEvent = function (e) {
    this._groupChannelBroadcast.unsubscribe(e);
  }, u.prototype._updateJoinedMemberCount = function (e) {
    e.joinedMemberCount = e.members.filter(function (e) {
      return e.state === Nt.JOINED;
    }).length;
  }, u.prototype.getChannel = function (e, t) {
    return void 0 === t && (t = !1), i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            Qi$1(w$1("string", e)).throw(v$2.invalidParameters), s.label = 1;

          case 1:
            return s.trys.push([1, 3,, 4]), [4, this.getChannelFromCache(e)];

          case 2:
            return (n = s.sent()) ? [2, n] : [3, 4];

          case 3:
            return s.sent(), [3, 4];

          case 4:
            return [4, this.getChannelWithoutCache(e, t)];

          case 5:
            return [2, s.sent()];
        }
      });
    });
  }, u.prototype.getChannelWithoutCache = function (e, t) {
    return void 0 === t && (t = !1), i$1(this, void 0, void 0, function () {
      var n, s, r, a, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), n = new tn({
              channelUrl: e,
              isInternalCall: t
            }), [4, this._requestQueue.send(n)];

          case 1:
            switch (s = o.sent(), r = s.as(nn).channel, a = r.unreadMessageCount, i = r.unreadMentionCount, r.myCountPreference) {
              case Xs.UNREAD_MESSAGE_COUNT_ONLY:
                i = 0;
                break;

              case Xs.UNREAD_MENTION_COUNT_ONLY:
                a = 0;
                break;

              case Xs.OFF:
                a = 0, i = 0;
            }

            return r._updateUnreadCount(a, i), [4, this.upsertChannelsToCache([r])];

          case 2:
            return [2, o.sent()[0]];
        }
      });
    });
  }, u.prototype.refreshChannel = function (e, t, n) {
    return void 0 === t && (t = !0), void 0 === n && (n = po.REFRESH_CHANNEL), i$1(this, void 0, void 0, function () {
      var s, r, a, i, o;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return u.trys.push([0, 5,, 6]), s = new tn({
              channelUrl: e,
              isInternalCall: t
            }), [4, this._requestQueue.send(s)];

          case 1:
            return r = u.sent(), (a = r.as(nn).channel).myMemberState !== Nt.NONE ? [3, 2] : (this._dispatcher.dispatch(new Xt({
              channelUrls: [a.url],
              source: n
            })), [3, 4]);

          case 2:
            return [4, this.upsertChannelsToCache([a])];

          case 3:
            i = u.sent(), this._dispatcher.dispatch(new Jt({
              channels: i,
              source: n
            })), u.label = 4;

          case 4:
            return [3, 6];

          case 5:
            return (o = u.sent()).code !== u$1.NON_AUTHORIZED && o.code !== u$1.NOT_FOUND_IN_DATABASE || this._dispatcher.dispatch(new Xt({
              channelUrls: [e],
              source: n
            })), [3, 6];

          case 6:
            return [2];
        }
      });
    });
  }, u.prototype.getMyGroupChannels = function (e, t, n, r) {
    return void 0 === r && (r = po.REQUEST_CHANNEL), i$1(this, void 0, void 0, function () {
      var a, i, o, u, c;
      return o$1(this, function (l) {
        switch (l.label) {
          case 0:
            return a = new rn(n$1(n$1({}, t), {
              userId: this._sdkState.userId,
              token: e,
              limit: n
            })), [4, this._requestQueue.send(a)];

          case 1:
            return i = l.sent(), o = i.as(an), u = o.channels, c = o.token, this._dispatcher.dispatch(new Jt({
              channels: u,
              source: r
            })), [2, {
              channels: u,
              token: c
            }];
        }
      });
    });
  }, u.prototype.getMyGroupChannelChangeLogs = function (e, t, r) {
    return void 0 === r && (r = po.REQUEST_CHANNEL_CHANGELOGS), i$1(this, void 0, void 0, function () {
      var a, i, o, u, c, d, _, p;

      return o$1(this, function (f) {
        switch (f.label) {
          case 0:
            return a = n$1(n$1({}, Gt), t), Qi$1((w$1("string", e) || w$1("number", e)) && Vt(a)).throw(v$2.invalidParameters), i = new $t($({
              userId: this._sdkState.userId,
              ts: "number" == typeof e ? e : null,
              token: "string" == typeof e ? e : null,
              filter: a
            })), [4, this._requestQueue.send(i)];

          case 1:
            return o = f.sent(), u = o.as(en), c = u.updatedChannels, d = u.deletedChannelUrls, _ = u.hasMore, p = u.ts, c.length > 0 && this._dispatcher.dispatch(new Jt({
              channels: c,
              source: r,
              ts: p
            })), d.length > 0 && this._dispatcher.dispatch(new Xt({
              channelUrls: d,
              source: r
            })), [2, {
              updatedChannels: c,
              deletedChannelUrls: d,
              hasMore: _,
              token: u.token
            }];
        }
      });
    });
  }, u.prototype.getGroupChannelCount = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return t = n$1(n$1({}, Bt), e), Qi$1(qt(t)).throw(v$2.invalidParameters), n = new on({
              userId: this._sdkState.userId,
              filter: t
            }), [4, this._requestQueue.send(n)];

          case 1:
            return r = a.sent(), [2, r.as(un).groupChannelCount];
        }
      });
    });
  }, u.prototype.getUnreadItemCount = function (e) {
    return i$1(this, void 0, void 0, function () {
      var n, r, a, i, o, u, c, d, _, p, m, g, E, C, y, M;

      return o$1(this, function (f) {
        switch (f.label) {
          case 0:
            return n = n$1(n$1({}, Wt), e), Qi$1(function (e) {
              return S$2(kt, e.keys);
            }(n)).throw(v$2.invalidParameters), r = _o.of(this._iid), a = r.sdkState, i = r.requestQueue, o = new cn({
              userId: a.userId,
              filter: n
            }), [4, i.send(o)];

          case 1:
            return u = f.sent(), c = u.as(ln), d = c.groupChannelUnreadMentionCount, _ = c.groupChannelUnreadMessageCount, p = c.groupChannelInvitationCount, m = c.superGroupChannelUnreadMentionCount, g = c.superGroupChannelUnreadMessageCount, E = c.superGroupChannelInvitationCount, C = c.nonSuperGroupChannelUnreadMentionCount, y = c.nonSuperGroupChannelUnreadMessageCount, M = c.nonSuperGroupChannelInvitationCount, [2, J({
              groupChannelUnreadMentionCount: d,
              groupChannelUnreadMessageCount: _,
              groupChannelInvitationCount: p,
              superGroupChannelUnreadMentionCount: m,
              superGroupChannelUnreadMessageCount: g,
              superGroupChannelInvitationCount: E,
              nonSuperGroupChannelUnreadMentionCount: C,
              nonSuperGroupChannelUnreadMessageCount: y,
              nonSuperGroupChannelInvitationCount: M
            })];
        }
      });
    });
  }, u.prototype.getTotalUnreadChannelCount = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s, r;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, s = new hn({
              userId: t.userId
            }), [4, n.send(s)];

          case 1:
            return r = a.sent(), [2, r.as(dn).unreadCount];
        }
      });
    });
  }, u.prototype.getTotalUnreadMessageCount = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, a, i, o;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return t = n$1(n$1({}, jt), e), Qi$1(zt(t)).throw(v$2.invalidParameters), n = _o.of(this._iid), r = n.sdkState, a = n.requestQueue, i = new _n({
              userId: r.userId,
              filter: t
            }), [4, a.send(i)];

          case 1:
            return o = u.sent(), [2, o.as(pn).unreadCount];
        }
      });
    });
  }, u.prototype.getTotalScheduledMessageCount = function (e) {
    return void 0 === e && (e = {}), i$1(this, void 0, void 0, function () {
      var t, n, a, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return t = n$1(n$1({}, Qt), e), Qi$1(function (e) {
              return w$1("string", e.channelUrl, !0) && S$2(Se, e.scheduledStatus, !0) && N$1(z, e.messageTypeFilter);
            }(t)).throw(v$2.invalidParameters), n = _o.of(this._iid).requestQueue, a = new fn(t), [4, n.send(a)];

          case 1:
            return i = o.sent(), [2, i.as(mn).count];
        }
      });
    });
  }, u.prototype.getSubscribedTotalUnreadMessageCount = function () {
    var e = _o.of(this._iid).subscribedUnreadMessageCount;
    return e.all >= 0 ? e.all : 0;
  }, u.prototype.getSubscribedCustomTypeTotalUnreadMessageCount = function () {
    var e = 0,
        t = _o.of(this._iid).subscribedUnreadMessageCount;

    for (var n in t.customTypes) e += t.customTypes[n];

    return e;
  }, u.prototype.getSubscribedCustomTypeUnreadMessageCount = function (e) {
    var t;
    return null !== (t = _o.of(this._iid).subscribedUnreadMessageCount.customTypes[e]) && void 0 !== t ? t : 0;
  }, u.prototype.createChannel = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, a;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return t = n$1(n$1({}, xt), e), Qi$1(Ht(t)).throw(v$2.invalidParameters), t.isPublic || (t.accessCode = void 0), n = new gn(n$1({
              userId: this._sdkState.userId
            }, t)), [4, this._requestQueue.send(n)];

          case 1:
            return r = i.sent(), a = r.as(En).channel, [4, this.upsertChannelsToCache([a])];

          case 2:
            return i.sent(), [2, a];
        }
      });
    });
  }, u.prototype.markAsReadAll = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s, r, a, i, o;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return e = Date.now(), Qi$1(e - this._markAsReadAllLastSentAt >= 1e3).throw(v$2.markAsReadAllRateLimitExceeded), this._markAsReadAllLastSentAt = e, t = new Cn({
              userId: this._sdkState.userId
            }), [4, this._requestQueue.send(t)];

          case 1:
            u.sent(), n = this._groupChannelCache.channels;

            try {
              for (s = s$2(n), r = s.next(); !r.done; r = s.next()) (a = r.value)._updateUnreadMemberState(this._sdkState.userId, e), a._updateUnreadCount(0, 0);
            } catch (e) {
              i = {
                error: e
              };
            } finally {
              try {
                r && !r.done && (o = s.return) && o.call(s);
              } finally {
                if (i) throw i.error;
              }
            }

            return n.length > 0 ? [4, this.upsertChannelsToCache(n)] : [3, 3];

          case 2:
            u.sent(), u.label = 3;

          case 3:
            return [2];
        }
      });
    });
  }, u.prototype.markAsReadWithChannelUrls = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, s, r, a, i, o, u, c;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            return t = Date.now(), Qi$1(S$2("string", e) && t - this._markAsReadAllLastSentAt >= 1e3).throw(v$2.markAsReadAllRateLimitExceeded), this._markAsReadAllLastSentAt = t, n = new Cn({
              userId: this._sdkState.userId,
              channelUrls: e
            }), [4, this._requestQueue.send(n)];

          case 1:
            d.sent(), s = this._groupChannelCache.channels, r = [];

            try {
              for (a = s$2(s), i = a.next(); !i.done; i = a.next()) o = i.value, e.includes(o.url) && (o._updateUnreadMemberState(this._sdkState.userId, t), o._updateUnreadCount(0, 0), r.push(o));
            } catch (e) {
              u = {
                error: e
              };
            } finally {
              try {
                i && !i.done && (c = a.return) && c.call(a);
              } finally {
                if (u) throw u.error;
              }
            }

            return r.length > 0 ? [4, this.upsertChannelsToCache(r)] : [3, 3];

          case 2:
            d.sent(), d.label = 3;

          case 3:
            return [2];
        }
      });
    });
  }, u.prototype.markAsDelivered = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this.getChannel(e)];

          case 1:
            return [4, t.sent().markAsDelivered()];

          case 2:
            return t.sent(), [2];
        }
      });
    });
  }, u;
}(L);

!function (e) {
  e[e.IDLE = 0] = "IDLE", e[e.RUNNING = 1] = "RUNNING", e[e.END = 2] = "END";
}(jn || (jn = {}));

var Kn,
    Jn = function (t) {
  function n(e, n, s, r) {
    var a = t.call(this) || this;
    return a._state = jn.IDLE, a._retryCount = 0, a._retryLimit = 3, a.priority = 0, a._worker = n, a;
  }

  return t$1(n, t), Object.defineProperty(n.prototype, "isIdle", {
    get: function () {
      return this._state === jn.IDLE;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "isRunning", {
    get: function () {
      return this._state === jn.RUNNING;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "isDone", {
    get: function () {
      return this._state === jn.END;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "retryCount", {
    get: function () {
      return this._retryCount;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(n.prototype, "retryLimit", {
    get: function () {
      return this._retryLimit;
    },
    enumerable: !1,
    configurable: !0
  }), n.prototype._run = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            if (!this.isRunning) return [3, 4];
            s.label = 1;

          case 1:
            return s.trys.push([1, 3,, 4]), [4, this._worker(e)];

          case 2:
            return t = s.sent(), this._retryCount = 0, this.dispatch("progress", t), t.hasNext ? this._run(t.nextToken) : this.end(), [3, 4];

          case 3:
            return n = s.sent(), this.dispatch("error", n), this._retryCount < this._retryLimit ? (this._retryCount++, this._run(e)) : this.stop(), [3, 4];

          case 4:
            return [2];
        }
      });
    });
  }, n.prototype.start = function (e) {
    this.isIdle && (this._state = jn.RUNNING, this._run(e));
  }, n.prototype.stop = function () {
    this._state = jn.IDLE, this.dispatch("stop");
  }, n.prototype.end = function () {
    this._state = jn.END, this.dispatch("end");
  }, n;
}(Q),
    Xn = {},
    Zn = function () {
  function e(e) {
    var t = e._iid,
        n = e.channel,
        s = e.limit,
        r = void 0 === s ? 100 : s,
        a = this;
    this.ref = 0, this._iid = t, this._channel = n, this._limit = r, this._prevSyncLoopCount = 0, this._nextSyncLoopCount = 0;
    var i,
        o,
        u = _o.of(this._iid),
        c = u.sdkState,
        l = u.dispatcher,
        m = u.logger;
    this._metadataKey = (i = c.userId, o = n.url, "sendbird:".concat(i, "@groupchannel/").concat(o, "/message/sync.meta"));

    var v = function (e, t) {
      return "sendbird:".concat(e, "@groupchannel/").concat(t, "/message/sync");
    }(c.userId, n.url);

    this._prevSync = new Jn(v, function (e) {
      return i$1(a, void 0, void 0, function () {
        var t, n, s, r, a, i, o, u, c, l;
        return o$1(this, function (p) {
          switch (p.label) {
            case 0:
              return t = {
                hasNext: !0,
                nextToken: 0
              }, this._prevSyncLoopCount++, [4, this.loadMetadata(e)];

            case 1:
              if (p.sent(), m.debug("message background prev sync from", null === (i = this._metadata) || void 0 === i ? void 0 : i.range.top), null === (o = this._metadata) || void 0 === o ? void 0 : o.previousComplete) return [3, 9];
              p.label = 2;

            case 2:
              return p.trys.push([2, 5,, 8]), [4, Zi.of(this._iid).getMessagesByTimestamp(this._channel.url, this._channel.channelType, (null === (c = null === (u = this._metadata) || void 0 === u ? void 0 : u.range) || void 0 === c ? void 0 : c.top) ? this._metadata.range.top : e, {
                prevResultSize: this._limit,
                nextResultSize: 0,
                replyType: V.ALL,
                includeReactions: !0,
                includeMetaArray: !0,
                includeParentMessageInfo: !0,
                includeThreadInfo: !0
              }, po.SYNC_MESSAGE_BACKGROUND)];

            case 3:
              return (n = p.sent()).length > 0 && (s = n.map(function (e) {
                return e.createdAt;
              }), (null === (l = this._metadata) || void 0 === l ? void 0 : (a = l.range).intersect.apply(a, c$1([], a$1(s), !1))) ? this.extendRange(n) : this._metadata = {
                range: new H({
                  top: Math.min.apply(Math, c$1([], a$1(s), !1)),
                  bottom: Math.max.apply(Math, c$1([], a$1(s), !1))
                }),
                previousComplete: !1
              }), t.hasNext = n.length >= this._limit && this._prevSyncLoopCount < 1, this._metadata && (t.nextToken = this._metadata.range.top, this._metadata.previousComplete = n.length < this._limit), m.debug("message background prev sync progress", t), [4, this.saveMetadata()];

            case 4:
              return p.sent(), [3, 8];

            case 5:
              return r = p.sent(), m.debug("message background prev sync error", r), r instanceof v$2 && r.isInvalidTokenError ? [4, this.clearMetadata()] : [3, 7];

            case 6:
              p.sent(), p.label = 7;

            case 7:
              throw r;

            case 8:
              return [3, 10];

            case 9:
              t.hasNext = !1, p.label = 10;

            case 10:
              return [2, t];
          }
        });
      });
    }), this._nextSync = new Jn(v, function (e) {
      return i$1(a, void 0, void 0, function () {
        var t, n, s, r, a, i, o, u, c;
        return o$1(this, function (l) {
          switch (l.label) {
            case 0:
              return t = {
                hasNext: !0,
                nextToken: 0
              }, this._nextSyncLoopCount++, [4, this.loadMetadata(e)];

            case 1:
              l.sent(), m.debug("message background next sync from", null === (i = this._metadata) || void 0 === i ? void 0 : i.range.bottom), l.label = 2;

            case 2:
              return l.trys.push([2, 5,, 6]), [4, Zi.of(this._iid).getMessagesByTimestamp(this._channel.url, this._channel.channelType, (null === (u = null === (o = this._metadata) || void 0 === o ? void 0 : o.range) || void 0 === u ? void 0 : u.bottom) ? this._metadata.range.bottom : e, {
                prevResultSize: 0,
                nextResultSize: this._limit,
                replyType: V.ALL,
                includeReactions: !0,
                includeMetaArray: !0,
                includeParentMessageInfo: !0,
                includeThreadInfo: !0
              }, po.SYNC_MESSAGE_BACKGROUND)];

            case 3:
              return (n = l.sent()).length > 0 && (s = n.map(function (e) {
                return e.createdAt;
              }), (null === (c = this._metadata) || void 0 === c ? void 0 : (a = c.range).intersect.apply(a, c$1([], a$1(s), !1))) ? this.extendRange(n) : this._metadata = {
                range: new H({
                  top: Math.min.apply(Math, c$1([], a$1(s), !1)),
                  bottom: Math.max.apply(Math, c$1([], a$1(s), !1))
                }),
                previousComplete: !1
              }), t.hasNext = n.length >= this._limit && this._nextSyncLoopCount < 1, this._metadata && (t.nextToken = this._metadata.range.bottom), m.debug("message background next sync progress", t), [4, this.saveMetadata()];

            case 4:
              return l.sent(), [3, 6];

            case 5:
              throw r = l.sent(), m.debug("message background next sync error", r), r;

            case 6:
              return [2, t];
          }
        });
      });
    }), this._connectionEventContext = l.on(function (e) {
      if (e instanceof ai$1) if (e.stateType === ti$1.CONNECTED) a.resume();else a.pause();
    });
  }

  return e.of = function (t, n) {
    return Xn[t] || (Xn[t] = {}), Xn[t][n.url] || (Xn[t][n.url] = new e({
      _iid: t,
      channel: n
    })), Xn[t][n.url].ref++, Xn[t][n.url];
  }, e.clear = function (e, t) {
    Xn[e] && Xn[e][t] && (Xn[e][t].close(), delete Xn[e]);
  }, Object.defineProperty(e.prototype, "range", {
    get: function () {
      var e, t;
      return null !== (t = null === (e = this._metadata) || void 0 === e ? void 0 : e.range) && void 0 !== t ? t : new H({});
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "previousComplete", {
    get: function () {
      var e;
      return !!(null === (e = this._metadata) || void 0 === e ? void 0 : e.previousComplete);
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.isWrappingMessages = function (e) {
    var t;
    return null === (t = this.range) || void 0 === t ? void 0 : t.includes.apply(t, c$1([], a$1(e.map(function (e) {
      return e.createdAt;
    })), !1));
  }, e.prototype.extendRange = function (e) {
    var t;
    this._metadata && (t = this._metadata.range).extends.apply(t, c$1([], a$1(e.map(function (e) {
      return e.createdAt;
    })), !1));
  }, e.prototype.loadMetadata = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return this._metadata ? [3, 2] : [4, _o.of(this._iid).cacheContext.preference.get(this._metadataKey)];

          case 1:
            (t = n.sent()) ? t.range.bottom < e ? this._metadata = {
              range: new H({}),
              previousComplete: !1
            } : this._metadata = {
              range: new H(t.range),
              previousComplete: t.previousComplete
            } : this._metadata = {
              range: new H({}),
              previousComplete: !1
            }, n.label = 2;

          case 2:
            return [2, this._metadata];
        }
      });
    });
  }, e.prototype.saveMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this._metadata ? [4, _o.of(this._iid).cacheContext.preference.set(this._metadataKey, this._metadata)] : [3, 2];

          case 1:
            return e.sent(), [2, !0];

          case 2:
            return [2, !1];
        }
      });
    });
  }, e.prototype.clearMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, _o.of(this._iid).cacheContext.preference.remove(this._metadataKey)];

          case 1:
            return e.sent(), this._metadata = void 0, [2];
        }
      });
    });
  }, e.prototype.resume = function (e) {
    var t, n, s, r;
    void 0 === e && (e = Date.now());
    var a = _o.of(this._iid),
        i = a.logger;
    a.connectionManager.isConnected && (i.debug("message background sync resume()"), this._prevSyncLoopCount = this._nextSyncLoopCount = 0, this._metadata && this._metadata.previousComplete || this._prevSync.start(null !== (n = null === (t = this._metadata) || void 0 === t ? void 0 : t.range.top) && void 0 !== n ? n : e), this._nextSync.start(null !== (r = null === (s = this._metadata) || void 0 === s ? void 0 : s.range.bottom) && void 0 !== r ? r : e));
  }, e.prototype.pause = function () {
    _o.of(this._iid).logger.debug("message background sync stop()"), this._prevSync.stop(), this._nextSync.stop();
  }, e.prototype.close = function () {
    this.ref--, this.ref <= 0 && (this.ref = 0, this.pause(), this._connectionEventContext.close(), delete Xn[this._iid][this._channel.url]);
  }, e;
}(),
    $n = {},
    es = function () {
  function e(e) {
    var t = e._iid,
        n = e.channel,
        s = this;
    this.ref = 0, this._iid = t, this._channel = n;
    var r,
        a,
        i = _o.of(this._iid),
        o = i.logger,
        u = i.sdkState,
        c = i.dispatcher;
    this._metadataKey = (r = u.userId, a = n.url, "sendbird:".concat(r, "@groupchannel/").concat(a, "/message/changelogs.meta"));

    var l = function (e, t) {
      return "sendbird:".concat(e, "@groupchannel/").concat(t, "/message/changelogs");
    }(u.userId, this._channel.url);

    this._sync = new Jn(l, function () {
      return i$1(s, void 0, void 0, function () {
        var e, t, n, s, r, a, i, u;
        return o$1(this, function (c) {
          switch (c.label) {
            case 0:
              return e = {
                hasNext: !0,
                nextToken: 0
              }, [4, this.loadMetadata()];

            case 1:
              c.sent(), o.debug("message changelog sync from", null === (u = this._metadata) || void 0 === u ? void 0 : u.token), c.label = 2;

            case 2:
              return c.trys.push([2, 5,, 8]), [4, Zi.of(this._iid).getMessageChangelogs(this._channel.url, this._channel.channelType, this._metadata.token, {
                replyType: V.ALL,
                includeReactions: !0,
                includeThreadInfo: !0,
                includeMetaArray: !0,
                includeParentMessageInfo: !0
              }, po.SYNC_MESSAGE_CHANGELOGS)];

            case 3:
              return t = c.sent(), n = t.updatedMessages, s = t.deletedMessageIds, r = t.hasMore, a = t.token, e.hasNext = r, e.nextToken = a, (n.length > 0 || s.length > 0) && this._metadata && (this._metadata.token = a), o.debug("message changelog sync progress", e), [4, this.saveMetadata()];

            case 4:
              return c.sent(), [3, 8];

            case 5:
              return i = c.sent(), o.debug("message changelog sync error", i), i instanceof v$2 && i.isInvalidTokenError ? [4, this.clearMetadata()] : [3, 7];

            case 6:
              c.sent(), c.label = 7;

            case 7:
              throw i;

            case 8:
              return [2, e];
          }
        });
      });
    }), this._connectionEventContext = c.on(function (e) {
      if (e instanceof ai$1) if (e.stateType === ti$1.CONNECTED) s.resume();else s.pause();
    });
  }

  return e.of = function (t, n) {
    return $n[t] || ($n[t] = {}), $n[t][n.url] || ($n[t][n.url] = new e({
      _iid: t,
      channel: n
    })), $n[t][n.url].ref++, $n[t][n.url];
  }, e.clear = function (e, t) {
    $n[e] && $n[e][t] && ($n[e][t].close(), delete $n[e]);
  }, e.prototype.loadMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return this._metadata ? [3, 2] : (e = _o.of(this._iid), t = e.cacheContext, n = e.firstConnectedAt, [4, t.preference.get(this._metadataKey)]);

          case 1:
            s = r.sent(), this._metadata = {
              token: s ? s.token : n
            }, r.label = 2;

          case 2:
            return [2, this._metadata];
        }
      });
    });
  }, e.prototype.saveMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this._metadata ? [4, _o.of(this._iid).cacheContext.preference.set(this._metadataKey, this._metadata)] : [3, 2];

          case 1:
            return e.sent(), [2, !0];

          case 2:
            return [2, !1];
        }
      });
    });
  }, e.prototype.clearMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, _o.of(this._iid).cacheContext.preference.remove(this._metadataKey)];

          case 1:
            return e.sent(), this._metadata = void 0, [2];
        }
      });
    });
  }, e.prototype.resume = function () {
    var e = _o.of(this._iid),
        t = e.logger;
    e.connectionManager.isConnected && (t.debug("message changelog sync resume()"), this._sync.start(0));
  }, e.prototype.pause = function () {
    var e = _o.of(this._iid),
        t = e.logger;
    e.connectionManager, t.debug("message changelog sync pause()"), this._sync.stop();
  }, e.prototype.close = function () {
    this.ref--, this.ref <= 0 && (this.ref = 0, this.pause(), this._connectionEventContext.close(), delete $n[this._iid][this._channel.url]);
  }, e;
}(),
    ts = {},
    ns = function () {
  function e(e) {
    var t = e._iid,
        n = e.channel,
        s = e.hasPollMessage,
        r = this;
    this.ref = 0, this._iid = t, this._channel = n;
    var a,
        i,
        o = _o.of(this._iid),
        u = o.logger,
        c = o.sdkState,
        l = o.dispatcher;
    this._metadataKey = (a = c.userId, i = n.url, "sendbird:".concat(a, "@groupchannel/").concat(i, "/poll/changelogs.meta"));

    var d = function (e, t) {
      return "sendbird:".concat(e, "@groupchannel/").concat(t, "/poll/changelogs");
    }(c.userId, this._channel.url);

    this._sync = new Jn(d, function () {
      return i$1(r, void 0, void 0, function () {
        var e, t, n, r, a, i, o, c;
        return o$1(this, function (l) {
          switch (l.label) {
            case 0:
              return e = {
                hasNext: !0,
                nextToken: 0
              }, [4, this.loadMetadata()];

            case 1:
              return l.sent(), u.debug("poll changelog sync from", null === (c = this._metadata) || void 0 === c ? void 0 : c.token), (t = !this._metadata || !this._metadata.token) ? [4, s()] : [3, 3];

            case 2:
              t = !l.sent(), l.label = 3;

            case 3:
              if (t) return [2, {
                hasNext: !1,
                nextToken: 0
              }];
              this._metadata || (n = _o.of(this._iid).firstConnectedAt, this._metadata = {
                token: n
              }), l.label = 4;

            case 4:
              return l.trys.push([4, 7,, 10]), [4, Zo.of(this._iid).getPollChangeLogs(this._channel.url, this._channel.channelType, this._metadata.token)];

            case 5:
              return r = l.sent(), a = r.hasMore, i = r.token, e.hasNext = a, e.nextToken = i, this._metadata.token = i, u.debug("poll changelog sync progress", e), [4, this.saveMetadata()];

            case 6:
              return l.sent(), [3, 10];

            case 7:
              return o = l.sent(), u.debug("poll changelog sync error", o), o instanceof v$2 && o.isInvalidTokenError ? [4, this.clearMetadata()] : [3, 9];

            case 8:
              l.sent(), l.label = 9;

            case 9:
              throw o;

            case 10:
              return [2, e];
          }
        });
      });
    }), this._connectionEventContext = l.on(function (e) {
      if (e instanceof ai$1) if (e.stateType === ti$1.CONNECTED) r.resume();else r.pause();
    });
  }

  return e.of = function (t, n, s) {
    return ts[t] || (ts[t] = {}), ts[t][n.url] || (ts[t][n.url] = new e({
      _iid: t,
      channel: n,
      hasPollMessage: s
    })), ts[t][n.url].ref++, ts[t][n.url];
  }, e.prototype.loadMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this._metadata ? [3, 2] : [4, _o.of(this._iid).cacheContext.preference.get(this._metadataKey)];

          case 1:
            e = t.sent(), this._metadata = e ? {
              token: e.token
            } : void 0, t.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, e.prototype.saveMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this._metadata ? [4, _o.of(this._iid).cacheContext.preference.set(this._metadataKey, this._metadata)] : [3, 2];

          case 1:
            e.sent(), e.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, e.prototype.clearMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, _o.of(this._iid).cacheContext.preference.remove(this._metadataKey)];

          case 1:
            return e.sent(), this._metadata = void 0, [2];
        }
      });
    });
  }, e.prototype.resume = function () {
    _o.of(this._iid).logger.debug("poll changelog sync resume()"), this._sync.start(0);
  }, e.prototype.pause = function () {
    _o.of(this._iid).logger.debug("poll changelog sync pause()"), this._sync.stop();
  }, e.prototype.close = function () {
    this.ref--, this.ref <= 0 && (this.ref = 0, this.pause(), this._connectionEventContext.close(), delete ts[this._iid][this._channel.url]);
  }, e;
}(),
    ss = function (t) {
  function n(e) {
    var n = e.channels,
        s = e.source,
        r = e.isWebSocketEventComing,
        a = void 0 !== r && r,
        i = e.data,
        o = void 0 === i ? null : i,
        u = t.call(this) || this;
    return u.channels = n, u.source = s, u.isWebSocketEventComing = a, u.data = o, u;
  }

  return t$1(n, t), n;
}(X);
    (function (t) {
  function n(e) {
    var n = e.channelUrls,
        s = e.source,
        r = e.isWebSocketEventComing,
        a = void 0 !== r && r,
        i = t.call(this) || this;
    return i.channelUrls = n, i.source = s, i.isWebSocketEventComing = a, i;
  }

  return t$1(n, t), n;
})(X);
    var as = function (n) {
  function s(e) {
    var s,
        r,
        a,
        i,
        o,
        u,
        c,
        l,
        h,
        d,
        _ = this;

    return (_ = n.call(this) || this).method = ee.GET, _.path = "".concat(ge$1(e.channelType), "/").concat(e.channelUrl, "/messages_gap"), _.params = J({
      prev_start_ts: e.prevStart,
      prev_end_ts: e.prevEnd,
      prev_cache_count: e.prevCount,
      next_start_ts: e.nextStart,
      next_end_ts: e.nextEnd,
      next_cache_count: e.nextCount,
      huge_gap_threshold: null !== (s = e.threshold) && void 0 !== s ? s : null,
      reverse: !0,
      custom_types: null !== (r = e.customTypes) && void 0 !== r ? r : ["*"],
      message_type: null !== (a = e.messageType) && void 0 !== a ? a : null,
      include_reply_type: null !== (i = e.replyType) && void 0 !== i ? i : V.NONE,
      include_reactions: null === (o = e.includeReactions) || void 0 === o || o,
      include_meta_array: null === (u = e.includeMetaArray) || void 0 === u || u,
      include_thread_info: null === (c = e.includeThreadInfo) || void 0 === c || c,
      include_parent_message_info: null === (l = e.includeParentMessageInfo) || void 0 === l || l,
      with_sorted_meta_array: null === (h = e.includeMetaArray) || void 0 === h || h,
      show_subchannel_messages_only: null !== (d = e.showSubchannelMessagesOnly) && void 0 !== d && d,
      include_poll_details: !0,
      checking_continuous_messages: e.checkingContinuousMessages
    }), _;
  }

  return t$1(s, n), s;
}(Ne$2),
    is = function (t) {
  function n(e, n) {
    var s,
        r,
        a,
        i,
        o,
        u,
        c = this;
    return (c = t.call(this, e, n) || this).isHugeGap = n.is_huge_gap, c.prevMessages = (null !== (s = n.prev_messages) && void 0 !== s ? s : []).map(function (t) {
      return We$1(e, t);
    }), c.prevHasMore = null !== (r = n.prev_hasmore) && void 0 !== r && r, c.isContinuousPrevMessages = null !== (a = n.is_continuous_prev_messages) && void 0 !== a && a, c.nextMessages = (null !== (i = n.next_messages) && void 0 !== i ? i : []).map(function (t) {
      return We$1(e, t);
    }), c.nextHasmore = null !== (o = n.next_hasmore) && void 0 !== o && o, c.isContinuousNextMessages = null !== (u = n.is_continuous_next_messages) && void 0 !== u && u, c;
  }

  return t$1(n, t), n;
}(Te$2),
    os = function (e, t) {
  return t instanceof De$2 ? e.findIndex(function (e) {
    return e instanceof De$2 && t.isIdentical(e);
  }) : e.findIndex(function (e) {
    return e.isIdentical(t);
  });
},
    us = function (e, t) {
  return e.findIndex(function (e) {
    return e.messageId === t;
  });
},
    cs = function (e, t) {
  if (e.length > 0) {
    for (var n = 0, s = e.length - 1, r = Math.floor((n + s) / 2); n < s;) {
      var a = e[r].createdAt - t.createdAt;
      if (a > 0) s = r, r = Math.floor((n + s) / 2);else {
        if (!(a < 0)) return r;
        n = r + 1, r = Math.floor((n + s) / 2);
      }
    }

    return e[r].createdAt > t.createdAt ? r : r + 1;
  }

  return e.length;
},
    ls = function (e) {
  this.source = e;
},
    hs = function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  return t$1(n, t), n;
}(ls),
    ds = function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  return t$1(n, t), n;
}(ls),
    _s = function (e) {
  this.source = e;
},
    ps = function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  return t$1(n, t), n;
}(_s),
    fs = function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  return t$1(n, t), n;
}(_s),
    ms = 6e5,
    vs = {
  includeMetaArray: !0,
  includeReactions: !0,
  includeThreadInfo: !0,
  includeParentMessageInfo: !0
};

!function (e) {
  e.CACHE_AND_REPLACE_BY_API = "cache_and_replace_by_api";
}(Kn || (Kn = {}));

var gs,
    Es,
    Cs,
    ys = function () {
  function e() {}

  return e.prototype._invokeResponse = function (e, t, n) {
    var s = this;
    bi$1(function () {
      return i$1(s, void 0, void 0, function () {
        return o$1(this, function (s) {
          switch (e) {
            case "local":
              this._onCacheResult(t, n);

              break;

            case "remote":
              this._onApiResult(t, n);

          }

          return [2];
        });
      });
    });
  }, e.prototype.onCacheResult = function (e) {
    return this._onCacheResult = e, this;
  }, e.prototype.onApiResult = function (e) {
    return this._onApiResult = e, this;
  }, e;
}(),
    Ms = function () {
  function e(e, t) {
    var n = t.filter,
        s = t.startingPoint,
        r = t.limit,
        a = t.channel,
        i = t.channelManager,
        o = this;
    this._messages = [], this._unsentMessages = [], this._iid = e, this._key = "mc-".concat(Z()), this._isDisposed = !1, this.filter = null != n ? n : new Li(), this._channel = a, this._syncRange = new H({}), this._hasPrevious = !0, this._hasNext = !0, this._startingPoint = "number" == typeof s ? s : Date.now() + ms, this._limit = r || lr, this._channelManager = i, this._channelManager.subscribeChannelEvent(this._key, {
      onUpdate: function (e, t, n) {
        var s = e.findIndex(function (e) {
          return e.isIdentical(o.channel);
        });
        s >= 0 && (o._replaceChannelOfCollection(e[s]), o.channel._runIfHandleableWithGroupChannel(function (e) {
          switch (t) {
            case po.EVENT_CHANNEL_UPDATED:
              var s = !1;

              for (var r in o._messages) {
                if (o._messages[r].createdAt >= e.messageOffsetTimestamp) {
                  s = !0;
                  var a = parseInt(r);

                  if (a > 0) {
                    var i = o._messages.splice(0, a);

                    o._removeMessagesFromView(i.map(function (e) {
                      return e.messageId;
                    }), po.EVENT_MESSAGE_OFFSET_UPDATED);
                  }

                  break;
                }
              }

              !s && o._messages.length > 0 && o._removeMessagesFromView(o._messages.map(function (e) {
                return e.messageId;
              }), po.EVENT_MESSAGE_OFFSET_UPDATED);
              break;

            case po.EVENT_CHANNEL_UNMUTED:
              var u = _o.of(o._iid).sdkState,
                  c = n;
              u.userId === c && o._clearCheckMyMutedTimer();
              break;

            case po.EVENT_CHANNEL_MUTED:
              u = _o.of(o._iid).sdkState;
              var l = n;
              u.userId === l && -1 !== e._myMutedRemainingTime && o._startCheckMyMutedTimer(e._myMutedRemainingTime);
              break;

            case po.EVENT_CHANNEL_LEFT:
              e.isPublic && o._clearCheckMyMutedTimer();
          }

          bi$1(function () {
            return i$1(o, void 0, void 0, function () {
              var e, n;
              return o$1(this, function (s) {
                return e = this._createChannelEventContext(t), Kt(t) && (null === (n = this._handler) || void 0 === n ? void 0 : n.onChannelUpdated) && this._handler.onChannelUpdated(e, this.channel), [2];
              });
            });
          });
        }));
      },
      onRemove: function (e, t) {
        e.indexOf(o.channel.url) >= 0 && (o._clearCheckMyMutedTimer(), bi$1(function () {
          return i$1(o, void 0, void 0, function () {
            var e, n;
            return o$1(this, function (s) {
              return e = this._createChannelEventContext(t), (null === (n = this._handler) || void 0 === n ? void 0 : n.onChannelDeleted) && this._handler.onChannelDeleted(e, this.channel.url), [2];
            });
          });
        }));
      }
    }), this._channelManager.subscribeMessageEvent(this._key, {
      onUpdate: function (e, t) {
        var n,
            s,
            r = [],
            a = [];

        try {
          for (var i = s$2(e), u = i.next(); !u.done; u = i.next()) {
            var c = u.value;
            c.channelUrl === o._channel.url && (o.filter.match(c) ? r.push(c) : a.push(c.messageId));
          }
        } catch (e) {
          n = {
            error: e
          };
        } finally {
          try {
            u && !u.done && (s = i.return) && s.call(i);
          } finally {
            if (n) throw n.error;
          }
        }

        if (wo(t)) {
          if (r.length > 0) switch (t) {
            case po.LOCAL_MESSAGE_CANCELED:
            case po.LOCAL_MESSAGE_RESEND_STARTED:
            case po.EVENT_MESSAGE_SENT_FAILED:
            case po.EVENT_MESSAGE_SENT_SUCCESS:
            case po.EVENT_MESSAGE_UPDATED:
            case po.EVENT_MESSAGE_THREADINFO_UPDATED:
            case po.EVENT_MESSAGE_REACTION_UPDATED:
            case po.SYNC_MESSAGE_CHANGELOGS:
              o._updateMessagesToView(r, t);

              break;

            case po.EVENT_MESSAGE_SENT_PENDING:
              o._addMessagesToView(r, t);

              break;

            case po.EVENT_MESSAGE_RECEIVED:
              o.hasNext || o._addMessagesToView(r, t);
              break;

            case po.SYNC_MESSAGE_FILL:
              o._addMessagesToView(r, t);

          }
          a.length > 0 && o._removeMessagesFromView(a, t);
        }
      },
      onRemove: function (e, t) {
        o._removeMessagesFromView(e, t);
      },
      onRemoveUnsent: function (e, t) {
        o._removeUnsentMessageFromView(e, t);
      },
      onPollChangeLogUpdate: function (e, t) {
        o._updatePollsToView(e, t);
      },
      onPollUpdate: function (e, t) {
        o._applyPollUpdateEventToView(e, t);
      },
      onPollVote: function (e, t) {
        o._applyPollVoteEventToView(e, t);
      }
    });
    var u = _o.of(this._iid),
        c = u.cacheContext,
        l = u.dispatcher,
        h = u.logger;

    this._channel._updateMessageCollectionLastAccessedAt();

    var v = this._createChannelUpdateEventCommand(po.CHANNEL_LASTACCESSEDAT_UPDATED);

    v && l.dispatch(v), this._shouldStartBackgroundSync() && (this._backgroundSync = Zn.of(this._iid, this._channel), this._backgroundSync.resume(this._startingPoint)), this._changelogSync = es.of(this._iid, this._channel), this._changelogSync.resume(), this._pollChangelogSync = ns.of(this._iid, this._channel, this._hasPollMessage.bind(this)), this._pollChangelogSync.resume(), this._prevFill = new Jn(this._key, function (e) {
      return i$1(o, void 0, void 0, function () {
        var t, n, s, r, a;
        return o$1(this, function (i) {
          switch (i.label) {
            case 0:
              return [4, this._getRemoteMessages(e, {
                prevLimit: this._limit,
                source: po.SYNC_MESSAGE_FILL,
                checkingContinuousMessages: c.localCacheEnabled
              })];

            case 1:
              return t = i.sent(), n = t.messages, s = t.isContinuousMessages, n.length > 0 ? (r = Math.min.apply(Math, c$1([], a$1(n.map(function (e) {
                return e.createdAt;
              })), !1)), this._syncRange.extends(r), s && (null === (a = this._backgroundSync) || void 0 === a || a.range.extends(r)), [2, {
                hasNext: n.length >= this._limit && this.viewTop < r,
                nextToken: this._syncRange.top
              }]) : [2, {
                hasNext: !1,
                nextToken: 0
              }];
          }
        });
      });
    }), this._nextFill = new Jn(this._key, function (e) {
      return i$1(o, void 0, void 0, function () {
        var t, n, s, r, a;
        return o$1(this, function (i) {
          switch (i.label) {
            case 0:
              return [4, this._getRemoteMessages(e, {
                nextLimit: this._limit,
                source: po.SYNC_MESSAGE_FILL,
                checkingContinuousMessages: c.localCacheEnabled
              })];

            case 1:
              return t = i.sent(), n = t.messages, s = t.isContinuousMessages, n.length > 0 ? (r = Math.max.apply(Math, c$1([], a$1(n.map(function (e) {
                return e.createdAt;
              })), !1)), this._syncRange.extends(r), s && (null === (a = this._backgroundSync) || void 0 === a || a.range.extends(r)), [2, {
                hasNext: !(n.length >= this._limit && this._hasNext) || this.viewBottom > r,
                nextToken: this._syncRange.bottom
              }]) : [2, {
                hasNext: !1,
                nextToken: 0
              }];
          }
        });
      });
    }), this._connectionEventContext = l.on(function (e) {
      if (e instanceof ai$1) switch (e.stateType) {
        case ti$1.CONNECTED:
          o._refreshChannel(po.SYNC_CHANNEL_CHANGELOGS), mi$1(function () {
            return i$1(o, void 0, void 0, function () {
              var e;
              return o$1(this, function (t) {
                switch (t.label) {
                  case 0:
                    return [4, this.channel.getMyMutedInfo()];

                  case 1:
                    return (e = t.sent()).isMuted && -1 !== e.remainingDuration && this._startCheckMyMutedTimer(e.remainingDuration), [2];
                }
              });
            });
          }), h.debug("check huge gap"), o._checkHugeGap();
          break;

        case ti$1.LOGOUT:
          o.dispose();
          break;

        default:
          o._clearCheckMyMutedTimer(), o._prevFill.stop(), o._nextFill.stop();
      }
    }), _o.of(this._iid).statLogCollector.put(new io({
      type: we$2.FEATURE_LOCALCACHE,
      data: {
        use_local_cache: c.localCacheEnabled,
        collection_interface: {
          message: !0
        }
      }
    }));
  }

  return Object.defineProperty(e.prototype, "channel", {
    get: function () {
      return this._channel;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "succeededMessages", {
    get: function () {
      return c$1([], a$1(this._messages), !1);
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "failedMessages", {
    get: function () {
      return this._unsentMessages.filter(function (e) {
        return e.sendingStatus === q.FAILED;
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "pendingMessages", {
    get: function () {
      return this._unsentMessages.filter(function (e) {
        return e.sendingStatus === q.PENDING;
      });
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "hasPrevious", {
    get: function () {
      return this._hasPrevious;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "hasNext", {
    get: function () {
      return this._hasNext;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "viewTop", {
    get: function () {
      return Math.min.apply(Math, c$1(c$1([], a$1(this._messages.map(function (e) {
        return e.createdAt;
      })), !1), [Number.MAX_SAFE_INTEGER], !1));
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "viewBottom", {
    get: function () {
      return Math.max.apply(Math, c$1(c$1([], a$1(this._messages.map(function (e) {
        return e.createdAt;
      })), !1), [0], !1));
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype._replaceChannelOfCollection = function (e) {
    this._channel.isGroupChannel() ? this._channel = e : this._channel.isFeedChannel() && (this._channel._groupChannel = e._groupChannel);
  }, e.prototype._shouldStartBackgroundSync = function () {
    var e = _o.of(this._iid).cacheContext;
    return this.channel.isGroupChannel() ? e.localCacheEnabled && !this.channel.isSuper : e.localCacheEnabled;
  }, e.prototype._createChannelEventContext = function (e) {
    switch (!0) {
      case this.channel.isGroupChannel():
        return new hs(e);

      case this.channel.isFeedChannel():
        return new ds(e);

      default:
        throw new v$2({
          code: u$1.WRONG_CHANNEL_TYPE,
          message: "Wrong channel type"
        });
    }
  }, e.prototype._createMessageEventContext = function (e) {
    switch (!0) {
      case this.channel.isGroupChannel():
        return new ps(e);

      case this.channel.isFeedChannel():
        return new fs(e);

      default:
        throw new v$2({
          code: u$1.WRONG_CHANNEL_TYPE,
          message: "Wrong channel type"
        });
    }
  }, e.prototype._createChannelUpdateEventCommand = function (e) {
    switch (!0) {
      case this.channel.isGroupChannel():
        return new Jt({
          channels: [this._channel],
          source: e
        });

      case this.channel.isFeedChannel():
        return new ss({
          channels: [this._channel],
          source: e
        });

      default:
        return null;
    }
  }, e.prototype._setBaseMessageCollectionHandler = function (e) {
    this._handler = e;
  }, e.prototype._filterUnderOffsetMessage = function (e) {
    return e;
  }, e.prototype._addMessagesToView = function (e, t) {
    var n,
        s,
        r = this,
        a = this._filterUnderOffsetMessage(e),
        i = [],
        o = [];

    try {
      for (var u = s$2(a), c = u.next(); !c.done; c = u.next()) {
        var l = c.value;

        if (t === po.SYNC_MESSAGE_FILL) {
          if (l.messageId > 0) {
            if ((E = os(this._messages, l)) < 0) {
              os(this._unsentMessages, l) < 0 && i.push(l);
              var h = cs(this._messages, l);

              this._messages.splice(h, 0, l);
            }
          } else if (l instanceof De$2) {
            (E = os(this._unsentMessages, l)) < 0 && os(this._messages, l) < 0 && (this._unsentMessages.push(l), i.push(l));
          }
        } else if (l.messageId > 0) {
          if ((E = os(this._messages, l)) < 0) {
            var v = os(this._unsentMessages, l);
            v < 0 ? i.push(l) : (this._unsentMessages.splice(v, 1), o.push(l));
            h = cs(this._messages, l);

            this._messages.splice(h, 0, l);
          } else o.push(l), this._messages[E] = l;

          if (l.updatedAt > 0) {
            var g = this._updateChildMessagesInView(l);

            o.push.apply(o, c$1([], a$1(g), !1));
          }
        } else if (l instanceof De$2) {
          var E;
          (E = os(this._unsentMessages, l)) < 0 ? os(this._messages, l) < 0 && (this._unsentMessages.push(l), i.push(l)) : (o.push(l), this._unsentMessages[E] = l);
        }
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        c && !c.done && (s = u.return) && s.call(u);
      } finally {
        if (n) throw n.error;
      }
    }

    wo(t) && bi$1(function () {
      return i$1(r, void 0, void 0, function () {
        var e, n, s, r, a;
        return o$1(this, function (u) {
          return e = this._createMessageEventContext(t), i.length > 0 && (null === (s = null === (n = this._handler) || void 0 === n ? void 0 : n.onMessagesAdded) || void 0 === s || s.call(n, e, this.channel, i)), o.length > 0 && (null === (a = null === (r = this._handler) || void 0 === r ? void 0 : r.onMessagesUpdated) || void 0 === a || a.call(r, e, this.channel, o)), [2];
        });
      });
    });
  }, e.prototype._updateChildMessagesInView = function (e) {
    var t = [];
    return this._messages.forEach(function (n) {
      n.parentMessageId === e.messageId && n.applyParentMessage(e) && t.push(n);
    }), t;
  }, e.prototype._updatePollsToView = function (e, t) {
    var n,
        s,
        r = this,
        a = [];

    try {
      for (var i = s$2(e), o = i.next(); !o.done; o = i.next()) {
        var u = o.value,
            c = us(this._messages, u.messageId);

        if (c >= 0) {
          var l = this._messages[c];
          l && l.applyPoll(u), a.push(l);
        }
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        o && !o.done && (s = i.return) && s.call(i);
      } finally {
        if (n) throw n.error;
      }
    }

    return a.length > 0 && wo(t) && bi$1(function () {
      return i$1(r, void 0, void 0, function () {
        var e, n, s;
        return o$1(this, function (r) {
          return e = this._createMessageEventContext(t), a.length > 0 && (null === (s = (n = this._handler).onMessagesUpdated) || void 0 === s || s.call(n, e, this.channel, a)), [2];
        });
      });
    }), a;
  }, e.prototype._applyPollUpdateEventToView = function (e, t) {
    var n = this,
        s = us(this._messages, e.messageId);

    if (s >= 0) {
      var r = this._messages[s];
      r && r.isUserMessage() && r.poll && r.poll.applyPollUpdateEvent(e) && wo(t) && bi$1(function () {
        return i$1(n, void 0, void 0, function () {
          var e, n, s;
          return o$1(this, function (a) {
            return e = this._createMessageEventContext(t), null === (s = null === (n = this._handler) || void 0 === n ? void 0 : n.onMessagesUpdated) || void 0 === s || s.call(n, e, this.channel, [r]), [2];
          });
        });
      });
    }
  }, e.prototype._applyPollVoteEventToView = function (e, t) {
    var n = this,
        s = us(this._messages, e.messageId);

    if (s >= 0) {
      var r = this._messages[s];
      r && r.isUserMessage() && r.poll && r.poll.applyPollVoteEvent(e) && wo(t) && bi$1(function () {
        return i$1(n, void 0, void 0, function () {
          var e, n, s;
          return o$1(this, function (a) {
            return e = this._createMessageEventContext(t), null === (s = null === (n = this._handler) || void 0 === n ? void 0 : n.onMessagesUpdated) || void 0 === s || s.call(n, e, this.channel, [r]), [2];
          });
        });
      });
    }
  }, e.prototype._updateMessagesToView = function (e, t) {
    var n,
        s,
        r = this,
        a = [],
        i = [],
        o = [];

    try {
      for (var u = s$2(e), c = u.next(); !c.done; c = u.next()) {
        var l,
            h = c.value;
        if (h.messageId > 0) {
          if ((l = os(this._messages, h)) >= 0) i.push(h), this._messages[l] = h;else {
            var v = os(this._unsentMessages, h);

            if (v >= 0) {
              var g = this._unsentMessages.splice(v, 1);

              if (this.hasNext && g.length > 0) o.push(g[0]);else {
                i.push(h);
                var E = cs(this._messages, h);

                this._messages.splice(E, 0, h);
              }
            } else {
              var C = this._messages.map(function (e) {
                return e.createdAt;
              });

              (h.createdAt < Math.min.apply(Math, c$1([], a$1(C), !1)) && !this._hasPrevious || h.createdAt > Math.max.apply(Math, c$1([], a$1(C), !1)) && !this._hasNext) && a.push(h);
            }
          }
        } else if (h instanceof De$2) (l = os(this._unsentMessages, h)) >= 0 && (i.push(h), this._unsentMessages[l] = h);
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        c && !c.done && (s = u.return) && s.call(u);
      } finally {
        if (n) throw n.error;
      }
    }

    return wo(t) && bi$1(function () {
      return i$1(r, void 0, void 0, function () {
        var e, n, s, r, u;
        return o$1(this, function (c) {
          return e = this._createMessageEventContext(t), i.length > 0 ? null === (s = null === (n = this._handler) || void 0 === n ? void 0 : n.onMessagesUpdated) || void 0 === s || s.call(n, e, this.channel, i) : o.length > 0 ? null === (u = null === (r = this._handler) || void 0 === r ? void 0 : r.onMessagesDeleted) || void 0 === u || u.call(r, e, this.channel, [], o) : a.length > 0 && this._addMessagesToView(a, t), [2];
        });
      });
    }), i;
  }, e.prototype._removeMessagesFromView = function (e, t) {
    var n,
        s,
        r = this,
        a = [],
        i = [],
        o = function (e) {
      var t = u._messages.findIndex(function (t) {
        return t.messageId === e;
      });

      if (t >= 0) {
        var n = u._messages[t];
        a.push(n.messageId), i.push(n), u._messages.splice(t, 1);
      }
    },
        u = this;

    try {
      for (var c = s$2(e), l = c.next(); !l.done; l = c.next()) {
        o(l.value);
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        l && !l.done && (s = c.return) && s.call(c);
      } finally {
        if (n) throw n.error;
      }
    }

    return wo(t) && i.length > 0 && bi$1(function () {
      return i$1(r, void 0, void 0, function () {
        var e, n, s;
        return o$1(this, function (r) {
          return e = this._createMessageEventContext(t), null === (s = null === (n = this._handler) || void 0 === n ? void 0 : n.onMessagesDeleted) || void 0 === s || s.call(n, e, this.channel, a, i), [2];
        });
      });
    }), a;
  }, e.prototype._removeUnsentMessageFromView = function (e, t) {
    var n = this._unsentMessages.findIndex(function (t) {
      return t.reqId === e;
    });

    n >= 0 && this._unsentMessages.splice(n, 1);
  }, e.prototype._getLocalMessages = function (e, t) {
    var n = t.prevLimit,
        s = void 0 === n ? 0 : n,
        r = t.nextLimit,
        a = void 0 === r ? 0 : r,
        i = t.inclusive,
        o = void 0 === i || i;
    return i$1(this, void 0, void 0, function () {
      var t, n, r, i, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return t = [], o ? [4, this._channelManager.getExactlyMatchingMessagesForTokenFromCache(this._channel.url, e, this.filter)] : [3, 2];

          case 1:
            t = c.sent(), c.label = 2;

          case 2:
            return s > 0 ? [4, this._channelManager.getMessagesFromCache(this._channel.url, e, "prev", this.filter, s, !1)] : [3, 4];

          case 3:
            return r = c.sent(), [3, 5];

          case 4:
            r = [], c.label = 5;

          case 5:
            return n = r, a > 0 ? [4, this._channelManager.getMessagesFromCache(this._channel.url, e, "next", this.filter, a, !1)] : [3, 7];

          case 6:
            return u = c.sent(), [3, 8];

          case 7:
            u = [], c.label = 8;

          case 8:
            return i = u, [2, c$1(c$1(c$1([], a$1(t), !1), a$1(n), !1), a$1(i), !1).sort(function (e, t) {
              return t.createdAt - e.createdAt;
            })];
        }
      });
    });
  }, e.prototype._getRemoteMessages = function (e, t) {
    var r = t.prevLimit,
        a = void 0 === r ? 0 : r,
        i = t.nextLimit,
        o = void 0 === i ? 0 : i,
        u = t.source,
        c = void 0 === u ? po.REQUEST_MESSAGE : u,
        l = t.reverse,
        h = void 0 !== l && l,
        d = t.checkingContinuousMessages,
        _ = void 0 !== d && d;

    return i$1(this, void 0, void 0, function () {
      var t, r;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return t = Zi.of(this._iid), a > 0 || o > 0 ? [4, t._getMessagesByTimestampForCollection(this._channel.url, this._channel.channelType, e, $(n$1(n$1(n$1({}, this.filter), vs), {
              isInclusive: !0,
              reverse: h,
              prevResultSize: a,
              nextResultSize: o
            })), c, _)] : [3, 2];

          case 1:
            return r = i.sent(), [3, 3];

          case 2:
            r = {
              messages: [],
              isContinuousMessages: !1
            }, i.label = 3;

          case 3:
            return [2, r];
        }
      });
    });
  }, e.prototype._checkHugeGap = function () {
    var e;
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          r,
          a,
          i,
          o,
          u,
          c,
          l,
          m,
          v,
          g,
          E,
          C,
          M,
          b,
          N,
          U,
          S,
          T = this;
      return o$1(this, function (A) {
        switch (A.label) {
          case 0:
            return this._messages.length > 0 ? (t = this._syncRange.top, n = this.viewTop, r = this._syncRange.bottom, a = this.hasNext ? this.viewBottom : Number.MAX_SAFE_INTEGER, [4, this._channelManager.getCachedMessageCountBetween(this._channel.url, this.filter, n, t)]) : [3, 4];

          case 1:
            return i = A.sent(), [4, this._channelManager.getCachedMessageCountBetween(this._channel.url, this.filter, r, a)];

          case 2:
            return o = A.sent(), [4, vi$1(function () {
              return i$1(T, void 0, void 0, function () {
                var e,
                    u,
                    c,
                    l,
                    h,
                    m,
                    v,
                    g,
                    E,
                    C,
                    M,
                    b,
                    N,
                    U,
                    S,
                    T,
                    A,
                    I,
                    w,
                    D,
                    L,
                    R = this;
                return o$1(this, function (P) {
                  switch (P.label) {
                    case 0:
                      return e = _o.of(this._iid), u = e.dispatcher, c = e.requestQueue, l = e.cacheContext, h = new as(n$1(n$1({
                        channelUrl: this._channel.url,
                        channelType: this._channel.channelType,
                        prevStart: n,
                        prevEnd: t,
                        prevCount: i,
                        nextStart: r,
                        nextEnd: a,
                        nextCount: o,
                        checkingContinuousMessages: l.localCacheEnabled
                      }, this.filter), vs)), [4, c.send(h)];

                    case 1:
                      return m = P.sent(), v = m.as(is), g = v.isHugeGap, E = v.prevMessages, C = void 0 === E ? [] : E, M = v.prevHasMore, b = v.isContinuousPrevMessages, N = v.nextMessages, U = void 0 === N ? [] : N, S = v.nextHasmore, T = v.isContinuousNextMessages, g ? bi$1(function () {
                        return i$1(R, void 0, void 0, function () {
                          var e;
                          return o$1(this, function (t) {
                            return (null === (e = this._handler) || void 0 === e ? void 0 : e.onHugeGapDetected) && this._handler.onHugeGapDetected(), [2];
                          });
                        });
                      }) : (A = this.viewTop, I = this.viewBottom, w = Math.min.apply(Math, c$1([Number.MAX_SAFE_INTEGER, A], a$1(C.map(function (e) {
                        return e.createdAt;
                      })), !1)), D = Math.max.apply(Math, c$1([0, I], a$1(U.map(function (e) {
                        return e.createdAt;
                      })), !1)), u.dispatch(new No({
                        messages: C,
                        source: po.SYNC_MESSAGE_FILL
                      })), u.dispatch(new No({
                        messages: U,
                        source: po.SYNC_MESSAGE_FILL
                      })), this._syncRange.extends(w, D), (b || T) && (null === (L = this._backgroundSync) || void 0 === L || L.range.extends(w, D)), M && this._prevFill.start(w), S && this._nextFill.start(D)), [2];
                  }
                });
              });
            }, 1)];

          case 3:
            return A.sent(), [3, 8];

          case 4:
            u = _o.of(this._iid).cacheContext, c = Math.floor(this._limit / 2), l = Date.now(), A.label = 5;

          case 5:
            return A.trys.push([5, 7,, 8]), [4, this._getRemoteMessages(l, {
              prevLimit: c,
              nextLimit: c,
              source: po.SYNC_MESSAGE_FILL,
              checkingContinuousMessages: u.localCacheEnabled
            })];

          case 6:
            if (m = A.sent(), v = m.messages, g = m.isContinuousMessages, v.length > 0) {
              for (E = v.map(function (e) {
                return e.createdAt;
              }), C = 0, M = 0, b = 0; b < E.length; b++) (N = E[b]) <= l ? C++ : N >= l && M++;

              this._hasPrevious = C >= c, this._hasNext = M >= c, (S = this._syncRange).extends.apply(S, c$1([], a$1(E), !1)), g && (null === (e = this._backgroundSync) || void 0 === e || e.range.extends(this._syncRange.top, this._syncRange.bottom)), this._addMessagesToView(v, po.SYNC_MESSAGE_FILL);
            } else this._hasPrevious = !1, this._hasNext = !1;

            return [3, 8];

          case 7:
            return (U = A.sent()) instanceof v$2 && U.code === u$1.NOT_FOUND_IN_DATABASE && (this._hasPrevious = !1, this._hasNext = !1), [3, 8];

          case 8:
            return [2];
        }
      });
    });
  }, e.prototype._loadUnsentMessages = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return e = this, [4, this._channelManager.getUnsentMessagesFromCache(this._channel.url, this.filter)];

          case 1:
            return e._unsentMessages = t.sent(), [2];
        }
      });
    });
  }, e.prototype._hasPollMessage = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, this._channelManager.getPollMessagesFromCache(this._channel.url, Date.now() + ms, this.filter, 1)];

          case 1:
            return e.sent().length > 0 ? [2, !0] : [2, !1];
        }
      });
    });
  }, e.prototype._refreshChannel = function (e) {
    this._channelManager.refreshChannel(this.channel.url, !0, e);
  }, e.prototype._startCheckMyMutedTimer = function (e) {
    var t = this;
    this._clearCheckMyMutedTimer(), this._checkMyMutedStateTimer = setTimeout(function () {
      return i$1(t, void 0, void 0, function () {
        var e,
            t,
            n = this;
        return o$1(this, function (s) {
          switch (s.label) {
            case 0:
              this._checkMyMutedStateTimer = void 0, e = !0, s.label = 1;

            case 1:
              return s.trys.push([1, 3, 4, 5]), [4, this._channel.getMyMutedInfo()];

            case 2:
              return t = s.sent(), e = !t.isMuted, [3, 5];

            case 3:
              return s.sent(), e = !0, [3, 5];

            case 4:
              return e && this.channel._runIfHandleableWithGroupChannel(function (e) {
                var t, s;
                e.myMutedState = M$1.UNMUTED;

                var r = n._createChannelEventContext(po.EVENT_CHANNEL_UNMUTED);

                null === (s = null === (t = n._handler) || void 0 === t ? void 0 : t.onChannelUpdated) || void 0 === s || s.call(t, r, n.channel);
              }), [7];

            case 5:
              return [2];
          }
        });
      });
    }, e + 1e3);
  }, e.prototype._clearCheckMyMutedTimer = function () {
    this._checkMyMutedStateTimer && (clearTimeout(this._checkMyMutedStateTimer), this._checkMyMutedStateTimer = void 0);
  }, e.prototype.initialize = function (e) {
    var t = this,
        n = new ys();
    this._messages = [], this._unsentMessages = [], this._syncRange = new H({}), this._hasNext = !0, this._hasPrevious = !0, this._refreshChannel(po.REFRESH_CHANNEL), mi$1(function () {
      return i$1(t, void 0, void 0, function () {
        var e;
        return o$1(this, function (t) {
          switch (t.label) {
            case 0:
              return [4, this.channel.getMyMutedInfo()];

            case 1:
              return (e = t.sent()).isMuted && -1 !== e.remainingDuration && this._startCheckMyMutedTimer(e.remainingDuration), [2];
          }
        });
      });
    });
    var s = Math.floor(this._limit / 2);
    if (e === Kn.CACHE_AND_REPLACE_BY_API) this._getLocalMessages(this._startingPoint, {
      prevLimit: s,
      nextLimit: s
    }).then(function (e) {
      return i$1(t, void 0, void 0, function () {
        var t;
        return o$1(this, function (s) {
          switch (s.label) {
            case 0:
              return t = this._filterUnderOffsetMessage(e), this._addMessagesToView(t, po.REQUEST_MESSAGE), [4, this._loadUnsentMessages()];

            case 1:
              return s.sent(), n._invokeResponse("local", null, t), [2];
          }
        });
      });
    }).catch(function (e) {
      if (g$2(e)) throw e;

      n._invokeResponse("local", e, null);
    }).finally(function () {
      var e = _o.of(t._iid).cacheContext;

      t._getRemoteMessages(t._startingPoint, {
        prevLimit: s,
        nextLimit: s,
        reverse: !0,
        checkingContinuousMessages: e.localCacheEnabled
      }).then(function (e) {
        var r,
            a,
            i = e.messages,
            o = e.isContinuousMessages;
        t._messages = [];

        var u = t._filterUnderOffsetMessage(i);

        if (u.length > 0) {
          for (var c = u.map(function (e) {
            return e.createdAt;
          }), l = 0, h = 0, p = 0; p < c.length; p++) {
            var f = c[p];
            f < t._startingPoint ? l++ : f > t._startingPoint && h++;
          }

          t._hasPrevious = l >= s, t._hasNext = h >= s, (r = t._syncRange).extends.apply(r, c$1([], a$1(u.map(function (e) {
            return e.createdAt;
          })), !1)), o && (null === (a = t._backgroundSync) || void 0 === a || a.range.extends(t._syncRange.top, t._syncRange.bottom)), t._addMessagesToView(u, po.REQUEST_MESSAGE);
        } else t._hasPrevious = !1, t._hasNext = !1;

        n._invokeResponse("remote", null, u);
      }).catch(function (e) {
        if (g$2(e)) throw e;

        n._invokeResponse("remote", e, null);
      });
    });
    var r = _o.of(this._iid),
        a = r.cacheContext;
    return r.statLogCollector.put(new io({
      type: we$2.FEATURE_LOCALCACHE,
      data: {
        use_local_cache: a.localCacheEnabled,
        collection_interface: {
          message_init_policy: e
        }
      }
    })), n;
  }, e.prototype.loadPrevious = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t,
          n,
          s = this;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            if (this._isDisposed) throw new v$2({
              code: u$1.COLLECTION_DISPOSED,
              message: "Collection has been disposed."
            });
            return this._hasPrevious ? (e = Math.floor(this._limit / 2), t = this.viewTop, n = [], [4, mi$1(function () {
              return i$1(s, void 0, void 0, function () {
                var s;
                return o$1(this, function (r) {
                  switch (r.label) {
                    case 0:
                      return s = this._filterUnderOffsetMessage, [4, this._getLocalMessages(t, {
                        prevLimit: e,
                        inclusive: !1
                      })];

                    case 1:
                      return n = s.apply(this, [r.sent()]), [2];
                  }
                });
              });
            })]) : [2, []];

          case 1:
            return r.sent(), n.length < e || !this._backgroundSync || !this._backgroundSync.isWrappingMessages(n) ? [4, mi$1(function () {
              return i$1(s, void 0, void 0, function () {
                var s,
                    r,
                    a,
                    i,
                    o,
                    u = this;
                return o$1(this, function (c) {
                  switch (c.label) {
                    case 0:
                      return s = _o.of(this._iid).cacheContext, [4, this._getRemoteMessages(t, {
                        prevLimit: e,
                        reverse: !0,
                        checkingContinuousMessages: s.localCacheEnabled
                      })];

                    case 1:
                      return r = c.sent(), n = (n = this._filterUnderOffsetMessage(r.messages)).filter(function (e) {
                        return os(u._messages, e) < 0;
                      }), this._hasPrevious = n.length >= e, n.length > 0 && ((a = this._syncRange).extends.apply(a, c$1([], a$1(n.map(function (e) {
                        return e.createdAt;
                      })), !1)), (null === (i = this._backgroundSync) || void 0 === i ? void 0 : i.range.overlap(this._syncRange)) && r.isContinuousMessages && (null === (o = this._backgroundSync) || void 0 === o || o.range.extends(this._syncRange.top))), [2];
                  }
                });
              });
            })] : [3, 3];

          case 2:
            return r.sent(), this._addMessagesToView(n, po.REQUEST_MESSAGE), [3, 4];

          case 3:
            this._hasPrevious = n.length >= e, n.length > 0 && this._addMessagesToView(n, po.REQUEST_MESSAGE), r.label = 4;

          case 4:
            return [2, n];
        }
      });
    });
  }, e.prototype.loadNext = function () {
    var e;
    return i$1(this, void 0, void 0, function () {
      var t,
          n,
          s,
          r = this;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            if (this._isDisposed) throw new v$2({
              code: u$1.COLLECTION_DISPOSED,
              message: "Collection has been disposed."
            });
            return this._hasNext ? (t = Math.floor(this._limit / 2), n = this.viewBottom, s = [], [4, mi$1(function () {
              return i$1(r, void 0, void 0, function () {
                var e;
                return o$1(this, function (r) {
                  switch (r.label) {
                    case 0:
                      return e = this._filterUnderOffsetMessage, [4, this._getLocalMessages(n, {
                        nextLimit: t,
                        inclusive: !1
                      })];

                    case 1:
                      return s = e.apply(this, [r.sent()]), [2];
                  }
                });
              });
            })]) : [2, []];

          case 1:
            return a.sent(), s.length < t || !(null === (e = this._backgroundSync) || void 0 === e ? void 0 : e.isWrappingMessages(s)) ? [4, mi$1(function () {
              return i$1(r, void 0, void 0, function () {
                var e,
                    r,
                    a,
                    i,
                    o,
                    u = this;
                return o$1(this, function (c) {
                  switch (c.label) {
                    case 0:
                      return e = _o.of(this._iid).cacheContext, [4, this._getRemoteMessages(n, {
                        nextLimit: t,
                        reverse: !0,
                        checkingContinuousMessages: e.localCacheEnabled
                      })];

                    case 1:
                      return r = c.sent(), s = (s = this._filterUnderOffsetMessage(r.messages)).filter(function (e) {
                        return os(u._messages, e) < 0;
                      }), this._hasNext = s.length >= t, s.length > 0 && ((a = this._syncRange).extends.apply(a, c$1([], a$1(s.map(function (e) {
                        return e.createdAt;
                      })), !1)), (null === (i = this._backgroundSync) || void 0 === i ? void 0 : i.range.overlap(this._syncRange)) && r.isContinuousMessages && (null === (o = this._backgroundSync) || void 0 === o || o.range.extends(this._syncRange.bottom))), [2];
                  }
                });
              });
            })] : [3, 3];

          case 2:
            return a.sent(), this._addMessagesToView(s, po.REQUEST_MESSAGE), [3, 4];

          case 3:
            this._hasNext = s.length >= t, s.length > 0 && this._addMessagesToView(s, po.REQUEST_MESSAGE), a.label = 4;

          case 4:
            return [2, s];
        }
      });
    });
  }, e.prototype.removeFailedMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            if (this._isDisposed) throw new v$2({
              code: u$1.COLLECTION_DISPOSED,
              message: "Collection has been disposed."
            });
            return [4, this._channelManager.removeFailedMessageFromCache(e)];

          case 1:
            return n.sent(), (t = this._unsentMessages.findIndex(function (t) {
              return t.reqId === e;
            })) > -1 && this._unsentMessages.splice(t, 1), [2];
        }
      });
    });
  }, e.prototype.dispose = function () {
    var e, t, n;

    if (!this._isDisposed) {
      this._isDisposed = !0;
      var s = _o.of(this._iid),
          r = s.cacheContext,
          a = s.dispatcher;
      this._messages = [], this._clearCheckMyMutedTimer(), this._channel._updateMessageCollectionLastAccessedAt();

      var i = this._createChannelUpdateEventCommand(po.CHANNEL_LASTACCESSEDAT_UPDATED);

      i && a.dispatch(i), r.localCacheEnabled && (this._prevFill.stop(), this._nextFill.stop()), null === (e = this._backgroundSync) || void 0 === e || e.close(), null === (t = this._changelogSync) || void 0 === t || t.close(), null === (n = this._pollChangelogSync) || void 0 === n || n.close(), this._channelManager.unsubscribeChannelEvent(this._key), this._channelManager.unsubscribeMessageEvent(this._key), this._connectionEventContext && this._connectionEventContext.close();
    }
  }, e;
}(),
    bs = function (t) {
  function n(e, n) {
    return t.call(this, e, n$1(n$1({}, n), {
      channelManager: Yn.of(e)
    })) || this;
  }

  return t$1(n, t), n.prototype.setMessageCollectionHandler = function (e) {
    this._setBaseMessageCollectionHandler(e);
  }, n;
}(Ms),
    Ns = {
  coverUrl: void 0,
  coverImage: void 0,
  isDistinct: void 0,
  isPublic: void 0,
  isDiscoverable: void 0,
  accessCode: void 0,
  name: void 0,
  data: void 0,
  customType: void 0,
  operatorUserIds: void 0,
  messageSurvivalSeconds: void 0
},
    Us = function (t) {
  function n(e) {
    var n = this,
        s = e.channelUrl,
        r = e.token,
        a = e.limit,
        i = e.order,
        o = e.mutedMemberFilter,
        u = e.memberStateFilter,
        c = e.nicknameStartsWithFilter,
        l = e.operatorFilter;
    return (n = t.call(this) || this).method = ee.GET, n.path = "".concat(ie, "/").concat(encodeURIComponent(s), "/members"), n.params = {
      token: r,
      limit: a,
      order: i,
      muted_member_filter: o,
      member_state_filter: u,
      nickname_startswith: c,
      operator_filter: l,
      show_member_is_muted: !0,
      show_read_receipt: !0,
      show_delivery_receipt: !0
    }, n;
  }

  return t$1(n, t), n;
}(Ne$2),
    Ss = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    s.members = [];
    var r = n.next,
        a = n.members;
    return s.token = r, a && a.length > 0 && (s.members = a.map(function (t) {
      return new Rt(e, t);
    })), s;
  }

  return t$1(n, t), n;
}(Te$2);

!function (e) {
  e.ALL = "all", e.MUTED = "muted", e.UNMUTED = "unmuted";
}(gs || (gs = {})), function (e) {
  e.MEMBER_NICKNAME_ALPHABETICAL = "member_nickname_alphabetical", e.OPERATOR_THEN_MEMBER_ALPHABETICAL = "operator_then_member_alphabetical";
}(Es || (Es = {})), function (e) {
  e.ALL = "all", e.JOINED = "joined_only", e.INVITED = "invited_only", e.INVITED_BY_FRIEND = "invited_by_friend", e.INVITED_BY_NON_FRIEND = "invited_by_non_friend";
}(Cs || (Cs = {}));

var Ts = function (t) {
  function a(e, n, s) {
    var r,
        a,
        o,
        u,
        c = this;
    return (c = t.call(this, e, n, x.GROUP, s) || this).mutedMemberFilter = gs.ALL, c.memberStateFilter = Cs.ALL, c.nicknameStartsWithFilter = null, c.operatorFilter = wt.ALL, c.order = Es.MEMBER_NICKNAME_ALPHABETICAL, c.mutedMemberFilter = null !== (r = s.mutedMemberFilter) && void 0 !== r ? r : gs.ALL, c.memberStateFilter = null !== (a = s.memberStateFilter) && void 0 !== a ? a : Cs.ALL, c.nicknameStartsWithFilter = null !== (o = s.nicknameStartsWithFilter) && void 0 !== o ? o : null, c.order = null !== (u = s.order) && void 0 !== u ? u : Es.MEMBER_NICKNAME_ALPHABETICAL, c;
  }

  return t$1(a, t), a.prototype._validate = function () {
    return t.prototype._validate.call(this) && N$1(gs, this.mutedMemberFilter) && N$1(Cs, this.memberStateFilter) && (w$1("string", this.nicknameStartsWithFilter) || null === this.nicknameStartsWithFilter) && N$1(wt, this.operatorFilter) && N$1(Es, this.order);
  }, a.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, r, a, i, o;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, t = new Us($(n$1(n$1({}, this), {
              token: this._token
            }))), [4, e.send(t)]) : [3, 2] : [3, 5];

          case 1:
            return r = u.sent(), a = r.as(Ss), i = a.members, o = a.token, this._token = o, this._hasNext = !!o, this._isLoading = !1, [2, i];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, a;
}(Io),
    As = function (t) {
  function n(e) {
    var n = this,
        s = e.channelUrl,
        r = e.userId,
        a = e.accessCode;
    return (n = t.call(this) || this).method = ee.PUT, n.path = "".concat(ie, "/").concat(encodeURIComponent(s), "/accept"), n.params = {
      user_id: r,
      access_code: a
    }, n;
  }

  return t$1(n, t), n;
}(Ne$2),
    Is = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.channel = new sr(e, n), s.channel.myMemberState = Nt.JOINED, s;
  }

  return t$1(n, t), n;
}(Te$2),
    ws = function (n) {
  function s(e) {
    var s = this,
        r = e.channelUrl,
        a = e.isDistinct,
        i = e.isPublic,
        o = e.isDiscoverable,
        u = e.coverUrl,
        c = e.coverImage,
        l = e.accessCode,
        h = e.name,
        d = e.data,
        _ = e.customType,
        p = e.operatorUserIds,
        f = e.messageSurvivalSeconds;
    return (s = n.call(this) || this).method = ee.PUT, s.path = "".concat(ie, "/").concat(encodeURIComponent(r)), s.params = J({
      is_distinct: a,
      is_public: i,
      is_discoverable: o,
      name: h,
      data: d,
      custom_type: _,
      cover_url: u,
      cover_file: c,
      access_code: l,
      operator_ids: p,
      message_survival_seconds: f
    }), s;
  }

  return t$1(s, n), s;
}(Ne$2),
    Ds = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.channel = new sr(e, n), s;
  }

  return t$1(n, t), n;
}(Te$2),
    Ls = function (t) {
  function n(e) {
    var n = this,
        s = e.channelUrl;
    return (n = t.call(this) || this).method = ee.DELETE, n.path = "".concat(ie, "/").concat(encodeURIComponent(s)), n;
  }

  return t$1(n, t), n;
}(Ne$2);

!function (t) {
  function n(e, n) {
    return t.call(this, e, n) || this;
  }

  t$1(n, t);
}(Te$2);

var Rs = function (t) {
  function n(e) {
    var n = this,
        s = e.channelUrl;
    return (n = t.call(this) || this).method = ee.DELETE, n.path = "".concat(ie, "/").concat(encodeURIComponent(s), "/hide"), n;
  }

  return t$1(n, t), n;
}(Ne$2);

!function (t) {
  function n() {
    return null !== t && t.apply(this, arguments) || this;
  }

  t$1(n, t);
}(Te$2);

var Ps = function (t) {
  function n(e) {
    var n = e.userId,
        s = e.channelUrl,
        r = e.countPreference,
        a = t.call(this) || this;
    return a.method = ee.PUT, a.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/count_preference/").concat(encodeURIComponent(s)), a.params = {
      count_preference: r
    }, a;
  }

  return t$1(n, t), n;
}(Ne$2),
    ks = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.countPreference = n.count_preference, s;
  }

  return t$1(n, t), n;
}(Te$2),
    Os = function (t) {
  function n(e) {
    var n = this,
        s = e.channelUrl;
    return (n = t.call(this) || this).method = ee.PUT, n.path = "".concat(ie, "/").concat(encodeURIComponent(s), "/reset_user_history"), n;
  }

  return t$1(n, t), n;
}(Ne$2),
    Fs = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this,
        r = n.ts_message_offset;
    return s.messageOffsetTimestamp = r, s;
  }

  return t$1(n, t), n;
}(Te$2),
    xs = n$1(n$1({}, Ct$1), {
  scheduledAt: void 0,
  file: void 0,
  fileUrl: void 0,
  fileName: void 0,
  mimeType: void 0,
  fileSize: void 0,
  thumbnailSizes: void 0,
  requireAuth: !1
}),
    Hs = n$1(n$1({}, kt$2), {
  scheduledAt: void 0
}),
    Gs = function (s) {
  function r(e) {
    var r,
        a = this;
    a = s.call(this) || this;
    var i = [];
    e.mentionType === H$1.USERS && (e.mentionedUserIds ? i = e.mentionedUserIds : e.mentionedUsers && (i = e.mentionedUsers.map(function (e) {
      return e.userId;
    })));
    var o = e.channelType,
        u = e.channelUrl,
        c = e.scheduledMessageId;
    return a.method = ee.PUT, a.path = "".concat(ge$1(o), "/").concat(encodeURIComponent(u), "/scheduled_messages/").concat(encodeURIComponent(c)), a.params = J($({
      req_id: e.reqId,
      scheduled_at: e.scheduledAt,
      message_type: F.FILE,
      url: e.fileUrl,
      file_name: e.fileName,
      file_size: e.fileSize,
      file_type: e.mimeType,
      thumbnails: e.thumbnailSizes ? e.thumbnailSizes.map(function (e) {
        return qe$1.payloadify(e);
      }) : [],
      custom_type: e.customType,
      data: e.data,
      require_auth: e.requireAuth,
      mention_type: e.mentionType,
      mentioned_user_ids: i,
      sorted_metaarray: null === (r = e.metaArrays) || void 0 === r ? void 0 : r.map(function (e) {
        return Oe$2.payloadify(e);
      }),
      apple_critical_alert_options: e.appleCriticalAlertOptions ? ke.payloadify(e.appleCriticalAlertOptions) : null,
      push_option: e.pushNotificationDeliveryOption
    })), a;
  }

  return t$1(r, s), r;
}(Ne$2),
    Vs = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.message = new He$2(e, n), s;
  }

  return t$1(n, t), n;
}(Te$2),
    Bs = function (s) {
  function r(e) {
    var r,
        a = this;
    a = s.call(this) || this;
    var i = [];
    e.mentionType === H$1.USERS && (e.mentionedUserIds ? i = e.mentionedUserIds : e.mentionedUsers && (i = e.mentionedUsers.map(function (e) {
      return e.userId;
    })));
    var o = e.channelType,
        u = e.channelUrl,
        c = e.scheduledMessageId;
    return a.method = ee.PUT, a.path = "".concat(ge$1(o), "/").concat(encodeURIComponent(u), "/scheduled_messages/").concat(encodeURIComponent(c)), a.params = J($({
      req_id: e.reqId,
      scheduled_at: e.scheduledAt,
      message_type: F.USER,
      message: e.message,
      custom_type: e.customType,
      data: e.data,
      mention_type: e.mentionType,
      mentioned_user_ids: i,
      sorted_metaarray: null === (r = e.metaArrays) || void 0 === r ? void 0 : r.map(function (e) {
        return Oe$2.payloadify(e);
      }),
      apple_critical_alert_options: e.appleCriticalAlertOptions ? ke.payloadify(e.appleCriticalAlertOptions) : null,
      target_langs: e.translationTargetLanguages,
      push_option: e.pushNotificationDeliveryOption
    })), a;
  }

  return t$1(r, s), r;
}(Ne$2);

!function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.message = new je$1(e, n), s;
  }

  t$1(n, t);
}(Te$2);

var qs = function (t) {
  function n(e) {
    var n = t.call(this) || this,
        s = e.channelType,
        r = e.channelUrl,
        a = e.scheduledMessageId;
    return n.method = ee.DELETE, n.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(r), "/scheduled_messages/").concat(encodeURIComponent(a)), n;
  }

  return t$1(n, t), n;
}(Ne$2),
    Ws = function (t) {
  function n(e) {
    var n = t.call(this) || this,
        s = e.channelType,
        r = e.channelUrl,
        a = e.scheduledMessageId;
    return n.method = ee.POST, n.path = "".concat(ge$1(s), "/").concat(encodeURIComponent(r), "/scheduled_messages/").concat(encodeURIComponent(a), "/send_now"), n;
  }

  return t$1(n, t), n;
}(Ne$2),
    js = function (t) {
  function n(e) {
    var n = e.userId,
        s = e.channelUrl,
        r = e.pushTriggerOption,
        a = t.call(this) || this;
    return a.method = ee.PUT, a.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push_preference/").concat(encodeURIComponent(s)), a.params = {
      push_trigger_option: r
    }, a;
  }

  return t$1(n, t), n;
}(Ne$2),
    zs = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.pushTriggerOption = n.push_trigger_option, s.enabled = n.enable, s;
  }

  return t$1(n, t), n;
}(Te$2),
    Qs = function (t) {
  function n(e) {
    var n = e.userId,
        s = e.channelUrl,
        r = t.call(this) || this;
    return r.method = ee.GET, r.path = "".concat(ne, "/").concat(encodeURIComponent(n), "/push_preference/").concat(encodeURIComponent(s)), r;
  }

  return t$1(n, t), n;
}(Ne$2),
    Ys = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this;
    return s.pushTriggerOption = n.push_trigger_option, s.enabled = n.enable, s;
  }

  return t$1(n, t), n;
}(Te$2),
    Ks = function (t) {
  function n(e) {
    var n = e.channelType,
        s = e.channelUrl,
        r = e.messageId,
        a = t.call(this) || this;
    return a.method = ee.POST, a.path = "".concat(ge$1(n), "/").concat(encodeURIComponent(s), "/messages/").concat(r, "/pin"), a;
  }

  return t$1(n, t), n;
}(Ne$2);

!function (t) {
  function n(e, n) {
    return t.call(this, e, n) || this;
  }

  t$1(n, t);
}(Te$2);

var Js = function (t) {
  function n(e) {
    var n = e.channelType,
        s = e.channelUrl,
        r = e.messageId,
        a = t.call(this) || this;
    return a.method = ee.DELETE, a.path = "".concat(ge$1(n), "/").concat(encodeURIComponent(s), "/messages/").concat(r, "/pin"), a;
  }

  return t$1(n, t), n;
}(Ne$2);

!function (t) {
  function n(e, n) {
    return t.call(this, e, n) || this;
  }

  t$1(n, t);
}(Te$2);

var Xs,
    Zs,
    $s = function (t) {
  function n(e, n) {
    var s = t.call(this, e) || this;
    return s.message = We$1(e, n.message), s;
  }

  return t$1(n, t), n;
}(Fi$1),
    er = function (n) {
  function s(e) {
    var s = this,
        r = e.channelType,
        a = e.channelUrl,
        i = e.limit,
        o = e.token,
        u = e.includeReactions,
        c = e.includeMetaArray,
        l = e.includeParentMessageInfo,
        h = e.includeThreadInfo,
        d = e.includePollDetails;
    return (s = n.call(this) || this).method = ee.GET, s.path = "".concat(ge$1(r), "/").concat(encodeURIComponent(a), "/pinned_messages"), s.params = J({
      limit: i,
      token: o,
      include_reactions: u,
      with_sorted_meta_array: c,
      include_thread_info: h,
      include_parent_message_info: l,
      include_poll_details: d
    }), s;
  }

  return t$1(s, n), s;
}(Ne$2),
    tr = function (t) {
  function n(e, n) {
    var s = t.call(this, e, n) || this,
        r = n.pinned_messages,
        a = n.has_more,
        i = n.next;
    return s.pinnedMessages = r.map(function (t) {
      return new $s(e, t);
    }), s.hasMore = a, s.token = i, s;
  }

  return t$1(n, t), n;
}(Te$2),
    nr = function (t) {
  function n(e, n, s, r) {
    var a = t.call(this, e, n, s, r) || this;
    return a.includeMetaArray = r.includeMetaArray, a.includeReactions = r.includeReactions, a.includeParentMessageInfo = r.includeParentMessageInfo, a.includeThreadInfo = r.includeThreadInfo, a.includePollDetails = r.includePollDetails, a;
  }

  return t$1(n, t), n.prototype._validate = function () {
    return t.prototype._validate.call(this) && w$1("boolean", this.includeMetaArray, !0) && w$1("boolean", this.includeReactions, !0) && w$1("boolean", this.includeParentMessageInfo, !0) && w$1("boolean", this.includeThreadInfo, !0) && w$1("boolean", this.includePollDetails, !0);
  }, n.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, r, a, i, o;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, t = new er(n$1(n$1({}, this), {
              token: this._token
            })), [4, e.send(t)]) : [3, 2] : [3, 5];

          case 1:
            return n = u.sent(), r = n.as(tr), a = r.pinnedMessages, i = r.hasMore, o = r.token, this._token = o, this._hasNext = !!i, this._isLoading = !1, [2, a];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, n;
}(Io);

!function (e) {
  e.ALL = "all", e.UNREAD_MESSAGE_COUNT_ONLY = "unread_message_count_only", e.UNREAD_MENTION_COUNT_ONLY = "unread_mention_count_only", e.OFF = "off";
}(Xs || (Xs = {})), function (e) {
  e.UNHIDDEN = "unhidden", e.HIDDEN_ALLOW_AUTO_UNHIDE = "hidden_allow_auto_unhide", e.HIDDEN_PREVENT_AUTO_UNHIDE = "hidden_prevent_auto_unhide";
}(Zs || (Zs = {}));

var sr = function (u) {
  function c(e, t) {
    var n,
        c,
        l,
        h,
        p,
        f,
        m,
        v,
        E,
        C,
        y,
        M,
        b,
        N,
        U,
        S,
        T,
        A,
        I,
        w,
        D = this;
    return (D = u.call(this, e, t) || this)._unreadMemberStateMap = new Map(), D._undeliveredMemberStateMap = new Map(), D._typingStatus = new Map(), D._lastMemberCountUpdated = 0, D._typingStarted = 0, D._typingEnded = 0, D.isDistinct = !1, D.isSuper = !1, D.isBroadcast = !1, D.isExclusive = !1, D.isPublic = !1, D.isDiscoverable = !0, D.isChatNotification = !1, D.isAccessCodeRequired = !1, D.isPushEnabled = !1, D.unreadMessageCount = 0, D.unreadMentionCount = 0, D.members = [], D.memberCount = 0, D.joinedMemberCount = 0, D.hiddenState = Zs.UNHIDDEN, D.lastMessage = null, D.messageOffsetTimestamp = 0, D.messageSurvivalSeconds = -1, D.myMemberState = Nt.NONE, D.myRole = U$1.NONE, D.myMutedState = M$1.UNMUTED, D.myLastRead = 0, D.myCountPreference = Xs.ALL, D.myPushTriggerOption = _$1.DEFAULT, D.inviter = null, D.invitedAt = 0, D.joinedAt = 0, D.pinnedMessageIds = [], D.lastPinnedMessage = null, D._pinnedMessagesUpdatedAt = 0, D._myMutedRemainingTime = -1, D.channelType = x.GROUP, D.isDistinct = null !== (c = t.is_distinct) && void 0 !== c && c, D.isSuper = null !== (l = t.is_super) && void 0 !== l && l, D.isBroadcast = null !== (h = t.is_broadcast) && void 0 !== h && h, D.isExclusive = null !== (p = t.is_exclusive) && void 0 !== p && p, D.isPublic = null !== (f = t.is_public) && void 0 !== f && f, D.isDiscoverable = null !== (m = t.is_discoverable) && void 0 !== m ? m : D.isPublic, D.isChatNotification = null !== (v = t.is_chat_notification) && void 0 !== v && v, D.isAccessCodeRequired = null !== (E = t.is_access_code_required) && void 0 !== E && E, D.isPushEnabled = null !== (C = t.is_push_enabled) && void 0 !== C && C, Array.isArray(t.members) && (n = D.members).push.apply(n, c$1([], a$1(t.members.map(function (e) {
      return new Rt(D._iid, e);
    })), !1)), D.memberCount = null !== (y = t.member_count) && void 0 !== y ? y : 0, D.joinedMemberCount = null !== (M = t.joined_member_count) && void 0 !== M ? M : 0, D.hiddenState = N$1(Zs, t.hidden_state) ? t.hidden_state : Zs.UNHIDDEN, D.messageOffsetTimestamp = null !== (b = t.ts_message_offset) && void 0 !== b ? b : 0, D.messageSurvivalSeconds = null !== (N = t.message_survival_seconds) && void 0 !== N ? N : -1, D.lastMessage = t.last_message ? We$1(D._iid, n$1({
      channel_type: D.channelType
    }, t.last_message)) : null, t.read_receipt && Object.keys(t.read_receipt).forEach(function (e) {
      w$1("number", t.read_receipt[e]) && D._updateUnreadMemberState(e, t.read_receipt[e]);
    }), t.delivery_receipt && Object.keys(t.delivery_receipt).forEach(function (e) {
      w$1("number", t.delivery_receipt[e]) && D._updateUndeliveredMemberState(e, t.delivery_receipt[e]);
    }), D.myMemberState = N$1(Nt, t.member_state) ? t.member_state : Nt.NONE, D.myRole = N$1(U$1, t.my_role) ? t.my_role : U$1.NONE, N$1(M$1, t.is_muted) ? D.myMutedState = t.is_muted : w$1("boolean", t.is_muted) ? D.myMutedState = t.is_muted ? M$1.MUTED : M$1.UNMUTED : D.myMutedState = M$1.UNMUTED, D.myCountPreference = N$1(Xs, t.count_preference) ? t.count_preference : Xs.ALL, D.myPushTriggerOption = N$1(_$1, t.push_trigger_option) ? t.push_trigger_option : _$1.ALL, D.myLastRead = null !== (U = t.user_last_read) && void 0 !== U ? U : 0, D.inviter = t.inviter ? new Xi$1(D._iid, t.inviter) : null, D.invitedAt = null !== (S = t.invited_at) && void 0 !== S ? S : 0, D.joinedAt = null !== (T = t.joined_ts) && void 0 !== T ? T : 0, D._updateUnreadCount(null !== (A = t.unread_message_count) && void 0 !== A ? A : 0, null !== (I = t.unread_mention_count) && void 0 !== I ? I : 0), D.pinnedMessageIds = null !== (w = t.pinned_message_ids) && void 0 !== w ? w : [], D.lastPinnedMessage = t.latest_pinned_message ? We$1(D._iid, n$1({
      channel_type: D.channelType
    }, t.latest_pinned_message)) : null, D;
  }

  return t$1(c, u), Object.defineProperty(c.prototype, "isHidden", {
    get: function () {
      return this.hiddenState !== Zs.UNHIDDEN;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(c.prototype, "isTyping", {
    get: function () {
      return this._typingStatus.size > 0;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(c.prototype, "cachedUnreadMemberState", {
    get: function () {
      var e,
          t,
          n = {};

      try {
        for (var s = s$2(this._unreadMemberStateMap), r = s.next(); !r.done; r = s.next()) {
          var a = a$1(r.value, 2),
              i = a[0],
              o = a[1];

          n[i] = o;
        }
      } catch (t) {
        e = {
          error: t
        };
      } finally {
        try {
          r && !r.done && (t = s.return) && t.call(s);
        } finally {
          if (e) throw e.error;
        }
      }

      return n;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(c.prototype, "cachedUndeliveredMemberState", {
    get: function () {
      var e,
          t,
          n = {};

      try {
        for (var s = s$2(this._undeliveredMemberStateMap), r = s.next(); !r.done; r = s.next()) {
          var a = a$1(r.value, 2),
              i = a[0],
              o = a[1];

          n[i] = o;
        }
      } catch (t) {
        e = {
          error: t
        };
      } finally {
        try {
          r && !r.done && (t = s.return) && t.call(s);
        } finally {
          if (e) throw e.error;
        }
      }

      return n;
    },
    enumerable: !1,
    configurable: !0
  }), c.payloadify = function (e) {
    return J($(n$1(n$1({}, u.payloadify.call(this, e)), {
      is_access_code_required: e.isAccessCodeRequired,
      is_distinct: e.isDistinct,
      is_super: e.isSuper,
      is_broadcast: e.isBroadcast,
      is_exclusive: e.isExclusive,
      is_public: e.isPublic,
      is_discoverable: e.isDiscoverable,
      is_muted: e.myMutedState,
      is_push_enabled: e.isPushEnabled,
      unread_message_count: e.unreadMessageCount,
      unread_mention_count: e.unreadMentionCount,
      push_trigger_option: e.myPushTriggerOption,
      count_preference: e.myCountPreference,
      hidden_state: e.hiddenState,
      member_count: e.memberCount,
      joined_member_count: e.joinedMemberCount,
      member_state: e.myMemberState,
      my_role: e.myRole,
      user_last_read: e.myLastRead,
      ts_message_offset: e.messageOffsetTimestamp,
      message_survival_seconds: e.messageSurvivalSeconds,
      read_receipt: e.cachedUnreadMemberState,
      delivery_receipt: e.cachedUndeliveredMemberState,
      members: e.members.map(function (e) {
        return Rt.payloadify(e);
      }),
      last_message: e.lastMessage ? Ve$1(e.lastMessage) : null,
      inviter: e.inviter ? Xi$1.payloadify(e.inviter) : null,
      invited_at: e.invitedAt,
      joined_ts: e.joinedAt,
      pinned_message_ids: e.pinnedMessageIds,
      latest_pinned_message: e.lastPinnedMessage ? Ve$1(e.lastPinnedMessage) : null
    })));
  }, c.prototype._shouldUpdateLastMessageWith = function (e) {
    return !(e instanceof De$2 && e.parentMessageId > 0 && !e.replyToChannel) && (!this.lastMessage || this.lastMessage.createdAt < e.createdAt || this.lastMessage.createdAt === e.createdAt && this.lastMessage.messageId === e.messageId && this.lastMessage.updatedAt < e.updatedAt);
  }, c.prototype._updateUnreadCount = function (e, t) {
    if ("number" == typeof e && e >= 0) {
      if (this.myCountPreference === Xs.ALL || this.myCountPreference === Xs.UNREAD_MESSAGE_COUNT_ONLY) {
        if (this.isExclusive || this.isSuper || this.isBroadcast) {
          var n = _o.of(this._iid).maxSuperGroupChannelUnreadCount;
          this.unreadMessageCount = n && e >= n ? n : e;
        } else this.unreadMessageCount = e;
      } else this.unreadMessageCount = 0;
    } else this.unreadMessageCount = 0;
    "number" == typeof t && t >= 0 && (this.myCountPreference === Xs.ALL || this.myCountPreference === Xs.UNREAD_MENTION_COUNT_ONLY) ? this.unreadMentionCount = t : this.unreadMentionCount = 0;
  }, c.prototype._updateUnreadMemberState = function (e, t) {
    var n = this._unreadMemberStateMap.get(e);

    return (!n || n < t) && (this._unreadMemberStateMap.set(e, t), _o.of(this._iid).sdkState.userId === e && (this.myLastRead = t), !0);
  }, c.prototype._updateUndeliveredMemberState = function (e, t) {
    var n = this._undeliveredMemberStateMap.get(e);

    return (!n || n < t) && (this._undeliveredMemberStateMap.set(e, t), !0);
  }, c.prototype._updateTypingStatus = function (e, t) {
    void 0 === t && (t = new Date().getTime()), t > 0 ? this._typingStatus.set(e.userId, {
      user: e,
      ts: t
    }) : this._typingStatus.delete(e.userId);
  }, c.prototype._clearTypingStatus = function () {
    this._typingStatus.clear(), this._typingStarted = 0, this._typingEnded = 0;
  }, c.prototype._setLatestMemberCount = function (e, t, n) {
    var s = !1;
    return n >= this._lastMemberCountUpdated && (this._lastMemberCountUpdated = n, s = e !== this.memberCount || t !== this.joinedMemberCount, this.memberCount = e, this.joinedMemberCount = t), s;
  }, c.prototype.isReadMessage = function (e) {
    var t = _o.of(this._iid).sdkState,
        n = this._unreadMemberStateMap.get(t.userId);

    return !!n && n >= e.createdAt;
  }, c.prototype.serialize = function () {
    var e = this;
    return Zi$1(this, function (t) {
      t.cachedUnreadMemberState = e.cachedUnreadMemberState, t.cachedUndeliveredMemberState = e.cachedUndeliveredMemberState;
    });
  }, c.prototype.createMessageCollection = function (e) {
    return void 0 === e && (e = {}), new bs(this._iid, n$1(n$1({}, e), {
      channel: this
    }));
  }, c.prototype.createMemberListQuery = function (e) {
    return void 0 === e && (e = {}), new Ts(this._iid, this.url, e);
  }, c.prototype.createPinnedMessageListQuery = function (e) {
    return void 0 === e && (e = {}), new nr(this._iid, this.url, this.channelType, e);
  }, c.prototype.addMember = function (e, t) {
    if (void 0 === t && (t = 0), !this.isExclusive && !this.isSuper && !this.isBroadcast) {
      var n = this.members.findIndex(function (t) {
        return t.userId === e.userId;
      });

      if (n > -1) {
        var s = this.members[n];
        s.state === Nt.JOINED && (e.state = s.state), this.members.splice(n, 1), this.memberCount--;
      }

      this.members.push(e), this.memberCount++, this._updateUnreadMemberState(e.userId, t), this._updateUndeliveredMemberState(e.userId, t);
    }
  }, c.prototype.removeMember = function (e) {
    if (!this.isExclusive && !this.isSuper && !this.isBroadcast) {
      var t = e instanceof Rt ? e.userId : e,
          n = this.members.findIndex(function (e) {
        return e.userId === t;
      });
      if (n > -1) return this.members.splice(n, 1), this.memberCount--, !0;
    }

    return !1;
  }, c.prototype.getUnreadMemberCount = function (e) {
    var t, n;

    if (e instanceof De$2 && !this.isExclusive && !this.isSuper && !this.isBroadcast) {
      var s = _o.of(this._iid).sdkState,
          r = e.createdAt,
          a = 0;

      try {
        for (var i = s$2(this.members), o = i.next(); !o.done; o = i.next()) {
          var u = o.value;
          if (s.userId !== u.userId && u.state === Nt.JOINED && e.sender.userId !== u.userId) (this.cachedUnreadMemberState[u.userId] || 0) < r && a++;
        }
      } catch (e) {
        t = {
          error: e
        };
      } finally {
        try {
          o && !o.done && (n = i.return) && n.call(i);
        } finally {
          if (t) throw t.error;
        }
      }

      return a;
    }

    return 0;
  }, c.prototype.getUndeliveredMemberCount = function (e) {
    var t, n;

    if (e instanceof De$2 && !this.isExclusive && !this.isSuper && !this.isBroadcast) {
      var s = _o.of(this._iid).sdkState,
          r = e.createdAt,
          a = 0;

      try {
        for (var i = s$2(this.members), o = i.next(); !o.done; o = i.next()) {
          var u = o.value;
          if (s.userId !== u.userId && u.state === Nt.JOINED && e.sender.userId !== u.userId) (this.cachedUndeliveredMemberState[u.userId] || 0) < r && a++;
        }
      } catch (e) {
        t = {
          error: e
        };
      } finally {
        try {
          o && !o.done && (n = i.return) && n.call(i);
        } finally {
          if (t) throw t.error;
        }
      }

      return a;
    }

    return 0;
  }, c.prototype.getReadMembers = function (e, t) {
    var n = this;
    void 0 === t && (t = !1);
    var s = _o.of(this._iid).sdkState;
    if (!s.userId || this.isExclusive || this.isSuper || this.isBroadcast) return [];
    var r = e instanceof De$2 ? e.sender : null,
        a = [];
    return this.members.forEach(function (i) {
      if (t || i.userId !== s.userId && i.userId !== (null == r ? void 0 : r.userId)) {
        var o = n._unreadMemberStateMap.get(i.userId);

        o && o >= e.createdAt && a.push(i);
      }
    }), a;
  }, c.prototype.getUnreadMembers = function (e, t) {
    var n = this;
    void 0 === t && (t = !1);
    var s = _o.of(this._iid).sdkState;
    if (!s.userId || this.isExclusive || this.isSuper || this.isBroadcast) return [];
    var r = e instanceof De$2 ? e.sender : null,
        a = [];
    return this.members.forEach(function (i) {
      if (t || i.userId !== s.userId && i.userId !== (null == r ? void 0 : r.userId)) {
        var o = n._unreadMemberStateMap.get(i.userId);

        o && o < e.createdAt && a.push(i);
      }
    }), a;
  }, c.prototype.getReadStatus = function (e) {
    var t = this;
    void 0 === e && (e = !1);
    var n = _o.of(this._iid).sdkState;
    if (!n.userId || this.isExclusive || this.isSuper || this.isBroadcast) return null;
    var s = {};
    return this.members.forEach(function (r) {
      if (e || r.userId !== n.userId) {
        var a = t._unreadMemberStateMap.get(r.userId);

        s[r.userId] = new Pt(t._iid, {
          channel_url: t.url,
          channel_type: t.channelType,
          user: Rt.payloadify(r),
          ts: null != a ? a : 0
        });
      }
    }), s;
  }, c.prototype.getTypingUsers = function () {
    var e = [];
    return this._typingStatus.forEach(function (t) {
      var n = t.user;
      e.push(n);
    }), e;
  }, c.prototype.invalidateTypingStatus = function () {
    var e = this,
        t = _o.of(this._iid).typingIndicatorInvalidateTime,
        n = Date.now(),
        s = !1;
    return this._typingStatus.forEach(function (r, a) {
      var i = r.ts;
      n - i >= t && (e._typingStatus.delete(a), s = !0);
    }), s;
  }, c.prototype.refresh = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return [2, this._refresh()];
      });
    });
  }, c.prototype._refresh = function (e) {
    return void 0 === e && (e = !1), i$1(this, void 0, void 0, function () {
      var t, n, s, r, a, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return t = _o.of(this._iid), n = t.requestQueue, s = t.dispatcher, r = new tn({
              channelUrl: this.url
            }), [4, n.send(r)];

          case 1:
            return a = o.sent(), i = a.as(nn).channel, this._update(i), e && s.dispatch(new Jt({
              channels: [i],
              source: po.REQUEST_CHANNEL
            })), [2, this];
        }
      });
    });
  }, c.prototype.freeze = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, u.prototype.freeze.call(this)];

          case 1:
            return e.sent(), _o.of(this._iid).dispatcher.dispatch(new Jt({
              channels: [this],
              source: po.EVENT_CHANNEL_FROZEN,
              isWebSocketEventComing: !0
            })), [2];
        }
      });
    });
  }, c.prototype.unfreeze = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, u.prototype.unfreeze.call(this)];

          case 1:
            return e.sent(), _o.of(this._iid).dispatcher.dispatch(new Jt({
              channels: [this],
              source: po.EVENT_CHANNEL_UNFROZEN,
              isWebSocketEventComing: !0
            })), [2];
        }
      });
    });
  }, c.prototype.updateChannel = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, a, i, o, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return t = n$1(n$1({}, Ns), e), Qi$1(function (e) {
              return w$1("string", e.coverUrl, !0) && (k(e.coverImage) || w$1("string", e.coverImage, !0)) && w$1("boolean", e.isDistinct, !0) && w$1("boolean", e.isPublic, !0) && w$1("boolean", e.isDiscoverable, !0) && w$1("string", e.accessCode, !0) && w$1("string", e.name, !0) && w$1("string", e.data, !0) && w$1("string", e.customType, !0) && S$2("string", e.operatorUserIds, !0) && w$1("number", e.messageSurvivalSeconds, !0);
            }(t)).throw(v$2.invalidParameters), n = _o.of(this._iid), r = n.dispatcher, a = n.requestQueue, i = new ws(n$1({
              channelUrl: this.url
            }, t)), [4, a.send(i)];

          case 1:
            return o = c.sent(), u = o.as(Ds).channel, this._update(u), r.dispatch(new Jt({
              channels: [u],
              source: po.EVENT_CHANNEL_UPDATED,
              isWebSocketEventComing: !0
            })), [2, this];
        }
      });
    });
  }, c.prototype.invite = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return Qi$1(e.every(function (e) {
          return e instanceof Xi$1;
        })).throw(v$2.invalidParameters), [2, this.inviteWithUserIds(e.map(function (e) {
          return e.userId;
        }))];
      });
    });
  }, c.prototype.inviteWithUserIds = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, s, r, a, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.dispatcher, s = t.requestQueue, r = new Sn({
              channelUrl: this.url,
              userIds: e
            }), [4, s.send(r)];

          case 1:
            return a = o.sent(), i = a.as(Tn).channel, this._update(i), n.dispatch(new Jt({
              channels: [i],
              source: po.EVENT_CHANNEL_INVITED,
              isWebSocketEventComing: !0
            })), [2, this];
        }
      });
    });
  }, c.prototype.join = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, s, r, a, i, o;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return Qi$1(w$1("string", e, !0)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.dispatcher, s = t.sdkState, r = t.requestQueue, a = new yn({
              channelUrl: this.url,
              userId: s.userId,
              accessCode: e
            }), [4, r.send(a)];

          case 1:
            return i = u.sent(), (o = i.as(Mn).channel).myMemberState = this.myMemberState = Nt.JOINED, this._update(o), n.dispatch(new Jt({
              channels: [o],
              source: po.EVENT_CHANNEL_JOINED,
              isWebSocketEventComing: !0
            })), [2, this];
        }
      });
    });
  }, c.prototype.leave = function (e) {
    return void 0 === e && (e = !1), i$1(this, void 0, void 0, function () {
      var t, n, s, r;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return t = _o.of(this._iid), n = t.sdkState, s = t.requestQueue, r = new Nn({
              channelUrl: this.url,
              userId: n.userId,
              shouldRemoveOperatorStatus: e
            }), [4, s.send(r)];

          case 1:
            return a.sent(), this.myMemberState = Nt.NONE, [2];
        }
      });
    });
  }, c.prototype.acceptInvitation = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, s, r, a, i, o;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return Qi$1(w$1("string", e, !0)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.dispatcher, s = t.sdkState, r = t.requestQueue, a = new As({
              channelUrl: this.url,
              userId: s.userId,
              accessCode: e
            }), [4, r.send(a)];

          case 1:
            return i = u.sent(), (o = i.as(Is).channel).myMemberState = this.myMemberState = Nt.JOINED, this._update(o), n.dispatch(new Jt({
              channels: [o],
              source: po.EVENT_CHANNEL_ACCEPTED_INVITE,
              isWebSocketEventComing: !0
            })), [2, this];
        }
      });
    });
  }, c.prototype.declineInvitation = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, s = new In({
              channelUrl: this.url,
              userId: t.userId
            }), [4, n.send(s)];

          case 1:
            return r.sent(), this.myMemberState = Nt.NONE, [2, this];
        }
      });
    });
  }, c.prototype.sendUserMessage = function (e) {
    var t = this,
        n = new gt$1(),
        s = _o.of(this._iid).dispatcher,
        r = I$1.of(this._iid);
    return u.prototype.sendUserMessage.call(this, e).onPending(function (e) {
      r.completeCurrentAndProcessNextAutoResend(e), n._trigger(e);
    }).onFailed(function (e, t) {
      t && r.completeCurrentAndProcessNextAutoResend(t), n._triggerFailed(e, t);
    }).onSucceeded(function (e) {
      t.hiddenState === Zs.HIDDEN_ALLOW_AUTO_UNHIDE && (t.hiddenState = Zs.UNHIDDEN), r.completeCurrentAndProcessNextAutoResend(e), t._shouldUpdateLastMessageWith(e) && (t.lastMessage = e), Yn.of(t._iid).handlers.map(function (e) {
        e.onChannelChanged && e.onChannelChanged(t);
      }), s.dispatch(new Jt({
        channels: [t],
        source: po.EVENT_MESSAGE_SENT
      })), n._trigger(e);
    }), n;
  }, c.prototype.updateUserMessage = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n,
          s,
          r,
          a,
          i = this;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return n = _o.of(this._iid).dispatcher, [4, u.prototype.updateUserMessage.call(this, e, t)];

          case 1:
            return s = o.sent(), r = !1, !s.silent && this._shouldUpdateLastMessageWith(s) && (this.lastMessage = s, r = !0), a = !1, this.lastPinnedMessage && this.lastPinnedMessage.messageId === s.messageId && (this.lastPinnedMessage = s, r = !0, a = !0), r && (Yn.of(this._iid).handlers.map(function (e) {
              e.onChannelChanged && e.onChannelChanged(i);
            }), n.dispatch(new Jt({
              channels: [this],
              source: a ? po.EVENT_PINNED_MESSAGE_UPDATED : po.EVENT_MESSAGE_UPDATED
            }))), a && Yn.of(this._iid).handlers.map(function (e) {
              e.onPinnedMessageUpdated && e.onPinnedMessageUpdated(i);
            }), n.dispatch(new No({
              messages: [s],
              source: po.EVENT_MESSAGE_UPDATED
            })), [2, s];
        }
      });
    });
  }, c.prototype._autoResendUserMessage = function (e) {
    var t = this,
        n = new gt$1(),
        s = _o.of(this._iid).dispatcher,
        r = I$1.of(this._iid);
    return u.prototype._autoResendUserMessage.call(this, e).onPending(function (e) {
      r.completeCurrentAndProcessNextAutoResend(e), n._trigger(e);
    }).onFailed(function (e, t) {
      r.completeCurrentAndProcessNextAutoResend(t), n._triggerFailed(e, t);
    }).onSucceeded(function (e) {
      var a = Yn.of(t._iid);
      r.completeCurrentAndProcessNextAutoResend(e), t._shouldUpdateLastMessageWith(e) && (t.lastMessage = e), a.handlers.map(function (e) {
        e.onChannelChanged && e.onChannelChanged(t);
      }), s.dispatch(new Jt({
        channels: [t],
        source: po.EVENT_MESSAGE_SENT
      })), n._trigger(e);
    }), n;
  }, c.prototype.sendFileMessage = function (e) {
    var t = this,
        n = new gt$1(),
        s = _o.of(this._iid).dispatcher,
        r = I$1.of(this._iid);
    return u.prototype.sendFileMessage.call(this, e).onPending(function (e) {
      r.completeCurrentAndProcessNextAutoResend(e), n._trigger(e);
    }).onFailed(function (e, t) {
      t && r.completeCurrentAndProcessNextAutoResend(t), n._triggerFailed(e, t);
    }).onSucceeded(function (e) {
      var a = Yn.of(t._iid);
      r.completeCurrentAndProcessNextAutoResend(e), t._shouldUpdateLastMessageWith(e) && (t.lastMessage = e), a.handlers.map(function (e) {
        e.onChannelChanged && e.onChannelChanged(t);
      }), s.dispatch(new Jt({
        channels: [t],
        source: po.EVENT_MESSAGE_SENT
      })), n._trigger(e);
    }), n;
  }, c.prototype.sendMultipleFilesMessage = function (e) {
    var t = this,
        n = new br(),
        s = _o.of(this._iid).dispatcher;
    return u.prototype.sendMultipleFilesMessage.call(this, e).onPending(function (e) {
      n._trigger(e);
    }).onFailed(function (e, t) {
      n._triggerFailed(e, t);
    }).onSucceeded(function (e) {
      var r = Yn.of(t._iid);
      t._shouldUpdateLastMessageWith(e) && (t.lastMessage = e), r.handlers.map(function (e) {
        e.onChannelChanged && e.onChannelChanged(t);
      }), s.dispatch(new Jt({
        channels: [t],
        source: po.EVENT_MESSAGE_SENT
      })), n._trigger(e);
    }).onFileUploaded(function (e, t, s, r) {
      n._triggerOnFileUploaded(e, t, s, r);
    }), n;
  }, c.prototype.updateFileMessage = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n,
          s,
          r,
          a,
          i = this;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return n = _o.of(this._iid).dispatcher, [4, u.prototype.updateFileMessage.call(this, e, t)];

          case 1:
            return s = o.sent(), r = !1, !s.silent && this._shouldUpdateLastMessageWith(s) && (this.lastMessage = s, r = !0), a = !1, this.lastPinnedMessage && this.lastPinnedMessage.messageId === s.messageId && (this.lastPinnedMessage = s, r = !0, a = !0), r && (Yn.of(this._iid).handlers.map(function (e) {
              e.onChannelChanged && e.onChannelChanged(i);
            }), n.dispatch(new Jt({
              channels: [this],
              source: a ? po.EVENT_PINNED_MESSAGE_UPDATED : po.EVENT_MESSAGE_UPDATED
            }))), a && Yn.of(this._iid).handlers.map(function (e) {
              e.onPinnedMessageUpdated && e.onPinnedMessageUpdated(i);
            }), n.dispatch(new No({
              messages: [s],
              source: po.EVENT_MESSAGE_UPDATED
            })), [2, s];
        }
      });
    });
  }, c.prototype._autoResendFileMessage = function (e) {
    var t = this,
        n = new gt$1(),
        s = _o.of(this._iid).dispatcher,
        r = I$1.of(this._iid);
    return u.prototype._autoResendFileMessage.call(this, e).onPending(function (e) {
      r.completeCurrentAndProcessNextAutoResend(e), n._trigger(e);
    }).onFailed(function (e, t) {
      r.completeCurrentAndProcessNextAutoResend(t), n._triggerFailed(e, t);
    }).onSucceeded(function (e) {
      var a = Yn.of(t._iid);
      r.completeCurrentAndProcessNextAutoResend(e), t._shouldUpdateLastMessageWith(e) && (t.lastMessage = e), a.handlers.map(function (e) {
        e.onChannelChanged && e.onChannelChanged(t);
      }), s.dispatch(new Jt({
        channels: [t],
        source: po.EVENT_MESSAGE_SENT
      })), n._trigger(e);
    }), n;
  }, c.prototype.deleteMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, u.prototype.deleteMessage.call(this, e)];

          case 1:
            return t.sent(), 0 === e.messageId && e instanceof De$2 && _o.of(this._iid).dispatcher.dispatch(new So({
              reqId: e.reqId,
              source: po.EVENT_MESSAGE_DELETED
            })), [2];
        }
      });
    });
  }, c.prototype.hide = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, r, a, i, o, u, c;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            return t = n$1(n$1({}, Dn), e), Qi$1(function (e) {
              return w$1("boolean", e.hidePreviousMessages, !0) && w$1("boolean", e.allowAutoUnhide, !0);
            }(t)).throw(v$2.invalidParameters), n = _o.of(this._iid), r = n.dispatcher, a = n.sdkState, i = n.requestQueue, o = new Ln(n$1({
              channelUrl: this.url,
              userId: a.userId
            }, t)), [4, i.send(o)];

          case 1:
            return u = d.sent(), c = u.as(Rn).messageOffsetTimestamp, this.hiddenState = t.allowAutoUnhide ? Zs.HIDDEN_ALLOW_AUTO_UNHIDE : Zs.HIDDEN_PREVENT_AUTO_UNHIDE, t.hidePreviousMessages && this._updateUnreadCount(0, 0), c && (this.messageOffsetTimestamp = c), r.dispatch(new Jt({
              channels: [this],
              source: po.EVENT_CHANNEL_HIDDEN,
              isWebSocketEventComing: !0
            })), [2, this];
        }
      });
    });
  }, c.prototype.unhide = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return e = _o.of(this._iid), t = e.dispatcher, n = e.requestQueue, s = new Rs({
              channelUrl: this.url
            }), [4, n.send(s)];

          case 1:
            return r.sent(), this.hiddenState = Zs.UNHIDDEN, t.dispatch(new Jt({
              channels: [this],
              source: po.EVENT_CHANNEL_UNHIDDEN,
              isWebSocketEventComing: !0
            })), [2, this];
        }
      });
    });
  }, c.prototype.delete = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return e = _o.of(this._iid).requestQueue, t = new Ls({
              channelUrl: this.url
            }), [4, e.send(t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, c.prototype.markAsRead = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t,
          n,
          s,
          r,
          a,
          i,
          o = this;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.dispatcher, s = e.requestQueue, r = new Bn({
              channelUrl: this.url
            }), [4, s.send(r)];

          case 1:
            return a = u.sent(), i = a.as(qn).readStatus, this._updateUnreadMemberState(t.userId, i.readAt), (this.unreadMessageCount > 0 || this.unreadMentionCount > 0) && (this._updateUnreadCount(0, 0), Yn.of(this._iid).handlers.map(function (e) {
              e.onChannelChanged && e.onChannelChanged(o);
            })), n.dispatch(new Jt({
              channels: [this],
              source: po.EVENT_CHANNEL_READ
            })), [2];
        }
      });
    });
  }, c.prototype.markAsDelivered = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, s = new Wn({
              channelUrl: this.url,
              userId: t.userId
            }), [4, n.send(s)];

          case 1:
            return r.sent(), [2];
        }
      });
    });
  }, c.prototype.startTyping = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s, r;
      return o$1(this, function (a) {
        return e = _o.of(this._iid), t = e.requestQueue, n = e.typingIndicatorThrottle, (s = new Date().getTime()) - this._typingStarted >= n && (this._typingStarted = s, this._typingEnded = 0, r = new kn({
          channelUrl: this.url,
          time: this._typingStarted
        }), t.send(r)), [2];
      });
    });
  }, c.prototype.endTyping = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s, r;
      return o$1(this, function (a) {
        return e = _o.of(this._iid), t = e.requestQueue, n = e.typingIndicatorThrottle, (s = new Date().getTime()) - this._typingEnded >= n && (this._typingStarted = 0, this._typingEnded = s, r = new Fn({
          channelUrl: this.url,
          time: this._typingStarted
        }), t.send(r)), [2];
      });
    });
  }, c.prototype.createScheduledUserMessage = function (e) {
    e = n$1(n$1({}, Fi), e), Qi$1(zi(e)).throw(v$2.invalidParameters);
    var t = new gt$1();
    return this._createScheduledUserMessage(e, t), t;
  }, c.prototype.updateScheduledUserMessage = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, a, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return n = n$1(n$1({}, Hs), t), Qi$1(function (e) {
              return Rt$2(e) && w$1("number", e.scheduledAt, !0);
            }(n)).throw(v$2.invalidParameters), r = _o.of(this._iid).requestQueue, a = new Bs(n$1({
              reqId: this._generateRequestId(),
              scheduledMessageId: e,
              channelType: this.channelType,
              channelUrl: this.url
            }, n)), [4, r.send(a)];

          case 1:
            return i = o.sent(), [2, i.as(Gn$1).message];
        }
      });
    });
  }, c.prototype.createScheduledFileMessage = function (e) {
    var t = this;
    e = n$1(n$1({}, Bi), e), Qi$1(Ki(e)).throw(v$2.invalidParameters);

    var n = Date.now(),
        r = this._generateRequestId(),
        a = new gt$1();

    return Ei$1(Ir).then(function () {
      var s = t._createPendingScheduledFileMessage(e, r, n);

      bi$1(function () {
        return i$1(t, void 0, void 0, function () {
          return o$1(this, function (e) {
            return [2, a._trigger(s)];
          });
        });
      });
    }), k(e.file) ? this._uploadFileAndUpdateParams(e).then(function () {
      return t._createScheduledFileMessage(e, a, r, n);
    }) : this._createScheduledFileMessage(e, a, r, n), a;
  }, c.prototype.updateScheduledFileMessage = function (e, t) {
    return i$1(this, void 0, void 0, function () {
      var n, r, a;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return n = n$1(n$1({}, xs), t), Qi$1(function (e) {
              return Pt$2(e) && w$1("number", e.scheduledAt, !0) && (k(e.file) || w$1("string", e.fileUrl)) && w$1("string", e.fileName, !0) && w$1("string", e.mimeType, !0) && w$1("number", e.fileSize, !0) && (null === e.thumbnailSizes || void 0 === e.thumbnailSizes || e.thumbnailSizes.every(function (e) {
                return w$1("object", e) && e.maxWidth > 0 && e.maxHeight > 0;
              }));
            }(n)).throw(v$2.invalidParameters), k(n.file) ? [4, this._uploadFileAndUpdateParams(n)] : [3, 2];

          case 1:
            i.sent(), i.label = 2;

          case 2:
            return r = new Gs(n$1({
              reqId: this._generateRequestId(),
              scheduledMessageId: e,
              channelType: this.channelType,
              channelUrl: this.url
            }, n)), [4, _o.of(this._iid).requestQueue.send(r)];

          case 3:
            return a = i.sent(), [2, a.as(Vs).message];
        }
      });
    });
  }, c.prototype.cancelScheduledMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = new qs({
              scheduledMessageId: e,
              channelType: this.channelType,
              channelUrl: this.url
            }), [4, _o.of(this._iid).requestQueue.send(t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, c.prototype.sendScheduledMessageNow = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return t = new Ws({
              scheduledMessageId: e,
              channelType: this.channelType,
              channelUrl: this.url
            }), [4, _o.of(this._iid).requestQueue.send(t)];

          case 1:
            return n.sent(), [2];
        }
      });
    });
  }, c.prototype.getMyPushTriggerOption = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s, r, a;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return e = _o.of(this._iid), t = e.sdkState, n = e.requestQueue, s = new Qs({
              userId: t.userId,
              channelUrl: this.url
            }), [4, n.send(s)];

          case 1:
            return r = i.sent(), a = r.as(Ys).pushTriggerOption, this.myPushTriggerOption = a, [2, a];
        }
      });
    });
  }, c.prototype.setMyPushTriggerOption = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, s, a, i, o, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return Qi$1(N$1(_$1, e)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.dispatcher, s = t.sdkState, a = t.requestQueue, i = new js({
              userId: s.userId,
              channelUrl: this.url,
              pushTriggerOption: e
            }), [4, a.send(i)];

          case 1:
            return o = c.sent(), u = o.as(zs).pushTriggerOption, this.myPushTriggerOption = u, n.dispatch(new Jt({
              channels: [this],
              source: po.EVENT_CHANNEL_UPDATED,
              isWebSocketEventComing: !0
            })), [2, u];
        }
      });
    });
  }, c.prototype.setMyCountPreference = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, s, a, i, o, u;
      return o$1(this, function (c) {
        switch (c.label) {
          case 0:
            return Qi$1(N$1(Xs, e)).throw(v$2.invalidParameters), t = _o.of(this._iid), n = t.dispatcher, s = t.sdkState, a = t.requestQueue, i = new Ps({
              channelUrl: this.url,
              userId: s.userId,
              countPreference: e
            }), [4, a.send(i)];

          case 1:
            return o = c.sent(), u = o.as(ks).countPreference, this.myCountPreference = u, this._updateUnreadCount(this.unreadMessageCount, this.unreadMentionCount), n.dispatch(new Jt({
              channels: [this],
              source: po.EVENT_CHANNEL_UPDATED,
              isWebSocketEventComing: !0
            })), [2, u];
        }
      });
    });
  }, c.prototype.resetMyHistory = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, s, r, a;
      return o$1(this, function (i) {
        switch (i.label) {
          case 0:
            return e = _o.of(this._iid), t = e.dispatcher, n = e.requestQueue, s = new Os({
              channelUrl: this.url
            }), [4, n.send(s)];

          case 1:
            return r = i.sent(), a = r.as(Fs).messageOffsetTimestamp, this.messageOffsetTimestamp = a, this.lastMessage && this.lastMessage.createdAt < a && (this.lastMessage = null), t.dispatch(new Jt({
              channels: [this],
              source: po.EVENT_CHANNEL_RESET_HISTORY,
              isWebSocketEventComing: !0
            })), [2, this];
        }
      });
    });
  }, c.prototype.pinMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(w$1("number", e) && e > 0).throw(v$2.invalidParameters), t = _o.of(this._iid).requestQueue, n = new Ks({
              channelType: this.channelType,
              channelUrl: this.url,
              messageId: e
            }), [4, t.send(n)];

          case 1:
            return s.sent(), [2];
        }
      });
    });
  }, c.prototype.unpinMessage = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n;
      return o$1(this, function (s) {
        switch (s.label) {
          case 0:
            return Qi$1(w$1("number", e) && e > 0).throw(v$2.invalidParameters), t = _o.of(this._iid).requestQueue, n = new Js({
              channelType: this.channelType,
              channelUrl: this.url,
              messageId: e
            }), [4, t.send(n)];

          case 1:
            return s.sent(), [2];
        }
      });
    });
  }, c.prototype._uploadFileAndUpdateParams = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t, n, s, r, a, i, o, u, c, l, h;
      return o$1(this, function (d) {
        switch (d.label) {
          case 0:
            return k(e.file) ? (t = _o.of(this._iid).requestQueue, n = new Te$1({
              file: e.file,
              channelUrl: this.url,
              thumbnailSizes: e.thumbnailSizes,
              requestId: this._generateRequestId()
            }), [4, t.send(n)]) : [3, 2];

          case 1:
            s = d.sent(), r = s.as(we$1), a = r.url, i = r.fileSize, o = void 0 === i ? e.fileSize : i, u = r.thumbnailSizes, c = void 0 === u ? e.thumbnailSizes : u, l = r.requireAuth, h = void 0 !== l && l, e.fileUrl = a, e.fileSize = o, e.thumbnailSizes = c, e.requireAuth = h, d.label = 2;

          case 2:
            return [2];
        }
      });
    });
  }, c;
}(Er);

var Oe,
    De = {},
    Pe = function () {
  function e(e) {
    var t = e._iid,
        n = e.limit,
        a = void 0 === n ? 100 : n,
        r = this;
    this.ref = 0, this._iid = t, this._limit = a;
    var o,
        l = _o.of(this._iid),
        u = l.sdkState,
        c = l.dispatcher,
        d = l.logger,
        p = l.cacheContext;
    this._metadataKey = (o = u.userId, "sendbird:".concat(o, "@groupchannel/sync.meta"));

    var m = function (e) {
      return "sendbird:".concat(e, "@groupchannel/sync");
    }(u.userId);

    this._sync = new Jn(m, function () {
      return i$1(r, void 0, void 0, function () {
        var e, t, n, a, r, i, s, o, l, c, f, m;
        return o$1(this, function (h) {
          switch (h.label) {
            case 0:
              return e = {
                hasNext: !0,
                nextToken: ""
              }, [4, this.loadMetadata()];

            case 1:
              if (h.sent(), d.debug("channel background sync from", null === (l = this._metadata) || void 0 === l ? void 0 : l.token), null === (c = this._metadata) || void 0 === c ? void 0 : c.completed) return [3, 13];
              h.label = 2;

            case 2:
              if (h.trys.push([2, 9,, 12]), (t = {
                includeEmpty: !0,
                order: g$1.CHRONOLOGICAL
              }).order !== g$1.LATEST_LAST_MESSAGE) return [3, 6];
              h.label = 3;

            case 3:
              return h.trys.push([3, 5,, 6]), [4, p.preference.get(xi$1(u.appId))];

            case 4:
              return n = h.sent(), t.includeChatNotification = Boolean(n), [3, 6];

            case 5:
              return h.sent(), t.includeChatNotification = !1, [3, 6];

            case 6:
              return [4, Yn.of(this._iid).getMyGroupChannels(null !== (m = null === (f = this._metadata) || void 0 === f ? void 0 : f.token) && void 0 !== m ? m : "", t, this._limit, po.SYNC_CHANNEL_BACKGROUND)];

            case 7:
              return a = h.sent(), r = a.channels, i = a.token, e.hasNext = r.length >= this._limit && !!i, e.nextToken = i, this._metadata && (this._metadata.token = i, (o = this._metadata.range).extends.apply(o, c$1([], a$1(r.map(function (e) {
                return e.createdAt;
              })), !1)), this._metadata.completed = !e.hasNext), d.debug("channel background sync progress", e), [4, this.saveMetadata()];

            case 8:
              return h.sent(), [3, 12];

            case 9:
              return s = h.sent(), d.debug("channel background sync error", s), s instanceof v$2 && s.isInvalidTokenError ? [4, this.clearMetaData()] : [3, 11];

            case 10:
              h.sent(), h.label = 11;

            case 11:
              throw s;

            case 12:
              return [3, 14];

            case 13:
              e.hasNext = !1, e.nextToken = "", h.label = 14;

            case 14:
              return [2, e];
          }
        });
      });
    }), this._connectionEventContext = c.on(function (e) {
      if (e instanceof ai$1) if (e.stateType === ti$1.CONNECTED) r.resume();else r.pause();
    });
  }

  return e.of = function (t) {
    return De[t] || (De[t] = new e({
      _iid: t
    })), De[t].ref++, De[t];
  }, e.clear = function (e) {
    De[e] && (De[e].close(), delete De[e]);
  }, Object.defineProperty(e.prototype, "range", {
    get: function () {
      var e, t;
      return null !== (t = null === (e = this._metadata) || void 0 === e ? void 0 : e.range) && void 0 !== t ? t : new H({});
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(e.prototype, "completed", {
    get: function () {
      var e;
      return !!(null === (e = this._metadata) || void 0 === e ? void 0 : e.completed);
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.loadMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return this._metadata ? [3, 2] : [4, _o.of(this._iid).cacheContext.preference.get(this._metadataKey)];

          case 1:
            e = t.sent(), this._metadata = {
              token: e ? e.token : "",
              range: new H(e ? e.range : {
                top: Number.MAX_SAFE_INTEGER,
                bottom: 0
              }),
              completed: !!e && e.completed
            }, t.label = 2;

          case 2:
            return [2, this._metadata];
        }
      });
    });
  }, e.prototype.saveMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this._metadata ? [4, _o.of(this._iid).cacheContext.preference.set(this._metadataKey, this._metadata)] : [3, 2];

          case 1:
            return e.sent(), [2, !0];

          case 2:
            return [2, !1];
        }
      });
    });
  }, e.prototype.clearMetaData = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, _o.of(this._iid).cacheContext.preference.remove(this._metadataKey)];

          case 1:
            return e.sent(), this._metadata = void 0, [2];
        }
      });
    });
  }, e.prototype.resume = function () {
    var e,
        t,
        n = _o.of(this._iid),
        a = n.logger;
    n.connectionManager.isConnected && (a.debug("channel background sync resume()"), this._sync.start(null !== (t = null === (e = this._metadata) || void 0 === e ? void 0 : e.token) && void 0 !== t ? t : ""));
  }, e.prototype.pause = function () {
    _o.of(this._iid).logger.debug("channel background sync stop()"), this._sync.stop();
  }, e.prototype.close = function () {
    this.ref--, this.ref <= 0 && (this.ref = 0, this.pause(), this._connectionEventContext.close(), delete De[this._iid]);
  }, e;
}(),
    Ie = {},
    He = function () {
  function e(e) {
    var t = e._iid,
        n = this;
    this.ref = 0, this._iid = t;
    var a,
        r = _o.of(this._iid),
        o = r.logger,
        l = r.sdkState,
        u = r.dispatcher,
        c = r.cacheContext;
    this._metadataKey = (a = l.userId, "sendbird:".concat(a, "@groupchannel/changelogs.meta"));

    var d = function (e) {
      return "sendbird:".concat(e, "@groupchannel/changelogs");
    }(l.userId);

    this._sync = new Jn(d, function () {
      return i$1(n, void 0, void 0, function () {
        var e, t, n, a, r, i, s, u, d, p;
        return o$1(this, function (h) {
          switch (h.label) {
            case 0:
              return e = {
                hasNext: !0,
                nextToken: 0
              }, [4, this.loadMetadata()];

            case 1:
              h.sent(), o.debug("channel changelog sync from", null === (u = this._metadata) || void 0 === u ? void 0 : u.token), h.label = 2;

            case 2:
              h.trys.push([2, 9,, 12]), t = {
                includeEmpty: !0
              }, h.label = 3;

            case 3:
              return h.trys.push([3, 5,, 6]), [4, c.preference.get(xi$1(l.appId))];

            case 4:
              return n = h.sent(), t.includeChatNotification = Boolean(n), [3, 6];

            case 5:
              return h.sent(), t.includeChatNotification = !1, [3, 6];

            case 6:
              return [4, Yn.of(this._iid).getMyGroupChannelChangeLogs(null !== (p = null === (d = this._metadata) || void 0 === d ? void 0 : d.token) && void 0 !== p ? p : "", t, po.SYNC_CHANNEL_CHANGELOGS)];

            case 7:
              return a = h.sent(), r = a.hasMore, i = a.token, e.hasNext = r, e.nextToken = i, this._metadata && (this._metadata.token = i), o.debug("channel changelog sync progress", e), [4, this.saveMetadata()];

            case 8:
              return h.sent(), [3, 12];

            case 9:
              return s = h.sent(), o.debug("channel changelog sync error", s), s instanceof v$2 && s.isInvalidTokenError ? [4, this.clearMetadata()] : [3, 11];

            case 10:
              h.sent(), h.label = 11;

            case 11:
              throw s;

            case 12:
              return [2, e];
          }
        });
      });
    }), this._connectionEventContext = u.on(function (e) {
      if (e instanceof ai$1) if (e.stateType === ti$1.CONNECTED) n.resume();else n.pause();
    });
  }

  return e.of = function (t) {
    return Ie[t] || (Ie[t] = new e({
      _iid: t
    })), Ie[t].ref++, Ie[t];
  }, e.clear = function (e) {
    Ie[e] && (Ie[e].close(), delete Ie[e]);
  }, e.prototype.loadMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, a;
      return o$1(this, function (r) {
        switch (r.label) {
          case 0:
            return this._metadata ? [3, 2] : (e = _o.of(this._iid), t = e.cacheContext, n = e.firstConnectedAt, [4, t.preference.get(this._metadataKey)]);

          case 1:
            a = r.sent(), this._metadata = {
              token: a ? a.token : n
            }, r.label = 2;

          case 2:
            return [2, this._metadata];
        }
      });
    });
  }, e.prototype.saveMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return this._metadata ? [4, _o.of(this._iid).cacheContext.preference.set(this._metadataKey, this._metadata)] : [3, 2];

          case 1:
            return e.sent(), [2, !0];

          case 2:
            return [2, !1];
        }
      });
    });
  }, e.prototype.clearMetadata = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, _o.of(this._iid).cacheContext.preference.remove(this._metadataKey)];

          case 1:
            return e.sent(), this._metadata = void 0, [2];
        }
      });
    });
  }, e.prototype.resume = function () {
    _o.of(this._iid).connectionManager.isConnected && this._sync.start(0);
  }, e.prototype.pause = function () {
    this._sync.stop();
  }, e.prototype.close = function () {
    this.ref--, this.ref <= 0 && (this.ref = 0, this.pause(), this._connectionEventContext.close(), delete Ie[this._iid]);
  }, e;
}(),
    Re = function (e, t) {
  return e.findIndex(function (e) {
    return e.isIdentical(t);
  });
},
    Ve = function (e, t, n) {
  if (e.length > 0) {
    for (var a = Re(e, t), r = 0, i = e.length - 1, s = Math.floor((r + i) / 2); r < i;) {
      var o = Ke(e[s], t, n);
      if (o > 0) i = s, s = Math.floor((r + i) / 2);else {
        if (!(o < 0)) return {
          place: s,
          oldPosition: a
        };
        r = s + 1, s = Math.floor((r + i) / 2);
      }
    }

    return {
      place: Ke(e[s], t, n) >= 0 ? s : s + 1,
      oldPosition: a
    };
  }

  return {
    place: e.length,
    oldPosition: -1
  };
},
    Ke = function (e, t, n) {
  switch (n) {
    case g$1.LATEST_LAST_MESSAGE:
      return e.lastMessage && t.lastMessage ? t.lastMessage.createdAt - e.lastMessage.createdAt : e.lastMessage ? -1 : t.lastMessage ? 1 : t.createdAt - e.createdAt;

    case g$1.CHRONOLOGICAL:
      return t.createdAt - e.createdAt;

    case g$1.CHANNEL_NAME_ALPHABETICAL:
      var a = e.name.localeCompare(t.name);
      return 0 === a ? e.createdAt - t.createdAt : a;

    default:
      return 0;
  }
},
    Qe = function () {
  function e(e, t) {
    var n = t.filter,
        a = t.order,
        r = t.limit,
        o = this;
    this.channels = [], this._iid = e, this._key = "gcc-".concat(Z()), this._isDisposed = !1, this._isGetRemoteChannelsSucceeded = !0, this.filter = null != n ? n : new Ot(), this.order = null != a ? a : g$1.LATEST_LAST_MESSAGE, this._hasMore = !0, this._token = "", this._limit = null != r ? r : or;
    var l = _o.of(this._iid),
        u = l.sdkState,
        c = l.cacheContext,
        d = l.dispatcher;
    c.localCacheEnabled && (this._backgroundSync = Pe.of(e), this._backgroundSync.resume()), this._changelogSync = He.of(e), this._changelogSync.resume(), Yn.of(this._iid).subscribeChannelEvent(this._key, {
      onUpdate: function (e, t) {
        if (Kt(t)) {
          var n = e.filter(function (e) {
            return o.filter.match(e, u.userId);
          }),
              a = e.filter(function (e) {
            return !o.filter.match(e, u.userId);
          }).map(function (e) {
            return e.url;
          });
          n.length > 0 && o._addChannelsToView(n, t), a.length > 0 && o._removeChannelsFromView(a, t);
        }
      },
      onRemove: function (e, t) {
        o._removeChannelsFromView(e, t);
      }
    }), _o.of(this._iid).statLogCollector.put(new io({
      type: we$2.FEATURE_LOCALCACHE,
      data: {
        use_local_cache: c.localCacheEnabled,
        collection_interface: {
          group_channel: !0
        }
      }
    })), d.on(function (e) {
      e instanceof ai$1 && (e.stateType === ti$1.CONNECTED ? o._isGetRemoteChannelsSucceeded || i$1(o, void 0, void 0, function () {
        return o$1(this, function (e) {
          switch (e.label) {
            case 0:
              return [4, this._revokeLoadMore()];

            case 1:
              return e.sent(), [2];
          }
        });
      }) : e.stateType === ti$1.LOGOUT && o.dispose());
    });
  }

  return Object.defineProperty(e.prototype, "hasMore", {
    get: function () {
      return !this._isDisposed && this._hasMore;
    },
    enumerable: !1,
    configurable: !0
  }), e.prototype.setGroupChannelCollectionHandler = function (e) {
    this._handler = e;
  }, e.prototype._addChannelsToView = function (e, t, n) {
    var a,
        r,
        s,
        o,
        l = this;
    void 0 === n && (n = !1);
    var u = [],
        c = [],
        d = [];

    try {
      for (var p = s$2(e), f = p.next(); !f.done; f = p.next()) {
        var m = f.value,
            v = Re(this.channels, m);
        v >= 0 && this.channels.splice(v, 1);
        var _ = Ve(this.channels, m, this.order).place;
        if (v < 0) _ === this.channels.length ? !n && this._hasMore || (u.push(m), this.channels.push(m)) : (u.push(m), this.channels.splice(_, 0, m));else switch (t) {
          case po.EVENT_CHANNEL_UPDATED:
          case po.EVENT_MESSAGE_RECEIVED:
          case po.SYNC_CHANNEL_CHANGELOGS:
          case po.EVENT_MESSAGE_SENT:
            _ !== v && this._hasMore && _ === this.channels.length ? d.push(m) : (this.channels.splice(_, 0, m), c.push(m));
            break;

          default:
            this.channels.splice(_, 0, m), c.push(m);
        }
      }
    } catch (e) {
      a = {
        error: e
      };
    } finally {
      try {
        f && !f.done && (r = p.return) && r.call(p);
      } finally {
        if (a) throw a.error;
      }
    }

    if (d.length > 0) try {
      for (var g = s$2(d), y = g.next(); !y.done; y = g.next()) {
        m = y.value;
        var C = Re(this.channels, m);
        -1 !== C && this.channels.splice(C, 1);
      }
    } catch (e) {
      s = {
        error: e
      };
    } finally {
      try {
        y && !y.done && (o = g.return) && o.call(g);
      } finally {
        if (s) throw s.error;
      }
    }
    Kt(t) && bi$1(function () {
      return i$1(l, void 0, void 0, function () {
        var e, n, a, r;
        return o$1(this, function (i) {
          return e = new hs(t), u.length > 0 && (null === (n = this._handler) || void 0 === n ? void 0 : n.onChannelsAdded) && this._handler.onChannelsAdded(e, u), c.length > 0 && (null === (a = this._handler) || void 0 === a ? void 0 : a.onChannelsUpdated) && this._handler.onChannelsUpdated(e, c), d.length > 0 && (null === (r = this._handler) || void 0 === r ? void 0 : r.onChannelsDeleted) && this._handler.onChannelsDeleted(e, d.map(function (e) {
            return e.url;
          })), [2];
        });
      });
    });
  }, e.prototype._removeChannelsFromView = function (e, t) {
    var n,
        a,
        r = this,
        s = [],
        o = function (e) {
      var t = l.channels.findIndex(function (t) {
        return t.url === e;
      });
      t >= 0 && (s.push(l.channels[t].url), l.channels.splice(t, 1));
    },
        l = this;

    try {
      for (var u = s$2(e), c = u.next(); !c.done; c = u.next()) {
        o(c.value);
      }
    } catch (e) {
      n = {
        error: e
      };
    } finally {
      try {
        c && !c.done && (a = u.return) && a.call(u);
      } finally {
        if (n) throw n.error;
      }
    }

    return Kt(t) && s.length > 0 && bi$1(function () {
      return i$1(r, void 0, void 0, function () {
        var e, n;
        return o$1(this, function (a) {
          return e = new hs(t), (null === (n = this._handler) || void 0 === n ? void 0 : n.onChannelsDeleted) && this._handler.onChannelsDeleted(e, s), [2];
        });
      });
    }), s;
  }, e.prototype._getLocalChannels = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t;
      return o$1(this, function (n) {
        switch (n.label) {
          case 0:
            return e = Yn.of(this._iid), t = this.channels.length > 0 ? function (e, t) {
              var n, a, r, i;

              switch (t) {
                case g$1.LATEST_LAST_MESSAGE:
                  return null !== (a = null === (n = e.lastMessage) || void 0 === n ? void 0 : n.createdAt) && void 0 !== a ? a : e.createdAt;

                case g$1.CHRONOLOGICAL:
                  return e.createdAt;

                case g$1.CHANNEL_NAME_ALPHABETICAL:
                  return e.name;

                default:
                  return null !== (i = null === (r = e.lastMessage) || void 0 === r ? void 0 : r.createdAt) && void 0 !== i ? i : e.createdAt;
              }
            }(this.channels[this.channels.length - 1], this.order) : null, [4, e.getChannelsFromCache(t, this.filter, this.order, this._limit, t ? this.channels[this.channels.length - 1].url : void 0)];

          case 1:
            return [2, n.sent()];
        }
      });
    });
  }, e.prototype._getRemoteChannels = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return [4, Yn.of(this._iid).getMyGroupChannels(this._token, $(n$1(n$1({}, this.filter), {
              order: this.order
            })), this._limit)];

          case 1:
            return e = a.sent(), t = e.channels, n = e.token, this._token = n, this._hasMore = !!n, [2, t];
        }
      });
    });
  }, e.prototype._revokeLoadMore = function () {
    return i$1(this, void 0, void 0, function () {
      var e;
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            if (this._isDisposed) return [2];
            t.label = 1;

          case 1:
            return t.trys.push([1, 3,, 4]), [4, this._getRemoteChannels()];

          case 2:
            return e = t.sent(), this._isGetRemoteChannelsSucceeded = !0, this._addChannelsToView(e, po.REQUEST_CHANNEL, !0), [3, 4];

          case 3:
            return t.sent(), this._isGetRemoteChannelsSucceeded = !1, [3, 4];

          case 4:
            return [2];
        }
      });
    });
  }, e.prototype.loadMore = function () {
    return i$1(this, void 0, void 0, function () {
      var e,
          t,
          n,
          a,
          r = this;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            if (this._isDisposed) throw new v$2({
              code: u$1.COLLECTION_DISPOSED,
              message: "Collection has been disposed."
            });
            return this._hasMore ? (e = _o.of(this._iid), t = e.cacheContext, n = e.connectionManager, a = [], !t.localCacheEnabled || n.isConnected && !this._backgroundSync.completed ? [3, 2] : [4, mi$1(function () {
              return i$1(r, void 0, void 0, function () {
                return o$1(this, function (e) {
                  switch (e.label) {
                    case 0:
                      return [4, this._getLocalChannels()];

                    case 1:
                      return a = e.sent(), [2];
                  }
                });
              });
            })]) : [3, 6];

          case 1:
            return o.sent(), this._hasMore = a.length >= this._limit, [3, 5];

          case 2:
            return o.trys.push([2, 4,, 5]), [4, this._getRemoteChannels()];

          case 3:
            return a = o.sent(), this._isGetRemoteChannelsSucceeded = !0, [3, 5];

          case 4:
            return o.sent(), this._isGetRemoteChannelsSucceeded = !1, [3, 5];

          case 5:
            return this._addChannelsToView(a, po.REQUEST_CHANNEL, !0), [2, a];

          case 6:
            return [2, []];
        }
      });
    });
  }, e.prototype.dispose = function () {
    var e, t;
    this._isDisposed || (this._isDisposed = !0, this.channels.length > 0 && this.channels.splice(0, this.channels.length), null === (e = this._backgroundSync) || void 0 === e || e.close(), null === (t = this._changelogSync) || void 0 === t || t.close(), Yn.of(this._iid).unsubscribeChannelEvent(this._key));
  }, e;
}(),
    je = function (e) {
  function t(t) {
    var n = this,
        a = t.token,
        r = t.limit,
        i = t.order,
        s = t.includeEmpty,
        o = t.membershipFilter,
        l = t.channelNameContainsFilter,
        u = t.channelUrlsFilter,
        c = t.customTypesFilter,
        h = t.customTypeStartsWithFilter,
        d = t.superChannelFilter,
        p = t.metadataOrderKeyFilter,
        f = t.metadataKey,
        m = t.metadataValues,
        v = t.metadataValueStartsWith,
        _ = t.includeFrozen,
        g = t.includeMetaData;
    return (n = e.call(this) || this).method = ee.GET, n.path = ie, n.params = J($({
      token: a,
      limit: r,
      order: i,
      show_member: !0,
      show_read_receipt: !0,
      show_delivery_receipt: !0,
      show_empty: s,
      public_mode: Ut.PUBLIC,
      public_membership_mode: o,
      name_contains: l,
      channel_urls: u,
      custom_types: c,
      custom_type_startswith: h,
      super_mode: d,
      metadata_order_key: p,
      metadata_key: f,
      metadata_values: m,
      metadata_value_startswith: v,
      show_frozen: _,
      show_metadata: g
    })), n;
  }

  return t$1(t, e), t;
}(Ne$2),
    We = function (e) {
  function t(t, n) {
    var a = e.call(this, t, n) || this;
    a.channels = [];
    var r = n.next,
        i = n.channels,
        s = n.ts;
    return a.token = r, i && i.length > 0 && (a.channels = i.map(function (e) {
      return e.ts = s, new sr(t, e);
    })), a.ts = "number" == typeof s ? s : 0, a;
  }

  return t$1(t, e), t;
}(Te$2);

!function (e) {
  e.ALL = "all", e.JOINED = "joined";
}(Oe || (Oe = {}));

var ze = function (e) {
  function t(t, n) {
    var a,
        r,
        i,
        s,
        o,
        l,
        u,
        c,
        h,
        d,
        p,
        f,
        m,
        v,
        _ = this;

    return (_ = e.call(this, t, n) || this).includeEmpty = !1, _.includeFrozen = !0, _.includeMetaData = !0, _.channelUrlsFilter = null, _.customTypesFilter = null, _.customTypeStartsWithFilter = null, _.channelNameContainsFilter = null, _.membershipFilter = Oe.ALL, _.superChannelFilter = Tt.ALL, _.metadataKey = null, _.metadataValues = null, _.metadataOrderKeyFilter = null, _.metadataValueStartsWith = null, _.order = f$2.CHRONOLOGICAL, _.includeEmpty = null !== (a = n.includeEmpty) && void 0 !== a && a, _.includeFrozen = null === (r = n.includeFrozen) || void 0 === r || r, _.includeMetaData = null === (i = n.includeMetaData) || void 0 === i || i, _.channelUrlsFilter = null !== (s = n.channelUrlsFilter) && void 0 !== s ? s : null, _.customTypesFilter = null !== (o = n.customTypesFilter) && void 0 !== o ? o : null, _.customTypeStartsWithFilter = null !== (l = n.customTypeStartsWithFilter) && void 0 !== l ? l : null, _.channelNameContainsFilter = null !== (u = n.channelNameContainsFilter) && void 0 !== u ? u : null, _.membershipFilter = null !== (c = n.membershipFilter) && void 0 !== c ? c : Oe.ALL, _.superChannelFilter = null !== (h = n.superChannelFilter) && void 0 !== h ? h : Tt.ALL, _.metadataKey = null !== (d = n.metadataKey) && void 0 !== d ? d : null, _.metadataValues = null !== (p = n.metadataValues) && void 0 !== p ? p : null, _.metadataOrderKeyFilter = null !== (f = n.metadataOrderKeyFilter) && void 0 !== f ? f : null, _.metadataValueStartsWith = null !== (m = n.metadataValueStartsWith) && void 0 !== m ? m : null, _.order = null !== (v = n.order) && void 0 !== v ? v : f$2.CHRONOLOGICAL, _;
  }

  return t$1(t, e), t.prototype._validate = function () {
    return e.prototype._validate.call(this) && w$1("boolean", this.includeEmpty) && w$1("boolean", this.includeFrozen) && w$1("boolean", this.includeMetaData) && w$1("string", this.channelNameContainsFilter, !0) && S$2("string", this.channelUrlsFilter, !0) && S$2("string", this.customTypesFilter, !0) && w$1("string", this.customTypeStartsWithFilter, !0) && N$1(Oe, this.membershipFilter) && N$1(Tt, this.superChannelFilter) && N$1(f$2, this.order) && w$1("string", this.metadataOrderKeyFilter, !0) && w$1("string", this.metadataKey, !0) && S$2("string", this.metadataValues, !0) && w$1("string", this.metadataValueStartsWith, !0);
  }, t.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, a, r, i, o, l;
      return o$1(this, function (u) {
        switch (u.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : (e = [], this._hasNext ? (this._isLoading = !0, t = _o.of(this._iid), n = t.requestQueue, t.dispatcher, a = new je($(n$1(n$1({}, this), {
              token: this._token
            }))), [4, n.send(a)]) : [3, 2]) : [3, 5];

          case 1:
            return r = u.sent(), i = r.as(We), o = i.channels, l = i.token, this._token = l, this._hasNext = !!l, this._isLoading = !1, [2, o];

          case 2:
            return [2, e];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, t;
}(Oo),
    Be = function (e) {
  function t(t) {
    void 0 === t && (t = {});
    var n = e.call(this) || this;
    return Object.keys(t).forEach(function (e) {
      n.hasOwnProperty(e) && (n[e] = t[e]);
    }), n;
  }

  return t$1(t, e), t;
}(function (e) {
  function t() {
    var t = null !== e && e.apply(this, arguments) || this;
    return t.onUserJoined = ze$2, t.onUserLeft = ze$2, t.onUserReceivedInvitation = ze$2, t.onUserDeclinedInvitation = ze$2, t.onChannelHidden = ze$2, t.onUnreadMemberStatusUpdated = ze$2, t.onUndeliveredMemberStatusUpdated = ze$2, t.onTypingStatusUpdated = ze$2, t.onPollUpdated = ze$2, t.onPollVoted = ze$2, t.onPollDeleted = ze$2, t.onPinnedMessageUpdated = ze$2, t;
  }

  return t$1(t, e), t;
}(S)),
    qe = function (e) {
  function t(t) {
    var n = this,
        a = t.token,
        r = t.limit,
        i = t.order,
        s = t.reverse,
        o = t.channelUrl,
        l = t.messageTypeFilter,
        u = t.scheduledStatus;
    return (n = e.call(this) || this).method = ee.GET, n.path = "".concat(_e$1), n.params = J($({
      token: a,
      limit: r,
      reverse: s,
      channel_url: o,
      order: i,
      message_type: l,
      status: u
    })), n;
  }

  return t$1(t, e), t;
}(Ne$2),
    Ye = function (e) {
  function t(t, n) {
    var a = e.call(this, t, n) || this;
    a.scheduledMessages = [];
    var r = n.next,
        i = n.scheduled_messages;
    return a.token = r, a.scheduledMessages = i.map(function (e) {
      return We$1(t, e);
    }), a;
  }

  return t$1(t, e), t;
}(Te$2),
    Je = function (e) {
  function t(t, n) {
    var a,
        r,
        i,
        s,
        o,
        l = this;
    return (l = e.call(this, t, n) || this).channelUrl = null, l.order = null, l.reverse = !1, l.scheduledStatus = null, l.messageTypeFilter = z.ALL, l.channelUrl = null !== (a = n.channelUrl) && void 0 !== a ? a : null, l.order = null !== (r = n.order) && void 0 !== r ? r : null, l.reverse = null !== (i = n.reverse) && void 0 !== i && i, l.scheduledStatus = null !== (s = n.scheduledStatus) && void 0 !== s ? s : null, l.messageTypeFilter = null !== (o = n.messageTypeFilter) && void 0 !== o ? o : z.ALL, l;
  }

  return t$1(t, e), t.prototype._validate = function () {
    return e.prototype._validate.call(this) && w$1("string", this.channelUrl, !0) && (N$1(E, this.order) || null === this.order) && w$1("boolean", this.reverse) && (S$2(Se, this.scheduledStatus) || null === this.scheduledStatus) && N$1(z, this.messageTypeFilter);
  }, t.prototype.next = function () {
    return i$1(this, void 0, void 0, function () {
      var e, t, n, a, r, i;
      return o$1(this, function (o) {
        switch (o.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = !0, e = _o.of(this._iid).requestQueue, t = new qe($(n$1(n$1({}, this), {
              token: this._token
            }))), [4, e.send(t)]) : [3, 2] : [3, 5];

          case 1:
            return n = o.sent(), a = n.as(Ye), r = a.scheduledMessages, i = a.token, this._token = i, this._hasNext = !!i, this._isLoading = !1, [2, r];

          case 2:
            return [2, []];

          case 3:
            throw v$2.queryInProgress;

          case 4:
            return [3, 6];

          case 5:
            throw v$2.invalidParameters;

          case 6:
            return [2];
        }
      });
    });
  }, t;
}(Oo),
    Xe = function (e) {
  function t() {
    var t = null !== e && e.apply(this, arguments) || this;
    return t.name = "groupChannel", t;
  }

  return t$1(t, e), t.prototype.init = function (t, n) {
    var a = n.sdkState,
        r = n.dispatcher,
        i = n.sessionManager,
        s = n.requestQueue,
        o = n.logger,
        l = n.onlineDetector,
        u = n.cacheContext;
    e.prototype.init.call(this, t, {
      sdkState: a,
      dispatcher: r,
      sessionManager: i,
      requestQueue: s,
      logger: o,
      onlineDetector: l,
      cacheContext: u
    }), this._manager = new Yn(t, {
      sdkState: a,
      cacheContext: u,
      dispatcher: r,
      sessionManager: i,
      requestQueue: s,
      logger: o
    });
  }, t.prototype.createGroupChannelCollection = function (e) {
    return void 0 === e && (e = {}), new Qe(this._iid, e);
  }, t.prototype.createMyGroupChannelListQuery = function (e) {
    return void 0 === e && (e = {}), new Gn(this._iid, e);
  }, t.prototype.createPublicGroupChannelListQuery = function (e) {
    return void 0 === e && (e = {}), new ze(this._iid, e);
  }, t.prototype.createScheduledMessageListQuery = function (e) {
    return void 0 === e && (e = {}), new Je(this._iid, e);
  }, t.prototype.addGroupChannelHandler = function (e, t) {
    Qi$1(w$1("string", e) && t instanceof Be).throw(v$2.invalidParameters), this._manager.addHandler(e, t);
  }, t.prototype.removeGroupChannelHandler = function (e) {
    Qi$1(w$1("string", e)).throw(v$2.invalidParameters), this._manager.removeHandler(e);
  }, t.prototype.removeAllGroupChannelHandlers = function () {
    this._manager.clearHandler();
  }, t.prototype.buildGroupChannelFromSerializedData = function (e) {
    return this._manager.buildGroupChannelFromSerializedData(e);
  }, t.prototype.buildGroupChannelListQueryFromSerializedData = function (e) {
    return this._manager.buildGroupChannelListQueryFromSerializedData(e);
  }, t.prototype.buildMemberFromSerializedData = function (e) {
    return this._manager.buildMemberFromSerializedData(e);
  }, t.prototype.getChannel = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), [2, this._manager.getChannel(e)];
      });
    });
  }, t.prototype.getChannelWithoutCache = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), [2, this._manager.getChannelWithoutCache(e)];
      });
    });
  }, t.prototype.getMyGroupChannelChangeLogsByToken = function (e, t) {
    return void 0 === t && (t = {}), i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return n = n$1(n$1({}, Gt), t), Qi$1(w$1("string", e) && Vt(n)).throw(v$2.invalidParameters), [4, this._manager.getMyGroupChannelChangeLogs(e, n)];

          case 1:
            return [2, a.sent()];
        }
      });
    });
  }, t.prototype.getMyGroupChannelChangeLogsByTimestamp = function (e, t) {
    return void 0 === t && (t = {}), i$1(this, void 0, void 0, function () {
      var n;
      return o$1(this, function (a) {
        switch (a.label) {
          case 0:
            return n = n$1(n$1({}, Gt), t), Qi$1(w$1("number", e) && Vt(n)).throw(v$2.invalidParameters), [4, this._manager.getMyGroupChannelChangeLogs(e, n)];

          case 1:
            return [2, a.sent()];
        }
      });
    });
  }, t.prototype.getGroupChannelCount = function (e) {
    return i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        return t = n$1(n$1({}, Bt), e), Qi$1(qt(t)).throw(v$2.invalidParameters), [2, this._manager.getGroupChannelCount(t)];
      });
    });
  }, t.prototype.getUnreadItemCount = function (e) {
    return void 0 === e && (e = {}), i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._manager.getUnreadItemCount(e)];

          case 1:
            return [2, t.sent()];
        }
      });
    });
  }, t.prototype.getTotalUnreadChannelCount = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        switch (e.label) {
          case 0:
            return [4, this._manager.getTotalUnreadChannelCount()];

          case 1:
            return [2, e.sent()];
        }
      });
    });
  }, t.prototype.getTotalUnreadMessageCount = function (e) {
    return void 0 === e && (e = {}), i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._manager.getTotalUnreadMessageCount(e)];

          case 1:
            return [2, t.sent()];
        }
      });
    });
  }, t.prototype.getTotalScheduledMessageCount = function (e) {
    return void 0 === e && (e = {}), i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return [4, this._manager.getTotalScheduledMessageCount(e)];

          case 1:
            return [2, t.sent()];
        }
      });
    });
  }, t.prototype.getSubscribedTotalUnreadMessageCount = function () {
    return this._manager.getSubscribedTotalUnreadMessageCount();
  }, t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount = function () {
    return this._manager.getSubscribedCustomTypeTotalUnreadMessageCount();
  }, t.prototype.getSubscribedCustomTypeUnreadMessageCount = function (e) {
    return this._manager.getSubscribedCustomTypeUnreadMessageCount(e);
  }, t.prototype.createChannel = function (e) {
    return void 0 === e && (e = {}), i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        return t = n$1(n$1({}, xt), e), Qi$1(Ht(t)).throw(v$2.invalidParameters), [2, this._manager.createChannel(t)];
      });
    });
  }, t.prototype.createDistinctChannelIfNotExist = function (e) {
    return void 0 === e && (e = {}), i$1(this, void 0, void 0, function () {
      var t;
      return o$1(this, function (n) {
        return t = n$1(n$1({}, xt), e), Qi$1(Ht(t)).throw(v$2.invalidParameters), t && (t.isDistinct = !0), [2, this.createChannel(t)];
      });
    });
  }, t.prototype.createChannelWithUserIds = function (e, t, n, a, r, s) {
    return void 0 === t && (t = !1), void 0 === r && (r = ""), void 0 === s && (s = ""), i$1(this, void 0, void 0, function () {
      var i;
      return o$1(this, function (o) {
        return i = n$1(n$1({}, xt), {
          invitedUserIds: e,
          isDistinct: t,
          name: n,
          data: r,
          customType: s
        }), "string" == typeof a ? i.coverUrl = a : i.coverImage = a, [2, this.createChannel(i)];
      });
    });
  }, t.prototype.markAsReadAll = function () {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (e) {
        return this._manager.markAsReadAll(), [2];
      });
    });
  }, t.prototype.markAsReadWithChannelUrls = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        return Qi$1(S$2("string", e)).throw(v$2.invalidParameters), this._manager.markAsReadWithChannelUrls(e), [2];
      });
    });
  }, t.prototype.markAsDelivered = function (e) {
    return i$1(this, void 0, void 0, function () {
      return o$1(this, function (t) {
        switch (t.label) {
          case 0:
            return Qi$1(w$1("string", e)).throw(v$2.invalidParameters), [4, this.getChannel(e)];

          case 1:
            return [4, t.sent().markAsDelivered()];

          case 2:
            return t.sent(), [2];
        }
      });
    });
  }, t;
}(fo);

const SUPPORTED_MIMES$2 = {
  IMAGE: ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/svg+xml', 'image/webp' // not supported in IE
  ],
  VIDEO: ['video/mpeg', 'video/ogg', 'video/webm', 'video/mp4'],
  AUDIO: ['audio/aac', 'audio/midi', 'audio/x-midi', 'audio/mpeg', 'audio/ogg', 'audio/opus', 'audio/wav', 'audio/webm', 'audio/3gpp', 'audio/3gpp2', 'audio/mp3']
};
/* eslint-disable no-redeclare */

const SendingMessageStatus$1 = {
  NONE: 'none',
  SUCCEEDED: 'succeeded',
  FAILED: 'failed',
  PENDING: 'pending'
};

const isTextuallyNull = text => {
  if (text === '' || text === null) {
    return true;
  }

  return false;
};

const isImage$1 = type => SUPPORTED_MIMES$2.IMAGE.indexOf(type) >= 0;

const isVideo$1 = type => SUPPORTED_MIMES$2.VIDEO.indexOf(type) >= 0;

const isSupportedFileView = type => isImage$1(type) || isVideo$1(type);

const isUserMessage = message => message && (message['isUserMessage'] && typeof message.isUserMessage === 'function' ? message.isUserMessage() : (message === null || message === void 0 ? void 0 : message.messageType) === 'user');

const isEditedMessage = message => isUserMessage(message) && (message === null || message === void 0 ? void 0 : message.updatedAt) > 0;

const getSendingMessageStatus = () => _objectSpread2({}, SendingMessageStatus$1);

const reducer$3 = (accumulator, currentValue) => {
  if (Array.isArray(currentValue)) {
    return [...accumulator, ...currentValue];
  } else {
    accumulator.push(currentValue);
    return accumulator;
  }
};

const getClassName = classNames => Array.isArray(classNames) ? classNames.reduce(reducer$3, []).join(' ') : classNames;

const URL_REG = /^((http|https):\/\/)?([a-z\d]+\.)+[a-z]{2,6}(\:[0-9]{1,5})?(\/[-a-zA-Z\d%_.~+&=]*)*(\?[;&a-zA-Z\d%_.~+=-]*)?(\#[-a-zA-Z\d_]*)?$/;

const isUrl = text => URL_REG.test(text);

const arrayEqual = (array1, array2) => {
  if (Array.isArray(array1) && Array.isArray(array2) && array1.length === array2.length) {
    for (let i = 0; i < array1.length; i++) {
      if (array1[i] !== array2[i]) {
        return false;
      }
    }

    return true;
  }

  return false;
};

const applicationAttributes = {
  reactions: 'reactions',
  message_search_v3: 'message_search_v3',
  enable_og_tag: 'enable_og_tag',
  enable_message_threading: 'enable_message_threading',
  allow_broadcast_channel: 'allow_broadcast_channel',
  allow_super_group_channel: 'allow_super_group_channel'
};

/**
 * Preserves a reference to the given callback function as an argument while the component is mounted.
 * Wraps the given callback in React's Ref to preserve the reference.
 * @param callback want to be preserved
 */

function usePreservedCallback(callback) {
  const callbackRef = useRef(callback);
  useEffect(() => {
    callbackRef.current = callback;
  });
  return useCallback((...args) => callbackRef.current(...args), [callbackRef]);
}

function snakeToCamel(obj) {
  if (typeof obj !== 'object' || obj === null) {
    return obj;
  }

  if (Array.isArray(obj)) {
    return obj.map(item => snakeToCamel(item));
  }

  const result = {};
  Object.keys(obj).forEach(key => {
    const camelKey = key.replace(/_\w/g, m => m[1].toUpperCase()); // @ts-ignore

    result[camelKey] = snakeToCamel(obj[key]);
  });
  return result;
}

const initialConfig = {
  common: {
    enableUsingDefaultUserProfile: false
  },
  groupChannel: {
    channel: {
      enableMention: false,
      enableOgtag: true,
      enableReactions: true,
      enableTypingIndicator: true,
      enableVoiceMessage: false,
      input: {
        camera: {
          enablePhoto: true,
          enableVideo: true
        },
        enableDocument: true,
        gallery: {
          enablePhoto: true,
          enableVideo: true
        }
      },
      replyType: 'quote_reply',
      threadReplySelectType: 'thread'
    },
    channelList: {
      enableMessageReceiptStatus: false,
      enableTypingIndicator: false
    },
    setting: {
      enableMessageSearch: false
    }
  },
  openChannel: {
    channel: {
      enableOgtag: true,
      input: {
        camera: {
          enablePhoto: true,
          enableVideo: true
        },
        enableDocument: true,
        gallery: {
          enablePhoto: true,
          enableVideo: true
        }
      }
    }
  }
};

function isSameType(a, b) {
  // we do this cause typeof can't differenciate object/ array/ null
  return Object.prototype.toString.call(a) === Object.prototype.toString.call(b);
}

/**
 * @param localConfigs Set directly in code level. It has higher priority than remote ones
 * @param remoteConfigs Set by Feature Config setting in Dashboard
 * @returns
 */

function getConfigsByPriority(localConfigs, remoteConfigs) {
  // copy remoteConfigs to prevent mutation
  const prioritizedConfigs = Object.assign({}, remoteConfigs);
  Object.keys(localConfigs).forEach(key => {
    if (Object.prototype.hasOwnProperty.call(prioritizedConfigs, key) && isSameType(localConfigs[key], prioritizedConfigs[key])) {
      if (typeof localConfigs[key] === 'object') {
        // Recursively call getConfigsByPriority only when the value of the key is Object
        prioritizedConfigs[key] = getConfigsByPriority(localConfigs[key], prioritizedConfigs[key]);
      } else {
        prioritizedConfigs[key] = localConfigs[key];
      }
    }
  });
  return prioritizedConfigs;
}
/**
 * @param json UIKitConfiguration's json
 * @returns boolean
 * */

function isRawSBUConfigPayload(json) {
  return typeof json === 'object' && 'configuration' in json && 'updated_at' in json;
}

var __awaiter$1 = undefined && undefined.__awaiter || function (thisArg, _arguments, P, generator) {
  function adopt(value) {
    return value instanceof P ? value : new P(function (resolve) {
      resolve(value);
    });
  }

  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};
const MemoryStorage = {
  items: {},

  getItem(key) {
    var _a;

    return __awaiter$1(this, void 0, void 0, function* () {
      return (_a = MemoryStorage.items[key]) !== null && _a !== void 0 ? _a : null;
    });
  },

  setItem(key, value) {
    return __awaiter$1(this, void 0, void 0, function* () {
      MemoryStorage.items[key] = value;
    });
  }

};
class UIKitConfigManager {
  constructor(storage) {
    this.storage = storage !== null && storage !== void 0 ? storage : MemoryStorage;
  }

  init(appId) {
    this.key = `sbu@${appId}.uikitConfiguration`;
    return this.get();
  }

  get safeKey() {
    if (!this.key) throw new Error('Please UIKitConfigManager.init() first');
    return this.key;
  }

  update(remoteConfigPayload) {
    return __awaiter$1(this, void 0, void 0, function* () {
      const storedConfigPayload = yield this.get();
      const mergedConfigPayload = {
        updatedAt: remoteConfigPayload.updatedAt,
        configuration: getConfigsByPriority(remoteConfigPayload.configuration, storedConfigPayload.configuration)
      };
      yield this.storage.setItem(this.safeKey, JSON.stringify(mergedConfigPayload));
      return mergedConfigPayload;
    });
  }

  get() {
    return __awaiter$1(this, void 0, void 0, function* () {
      const initialPayload = {
        updatedAt: 0,
        configuration: initialConfig
      };

      try {
        const storedConfig = yield this.storage.getItem(this.safeKey);

        if (storedConfig) {
          // TODO: Validation
          return JSON.parse(storedConfig);
        } else {
          return initialPayload;
        }
      } catch (_a) {
        return initialPayload;
      }
    });
  }

}

var __awaiter = undefined && undefined.__awaiter || function (thisArg, _arguments, P, generator) {
  function adopt(value) {
    return value instanceof P ? value : new P(function (resolve) {
      resolve(value);
    });
  }

  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

function getApplicationAttributes(sdk) {
  var _a, _b;

  return (_b = (_a = sdk.appInfo) === null || _a === void 0 ? void 0 : _a.applicationAttributes) !== null && _b !== void 0 ? _b : [];
}

const UIKitConfigContext = createContext({
  initDashboardConfigs: () => Promise.resolve(),
  configs: initialConfig,
  configsWithAppAttr: () => initialConfig
});

const UIKitConfigProvider = ({
  storage,
  children,
  localConfigs = {}
}) => {
  // Set by Feature Config setting in Dashboard
  const [remoteConfigs, setRemoteConfigs] = useState(initialConfig);
  const [manager] = useState(() => new UIKitConfigManager(storage));
  const initDashboardConfigs = useCallback(sdk => __awaiter(void 0, void 0, void 0, function* () {
    // Compare the sdk uikitConfig's lastUpdatedAt <-> stored one
    const storedConfigPayload = yield manager.init(sdk.appId);

    if (sdk.appInfo && sdk.appInfo.uikitConfigInfo.lastUpdatedAt === storedConfigPayload.updatedAt) {
      setRemoteConfigs(storedConfigPayload.configuration);
    } else {
      try {
        const response = yield sdk.getUIKitConfiguration();

        if (isRawSBUConfigPayload(response.json)) {
          const remoteConfigPayload = snakeToCamel(response.json);
          const updatedConfigPayload = yield manager.update(remoteConfigPayload);
          setRemoteConfigs(updatedConfigPayload.configuration);
        }
      } catch (_a) {
        setRemoteConfigs(storedConfigPayload.configuration);
      }
    }
  }), [manager]);
  const configs = getConfigsByPriority(localConfigs, remoteConfigs);
  const configsWithAppAttr = usePreservedCallback(sdk => ({
    groupChannel: {
      channel: {
        get enableReactions() {
          return configs.groupChannel.channel.enableReactions && getApplicationAttributes(sdk).includes(applicationAttributes.reactions);
        },

        get enableOgtag() {
          return configs.groupChannel.channel.enableOgtag && getApplicationAttributes(sdk).includes(applicationAttributes.enable_og_tag);
        }

      },
      setting: {
        get enableMessageSearch() {
          return configs.groupChannel.setting.enableMessageSearch && getApplicationAttributes(sdk).includes(applicationAttributes.message_search_v3);
        }

      }
    },
    openChannel: {
      channel: {
        get enableOgtag() {
          return configs.openChannel.channel.enableOgtag && getApplicationAttributes(sdk).includes(applicationAttributes.enable_og_tag);
        }

      }
    }
  }));
  return React__default__default.createElement(UIKitConfigContext.Provider, {
    value: {
      initDashboardConfigs,
      configs,
      configsWithAppAttr
    }
  }, children);
};

const useUIKitConfig = () => useContext(UIKitConfigContext);

const SCROLL_BUFFER = 10; // voice message record
const VOICE_RECORDER_DEFAULT_MIN = 1000; // 1 seconds

const VOICE_RECORDER_DEFAULT_MAX = 600000; // 10 minutes

const VOICE_RECORDER_AUDIO_BIT_RATE = 12000;
const VOICE_RECORDER_AUDIO_SAMPLE_RATE = 11025;
const BROWSER_SUPPORT_MIME_TYPE_LIST = ['audio/webm', 'audio/mp4', 'audio/mpeg', 'audio/ogg'];
/**
 * Append Audio element to the root
 * because I can't get the Audio element in the useEffect unmount scope
 */

const VOICE_PLAYER_ROOT_ID = 'sendbird-voice-player-provider-root';
const VOICE_PLAYER_AUDIO_ID = 'sendbird-global-audio-player-id'; // voice message file

const VOICE_MESSAGE_FILE_NAME = 'Voice_message.mp3';
const VOICE_MESSAGE_MIME_TYPE = 'audio/mp3;sbu_type=voice'; // meta array

/**
 * Example:
 * const MyComponent = () => {
 *  const context = useSendbirdStateContext();
 *  const sdk = sendbirdSelectors.getSdk(context);
 *  return (<div>...</div>);
 * }
 */

function useSendbirdStateContext() {
  const context = useContext(SendbirdSdkContext);
  return context;
}

const INITIALIZE_AUDIO_UNIT = 'INITIALIZE_AUDIO_UNIT';
const SET_CURRENT_PLAYER = 'SET_CURRENT_PLAYER';
const ON_VOICE_PLAYER_PLAY = 'ON_VOICE_PLAYER_PLAY';
const ON_VOICE_PLAYER_PAUSE = 'ON_VOICE_PLAYER_PAUSE';
const ON_CURRENT_TIME_UPDATE = 'ON_CURRENT_TIME_UPDATE';
const VOICE_PLAYER_STATUS = {
  IDLE: 'IDLE',
  PREPARING: 'PREPARING',
  PLAYING: 'PLAYING',
  PAUSED: 'PAUSED',
  COMPLETED: 'COMPLETED'
};

const AudioUnitDefaultValue = () => ({
  audioFile: null,
  playbackTime: 0,
  duration: 1000,
  playingStatus: VOICE_PLAYER_STATUS.IDLE
});

const voicePlayerInitialState = {
  currentPlayer: null,
  currentGroupKey: '',
  audioStorage: {}
};

function voicePlayerReducer(state, action) {
  switch (action.type) {
    case INITIALIZE_AUDIO_UNIT:
      {
        var _state$audioStorage;

        const {
          groupKey
        } = action.payload;
        const audioUnit = (_state$audioStorage = state.audioStorage) !== null && _state$audioStorage !== void 0 && _state$audioStorage[groupKey] ? state.audioStorage[groupKey] : AudioUnitDefaultValue();
        audioUnit.playingStatus = VOICE_PLAYER_STATUS.PREPARING;
        return _objectSpread2(_objectSpread2({}, state), {}, {
          audioStorage: _objectSpread2(_objectSpread2({}, state.audioStorage), {}, {
            [groupKey]: audioUnit
          })
        });
      }

    case SET_CURRENT_PLAYER:
      {
        const {
          audioPlayer,
          groupKey
        } = action.payload;
        return _objectSpread2(_objectSpread2({}, state), {}, {
          currentPlayer: audioPlayer,
          currentGroupKey: groupKey
        });
      }

    case ON_VOICE_PLAYER_PLAY:
      {
        var _state$audioStorage2;

        const {
          groupKey,
          audioFile
        } = action.payload;
        const audioUnit = (_state$audioStorage2 = state.audioStorage) !== null && _state$audioStorage2 !== void 0 && _state$audioStorage2[groupKey] ? state.audioStorage[groupKey] : AudioUnitDefaultValue();
        audioUnit.audioFile = audioFile;
        audioUnit.playingStatus = VOICE_PLAYER_STATUS.PLAYING;
        return _objectSpread2(_objectSpread2({}, state), {}, {
          audioStorage: _objectSpread2(_objectSpread2({}, state.audioStorage), {}, {
            [groupKey]: audioUnit
          })
        });
      }

    case ON_VOICE_PLAYER_PAUSE:
      {
        var _state$audioStorage3;

        const {
          groupKey
        } = action.payload;
        const audioUnit = (_state$audioStorage3 = state.audioStorage) !== null && _state$audioStorage3 !== void 0 && _state$audioStorage3[groupKey] ? state.audioStorage[groupKey] : AudioUnitDefaultValue();
        audioUnit.playingStatus = VOICE_PLAYER_STATUS.PAUSED;
        const {
          currentTime,
          duration
        } = state.currentPlayer;

        if (audioUnit.playbackTime === audioUnit.duration) {
          audioUnit.playbackTime = 0;
        } else if (currentTime > 0 && duration > 0) {
          audioUnit.playbackTime = currentTime;
          audioUnit.duration = duration;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          audioStorage: _objectSpread2(_objectSpread2({}, state.audioStorage), {}, {
            [groupKey]: audioUnit
          })
        });
      }

    case ON_CURRENT_TIME_UPDATE:
      {
        var _state$audioStorage4;

        const {
          groupKey
        } = action.payload;
        const {
          currentTime,
          duration
        } = state.currentPlayer;
        const audioUnit = (_state$audioStorage4 = state.audioStorage) !== null && _state$audioStorage4 !== void 0 && _state$audioStorage4[groupKey] ? state.audioStorage[groupKey] : AudioUnitDefaultValue();

        if (currentTime > 0 && duration > 0) {
          audioUnit.playbackTime = currentTime;
          audioUnit.duration = duration;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          audioStorage: _objectSpread2(_objectSpread2({}, state.audioStorage), {}, {
            [groupKey]: audioUnit
          })
        });
      }

    default:
      return state;
  }
} // VoicePlayerProvider interface


const ALL = 'ALL';

const noop$4 = () => {
  /* noop */
};

const VoicePlayerStoreDefaultValue = {
  currentGroupKey: '',
  currentPlayer: null,
  audioStorage: {}
};
const Context$2 = /*#__PURE__*/createContext({
  play: noop$4,
  pause: noop$4,
  stop: noop$4,
  voicePlayerStore: VoicePlayerStoreDefaultValue
});

const VoicePlayerProvider = _ref => {
  let {
    children
  } = _ref;
  const [voicePlayerStore, voicePlayerDispatcher] = useReducer(voicePlayerReducer, voicePlayerInitialState);
  const {
    currentGroupKey,
    currentPlayer,
    audioStorage
  } = voicePlayerStore;
  const {
    config
  } = useSendbirdStateContext();
  const {
    logger
  } = config;

  const stop = function () {
    let text = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

    if (currentGroupKey.includes(text)) {
      logger.info('VoicePlayer: Pause playing(by text).');
      pause(currentGroupKey);
    }
  };

  const pause = groupKey => {
    if (currentGroupKey === groupKey && currentPlayer !== null) {
      logger.info('VoicePlayer: Pause playing(by group key).');
      currentPlayer === null || currentPlayer === void 0 ? void 0 : currentPlayer.pause();
    }

    if (groupKey === ALL) {
      logger.info('VoicePlayer: Pause playing(all).');
      currentPlayer === null || currentPlayer === void 0 ? void 0 : currentPlayer.pause();
    }
  };

  const play = _ref2 => {
    let {
      groupKey,
      audioFile = null,
      audioFileUrl = ''
    } = _ref2;

    if (groupKey !== currentGroupKey) {
      pause(currentGroupKey);
    } // Clear the previous AudioPlayer element


    const voicePlayerRoot = document.getElementById(VOICE_PLAYER_ROOT_ID);
    const voicePlayerAudioElement = document.getElementById(VOICE_PLAYER_AUDIO_ID);

    if (voicePlayerAudioElement) {
      voicePlayerRoot.removeChild(voicePlayerAudioElement);
    }

    logger.info('VoicePlayer: Start getting audio file.');
    new Promise(resolve => {
      var _audioStorage$groupKe;

      voicePlayerDispatcher({
        type: INITIALIZE_AUDIO_UNIT,
        payload: {
          groupKey
        }
      }); // audio file passed as a parameter

      if (audioFile) {
        logger.info('VoicePlayer: Use the audioFile instance.');
        resolve(audioFile);
        return;
      } // audio file from the audioStorage


      const cachedAudioFile = audioStorage === null || audioStorage === void 0 ? void 0 : (_audioStorage$groupKe = audioStorage[groupKey]) === null || _audioStorage$groupKe === void 0 ? void 0 : _audioStorage$groupKe.audioFile;

      if (cachedAudioFile) {
        logger.info('VoicePlayer: Get from the audioStorage.');
        resolve(cachedAudioFile);
        return;
      } // fetch the audio file from URL


      fetch(audioFileUrl).then(res => res.blob()).then(blob => {
        const audioFile = new File([blob], VOICE_MESSAGE_FILE_NAME, {
          lastModified: new Date().getTime(),
          type: VOICE_MESSAGE_MIME_TYPE
        });
        resolve(audioFile);
        logger.info('VoicePlayer: Get the audioFile from URL.');
      });
    }).then(audioFile => {
      var _URL, _URL$createObjectURL;

      const voicePlayerRoot = document.getElementById(VOICE_PLAYER_ROOT_ID);
      logger.info('VoicePlayer: Succeeded getting audio file.', {
        audioFile
      });
      const currentAudioUnit = audioStorage[groupKey] || AudioUnitDefaultValue();
      const audioPlayer = new Audio((_URL = URL) === null || _URL === void 0 ? void 0 : (_URL$createObjectURL = _URL.createObjectURL) === null || _URL$createObjectURL === void 0 ? void 0 : _URL$createObjectURL.call(_URL, audioFile));
      audioPlayer.id = VOICE_PLAYER_AUDIO_ID;
      audioPlayer.currentTime = currentAudioUnit.playbackTime;
      audioPlayer.volume = 1;
      audioPlayer.loop = false;

      audioPlayer.onplaying = () => {
        logger.info('VoicePlayer: OnPlaying event is called from audioPlayer', {
          groupKey,
          audioPlayer
        });
        voicePlayerDispatcher({
          type: ON_VOICE_PLAYER_PLAY,
          payload: {
            groupKey,
            audioFile
          }
        });
      };

      audioPlayer.onpause = () => {
        logger.info('VoicePlayer: OnPause event is called from audioPlayer', {
          groupKey,
          audioPlayer
        });
        voicePlayerDispatcher({
          type: ON_VOICE_PLAYER_PAUSE,
          payload: {
            groupKey
          }
        });
      };

      audioPlayer.ontimeupdate = () => {
        voicePlayerDispatcher({
          type: ON_CURRENT_TIME_UPDATE,
          payload: {
            groupKey
          }
        });
      };

      audioPlayer.dataset.sbGroupId = groupKey; // clean up the previous audio player

      try {
        voicePlayerRoot === null || voicePlayerRoot === void 0 ? void 0 : voicePlayerRoot.childNodes.forEach(node => {
          var _element$dataset;

          const element = node;
          const thisGroupKey = (_element$dataset = element.dataset) === null || _element$dataset === void 0 ? void 0 : _element$dataset.sbGroupKey;

          if (thisGroupKey !== groupKey) {
            var _element$pause;

            element === null || element === void 0 ? void 0 : (_element$pause = element.pause) === null || _element$pause === void 0 ? void 0 : _element$pause.call(element);
            voicePlayerDispatcher({
              type: ON_VOICE_PLAYER_PAUSE,
              payload: {
                groupKey
              }
            });
            voicePlayerRoot.removeChild(element);
            logger.info('VoicePlayer: Removed other player.', {
              element
            });
          }
        });
      } finally {
        audioPlayer === null || audioPlayer === void 0 ? void 0 : audioPlayer.play();
        voicePlayerRoot === null || voicePlayerRoot === void 0 ? void 0 : voicePlayerRoot.appendChild(audioPlayer);
        voicePlayerDispatcher({
          type: SET_CURRENT_PLAYER,
          payload: {
            groupKey,
            audioPlayer
          }
        });
        logger.info('VoicePlayer: Succeeded playing audio player.', {
          groupKey,
          audioPlayer
        });
      }
    });
  };

  return /*#__PURE__*/React__default__default.createElement(Context$2.Provider, {
    value: {
      play,
      pause,
      stop,
      voicePlayerStore
    }
  }, /*#__PURE__*/React__default__default.createElement("div", {
    id: VOICE_PLAYER_ROOT_ID,
    style: {
      display: 'none'
    }
  }), children);
};

/**
 * NOTE:
 * Do not forget to update the string set table on Docs
 * When you update this string set
 */
const getStringSet$1 = function () {
  let lang = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'en';
  const stringSet = {
    en: {
      // Group Channel - Conversation
      MESSAGE_STATUS__YESTERDAY: 'Yesterday',
      CHANNEL__MESSAGE_LIST__NOTIFICATION__NEW_MESSAGE: 'new message(s) since',
      CHANNEL__MESSAGE_LIST__NOTIFICATION__ON: 'on',
      // Channel List
      CHANNEL_PREVIEW_MOBILE_LEAVE: 'Leave channel',
      // Group Channel - Settings
      CHANNEL_SETTING__HEADER__TITLE: 'Channel information',
      CHANNEL_SETTING__PROFILE__EDIT: 'Edit',
      CHANNEL_SETTING__MEMBERS__TITLE: 'Members',
      CHANNEL_SETTING__MEMBERS__SEE_ALL_MEMBERS: 'All members',
      CHANNEL_SETTING__MEMBERS__INVITE_MEMBER: 'Invite users',
      CHANNEL_SETTING__MEMBERS__YOU: ' (You)',
      CHANNEL_SETTING__MEMBERS__SELECT_TITLE: 'Select members',
      CHANNEL_SETTING__MEMBERS__OPERATOR: 'Operator',
      CHANNEL_SETTING__LEAVE_CHANNEL__TITLE: 'Leave channel',
      CHANNEL_SETTING__OPERATORS__TITLE: 'Operators',
      CHANNEL_SETTING__OPERATORS__TITLE_ALL: 'All operators',
      CHANNEL_SETTING__OPERATORS__TITLE_ADD: 'Add operator',
      CHANNEL_SETTING__OPERATORS__ADD_BUTTON: 'Add',
      CHANNEL_SETTING__MUTED_MEMBERS__TITLE: 'Muted members',
      CHANNEL_SETTING__MUTED_MEMBERS__TITLE_ALL: 'All muted members',
      CHANNEL_SETTING__NO_UNMUTED: 'No muted members yet',
      CHANNEL_SETTING__BANNED_MEMBERS__TITLE: 'Banned users',
      CHANNEL_SETTING__FREEZE_CHANNEL: 'Freeze Channel',
      CHANNEL_SETTING__MODERATION__REGISTER_AS_OPERATOR: 'Register as operator',
      CHANNEL_SETTING__MODERATION__UNREGISTER_OPERATOR: 'Unregister operator',
      CHANNEL_SETTING__MODERATION__MUTE: 'Mute',
      CHANNEL_SETTING__MODERATION__UNMUTE: 'Unmute',
      CHANNEL_SETTING__MODERATION__BAN: 'Ban',
      CHANNEL_SETTING__MODERATION__UNBAN: 'Unban',
      CHANNEL_SETTING__MODERATION__EMPTY_BAN: 'No banned members yet',
      CHANNEL_SETTING__MODERATION__ALL_BAN: 'All banned members',
      // OpenChannel - Conversation
      OPEN_CHANNEL_CONVERSATION__TITLE_PARTICIPANTS: 'participants',
      OPEN_CHANNEL_CONVERSATION__SELECT_PARTICIPANTS: 'Select participants',
      // OpenChannelList
      OPEN_CHANNEL_LIST__TITLE: 'Channels',
      CREATE_OPEN_CHANNEL_LIST__TITLE: 'New channel profile',
      CREATE_OPEN_CHANNEL_LIST__SUBTITLE__IMG_SECTION: 'Channel image',
      CREATE_OPEN_CHANNEL_LIST__SUBTITLE__IMG_UPLOAD: 'Upload',
      CREATE_OPEN_CHANNEL_LIST__SUBTITLE__TEXT_SECTION: 'Channel name',
      CREATE_OPEN_CHANNEL_LIST__SUBTITLE__TEXT_PLACE_HOLDER: 'Enter channel name',
      CREATE_OPEN_CHANNEL_LIST__SUBMIT: 'Create',
      // OpenChannel - Settings
      OPEN_CHANNEL_SETTINGS__OPERATOR_TITLE: 'Channel Information',
      OPEN_CHANNEL_SETTINGS__OPERATOR_URL: 'URL',
      OPEN_CHANNEL_SETTINGS__PARTICIPANTS_ACCORDION_TITLE: 'Participants',
      OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_PANEL: 'Delete channel',
      OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_TITLE: 'Delete channel?',
      OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_CONTEXT: 'Once deleted, this channel can\'t be restored.',
      OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_SUBMIT: 'Delete',
      OPEN_CHANNEL_SETTINGS__OPERATORS_TITLE: 'Operators',
      OPEN_CHANNEL_SETTINGS__OPERATORS__TITLE_ADD: 'Add operator',
      OPEN_CHANNEL_SETTINGS__OPERATORS__TITLE_ALL: 'All operators',
      OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__TITLE: 'Muted participants',
      OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__TITLE_ALL: 'All muted participants',
      OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__NO_ONE: 'No muted participants yet',
      OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__TITLE: 'Banned users',
      OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__TITLE_ALL: 'All banned users',
      OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__NO_ONE: 'No banned users yet',
      OPEN_CHANNEL_SETTINGS__MEMBERS__YOU: ' (You)',
      OPEN_CHANNEL_SETTINGS__MEMBERS__OPERATOR: 'Operator',
      OPEN_CHANNEL_SETTINGS__PARTICIPANTS_TITLE: 'Participants',
      OPEN_CHANNEL_SETTINGS__EMPTY_LIST: 'No participants yet',
      OPEN_CHANNEL_SETTINGS__SEE_ALL: 'See all participants',
      OPEN_CHANNEL_SETTINGS__ALL_PARTICIPANTS_TITLE: 'All participants',
      OPEN_CHANNEL_SETTINGS__NO_TITLE: '(No title)',
      OPEN_CHANNEL_SETTING__MODERATION__REGISTER_AS_OPERATOR: 'Register as operator',
      OPEN_CHANNEL_SETTING__MODERATION__UNREGISTER_OPERATOR: 'Unregister operator',
      OPEN_CHANNEL_SETTING__MODERATION__MUTE: 'Mute',
      OPEN_CHANNEL_SETTING__MODERATION__UNMUTE: 'Unmute',
      OPEN_CHANNEL_SETTING__MODERATION__BAN: 'Ban',
      OPEN_CHANNEL_SETTING__MODERATION__UNBAN: 'Unban',
      // Channel - Common
      TRYING_TO_CONNECT: 'Trying to connectâ¦',
      TYPING_INDICATOR__IS_TYPING: 'is typing...',
      TYPING_INDICATOR__AND: 'and',
      TYPING_INDICATOR__ARE_TYPING: 'are typing...',
      TYPING_INDICATOR__MULTIPLE_TYPING: 'Several people are typing...',
      CHANNEL_FROZEN: 'Channel frozen',
      PLACE_HOLDER__NO_CHANNEL: 'No channels',
      PLACE_HOLDER__WRONG: 'Something went wrong',
      PLACE_HOLDER__RETRY_TO_CONNECT: 'Retry',
      PLACE_HOLDER__NO_MESSAGES: 'No messages',
      TOOLTIP__AND_YOU: ', and you',
      TOOLTIP__YOU: 'you',
      TOOLTIP__UNKNOWN_USER: '(no name)',
      UNKNOWN__UNKNOWN_MESSAGE_TYPE: '(Unknown message type)',
      UNKNOWN__CANNOT_READ_MESSAGE: 'Cannot read this message.',
      MESSAGE_EDITED: '(edited)',
      // Channel - Modal
      MODAL__DELETE_MESSAGE__TITLE: 'Delete this message?',
      MODAL__CHANNEL_INFORMATION__TITLE: 'Edit channel information',
      MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE: 'Channel image',
      MODAL__CHANNEL_INFORMATION__UPLOAD: 'Upload',
      MODAL__CHANNEL_INFORMATION__CHANNEL_NAME: 'Channel name',
      MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER: 'Enter name',
      MODAL__INVITE_MEMBER__TITLE: 'Invite member',
      MODAL__INVITE_MEMBER__SELECTED: 'selected',
      MODAL__CHOOSE_CHANNEL_TYPE__TITLE: 'New channel',
      MODAL__CHOOSE_CHANNEL_TYPE__GROUP: 'Group',
      MODAL__CHOOSE_CHANNEL_TYPE__SUPER_GROUP: 'Super group',
      MODAL__CHOOSE_CHANNEL_TYPE__BROADCAST: 'Broadcast',
      MODAL__CREATE_CHANNEL__TITLE: 'New channel',
      MODAL__CREATE_CHANNEL__GROUP: 'Group',
      MODAL__CREATE_CHANNEL__SUPER: 'Super group',
      MODAL__CREATE_CHANNEL__BROADCAST: 'Broadcast',
      MODAL__CREATE_CHANNEL__SELECTED: 'selected',
      MODAL__LEAVE_CHANNEL__TITLE: 'Leave this channel?',
      MODAL__LEAVE_CHANNEL__FOOTER: 'Leave',
      MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_MUTED: 'You\'re muted by the operator.',
      MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_FROZEN: 'Channel is frozen.',
      // User Profile
      USER_PROFILE__MESSAGE: 'Message',
      USER_PROFILE__USER_ID: 'User ID',
      EDIT_PROFILE__TITLE: 'My profile',
      EDIT_PROFILE__IMAGE_LABEL: 'Profile image',
      EDIT_PROFILE__IMAGE_UPLOAD: 'Upload',
      EDIT_PROFILE__NICKNAME_LABEL: 'Nickname',
      EDIT_PROFILE__NICKNAME_PLACEHOLDER: 'Enter your nickname',
      EDIT_PROFILE__USERID_LABEL: 'User ID',
      EDIT_PROFILE__THEME_LABEL: 'Dark theme',
      // Message Input
      MESSAGE_INPUT__PLACE_HOLDER: 'Enter message',
      MESSAGE_INPUT__PLACE_HOLDER__DISABLED: 'Chat is unavailable in this channel',
      MESSAGE_INPUT__PLACE_HOLDER__MUTED: 'Chat is unavailable because you\'re muted',
      MESSAGE_INPUT__PLACE_HOLDER__MUTED_SHORT: 'You\'re muted',
      MESSAGE_INPUT__QUOTE_REPLY__PLACE_HOLDER: 'Reply to message',
      // Common UI
      BUTTON__CANCEL: 'Cancel',
      BUTTON__DELETE: 'Delete',
      BUTTON__SAVE: 'Save',
      BUTTON__CREATE: 'Create',
      BUTTON__INVITE: 'Invite',
      BUTTON__OK: 'OK',
      BADGE__OVER: '+',
      NO_TITLE: 'No title',
      NO_NAME: '(No name)',
      NO_MEMBERS: '(No members)',
      // Context Menu
      MESSAGE_MENU__COPY: 'Copy',
      MESSAGE_MENU__REPLY: 'Reply',
      MESSAGE_MENU__THREAD: 'Reply in thread',
      MESSAGE_MENU__OPEN_IN_CHANNEL: 'Open in channel',
      MESSAGE_MENU__EDIT: 'Edit',
      MESSAGE_MENU__RESEND: 'Resend',
      MESSAGE_MENU__DELETE: 'Delete',
      MESSAGE_MENU__SAVE: 'Save',
      //  * FIXME: get back legacy, remove after refactoring open channel messages *
      CONTEXT_MENU_DROPDOWN__COPY: 'Copy',
      CONTEXT_MENU_DROPDOWN__EDIT: 'Edit',
      CONTEXT_MENU_DROPDOWN__RESEND: 'Resend',
      CONTEXT_MENU_DROPDOWN__DELETE: 'Delete',
      CONTEXT_MENU_DROPDOWN__SAVE: 'Save',
      // Feature - Message Search
      SEARCH: 'Search',
      SEARCH_IN_CHANNEL: 'Search in channel',
      SEARCH_IN: 'Search in',
      SEARCHING: 'Searching for messages...',
      NO_SEARCHED_MESSAGE: 'No results found.',
      // Feature - Message Reply
      QUOTE_MESSAGE_INPUT__REPLY_TO: 'Reply to',
      QUOTE_MESSAGE_INPUT__FILE_TYPE_IMAGE: 'Photo',
      QUOTE_MESSAGE_INPUT__FILE_TYPE_GIF: 'GIF',
      QUOTE_MESSAGE_INPUT__FILE_TYPE__VIDEO: 'Video',
      QUOTED_MESSAGE__REPLIED_TO: 'replied to',
      QUOTED_MESSAGE__CURRENT_USER: 'You',
      QUOTED_MESSAGE__UNAVAILABLE: 'Message unavailable',
      // Feature - Thread
      THREAD__HEADER_TITLE: 'Thread',
      CHANNEL__THREAD_REPLY: 'reply',
      CHANNEL__THREAD_REPLIES: 'replies',
      CHANNEL__THREAD_OVER_MAX: '99+',
      THREAD__THREAD_REPLY: 'reply',
      THREAD__THREAD_REPLIES: 'replies',
      THREAD__INPUT__REPLY_TO_THREAD: 'Reply to thread',
      THREAD__INPUT__REPLY_IN_THREAD: 'Reply in thread',
      // Feature - Mention
      MENTION_NAME__NO_NAME: '(No name)',
      MENTION_COUNT__OVER_LIMIT: 'You can mention up to %d times at a time.',
      UI__FILE_VIEWER__UNSUPPORT: 'Unsupported message',
      // Feature - Voice Message
      VOICE_RECORDING_PERMISSION_DENIED: `You cannot record the voice since
        voice recording is not permitted in your device system setting`,
      VOICE_MESSAGE: 'Voice Message'
    }
  };
  return stringSet[lang];
};

var formatDistanceLocale$1 = {
  lessThanXSeconds: {
    one: 'less than a second',
    other: 'less than {{count}} seconds'
  },
  xSeconds: {
    one: '1 second',
    other: '{{count}} seconds'
  },
  halfAMinute: 'half a minute',
  lessThanXMinutes: {
    one: 'less than a minute',
    other: 'less than {{count}} minutes'
  },
  xMinutes: {
    one: '1 minute',
    other: '{{count}} minutes'
  },
  aboutXHours: {
    one: 'about 1 hour',
    other: 'about {{count}} hours'
  },
  xHours: {
    one: '1 hour',
    other: '{{count}} hours'
  },
  xDays: {
    one: '1 day',
    other: '{{count}} days'
  },
  aboutXWeeks: {
    one: 'about 1 week',
    other: 'about {{count}} weeks'
  },
  xWeeks: {
    one: '1 week',
    other: '{{count}} weeks'
  },
  aboutXMonths: {
    one: 'about 1 month',
    other: 'about {{count}} months'
  },
  xMonths: {
    one: '1 month',
    other: '{{count}} months'
  },
  aboutXYears: {
    one: 'about 1 year',
    other: 'about {{count}} years'
  },
  xYears: {
    one: '1 year',
    other: '{{count}} years'
  },
  overXYears: {
    one: 'over 1 year',
    other: 'over {{count}} years'
  },
  almostXYears: {
    one: 'almost 1 year',
    other: 'almost {{count}} years'
  }
};

var formatDistance$1 = function formatDistance(token, count, options) {
  var result;
  var tokenValue = formatDistanceLocale$1[token];

  if (typeof tokenValue === 'string') {
    result = tokenValue;
  } else if (count === 1) {
    result = tokenValue.one;
  } else {
    result = tokenValue.other.replace('{{count}}', count.toString());
  }

  if (options !== null && options !== void 0 && options.addSuffix) {
    if (options.comparison && options.comparison > 0) {
      return 'in ' + result;
    } else {
      return result + ' ago';
    }
  }

  return result;
};

function buildFormatLongFn$1(args) {
  return function () {
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}; // TODO: Remove String()

    var width = options.width ? String(options.width) : args.defaultWidth;
    var format = args.formats[width] || args.formats[args.defaultWidth];
    return format;
  };
}

var dateFormats$1 = {
  full: 'EEEE, MMMM do, y',
  long: 'MMMM do, y',
  medium: 'MMM d, y',
  short: 'MM/dd/yyyy'
};
var timeFormats$1 = {
  full: 'h:mm:ss a zzzz',
  long: 'h:mm:ss a z',
  medium: 'h:mm:ss a',
  short: 'h:mm a'
};
var dateTimeFormats$1 = {
  full: "{{date}} 'at' {{time}}",
  long: "{{date}} 'at' {{time}}",
  medium: '{{date}}, {{time}}',
  short: '{{date}}, {{time}}'
};
var formatLong$1 = {
  date: buildFormatLongFn$1({
    formats: dateFormats$1,
    defaultWidth: 'full'
  }),
  time: buildFormatLongFn$1({
    formats: timeFormats$1,
    defaultWidth: 'full'
  }),
  dateTime: buildFormatLongFn$1({
    formats: dateTimeFormats$1,
    defaultWidth: 'full'
  })
};
var formatRelativeLocale$1 = {
  lastWeek: "'last' eeee 'at' p",
  yesterday: "'yesterday at' p",
  today: "'today at' p",
  tomorrow: "'tomorrow at' p",
  nextWeek: "eeee 'at' p",
  other: 'P'
};

var formatRelative$1 = function formatRelative(token, _date, _baseDate, _options) {
  return formatRelativeLocale$1[token];
};

function buildLocalizeFn$1(args) {
  return function (dirtyIndex, options) {
    var context = options !== null && options !== void 0 && options.context ? String(options.context) : 'standalone';
    var valuesArray;

    if (context === 'formatting' && args.formattingValues) {
      var defaultWidth = args.defaultFormattingWidth || args.defaultWidth;
      var width = options !== null && options !== void 0 && options.width ? String(options.width) : defaultWidth;
      valuesArray = args.formattingValues[width] || args.formattingValues[defaultWidth];
    } else {
      var _defaultWidth = args.defaultWidth;

      var _width = options !== null && options !== void 0 && options.width ? String(options.width) : args.defaultWidth;

      valuesArray = args.values[_width] || args.values[_defaultWidth];
    }

    var index = args.argumentCallback ? args.argumentCallback(dirtyIndex) : dirtyIndex; // @ts-ignore: For some reason TypeScript just don't want to match it, no matter how hard we try. I challenge you to try to remove it!

    return valuesArray[index];
  };
}

var eraValues$1 = {
  narrow: ['B', 'A'],
  abbreviated: ['BC', 'AD'],
  wide: ['Before Christ', 'Anno Domini']
};
var quarterValues$1 = {
  narrow: ['1', '2', '3', '4'],
  abbreviated: ['Q1', 'Q2', 'Q3', 'Q4'],
  wide: ['1st quarter', '2nd quarter', '3rd quarter', '4th quarter']
}; // Note: in English, the names of days of the week and months are capitalized.
// If you are making a new locale based on this one, check if the same is true for the language you're working on.
// Generally, formatted dates should look like they are in the middle of a sentence,
// e.g. in Spanish language the weekdays and months should be in the lowercase.

var monthValues$1 = {
  narrow: ['J', 'F', 'M', 'A', 'M', 'J', 'J', 'A', 'S', 'O', 'N', 'D'],
  abbreviated: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
  wide: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
};
var dayValues$1 = {
  narrow: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],
  short: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
  abbreviated: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
  wide: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
};
var dayPeriodValues$1 = {
  narrow: {
    am: 'a',
    pm: 'p',
    midnight: 'mi',
    noon: 'n',
    morning: 'morning',
    afternoon: 'afternoon',
    evening: 'evening',
    night: 'night'
  },
  abbreviated: {
    am: 'AM',
    pm: 'PM',
    midnight: 'midnight',
    noon: 'noon',
    morning: 'morning',
    afternoon: 'afternoon',
    evening: 'evening',
    night: 'night'
  },
  wide: {
    am: 'a.m.',
    pm: 'p.m.',
    midnight: 'midnight',
    noon: 'noon',
    morning: 'morning',
    afternoon: 'afternoon',
    evening: 'evening',
    night: 'night'
  }
};
var formattingDayPeriodValues$1 = {
  narrow: {
    am: 'a',
    pm: 'p',
    midnight: 'mi',
    noon: 'n',
    morning: 'in the morning',
    afternoon: 'in the afternoon',
    evening: 'in the evening',
    night: 'at night'
  },
  abbreviated: {
    am: 'AM',
    pm: 'PM',
    midnight: 'midnight',
    noon: 'noon',
    morning: 'in the morning',
    afternoon: 'in the afternoon',
    evening: 'in the evening',
    night: 'at night'
  },
  wide: {
    am: 'a.m.',
    pm: 'p.m.',
    midnight: 'midnight',
    noon: 'noon',
    morning: 'in the morning',
    afternoon: 'in the afternoon',
    evening: 'in the evening',
    night: 'at night'
  }
};

var ordinalNumber$1 = function ordinalNumber(dirtyNumber, _options) {
  var number = Number(dirtyNumber); // If ordinal numbers depend on context, for example,
  // if they are different for different grammatical genders,
  // use `options.unit`.
  //
  // `unit` can be 'year', 'quarter', 'month', 'week', 'date', 'dayOfYear',
  // 'day', 'hour', 'minute', 'second'.

  var rem100 = number % 100;

  if (rem100 > 20 || rem100 < 10) {
    switch (rem100 % 10) {
      case 1:
        return number + 'st';

      case 2:
        return number + 'nd';

      case 3:
        return number + 'rd';
    }
  }

  return number + 'th';
};

var localize$1 = {
  ordinalNumber: ordinalNumber$1,
  era: buildLocalizeFn$1({
    values: eraValues$1,
    defaultWidth: 'wide'
  }),
  quarter: buildLocalizeFn$1({
    values: quarterValues$1,
    defaultWidth: 'wide',
    argumentCallback: function argumentCallback(quarter) {
      return quarter - 1;
    }
  }),
  month: buildLocalizeFn$1({
    values: monthValues$1,
    defaultWidth: 'wide'
  }),
  day: buildLocalizeFn$1({
    values: dayValues$1,
    defaultWidth: 'wide'
  }),
  dayPeriod: buildLocalizeFn$1({
    values: dayPeriodValues$1,
    defaultWidth: 'wide',
    formattingValues: formattingDayPeriodValues$1,
    defaultFormattingWidth: 'wide'
  })
};

function buildMatchFn$1(args) {
  return function (string) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var width = options.width;
    var matchPattern = width && args.matchPatterns[width] || args.matchPatterns[args.defaultMatchWidth];
    var matchResult = string.match(matchPattern);

    if (!matchResult) {
      return null;
    }

    var matchedString = matchResult[0];
    var parsePatterns = width && args.parsePatterns[width] || args.parsePatterns[args.defaultParseWidth];
    var key = Array.isArray(parsePatterns) ? findIndex$1(parsePatterns, function (pattern) {
      return pattern.test(matchedString);
    }) : findKey$1(parsePatterns, function (pattern) {
      return pattern.test(matchedString);
    });
    var value;
    value = args.valueCallback ? args.valueCallback(key) : key;
    value = options.valueCallback ? options.valueCallback(value) : value;
    var rest = string.slice(matchedString.length);
    return {
      value: value,
      rest: rest
    };
  };
}

function findKey$1(object, predicate) {
  for (var key in object) {
    if (object.hasOwnProperty(key) && predicate(object[key])) {
      return key;
    }
  }

  return undefined;
}

function findIndex$1(array, predicate) {
  for (var key = 0; key < array.length; key++) {
    if (predicate(array[key])) {
      return key;
    }
  }

  return undefined;
}

function buildMatchPatternFn$1(args) {
  return function (string) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var matchResult = string.match(args.matchPattern);
    if (!matchResult) return null;
    var matchedString = matchResult[0];
    var parseResult = string.match(args.parsePattern);
    if (!parseResult) return null;
    var value = args.valueCallback ? args.valueCallback(parseResult[0]) : parseResult[0];
    value = options.valueCallback ? options.valueCallback(value) : value;
    var rest = string.slice(matchedString.length);
    return {
      value: value,
      rest: rest
    };
  };
}

var matchOrdinalNumberPattern$1 = /^(\d+)(th|st|nd|rd)?/i;
var parseOrdinalNumberPattern$1 = /\d+/i;
var matchEraPatterns$1 = {
  narrow: /^(b|a)/i,
  abbreviated: /^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,
  wide: /^(before christ|before common era|anno domini|common era)/i
};
var parseEraPatterns$1 = {
  any: [/^b/i, /^(a|c)/i]
};
var matchQuarterPatterns$1 = {
  narrow: /^[1234]/i,
  abbreviated: /^q[1234]/i,
  wide: /^[1234](th|st|nd|rd)? quarter/i
};
var parseQuarterPatterns$1 = {
  any: [/1/i, /2/i, /3/i, /4/i]
};
var matchMonthPatterns$1 = {
  narrow: /^[jfmasond]/i,
  abbreviated: /^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,
  wide: /^(january|february|march|april|may|june|july|august|september|october|november|december)/i
};
var parseMonthPatterns$1 = {
  narrow: [/^j/i, /^f/i, /^m/i, /^a/i, /^m/i, /^j/i, /^j/i, /^a/i, /^s/i, /^o/i, /^n/i, /^d/i],
  any: [/^ja/i, /^f/i, /^mar/i, /^ap/i, /^may/i, /^jun/i, /^jul/i, /^au/i, /^s/i, /^o/i, /^n/i, /^d/i]
};
var matchDayPatterns$1 = {
  narrow: /^[smtwf]/i,
  short: /^(su|mo|tu|we|th|fr|sa)/i,
  abbreviated: /^(sun|mon|tue|wed|thu|fri|sat)/i,
  wide: /^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i
};
var parseDayPatterns$1 = {
  narrow: [/^s/i, /^m/i, /^t/i, /^w/i, /^t/i, /^f/i, /^s/i],
  any: [/^su/i, /^m/i, /^tu/i, /^w/i, /^th/i, /^f/i, /^sa/i]
};
var matchDayPeriodPatterns$1 = {
  narrow: /^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,
  any: /^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i
};
var parseDayPeriodPatterns$1 = {
  any: {
    am: /^a/i,
    pm: /^p/i,
    midnight: /^mi/i,
    noon: /^no/i,
    morning: /morning/i,
    afternoon: /afternoon/i,
    evening: /evening/i,
    night: /night/i
  }
};
var match$1 = {
  ordinalNumber: buildMatchPatternFn$1({
    matchPattern: matchOrdinalNumberPattern$1,
    parsePattern: parseOrdinalNumberPattern$1,
    valueCallback: function valueCallback(value) {
      return parseInt(value, 10);
    }
  }),
  era: buildMatchFn$1({
    matchPatterns: matchEraPatterns$1,
    defaultMatchWidth: 'wide',
    parsePatterns: parseEraPatterns$1,
    defaultParseWidth: 'any'
  }),
  quarter: buildMatchFn$1({
    matchPatterns: matchQuarterPatterns$1,
    defaultMatchWidth: 'wide',
    parsePatterns: parseQuarterPatterns$1,
    defaultParseWidth: 'any',
    valueCallback: function valueCallback(index) {
      return index + 1;
    }
  }),
  month: buildMatchFn$1({
    matchPatterns: matchMonthPatterns$1,
    defaultMatchWidth: 'wide',
    parsePatterns: parseMonthPatterns$1,
    defaultParseWidth: 'any'
  }),
  day: buildMatchFn$1({
    matchPatterns: matchDayPatterns$1,
    defaultMatchWidth: 'wide',
    parsePatterns: parseDayPatterns$1,
    defaultParseWidth: 'any'
  }),
  dayPeriod: buildMatchFn$1({
    matchPatterns: matchDayPeriodPatterns$1,
    defaultMatchWidth: 'any',
    parsePatterns: parseDayPeriodPatterns$1,
    defaultParseWidth: 'any'
  })
};
/**
 * @type {Locale}
 * @category Locales
 * @summary English locale (United States).
 * @language English
 * @iso-639-2 eng
 * @author Sasha Koss [@kossnocorp]{@link https://github.com/kossnocorp}
 * @author Lesha Koss [@leshakoss]{@link https://github.com/leshakoss}
 */

var locale$1 = {
  code: 'en-US',
  formatDistance: formatDistance$1,
  formatLong: formatLong$1,
  formatRelative: formatRelative$1,
  localize: localize$1,
  match: match$1,
  options: {
    weekStartsOn: 0
    /* Sunday */
    ,
    firstWeekContainsDate: 1
  }
};
var defaultLocale$1 = locale$1;

const LocalizationContext = /*#__PURE__*/React__default__default.createContext({
  stringSet: getStringSet$1('en'),
  dateLocale: defaultLocale$1
});

const LocalizationProvider = props => {
  const {
    children
  } = props;
  return /*#__PURE__*/React__default__default.createElement(LocalizationContext.Provider, {
    value: props
  }, children);
};

const useLocalization = () => React__default__default.useContext(LocalizationContext);

const MODAL_ROOT = 'sendbird-modal-root';

var propTypes = {exports: {}};

var reactIs = {exports: {}};

var reactIs_production_min = {};

/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var hasRequiredReactIs_production_min;

function requireReactIs_production_min () {
	if (hasRequiredReactIs_production_min) return reactIs_production_min;
	hasRequiredReactIs_production_min = 1;

	var b = "function" === typeof Symbol && Symbol.for,
	    c = b ? Symbol.for("react.element") : 60103,
	    d = b ? Symbol.for("react.portal") : 60106,
	    e = b ? Symbol.for("react.fragment") : 60107,
	    f = b ? Symbol.for("react.strict_mode") : 60108,
	    g = b ? Symbol.for("react.profiler") : 60114,
	    h = b ? Symbol.for("react.provider") : 60109,
	    k = b ? Symbol.for("react.context") : 60110,
	    l = b ? Symbol.for("react.async_mode") : 60111,
	    m = b ? Symbol.for("react.concurrent_mode") : 60111,
	    n = b ? Symbol.for("react.forward_ref") : 60112,
	    p = b ? Symbol.for("react.suspense") : 60113,
	    q = b ? Symbol.for("react.suspense_list") : 60120,
	    r = b ? Symbol.for("react.memo") : 60115,
	    t = b ? Symbol.for("react.lazy") : 60116,
	    v = b ? Symbol.for("react.block") : 60121,
	    w = b ? Symbol.for("react.fundamental") : 60117,
	    x = b ? Symbol.for("react.responder") : 60118,
	    y = b ? Symbol.for("react.scope") : 60119;

	function z(a) {
	  if ("object" === typeof a && null !== a) {
	    var u = a.$$typeof;

	    switch (u) {
	      case c:
	        switch (a = a.type, a) {
	          case l:
	          case m:
	          case e:
	          case g:
	          case f:
	          case p:
	            return a;

	          default:
	            switch (a = a && a.$$typeof, a) {
	              case k:
	              case n:
	              case t:
	              case r:
	              case h:
	                return a;

	              default:
	                return u;
	            }

	        }

	      case d:
	        return u;
	    }
	  }
	}

	function A(a) {
	  return z(a) === m;
	}

	reactIs_production_min.AsyncMode = l;
	reactIs_production_min.ConcurrentMode = m;
	reactIs_production_min.ContextConsumer = k;
	reactIs_production_min.ContextProvider = h;
	reactIs_production_min.Element = c;
	reactIs_production_min.ForwardRef = n;
	reactIs_production_min.Fragment = e;
	reactIs_production_min.Lazy = t;
	reactIs_production_min.Memo = r;
	reactIs_production_min.Portal = d;
	reactIs_production_min.Profiler = g;
	reactIs_production_min.StrictMode = f;
	reactIs_production_min.Suspense = p;

	reactIs_production_min.isAsyncMode = function (a) {
	  return A(a) || z(a) === l;
	};

	reactIs_production_min.isConcurrentMode = A;

	reactIs_production_min.isContextConsumer = function (a) {
	  return z(a) === k;
	};

	reactIs_production_min.isContextProvider = function (a) {
	  return z(a) === h;
	};

	reactIs_production_min.isElement = function (a) {
	  return "object" === typeof a && null !== a && a.$$typeof === c;
	};

	reactIs_production_min.isForwardRef = function (a) {
	  return z(a) === n;
	};

	reactIs_production_min.isFragment = function (a) {
	  return z(a) === e;
	};

	reactIs_production_min.isLazy = function (a) {
	  return z(a) === t;
	};

	reactIs_production_min.isMemo = function (a) {
	  return z(a) === r;
	};

	reactIs_production_min.isPortal = function (a) {
	  return z(a) === d;
	};

	reactIs_production_min.isProfiler = function (a) {
	  return z(a) === g;
	};

	reactIs_production_min.isStrictMode = function (a) {
	  return z(a) === f;
	};

	reactIs_production_min.isSuspense = function (a) {
	  return z(a) === p;
	};

	reactIs_production_min.isValidElementType = function (a) {
	  return "string" === typeof a || "function" === typeof a || a === e || a === m || a === g || a === f || a === p || a === q || "object" === typeof a && null !== a && (a.$$typeof === t || a.$$typeof === r || a.$$typeof === h || a.$$typeof === k || a.$$typeof === n || a.$$typeof === w || a.$$typeof === x || a.$$typeof === y || a.$$typeof === v);
	};

	reactIs_production_min.typeOf = z;
	return reactIs_production_min;
}

var reactIs_development = {};

/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var hasRequiredReactIs_development;

function requireReactIs_development () {
	if (hasRequiredReactIs_development) return reactIs_development;
	hasRequiredReactIs_development = 1;

	if (process.env.NODE_ENV !== "production") {
	  (function () {
	    // nor polyfill, then a plain number is used for performance.

	    var hasSymbol = typeof Symbol === 'function' && Symbol.for;
	    var REACT_ELEMENT_TYPE = hasSymbol ? Symbol.for('react.element') : 0xeac7;
	    var REACT_PORTAL_TYPE = hasSymbol ? Symbol.for('react.portal') : 0xeaca;
	    var REACT_FRAGMENT_TYPE = hasSymbol ? Symbol.for('react.fragment') : 0xeacb;
	    var REACT_STRICT_MODE_TYPE = hasSymbol ? Symbol.for('react.strict_mode') : 0xeacc;
	    var REACT_PROFILER_TYPE = hasSymbol ? Symbol.for('react.profiler') : 0xead2;
	    var REACT_PROVIDER_TYPE = hasSymbol ? Symbol.for('react.provider') : 0xeacd;
	    var REACT_CONTEXT_TYPE = hasSymbol ? Symbol.for('react.context') : 0xeace; // TODO: We don't use AsyncMode or ConcurrentMode anymore. They were temporary
	    // (unstable) APIs that have been removed. Can we remove the symbols?

	    var REACT_ASYNC_MODE_TYPE = hasSymbol ? Symbol.for('react.async_mode') : 0xeacf;
	    var REACT_CONCURRENT_MODE_TYPE = hasSymbol ? Symbol.for('react.concurrent_mode') : 0xeacf;
	    var REACT_FORWARD_REF_TYPE = hasSymbol ? Symbol.for('react.forward_ref') : 0xead0;
	    var REACT_SUSPENSE_TYPE = hasSymbol ? Symbol.for('react.suspense') : 0xead1;
	    var REACT_SUSPENSE_LIST_TYPE = hasSymbol ? Symbol.for('react.suspense_list') : 0xead8;
	    var REACT_MEMO_TYPE = hasSymbol ? Symbol.for('react.memo') : 0xead3;
	    var REACT_LAZY_TYPE = hasSymbol ? Symbol.for('react.lazy') : 0xead4;
	    var REACT_BLOCK_TYPE = hasSymbol ? Symbol.for('react.block') : 0xead9;
	    var REACT_FUNDAMENTAL_TYPE = hasSymbol ? Symbol.for('react.fundamental') : 0xead5;
	    var REACT_RESPONDER_TYPE = hasSymbol ? Symbol.for('react.responder') : 0xead6;
	    var REACT_SCOPE_TYPE = hasSymbol ? Symbol.for('react.scope') : 0xead7;

	    function isValidElementType(type) {
	      return typeof type === 'string' || typeof type === 'function' || // Note: its typeof might be other than 'symbol' or 'number' if it's a polyfill.
	      type === REACT_FRAGMENT_TYPE || type === REACT_CONCURRENT_MODE_TYPE || type === REACT_PROFILER_TYPE || type === REACT_STRICT_MODE_TYPE || type === REACT_SUSPENSE_TYPE || type === REACT_SUSPENSE_LIST_TYPE || typeof type === 'object' && type !== null && (type.$$typeof === REACT_LAZY_TYPE || type.$$typeof === REACT_MEMO_TYPE || type.$$typeof === REACT_PROVIDER_TYPE || type.$$typeof === REACT_CONTEXT_TYPE || type.$$typeof === REACT_FORWARD_REF_TYPE || type.$$typeof === REACT_FUNDAMENTAL_TYPE || type.$$typeof === REACT_RESPONDER_TYPE || type.$$typeof === REACT_SCOPE_TYPE || type.$$typeof === REACT_BLOCK_TYPE);
	    }

	    function typeOf(object) {
	      if (typeof object === 'object' && object !== null) {
	        var $$typeof = object.$$typeof;

	        switch ($$typeof) {
	          case REACT_ELEMENT_TYPE:
	            var type = object.type;

	            switch (type) {
	              case REACT_ASYNC_MODE_TYPE:
	              case REACT_CONCURRENT_MODE_TYPE:
	              case REACT_FRAGMENT_TYPE:
	              case REACT_PROFILER_TYPE:
	              case REACT_STRICT_MODE_TYPE:
	              case REACT_SUSPENSE_TYPE:
	                return type;

	              default:
	                var $$typeofType = type && type.$$typeof;

	                switch ($$typeofType) {
	                  case REACT_CONTEXT_TYPE:
	                  case REACT_FORWARD_REF_TYPE:
	                  case REACT_LAZY_TYPE:
	                  case REACT_MEMO_TYPE:
	                  case REACT_PROVIDER_TYPE:
	                    return $$typeofType;

	                  default:
	                    return $$typeof;
	                }

	            }

	          case REACT_PORTAL_TYPE:
	            return $$typeof;
	        }
	      }

	      return undefined;
	    } // AsyncMode is deprecated along with isAsyncMode


	    var AsyncMode = REACT_ASYNC_MODE_TYPE;
	    var ConcurrentMode = REACT_CONCURRENT_MODE_TYPE;
	    var ContextConsumer = REACT_CONTEXT_TYPE;
	    var ContextProvider = REACT_PROVIDER_TYPE;
	    var Element = REACT_ELEMENT_TYPE;
	    var ForwardRef = REACT_FORWARD_REF_TYPE;
	    var Fragment = REACT_FRAGMENT_TYPE;
	    var Lazy = REACT_LAZY_TYPE;
	    var Memo = REACT_MEMO_TYPE;
	    var Portal = REACT_PORTAL_TYPE;
	    var Profiler = REACT_PROFILER_TYPE;
	    var StrictMode = REACT_STRICT_MODE_TYPE;
	    var Suspense = REACT_SUSPENSE_TYPE;
	    var hasWarnedAboutDeprecatedIsAsyncMode = false; // AsyncMode should be deprecated

	    function isAsyncMode(object) {
	      {
	        if (!hasWarnedAboutDeprecatedIsAsyncMode) {
	          hasWarnedAboutDeprecatedIsAsyncMode = true; // Using console['warn'] to evade Babel and ESLint

	          console['warn']('The ReactIs.isAsyncMode() alias has been deprecated, ' + 'and will be removed in React 17+. Update your code to use ' + 'ReactIs.isConcurrentMode() instead. It has the exact same API.');
	        }
	      }
	      return isConcurrentMode(object) || typeOf(object) === REACT_ASYNC_MODE_TYPE;
	    }

	    function isConcurrentMode(object) {
	      return typeOf(object) === REACT_CONCURRENT_MODE_TYPE;
	    }

	    function isContextConsumer(object) {
	      return typeOf(object) === REACT_CONTEXT_TYPE;
	    }

	    function isContextProvider(object) {
	      return typeOf(object) === REACT_PROVIDER_TYPE;
	    }

	    function isElement(object) {
	      return typeof object === 'object' && object !== null && object.$$typeof === REACT_ELEMENT_TYPE;
	    }

	    function isForwardRef(object) {
	      return typeOf(object) === REACT_FORWARD_REF_TYPE;
	    }

	    function isFragment(object) {
	      return typeOf(object) === REACT_FRAGMENT_TYPE;
	    }

	    function isLazy(object) {
	      return typeOf(object) === REACT_LAZY_TYPE;
	    }

	    function isMemo(object) {
	      return typeOf(object) === REACT_MEMO_TYPE;
	    }

	    function isPortal(object) {
	      return typeOf(object) === REACT_PORTAL_TYPE;
	    }

	    function isProfiler(object) {
	      return typeOf(object) === REACT_PROFILER_TYPE;
	    }

	    function isStrictMode(object) {
	      return typeOf(object) === REACT_STRICT_MODE_TYPE;
	    }

	    function isSuspense(object) {
	      return typeOf(object) === REACT_SUSPENSE_TYPE;
	    }

	    reactIs_development.AsyncMode = AsyncMode;
	    reactIs_development.ConcurrentMode = ConcurrentMode;
	    reactIs_development.ContextConsumer = ContextConsumer;
	    reactIs_development.ContextProvider = ContextProvider;
	    reactIs_development.Element = Element;
	    reactIs_development.ForwardRef = ForwardRef;
	    reactIs_development.Fragment = Fragment;
	    reactIs_development.Lazy = Lazy;
	    reactIs_development.Memo = Memo;
	    reactIs_development.Portal = Portal;
	    reactIs_development.Profiler = Profiler;
	    reactIs_development.StrictMode = StrictMode;
	    reactIs_development.Suspense = Suspense;
	    reactIs_development.isAsyncMode = isAsyncMode;
	    reactIs_development.isConcurrentMode = isConcurrentMode;
	    reactIs_development.isContextConsumer = isContextConsumer;
	    reactIs_development.isContextProvider = isContextProvider;
	    reactIs_development.isElement = isElement;
	    reactIs_development.isForwardRef = isForwardRef;
	    reactIs_development.isFragment = isFragment;
	    reactIs_development.isLazy = isLazy;
	    reactIs_development.isMemo = isMemo;
	    reactIs_development.isPortal = isPortal;
	    reactIs_development.isProfiler = isProfiler;
	    reactIs_development.isStrictMode = isStrictMode;
	    reactIs_development.isSuspense = isSuspense;
	    reactIs_development.isValidElementType = isValidElementType;
	    reactIs_development.typeOf = typeOf;
	  })();
	}
	return reactIs_development;
}

var hasRequiredReactIs;

function requireReactIs () {
	if (hasRequiredReactIs) return reactIs.exports;
	hasRequiredReactIs = 1;
	(function (module) {

		if (process.env.NODE_ENV === 'production') {
		  module.exports = requireReactIs_production_min();
		} else {
		  module.exports = requireReactIs_development();
		}
} (reactIs));
	return reactIs.exports;
}

/*
object-assign
(c) Sindre Sorhus
@license MIT
*/

var objectAssign;
var hasRequiredObjectAssign;

function requireObjectAssign () {
	if (hasRequiredObjectAssign) return objectAssign;
	hasRequiredObjectAssign = 1;
	/* eslint-disable no-unused-vars */

	var getOwnPropertySymbols = Object.getOwnPropertySymbols;
	var hasOwnProperty = Object.prototype.hasOwnProperty;
	var propIsEnumerable = Object.prototype.propertyIsEnumerable;

	function toObject(val) {
	  if (val === null || val === undefined) {
	    throw new TypeError('Object.assign cannot be called with null or undefined');
	  }

	  return Object(val);
	}

	function shouldUseNative() {
	  try {
	    if (!Object.assign) {
	      return false;
	    } // Detect buggy property enumeration order in older V8 versions.
	    // https://bugs.chromium.org/p/v8/issues/detail?id=4118


	    var test1 = new String('abc'); // eslint-disable-line no-new-wrappers

	    test1[5] = 'de';

	    if (Object.getOwnPropertyNames(test1)[0] === '5') {
	      return false;
	    } // https://bugs.chromium.org/p/v8/issues/detail?id=3056


	    var test2 = {};

	    for (var i = 0; i < 10; i++) {
	      test2['_' + String.fromCharCode(i)] = i;
	    }

	    var order2 = Object.getOwnPropertyNames(test2).map(function (n) {
	      return test2[n];
	    });

	    if (order2.join('') !== '0123456789') {
	      return false;
	    } // https://bugs.chromium.org/p/v8/issues/detail?id=3056


	    var test3 = {};
	    'abcdefghijklmnopqrst'.split('').forEach(function (letter) {
	      test3[letter] = letter;
	    });

	    if (Object.keys(Object.assign({}, test3)).join('') !== 'abcdefghijklmnopqrst') {
	      return false;
	    }

	    return true;
	  } catch (err) {
	    // We don't expect any of the above to throw, but better to be safe.
	    return false;
	  }
	}

	objectAssign = shouldUseNative() ? Object.assign : function (target, source) {
	  var from;
	  var to = toObject(target);
	  var symbols;

	  for (var s = 1; s < arguments.length; s++) {
	    from = Object(arguments[s]);

	    for (var key in from) {
	      if (hasOwnProperty.call(from, key)) {
	        to[key] = from[key];
	      }
	    }

	    if (getOwnPropertySymbols) {
	      symbols = getOwnPropertySymbols(from);

	      for (var i = 0; i < symbols.length; i++) {
	        if (propIsEnumerable.call(from, symbols[i])) {
	          to[symbols[i]] = from[symbols[i]];
	        }
	      }
	    }
	  }

	  return to;
	};
	return objectAssign;
}

/**
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var ReactPropTypesSecret_1;
var hasRequiredReactPropTypesSecret;

function requireReactPropTypesSecret () {
	if (hasRequiredReactPropTypesSecret) return ReactPropTypesSecret_1;
	hasRequiredReactPropTypesSecret = 1;

	var ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';
	ReactPropTypesSecret_1 = ReactPropTypesSecret;
	return ReactPropTypesSecret_1;
}

var has;
var hasRequiredHas;

function requireHas () {
	if (hasRequiredHas) return has;
	hasRequiredHas = 1;
	has = Function.call.bind(Object.prototype.hasOwnProperty);
	return has;
}

/**
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var checkPropTypes_1;
var hasRequiredCheckPropTypes;

function requireCheckPropTypes () {
	if (hasRequiredCheckPropTypes) return checkPropTypes_1;
	hasRequiredCheckPropTypes = 1;

	var printWarning = function () {};

	if (process.env.NODE_ENV !== 'production') {
	  var ReactPropTypesSecret = requireReactPropTypesSecret();

	  var loggedTypeFailures = {};

	  var has = requireHas();

	  printWarning = function (text) {
	    var message = 'Warning: ' + text;

	    if (typeof console !== 'undefined') {
	      console.error(message);
	    }

	    try {
	      // --- Welcome to debugging React ---
	      // This error was thrown as a convenience so that you can use this stack
	      // to find the callsite that caused this warning to fire.
	      throw new Error(message);
	    } catch (x) {
	      /**/
	    }
	  };
	}
	/**
	 * Assert that the values match with the type specs.
	 * Error messages are memorized and will only be shown once.
	 *
	 * @param {object} typeSpecs Map of name to a ReactPropType
	 * @param {object} values Runtime values that need to be type-checked
	 * @param {string} location e.g. "prop", "context", "child context"
	 * @param {string} componentName Name of the component for error messages.
	 * @param {?Function} getStack Returns the component stack.
	 * @private
	 */


	function checkPropTypes(typeSpecs, values, location, componentName, getStack) {
	  if (process.env.NODE_ENV !== 'production') {
	    for (var typeSpecName in typeSpecs) {
	      if (has(typeSpecs, typeSpecName)) {
	        var error; // Prop type validation may throw. In case they do, we don't want to
	        // fail the render phase where it didn't fail before. So we log it.
	        // After these have been cleaned up, we'll let them throw.

	        try {
	          // This is intentionally an invariant that gets caught. It's the same
	          // behavior as without this statement except with a better message.
	          if (typeof typeSpecs[typeSpecName] !== 'function') {
	            var err = Error((componentName || 'React class') + ': ' + location + ' type `' + typeSpecName + '` is invalid; ' + 'it must be a function, usually from the `prop-types` package, but received `' + typeof typeSpecs[typeSpecName] + '`.' + 'This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.');
	            err.name = 'Invariant Violation';
	            throw err;
	          }

	          error = typeSpecs[typeSpecName](values, typeSpecName, componentName, location, null, ReactPropTypesSecret);
	        } catch (ex) {
	          error = ex;
	        }

	        if (error && !(error instanceof Error)) {
	          printWarning((componentName || 'React class') + ': type specification of ' + location + ' `' + typeSpecName + '` is invalid; the type checker ' + 'function must return `null` or an `Error` but returned a ' + typeof error + '. ' + 'You may have forgotten to pass an argument to the type checker ' + 'creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and ' + 'shape all require an argument).');
	        }

	        if (error instanceof Error && !(error.message in loggedTypeFailures)) {
	          // Only monitor this failure once because there tends to be a lot of the
	          // same error.
	          loggedTypeFailures[error.message] = true;
	          var stack = getStack ? getStack() : '';
	          printWarning('Failed ' + location + ' type: ' + error.message + (stack != null ? stack : ''));
	        }
	      }
	    }
	  }
	}
	/**
	 * Resets warning cache when testing.
	 *
	 * @private
	 */


	checkPropTypes.resetWarningCache = function () {
	  if (process.env.NODE_ENV !== 'production') {
	    loggedTypeFailures = {};
	  }
	};

	checkPropTypes_1 = checkPropTypes;
	return checkPropTypes_1;
}

/**
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var factoryWithTypeCheckers;
var hasRequiredFactoryWithTypeCheckers;

function requireFactoryWithTypeCheckers () {
	if (hasRequiredFactoryWithTypeCheckers) return factoryWithTypeCheckers;
	hasRequiredFactoryWithTypeCheckers = 1;

	var ReactIs = requireReactIs();

	var assign = requireObjectAssign();

	var ReactPropTypesSecret = requireReactPropTypesSecret();

	var has = requireHas();

	var checkPropTypes = requireCheckPropTypes();

	var printWarning = function () {};

	if (process.env.NODE_ENV !== 'production') {
	  printWarning = function (text) {
	    var message = 'Warning: ' + text;

	    if (typeof console !== 'undefined') {
	      console.error(message);
	    }

	    try {
	      // --- Welcome to debugging React ---
	      // This error was thrown as a convenience so that you can use this stack
	      // to find the callsite that caused this warning to fire.
	      throw new Error(message);
	    } catch (x) {}
	  };
	}

	function emptyFunctionThatReturnsNull() {
	  return null;
	}

	factoryWithTypeCheckers = function (isValidElement, throwOnDirectAccess) {
	  /* global Symbol */
	  var ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;
	  var FAUX_ITERATOR_SYMBOL = '@@iterator'; // Before Symbol spec.

	  /**
	   * Returns the iterator method function contained on the iterable object.
	   *
	   * Be sure to invoke the function with the iterable as context:
	   *
	   *     var iteratorFn = getIteratorFn(myIterable);
	   *     if (iteratorFn) {
	   *       var iterator = iteratorFn.call(myIterable);
	   *       ...
	   *     }
	   *
	   * @param {?object} maybeIterable
	   * @return {?function}
	   */

	  function getIteratorFn(maybeIterable) {
	    var iteratorFn = maybeIterable && (ITERATOR_SYMBOL && maybeIterable[ITERATOR_SYMBOL] || maybeIterable[FAUX_ITERATOR_SYMBOL]);

	    if (typeof iteratorFn === 'function') {
	      return iteratorFn;
	    }
	  }
	  /**
	   * Collection of methods that allow declaration and validation of props that are
	   * supplied to React components. Example usage:
	   *
	   *   var Props = require('ReactPropTypes');
	   *   var MyArticle = React.createClass({
	   *     propTypes: {
	   *       // An optional string prop named "description".
	   *       description: Props.string,
	   *
	   *       // A required enum prop named "category".
	   *       category: Props.oneOf(['News','Photos']).isRequired,
	   *
	   *       // A prop named "dialog" that requires an instance of Dialog.
	   *       dialog: Props.instanceOf(Dialog).isRequired
	   *     },
	   *     render: function() { ... }
	   *   });
	   *
	   * A more formal specification of how these methods are used:
	   *
	   *   type := array|bool|func|object|number|string|oneOf([...])|instanceOf(...)
	   *   decl := ReactPropTypes.{type}(.isRequired)?
	   *
	   * Each and every declaration produces a function with the same signature. This
	   * allows the creation of custom validation functions. For example:
	   *
	   *  var MyLink = React.createClass({
	   *    propTypes: {
	   *      // An optional string or URI prop named "href".
	   *      href: function(props, propName, componentName) {
	   *        var propValue = props[propName];
	   *        if (propValue != null && typeof propValue !== 'string' &&
	   *            !(propValue instanceof URI)) {
	   *          return new Error(
	   *            'Expected a string or an URI for ' + propName + ' in ' +
	   *            componentName
	   *          );
	   *        }
	   *      }
	   *    },
	   *    render: function() {...}
	   *  });
	   *
	   * @internal
	   */


	  var ANONYMOUS = '<<anonymous>>'; // Important!
	  // Keep this list in sync with production version in `./factoryWithThrowingShims.js`.

	  var ReactPropTypes = {
	    array: createPrimitiveTypeChecker('array'),
	    bigint: createPrimitiveTypeChecker('bigint'),
	    bool: createPrimitiveTypeChecker('boolean'),
	    func: createPrimitiveTypeChecker('function'),
	    number: createPrimitiveTypeChecker('number'),
	    object: createPrimitiveTypeChecker('object'),
	    string: createPrimitiveTypeChecker('string'),
	    symbol: createPrimitiveTypeChecker('symbol'),
	    any: createAnyTypeChecker(),
	    arrayOf: createArrayOfTypeChecker,
	    element: createElementTypeChecker(),
	    elementType: createElementTypeTypeChecker(),
	    instanceOf: createInstanceTypeChecker,
	    node: createNodeChecker(),
	    objectOf: createObjectOfTypeChecker,
	    oneOf: createEnumTypeChecker,
	    oneOfType: createUnionTypeChecker,
	    shape: createShapeTypeChecker,
	    exact: createStrictShapeTypeChecker
	  };
	  /**
	   * inlined Object.is polyfill to avoid requiring consumers ship their own
	   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is
	   */

	  /*eslint-disable no-self-compare*/

	  function is(x, y) {
	    // SameValue algorithm
	    if (x === y) {
	      // Steps 1-5, 7-10
	      // Steps 6.b-6.e: +0 != -0
	      return x !== 0 || 1 / x === 1 / y;
	    } else {
	      // Step 6.a: NaN == NaN
	      return x !== x && y !== y;
	    }
	  }
	  /*eslint-enable no-self-compare*/

	  /**
	   * We use an Error-like object for backward compatibility as people may call
	   * PropTypes directly and inspect their output. However, we don't use real
	   * Errors anymore. We don't inspect their stack anyway, and creating them
	   * is prohibitively expensive if they are created too often, such as what
	   * happens in oneOfType() for any type before the one that matched.
	   */


	  function PropTypeError(message, data) {
	    this.message = message;
	    this.data = data && typeof data === 'object' ? data : {};
	    this.stack = '';
	  } // Make `instanceof Error` still work for returned errors.


	  PropTypeError.prototype = Error.prototype;

	  function createChainableTypeChecker(validate) {
	    if (process.env.NODE_ENV !== 'production') {
	      var manualPropTypeCallCache = {};
	      var manualPropTypeWarningCount = 0;
	    }

	    function checkType(isRequired, props, propName, componentName, location, propFullName, secret) {
	      componentName = componentName || ANONYMOUS;
	      propFullName = propFullName || propName;

	      if (secret !== ReactPropTypesSecret) {
	        if (throwOnDirectAccess) {
	          // New behavior only for users of `prop-types` package
	          var err = new Error('Calling PropTypes validators directly is not supported by the `prop-types` package. ' + 'Use `PropTypes.checkPropTypes()` to call them. ' + 'Read more at http://fb.me/use-check-prop-types');
	          err.name = 'Invariant Violation';
	          throw err;
	        } else if (process.env.NODE_ENV !== 'production' && typeof console !== 'undefined') {
	          // Old behavior for people using React.PropTypes
	          var cacheKey = componentName + ':' + propName;

	          if (!manualPropTypeCallCache[cacheKey] && // Avoid spamming the console because they are often not actionable except for lib authors
	          manualPropTypeWarningCount < 3) {
	            printWarning('You are manually calling a React.PropTypes validation ' + 'function for the `' + propFullName + '` prop on `' + componentName + '`. This is deprecated ' + 'and will throw in the standalone `prop-types` package. ' + 'You may be seeing this warning due to a third-party PropTypes ' + 'library. See https://fb.me/react-warning-dont-call-proptypes ' + 'for details.');
	            manualPropTypeCallCache[cacheKey] = true;
	            manualPropTypeWarningCount++;
	          }
	        }
	      }

	      if (props[propName] == null) {
	        if (isRequired) {
	          if (props[propName] === null) {
	            return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required ' + ('in `' + componentName + '`, but its value is `null`.'));
	          }

	          return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required in ' + ('`' + componentName + '`, but its value is `undefined`.'));
	        }

	        return null;
	      } else {
	        return validate(props, propName, componentName, location, propFullName);
	      }
	    }

	    var chainedCheckType = checkType.bind(null, false);
	    chainedCheckType.isRequired = checkType.bind(null, true);
	    return chainedCheckType;
	  }

	  function createPrimitiveTypeChecker(expectedType) {
	    function validate(props, propName, componentName, location, propFullName, secret) {
	      var propValue = props[propName];
	      var propType = getPropType(propValue);

	      if (propType !== expectedType) {
	        // `propValue` being instance of, say, date/regexp, pass the 'object'
	        // check, but we can offer a more precise error message here rather than
	        // 'of type `object`'.
	        var preciseType = getPreciseType(propValue);
	        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + preciseType + '` supplied to `' + componentName + '`, expected ') + ('`' + expectedType + '`.'), {
	          expectedType: expectedType
	        });
	      }

	      return null;
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function createAnyTypeChecker() {
	    return createChainableTypeChecker(emptyFunctionThatReturnsNull);
	  }

	  function createArrayOfTypeChecker(typeChecker) {
	    function validate(props, propName, componentName, location, propFullName) {
	      if (typeof typeChecker !== 'function') {
	        return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside arrayOf.');
	      }

	      var propValue = props[propName];

	      if (!Array.isArray(propValue)) {
	        var propType = getPropType(propValue);
	        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an array.'));
	      }

	      for (var i = 0; i < propValue.length; i++) {
	        var error = typeChecker(propValue, i, componentName, location, propFullName + '[' + i + ']', ReactPropTypesSecret);

	        if (error instanceof Error) {
	          return error;
	        }
	      }

	      return null;
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function createElementTypeChecker() {
	    function validate(props, propName, componentName, location, propFullName) {
	      var propValue = props[propName];

	      if (!isValidElement(propValue)) {
	        var propType = getPropType(propValue);
	        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected a single ReactElement.'));
	      }

	      return null;
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function createElementTypeTypeChecker() {
	    function validate(props, propName, componentName, location, propFullName) {
	      var propValue = props[propName];

	      if (!ReactIs.isValidElementType(propValue)) {
	        var propType = getPropType(propValue);
	        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected a single ReactElement type.'));
	      }

	      return null;
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function createInstanceTypeChecker(expectedClass) {
	    function validate(props, propName, componentName, location, propFullName) {
	      if (!(props[propName] instanceof expectedClass)) {
	        var expectedClassName = expectedClass.name || ANONYMOUS;
	        var actualClassName = getClassName(props[propName]);
	        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + actualClassName + '` supplied to `' + componentName + '`, expected ') + ('instance of `' + expectedClassName + '`.'));
	      }

	      return null;
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function createEnumTypeChecker(expectedValues) {
	    if (!Array.isArray(expectedValues)) {
	      if (process.env.NODE_ENV !== 'production') {
	        if (arguments.length > 1) {
	          printWarning('Invalid arguments supplied to oneOf, expected an array, got ' + arguments.length + ' arguments. ' + 'A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).');
	        } else {
	          printWarning('Invalid argument supplied to oneOf, expected an array.');
	        }
	      }

	      return emptyFunctionThatReturnsNull;
	    }

	    function validate(props, propName, componentName, location, propFullName) {
	      var propValue = props[propName];

	      for (var i = 0; i < expectedValues.length; i++) {
	        if (is(propValue, expectedValues[i])) {
	          return null;
	        }
	      }

	      var valuesString = JSON.stringify(expectedValues, function replacer(key, value) {
	        var type = getPreciseType(value);

	        if (type === 'symbol') {
	          return String(value);
	        }

	        return value;
	      });
	      return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of value `' + String(propValue) + '` ' + ('supplied to `' + componentName + '`, expected one of ' + valuesString + '.'));
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function createObjectOfTypeChecker(typeChecker) {
	    function validate(props, propName, componentName, location, propFullName) {
	      if (typeof typeChecker !== 'function') {
	        return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside objectOf.');
	      }

	      var propValue = props[propName];
	      var propType = getPropType(propValue);

	      if (propType !== 'object') {
	        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an object.'));
	      }

	      for (var key in propValue) {
	        if (has(propValue, key)) {
	          var error = typeChecker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);

	          if (error instanceof Error) {
	            return error;
	          }
	        }
	      }

	      return null;
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function createUnionTypeChecker(arrayOfTypeCheckers) {
	    if (!Array.isArray(arrayOfTypeCheckers)) {
	      process.env.NODE_ENV !== 'production' ? printWarning('Invalid argument supplied to oneOfType, expected an instance of array.') : void 0;
	      return emptyFunctionThatReturnsNull;
	    }

	    for (var i = 0; i < arrayOfTypeCheckers.length; i++) {
	      var checker = arrayOfTypeCheckers[i];

	      if (typeof checker !== 'function') {
	        printWarning('Invalid argument supplied to oneOfType. Expected an array of check functions, but ' + 'received ' + getPostfixForTypeWarning(checker) + ' at index ' + i + '.');
	        return emptyFunctionThatReturnsNull;
	      }
	    }

	    function validate(props, propName, componentName, location, propFullName) {
	      var expectedTypes = [];

	      for (var i = 0; i < arrayOfTypeCheckers.length; i++) {
	        var checker = arrayOfTypeCheckers[i];
	        var checkerResult = checker(props, propName, componentName, location, propFullName, ReactPropTypesSecret);

	        if (checkerResult == null) {
	          return null;
	        }

	        if (checkerResult.data && has(checkerResult.data, 'expectedType')) {
	          expectedTypes.push(checkerResult.data.expectedType);
	        }
	      }

	      var expectedTypesMessage = expectedTypes.length > 0 ? ', expected one of type [' + expectedTypes.join(', ') + ']' : '';
	      return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`' + expectedTypesMessage + '.'));
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function createNodeChecker() {
	    function validate(props, propName, componentName, location, propFullName) {
	      if (!isNode(props[propName])) {
	        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`, expected a ReactNode.'));
	      }

	      return null;
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function invalidValidatorError(componentName, location, propFullName, key, type) {
	    return new PropTypeError((componentName || 'React class') + ': ' + location + ' type `' + propFullName + '.' + key + '` is invalid; ' + 'it must be a function, usually from the `prop-types` package, but received `' + type + '`.');
	  }

	  function createShapeTypeChecker(shapeTypes) {
	    function validate(props, propName, componentName, location, propFullName) {
	      var propValue = props[propName];
	      var propType = getPropType(propValue);

	      if (propType !== 'object') {
	        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type `' + propType + '` ' + ('supplied to `' + componentName + '`, expected `object`.'));
	      }

	      for (var key in shapeTypes) {
	        var checker = shapeTypes[key];

	        if (typeof checker !== 'function') {
	          return invalidValidatorError(componentName, location, propFullName, key, getPreciseType(checker));
	        }

	        var error = checker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);

	        if (error) {
	          return error;
	        }
	      }

	      return null;
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function createStrictShapeTypeChecker(shapeTypes) {
	    function validate(props, propName, componentName, location, propFullName) {
	      var propValue = props[propName];
	      var propType = getPropType(propValue);

	      if (propType !== 'object') {
	        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type `' + propType + '` ' + ('supplied to `' + componentName + '`, expected `object`.'));
	      } // We need to check all keys in case some are required but missing from props.


	      var allKeys = assign({}, props[propName], shapeTypes);

	      for (var key in allKeys) {
	        var checker = shapeTypes[key];

	        if (has(shapeTypes, key) && typeof checker !== 'function') {
	          return invalidValidatorError(componentName, location, propFullName, key, getPreciseType(checker));
	        }

	        if (!checker) {
	          return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` key `' + key + '` supplied to `' + componentName + '`.' + '\nBad object: ' + JSON.stringify(props[propName], null, '  ') + '\nValid keys: ' + JSON.stringify(Object.keys(shapeTypes), null, '  '));
	        }

	        var error = checker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);

	        if (error) {
	          return error;
	        }
	      }

	      return null;
	    }

	    return createChainableTypeChecker(validate);
	  }

	  function isNode(propValue) {
	    switch (typeof propValue) {
	      case 'number':
	      case 'string':
	      case 'undefined':
	        return true;

	      case 'boolean':
	        return !propValue;

	      case 'object':
	        if (Array.isArray(propValue)) {
	          return propValue.every(isNode);
	        }

	        if (propValue === null || isValidElement(propValue)) {
	          return true;
	        }

	        var iteratorFn = getIteratorFn(propValue);

	        if (iteratorFn) {
	          var iterator = iteratorFn.call(propValue);
	          var step;

	          if (iteratorFn !== propValue.entries) {
	            while (!(step = iterator.next()).done) {
	              if (!isNode(step.value)) {
	                return false;
	              }
	            }
	          } else {
	            // Iterator will provide entry [k,v] tuples rather than values.
	            while (!(step = iterator.next()).done) {
	              var entry = step.value;

	              if (entry) {
	                if (!isNode(entry[1])) {
	                  return false;
	                }
	              }
	            }
	          }
	        } else {
	          return false;
	        }

	        return true;

	      default:
	        return false;
	    }
	  }

	  function isSymbol(propType, propValue) {
	    // Native Symbol.
	    if (propType === 'symbol') {
	      return true;
	    } // falsy value can't be a Symbol


	    if (!propValue) {
	      return false;
	    } // 19.4.3.5 Symbol.prototype[@@toStringTag] === 'Symbol'


	    if (propValue['@@toStringTag'] === 'Symbol') {
	      return true;
	    } // Fallback for non-spec compliant Symbols which are polyfilled.


	    if (typeof Symbol === 'function' && propValue instanceof Symbol) {
	      return true;
	    }

	    return false;
	  } // Equivalent of `typeof` but with special handling for array and regexp.


	  function getPropType(propValue) {
	    var propType = typeof propValue;

	    if (Array.isArray(propValue)) {
	      return 'array';
	    }

	    if (propValue instanceof RegExp) {
	      // Old webkits (at least until Android 4.0) return 'function' rather than
	      // 'object' for typeof a RegExp. We'll normalize this here so that /bla/
	      // passes PropTypes.object.
	      return 'object';
	    }

	    if (isSymbol(propType, propValue)) {
	      return 'symbol';
	    }

	    return propType;
	  } // This handles more types than `getPropType`. Only used for error messages.
	  // See `createPrimitiveTypeChecker`.


	  function getPreciseType(propValue) {
	    if (typeof propValue === 'undefined' || propValue === null) {
	      return '' + propValue;
	    }

	    var propType = getPropType(propValue);

	    if (propType === 'object') {
	      if (propValue instanceof Date) {
	        return 'date';
	      } else if (propValue instanceof RegExp) {
	        return 'regexp';
	      }
	    }

	    return propType;
	  } // Returns a string that is postfixed to a warning about an invalid type.
	  // For example, "undefined" or "of type array"


	  function getPostfixForTypeWarning(value) {
	    var type = getPreciseType(value);

	    switch (type) {
	      case 'array':
	      case 'object':
	        return 'an ' + type;

	      case 'boolean':
	      case 'date':
	      case 'regexp':
	        return 'a ' + type;

	      default:
	        return type;
	    }
	  } // Returns class name of the object, if any.


	  function getClassName(propValue) {
	    if (!propValue.constructor || !propValue.constructor.name) {
	      return ANONYMOUS;
	    }

	    return propValue.constructor.name;
	  }

	  ReactPropTypes.checkPropTypes = checkPropTypes;
	  ReactPropTypes.resetWarningCache = checkPropTypes.resetWarningCache;
	  ReactPropTypes.PropTypes = ReactPropTypes;
	  return ReactPropTypes;
	};
	return factoryWithTypeCheckers;
}

/**
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var factoryWithThrowingShims;
var hasRequiredFactoryWithThrowingShims;

function requireFactoryWithThrowingShims () {
	if (hasRequiredFactoryWithThrowingShims) return factoryWithThrowingShims;
	hasRequiredFactoryWithThrowingShims = 1;

	var ReactPropTypesSecret = requireReactPropTypesSecret();

	function emptyFunction() {}

	function emptyFunctionWithReset() {}

	emptyFunctionWithReset.resetWarningCache = emptyFunction;

	factoryWithThrowingShims = function () {
	  function shim(props, propName, componentName, location, propFullName, secret) {
	    if (secret === ReactPropTypesSecret) {
	      // It is still safe when called from React.
	      return;
	    }

	    var err = new Error('Calling PropTypes validators directly is not supported by the `prop-types` package. ' + 'Use PropTypes.checkPropTypes() to call them. ' + 'Read more at http://fb.me/use-check-prop-types');
	    err.name = 'Invariant Violation';
	    throw err;
	  }
	  shim.isRequired = shim;

	  function getShim() {
	    return shim;
	  }
	  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.

	  var ReactPropTypes = {
	    array: shim,
	    bigint: shim,
	    bool: shim,
	    func: shim,
	    number: shim,
	    object: shim,
	    string: shim,
	    symbol: shim,
	    any: shim,
	    arrayOf: getShim,
	    element: shim,
	    elementType: shim,
	    instanceOf: getShim,
	    node: shim,
	    objectOf: getShim,
	    oneOf: getShim,
	    oneOfType: getShim,
	    shape: getShim,
	    exact: getShim,
	    checkPropTypes: emptyFunctionWithReset,
	    resetWarningCache: emptyFunction
	  };
	  ReactPropTypes.PropTypes = ReactPropTypes;
	  return ReactPropTypes;
	};
	return factoryWithThrowingShims;
}

/**
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

if (process.env.NODE_ENV !== 'production') {
  var ReactIs = requireReactIs(); // By explicitly using `prop-types` you are opting into new development behavior.
  // http://fb.me/prop-types-in-prod


  var throwOnDirectAccess = true;
  propTypes.exports = requireFactoryWithTypeCheckers()(ReactIs.isElement, throwOnDirectAccess);
} else {
  // By explicitly using `prop-types` you are opting into new production behavior.
  // http://fb.me/prop-types-in-prod
  propTypes.exports = requireFactoryWithThrowingShims()();
}

const Typography = {
  H_1: 'H_1',
  H_2: 'H_2',
  SUBTITLE_1: 'SUBTITLE_1',
  SUBTITLE_2: 'SUBTITLE_2',
  BODY_1: 'BODY_1',
  BODY_2: 'BODY_2',
  BUTTON_1: 'BUTTON_1',
  BUTTON_2: 'BUTTON_2',
  CAPTION_1: 'CAPTION_1',
  CAPTION_2: 'CAPTION_2',
  CAPTION_3: 'CAPTION_3'
};
const Colors$2 = {
  ONBACKGROUND_1: 'ONBACKGROUND_1',
  ONBACKGROUND_2: 'ONBACKGROUND_2',
  ONBACKGROUND_3: 'ONBACKGROUND_3',
  ONBACKGROUND_4: 'ONBACKGROUND_4',
  ONCONTENT_1: 'ONCONTENT_1',
  ONCONTENT_2: 'ONCONTENT_2',
  PRIMARY: 'PRIMARY',
  ERROR: 'ERROR',
  SECONDARY_3: 'SECONDARY_3'
};

function changeTypographyToClassName(type) {
  switch (type) {
    case Typography.H_1:
      return 'sendbird-label--h-1';

    case Typography.H_2:
      return 'sendbird-label--h-2';

    case Typography.SUBTITLE_1:
      return 'sendbird-label--subtitle-1';

    case Typography.SUBTITLE_2:
      return 'sendbird-label--subtitle-2';

    case Typography.BODY_1:
      return 'sendbird-label--body-1';

    case Typography.BODY_2:
      return 'sendbird-label--body-2';

    case Typography.BUTTON_1:
      return 'sendbird-label--button-1';

    case Typography.BUTTON_2:
      return 'sendbird-label--button-2';

    case Typography.CAPTION_1:
      return 'sendbird-label--caption-1';

    case Typography.CAPTION_2:
      return 'sendbird-label--caption-2';

    case Typography.CAPTION_3:
      return 'sendbird-label--caption-3';

    default:
      return '';
  }
}

function changeColorToClassName$2(color) {
  switch (color) {
    case Colors$2.ONBACKGROUND_1:
      return 'sendbird-label--color-onbackground-1';

    case Colors$2.ONBACKGROUND_2:
      return 'sendbird-label--color-onbackground-2';

    case Colors$2.ONBACKGROUND_3:
      return 'sendbird-label--color-onbackground-3';

    case Colors$2.ONBACKGROUND_4:
      return 'sendbird-label--color-onbackground-4';

    case Colors$2.ONCONTENT_1:
      return 'sendbird-label--color-oncontent-1';

    case Colors$2.ONCONTENT_2:
      return 'sendbird-label--color-oncontent-2';

    case Colors$2.PRIMARY:
      return 'sendbird-label--color-primary';
    // should be Primary-3 fix me

    case Colors$2.ERROR:
      return 'sendbird-label--color-error';

    case Colors$2.SECONDARY_3:
      return 'sendbird-label--color-secondary-3';

    default:
      return '';
  }
}

function Label(_ref) {
  let {
    className,
    type,
    color,
    children
  } = _ref;
  return (
    /*#__PURE__*/
    // Donot make this into div
    // Mention uses Label. If we use div, it would break the mention detection on Paste
    // https://github.com/sendbird/sendbird-uikit-react/pull/479
    React__default__default.createElement("span", {
      className: [...(Array.isArray(className) ? className : [className]), 'sendbird-label', type ? changeTypographyToClassName(type) : '', color ? changeColorToClassName$2(color) : ''].join(' ')
    }, children)
  );
}

Label.propTypes = {
  className: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.arrayOf(propTypes.exports.string)]),
  type: propTypes.exports.string,
  color: propTypes.exports.string,
  children: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.number, propTypes.exports.element, propTypes.exports.any])
};
Label.defaultProps = {
  className: [],
  type: '',
  color: '',
  children: null
};
const LabelTypography = Typography;
const LabelColors = Colors$2;

let ButtonTypes$1 = /*#__PURE__*/function (ButtonTypes) {
  ButtonTypes["PRIMARY"] = "PRIMARY";
  ButtonTypes["SECONDARY"] = "SECONDARY";
  ButtonTypes["DANGER"] = "DANGER";
  ButtonTypes["DISABLED"] = "DISABLED";
  return ButtonTypes;
}({});

let ButtonSizes$1 = /*#__PURE__*/function (ButtonSizes) {
  ButtonSizes["BIG"] = "BIG";
  ButtonSizes["SMALL"] = "SMALL";
  return ButtonSizes;
}({});

function changeTypeToClassName(type) {
  switch (type) {
    case ButtonTypes$1.PRIMARY:
      return 'sendbird-button--primary';

    case ButtonTypes$1.SECONDARY:
      return 'sendbird-button--secondary';

    case ButtonTypes$1.DANGER:
      return 'sendbird-button--danger';

    case ButtonTypes$1.DISABLED:
      return 'sendbird-button--disabled';

    default:
      return null;
  }
}

function changeSizeToClassName(size) {
  switch (size) {
    case ButtonSizes$1.BIG:
      return 'sendbird-button--big';

    case ButtonSizes$1.SMALL:
      return 'sendbird-button--small';

    default:
      return null;
  }
}

const ButtonTypes = ButtonTypes$1;
const ButtonSizes = ButtonSizes$1;

function Button(_ref) {
  let {
    className,
    type = ButtonTypes.PRIMARY,
    size = ButtonSizes.BIG,
    children = 'Button',
    disabled = false,
    onClick = () => {
      /* noop */
    }
  } = _ref;
  const injectingClassNames = [...(Array.isArray(className) ? className : [className]), 'sendbird-button', disabled ? 'sendbird-button__disabled' : '', changeTypeToClassName(type), changeSizeToClassName(size)].join(' ');
  return /*#__PURE__*/React__default__default.createElement("button", {
    className: injectingClassNames,
    type: "button",
    onClick: onClick,
    disabled: disabled
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-button__text",
    type: LabelTypography.BUTTON_1,
    color: LabelColors.ONCONTENT_1
  }, children));
}

/* eslint-disable no-redeclare */

const Types$1 = {
  ADD: 'ADD',
  ARROW_LEFT: 'ARROW_LEFT',
  ATTACH: 'ATTACH',
  AUDIO_ON_LINED: 'AUDIO_ON_LINED',
  BAN: 'BAN',
  BROADCAST: 'BROADCAST',
  CAMERA: 'CAMERA',
  CHANNELS: 'CHANNELS',
  CHAT: 'CHAT',
  CHAT_FILLED: 'CHAT_FILLED',
  CHEVRON_DOWN: 'CHEVRON_DOWN',
  CHEVRON_RIGHT: 'CHEVRON_RIGHT',
  CLOSE: 'CLOSE',
  COLLAPSE: 'COLLAPSE',
  COPY: 'COPY',
  CREATE: 'CREATE',
  DELETE: 'DELETE',
  DISCONNECTED: 'DISCONNECTED',
  DOCUMENT: 'DOCUMENT',
  DONE: 'DONE',
  DONE_ALL: 'DONE_ALL',
  DOWNLOAD: 'DOWNLOAD',
  EDIT: 'EDIT',
  EMOJI_MORE: 'EMOJI_MORE',
  ERROR: 'ERROR',
  EXPAND: 'EXPAND',
  FILE_AUDIO: 'FILE_AUDIO',
  FILE_DOCUMENT: 'FILE_DOCUMENT',
  FREEZE: 'FREEZE',
  GIF: 'GIF',
  INFO: 'INFO',
  LEAVE: 'LEAVE',
  MEMBERS: 'MEMBERS',
  MESSAGE: 'MESSAGE',
  MODERATIONS: 'MODERATIONS',
  MORE: 'MORE',
  MUTE: 'MUTE',
  NOTIFICATIONS: 'NOTIFICATIONS',
  NOTIFICATIONS_OFF_FILLED: 'NOTIFICATIONS_OFF_FILLED',
  OPERATOR: 'OPERATOR',
  PHOTO: 'PHOTO',
  PLAY: 'PLAY',
  PLUS: 'PLUS',
  QUESTION: 'QUESTION',
  REFRESH: 'REFRESH',
  REPLY: 'REPLY',
  REMOVE: 'REMOVE',
  SEARCH: 'SEARCH',
  SEND: 'SEND',
  SETTINGS_FILLED: 'SETTINGS_FILLED',
  SPINNER: 'SPINNER',
  SUPERGROUP: 'SUPERGROUP',
  THREAD: 'THREAD',
  THUMBNAIL_NONE: 'THUMBNAIL_NONE',
  TOGGLE_OFF: 'TOGGLE_OFF',
  TOGGLE_ON: 'TOGGLE_ON',
  USER: 'USER'
};
/* eslint-disable no-redeclare */

const Colors$1 = {
  DEFAULT: 'DEFAULT',
  PRIMARY: 'PRIMARY',
  PRIMARY_2: 'PRIMARY_2',
  SECONDARY: 'SECONDARY',
  CONTENT: 'CONTENT',
  CONTENT_INVERSE: 'CONTENT_INVERSE',
  WHITE: 'WHITE',
  GRAY: 'GRAY',
  SENT: 'SENT',
  READ: 'READ',
  ON_BACKGROUND_1: 'ON_BACKGROUND_1',
  ON_BACKGROUND_2: 'ON_BACKGROUND_2',
  ON_BACKGROUND_3: 'ON_BACKGROUND_3',
  ON_BACKGROUND_4: 'ON_BACKGROUND_4',
  BACKGROUND_3: 'BACKGROUND_3',
  ERROR: 'ERROR'
};

function changeColorToClassName$1(color) {
  switch (color) {
    case Colors$1.PRIMARY:
      return 'sendbird-icon-color--primary';

    case Colors$1.PRIMARY_2:
      return 'sendbird-icon-color--primary-2';

    case Colors$1.SECONDARY:
      return 'sendbird-icon-color--secondary';

    case Colors$1.CONTENT:
      return 'sendbird-icon-color--content';

    case Colors$1.CONTENT_INVERSE:
      return 'sendbird-icon-color--content-inverse';

    case Colors$1.WHITE:
      return 'sendbird-icon-color--white';

    case Colors$1.GRAY:
      return 'sendbird-icon-color--gray';

    case Colors$1.SENT:
      return 'sendbird-icon-color--sent';

    case Colors$1.READ:
      return 'sendbird-icon-color--read';

    case Colors$1.ON_BACKGROUND_1:
      return 'sendbird-icon-color--on-background-1';

    case Colors$1.ON_BACKGROUND_2:
      return 'sendbird-icon-color--on-background-2';

    case Colors$1.ON_BACKGROUND_3:
      return 'sendbird-icon-color--on-background-3';

    case Colors$1.ON_BACKGROUND_4:
      return 'sendbird-icon-color--on-background-4';

    case Colors$1.BACKGROUND_3:
      return 'sendbird-icon-color--background-3';

    case Colors$1.ERROR:
      return 'sendbird-icon-color--error';

    default:
      return '';
  }
}

function changeTypeToIconClassName(type) {
  switch (type) {
    case Types$1.ADD:
      return 'sendbird-icon-add';

    case Types$1.ARROW_LEFT:
      return 'sendbird-icon-arrow-left';

    case Types$1.ATTACH:
      return 'sendbird-icon-attach';

    case Types$1.AUDIO_ON_LINED:
      return 'sendbird-icon-audio-on-lined';

    case Types$1.BAN:
      return 'sendbird-icon-ban';

    case Types$1.BROADCAST:
      return 'sendbird-icon-broadcast';

    case Types$1.CAMERA:
      return 'sendbird-icon-camera';

    case Types$1.CHANNELS:
      return 'sendbird-icon-channels';

    case Types$1.CHAT:
      return 'sendbird-icon-chat';

    case Types$1.CHAT_FILLED:
      return 'sendbird-icon-chat-filled';

    case Types$1.CHEVRON_DOWN:
      return 'sendbird-icon-chevron-down';

    case Types$1.CHEVRON_RIGHT:
      return 'sendbird-icon-chevron-right';

    case Types$1.CLOSE:
      return 'sendbird-icon-close';

    case Types$1.COLLAPSE:
      return 'sendbird-icon-collapse';

    case Types$1.COPY:
      return 'sendbird-icon-copy';

    case Types$1.CREATE:
      return 'sendbird-icon-create';

    case Types$1.DELETE:
      return 'sendbird-icon-delete';

    case Types$1.DISCONNECTED:
      return 'sendbird-icon-disconnected';

    case Types$1.DOCUMENT:
      return 'sendbird-icon-document';

    case Types$1.DONE:
      return 'sendbird-icon-done';

    case Types$1.DONE_ALL:
      return 'sendbird-icon-done-all';

    case Types$1.DOWNLOAD:
      return 'sendbird-icon-down-load';

    case Types$1.EDIT:
      return 'sendbird-icon-edit';

    case Types$1.EMOJI_MORE:
      return 'sendbird-icon-emoji-more';

    case Types$1.ERROR:
      return 'sendbird-icon-error';

    case Types$1.EXPAND:
      return 'sendbird-icon-expand';

    case Types$1.FILE_AUDIO:
      return 'sendbird-icon-file-audio';

    case Types$1.FILE_DOCUMENT:
      return 'sendbird-icon-file-document';

    case Types$1.FREEZE:
      return 'sendbird-icon-freeze';

    case Types$1.GIF:
      return 'sendbird-icon-gif';

    case Types$1.INFO:
      return 'sendbird-icon-info';

    case Types$1.LEAVE:
      return 'sendbird-icon-leave';

    case Types$1.MEMBERS:
      return 'sendbird-icon-members';

    case Types$1.MESSAGE:
      return 'sendbird-icon-message';

    case Types$1.MODERATIONS:
      return 'sendbird-icon-moderations';

    case Types$1.MORE:
      return 'sendbird-icon-more';

    case Types$1.MUTE:
      return 'sendbird-icon-mute';

    case Types$1.NOTIFICATIONS:
      return 'sendbird-icon-notifications';

    case Types$1.NOTIFICATIONS_OFF_FILLED:
      return 'sendbird-icon-notifications-off-filled';

    case Types$1.OPERATOR:
      return 'sendbird-icon-operator';

    case Types$1.PHOTO:
      return 'sendbird-icon-photo';

    case Types$1.PLAY:
      return 'sendbird-icon-play';

    case Types$1.PLUS:
      return 'sendbird-iconn-plus';

    case Types$1.QUESTION:
      return 'sendbird-icon-question';

    case Types$1.REFRESH:
      return 'sendbird-icon-refresh';

    case Types$1.REMOVE:
      return 'sendbird-icon-remove';

    case Types$1.REPLY:
      return 'sendbird-icon-reply';

    case Types$1.SEARCH:
      return 'sendbird-icon-search';

    case Types$1.SEND:
      return 'sendbird-icon-send';

    case Types$1.SETTINGS_FILLED:
      return 'sendbird-icon-settings-filled';

    case Types$1.SPINNER:
      return 'sendbird-icon-spinner';

    case Types$1.SUPERGROUP:
      return 'sendbird-icon-supergroup';

    case Types$1.THREAD:
      return 'sendbird-icon-thread';

    case Types$1.THUMBNAIL_NONE:
      return 'sendbird-icon-thumbnail-none';

    case Types$1.TOGGLE_OFF:
      return 'sendbird-icon-toggle-off';

    case Types$1.TOGGLE_ON:
      return 'sendbird-icon-toggle-on';

    case Types$1.USER:
      return 'sendbird-icon-user';

    default:
      return 'sendbird-icon-unknown';
    // If you see this text 'icon' replace icon for it
  }
}

var _path$R;

function _extends$U() {
  _extends$U = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$U.apply(this, arguments);
}

function SvgIconAdd(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$U({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$R || (_path$R = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-add_svg__fill",
    d: "M50.667 5.333a8 8 0 018 8v37.334a8 8 0 01-8 8H13.333a8 8 0 01-8-8V13.333a8 8 0 018-8zm0 5.334H13.333a2.667 2.667 0 00-2.666 2.666v37.334a2.667 2.667 0 002.666 2.666h37.334a2.667 2.667 0 002.666-2.666V13.333a2.667 2.667 0 00-2.666-2.666zm-18.667 8a2.667 2.667 0 012.649 2.355l.018.311v8h8a2.667 2.667 0 01.311 5.316l-.311.018h-8v8a2.667 2.667 0 01-5.316.311l-.018-.311v-8h-8a2.667 2.667 0 01-.311-5.316l.311-.018h8v-8A2.667 2.667 0 0132 18.667z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$Q;

function _extends$T() {
  _extends$T = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$T.apply(this, arguments);
}

function SvgIconArrowLeft(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$T({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$Q || (_path$Q = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-arrow-left_svg__fill",
    d: "M33.886 8.781a2.668 2.668 0 01.221 3.52l-.221.251-16.78 16.781H56a2.667 2.667 0 01.311 5.316l-.311.018-38.895-.001 16.78 16.782a2.666 2.666 0 01.222 3.52l-.221.251a2.668 2.668 0 01-3.52.222l-.252-.222L8.781 33.886a2.668 2.668 0 01-.222-3.52l.222-.252L30.114 8.781a2.668 2.668 0 013.772 0z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$P;

function _extends$S() {
  _extends$S = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$S.apply(this, arguments);
}

function SvgIconAttach(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$S({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$P || (_path$P = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-attach_svg__fill",
    d: "M55.334 28.926l-24.506 23.34c-5.222 4.973-13.74 4.973-18.962 0-5.149-4.903-5.149-12.797 0-17.7l24.506-23.34c3.138-2.988 8.278-2.988 11.416 0 3.064 2.919 3.064 7.594 0 10.513L23.255 45.077c-1.055 1.005-2.815 1.005-3.87.001-.98-.933-.98-2.39 0-3.325l22.64-21.535a2.667 2.667 0 00-3.676-3.864L15.709 37.89a7.578 7.578 0 00-.001 11.05c3.113 2.966 8.11 2.966 11.224 0l24.533-23.338c5.272-5.021 5.272-13.217 0-18.238-5.197-4.95-13.573-4.95-18.77 0L8.187 30.704c-7.356 7.005-7.356 18.419 0 25.424 7.281 6.935 19.036 6.935 26.318 0l24.506-23.34a2.666 2.666 0 10-3.678-3.862z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _g$2$1, _defs$7;

function _extends$R() {
  _extends$R = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$R.apply(this, arguments);
}

function SvgIconAudioOnLined(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$R({
    viewBox: "0 0 64 64",
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _g$2$1 || (_g$2$1 = /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icon-audio-on-lined_svg__clip0_1_7)"
  }, /*#__PURE__*/React__default.createElement("path", {
    className: "icon-audio-on-lined_svg__fill",
    clipRule: "evenodd",
    d: "M32 0C26.11 0 21.333 4.776 21.333 10.667V32c0 5.891 4.776 10.667 10.667 10.667S42.667 37.89 42.667 32V10.667C42.667 4.776 37.89 0 32 0zm-5.333 10.667a5.333 5.333 0 0110.666 0V32a5.333 5.333 0 01-10.666 0V10.667z"
  }), /*#__PURE__*/React__default.createElement("path", {
    className: "icon-audio-on-lined_svg__fill",
    d: "M16 26.667a2.667 2.667 0 10-5.333 0V32c0 10.879 8.143 19.856 18.666 21.168v5.499h-8a2.667 2.667 0 000 5.333h21.334a2.667 2.667 0 100-5.333h-8v-5.499C45.19 51.856 53.333 42.88 53.333 32v-5.333a2.667 2.667 0 10-5.333 0V32c0 8.837-7.163 16-16 16s-16-7.163-16-16v-5.333z"
  }))), _defs$7 || (_defs$7 = /*#__PURE__*/React__default.createElement("defs", null, /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icon-audio-on-lined_svg__clip0_1_7"
  }, /*#__PURE__*/React__default.createElement("path", {
    fill: "#fff",
    d: "M0 0h64v64H0z"
  })))));
}

var _path$O;

function _extends$Q() {
  _extends$Q = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$Q.apply(this, arguments);
}

function SvgIconBan(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$Q({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$O || (_path$O = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-ban_svg__fill",
    d: "M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667zM32 8C18.745 8 8 18.745 8 32s10.745 24 24 24 24-10.745 24-24S45.255 8 32 8zm12.333 21.333a1 1 0 011 1v3.334a1 1 0 01-1 1H19.667a1 1 0 01-1-1v-3.334a1 1 0 011-1h24.666z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$N;

function _extends$P() {
  _extends$P = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$P.apply(this, arguments);
}

function SvgIconBroadcast(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$P({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$N || (_path$N = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-broadcast_svg__fill",
    d: "M58.545 5.498c.08.258.122.526.122.796v46.079a2.666 2.666 0 01-3.462 2.546l-17.951-5.61c-.645 5.273-5.14 9.358-10.587 9.358C20.776 58.667 16 53.89 16 48v-5.334h-5.333a8 8 0 01-7.997-7.75l-.003-.25V24a8 8 0 018-8H16L55.205 3.749a2.665 2.665 0 013.34 1.75zM21.333 44.587V48a5.333 5.333 0 0010.652.398L32 47.92l-10.667-3.333zm32-34.667l-32 9.997v18.83l32 9.997V9.92zM16 21.333h-5.333a2.67 2.67 0 00-2.65 2.356L8 24v10.667a2.667 2.667 0 002.667 2.666H16v-16z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$M;

function _extends$O() {
  _extends$O = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$O.apply(this, arguments);
}

function SvgIconCamera(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$O({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$M || (_path$M = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-camera_svg__fill",
    d: "M40 5.333c.892 0 1.724.446 2.219 1.188l4.541 6.812H56a8 8 0 017.986 7.53l.014.47v29.334a8 8 0 01-8 8H8a8 8 0 01-8-8V21.333a8 8 0 018-8h9.237l4.544-6.812a2.665 2.665 0 011.888-1.167l.331-.02zm-1.43 5.334H25.428l-4.542 6.812a2.66 2.66 0 01-1.887 1.167l-.331.02H8a2.668 2.668 0 00-2.667 2.667v29.334A2.667 2.667 0 008 53.333h48a2.667 2.667 0 002.667-2.666V21.333A2.667 2.667 0 0056 18.667H45.333a2.665 2.665 0 01-2.218-1.188l-4.544-6.812zM32 21.333c7.364 0 13.333 5.97 13.333 13.334C45.333 42.03 39.363 48 32 48c-7.364 0-13.333-5.97-13.333-13.333 0-7.364 5.97-13.334 13.333-13.334zm0 5.334a8 8 0 100 16 8 8 0 000-16z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$L;

function _extends$N() {
  _extends$N = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$N.apply(this, arguments);
}

function SvgIconChannels(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$N({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$L || (_path$L = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-channels_svg__fill",
    d: "M42.65 5.333l.311.017a2.666 2.666 0 012.373 2.633l-.017.311-1.45 13.04h9.466a2.667 2.667 0 01.311 5.315l-.31.018H43.271l-1.184 10.666h11.245a2.667 2.667 0 01.312 5.316l-.31.018H41.495l-1.512 13.627a2.667 2.667 0 01-5.318-.277l.017-.311 1.448-13.04H25.496l-1.512 13.628a2.667 2.667 0 01-5.318-.277l.017-.311 1.448-13.04h-9.464a2.667 2.667 0 01-.311-5.315l.31-.018h10.057l1.186-10.667H10.667a2.667 2.667 0 01-.311-5.315l.31-.018h11.835l1.515-13.627a2.668 2.668 0 012.634-2.373l.311.017a2.666 2.666 0 012.373 2.633l-.017.311-1.45 13.04H38.5l1.515-13.628a2.668 2.668 0 012.634-2.373zm-5.927 32l1.186-10.667H27.272l-1.184 10.667h10.635z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$K;

function _extends$M() {
  _extends$M = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$M.apply(this, arguments);
}

function SvgIconChat(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$M({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$K || (_path$K = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-chat_svg__fill",
    d: "M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58c-5.965 1.912-10.133 2.572-12.504 1.981-2.799-.698-3.351-1.919-1.657-3.663 1.171-1.396 2.147-3.14 2.928-5.234.622-1.668.377-4.001-.737-7A29.15 29.15 0 012.666 32C2.667 15.8 15.8 2.667 32 2.667zM32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62.067 62.067 0 004.886-1.363l1.721-.568 2.04-.696 1.95.917A23.882 23.882 0 0032 56c13.255 0 24-10.745 24-24S45.255 8 32 8z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$J;

function _extends$L() {
  _extends$L = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$L.apply(this, arguments);
}

function SvgIconChatFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$L({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$J || (_path$J = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-chat-filled_svg__fill",
    d: "M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58c-5.965 1.912-10.133 2.572-12.504 1.981-2.799-.698-3.351-1.919-1.657-3.663 1.171-1.396 2.147-3.14 2.928-5.234.622-1.668.377-4.001-.737-7A29.15 29.15 0 012.666 32C2.667 15.8 15.8 2.667 32 2.667z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$I;

function _extends$K() {
  _extends$K = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$K.apply(this, arguments);
}

function SvgIconChevronDown(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$K({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$I || (_path$I = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-chevron-down_svg__fill",
    d: "M16.121 21.879a2.998 2.998 0 00-4.242 0 2.998 2.998 0 000 4.242l18 18a2.998 2.998 0 004.242 0l18-18a2.998 2.998 0 000-4.242 2.998 2.998 0 00-4.242 0L32 37.757 16.121 21.88z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$H;

function _extends$J() {
  _extends$J = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$J.apply(this, arguments);
}

function SvgIconChevronRight(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$J({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$H || (_path$H = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-chevron-right_svg__fill",
    d: "M22.114 46.114a2.668 2.668 0 003.772 3.772l16-16a2.668 2.668 0 000-3.772l-16-16a2.668 2.668 0 00-3.772 3.772L36.23 32 22.114 46.114z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$G;

function _extends$I() {
  _extends$I = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$I.apply(this, arguments);
}

function SvgIconClose(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$I({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$G || (_path$G = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-close_svg__fill",
    d: "M52.552 11.448a2.666 2.666 0 01.222 3.52l-.222.251-16.781 16.78 16.781 16.782a2.665 2.665 0 010 3.771 2.666 2.666 0 01-3.52.222l-.251-.222L32 35.771 15.219 52.552a2.665 2.665 0 01-3.771 0 2.666 2.666 0 01-.222-3.52l.222-.251L28.228 32l-16.78-16.781a2.665 2.665 0 010-3.771 2.666 2.666 0 013.52-.222l.251.222 16.78 16.78 16.782-16.78a2.665 2.665 0 013.771 0z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$F;

function _extends$H() {
  _extends$H = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$H.apply(this, arguments);
}

function SvgIconCollapse(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$H({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$F || (_path$F = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-collapse_svg__fill",
    d: "M16 8a2.667 2.667 0 00-2.649 2.356l-.018.31v42.667a2.667 2.667 0 005.316.311l.018-.31V34.666h25.56l-6.113 6.114a2.668 2.668 0 00-.221 3.52l.221.251a2.666 2.666 0 003.52.222l.252-.222 10.666-10.666a2.666 2.666 0 00.222-3.52l-.222-.252-10.666-10.666a2.666 2.666 0 00-3.993 3.52l.221.251 6.113 6.114h-25.56V10.667A2.667 2.667 0 0016 8z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$E;

function _extends$G() {
  _extends$G = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$G.apply(this, arguments);
}

function SvgIconCopy(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$G({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$E || (_path$E = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-copy_svg__fill",
    d: "M53.333 21.333a8 8 0 018 8v24a8 8 0 01-8 8h-24a8 8 0 01-8-8v-24a8 8 0 018-8zm0 5.334h-24a2.667 2.667 0 00-2.666 2.666v24A2.667 2.667 0 0029.333 56h24A2.667 2.667 0 0056 53.333v-24a2.667 2.667 0 00-2.667-2.666zm-18.666-24a8 8 0 017.986 7.53l.014.47v2.666a2.667 2.667 0 01-5.316.311l-.018-.31v-2.667a2.67 2.67 0 00-2.355-2.65L34.667 8h-24a2.67 2.67 0 00-2.65 2.356l-.017.31v24a2.67 2.67 0 002.356 2.65l.31.017h2.667a2.667 2.667 0 01.311 5.316l-.31.018h-2.667a8.001 8.001 0 01-7.987-7.53l-.013-.47v-24c0-4.26 3.33-7.743 7.53-7.987l.47-.013h24z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$D;

function _extends$F() {
  _extends$F = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$F.apply(this, arguments);
}

function SvgIconCreate(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$F({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$D || (_path$D = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-create_svg__fill",
    d: "M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58c-5.965 1.912-10.133 2.572-12.504 1.981-2.799-.698-3.351-1.919-1.657-3.663 1.171-1.396 2.147-3.14 2.928-5.234.622-1.668.377-4.001-.737-7A29.15 29.15 0 012.666 32C2.667 15.8 15.8 2.667 32 2.667zM32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62.067 62.067 0 004.886-1.363l1.721-.568 2.04-.696 1.95.917A23.882 23.882 0 0032 56c13.255 0 24-10.745 24-24S45.255 8 32 8zm2.667 16v5.333H40c3.556 0 3.556 5.334 0 5.334h-5.333V40c0 3.556-5.334 3.556-5.334 0v-5.333H24c-3.556 0-3.556-5.334 0-5.334h5.333V24c0-3.556 5.334-3.556 5.334 0z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$C;

function _extends$E() {
  _extends$E = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$E.apply(this, arguments);
}

function SvgIconDelete(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$E({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$C || (_path$C = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-delete_svg__fill",
    d: "M37.333 2.667c4.26 0 7.743 3.33 7.987 7.53l.013.47v2.666H56a2.667 2.667 0 01.311 5.316l-.311.018h-2.668l.001 34.666c0 4.26-3.33 7.743-7.53 7.987l-.47.013H18.667a8.001 8.001 0 01-7.987-7.53l-.013-.47V18.667H8a2.667 2.667 0 01-.311-5.316L8 13.333h10.666v-2.666a8.002 8.002 0 017.53-7.987l.47-.013h10.667zm10.666 16H16v34.666a2.67 2.67 0 002.356 2.65l.31.017h26.667a2.67 2.67 0 002.65-2.356l.017-.31V18.666zm-21.332 8a2.667 2.667 0 012.648 2.355l.018.311v16a2.667 2.667 0 01-5.316.311l-.017-.31v-16a2.667 2.667 0 012.667-2.667zm10.666 0a2.67 2.67 0 012.65 2.355l.017.311v16a2.667 2.667 0 01-5.315.311l-.018-.31v-16a2.667 2.667 0 012.666-2.667zm0-18.667H26.667a2.67 2.67 0 00-2.65 2.356l-.017.31v2.667h16v-2.666a2.67 2.67 0 00-2.356-2.65L37.334 8z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$B;

function _extends$D() {
  _extends$D = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$D.apply(this, arguments);
}

function SvgIconDisconnected(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$D({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$B || (_path$B = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-disconnected_svg__fill",
    d: "M54.534 6.069l-.248.217-9.736 9.735-.04.04-9.573 9.573c-.15.118-.286.254-.405.404L6.286 54.286a2.423 2.423 0 003.18 3.645l.248-.217 13.374-13.373a2.419 2.419 0 001.88-.401 12.119 12.119 0 0114.04 0 2.424 2.424 0 102.808-3.952 16.951 16.951 0 00-11.303-3.072l6.743-6.744a24.105 24.105 0 0110.159 5.021 2.424 2.424 0 003.11-3.719 28.945 28.945 0 00-9.34-5.23l5.633-5.634a36.153 36.153 0 019.225 5.934 2.425 2.425 0 003.211-3.633 40.972 40.972 0 00-8.796-5.941l7.256-7.256a2.423 2.423 0 00-3.18-3.645zm-35.04 21.474a28.936 28.936 0 00-6.032 3.942 2.424 2.424 0 003.137 3.697 24.018 24.018 0 015.022-3.282 2.425 2.425 0 00-2.127-4.357zM4.748 22.909a2.424 2.424 0 003.207 3.636 36.363 36.363 0 0126.978-8.977 2.424 2.424 0 00.389-4.832A41.204 41.204 0 004.748 22.909z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$A;

function _extends$C() {
  _extends$C = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$C.apply(this, arguments);
}

function SvgIconDocument(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$C({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$A || (_path$A = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-document_svg__fill",
    d: "M37.333 2.667a3.305 3.305 0 01.274.014l.085.01.058.008c.047.007.094.016.141.026l.029.007c.05.01.098.023.146.037l.034.01c.237.07.46.173.663.303l.034.022c.036.023.07.047.104.072l.057.043a2.646 2.646 0 01.261.228l-.126-.117c.05.043.097.088.143.135L55.21 19.438c.047.046.091.094.134.143l.035.04c.026.032.052.063.076.096l.04.054.07.1.024.038c.16.253.279.535.347.836l.01.048c.009.043.017.086.024.13l.006.048.007.051.004.041c.01.09.014.18.014.27v32a8 8 0 01-8 8H16a8 8 0 01-8-8V10.667a8 8 0 018-8h21.333zM34.666 8H16a2.667 2.667 0 00-2.667 2.667v42.666A2.667 2.667 0 0016 56h32a2.667 2.667 0 002.667-2.667L50.666 24H37.333a2.667 2.667 0 01-2.648-2.356l-.018-.31L34.666 8zm12.227 10.667l-6.894-6.894.001 6.894h6.893z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$z;

function _extends$B() {
  _extends$B = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$B.apply(this, arguments);
}

function SvgIconDone(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$B({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$z || (_path$z = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-done_svg__fill",
    d: "M12.552 31.448a2.665 2.665 0 10-3.771 3.771l13.333 13.333a2.666 2.666 0 003.772 0L55.219 19.22a2.667 2.667 0 00-3.771-3.771L24 42.895 12.552 31.448z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$y;

function _extends$A() {
  _extends$A = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$A.apply(this, arguments);
}

function SvgIconDoneAll(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$A({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$y || (_path$y = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-done-all_svg__fill",
    d: "M5.886 31.448L19.219 44.78a2.667 2.667 0 01-3.771 3.771L2.114 35.22a2.667 2.667 0 013.772-3.771zm52.228-16a2.666 2.666 0 113.772 3.771L32.552 48.552a2.665 2.665 0 01-3.771 0L15.448 35.22a2.665 2.665 0 010-3.771 2.665 2.665 0 013.771 0l11.448 11.447zm-9.562 0a2.665 2.665 0 010 3.771L32.556 35.215a2.665 2.665 0 01-3.771 0 2.664 2.664 0 010-3.77L44.78 15.447a2.665 2.665 0 013.771 0z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$x;

function _extends$z() {
  _extends$z = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$z.apply(this, arguments);
}

function SvgIconDownload(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$z({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$x || (_path$x = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-download_svg__fill",
    d: "M56 42.667a2.667 2.667 0 012.649 2.355l.018.311v8c0 4.26-3.33 7.743-7.53 7.987l-.47.013H13.333a8 8 0 01-7.986-7.53l-.014-.47v-8a2.667 2.667 0 015.316-.311l.018.311v8a2.67 2.67 0 002.355 2.65l.311.017h37.334a2.667 2.667 0 002.648-2.356l.018-.31v-8A2.667 2.667 0 0156 42.667zm-36.552-8.781a2.666 2.666 0 013.52-3.993l.251.221 6.114 6.114V5.333a2.667 2.667 0 015.316-.311l.018.311v30.894l6.114-6.113a2.668 2.668 0 013.52-.221l.251.221a2.666 2.666 0 01.222 3.52l-.222.252-10.658 10.657a2.341 2.341 0 01-.135.128l.127-.119a2.67 2.67 0 01-.195.176l-.056.045a1.74 1.74 0 01-.086.064l-.056.04-.086.056-.06.036-.081.046-.079.04a2.528 2.528 0 01-.14.065l-.09.036c-.023.01-.045.017-.067.025l-.09.03-.063.019c-.043.012-.086.024-.13.034l-.013.003a3.06 3.06 0 01-.144.028l-.064.01c-.03.005-.061.009-.092.012l-.084.008a1.727 1.727 0 01-.103.006l-.069.002h-.095c-.028 0-.055-.002-.082-.003l.139.003c-.084 0-.167-.004-.249-.011l-.061-.007a1.359 1.359 0 01-.092-.012l-.09-.015a2.242 2.242 0 01-.118-.025l-.04-.01a2.644 2.644 0 01-.34-.11l-.015-.006c-.05-.02-.097-.04-.145-.063l-.042-.02L30.71 45a1.16 1.16 0 01-.067-.039c-.03-.018-.059-.035-.087-.054l-.062-.041c-.03-.02-.06-.042-.088-.063l-.04-.03-.008-.007a2.796 2.796 0 01-.251-.223L19.448 33.886z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$w;

function _extends$y() {
  _extends$y = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$y.apply(this, arguments);
}

function SvgIconEdit(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$y({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 65 65"
  }, props), _path$w || (_path$w = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-edit_svg__fill",
    d: "M56 56a2.667 2.667 0 01.311 5.315l-.311.018H8a2.667 2.667 0 01-.311-5.316L8 56h48zM35.448 3.448a2.665 2.665 0 013.771 0l10.667 10.666a2.668 2.668 0 010 3.772L20.552 47.219c-.5.5-1.178.781-1.885.781H8a2.667 2.667 0 01-2.667-2.667V34.667c0-.708.281-1.386.781-1.886zm1.885 5.659L10.667 35.77v6.896h6.89L44.227 16l-6.894-6.893z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$v;

function _extends$x() {
  _extends$x = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$x.apply(this, arguments);
}

function SvgIconEmojiMore(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$x({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$v || (_path$v = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-emoji-more_svg__fill",
    d: "M32.097 3.22c2.65 0 5.255.357 7.763 1.054a2.134 2.134 0 01-1.144 4.111 24.669 24.669 0 00-6.619-.899c-13.603 0-24.63 11.027-24.63 24.63s11.027 24.63 24.63 24.63 24.63-11.027 24.63-24.63c0-2.227-.295-4.413-.87-6.518a2.13 2.13 0 011.494-2.62 2.13 2.13 0 012.62 1.494 28.895 28.895 0 011.023 7.644c0 15.96-12.938 28.897-28.897 28.897-15.96 0-28.897-12.937-28.897-28.897C3.2 16.157 16.138 3.22 32.097 3.22zm10.705 34.792a2.133 2.133 0 012.024 2.808c-1.873 5.623-6.937 9.488-12.729 9.488-5.792 0-10.856-3.865-12.73-9.488a2.134 2.134 0 011.875-2.803l.15-.005h21.41zm-3.477 4.266H24.867l.294.382c1.539 1.887 3.718 3.113 6.115 3.342l.314.024.507.015c2.617 0 5.037-1.188 6.743-3.151l.193-.23.292-.382zM21.392 21.954c1.087 0 1.985.814 2.116 1.866l.017.267v5.353a2.133 2.133 0 01-4.25.268l-.017-.268v-5.353c0-1.178.955-2.133 2.134-2.133zm21.41 0c1.088 0 1.985.814 2.117 1.866l.017.267v5.353a2.133 2.133 0 01-4.25.268l-.017-.268v-5.353c0-1.178.955-2.133 2.133-2.133zM54.853 0a.8.8 0 01.8.8v7.786h7.76a.8.8 0 01.8.8v2.667a.8.8 0 01-.8.8h-7.76v7.758a.8.8 0 01-.8.8h-2.666a.8.8 0 01-.8-.8v-7.758h-7.785a.8.8 0 01-.8-.8V9.387a.8.8 0 01.8-.8l7.784-.001V.8a.8.8 0 01.8-.8h2.667z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$u;

function _extends$w() {
  _extends$w = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$w.apply(this, arguments);
}

function SvgIconError(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$w({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$u || (_path$u = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-error_svg__fill",
    d: "M32 5.06a8 8 0 016.561 3.424l.287.439 22.608 37.744a8 8 0 01.022 7.962 8.005 8.005 0 01-6.356 4.014l-.535.024H9.384a8.002 8.002 0 01-6.862-4.038 8.008 8.008 0 01-.226-7.493l.27-.506L25.16 8.91A8.001 8.001 0 0132 5.06zm0 5.333c-.816 0-1.58.372-2.076.99l-.196.28-22.565 37.67a2.669 2.669 0 001.909 3.973l.341.027h45.144a2.67 2.67 0 002.45-3.659l-.148-.304L34.28 11.676A2.666 2.666 0 0032 10.393zm0 32.274A2.667 2.667 0 1132 48a2.667 2.667 0 010-5.333zm0-21.334a2.667 2.667 0 012.649 2.356l.018.311v10.667a2.667 2.667 0 01-5.316.311l-.018-.311V24A2.667 2.667 0 0132 21.333z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$t;

function _extends$v() {
  _extends$v = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$v.apply(this, arguments);
}

function SvgIconExpand(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$v({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$t || (_path$t = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-expand_svg__fill",
    d: "M48 8a2.667 2.667 0 012.649 2.356l.018.31V32l-.001.027v21.306a2.667 2.667 0 01-5.315.311l-.018-.31V34.665H19.772l6.114 6.115a2.668 2.668 0 01.221 3.52l-.221.251a2.666 2.666 0 01-3.52.222l-.252-.222-10.666-10.666a2.666 2.666 0 01-.222-3.52l.222-.252 10.666-10.666a2.666 2.666 0 013.993 3.52l-.221.251-6.113 6.114h25.56V10.667A2.667 2.667 0 0148 8z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$s;

function _extends$u() {
  _extends$u = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$u.apply(this, arguments);
}

function SvgIconFileAudio(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$u({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$s || (_path$s = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-file-audio_svg__fill",
    d: "M30.52 12.51c1.685-1.226 4.139-.103 4.139 1.893v35.194c0 1.996-2.454 3.119-4.138 1.893l-12.45-9.909H7.898c-1.416 0-2.564-1.074-2.564-2.399V24.818c0-1.325 1.148-2.4 2.564-2.4h10.175zm20.427.163c10.293 10.667 10.293 27.987 0 38.654a2.137 2.137 0 01-3.156-.047c-.86-.942-.84-2.448.044-3.364 8.49-8.799 8.49-23.033 0-31.832-.884-.916-.904-2.422-.044-3.364a2.137 2.137 0 013.156-.047zm-8.492 8.799c5.597 5.8 5.597 15.231 0 21.031a2.136 2.136 0 01-3.156-.046c-.86-.942-.84-2.448.044-3.364 3.794-3.932 3.794-10.279 0-14.211-.884-.916-.904-2.422-.044-3.363a2.136 2.136 0 013.156-.047z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$r;

function _extends$t() {
  _extends$t = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$t.apply(this, arguments);
}

function SvgIconFileDocument(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$t({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$r || (_path$r = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-file-document_svg__fill",
    d: "M39.414 6.4a2.41 2.41 0 011.71.701l12.642 12.75c.407.41.634.953.634 1.516v29.765c0 3.542-4.342 6.468-8 6.468H16.16c-3.658 0-6.4-2.926-6.4-6.468L9.6 12.868c0-3.542 2.902-6.468 6.56-6.468zm3.331 35.173l-21.49.027-.147.005c-1.066.08-1.908 1.014-1.908 2.155 0 1.193.92 2.16 2.055 2.16l21.49-.027.147-.005c1.066-.08 1.908-1.014 1.908-2.155 0-1.193-.92-2.16-2.055-2.16zm0-8.533l-21.49.027-.147.005c-1.066.08-1.908 1.014-1.908 2.155 0 1.193.92 2.16 2.055 2.16l21.49-.027.147-.005c1.066-.08 1.908-1.014 1.908-2.155 0-1.193-.92-2.16-2.055-2.16zm-11.807-8.507h-9.6l-.153.006a2.15 2.15 0 00-1.985 2.154c0 1.193.957 2.16 2.138 2.16h9.6l.152-.005a2.152 2.152 0 001.985-2.155c0-1.193-.957-2.16-2.137-2.16z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$q;

function _extends$s() {
  _extends$s = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$s.apply(this, arguments);
}

function SvgIconFreeze(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$s({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$q || (_path$q = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-freeze_svg__fill",
    d: "M41.636 3.226l.251.222a2.668 2.668 0 01.222 3.52l-.222.251-7.219 7.218V27.38l11.209-6.472 2.643-9.86a2.667 2.667 0 015.218 1.051l-.067.329-2.237 8.35 8.352 2.24a2.668 2.668 0 011.952 2.938l-.067.328a2.667 2.667 0 01-2.937 1.952l-.329-.066-9.861-2.643L37.334 32l11.209 6.47 9.862-2.64.329-.067a2.667 2.667 0 012.937 1.952l.067.328a2.669 2.669 0 01-1.952 2.938l-8.353 2.237 2.238 8.353.067.329a2.666 2.666 0 01-5.218 1.052l-2.643-9.861-11.209-6.472v12.944l7.219 7.218a2.667 2.667 0 01-3.52 3.993l-.251-.222L32 54.437l-6.114 6.115a2.666 2.666 0 01-3.52.222l-.251-.222a2.666 2.666 0 01-.222-3.52l.222-.251 7.218-7.22V36.62l-11.209 6.47-2.642 9.863a2.666 2.666 0 01-5.218-1.052l.067-.329 2.236-8.351-8.35-2.24a2.665 2.665 0 01-1.953-2.937l.067-.328a2.665 2.665 0 012.937-1.952l.329.066 9.861 2.642L26.667 32l-11.209-6.472-9.86 2.643-.329.066a2.665 2.665 0 01-2.937-1.952l-.067-.328a2.668 2.668 0 011.952-2.938l8.35-2.239-2.235-8.351-.067-.329a2.667 2.667 0 015.218-1.052l2.642 9.862 11.209 6.47V14.439L22.116 7.22a2.665 2.665 0 010-3.771 2.666 2.666 0 013.52-.222l.251.222 6.114 6.112 6.115-6.112a2.666 2.666 0 013.52-.222z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$p;

function _extends$r() {
  _extends$r = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$r.apply(this, arguments);
}

function SvgIconGif(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$r({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$p || (_path$p = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-gif_svg__fill",
    d: "M16.664 45.333c2.155 0 4.119-.318 5.89-.953 1.772-.636 3.143-1.53 4.113-2.683V31.34h-10.29v3.94h4.902v4.474c-.861.856-2.304 1.283-4.327 1.283-2.011 0-3.538-.695-4.58-2.085-1.04-1.39-1.562-3.446-1.562-6.168v-1.657c.012-2.698.497-4.73 1.455-6.097.958-1.366 2.352-2.05 4.184-2.05 1.437 0 2.565.345 3.385 1.034.82.69 1.35 1.777 1.59 3.262h5.243c-.324-2.804-1.36-4.94-3.107-6.408-1.748-1.468-4.172-2.201-7.273-2.201-2.226 0-4.169.502-5.827 1.506-1.658 1.004-2.927 2.454-3.807 4.35-.88 1.895-1.32 4.138-1.32 6.728v1.765c.024 2.52.5 4.712 1.428 6.578.928 1.865 2.245 3.288 3.95 4.269 1.707.98 3.69 1.47 5.953 1.47zm20.67 0V18.667H32v26.666h5.333zm10.396 0V34.436h9.721v-4.432H47.73v-6.887h10.937v-4.45h-16v26.666h5.063z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$o;

function _extends$q() {
  _extends$q = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$q.apply(this, arguments);
}

function SvgIconInfo(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$q({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$o || (_path$o = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-info_svg__fill",
    d: "M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667zM32 8C18.745 8 8 18.745 8 32s10.745 24 24 24 24-10.745 24-24S45.255 8 32 8zm1.667 21.333a1 1 0 011 1v14a1 1 0 01-1 1h-3.334a1 1 0 01-1-1v-14a1 1 0 011-1h3.334zm-1.667-8a2.667 2.667 0 110 5.334 2.667 2.667 0 010-5.334z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$n;

function _extends$p() {
  _extends$p = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$p.apply(this, arguments);
}

function SvgIconLeave(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$p({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$n || (_path$n = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-leave_svg__fill",
    d: "M32 5.333a2.667 2.667 0 01.311 5.316l-.311.018H10.667a2.67 2.67 0 00-2.65 2.355L8 13.333v37.334a2.667 2.667 0 002.356 2.648l.31.018H32a2.667 2.667 0 01.311 5.316l-.311.018H10.667a8.001 8.001 0 01-7.987-7.53l-.013-.47V13.333a8 8 0 017.53-7.986l.47-.014H32zm17.634 13.893l.252.222 10.666 10.666a2.666 2.666 0 01.222 3.52l-.222.252-10.666 10.666a2.666 2.666 0 01-3.993-3.52l.221-.251 4.78-4.782L20 36a2.667 2.667 0 01-.311-5.315l.311-.018h33.56l-7.446-7.448a2.668 2.668 0 01-.221-3.52l.221-.251a2.666 2.666 0 013.52-.222z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$m;

function _extends$o$1() {
  _extends$o$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$o$1.apply(this, arguments);
}

function SvgIconMembers(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$o$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$m || (_path$m = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-members_svg__fill",
    d: "M34.667 37.333c7.17 0 13.018 5.66 13.32 12.755l.013.579V56a2.667 2.667 0 01-5.315.311L42.667 56v-5.333c0-4.26-3.33-7.743-7.53-7.987l-.47-.013H13.333a8 8 0 00-7.986 7.53l-.014.47V56a2.667 2.667 0 01-5.316.311L0 56v-5.333c0-7.17 5.66-13.019 12.755-13.321l.578-.013h21.334zM54 37.765a13.333 13.333 0 019.986 12.297l.014.605V56a2.667 2.667 0 01-5.315.311L58.667 56v-5.331a8 8 0 00-6-7.74A2.667 2.667 0 1154 37.765zM24 5.333c7.364 0 13.333 5.97 13.333 13.334C37.333 26.03 31.363 32 24 32c-7.364 0-13.333-5.97-13.333-13.333 0-7.364 5.97-13.334 13.333-13.334zm19.328.43a13.333 13.333 0 010 25.834 2.667 2.667 0 11-1.323-5.167 8 8 0 000-15.5 2.667 2.667 0 111.323-5.167zM24 10.667a8 8 0 100 16 8 8 0 000-16z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$l;

function _extends$n$1() {
  _extends$n$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$n$1.apply(this, arguments);
}

function SvgIconMessage(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$n$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$l || (_path$l = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-message_svg__fill",
    d: "M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58c-5.965 1.912-10.133 2.572-12.504 1.981-2.799-.698-3.351-1.919-1.657-3.663 1.171-1.396 2.147-3.14 2.928-5.234.622-1.668.377-4.001-.737-7A29.15 29.15 0 012.666 32C2.667 15.8 15.8 2.667 32 2.667zM32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62.067 62.067 0 004.886-1.363l1.721-.568 2.04-.696 1.95.917A23.882 23.882 0 0032 56c13.255 0 24-10.745 24-24S45.255 8 32 8zM18.667 29.333a2.667 2.667 0 11-.001 5.333 2.667 2.667 0 01.001-5.333zm13.333 0a2.667 2.667 0 110 5.334 2.667 2.667 0 010-5.334zm13.333 0a2.667 2.667 0 110 5.334 2.667 2.667 0 010-5.334z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$k;

function _extends$m$1() {
  _extends$m$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$m$1.apply(this, arguments);
}

function SvgIconModerations(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$m$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$k || (_path$k = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-moderations_svg__fill",
    d: "M18.667 34.667a2.667 2.667 0 01.311 5.316l-.311.017h-5.334v16a2.667 2.667 0 01-5.316.311L8 56V40H2.667a2.667 2.667 0 01-.311-5.315l.31-.018h16zM32 29.333a2.667 2.667 0 012.649 2.356l.018.311v24a2.667 2.667 0 01-5.316.311L29.333 56V32A2.667 2.667 0 0132 29.333zM61.333 40a2.667 2.667 0 01.311 5.315l-.31.018h-5.335L56 56a2.667 2.667 0 01-5.315.311L50.667 56l-.001-10.668-5.333.001a2.667 2.667 0 01-.311-5.316l.311-.017h16zm-8-34.667a2.67 2.67 0 012.65 2.356L56 8v24a2.667 2.667 0 01-5.315.311L50.667 32V8a2.667 2.667 0 012.666-2.667zm-42.666 0a2.667 2.667 0 012.648 2.356l.018.311v18.667a2.667 2.667 0 01-5.316.311L8 26.667V8a2.667 2.667 0 012.667-2.667zm21.333 0a2.667 2.667 0 012.649 2.356l.018.311-.001 10.666H40a2.668 2.668 0 01.311 5.317L40 24H24a2.667 2.667 0 01-.311-5.315l.311-.018h5.333V8A2.667 2.667 0 0132 5.333z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$j;

function _extends$l$1() {
  _extends$l$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$l$1.apply(this, arguments);
}

function SvgIconMore(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$l$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$j || (_path$j = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-more_svg__fill",
    d: "M32 45.333a5.333 5.333 0 110 10.666 5.333 5.333 0 010-10.666zM32 28a5.333 5.333 0 110 10.668A5.333 5.333 0 0132 28zm0-17.333c2.946 0 5.333 2.387 5.333 5.333S34.946 21.333 32 21.333 26.667 18.946 26.667 16s2.387-5.333 5.333-5.333z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$i;

function _extends$k$1() {
  _extends$k$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$k$1.apply(this, arguments);
}

function SvgIconMute(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$k$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$i || (_path$i = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-mute_svg__fill",
    d: "M55.62 19.616l.067.123A26.552 26.552 0 0158.667 32c0 4.326-1.03 8.41-2.864 12.025-1.012 2.726-1.235 4.847-.67 6.363.71 1.903 1.598 3.49 2.662 4.758 1.54 1.586 1.039 2.696-1.506 3.33-2.09.521-5.716-.027-10.879-1.646l-.488-.155-1.594-.527A26.56 26.56 0 0132 58.667a26.55 26.55 0 01-12.326-3.014l-.059-.03 4-4A21.24 21.24 0 0032 53.333c2.993 0 5.89-.614 8.562-1.786l.498-.226 1.925-.905 3.613 1.196.695.219c.728.225 1.414.423 2.054.595l.472.125.485.121-.167-.42-.2-.594c-.814-2.685-.484-5.681.713-9.065l.154-.425.106-.284.528-1.084a21.188 21.188 0 001.895-8.8 21.24 21.24 0 00-1.71-8.385l3.997-3.999zm2.266-13.502a2.668 2.668 0 01.221 3.52l-.221.252-48 48a2.668 2.668 0 01-3.993-3.52l.221-.252 5.238-5.237a26.563 26.563 0 01-6.015-16.412L5.333 32C5.333 17.272 17.273 5.333 32 5.333a26.55 26.55 0 0116.877 6.02l5.237-5.239a2.668 2.668 0 013.772 0zM32 10.667c-11.782 0-21.333 9.55-21.333 21.333 0 4.836 1.614 9.401 4.48 13.084l29.936-29.938A21.248 21.248 0 0032 10.666z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$h;

function _extends$j$1() {
  _extends$j$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$j$1.apply(this, arguments);
}

function SvgIconNotifications(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$j$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$h || (_path$h = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-notifications_svg__fill",
    d: "M36.613 53.333c2.056 0 3.338 2.227 2.307 4.005a8 8 0 01-13.84 0c-.98-1.689.129-3.783 2.004-3.988l.303-.017h9.226zM32 2.667c11.56 0 20.972 9.194 21.323 20.669l.01.664v13.333a5.334 5.334 0 004.936 5.319l.753.033c2.963.318 3.077 4.616.342 5.24l-.342.056-.355.019H5.333l-.355-.019c-3.082-.33-3.082-4.965 0-5.296l.753-.033a5.335 5.335 0 004.92-4.9l.016-.419V24c0-11.782 9.55-21.333 21.333-21.333zM32 8c-8.636 0-15.674 6.842-15.989 15.4L16 24v13.333c0 1.562-.336 3.046-.939 4.383l-.275.564-.218.387h34.861l-.215-.387a10.583 10.583 0 01-1.146-3.74l-.055-.674-.013-.533V24c0-8.837-7.163-16-16-16z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$g;

function _extends$i$1() {
  _extends$i$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$i$1.apply(this, arguments);
}

function SvgIconNotificationsOffFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$i$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$g || (_path$g = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-notifications-off-filled_svg__fill",
    d: "M36.613 53.333c2.056 0 3.338 2.227 2.307 4.005a8 8 0 01-13.84 0c-.98-1.689.129-3.783 2.004-3.988l.303-.017h9.226zM32 2.667c7.173 0 13.52 3.54 17.387 8.97l5.686-5.687a2.105 2.105 0 012.85-.117l.127.117a2.105 2.105 0 010 2.977L8.927 58.05c-.78.781-2.023.82-2.85.117l-.127-.117a2.105 2.105 0 010-2.977L13.023 48h-7.69l-.355-.019c-3.082-.33-3.082-4.965 0-5.296l.753-.033a5.335 5.335 0 004.92-4.9l.016-.419V24c0-11.782 9.55-21.333 21.333-21.333zm20.85 16.795c.271 1.253.433 2.548.473 3.874l.01.664v13.333a5.334 5.334 0 004.936 5.319l.753.033c2.963.318 3.077 4.616.342 5.24l-.342.056-.355.019H24.31l28.54-28.538z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$f;

function _extends$h$1() {
  _extends$h$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$h$1.apply(this, arguments);
}

function SvgIconOperator(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$h$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$f || (_path$f = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-operator_svg__fill",
    d: "M29.83 6.45a2.667 2.667 0 014.34 0l11.697 16.374L57 13.918c1.88-1.504 4.573.054 4.32 2.35l-.047.29-8 37.334A2.666 2.666 0 0150.666 56H13.333a2.666 2.666 0 01-2.607-2.108l-8-37.333c-.525-2.452 2.315-4.207 4.273-2.641l11.132 8.906zM32 12.587l-11.163 15.63a2.667 2.667 0 01-3.836.532l-7.497-5.997 5.984 27.915h33.021l5.984-27.915L47 28.749a2.667 2.667 0 01-3.632-.281l-.204-.251L32 12.587zM32 32a5.333 5.333 0 110 10.668A5.333 5.333 0 0132 32z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$e;

function _extends$g$1() {
  _extends$g$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$g$1.apply(this, arguments);
}

function SvgIconPhoto(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$g$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$e || (_path$e = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-photo_svg__fill",
    d: "M50.667 5.333a8 8 0 018 8v37.334a8 8 0 01-8 8H13.333a8 8 0 01-8-8V13.333a8 8 0 018-8zm-8 25.107L19.77 53.332l30.896.001a2.667 2.667 0 002.661-2.498l.005-.168v-9.564L42.666 30.44zm8-19.773H13.333a2.667 2.667 0 00-2.666 2.666v37.334c0 1.143.72 2.119 1.731 2.498L40.781 24.78a2.668 2.668 0 013.52-.222l.251.222 8.78 8.78.001-20.228a2.667 2.667 0 00-2.498-2.661l-.168-.005zm-28 5.333a6.666 6.666 0 110 13.333 6.666 6.666 0 010-13.333zm0 5.333a1.334 1.334 0 100 2.667 1.334 1.334 0 000-2.667z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$d;

function _extends$f$1() {
  _extends$f$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$f$1.apply(this, arguments);
}

function SvgIconPlay(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$f$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$d || (_path$d = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-play_svg__fill",
    d: "M51.908 34.75c1.9-1.233 1.896-3.26.013-4.514L19.376 8.577c-1.893-1.26-3.404-.391-3.376 1.968l.522 42.888c.028 2.347 1.596 3.247 3.493 2.016L51.908 34.75z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$c;

function _extends$e$1() {
  _extends$e$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$e$1.apply(this, arguments);
}

function SvgIconPlus(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$e$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$c || (_path$c = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-plus_svg__fill",
    d: "M34.667 29.333h18.666c3.556 0 3.556 5.334 0 5.334H34.667v18.666c0 3.556-5.334 3.556-5.334 0V34.667H10.667c-3.556 0-3.556-5.334 0-5.334h18.666V10.667c0-3.556 5.334-3.556 5.334 0v18.666z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$b$1;

function _extends$d$1() {
  _extends$d$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$d$1.apply(this, arguments);
}

function SvgIconQuestion(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$d$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$b$1 || (_path$b$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-question_svg__fill",
    d: "M32 61.333C15.8 61.333 2.667 48.2 2.667 32S15.8 2.667 32 2.667 61.333 15.8 61.333 32 48.2 61.333 32 61.333zM32 56c13.255 0 24-10.745 24-24S45.255 8 32 8 8 18.745 8 32s10.745 24 24 24zm2.213-18.63a2.667 2.667 0 11-5.333 0v-2.69c0-1.148.734-2.168 1.823-2.53.173-.058.532-.195 1.01-.407.809-.36 1.616-.79 2.354-1.282 1.835-1.223 2.813-2.528 2.813-3.786a5.333 5.333 0 00-10.364-1.777 2.667 2.667 0 01-5.032-1.77 10.668 10.668 0 0120.729 3.551c0 3.413-2.022 6.109-5.187 8.22a21.268 21.268 0 01-2.813 1.578v.893zm-5.333 7.523a2.667 2.667 0 115.333 0v.44a2.667 2.667 0 11-5.333 0v-.44z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$a$1;

function _extends$c$1() {
  _extends$c$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$c$1.apply(this, arguments);
}

function SvgIconRefresh(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$c$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$a$1 || (_path$a$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-refresh_svg__fill",
    d: "M46.14 14.43l.562.537 6.631 6.167v-7.8a2.67 2.67 0 012.356-2.65l.311-.017a2.667 2.667 0 012.649 2.355l.018.311v16a2.67 2.67 0 01-2.356 2.65L56 32H40a2.667 2.667 0 01-.311-5.315l.311-.018h11.452l-8.44-7.85c-5.964-5.893-15.168-7.182-22.563-3.156-7.38 4.018-11.172 12.357-9.314 20.455 1.859 8.107 8.935 14.032 17.362 14.518 8.43.487 16.162-4.585 18.967-12.426a2.667 2.667 0 015.022 1.797C48.88 50.082 38.973 56.582 28.19 55.959c-10.785-.623-19.862-8.222-22.254-18.65C3.542 26.872 8.426 16.135 17.9 10.977c9.227-5.024 20.65-3.579 28.241 3.453z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$9$1;

function _extends$b$1() {
  _extends$b$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$b$1.apply(this, arguments);
}

function SvgIconRemove(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$b$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$9$1 || (_path$9$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-remove_svg__fill",
    d: "M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667zm9.886 19.447a2.668 2.668 0 00-3.772 0L32 28.23l-6.114-6.115-.134-.124a2.667 2.667 0 00-3.638.124l-.124.134a2.667 2.667 0 00.124 3.638L28.23 32l-6.115 6.114-.124.134a2.667 2.667 0 00.124 3.638l.134.124a2.667 2.667 0 003.638-.124L32 35.77l6.114 6.115.134.124a2.667 2.667 0 003.638-.124l.124-.134a2.667 2.667 0 00-.124-3.638L35.77 32l6.115-6.114.124-.134a2.667 2.667 0 00-.124-3.638z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$8$1;

function _extends$a$1() {
  _extends$a$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$a$1.apply(this, arguments);
}

function SvgIconReplyFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$a$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 12 12"
  }, props), _path$8$1 || (_path$8$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-reply-filled_svg__fill",
    d: "M11.774 10.5c.062 0 .12-.025.164-.07a.22.22 0 00.062-.164c-.07-1.447-.495-2.678-1.268-3.66-.618-.785-1.455-1.409-2.49-1.855a9.331 9.331 0 00-2.406-.655 9.542 9.542 0 00-.862-.078V2.225a.225.225 0 00-.128-.203.23.23 0 00-.24.028L.084 5.692A.221.221 0 000 5.865c0 .068.03.132.082.175l4.523 3.737c.067.056.16.068.24.03a.222.222 0 00.13-.202v-1.95c1.134-.08 2.178.003 3.107.25a6.39 6.39 0 012.087.96c1.018.724 1.398 1.5 1.4 1.507a.23.23 0 00.205.128z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$7$1;

function _extends$9$1() {
  _extends$9$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$9$1.apply(this, arguments);
}

function SvgIconSearch(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$9$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$7$1 || (_path$7$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-search_svg__fill",
    d: "M26.667 48C14.885 48 5.333 38.449 5.333 26.667c0-11.782 9.552-21.334 21.334-21.334S48 14.885 48 26.667c0 4.93-1.672 9.469-4.48 13.081l13.67 13.67a2.668 2.668 0 01-3.772 3.772l-13.67-13.67A21.239 21.239 0 0126.667 48zm0-5.333c8.836 0 16-7.164 16-16 0-8.837-7.164-16-16-16-8.837 0-16 7.163-16 16 0 8.836 7.163 16 16 16z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$6$1;

function _extends$8$1() {
  _extends$8$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$8$1.apply(this, arguments);
}

function SvgIconSend(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$8$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$6$1 || (_path$6$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-send_svg__fill",
    d: "M59.795 29.43L7.329 2.979C4.691 1.802 1.76 4.153 2.932 6.798l6.925 18.609a2 2 0 001.544 1.275l32.273 5.394L11.4 37.47a1.998 1.998 0 00-1.544 1.275L2.932 57.353c-.879 2.645 1.76 4.997 4.397 3.527l52.466-26.453c2.051-.882 2.051-3.82 0-4.996z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$5$1;

function _extends$7$1() {
  _extends$7$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$7$1.apply(this, arguments);
}

function SvgIconSettingsFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$7$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$5$1 || (_path$5$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-settings-filled_svg__fill",
    d: "M32 2.667A5.332 5.332 0 0137.333 8v.24A4.4 4.4 0 0040 12.267a4.4 4.4 0 004.853-.88l.16-.16a5.332 5.332 0 017.547 0 5.333 5.333 0 010 7.546l-.16.16a4.401 4.401 0 00-.88 4.854V24a4.4 4.4 0 004.027 2.667H56c2.946 0 5.333 2.387 5.333 5.333S58.946 37.333 56 37.333h-.24A4.4 4.4 0 0051.733 40a4.4 4.4 0 00.88 4.853l.16.16a5.332 5.332 0 010 7.547 5.333 5.333 0 01-7.546 0l-.16-.16a4.401 4.401 0 00-4.854-.88 4.397 4.397 0 00-2.666 4.027V56a5.333 5.333 0 01-10.667 0v-.24A4.4 4.4 0 0024 51.733a4.4 4.4 0 00-4.853.88l-.16.16a5.332 5.332 0 01-7.547 0 5.333 5.333 0 010-7.546l.16-.16a4.401 4.401 0 00.88-4.854 4.397 4.397 0 00-4.027-2.666H8A5.333 5.333 0 018 26.88h.24A4.4 4.4 0 0012.267 24a4.4 4.4 0 00-.88-4.853l-.16-.16a5.332 5.332 0 010-7.547 5.333 5.333 0 017.546 0l.16.16a4.401 4.401 0 004.854.88H24a4.4 4.4 0 002.667-4.027V8A5.332 5.332 0 0132 2.667zM32 24a8 8 0 100 16 8 8 0 000-16z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$4$1;

function _extends$6$1() {
  _extends$6$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$6$1.apply(this, arguments);
}

function SvgIconSpinner(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$6$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$4$1 || (_path$4$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-spinner_svg__fill",
    d: "M32 61.333C48.2 61.333 61.333 48.2 61.333 32S48.2 2.667 32 2.667 2.667 15.8 2.667 32a2.838 2.838 0 105.678 0C8.344 18.935 18.934 8.344 32 8.344c13.065 0 23.656 10.591 23.656 23.656S45.065 55.656 32 55.656a2.838 2.838 0 100 5.677z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$3$1;

function _extends$5$1() {
  _extends$5$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$5$1.apply(this, arguments);
}

function SvgIconSupergroup(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$5$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$3$1 || (_path$3$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-supergroup_svg__fill",
    d: "M36.889 43.013c6.608 0 12.121 4.685 12.43 10.734l.014.537V58a2.667 2.667 0 01-5.316.311L44 58v-3.716c0-3.07-2.87-5.718-6.636-5.925l-.475-.013H27.11c-3.838 0-6.86 2.525-7.096 5.557l-.015.381V58a2.667 2.667 0 01-5.315.311L14.667 58v-3.716c0-6.126 5.324-10.986 11.864-11.26l.58-.011h9.778zm18.578-17.291c.266 0 .53.04.784.118 4.632 1.426 7.518 4.801 7.736 9.688l.013.594v12.8a2.667 2.667 0 01-5.315.311l-.018-.311V36.124c-.002-2.595-1.163-4.171-3.528-5.034l-.104-.037-2.502.002a2.667 2.667 0 01-2.648-2.356l-.018-.31a2.67 2.67 0 012.355-2.65l.311-.017h2.934zm-44 0l.31.018a2.666 2.666 0 012.356 2.648l-.018.311a2.666 2.666 0 01-2.648 2.356l-2.51-.002-.119.042c-2.246.85-3.503 2.574-3.505 5.147v12.68l-.018.31A2.666 2.666 0 010 48.922V36.24l.014-.591c.225-4.874 3.203-8.415 7.712-9.809.255-.078.52-.118.788-.118h2.953zM32 19.958c5.512 0 10 4.409 10 9.871 0 5.463-4.488 9.872-10 9.872s-10-4.41-10-9.872 4.488-9.871 10-9.871zm0 5.333c-2.588 0-4.667 2.043-4.667 4.538 0 2.496 2.08 4.538 4.667 4.538 2.588 0 4.667-2.042 4.667-4.538 0-2.495-2.08-4.538-4.667-4.538zM17.333 2.667c5.513 0 10 4.409 10 9.871 0 5.462-4.487 9.871-10 9.871-5.512 0-10-4.409-10-9.871 0-5.462 4.488-9.871 10-9.871zm29.334 0c5.512 0 10 4.409 10 9.871 0 5.462-4.488 9.871-10 9.871-5.513 0-10-4.409-10-9.871 0-5.462 4.487-9.871 10-9.871zM17.333 8c-2.587 0-4.666 2.042-4.666 4.538 0 2.496 2.079 4.538 4.666 4.538 2.588 0 4.667-2.042 4.667-4.538C22 10.042 19.921 8 17.333 8zm29.334 0C44.079 8 42 10.042 42 12.538c0 2.496 2.079 4.538 4.667 4.538 2.587 0 4.666-2.042 4.666-4.538 0-2.496-2.079-4.538-4.666-4.538z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _path$2$1, _path2$1;

function _extends$4$1() {
  _extends$4$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$4$1.apply(this, arguments);
}

function SvgIconThread(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$4$1({
    viewBox: "0 0 64 64",
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$2$1 || (_path$2$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-thread_svg__fill",
    clipRule: "evenodd",
    d: "M38.824 25.895a2.95 2.95 0 014.16-.074L57.1 39.378a2.921 2.921 0 01.002 4.213L42.985 57.177a2.95 2.95 0 01-4.158-.07 2.919 2.919 0 01.07-4.14l11.928-11.48-11.926-11.451a2.919 2.919 0 01-.075-4.14z"
  })), _path2$1 || (_path2$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-thread_svg__fill",
    clipRule: "evenodd",
    d: "M8.866 6c1.583 0 2.866 1.216 2.866 2.716V25.5c0 7.672 6.846 14.068 15.475 14.068h22.927c1.583 0 2.866 1.216 2.866 2.716 0 1.5-1.283 2.716-2.866 2.716H27.207C15.604 45 6 36.35 6 25.5V8.716C6 7.216 7.283 6 8.866 6z"
  })));
}

var _path$1$1;

function _extends$3$1() {
  _extends$3$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$3$1.apply(this, arguments);
}

function SvgIconThumbnailNone(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$3$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$1$1 || (_path$1$1 = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-thumbnail-none_svg__fill",
    d: "M34.667 5.333a2.667 2.667 0 010 5.334H13.333a2.667 2.667 0 00-2.666 2.666v37.334c0 1.143.72 2.118 1.73 2.497l28.384-28.383a2.667 2.667 0 013.771 0l8.781 8.78v-4.228a2.667 2.667 0 012.498-2.661l.169-.005a2.667 2.667 0 012.667 2.666v21.334a8 8 0 01-8 8H13.33a8 8 0 01-7.998-8V13.333a8 8 0 018-8zm8 25.105L19.77 53.333h30.897a2.667 2.667 0 002.661-2.498l.005-.168v-9.563L42.667 30.438zM22.667 16a6.666 6.666 0 110 13.333 6.666 6.666 0 010-13.333zm0 5.333a1.334 1.334 0 100 2.667 1.334 1.334 0 000-2.667zM56.78 3.448a2.665 2.665 0 013.771 0 2.665 2.665 0 010 3.771l-4.782 4.78 4.782 4.782c.998.998 1.04 2.59.125 3.638l-.125.133a2.665 2.665 0 01-3.771 0l-4.782-4.781-4.78 4.781a2.667 2.667 0 01-3.638.125l-.133-.125a2.665 2.665 0 010-3.771L48.228 12l-4.78-4.781a2.667 2.667 0 01-.125-3.638l.125-.133a2.665 2.665 0 013.771 0l4.78 4.78z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

var _g$1$1;

function _extends$2$1() {
  _extends$2$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$2$1.apply(this, arguments);
}

function SvgIconToggleoff(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$2$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 88 48"
  }, props), _g$1$1 || (_g$1$1 = /*#__PURE__*/React__default.createElement("g", {
    fill: "none",
    fillRule: "evenodd"
  }, /*#__PURE__*/React__default.createElement("rect", {
    className: "icon-toggleoff_svg__fill",
    width: 80,
    height: 40,
    x: 4,
    y: 4,
    fill: "#000",
    rx: 20
  }), /*#__PURE__*/React__default.createElement("circle", {
    cx: 24,
    cy: 24,
    r: 12,
    fill: "#FFF"
  }), /*#__PURE__*/React__default.createElement("path", {
    fill: "#FFF",
    d: "M64 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4h40zm0 2H24C14.059 6 6 14.059 6 24c0 9.764 7.774 17.712 17.47 17.992L24 42h40c9.941 0 18-8.059 18-18 0-9.764-7.774-17.712-17.47-17.992L64 6z"
  }), /*#__PURE__*/React__default.createElement("path", {
    className: "icon-toggleoff_svg__fill",
    fill: "#000",
    d: "M64 0H24C10.745 0 0 10.745 0 24s10.745 24 24 24h40c13.255 0 24-10.745 24-24S77.255 0 64 0zm0 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4h40z"
  }))));
}

var _g$9;

function _extends$1$1() {
  _extends$1$1 = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$1$1.apply(this, arguments);
}

function SvgIconToggleon(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$1$1({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 88 48"
  }, props), _g$9 || (_g$9 = /*#__PURE__*/React__default.createElement("g", {
    fill: "none",
    fillRule: "evenodd"
  }, /*#__PURE__*/React__default.createElement("rect", {
    className: "icon-toggleon_svg__fill",
    width: 80,
    height: 40,
    x: 4,
    y: 4,
    fill: "#000",
    rx: 20
  }), /*#__PURE__*/React__default.createElement("circle", {
    cx: 64,
    cy: 24,
    r: 12,
    fill: "#FFF"
  }), /*#__PURE__*/React__default.createElement("path", {
    fill: "#FFF",
    d: "M64 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4h40zm0 2H24C14.059 6 6 14.059 6 24c0 9.764 7.774 17.712 17.47 17.992L24 42h40c9.941 0 18-8.059 18-18 0-9.764-7.774-17.712-17.47-17.992L64 6z"
  }), /*#__PURE__*/React__default.createElement("path", {
    className: "icon-toggleon_svg__fill",
    fill: "#000",
    d: "M64 0H24C10.745 0 0 10.745 0 24s10.745 24 24 24h40c13.255 0 24-10.745 24-24S77.255 0 64 0zm0 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4h40z"
  }))));
}

var _path$S;

function _extends$V() {
  _extends$V = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  return _extends$V.apply(this, arguments);
}

function SvgIconUser(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$V({
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 0 64 64"
  }, props), _path$S || (_path$S = /*#__PURE__*/React__default.createElement("path", {
    className: "icon-user_svg__fill",
    d: "M42.667 37.333c7.17 0 13.018 5.66 13.32 12.755l.013.579V56a2.667 2.667 0 01-5.315.311L50.667 56v-5.333c0-4.26-3.33-7.743-7.53-7.987l-.47-.013H21.333a8 8 0 00-7.986 7.53l-.014.47V56a2.667 2.667 0 01-5.316.311L8 56v-5.333c0-7.17 5.66-13.019 12.755-13.321l.578-.013h21.334zM32 5.333c7.364 0 13.333 5.97 13.333 13.334C45.333 26.03 39.363 32 32 32c-7.364 0-13.333-5.97-13.333-13.333 0-7.364 5.97-13.334 13.333-13.334zm0 5.334a8 8 0 100 16 8 8 0 000-16z",
    fill: "#000",
    fillRule: "evenodd"
  })));
}

function changeTypeToIconComponent(type) {
  switch (type) {
    case Types$1.ADD:
      return /*#__PURE__*/React__default__default.createElement(SvgIconAdd, null);

    case Types$1.ARROW_LEFT:
      return /*#__PURE__*/React__default__default.createElement(SvgIconArrowLeft, null);

    case Types$1.ATTACH:
      return /*#__PURE__*/React__default__default.createElement(SvgIconAttach, null);

    case Types$1.AUDIO_ON_LINED:
      return /*#__PURE__*/React__default__default.createElement(SvgIconAudioOnLined, null);

    case Types$1.BAN:
      return /*#__PURE__*/React__default__default.createElement(SvgIconBan, null);

    case Types$1.BROADCAST:
      return /*#__PURE__*/React__default__default.createElement(SvgIconBroadcast, null);

    case Types$1.CAMERA:
      return /*#__PURE__*/React__default__default.createElement(SvgIconCamera, null);

    case Types$1.CHANNELS:
      return /*#__PURE__*/React__default__default.createElement(SvgIconChannels, null);

    case Types$1.CHAT:
      return /*#__PURE__*/React__default__default.createElement(SvgIconChat, null);

    case Types$1.CHAT_FILLED:
      return /*#__PURE__*/React__default__default.createElement(SvgIconChatFilled, null);

    case Types$1.CHEVRON_DOWN:
      return /*#__PURE__*/React__default__default.createElement(SvgIconChevronDown, null);

    case Types$1.CHEVRON_RIGHT:
      return /*#__PURE__*/React__default__default.createElement(SvgIconChevronRight, null);

    case Types$1.CLOSE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconClose, null);

    case Types$1.COLLAPSE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconCollapse, null);

    case Types$1.COPY:
      return /*#__PURE__*/React__default__default.createElement(SvgIconCopy, null);

    case Types$1.CREATE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconCreate, null);

    case Types$1.DELETE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconDelete, null);

    case Types$1.DISCONNECTED:
      return /*#__PURE__*/React__default__default.createElement(SvgIconDisconnected, null);

    case Types$1.DOCUMENT:
      return /*#__PURE__*/React__default__default.createElement(SvgIconDocument, null);

    case Types$1.DONE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconDone, null);

    case Types$1.DONE_ALL:
      return /*#__PURE__*/React__default__default.createElement(SvgIconDoneAll, null);

    case Types$1.DOWNLOAD:
      return /*#__PURE__*/React__default__default.createElement(SvgIconDownload, null);

    case Types$1.EDIT:
      return /*#__PURE__*/React__default__default.createElement(SvgIconEdit, null);

    case Types$1.EMOJI_MORE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconEmojiMore, null);

    case Types$1.ERROR:
      return /*#__PURE__*/React__default__default.createElement(SvgIconError, null);

    case Types$1.EXPAND:
      return /*#__PURE__*/React__default__default.createElement(SvgIconExpand, null);

    case Types$1.FILE_AUDIO:
      return /*#__PURE__*/React__default__default.createElement(SvgIconFileAudio, null);

    case Types$1.FILE_DOCUMENT:
      return /*#__PURE__*/React__default__default.createElement(SvgIconFileDocument, null);

    case Types$1.FREEZE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconFreeze, null);

    case Types$1.GIF:
      return /*#__PURE__*/React__default__default.createElement(SvgIconGif, null);

    case Types$1.INFO:
      return /*#__PURE__*/React__default__default.createElement(SvgIconInfo, null);

    case Types$1.LEAVE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconLeave, null);

    case Types$1.MEMBERS:
      return /*#__PURE__*/React__default__default.createElement(SvgIconMembers, null);

    case Types$1.MESSAGE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconMessage, null);

    case Types$1.MODERATIONS:
      return /*#__PURE__*/React__default__default.createElement(SvgIconModerations, null);

    case Types$1.MORE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconMore, null);

    case Types$1.MUTE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconMute, null);

    case Types$1.NOTIFICATIONS:
      return /*#__PURE__*/React__default__default.createElement(SvgIconNotifications, null);

    case Types$1.NOTIFICATIONS_OFF_FILLED:
      return /*#__PURE__*/React__default__default.createElement(SvgIconNotificationsOffFilled, null);

    case Types$1.OPERATOR:
      return /*#__PURE__*/React__default__default.createElement(SvgIconOperator, null);

    case Types$1.PHOTO:
      return /*#__PURE__*/React__default__default.createElement(SvgIconPhoto, null);

    case Types$1.PLAY:
      return /*#__PURE__*/React__default__default.createElement(SvgIconPlay, null);

    case Types$1.PLUS:
      return /*#__PURE__*/React__default__default.createElement(SvgIconPlus, null);

    case Types$1.QUESTION:
      return /*#__PURE__*/React__default__default.createElement(SvgIconQuestion, null);

    case Types$1.REFRESH:
      return /*#__PURE__*/React__default__default.createElement(SvgIconRefresh, null);

    case Types$1.REMOVE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconRemove, null);

    case Types$1.REPLY:
      return /*#__PURE__*/React__default__default.createElement(SvgIconReplyFilled, null);

    case Types$1.SEARCH:
      return /*#__PURE__*/React__default__default.createElement(SvgIconSearch, null);

    case Types$1.SEND:
      return /*#__PURE__*/React__default__default.createElement(SvgIconSend, null);

    case Types$1.SETTINGS_FILLED:
      return /*#__PURE__*/React__default__default.createElement(SvgIconSettingsFilled, null);

    case Types$1.SPINNER:
      return /*#__PURE__*/React__default__default.createElement(SvgIconSpinner, null);

    case Types$1.SUPERGROUP:
      return /*#__PURE__*/React__default__default.createElement(SvgIconSupergroup, null);

    case Types$1.THREAD:
      return /*#__PURE__*/React__default__default.createElement(SvgIconThread, null);

    case Types$1.THUMBNAIL_NONE:
      return /*#__PURE__*/React__default__default.createElement(SvgIconThumbnailNone, null);

    case Types$1.TOGGLE_OFF:
      return /*#__PURE__*/React__default__default.createElement(SvgIconToggleoff, null);

    case Types$1.TOGGLE_ON:
      return /*#__PURE__*/React__default__default.createElement(SvgIconToggleon, null);

    case Types$1.USER:
      return /*#__PURE__*/React__default__default.createElement(SvgIconUser, null);

    default:
      return 'icon';
    // If you see this text 'icon' replace icon for it
  }
}

function Icon(_ref) {
  let {
    className,
    type,
    fillColor,
    width,
    height,
    onClick,
    children
  } = _ref;
  const iconStyle = {
    width: typeof width === 'string' ? width : `${width}px`,
    minWidth: typeof width === 'string' ? width : `${width}px`,
    height: typeof height === 'string' ? height : `${height}px`,
    minHeight: typeof height === 'string' ? height : `${height}px`
  };
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-icon', changeTypeToIconClassName(type), changeColorToClassName$1(fillColor)].join(' '),
    role: "button",
    onClick: onClick,
    onKeyDown: onClick,
    tabIndex: "0",
    style: iconStyle
  }, children || changeTypeToIconComponent(type));
}

Icon.propTypes = {
  className: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.arrayOf(propTypes.exports.string)]),

  /** Type: Use strings from below list */
  type: propTypes.exports.oneOfType([propTypes.exports.oneOf(Object.keys(Types$1)), propTypes.exports.string]).isRequired,

  /** Type: Use Colors from below list */
  fillColor: propTypes.exports.oneOf(Object.keys(Colors$1)),
  width: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.number]),
  height: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.number]),
  onClick: propTypes.exports.func,
  children: propTypes.exports.element
};
Icon.defaultProps = {
  className: '',
  fillColor: Colors$1.DEFAULT,
  width: 26,
  height: 26,
  onClick: () => {},
  children: null
};
const IconTypes = Types$1;
const IconColors = Colors$1;

const IconButton = /*#__PURE__*/React__default__default.forwardRef((props, ref) => {
  const {
    className = '',
    children,
    disabled = false,
    width = '56px',
    height = '56px',
    type = 'button',
    style = {},
    onBlur = () => {
      /* noop */
    },
    onClick = () => {
      /* noop */
    }
  } = props;
  const [isPressed, setIsPressed] = useState(false);
  return /*#__PURE__*/React__default__default.createElement("button", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-iconbutton', isPressed ? 'sendbird-iconbutton--pressed' : ''].join(' '),
    disabled: disabled,
    ref: ref,
    type: type,
    style: _objectSpread2(_objectSpread2({}, style), {}, {
      height,
      width
    }),
    onClick: e => {
      if (disabled) {
        return;
      }

      setIsPressed(true);
      onClick === null || onClick === void 0 ? void 0 : onClick(e);
    },
    onBlur: e => {
      setIsPressed(false);
      onBlur === null || onBlur === void 0 ? void 0 : onBlur(e);
    }
  }, /*#__PURE__*/React__default__default.createElement("span", {
    className: "sendbird-iconbutton__inner"
  }, children));
});

const DEFAULT_MOBILE = false; // const DEFAULT_MOBILE = '768px';

const MOBILE_CLASSNAME = 'sendbird--mobile-mode';
const MediaQueryContext = /*#__PURE__*/React__default__default.createContext({
  breakpoint: DEFAULT_MOBILE,
  isMobile: false
});

const addClassNameToBody = () => {
  try {
    const body = document.querySelector('body');
    body === null || body === void 0 ? void 0 : body.classList.add(MOBILE_CLASSNAME);
  } catch (_unused) {// noop
  }
};

const removeClassNameFromBody = () => {
  try {
    const body = document.querySelector('body');
    body === null || body === void 0 ? void 0 : body.classList.remove(MOBILE_CLASSNAME);
  } catch (_unused2) {// noop
  }
};

const MediaQueryProvider = props => {
  const {
    children,
    logger
  } = props;
  const breakpoint = (props === null || props === void 0 ? void 0 : props.breakpoint) || false;
  const [isMobile, setIsMobile] = useState(false);
  useEffect(() => {
    var _logger$info6;

    const updateSize = () => {
      if (typeof breakpoint === 'boolean') {
        setIsMobile(breakpoint);

        if (breakpoint) {
          var _logger$info;

          logger === null || logger === void 0 ? void 0 : (_logger$info = logger.info) === null || _logger$info === void 0 ? void 0 : _logger$info.call(logger, 'MediaQueryProvider: isMobile: true');
          addClassNameToBody();
        } else {
          var _logger$info2;

          logger === null || logger === void 0 ? void 0 : (_logger$info2 = logger.info) === null || _logger$info2 === void 0 ? void 0 : _logger$info2.call(logger, 'MediaQueryProvider: isMobile: false');
          removeClassNameFromBody();
        }
      } else {
        var _logger$info3;

        const mq = window.matchMedia(`(max-width: ${breakpoint})`);
        logger === null || logger === void 0 ? void 0 : (_logger$info3 = logger.info) === null || _logger$info3 === void 0 ? void 0 : _logger$info3.call(logger, `MediaQueryProvider: Screensize updated to ${breakpoint}`);

        if (mq.matches) {
          var _logger$info4;

          setIsMobile(true);
          addClassNameToBody();
          logger === null || logger === void 0 ? void 0 : (_logger$info4 = logger.info) === null || _logger$info4 === void 0 ? void 0 : _logger$info4.call(logger, 'MediaQueryProvider: isMobile: true');
        } else {
          var _logger$info5;

          setIsMobile(false);
          removeClassNameFromBody();
          logger === null || logger === void 0 ? void 0 : (_logger$info5 = logger.info) === null || _logger$info5 === void 0 ? void 0 : _logger$info5.call(logger, 'MediaQueryProvider: isMobile: false');
        }
      }
    };

    updateSize();
    window.addEventListener('resize', updateSize);
    logger === null || logger === void 0 ? void 0 : (_logger$info6 = logger.info) === null || _logger$info6 === void 0 ? void 0 : _logger$info6.call(logger, 'MediaQueryProvider: addEventListener', {
      updateSize
    });
    return () => {
      var _logger$info7;

      window.removeEventListener('resize', updateSize);
      logger === null || logger === void 0 ? void 0 : (_logger$info7 = logger.info) === null || _logger$info7 === void 0 ? void 0 : _logger$info7.call(logger, 'MediaQueryProvider: removeEventListener', {
        updateSize
      });
    };
  }, [breakpoint]);
  return /*#__PURE__*/React__default__default.createElement(MediaQueryContext.Provider, {
    value: {
      breakpoint,
      isMobile
    }
  }, children);
};

const useMediaQueryContext = () => React__default__default.useContext(MediaQueryContext);

const ModalHeader = _ref => {
  let {
    titleText
  } = _ref;
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-modal__header"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    type: LabelTypography.H_1,
    color: LabelColors.ONBACKGROUND_1
  }, titleText));
};

const ModalBody = _ref2 => {
  let {
    children
  } = _ref2;
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-modal__body"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    type: LabelTypography.SUBTITLE_1,
    color: LabelColors.ONBACKGROUND_2
  }, children));
};

const ModalFooter = _ref3 => {
  let {
    submitText,
    disabled = false,
    type = ButtonTypes.DANGER,
    onSubmit,
    onCancel
  } = _ref3;
  const {
    stringSet
  } = useContext(LocalizationContext);
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-modal__footer"
  }, /*#__PURE__*/React__default__default.createElement(Button, {
    type: ButtonTypes.SECONDARY,
    onClick: onCancel
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    type: LabelTypography.BUTTON_1,
    color: LabelColors.ONBACKGROUND_1
  }, stringSet.BUTTON__CANCEL)), /*#__PURE__*/React__default__default.createElement(Button, {
    type: type,
    disabled: disabled,
    onClick: onSubmit
  }, submitText));
};

function Modal(props) {
  const {
    children = null,
    className = '',
    isCloseOnClickOutside = false,
    isFullScreenOnMobile = false,
    titleText,
    submitText,
    disabled = false,
    hideFooter = false,
    type = ButtonTypes.DANGER,
    onCancel = () => {
      /* noop */
    },
    onSubmit = () => {
      /* noop */
    },
    renderHeader
  } = props;
  const {
    isMobile
  } = useMediaQueryContext();
  return /*#__PURE__*/createPortal( /*#__PURE__*/React__default__default.createElement("div", {
    className: `
      sendbird-modal ${className}
      ${isFullScreenOnMobile && isMobile ? 'sendbird-modal--full-mobile' : ''}
    `
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-modal__content"
  }, (renderHeader === null || renderHeader === void 0 ? void 0 : renderHeader()) || /*#__PURE__*/React__default__default.createElement(ModalHeader, {
    titleText: titleText
  }), /*#__PURE__*/React__default__default.createElement(ModalBody, null, children), !hideFooter && /*#__PURE__*/React__default__default.createElement(ModalFooter, {
    disabled: disabled,
    onCancel: onCancel,
    onSubmit: onSubmit,
    submitText: submitText,
    type: type
  }), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-modal__close"
  }, /*#__PURE__*/React__default__default.createElement(IconButton, {
    width: "32px",
    height: "32px",
    onClick: onCancel
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    type: IconTypes.CLOSE,
    fillColor: IconColors.DEFAULT,
    width: "24px",
    height: "24px"
  })))), /*#__PURE__*/React__default__default.createElement("div", {
    className: `
          sendbird-modal__backdrop
          ${isCloseOnClickOutside && 'sendbird-modal__backdrop--clickoutside'}
        `,
    onClick: e => {
      e === null || e === void 0 ? void 0 : e.stopPropagation();

      if (isCloseOnClickOutside) {
        onCancel();
      }
    }
  })), document.getElementById(MODAL_ROOT));
}

// Output of VoiceRecorder

const noop$3 = () => {
  /* noop */
};

const Context$1 = /*#__PURE__*/createContext({
  start: noop$3,
  stop: noop$3,
  isRecordable: false
});

const VoiceRecorderProvider = props => {
  var _BROWSER_SUPPORT_MIME;

  const {
    children
  } = props;
  const {
    config
  } = useSendbirdStateContext();
  const {
    logger,
    isVoiceMessageEnabled
  } = config;
  const [mediaRecorder, setMediaRecorder] = useState(null);
  const [isRecordable, setIsRecordable] = useState(false);
  const [permissionWarning, setPermissionWarning] = useState(false);
  const {
    stringSet
  } = useLocalization();

  const checkPermission = () => {
    try {
      // Type '"microphone"' is not assignable to type 'PermissionName'.ts(2322)
      // this is typescript issue
      // https://github.com/microsoft/TypeScript/issues/33923
      // @ts-expect-error
      navigator.permissions.query({
        name: 'microphone'
      }).then(result => {
        if (result.state === 'denied') {
          logger.warning('VoiceRecorder: Permission denied.');
          setPermissionWarning(true);
        }
      });
    } catch (error) {
      logger.warning('VoiceRecorder: Failed to check permission.', error);
    }
  };

  const browserSupportMimeType = (_BROWSER_SUPPORT_MIME = BROWSER_SUPPORT_MIME_TYPE_LIST.find(mimeType => MediaRecorder.isTypeSupported(mimeType))) !== null && _BROWSER_SUPPORT_MIME !== void 0 ? _BROWSER_SUPPORT_MIME : '';

  if (!browserSupportMimeType) {
    logger.error('VoiceRecorder: Browser does not support mimeType', {
      mimmeTypes: BROWSER_SUPPORT_MIME_TYPE_LIST
    });
  }

  const [webAudioUtils, setWebAudioUtils] = useState(null);
  useEffect(() => {
    if (isVoiceMessageEnabled && !webAudioUtils) {
      Promise.resolve().then(function () { return WebAudioUtils97e524fa; }).then(data => {
        setWebAudioUtils(data);
      });
    }
  }, []);
  const start = useCallback(eventHandler => {
    var _navigator, _navigator$mediaDevic, _navigator$mediaDevic2;

    if (isVoiceMessageEnabled && !webAudioUtils) {
      logger.error('VoiceRecorder: Recording audio processor is being loaded.');
      return;
    }

    logger.info('VoiceRecorder: Start recording.');

    if (mediaRecorder) {
      stop();
      logger.info('VoiceRecorder: Previous mediaRecorder is stopped.');
    }

    checkPermission();
    (_navigator = navigator) === null || _navigator === void 0 ? void 0 : (_navigator$mediaDevic = _navigator.mediaDevices) === null || _navigator$mediaDevic === void 0 ? void 0 : (_navigator$mediaDevic2 = _navigator$mediaDevic.getUserMedia) === null || _navigator$mediaDevic2 === void 0 ? void 0 : _navigator$mediaDevic2.call(_navigator$mediaDevic, {
      audio: true
    }).then(stream => {
      logger.info('VoiceRecorder: Succeeded getting media stream.', stream);
      setIsRecordable(true);
      const mediaRecorder = new MediaRecorder(stream, {
        mimeType: browserSupportMimeType,
        audioBitsPerSecond: VOICE_RECORDER_AUDIO_BIT_RATE
      });

      mediaRecorder.ondataavailable = e => {
        var _stream$getAudioTrack, _stream$getAudioTrack2, _stream$getAudioTrack3; // when recording stops


        logger.info('VoiceRecorder: Succeeded getting an available data.', e.data);
        const audioFile = new File([e.data], VOICE_MESSAGE_FILE_NAME, {
          lastModified: new Date().getTime(),
          type: VOICE_MESSAGE_MIME_TYPE
        });
        webAudioUtils === null || webAudioUtils === void 0 ? void 0 : webAudioUtils.downsampleToWav(audioFile, buffer => {
          const mp3Buffer = webAudioUtils === null || webAudioUtils === void 0 ? void 0 : webAudioUtils.encodeMp3(buffer);
          const mp3blob = new Blob(mp3Buffer, {
            type: VOICE_MESSAGE_MIME_TYPE
          });
          const convertedAudioFile = new File([mp3blob], VOICE_MESSAGE_FILE_NAME, {
            lastModified: new Date().getTime(),
            type: VOICE_MESSAGE_MIME_TYPE
          });
          eventHandler === null || eventHandler === void 0 ? void 0 : eventHandler.onRecordingEnded(convertedAudioFile);
          logger.info('VoiceRecorder: Succeeded converting audio file.', convertedAudioFile);
        });
        stream === null || stream === void 0 ? void 0 : (_stream$getAudioTrack = stream.getAudioTracks) === null || _stream$getAudioTrack === void 0 ? void 0 : (_stream$getAudioTrack2 = (_stream$getAudioTrack3 = _stream$getAudioTrack.call(stream)).forEach) === null || _stream$getAudioTrack2 === void 0 ? void 0 : _stream$getAudioTrack2.call(_stream$getAudioTrack3, track => track === null || track === void 0 ? void 0 : track.stop());
        setIsRecordable(false);
      };

      mediaRecorder === null || mediaRecorder === void 0 ? void 0 : mediaRecorder.start();
      setMediaRecorder(mediaRecorder);
      eventHandler === null || eventHandler === void 0 ? void 0 : eventHandler.onRecordingStarted();
    }).catch(err => {
      logger.error('VoiceRecorder: Failed getting media stream.', err);
      setMediaRecorder(null);
    });
  }, [mediaRecorder, webAudioUtils]);
  const stop = useCallback(() => {
    // Stop recording
    mediaRecorder === null || mediaRecorder === void 0 ? void 0 : mediaRecorder.stop();
    setMediaRecorder(null);
    setIsRecordable(false);
    logger.info('VoiceRecorder: Stop recording.');
  }, [mediaRecorder]);
  return /*#__PURE__*/React__default__default.createElement(Context$1.Provider, {
    value: {
      start,
      stop,
      isRecordable
    }
  }, children, permissionWarning && /*#__PURE__*/React__default__default.createElement(Modal, {
    hideFooter: true,
    onCancel: () => setPermissionWarning(false)
  }, /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, stringSet.VOICE_RECORDING_PERMISSION_DENIED)));
};

/**
 * Dashboard UIKitConfig's replyType is consisted of all lowercases,
 * we need to convert it into uppercase ones(or vice versa)
 * when we pass the value to internal components
 *  - 'thread' <-> 'THREAD'
 *  - 'quote_reply' <-> 'QUOTE_REPLY'
 */
function getCaseResolvedReplyType(replyType) {
  return {
    lowerCase: replyType.toLowerCase(),
    upperCase: replyType.toUpperCase()
  };
}
/**
 * Dashboard UIKitConfig's threadReplySelectType is consisted of all lowercase letters,
 * we need to convert it into uppercase ones(or vice versa)
 * when we pass the value to internal components
 *  - 'thread' <-> 'THREAD'
 *  - 'parent' <-> 'PARENT'
 */


function getCaseResolvedThreadReplySelectType(threadReplySelectType) {
  return {
    lowerCase: threadReplySelectType.toLowerCase(),
    upperCase: threadReplySelectType.toUpperCase()
  };
}

const isEmpty$1 = obj => {
  if (obj === null || obj === undefined) {
    return true;
  }

  for (const prop in obj) {
    if (obj.hasOwnProperty(prop)) {
      return false;
    }
  }

  return JSON.stringify(obj) === JSON.stringify({});
};

const useTheme = overrides => {
  useLayoutEffect(() => {
    if (!isEmpty$1(overrides)) {
      cssVars({
        variables: _objectSpread2(_objectSpread2({}, {
          '--sendbird-dark-primary-500': '#4d2aa6',
          '--sendbird-dark-primary-400': '#6440C4',
          '--sendbird-dark-primary-300': '#7B53EF',
          '--sendbird-dark-primary-200': '#9E8CF5',
          '--sendbird-dark-primary-100': '#E2DFFF',
          '--sendbird-dark-secondary-500': '#007A7A',
          '--sendbird-dark-secondary-400': '#189A8D',
          '--sendbird-dark-secondary-300': '#2EBA9F',
          '--sendbird-dark-secondary-200': '#6FD6BE',
          '--sendbird-dark-secondary-100': '#AEF2DC',
          '--sendbird-dark-information-100': '#b2d9ff',
          '--sendbird-dark-error-500': '#A30E2D',
          '--sendbird-dark-error-400': '#C11F41',
          '--sendbird-dark-error-300': '#E53157',
          '--sendbird-dark-error-200': '#FF6183',
          '--sendbird-dark-error-100': '#FFABBD',
          '--sendbird-dark-background-700': '#000000',
          '--sendbird-dark-background-600': '#161616',
          '--sendbird-dark-background-500': '#2C2C2C',
          '--sendbird-dark-background-400': '#393939',
          '--sendbird-dark-background-300': '#A8A8A8',
          '--sendbird-dark-background-200': '#D9D9D9',
          '--sendbird-dark-background-100': '#F0F0F0',
          '--sendbird-dark-background-50': '#FFFFFF',
          '--sendbird-dark-overlay': 'rgba(0, 0, 0, 0.32)',
          '--sendbird-dark-onlight-01': 'rgba(0, 0, 0, 0.88)',
          '--sendbird-dark-onlight-02': 'rgba(0, 0, 0, 0.50)',
          '--sendbird-dark-onlight-03': 'rgba(0, 0, 0, 0.38)',
          '--sendbird-dark-onlight-04': 'rgba(0, 0, 0, 0.12)',
          '--sendbird-dark-ondark-01': 'rgba(255, 255, 255, 0.88)',
          '--sendbird-dark-ondark-02': 'rgba(255, 255, 255, 0.50)',
          '--sendbird-dark-ondark-03': 'rgba(255, 255, 255, 0.38)',
          '--sendbird-dark-ondark-04': 'rgba(255, 255, 255, 0.12)',
          '--sendbird-dark-shadow-01': '0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12)',
          '--sendbird-dark-shadow-02': '0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12)',
          '--sendbird-dark-shadow-03': '0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12)',
          '--sendbird-dark-shadow-04': '0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12)',
          '--sendbird-dark-shadow-message-input': '0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12)',
          '--sendbird-light-primary-500': '#4d2aa6',
          '--sendbird-light-primary-400': '#6440C4',
          '--sendbird-light-primary-300': '#7B53EF',
          '--sendbird-light-primary-200': '#9E8CF5',
          '--sendbird-light-primary-100': '#E2DFFF',
          '--sendbird-light-secondary-500': '#007A7A',
          '--sendbird-light-secondary-400': '#189A8D',
          '--sendbird-light-secondary-300': '#2EBA9F',
          '--sendbird-light-secondary-200': '#6FD6BE',
          '--sendbird-light-secondary-100': '#AEF2DC',
          '--sendbird-light-information-100': '#b2d9ff',
          '--sendbird-light-error-500': '#A30E2D',
          '--sendbird-light-error-400': '#C11F41',
          '--sendbird-light-error-300': '#E53157',
          '--sendbird-light-error-200': '#FF6183',
          '--sendbird-light-error-100': '#FFABBD',
          '--sendbird-light-background-700': '#000000',
          '--sendbird-light-background-600': '#161616',
          '--sendbird-light-background-500': '#2C2C2C',
          '--sendbird-light-background-400': '#393939',
          '--sendbird-light-background-300': '#A8A8A8',
          '--sendbird-light-background-200': '#D9D9D9',
          '--sendbird-light-background-100': '#F0F0F0',
          '--sendbird-light-background-50': ' #FFFFFF',
          '--sendbird-light-overlay': 'rgba(0, 0, 0, 0.32)',
          '--sendbird-light-onlight-01': 'rgba(0, 0, 0, 0.88)',
          '--sendbird-light-onlight-02': 'rgba(0, 0, 0, 0.50)',
          '--sendbird-light-onlight-03': 'rgba(0, 0, 0, 0.38)',
          '--sendbird-light-onlight-04': 'rgba(0, 0, 0, 0.12)',
          '--sendbird-light-ondark-01': 'rgba(255, 255, 255, 0.88)',
          '--sendbird-light-ondark-02': 'rgba(255, 255, 255, 0.50)',
          '--sendbird-light-ondark-03': 'rgba(255, 255, 255, 0.38)',
          '--sendbird-light-ondark-04': 'rgba(255, 255, 255, 0.12)',
          '--sendbird-light-shadow-01': '0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12)',
          '--sendbird-light-shadow-02': '0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12)',
          '--sendbird-light-shadow-03': '0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12)',
          '--sendbird-light-shadow-04': '0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12)',
          '--sendbird-light-shadow-message-input': '0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12)'
        }), overrides)
      });
    }
  }, [overrides]);
};

const SDK_ACTIONS = {
  INIT_SDK: 'INIT_SDK',
  SET_SDK_LOADING: 'SET_SDK_LOADING',
  RESET_SDK: 'RESET_SDK',
  SDK_ERROR: 'SDK_ERROR'
};
const initialState$1 = {
  initialized: false,
  loading: false,
  sdk: {},
  error: false
};

function reducer$1(state, action) {
  return K$1(action).with({
    type: SDK_ACTIONS.SET_SDK_LOADING
  }, _ref => {
    let {
      payload
    } = _ref;
    return _objectSpread2(_objectSpread2({}, state), {}, {
      initialized: false,
      loading: payload
    });
  }).with({
    type: SDK_ACTIONS.SDK_ERROR
  }, () => {
    return _objectSpread2(_objectSpread2({}, state), {}, {
      initialized: false,
      loading: false,
      error: true
    });
  }).with({
    type: SDK_ACTIONS.INIT_SDK
  }, _ref2 => {
    let {
      payload
    } = _ref2;
    return {
      sdk: payload,
      initialized: true,
      loading: false,
      error: false
    };
  }).with({
    type: SDK_ACTIONS.RESET_SDK
  }, () => {
    return initialState$1;
  }).otherwise(() => {
    return state;
  });
}

const initialState$2 = {
  initialized: false,
  loading: false,
  user: {}
};

function reducer$2(state, action) {
  return K$1(action).with({
    type: USER_ACTIONS.INIT_USER
  }, _ref => {
    let {
      payload
    } = _ref;
    return {
      initialized: true,
      loading: false,
      user: payload
    };
  }).with({
    type: USER_ACTIONS.RESET_USER
  }, () => {
    return initialState$2;
  }).with({
    type: USER_ACTIONS.UPDATE_USER_INFO
  }, _ref2 => {
    let {
      payload
    } = _ref2;
    return _objectSpread2(_objectSpread2({}, state), {}, {
      user: payload
    });
  }).otherwise(() => {
    return state;
  });
}

function useConnectionStatus(sdk, logger) {
  const [isOnline, setIsOnline] = useState(true);
  useEffect(() => {
    const uniqueHandlerId = uuidv4();

    try {
      logger.warning('sdk changed', uniqueHandlerId);
      const handler = new Tr();

      handler.onDisconnected = () => {
        setIsOnline(false);
        logger.warning('onDisconnected', {
          isOnline
        });
      };

      handler.onReconnectStarted = () => {
        setIsOnline(false);
        logger.warning('onReconnectStarted', {
          isOnline
        });
      };

      handler.onReconnectSucceeded = () => {
        setIsOnline(true);
        logger.warning('onReconnectSucceeded', {
          isOnline
        });
      };

      handler.onReconnectFailed = () => {
        sdk.reconnect();
        logger.warning('onReconnectFailed');
      };

      logger.info('Added ConnectionHandler', uniqueHandlerId); // workaround -> addConnectionHandler invalidates session handler
      // provided through configureSession

      if (sdk !== null && sdk !== void 0 && sdk.addConnectionHandler) {
        sdk.addConnectionHandler(uniqueHandlerId, handler);
      }
    } catch (_unused) {//
    }

    return () => {
      try {
        sdk.removeConnectionHandler(uniqueHandlerId);
        logger.info('Removed ConnectionHandler', uniqueHandlerId);
      } catch (_unused2) {//
      }
    };
  }, [sdk]);
  useEffect(() => {
    const tryReconnect = () => {
      try {
        logger.warning('Try reconnecting SDK');

        if (sdk.connectionState !== 'OPEN') {
          // connection is not broken yet
          sdk.reconnect();
        }
      } catch (_unused3) {//
      }
    }; // addEventListener version


    window.addEventListener('online', tryReconnect);
    return () => {
      window.removeEventListener('online', tryReconnect);
    };
  }, [sdk]); // add offline-class to body

  useEffect(() => {
    const body = document.querySelector('body');

    if (!isOnline) {
      try {
        body.classList.add('sendbird__offline');
        logger.info('Added class sendbird__offline to body');
      } catch (e) {//
      }
    } else {
      try {
        body.classList.remove('sendbird__offline');
        logger.info('Removed class sendbird__offline from body');
      } catch (e) {//
      }
    }
  }, [isOnline]);
  return isOnline;
}

async function disconnectSdk(_ref) {
  let {
    sdkDispatcher,
    userDispatcher,
    sdk
  } = _ref;
  return new Promise(resolve => {
    sdkDispatcher({
      type: SDK_ACTIONS.SET_SDK_LOADING,
      payload: true
    });

    if (sdk !== null && sdk !== void 0 && sdk.disconnect) {
      sdk.disconnect().then(() => {
        sdkDispatcher({
          type: SDK_ACTIONS.RESET_SDK
        });
        userDispatcher({
          type: USER_ACTIONS.RESET_USER
        });
      }).finally(() => {
        resolve(true);
      });
    } else {
      resolve(true);
    }
  });
}

const APP_VERSION_STRING = '3.6.6';
const {
  INIT_SDK,
  SET_SDK_LOADING,
  RESET_SDK,
  SDK_ERROR
} = SDK_ACTIONS;
const {
  INIT_USER,
  UPDATE_USER_INFO,
  RESET_USER
} = USER_ACTIONS;

function getMissingParamError(_ref) {
  let {
    userId,
    appId
  } = _ref;
  return `SendbirdProvider | useConnect/setupConnection/Connection failed UserId: ${userId} or appId: ${appId} missing`;
}

function getConnectSbError(error) {
  return `SendbirdProvider | useConnect/setupConnection/Connection failed. ${(error === null || error === void 0 ? void 0 : error.code) || ''} ${(error === null || error === void 0 ? void 0 : error.message) || ''}`;
}

function setUpParams(_ref2) {
  let {
    appId,
    customApiHost,
    customWebSocketHost,
    sdkInitParams
  } = _ref2;

  const params = _objectSpread2(_objectSpread2({
    modules: [new Xe(), new Ie$1()],
    newInstance: true
  }, sdkInitParams !== null && sdkInitParams !== void 0 ? sdkInitParams : {}), {}, {
    // appId shouldn't be overrided
    appId
  });

  if (customApiHost) {
    params['customApiHost'] = customApiHost;
  }

  if (customWebSocketHost) {
    params['customWebSocketHost'] = customWebSocketHost;
  }

  const newSdk = hn$1.init(params);
  return newSdk;
} // Steps
// 1. Check if minimum userID/appID is provided
//  1.a. If not, throw error > !reject
//  1.b. If yes, continue
// 2. Set up params with custom host if provided
// 3. Set up session handler if provided
// 4. Set up version
// 5. Connect to Sendbird -> either using user ID or (user ID + access token)
// 6. If connected, connectCbSucess
//  6.a check if nickname is to be updated -> no > !resolve immediately
//  6.b check if nickname is to be updated -> yes > update nickname > !resolve
// 7. If not connected, connectCbError > !reject


async function setUpConnection(_ref3) {
  let {
    logger,
    sdkDispatcher,
    userDispatcher,
    initDashboardConfigs,
    userId,
    appId,
    customApiHost,
    customWebSocketHost,
    configureSession,
    nickname,
    profileUrl,
    accessToken,
    isUserIdUsedForNickname,
    sdkInitParams,
    customExtensionParams,
    isMobile = false
  } = _ref3;
  return new Promise((resolve, reject) => {
    var _logger$info;

    logger === null || logger === void 0 ? void 0 : (_logger$info = logger.info) === null || _logger$info === void 0 ? void 0 : _logger$info.call(logger, 'SendbirdProvider | useConnect/setupConnection/init', {
      userId,
      appId
    });
    sdkDispatcher({
      type: SET_SDK_LOADING,
      payload: true
    });

    if (userId && appId) {
      var _logger$info3, _newSdk$addSendbirdEx, _SendbirdProduct$UIKI, _SendbirdPlatform$JS, _DeviceOsPlatform$MOB, _DeviceOsPlatform$WEB, _logger$info8;

      const newSdk = setUpParams({
        appId,
        customApiHost,
        customWebSocketHost,
        sdkInitParams
      });

      if (configureSession && typeof configureSession === 'function') {
        var _logger$info2;

        const sessionHandler = configureSession(newSdk);
        logger === null || logger === void 0 ? void 0 : (_logger$info2 = logger.info) === null || _logger$info2 === void 0 ? void 0 : _logger$info2.call(logger, 'SendbirdProvider | useConnect/setupConnection/configureSession', sessionHandler);
        newSdk.setSessionHandler(sessionHandler);
      }

      logger === null || logger === void 0 ? void 0 : (_logger$info3 = logger.info) === null || _logger$info3 === void 0 ? void 0 : _logger$info3.call(logger, 'SendbirdProvider | useConnect/setupConnection/setVersion', {
        version: APP_VERSION_STRING
      });
      /**
       * Keep optional chaining to the addSendbirdExtensions
       * for supporting the ChatSDK v4.9.5 or less
       */

      newSdk === null || newSdk === void 0 ? void 0 : (_newSdk$addSendbirdEx = newSdk.addSendbirdExtensions) === null || _newSdk$addSendbirdEx === void 0 ? void 0 : _newSdk$addSendbirdEx.call(newSdk, [{
        product: (_SendbirdProduct$UIKI = ke$1 === null || ke$1 === void 0 ? void 0 : ke$1.UIKIT_CHAT) !== null && _SendbirdProduct$UIKI !== void 0 ? _SendbirdProduct$UIKI : 'uikit-chat',
        version: APP_VERSION_STRING,
        platform: (_SendbirdPlatform$JS = Oe$3 === null || Oe$3 === void 0 ? void 0 : Oe$3.JS) !== null && _SendbirdPlatform$JS !== void 0 ? _SendbirdPlatform$JS : 'js'
      }], isMobile ? (_DeviceOsPlatform$MOB = Ie$2 === null || Ie$2 === void 0 ? void 0 : Ie$2.MOBILE_WEB) !== null && _DeviceOsPlatform$MOB !== void 0 ? _DeviceOsPlatform$MOB : 'mobile_web' : (_DeviceOsPlatform$WEB = Ie$2 === null || Ie$2 === void 0 ? void 0 : Ie$2.WEB) !== null && _DeviceOsPlatform$WEB !== void 0 ? _DeviceOsPlatform$WEB : 'web', customExtensionParams);
      newSdk.addExtension('sb_uikit', APP_VERSION_STRING);

      const connectCbSucess = async user => {
        var _logger$info4;

        logger === null || logger === void 0 ? void 0 : (_logger$info4 = logger.info) === null || _logger$info4 === void 0 ? void 0 : _logger$info4.call(logger, 'SendbirdProvider | useConnect/setupConnection/connectCbSucess', user);
        sdkDispatcher({
          type: INIT_SDK,
          payload: newSdk
        });
        userDispatcher({
          type: INIT_USER,
          payload: user
        });
        initDashboardConfigs(newSdk).then(config => {
          var _logger$info5;

          logger === null || logger === void 0 ? void 0 : (_logger$info5 = logger.info) === null || _logger$info5 === void 0 ? void 0 : _logger$info5.call(logger, 'SendbirdProvider | useConnect/setupConnection/getUIKitConfiguration success', {
            config
          });
        }).catch(error => {
          var _logger$error;

          logger === null || logger === void 0 ? void 0 : (_logger$error = logger.error) === null || _logger$error === void 0 ? void 0 : _logger$error.call(logger, 'SendbirdProvider | useConnect/setupConnection/getUIKitConfiguration failed', {
            error
          });
        }); // use nickname/profileUrl if provided
        // or set userID as nickname

        if ((nickname !== user.nickname || profileUrl !== user.profileUrl) && !(isTextuallyNull(nickname) && isTextuallyNull(profileUrl))) {
          var _logger$info6;

          logger === null || logger === void 0 ? void 0 : (_logger$info6 = logger.info) === null || _logger$info6 === void 0 ? void 0 : _logger$info6.call(logger, 'SendbirdProvider | useConnect/setupConnection/updateCurrentUserInfo', {
            nickname,
            profileUrl
          });
          newSdk.updateCurrentUserInfo({
            nickname: nickname || user.nickname || (isUserIdUsedForNickname ? user.userId : ''),
            profileUrl: profileUrl || user.profileUrl
          }).then(namedUser => {
            var _logger$info7;

            logger === null || logger === void 0 ? void 0 : (_logger$info7 = logger.info) === null || _logger$info7 === void 0 ? void 0 : _logger$info7.call(logger, 'SendbirdProvider | useConnect/setupConnection/updateCurrentUserInfo success', {
              nickname,
              profileUrl
            });
            userDispatcher({
              type: UPDATE_USER_INFO,
              payload: namedUser
            });
          }).finally(() => {
            resolve();
          });
        } else {
          resolve();
        }
      };

      const connectCbError = e => {
        var _logger$error2;

        const errorMessage = getConnectSbError(e);
        logger === null || logger === void 0 ? void 0 : (_logger$error2 = logger.error) === null || _logger$error2 === void 0 ? void 0 : _logger$error2.call(logger, errorMessage, {
          e,
          appId,
          userId
        });
        sdkDispatcher({
          type: RESET_SDK
        });
        userDispatcher({
          type: RESET_USER
        });
        sdkDispatcher({
          type: SDK_ERROR
        }); // exit promise with error

        reject(errorMessage);
      };

      logger === null || logger === void 0 ? void 0 : (_logger$info8 = logger.info) === null || _logger$info8 === void 0 ? void 0 : _logger$info8.call(logger, `SendbirdProvider | useConnect/setupConnection/connect connecting using ${accessToken !== null && accessToken !== void 0 ? accessToken : userId}`);
      newSdk.connect(userId, accessToken).then(res => connectCbSucess(res)).catch(err => connectCbError(err));
    } else {
      var _logger$error3;

      const errorMessage = getMissingParamError({
        userId,
        appId
      });
      sdkDispatcher({
        type: SDK_ERROR
      });
      logger === null || logger === void 0 ? void 0 : (_logger$error3 = logger.error) === null || _logger$error3 === void 0 ? void 0 : _logger$error3.call(logger, errorMessage); // exit promise with error

      reject(errorMessage);
    }
  });
}

async function connect(_ref) {
  let {
    logger,
    sdkDispatcher,
    userDispatcher,
    initDashboardConfigs,
    userId,
    appId,
    customApiHost,
    customWebSocketHost,
    configureSession,
    nickname,
    profileUrl,
    accessToken,
    sdk,
    sdkInitParams,
    customExtensionParams,
    isMobile
  } = _ref;
  await disconnectSdk({
    logger,
    sdkDispatcher,
    userDispatcher,
    sdk
  });
  await setUpConnection({
    logger,
    sdkDispatcher,
    userDispatcher,
    initDashboardConfigs,
    userId,
    appId,
    customApiHost,
    customWebSocketHost,
    configureSession,
    nickname,
    profileUrl,
    accessToken,
    sdkInitParams,
    customExtensionParams,
    isMobile
  });
}

function useConnect(triggerTypes, staticTypes) {
  var _logger$info;

  const {
    userId,
    appId,
    accessToken,
    isMobile,
    isUserIdUsedForNickname
  } = triggerTypes;
  const {
    logger,
    nickname,
    profileUrl,
    configureSession,
    customApiHost,
    customWebSocketHost,
    sdk,
    sdkDispatcher,
    userDispatcher,
    initDashboardConfigs,
    sdkInitParams,
    customExtensionParams
  } = staticTypes;
  logger === null || logger === void 0 ? void 0 : (_logger$info = logger.info) === null || _logger$info === void 0 ? void 0 : _logger$info.call(logger, 'SendbirdProvider | useConnect', _objectSpread2(_objectSpread2({}, triggerTypes), staticTypes));
  useEffect(() => {
    var _logger$info2;

    logger === null || logger === void 0 ? void 0 : (_logger$info2 = logger.info) === null || _logger$info2 === void 0 ? void 0 : _logger$info2.call(logger, 'SendbirdProvider | useConnect/useEffect', {
      userId,
      appId,
      accessToken
    });

    try {
      connect({
        userId,
        appId,
        accessToken,
        logger,
        nickname,
        profileUrl,
        configureSession,
        customApiHost,
        customWebSocketHost,
        sdk,
        sdkDispatcher,
        userDispatcher,
        initDashboardConfigs,
        isUserIdUsedForNickname,
        sdkInitParams,
        customExtensionParams,
        isMobile
      });
    } catch (error) {
      var _logger$error;

      logger === null || logger === void 0 ? void 0 : (_logger$error = logger.error) === null || _logger$error === void 0 ? void 0 : _logger$error.call(logger, 'SendbirdProvider | useConnect/useEffect', error);
    }
  }, [userId, appId, accessToken]);
  const reconnect = useCallback(() => {
    var _logger$info3;

    logger === null || logger === void 0 ? void 0 : (_logger$info3 = logger.info) === null || _logger$info3 === void 0 ? void 0 : _logger$info3.call(logger, 'SendbirdProvider | useConnect/reconnect/useCallback', {
      sdk
    });

    try {
      connect({
        userId,
        appId,
        accessToken,
        logger,
        nickname,
        profileUrl,
        configureSession,
        customApiHost,
        customWebSocketHost,
        sdk,
        sdkDispatcher,
        userDispatcher,
        initDashboardConfigs,
        isUserIdUsedForNickname,
        sdkInitParams,
        customExtensionParams,
        isMobile
      });
    } catch (error) {
      var _logger$error2;

      logger === null || logger === void 0 ? void 0 : (_logger$error2 = logger.error) === null || _logger$error2 === void 0 ? void 0 : _logger$error2.call(logger, 'SendbirdProvider | useConnect/reconnect/useCallback', error);
    }
  }, [sdk]);
  return reconnect;
} // Logger, pretty much explains it
// in SendbirdProvider
// const [logger, setLogger] = useState(LoggerFactory(logLevel));


const LOG_LEVELS = {
  DEBUG: 'debug',
  WARNING: 'warning',
  ERROR: 'error',
  INFO: 'info',
  ALL: 'all'
};

const colorLog = level => {
  switch (level) {
    case LOG_LEVELS.WARNING:
      return 'color: Orange';

    case LOG_LEVELS.ERROR:
      return 'color: Red';

    default:
      return 'color: Gray';
  }
};

const printLog = _ref => {
  let {
    level,
    title,
    description = ''
  } = _ref; // eslint-disable-next-line no-console

  console.log(`%c SendbirdUIKit | ${level} | ${new Date().toISOString()} | ${title} ${description && '|'}`, colorLog(level), description);
};

const noop$2 = () => {
  /* noop */
};

const getDefaultLogger = () => ({
  info: noop$2,
  error: noop$2,
  warning: noop$2
});

const LoggerFactory = (lvl, customInterface) => {
  const logInterface = customInterface || printLog;
  const lvlArray = Array.isArray(lvl) ? lvl : [lvl];

  const applyLog = lgLvl => (title, description) => logInterface({
    level: lgLvl,
    title,
    description
  });

  const logger = lvlArray.reduce((accumulator, currentLvl) => {
    if (currentLvl === LOG_LEVELS.DEBUG || currentLvl === LOG_LEVELS.ALL) {
      return _objectSpread2(_objectSpread2({}, accumulator), {}, {
        info: applyLog(LOG_LEVELS.INFO),
        error: applyLog(LOG_LEVELS.ERROR),
        warning: applyLog(LOG_LEVELS.WARNING)
      });
    }

    if (currentLvl === LOG_LEVELS.INFO) {
      return _objectSpread2(_objectSpread2({}, accumulator), {}, {
        info: applyLog(LOG_LEVELS.INFO)
      });
    }

    if (currentLvl === LOG_LEVELS.ERROR) {
      return _objectSpread2(_objectSpread2({}, accumulator), {}, {
        error: applyLog(LOG_LEVELS.ERROR)
      });
    }

    if (currentLvl === LOG_LEVELS.WARNING) {
      return _objectSpread2(_objectSpread2({}, accumulator), {}, {
        warning: applyLog(LOG_LEVELS.WARNING)
      });
    }

    return _objectSpread2({}, accumulator);
  }, getDefaultLogger());
  return logger;
}; // TODO: Make this to hook, useLogger
// https://davidwalsh.name/pubsub-javascript
// we use pubsub to sync events between multiple components(example - ChannelList, Channel)
// for example, if customer sends a message from their custom component
// without pubsub,we would not be able to listen to it
// in our ChannelList or Conversation


const pubSubFactory = () => {
  const topics = {};
  const hOP = topics.hasOwnProperty;
  return {
    __getTopics: () => topics,
    subscribe: (topic, listener) => {
      // Create the topic's object if not yet created
      if (!hOP.call(topics, topic)) {
        topics[topic] = [];
      } // Add the listener to queue


      const index = topics[topic].push(listener) - 1; // Provide handle back for removal of topic

      return {
        remove: () => {
          delete topics[topic][index];
        }
      };
    },
    publish: (topic, info) => {
      // If the topic doesn't exist, or there's no listeners in queue, just leave
      if (!hOP.call(topics, topic)) {
        return;
      } // Cycle through topics queue, fire!


      topics[topic].forEach(item => {
        item(info !== undefined ? info : {});
      });
    }
  };
};
/* eslint-disable default-param-last */


function useAppendDomNode() {
  let ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  let rootSelector = arguments.length > 1 ? arguments[1] : undefined;
  useEffect(() => {
    const root = document.querySelector(rootSelector);
    ids.forEach(id => {
      const elem = document.createElement('div');
      elem.setAttribute('id', id);
      root.appendChild(elem);
    });
    return () => {
      ids.forEach(id => {
        const target = document.getElementById(id);

        if (target) {
          root.removeChild(target);
        }
      });
    };
  }, []);
}

const VoiceMessageProvider = _ref => {
  let {
    children,
    isVoiceMessageEnabled = true
  } = _ref;

  if (!isVoiceMessageEnabled) {
    return /*#__PURE__*/React__default__default.createElement(VoicePlayerProvider, null, children);
  }

  return /*#__PURE__*/React__default__default.createElement(VoiceRecorderProvider, null, /*#__PURE__*/React__default__default.createElement(VoicePlayerProvider, null, children));
};

function uikitConfigMapper(_ref) {
  var _uikitOptions$common$, _uikitOptions$common, _uikitOptions$groupCh, _uikitOptions$groupCh2, _uikitOptions$groupCh3, _uikitOptions$groupCh4, _uikitOptions$groupCh5, _uikitOptions$groupCh6, _uikitOptions$groupCh7, _uikitOptions$groupCh8, _uikitOptions$groupCh9, _uikitOptions$groupCh10, _uikitOptions$groupCh11, _uikitOptions$groupCh12, _uikitOptions$groupCh13, _uikitOptions$groupCh14, _uikitOptions$groupCh15, _uikitOptions$groupCh16, _uikitOptions$groupCh17, _uikitOptions$groupCh18, _uikitOptions$groupCh19, _uikitOptions$openCha, _uikitOptions$openCha2, _uikitOptions$openCha3;

  let {
    legacyConfig,
    uikitOptions = {}
  } = _ref;
  const {
    replyType,
    isMentionEnabled,
    isReactionEnabled,
    disableUserProfile,
    isVoiceMessageEnabled,
    isTypingIndicatorEnabledOnChannelList,
    isMessageReceiptStatusEnabledOnChannelList,
    showSearchIcon
  } = legacyConfig;
  return {
    common: {
      enableUsingDefaultUserProfile: (_uikitOptions$common$ = (_uikitOptions$common = uikitOptions.common) === null || _uikitOptions$common === void 0 ? void 0 : _uikitOptions$common.enableUsingDefaultUserProfile) !== null && _uikitOptions$common$ !== void 0 ? _uikitOptions$common$ : typeof disableUserProfile === 'boolean' ? !disableUserProfile : undefined
    },
    groupChannel: {
      enableOgtag: (_uikitOptions$groupCh = uikitOptions.groupChannel) === null || _uikitOptions$groupCh === void 0 ? void 0 : _uikitOptions$groupCh.enableOgtag,
      enableMention: (_uikitOptions$groupCh2 = (_uikitOptions$groupCh3 = uikitOptions.groupChannel) === null || _uikitOptions$groupCh3 === void 0 ? void 0 : _uikitOptions$groupCh3.enableMention) !== null && _uikitOptions$groupCh2 !== void 0 ? _uikitOptions$groupCh2 : isMentionEnabled,
      enableReactions: (_uikitOptions$groupCh4 = (_uikitOptions$groupCh5 = uikitOptions.groupChannel) === null || _uikitOptions$groupCh5 === void 0 ? void 0 : _uikitOptions$groupCh5.enableReactions) !== null && _uikitOptions$groupCh4 !== void 0 ? _uikitOptions$groupCh4 : isReactionEnabled,
      enableTypingIndicator: (_uikitOptions$groupCh6 = uikitOptions.groupChannel) === null || _uikitOptions$groupCh6 === void 0 ? void 0 : _uikitOptions$groupCh6.enableTypingIndicator,
      enableVoiceMessage: (_uikitOptions$groupCh7 = (_uikitOptions$groupCh8 = uikitOptions.groupChannel) === null || _uikitOptions$groupCh8 === void 0 ? void 0 : _uikitOptions$groupCh8.enableVoiceMessage) !== null && _uikitOptions$groupCh7 !== void 0 ? _uikitOptions$groupCh7 : isVoiceMessageEnabled,
      replyType: (_uikitOptions$groupCh9 = (_uikitOptions$groupCh10 = uikitOptions.groupChannel) === null || _uikitOptions$groupCh10 === void 0 ? void 0 : _uikitOptions$groupCh10.replyType) !== null && _uikitOptions$groupCh9 !== void 0 ? _uikitOptions$groupCh9 : replyType != null ? getCaseResolvedReplyType(replyType).lowerCase : undefined,
      threadReplySelectType: (_uikitOptions$groupCh11 = uikitOptions.groupChannel) === null || _uikitOptions$groupCh11 === void 0 ? void 0 : _uikitOptions$groupCh11.threadReplySelectType,
      input: {
        enableDocument: (_uikitOptions$groupCh12 = uikitOptions.groupChannel) === null || _uikitOptions$groupCh12 === void 0 ? void 0 : (_uikitOptions$groupCh13 = _uikitOptions$groupCh12.input) === null || _uikitOptions$groupCh13 === void 0 ? void 0 : _uikitOptions$groupCh13.enableDocument
      }
    },
    groupChannelList: {
      enableTypingIndicator: (_uikitOptions$groupCh14 = (_uikitOptions$groupCh15 = uikitOptions.groupChannelList) === null || _uikitOptions$groupCh15 === void 0 ? void 0 : _uikitOptions$groupCh15.enableTypingIndicator) !== null && _uikitOptions$groupCh14 !== void 0 ? _uikitOptions$groupCh14 : isTypingIndicatorEnabledOnChannelList,
      enableMessageReceiptStatus: (_uikitOptions$groupCh16 = (_uikitOptions$groupCh17 = uikitOptions.groupChannelList) === null || _uikitOptions$groupCh17 === void 0 ? void 0 : _uikitOptions$groupCh17.enableMessageReceiptStatus) !== null && _uikitOptions$groupCh16 !== void 0 ? _uikitOptions$groupCh16 : isMessageReceiptStatusEnabledOnChannelList
    },
    groupChannelSettings: {
      enableMessageSearch: (_uikitOptions$groupCh18 = (_uikitOptions$groupCh19 = uikitOptions.groupChannelSettings) === null || _uikitOptions$groupCh19 === void 0 ? void 0 : _uikitOptions$groupCh19.enableMessageSearch) !== null && _uikitOptions$groupCh18 !== void 0 ? _uikitOptions$groupCh18 : showSearchIcon
    },
    openChannel: {
      enableOgtag: (_uikitOptions$openCha = uikitOptions.openChannel) === null || _uikitOptions$openCha === void 0 ? void 0 : _uikitOptions$openCha.enableOgtag,
      input: {
        enableDocument: (_uikitOptions$openCha2 = uikitOptions.openChannel) === null || _uikitOptions$openCha2 === void 0 ? void 0 : (_uikitOptions$openCha3 = _uikitOptions$openCha2.input) === null || _uikitOptions$openCha3 === void 0 ? void 0 : _uikitOptions$openCha3.enableDocument
      }
    }
  };
}

const TIMEOUT = 2000;
/*
  * This is a factory function that returns a scheduler.
  * The scheduler is a queue that calls the callback function on intervals.
  * If interval is empty, the callback function is called immediately.
  * If interval is not empty, the callback function is called after the interval.
*/

function schedulerFactory(_ref) {
  let {
    logger,
    timeout,
    cb
  } = _ref;
  let queue = [];
  let interval = null;

  const push = channel => {
    const channelPresent = queue.find(c => c.url === channel.url);

    if (!channelPresent) {
      queue.push(channel);
    } else {
      logger.info('Channel: Mark as read already in queue', {
        channel
      });
    } // start the interval if it's not already running


    if (interval) {
      return;
    }

    const item = queue.shift();

    if (item) {
      cb(item);
    }

    interval = setInterval(() => {
      if (queue.length === 0 && interval) {
        clearInterval(interval);
        interval = null;
        return;
      }

      const item = queue.shift();

      if (item) {
        cb(item);
      }
    }, timeout || TIMEOUT);
  };

  const clear = () => {
    queue = [];

    if (interval) {
      clearInterval(interval);
      interval = null;
    }
  };

  return {
    push,
    clear,
    getQueue: () => queue
  };
} // this hook accepts a callback to run component is unmounted


function useUnmount(callback) {
  let deps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
  useLayoutEffect(() => {
    return () => {
      callback();
    };
  }, deps);
}

function useMarkAsReadScheduler(_ref, _ref2) {
  let {
    isConnected
  } = _ref;
  let {
    logger
  } = _ref2;
  const markAsReadScheduler = useMemo(() => schedulerFactory({
    logger,
    cb: channel => {
      try {
        channel.markAsRead();
      } catch (error) {
        logger.warning('Channel: Mark as delivered failed', {
          channel,
          error
        });
      }
    }
  }), []);
  useEffect(() => {
    // for simplicity, we clear the queue when the connection is lost
    if (!isConnected) {
      markAsReadScheduler.clear();
    }
  }, [isConnected]);
  useUnmount(() => {
    markAsReadScheduler.clear();
  });
  return markAsReadScheduler;
}

function useMarkAsDeliveredScheduler(_ref, _ref2) {
  let {
    isConnected
  } = _ref;
  let {
    logger
  } = _ref2;
  const markAsDeliveredScheduler = useMemo(() => schedulerFactory({
    logger,
    cb: channel => {
      try {
        channel.markAsDelivered();
      } catch (error) {
        logger.warning('Channel: Mark as delivered failed', {
          channel,
          error
        });
      }
    }
  }), []);
  useEffect(() => {
    // for simplicity, we clear the queue when the connection is lost
    if (!isConnected) {
      markAsDeliveredScheduler.clear();
    }
  }, [isConnected]);
  useUnmount(() => {
    markAsDeliveredScheduler.clear();
  });
  return markAsDeliveredScheduler;
}

function Sendbird(props) {
  const localConfigs = uikitConfigMapper({
    legacyConfig: {
      replyType: props.replyType,
      isMentionEnabled: props.isMentionEnabled,
      isReactionEnabled: props.isReactionEnabled,
      disableUserProfile: props.disableUserProfile,
      isVoiceMessageEnabled: props.isVoiceMessageEnabled,
      isTypingIndicatorEnabledOnChannelList: props.isTypingIndicatorEnabledOnChannelList,
      isMessageReceiptStatusEnabledOnChannelList: props.isMessageReceiptStatusEnabledOnChannelList,
      showSearchIcon: props.showSearchIcon
    },
    uikitOptions: props.uikitOptions
  });
  return /*#__PURE__*/React__default__default.createElement(UIKitConfigProvider, {
    localConfigs: {
      common: localConfigs === null || localConfigs === void 0 ? void 0 : localConfigs.common,
      groupChannel: {
        channel: localConfigs === null || localConfigs === void 0 ? void 0 : localConfigs.groupChannel,
        channelList: localConfigs === null || localConfigs === void 0 ? void 0 : localConfigs.groupChannelList,
        setting: localConfigs === null || localConfigs === void 0 ? void 0 : localConfigs.groupChannelSettings
      },
      openChannel: {
        channel: localConfigs === null || localConfigs === void 0 ? void 0 : localConfigs.openChannel
      }
    }
  }, /*#__PURE__*/React__default__default.createElement(SendbirdSDK, props));
}

const SendbirdSDK = _ref => {
  let {
    appId,
    userId,
    children,
    accessToken = '',
    customApiHost = '',
    customWebSocketHost = '',
    configureSession = null,
    theme = 'light',
    config = {},
    nickname = '',
    colorSet = null,
    stringSet = null,
    dateLocale = null,
    profileUrl = '',
    voiceRecord = {
      maxRecordingTime: VOICE_RECORDER_DEFAULT_MAX,
      minRecordingTime: VOICE_RECORDER_DEFAULT_MIN
    },
    userListQuery = null,
    imageCompression = {},
    allowProfileEdit = false,
    disableMarkAsDelivered = false,
    renderUserProfile = null,
    onUserProfileMessage = null,
    breakpoint = false,
    isUserIdUsedForNickname = true,
    sdkInitParams,
    customExtensionParams
  } = _ref;
  const {
    logLevel = '',
    userMention = {},
    isREMUnitEnabled = false
  } = config;
  const {
    isMobile
  } = useMediaQueryContext();
  const [logger, setLogger] = useState(LoggerFactory(logLevel));
  const [pubSub] = useState(pubSubFactory());
  const [sdkStore, sdkDispatcher] = useReducer(reducer$1, initialState$1);
  const [userStore, userDispatcher] = useReducer(reducer$2, initialState$2);
  const {
    configs,
    configsWithAppAttr,
    initDashboardConfigs
  } = useUIKitConfig();
  const sdkInitialized = sdkStore.initialized;
  const sdk = sdkStore === null || sdkStore === void 0 ? void 0 : sdkStore.sdk;
  useTheme(colorSet);
  const reconnect = useConnect({
    appId,
    userId,
    accessToken,
    isUserIdUsedForNickname,
    isMobile
  }, {
    logger,
    nickname,
    profileUrl,
    configureSession,
    customApiHost,
    customWebSocketHost,
    sdkInitParams,
    customExtensionParams,
    sdk,
    sdkDispatcher,
    userDispatcher,
    initDashboardConfigs
  });
  useUnmount(() => {
    if (typeof sdk.disconnect === 'function') {
      disconnectSdk({
        logger,
        sdkDispatcher,
        userDispatcher,
        sdk
      });
    }
  }, [sdk.disconnect]); // to create a pubsub to communicate between parent and child

  useEffect(() => {
    setLogger(LoggerFactory(logLevel));
  }, [logLevel]);
  useAppendDomNode(['sendbird-modal-root', 'sendbird-dropdown-portal', 'sendbird-emoji-list-portal'], 'body'); // should move to reducer

  const [currenttheme, setCurrenttheme] = useState(theme);
  useEffect(() => {
    setCurrenttheme(theme);
  }, [theme]);
  useEffect(() => {
    const body = document.querySelector('body');
    body.classList.remove('sendbird-experimental__rem__units');

    if (isREMUnitEnabled) {
      body.classList.add('sendbird-experimental__rem__units');
    }
  }, [isREMUnitEnabled]); // add-remove theme from body

  useEffect(() => {
    logger.info('Setup theme', `Theme: ${currenttheme}`);

    try {
      const body = document.querySelector('body');
      body.classList.remove('sendbird-theme--light');
      body.classList.remove('sendbird-theme--dark');
      body.classList.add(`sendbird-theme--${currenttheme || 'light'}`);
      logger.info('Finish setup theme'); // eslint-disable-next-line no-empty
    } catch (e) {
      logger.warning('Setup theme failed', `${e}`);
    }

    return () => {
      try {
        const body = document.querySelector('body');
        body.classList.remove('sendbird-theme--light');
        body.classList.remove('sendbird-theme--dark'); // eslint-disable-next-line no-empty
      } catch (_unused) {}
    };
  }, [currenttheme]);
  const isOnline = useConnectionStatus(sdkStore.sdk, logger);
  const markAsReadScheduler = useMarkAsReadScheduler({
    isConnected: isOnline
  }, {
    logger
  });
  const markAsDeliveredScheduler = useMarkAsDeliveredScheduler({
    isConnected: isOnline
  }, {
    logger
  });
  const localeStringSet = React__default__default.useMemo(() => {
    if (!stringSet) {
      return getStringSet$1('en');
    }

    return _objectSpread2(_objectSpread2({}, getStringSet$1('en')), stringSet);
  }, [stringSet]);
  return /*#__PURE__*/React__default__default.createElement(SendbirdSdkContext.Provider, {
    value: {
      stores: {
        sdkStore,
        userStore
      },
      dispatchers: {
        sdkDispatcher,
        userDispatcher,
        reconnect
      },
      config: {
        disableMarkAsDelivered,
        renderUserProfile,
        onUserProfileMessage,
        allowProfileEdit,
        isOnline,
        userId,
        appId,
        accessToken,
        theme: currenttheme,
        setCurrenttheme,
        userListQuery,
        logger,
        pubSub,
        imageCompression: _objectSpread2({
          compressionRate: 0.7
        }, imageCompression),
        voiceRecord,
        userMention: {
          maxMentionCount: (userMention === null || userMention === void 0 ? void 0 : userMention.maxMentionCount) || 10,
          maxSuggestionCount: (userMention === null || userMention === void 0 ? void 0 : userMention.maxSuggestionCount) || 15
        },
        markAsReadScheduler,
        markAsDeliveredScheduler,
        // From UIKitConfigProvider.localConfigs
        disableUserProfile: !configs.common.enableUsingDefaultUserProfile,
        isReactionEnabled: sdkInitialized && configsWithAppAttr(sdk).groupChannel.channel.enableReactions,
        isMentionEnabled: configs.groupChannel.channel.enableMention,
        isVoiceMessageEnabled: configs.groupChannel.channel.enableVoiceMessage,
        replyType: getCaseResolvedReplyType(configs.groupChannel.channel.replyType).upperCase,
        isTypingIndicatorEnabledOnChannelList: configs.groupChannel.channelList.enableTypingIndicator,
        isMessageReceiptStatusEnabledOnChannelList: configs.groupChannel.channelList.enableMessageReceiptStatus,
        showSearchIcon: sdkInitialized && configsWithAppAttr(sdk).groupChannel.setting.enableMessageSearch,
        // Remote configs set from dashboard by UIKit feature configuration
        groupChannel: {
          enableOgtag: sdkInitialized && configsWithAppAttr(sdk).groupChannel.channel.enableOgtag,
          enableTypingIndicator: configs.groupChannel.channel.enableTypingIndicator,
          enableDocument: configs.groupChannel.channel.input.enableDocument,
          threadReplySelectType: getCaseResolvedThreadReplySelectType(configs.groupChannel.channel.threadReplySelectType).upperCase
        },
        openChannel: {
          enableOgtag: sdkInitialized && configsWithAppAttr(sdk).openChannel.channel.enableOgtag,
          enableDocument: configs.openChannel.channel.input.enableDocument
        }
      }
    }
  }, /*#__PURE__*/React__default__default.createElement(MediaQueryProvider, {
    logger: logger,
    breakpoint: breakpoint
  }, /*#__PURE__*/React__default__default.createElement(LocalizationProvider, {
    stringSet: localeStringSet,
    dateLocale: dateLocale
  }, /*#__PURE__*/React__default__default.createElement(VoiceMessageProvider, {
    isVoiceMessageEnabled: configs.groupChannel.channel.enableVoiceMessage
  }, children))));
};

var css_248z$f = ".sendbird-openchannel-conversation-header {\n  position: relative;\n  min-height: 64px;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-openchannel-conversation-header {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-openchannel-conversation-header {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-openchannel-conversation-header .sendbird-openchannel-conversation-header__left__title {\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  max-width: calc(100% - 120px);\n}\n.sendbird-openchannel-conversation-header__left [class*=sendbird-openchannel-conversation-header__left__cover-image] {\n  position: absolute;\n  left: 20px;\n  top: 16px;\n}\n.sendbird-openchannel-conversation-header__left__title {\n  position: absolute;\n  left: 60px;\n  top: 12px;\n}\n.sendbird-openchannel-conversation-header__left__sub-title {\n  position: absolute;\n  left: 60px;\n  top: 36px;\n}\n.sendbird-openchannel-conversation-header__right {\n  position: absolute;\n  top: 0px;\n  right: 0px;\n  width: 64px;\n  height: 64px;\n}\n.sendbird-openchannel-conversation-header__right__trigger {\n  position: absolute;\n  top: 16px;\n  right: 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.sendbird-openchannel-conversation-header__left__cover-image--icon {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 50%;\n}\n.sendbird-theme--light .sendbird-openchannel-conversation-header__left__cover-image--icon {\n  background-color: var(--sendbird-light-background-300);\n}\n.sendbird-theme--dark .sendbird-openchannel-conversation-header__left__cover-image--icon {\n  background-color: var(--sendbird-dark-background-300);\n}\n.sendbird-word {\n  display: inline;\n  height: -moz-fit-content;\n  height: fit-content;\n}\n\n.sendbird-word__url {\n  margin: 0 4px;\n  display: inline;\n  color: inherit;\n  word-break: break-all;\n}\n.sendbird-open-channel-preview {\n  position: relative;\n  display: inline-flex;\n  flex-direction: row;\n  width: 264px;\n  height: 58px;\n  min-width: 264px;\n  min-height: 58px;\n  box-sizing: border-box;\n}\n.sendbird--mobile-mode .sendbird-open-channel-preview {\n  width: 100%;\n}\n.sendbird-theme--light .sendbird-open-channel-preview {\n  background-color: var(--sendbird-light-background-50);\n  border-bottom: solid 1px var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-open-channel-preview {\n  background-color: var(--sendbird-dark-background-600);\n  border-bottom: solid 1px var(--sendbird-dark-ondark-04);\n}\n.sendbird-theme--light .sendbird-open-channel-preview:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-open-channel-preview:hover {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-open-channel-preview.selected {\n  background-color: var(--sendbird-light-primary-100);\n  border-left: solid 4px var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-open-channel-preview.selected {\n  background-color: var(--sendbird-dark-primary-300);\n  border-left: solid 4px var(--sendbird-dark-primary-200);\n}\n.sendbird-open-channel-preview .sendbird-open-channel-preview__cover-image {\n  position: relative;\n  margin-top: 8px;\n  margin-left: 16px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 42px;\n  height: 42px;\n  box-sizing: border-box;\n}\n.sendbird-open-channel-preview .sendbird-open-channel-preview__cover-image .sendbird-open-channel-preview__cover-image__avatar,\n.sendbird-open-channel-preview .sendbird-open-channel-preview__cover-image .sendbird-open-channel-preview__cover-image__avatar--default {\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  box-sizing: border-box;\n}\n.sendbird-open-channel-preview .sendbird-open-channel-preview__context {\n  position: relative;\n  margin-top: 8px;\n  margin-left: 16px;\n  display: inline-flex;\n  flex-direction: column;\n  width: calc(100% - 100px);\n  box-sizing: border-box;\n}\n.sendbird-open-channel-preview .sendbird-open-channel-preview__context .sendbird-open-channel-preview__context__title {\n  position: relative;\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n  width: 100%;\n  height: 16px;\n  box-sizing: border-box;\n}\n.sendbird-open-channel-preview .sendbird-open-channel-preview__context .sendbird-open-channel-preview__context__title .sendbird-open-channel-preview__context__title__channel-name {\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  box-sizing: border-box;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  word-break: keep-all;\n}\n.sendbird-open-channel-preview .sendbird-open-channel-preview__context .sendbird-open-channel-preview__context__title .sendbird-open-channel-preview__context__title__channel-name.frozen {\n  max-width: calc(100% - 20px);\n}\n.sendbird--mobile-mode .sendbird-open-channel-preview .sendbird-open-channel-preview__context .sendbird-open-channel-preview__context__title .sendbird-open-channel-preview__context__title__channel-name {\n  overflow-y: hidden;\n}\n.sendbird-open-channel-preview .sendbird-open-channel-preview__context .sendbird-open-channel-preview__context__title .sendbird-open-channel-preview__context__title__frozen {\n  position: relative;\n  margin-left: 4px;\n  display: inline-flex;\n}\n.sendbird-open-channel-preview .sendbird-open-channel-preview__context .sendbird-open-channel-preview__context__participants {\n  position: relative;\n  margin-top: 8px;\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n  width: 100%;\n  height: 14px;\n  box-sizing: border-box;\n}\n.sendbird-open-channel-preview .sendbird-open-channel-preview__context .sendbird-open-channel-preview__context__participants .sendbird-open-channel-preview__context__participants__icon {\n  position: relative;\n  display: inline-flex;\n  width: 14px;\n  height: 14px;\n  box-sizing: border-box;\n}\n.sendbird-open-channel-preview .sendbird-open-channel-preview__context .sendbird-open-channel-preview__context__participants .sendbird-open-channel-preview__context__participants__count {\n  position: relative;\n  margin-left: 4px;\n  display: inline-flex;\n  width: 160px;\n  max-width: 160px;\n  height: 12px;\n  box-sizing: border-box;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  word-break: keep-all;\n}\n.sendbird--mobile-mode .sendbird-open-channel-preview .sendbird-open-channel-preview__context .sendbird-open-channel-preview__context__participants .sendbird-open-channel-preview__context__participants__count {\n  overflow-y: hidden;\n}\n.sendbird-create-open-channel-ui {\n  position: relative;\n  display: inline-flex;\n}\n\n.sendbird-create-open-channel-ui__profile-input {\n  position: relative;\n  display: inline-flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n}\n.sendbird-create-open-channel-ui__profile-input .sendbird-create-open-channel-ui__profile-input__img-section {\n  position: relative;\n  margin-top: 16px;\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n}\n.sendbird-create-open-channel-ui__profile-input .sendbird-create-open-channel-ui__profile-input__img-section .sendbird-create-open-channel-ui__profile-input__img-section__avatar {\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 80px;\n  height: 80px;\n}\n.sendbird-create-open-channel-ui__profile-input .sendbird-create-open-channel-ui__profile-input__img-section .sendbird-create-open-channel-ui__profile-input__img-section__avatar--default {\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 80px;\n  height: 80px;\n  border-radius: 50%;\n}\n.sendbird-theme--light .sendbird-create-open-channel-ui__profile-input .sendbird-create-open-channel-ui__profile-input__img-section .sendbird-create-open-channel-ui__profile-input__img-section__avatar--default {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-create-open-channel-ui__profile-input .sendbird-create-open-channel-ui__profile-input__img-section .sendbird-create-open-channel-ui__profile-input__img-section__avatar--default {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-create-open-channel-ui__profile-input .sendbird-create-open-channel-ui__profile-input__img-section .sendbird-create-open-channel-ui__profile-input__img-section__button {\n  position: relative;\n  margin-left: 18px;\n  display: inline-flex;\n}\n.sendbird-create-open-channel-ui__profile-input .sendbird-create-open-channel-ui__profile-input__name-section {\n  position: relative;\n  margin-top: 8px;\n  display: inline-flex;\n  flex-direction: row;\n}\n.sendbird-open-channel-list,\n.sendbird-open-channel-list-ui {\n  position: relative;\n  display: inline-flex;\n  flex-direction: column;\n  width: 256px;\n  min-width: 256px;\n  height: 100%;\n  box-sizing: border-box;\n}\n.sendbird--mobile-mode .sendbird-open-channel-list,\n.sendbird--mobile-mode .sendbird-open-channel-list-ui {\n  width: 100%;\n}\n.sendbird-theme--light .sendbird-open-channel-list,\n.sendbird-theme--light .sendbird-open-channel-list-ui {\n  border-right: solid 1px var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-open-channel-list,\n.sendbird-theme--dark .sendbird-open-channel-list-ui {\n  border-right: solid 1px var(--sendbird-dark-ondark-04);\n}\n.sendbird-open-channel-list .sendbird-open-channel-list-ui__header,\n.sendbird-open-channel-list-ui .sendbird-open-channel-list-ui__header {\n  position: relative;\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n  width: 100%;\n  height: 64px;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-open-channel-list .sendbird-open-channel-list-ui__header,\n.sendbird-theme--light .sendbird-open-channel-list-ui .sendbird-open-channel-list-ui__header {\n  background-color: var(--sendbird-light-background-50);\n  border-bottom: solid 1px var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-open-channel-list .sendbird-open-channel-list-ui__header,\n.sendbird-theme--dark .sendbird-open-channel-list-ui .sendbird-open-channel-list-ui__header {\n  background-color: var(--sendbird-dark-background-600);\n  border-bottom: solid 1px var(--sendbird-dark-ondark-04);\n}\n.sendbird-open-channel-list .sendbird-open-channel-list-ui__header .sendbird-open-channel-list-ui__header__title,\n.sendbird-open-channel-list-ui .sendbird-open-channel-list-ui__header .sendbird-open-channel-list-ui__header__title {\n  position: relative;\n  margin-left: 24px;\n  display: inline-flex;\n  align-items: center;\n  box-sizing: border-box;\n}\n.sendbird-open-channel-list .sendbird-open-channel-list-ui__header .sendbird-open-channel-list-ui__header__button-refresh,\n.sendbird-open-channel-list-ui .sendbird-open-channel-list-ui__header .sendbird-open-channel-list-ui__header__button-refresh {\n  position: absolute;\n  top: 16px;\n  right: 56px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  box-sizing: border-box;\n}\n.sendbird-open-channel-list .sendbird-open-channel-list-ui__header .sendbird-open-channel-list-ui__header__button-create-channel,\n.sendbird-open-channel-list-ui .sendbird-open-channel-list-ui__header .sendbird-open-channel-list-ui__header__button-create-channel {\n  position: absolute;\n  top: 16px;\n  right: 16px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  box-sizing: border-box;\n}\n.sendbird-open-channel-list .sendbird-open-channel-list-ui__channel-list,\n.sendbird-open-channel-list-ui .sendbird-open-channel-list-ui__channel-list {\n  position: relative;\n  display: inline-flex;\n  flex-direction: column;\n  width: 100%;\n  height: calc(100% - 64px);\n  box-sizing: border-box;\n  overflow-y: scroll;\n}\n\n.sendbird-open-channel-list-ui__channel-list--place-holder--loading {\n  position: relative;\n  min-height: 62px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n.sendbird-theme--light .sendbird-open-channel-list-ui__channel-list--place-holder--loading {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-open-channel-list-ui__channel-list--place-holder--loading {\n  background-color: var(--sendbird-dark-background-500);\n}\n@import url(\"https://fonts.googleapis.com/css?family=Open+Sans:400,600,700&display=swap\");\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-highlight-100: #fff2b6;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-highlight-100: #fff2b6;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-iconbutton-color: #825eeb;\n  --sendbird-message-input-border-active: #7B53EF;\n  --sendbird-selected-reaction-button-border-hover: #9E8CF5;\n  --sendbird-add-reaction-button-border-hover: #9E8CF5;\n  --sendbird-tooltip-background: #000000;\n  --sendbird-tooltip-text-color: rgba(255, 255, 255, 0.88);\n  --sendbird-button-border-focus: #FFFFFF;\n  --sendbird-file-message-icon-background: #FFFFFF;\n  --sendbird-font-family-default: \"Roboto\", sans-serif;\n  --sendbird-message-balloon-width: 404px;\n}\n.sendbird-experimental__rem__units .sendbird-label--h-1 {\n  font-size: 1.25rem;\n}\n.sendbird-experimental__rem__units .sendbird-label--h-2 {\n  font-size: 1.125rem;\n}\n.sendbird-experimental__rem__units .sendbird-label--subtitle-1 {\n  font-size: 1rem;\n}\n.sendbird-experimental__rem__units .sendbird-label--subtitle-2 {\n  font-size: 0.875rem;\n}\n.sendbird-experimental__rem__units .sendbird-label--body-1 {\n  font-size: 0.875rem;\n}\n.sendbird-experimental__rem__units .sendbird-label--body-2 {\n  font-size: 0.75rem;\n}\n.sendbird-experimental__rem__units .sendbird-label--button-1 {\n  font-size: 0.875rem;\n}\n.sendbird-experimental__rem__units .sendbird-label--button-2 {\n  font-size: 0.875rem;\n}\n.sendbird-experimental__rem__units .sendbird-label--caption-1 {\n  font-size: 0.875rem;\n}\n.sendbird-experimental__rem__units .sendbird-label--caption-2 {\n  font-size: 0.75rem;\n}\n.sendbird-experimental__rem__units .sendbird-label--caption-3 {\n  font-size: 0.75rem;\n}\n.sendbird-experimental__rem__units .sendbird-message-search-pannel .sendbird-message-search-pannel__input__container__input-area {\n  font-size: 0.875rem;\n}\n.sendbird-experimental__rem__units .sendbird-checkbox {\n  font-size: 1.375rem;\n}\n.sendbird-experimental__rem__units .sendbird-mention-user-label {\n  font-size: 0.875rem;\n}\n.sendbird-experimental__rem__units .sendbird-mention-user-label.purple {\n  font-size: 1.125rem;\n}\n.sendbird-experimental__rem__units .sendbird-message-input .sendbird-message-input--textarea,\n.sendbird-experimental__rem__units .sendbird-message-input .sendbird-message-input--placeholder {\n  font-size: 0.875rem;\n}\n.sendbird-experimental__rem__units .sendbird-input .sendbird-input__input,\n.sendbird-experimental__rem__units .sendbird-input .sendbird-input__placeholder {\n  font-size: 0.875rem;\n}\n.sendbird-experimental__rem__units .sendbird-tooltip__text {\n  font-size: 0.75rem;\n}\n.sendbird-experimental__rem__units .sendbird-quote-message .sendbird-quote-message__replied-to .sendbird-quote-message__replied-to__text {\n  font-size: 0.75rem;\n}\n.sendbird-experimental__rem__units .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__text-message {\n  font-size: 0.75rem;\n}\n.sendbird-experimental__rem__units .sendbird-quote-message .sendbird-quote-message__replied-message__file-message {\n  font-size: 0.75rem;\n}\n.sendbird-modal--full-mobile .sendbird-modal__content {\n  width: 100vw;\n  max-width: 100%;\n  height: 100%;\n}\n.sendbird--mobile-mode .sendbird-modal--full-mobile .sendbird-modal__content {\n  height: -webkit-fill-available;\n  height: -moz-available;\n  height: stretch;\n}\n\n.sendbird-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.sendbird-modal__backdrop--clickoutside {\n  cursor: pointer;\n}\n\n.sendbird-modal__content {\n  width: 480px;\n  border-radius: 4px;\n  z-index: 10001;\n  padding: 18px 24px 24px 24px;\n  position: relative;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-modal__content {\n  background-color: var(--sendbird-light-background-50);\n  box-shadow: var(--sendbird-light-shadow-04);\n}\n.sendbird-theme--dark .sendbird-modal__content {\n  background-color: var(--sendbird-dark-background-500);\n  box-shadow: var(--sendbird-dark-shadow-04);\n}\n.sendbird-modal__content .sendbird-modal__close {\n  position: absolute;\n  top: 16px;\n  right: 16px;\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-modal__content .sendbird-modal__close path {\n  fill: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-modal__content .sendbird-modal__close path {\n  fill: var(--sendbird-dark-ondark-01);\n}\n.sendbird-modal__content .sendbird-modal__header {\n  margin-bottom: 16px;\n}\n.sendbird-modal__content .sendbird-modal__body {\n  height: calc(100% - 116px);\n}\n.sendbird-modal__content .sendbird-modal__footer {\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n  margin-top: 32px;\n  text-align: right;\n}\n.sendbird--mobile-mode .sendbird-modal__content .sendbird-modal__footer {\n  position: sticky;\n  bottom: 24px;\n}\n.sendbird-modal__content .sendbird-modal__footer .sendbird-button:last-child {\n  margin-left: 8px;\n  min-width: 80px;\n  height: 40px;\n}\n\n.sendbird-modal__backdrop {\n  position: fixed;\n  z-index: 10000;\n  height: 100%;\n  width: 100%;\n  top: 0;\n  left: 0;\n}\n.sendbird-theme--light .sendbird-modal__backdrop {\n  background-color: var(--sendbird-light-overlay-02);\n}\n.sendbird-theme--dark .sendbird-modal__backdrop {\n  background-color: var(--sendbird-dark-overlay-02);\n}\n.sendbird-button {\n  display: inline-block;\n  box-shadow: none;\n  border-radius: 4px;\n  padding: 0px;\n  font-family: var(--sendbird-font-family-default);\n  cursor: pointer;\n}\n.sendbird-button:hover {\n  box-shadow: none;\n}\n.sendbird-button:focus {\n  outline: none;\n}\n.sendbird-button:active {\n  box-shadow: none;\n}\n.sendbird-button.sendbird-button__disabled {\n  cursor: not-allowed;\n}\n.sendbird-theme--light .sendbird-button.sendbird-button__disabled {\n  border: none;\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-button.sendbird-button__disabled {\n  border: none;\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-theme--light .sendbird-button.sendbird-button__disabled:hover {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-button.sendbird-button__disabled:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n\n.sendbird-button--big {\n  height: 40px;\n}\n.sendbird-button--big .sendbird-button__text {\n  margin: 10px 16px;\n}\n\n.sendbird-button--small {\n  height: 32px;\n}\n.sendbird-button--small .sendbird-button__text {\n  margin: 6px 16px;\n}\n\n.sendbird-theme--light .sendbird-button--primary {\n  border: 1px solid var(--sendbird-light-primary-300);\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-button--primary {\n  border: 1px solid var(--sendbird-dark-primary-200);\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-theme--light .sendbird-button--primary .sendbird-button__text {\n  color: var(--sendbird-light-ondark-01);\n}\n.sendbird-theme--dark .sendbird-button--primary .sendbird-button__text {\n  color: var(--sendbird-dark-onlight-01);\n}\n.sendbird-theme--light .sendbird-button--primary:hover {\n  background-color: var(--sendbird-light-primary-400);\n  border-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-button--primary:hover {\n  background-color: var(--sendbird-dark-primary-300);\n  border-color: var(--sendbird-dark-primary-300);\n}\n.sendbird-theme--light .sendbird-button--primary:focus {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-light-primary-300);\n  border: 1px solid var(--sendbird-button-border-focus);\n}\n.sendbird-theme--dark .sendbird-button--primary:focus {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-dark-primary-200);\n  border: 1px solid var(--sendbird-button-border-focus);\n}\n.sendbird-theme--light .sendbird-button--primary:active {\n  background-color: var(--sendbird-light-primary-500);\n}\n.sendbird-theme--dark .sendbird-button--primary:active {\n  background-color: var(--sendbird-dark-primary-400);\n}\n.sendbird-theme--light .sendbird-button--primary:focus .sendbird-button--primary:hover {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-button--primary:focus .sendbird-button--primary:hover {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-dark-primary-300);\n}\n.sendbird-theme--light .sendbird-button--primary:focus .sendbird-button--primary:active {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-light-primary-500);\n}\n.sendbird-theme--dark .sendbird-button--primary:focus .sendbird-button--primary:active {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-dark-primary-400);\n}\n\n.sendbird-button--secondary {\n  background-color: transparent;\n}\n.sendbird-theme--light .sendbird-button--secondary {\n  border: 1px solid var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-button--secondary {\n  border: 1px solid var(--sendbird-dark-ondark-03);\n}\n.sendbird-theme--light .sendbird-button--secondary .sendbird-button__text {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-button--secondary .sendbird-button__text {\n  color: var(--sendbird-dark-ondark-01);\n}\n.sendbird-button--secondary:hover {\n  background-color: transparent;\n}\n.sendbird-theme--light .sendbird-button--secondary:hover {\n  border: 1px solid var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-button--secondary:hover {\n  border: 1px solid var(--sendbird-dark-primary-200);\n}\n.sendbird-theme--light .sendbird-button--secondary:hover .sendbird-button__text {\n  color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-button--secondary:hover .sendbird-button__text {\n  color: var(--sendbird-dark-primary-200);\n}\n.sendbird-button--secondary.sendbird-button__disabled {\n  cursor: not-allowed;\n  border: none;\n}\n.sendbird-theme--light .sendbird-button--secondary.sendbird-button__disabled {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-button--secondary.sendbird-button__disabled {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-theme--light .sendbird-button--secondary.sendbird-button__disabled .sendbird-button__text {\n  color: var(--sendbird-light-onlight-02);\n}\n.sendbird-theme--dark .sendbird-button--secondary.sendbird-button__disabled .sendbird-button__text {\n  color: var(--sendbird-dark-ondark-02);\n}\n.sendbird-button--secondary.sendbird-button__disabled:hover {\n  border: none;\n}\n.sendbird-theme--light .sendbird-button--secondary.sendbird-button__disabled:hover {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-button--secondary.sendbird-button__disabled:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-theme--light .sendbird-button--secondary.sendbird-button__disabled:hover .sendbird-button__text {\n  color: var(--sendbird-light-onlight-02);\n}\n.sendbird-theme--dark .sendbird-button--secondary.sendbird-button__disabled:hover .sendbird-button__text {\n  color: var(--sendbird-dark-ondark-02);\n}\n.sendbird-theme--light .sendbird-button--secondary:hover .sendbird-button--secondary:focus .sendbird-button__text {\n  color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-button--secondary:hover .sendbird-button--secondary:focus .sendbird-button__text {\n  color: var(--sendbird-dark-primary-200);\n}\n.sendbird-button--secondary:focus {\n  border: 1px solid transparent;\n  background-color: transparent;\n}\n.sendbird-theme--light .sendbird-button--secondary:focus {\n  box-shadow: var(--sendbird-light-primary-300) 0px 0px 0px 2px;\n}\n.sendbird-theme--dark .sendbird-button--secondary:focus {\n  box-shadow: var(--sendbird-dark-primary-200) 0px 0px 0px 2px;\n}\n.sendbird-theme--light .sendbird-button--secondary:focus .sendbird-button__text {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-button--secondary:focus .sendbird-button__text {\n  color: var(--sendbird-dark-ondark-01);\n}\n.sendbird-button--secondary:active {\n  box-shadow: none;\n}\n.sendbird-theme--light .sendbird-button--secondary:active {\n  border: 1px solid var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-button--secondary:active {\n  border: 1px solid var(--sendbird-dark-primary-200);\n}\n.sendbird-theme--light .sendbird-button--secondary:active .sendbird-button__text {\n  color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-button--secondary:active .sendbird-button__text {\n  color: var(--sendbird-dark-primary-200);\n}\n\n.sendbird-theme--light .sendbird-button--danger {\n  border: 1px solid var(--sendbird-light-error-300);\n  background-color: var(--sendbird-light-error-300);\n}\n.sendbird-theme--dark .sendbird-button--danger {\n  border: 1px solid var(--sendbird-dark-error-200);\n  background-color: var(--sendbird-dark-error-200);\n}\n.sendbird-theme--light .sendbird-button--danger .sendbird-button__text {\n  color: var(--sendbird-light-ondark-01);\n}\n.sendbird-theme--dark .sendbird-button--danger .sendbird-button__text {\n  color: var(--sendbird-dark-onlight-01);\n}\n.sendbird-theme--light .sendbird-button--danger:hover {\n  background-color: var(--sendbird-light-error-400);\n  border-color: var(--sendbird-light-error-400);\n}\n.sendbird-theme--dark .sendbird-button--danger:hover {\n  background-color: var(--sendbird-dark-error-400);\n  border-color: var(--sendbird-dark-error-400);\n}\n.sendbird-theme--light .sendbird-button--danger:focus {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-light-error-300);\n  border-color: var(--sendbird-button-border-focus);\n}\n.sendbird-theme--dark .sendbird-button--danger:focus {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-dark-error-300);\n  border-color: var(--sendbird-button-border-focus);\n}\n.sendbird-button--danger:active {\n  box-shadow: none;\n}\n.sendbird-theme--light .sendbird-button--danger:active {\n  background-color: var(--sendbird-light-error-500);\n}\n.sendbird-theme--dark .sendbird-button--danger:active {\n  background-color: var(--sendbird-dark-error-500);\n}\n.sendbird-theme--light .sendbird-button--danger:hover .sendbird-button--danger:focus {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-light-error-400);\n}\n.sendbird-theme--dark .sendbird-button--danger:hover .sendbird-button--danger:focus {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-dark-error-400);\n}\n.sendbird-theme--light .sendbird-button--danger:active .sendbird-button--danger:focus {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-light-error-500);\n}\n.sendbird-theme--dark .sendbird-button--danger:active .sendbird-button--danger:focus {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-dark-error-500);\n}\n\n.sendbird-button--disabled {\n  border: 1px solid transparent;\n  cursor: not-allowed;\n}\n.sendbird-theme--light .sendbird-button--disabled {\n  background-color: var(--sendbird-light-background-200);\n  color: var(--sendbird-light-ondark-01);\n}\n.sendbird-theme--dark .sendbird-button--disabled {\n  background-color: var(--sendbird-dark-background-400);\n  color: var(--sendbird-dark-onlight-01);\n}\n.sendbird--mobile-mode .sendbird-label {\n  -webkit-user-select: none;\n  -webkit-touch-callout: none;\n}\n\n[class*=sendbird-label] {\n  font-family: var(--sendbird-font-family-default);\n}\n\n.sendbird-label--h-1 {\n  font-size: 20px;\n  font-weight: 600;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.4;\n  letter-spacing: -0.2px;\n}\n\n.sendbird-label--h-2 {\n  font-size: 18px;\n  font-weight: 600;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: normal;\n  letter-spacing: -0.2px;\n}\n\n.sendbird-label--subtitle-1 {\n  font-size: 16px;\n  font-weight: normal;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.38;\n  letter-spacing: -0.2px;\n}\n\n.sendbird-label--subtitle-2 {\n  font-size: 14px;\n  font-weight: 500;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.14;\n  letter-spacing: -0.2px;\n}\n\n.sendbird-label--body-1 {\n  font-size: 14px;\n  font-weight: normal;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.43;\n  letter-spacing: normal;\n}\n\n.sendbird-label--body-2 {\n  font-size: 12px;\n  font-weight: normal;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.33;\n  letter-spacing: normal;\n}\n\n.sendbird-label--button-1 {\n  font-size: 14px;\n  font-weight: 600;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.43;\n  letter-spacing: normal;\n}\n\n.sendbird-label--button-2 {\n  font-size: 14px;\n  font-weight: normal;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.43;\n  letter-spacing: normal;\n}\n\n.sendbird-label--caption-1 {\n  font-size: 14px;\n  font-weight: 600;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.43;\n  letter-spacing: normal;\n}\n\n.sendbird-label--caption-2 {\n  font-size: 12px;\n  font-weight: bold;\n  font-style: normal;\n  line-height: 1;\n  letter-spacing: normal;\n}\n\n.sendbird-label--caption-3 {\n  font-size: 12px;\n  font-weight: normal;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1;\n  letter-spacing: normal;\n}\n\n.sendbird-theme--light .sendbird-label--color-onbackground-1 {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-label--color-onbackground-1 {\n  color: var(--sendbird-dark-ondark-01);\n}\n\n.sendbird-theme--light .sendbird-label--color-onbackground-2 {\n  color: var(--sendbird-light-onlight-02);\n}\n.sendbird-theme--dark .sendbird-label--color-onbackground-2 {\n  color: var(--sendbird-dark-ondark-02);\n}\n\n.sendbird-theme--light .sendbird-label--color-onbackground-3 {\n  color: var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-label--color-onbackground-3 {\n  color: var(--sendbird-dark-ondark-03);\n}\n\n.sendbird-theme--light .sendbird-label--color-onbackground-4 {\n  color: var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-label--color-onbackground-4 {\n  color: var(--sendbird-dark-ondark-04);\n}\n\n.sendbird-theme--light .sendbird-label--color-oncontent-1 {\n  color: var(--sendbird-light-ondark-01);\n}\n.sendbird-theme--dark .sendbird-label--color-oncontent-1 {\n  color: var(--sendbird-dark-onlight-01);\n}\n\n.sendbird-theme--light .sendbird-label--color-oncontent-2 {\n  color: var(--sendbird-light-ondark-02);\n}\n.sendbird-theme--dark .sendbird-label--color-oncontent-2 {\n  color: var(--sendbird-dark-onlight-02);\n}\n\n.sendbird-theme--light .sendbird-label--color-primary {\n  color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-label--color-primary {\n  color: var(--sendbird-dark-primary-200);\n}\n\n.sendbird-theme--light .sendbird-label--color-error {\n  color: var(--sendbird-light-error-300);\n}\n.sendbird-theme--dark .sendbird-label--color-error {\n  color: var(--sendbird-dark-error-200);\n}\n\n.sendbird-theme--light .sendbird-label--color-secondary-3 {\n  color: var(--sendbird-light-secondary-300);\n}\n.sendbird-theme--dark .sendbird-label--color-secondary-3 {\n  color: var(--sendbird-dark-secondary-200);\n}\n.sendbird-icon {\n  display: inline-block;\n}\n.sendbird-icon:focus {\n  outline: none;\n}\n\n.sendbird-theme--light .sendbird-icon-color--primary [class*=fill] {\n  fill: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-icon-color--primary [class*=fill] {\n  fill: var(--sendbird-dark-primary-200);\n}\n\n.sendbird-theme--light .sendbird-icon-color--primary-2 [class*=fill] {\n  fill: var(--sendbird-light-primary-200);\n}\n.sendbird-theme--dark .sendbird-icon-color--primary-2 [class*=fill] {\n  fill: var(--sendbird-dark-primary-400);\n}\n\n.sendbird-theme--light .sendbird-icon-color--primary [class*=stroke] {\n  stroke: var(--sendbird-light-primary-300);\n  stroke-width: 2px;\n  stroke-linejoin: round;\n}\n.sendbird-theme--dark .sendbird-icon-color--primary [class*=stroke] {\n  stroke: var(--sendbird-dark-primary-200);\n  stroke-width: 2px;\n  stroke-linejoin: round;\n}\n\n.sendbird-theme--light .sendbird-icon-color--secondary [class*=fill] {\n  fill: var(--sendbird-light-secondary-300);\n}\n.sendbird-theme--dark .sendbird-icon-color--secondary [class*=fill] {\n  fill: var(--sendbird-dark-secondary-200);\n}\n\n.sendbird-theme--light .sendbird-icon-color--content [class*=fill] {\n  fill: var(--sendbird-light-ondark-01);\n}\n.sendbird-theme--dark .sendbird-icon-color--content [class*=fill] {\n  fill: var(--sendbird-dark-onlight-01);\n}\n\n.sendbird-theme--light .sendbird-icon-color--content-inverse [class*=fill] {\n  fill: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-icon-color--content-inverse [class*=fill] {\n  fill: var(--sendbird-dark-ondark-01);\n}\n\n.sendbird-icon-color--white [class*=fill] {\n  fill: #ffffff;\n}\n\n.sendbird-icon-color--gray [class*=fill] {\n  fill: var(--sendbird-light-onlight-04);\n}\n\n.sendbird-theme--light .sendbird-icon-color--sent [class*=fill] {\n  fill: var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-icon-color--sent [class*=fill] {\n  fill: var(--sendbird-dark-ondark-03);\n}\n\n.sendbird-theme--light .sendbird-icon-color--read [class*=fill] {\n  fill: var(--sendbird-light-secondary-300);\n}\n.sendbird-theme--dark .sendbird-icon-color--read [class*=fill] {\n  fill: var(--sendbird-dark-secondary-200);\n}\n\n.sendbird-theme--light .sendbird-icon-color--on-background-1 [class*=fill] {\n  fill: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-icon-color--on-background-1 [class*=fill] {\n  fill: var(--sendbird-dark-ondark-01);\n}\n\n.sendbird-theme--light .sendbird-icon-color--on-background-2 [class*=fill] {\n  fill: var(--sendbird-light-onlight-02);\n}\n.sendbird-theme--dark .sendbird-icon-color--on-background-2 [class*=fill] {\n  fill: var(--sendbird-dark-ondark-02);\n}\n\n.sendbird-theme--light .sendbird-icon-color--on-background-3 [class*=fill] {\n  fill: var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-icon-color--on-background-3 [class*=fill] {\n  fill: var(--sendbird-dark-ondark-03);\n}\n\n.sendbird-theme--light .sendbird-icon-color--on-background-4 [class*=fill] {\n  fill: var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-icon-color--on-background-4 [class*=fill] {\n  fill: var(--sendbird-dark-ondark-04);\n}\n\n.sendbird-theme--light .sendbird-icon-color--background-3 [class*=fill] {\n  fill: var(--sendbird-light-background-300);\n}\n.sendbird-theme--dark .sendbird-icon-color--background-3 [class*=fill] {\n  fill: var(--sendbird-dark-background-400);\n}\n\n.sendbird-theme--light .sendbird-icon-color--error [class*=fill] {\n  fill: var(--sendbird-light-error-300);\n}\n.sendbird-theme--dark .sendbird-icon-color--error [class*=fill] {\n  fill: var(--sendbird-dark-error-200);\n}\n.sendbird-iconbutton {\n  color: var(--sendbird-iconbutton-color);\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  padding: 3px;\n  background-color: transparent;\n  cursor: pointer;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  border: 1px solid transparent;\n  border-radius: 4px;\n  outline: 0px;\n}\n.sendbird-iconbutton .sendbird-iconbutton__inner {\n  height: 100%;\n}\n.sendbird-theme--light .sendbird-iconbutton .sendbird-iconbutton__inner svg {\n  fill: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-iconbutton .sendbird-iconbutton__inner svg {\n  fill: var(--sendbird-dark-ondark-01);\n}\n.sendbird-theme--light .sendbird-iconbutton:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-iconbutton:hover {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-iconbutton:active {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-iconbutton:active {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-iconbutton:disabled {\n  cursor: not-allowed !important;\n}\n.sendbird-theme--light .sendbird-iconbutton:disabled .sendbird-iconbutton__inner svg, .sendbird-theme--light .sendbird-iconbutton:disabled .sendbird-iconbutton__inner path {\n  fill: var(--sendbird-light-onlight-02);\n}\n.sendbird-theme--dark .sendbird-iconbutton:disabled .sendbird-iconbutton__inner svg, .sendbird-theme--dark .sendbird-iconbutton:disabled .sendbird-iconbutton__inner path {\n  fill: var(--sendbird-dark-ondark-02);\n}\n\n.sendbird-theme--light .sendbird-iconbutton--pressed {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-iconbutton--pressed {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-channel-list {\n  width: 320px;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-channel-list {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-channel-list {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird--mobile-mode .sendbird-channel-list {\n  width: 100%;\n}\n\n.sendbird-channel-list__header {\n  height: 64px;\n  min-height: 64px;\n}\n\n.sendbird-channel-list__body {\n  flex: 1 1 0;\n  -ms-flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n.sendbird-channel-header {\n  position: relative;\n  height: 64px;\n  min-height: 64px;\n  width: 320px;\n  padding: 8px 64px 8px 8px;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-channel-header {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-channel-header {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird--mobile-mode .sendbird-channel-header {\n  width: 100%;\n}\n.sendbird-channel-header.sendbird-channel-header--allow-edit .sendbird-channel-header__title {\n  cursor: pointer;\n}\n.sendbird-channel-header .sendbird-channel-header__title {\n  display: flex;\n  flex-direction: row;\n  width: 260px;\n  height: 48px;\n  border-radius: 4px;\n}\n.sendbird-theme--light .sendbird-channel-header .sendbird-channel-header__title:hover {\n  background: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-channel-header .sendbird-channel-header__title:hover {\n  background: var(--sendbird-dark-background-500);\n}\n.sendbird-channel-header .sendbird-channel-header__title:focus {\n  outline: none;\n}\n.sendbird-theme--light .sendbird-channel-header .sendbird-channel-header__title:focus {\n  background: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-channel-header .sendbird-channel-header__title:focus {\n  background: var(--sendbird-dark-background-400);\n}\n.sendbird-theme--light .sendbird-channel-header .sendbird-channel-header__title:active {\n  border: solid 2px var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-channel-header .sendbird-channel-header__title:active {\n  border: solid 2px var(--sendbird-dark-primary-200);\n}\n.sendbird-channel-header .sendbird-channel-header__title .sendbird-channel-header__title__left {\n  width: 48px;\n  padding: 8px;\n  box-sizing: border-box;\n}\n.sendbird-channel-header .sendbird-channel-header__title .sendbird-channel-header__title__right {\n  margin-left: 4px;\n  padding-top: 8px;\n}\n.sendbird-channel-header .sendbird-channel-header__title .sendbird-channel-header__title__right__name,\n.sendbird-channel-header .sendbird-channel-header__title .sendbird-channel-header__title__right__user-id {\n  display: block;\n  max-width: 200px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-channel-header .sendbird-channel-header__right-icon {\n  position: absolute;\n  right: 16px;\n  top: 16px;\n}\n.sendbird-image-renderer {\n  overflow: hidden;\n  position: relative;\n}\n\n.sendbird-image-renderer__hidden-image-loader {\n  display: none;\n}\n\n.sendbird-image-renderer,\n.sendbird-image-renderer__image {\n  width: 320px;\n  height: 180px;\n}\n.sendbird-avatar {\n  display: inline-block;\n  overflow: hidden;\n  border-radius: 50%;\n  position: relative;\n}\n.sendbird-avatar:focus {\n  outline: none;\n}\n.sendbird-avatar .sendbird-avatar-img {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.sendbird-theme--light .sendbird-avatar .sendbird-avatar-img {\n  background-color: var(--sendbird-light-background-300);\n}\n.sendbird-theme--dark .sendbird-avatar .sendbird-avatar-img {\n  background-color: var(--sendbird-dark-background-300);\n}\n.sendbird-avatar .sendbird-avatar--inner__two-child .sendbird-avatar-img:first-child {\n  transform: translate(2%, -50%);\n}\n.sendbird-avatar .sendbird-avatar--inner__two-child .sendbird-avatar-img:last-child {\n  transform: translate(-102%, -50%);\n}\n.sendbird-avatar .sendbird-avatar--inner__three-child--upper .sendbird-avatar-img:first-child {\n  transform: translate(-50%, -102%);\n}\n.sendbird-avatar .sendbird-avatar--inner__three-child--lower .sendbird-avatar-img:first-child {\n  transform: translate(-77%, -23%) scale(0.5);\n}\n.sendbird-avatar .sendbird-avatar--inner__three-child--lower .sendbird-avatar-img:last-child {\n  transform: translate(-23%, -23%) scale(0.5);\n}\n.sendbird-avatar .sendbird-avatar--inner__four-child .sendbird-avatar-img:first-child {\n  transform: translate(-77%, -77%) scale(0.5);\n}\n.sendbird-avatar .sendbird-avatar--inner__four-child .sendbird-avatar-img:nth-child(2) {\n  transform: translate(-23%, -77%) scale(0.5);\n}\n.sendbird-avatar .sendbird-avatar--inner__four-child .sendbird-avatar-img:nth-child(3) {\n  transform: translate(-77%, -23%) scale(0.5);\n}\n.sendbird-avatar .sendbird-avatar--inner__four-child .sendbird-avatar-img:last-child {\n  transform: translate(-23%, -23%) scale(0.5);\n}\n.sendbird-avatar .sendbird-avatar-img--default {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.sendbird-theme--light .sendbird-avatar .sendbird-avatar-img--default {\n  background-color: var(--sendbird-light-background-300);\n}\n.sendbird-theme--dark .sendbird-avatar .sendbird-avatar-img--default {\n  background-color: var(--sendbird-dark-background-300);\n}\n.sendbird--mobile-mode .sendbird-add-channel__modal .sendbird-modal__content {\n  margin: 0 40px;\n}\n\n.sendbird-add-channel__rectangle-wrap {\n  margin-top: 26px;\n}\n\n.sendbird-add-channel__rectangle-footer {\n  text-align: right;\n  margin-top: 32px;\n}\n\n.sendbird-add-channel__rectangle {\n  width: 432px;\n  height: 72px;\n  border-radius: 4px;\n  margin-bottom: 8px;\n  padding: 25px 72px;\n  position: relative;\n  box-sizing: border-box;\n  cursor: pointer;\n}\n.sendbird--mobile-mode .sendbird-add-channel__rectangle {\n  min-width: 288px;\n  width: 100%;\n  padding-right: 0;\n}\n.sendbird-theme--light .sendbird-add-channel__rectangle {\n  border: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-add-channel__rectangle {\n  border: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-add-channel__rectangle .sendbird-icon {\n  position: absolute;\n  left: 22px;\n  top: 24px;\n}\n.sendbird-create-channel--content {\n  width: 480px;\n  max-height: 552px;\n}\n\n.sendbird-create-channel--scroll {\n  height: 360px;\n  overflow-x: hidden;\n  overflow-y: scroll;\n}\n.sendbird--mobile-mode .sendbird-create-channel--scroll {\n  height: calc(100vh - 200px);\n  height: calc(var(--sendbird-vh, 1vh) * 100 - 200px);\n}\n.sendbird-user-list-item {\n  display: block;\n  position: relative;\n  box-sizing: border-box;\n  width: 432px;\n  height: 56px;\n}\n.sendbird--mobile-mode .sendbird-user-list-item {\n  width: 100%;\n}\n.sendbird-theme--light .sendbird-user-list-item {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-user-list-item {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-user-list-item .sendbird-user-list-item__avatar {\n  position: absolute;\n  top: 8px;\n  left: 0px;\n  cursor: pointer;\n}\n.sendbird-user-list-item .sendbird-muted-avatar {\n  position: absolute;\n  top: 8px;\n  left: 0px;\n  pointer-events: none;\n}\n.sendbird-user-list-item .sendbird-user-list-item__title {\n  position: absolute;\n  top: 17px;\n  left: 56px;\n  max-width: 250px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird--mobile-mode .sendbird-user-list-item .sendbird-user-list-item__title {\n  max-width: 62%;\n}\n.sendbird-user-list-item .sendbird-user-list-item__subtitle {\n  position: absolute;\n  top: 23px;\n  left: 140px;\n  max-width: 237px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird--mobile-mode .sendbird-user-list-item .sendbird-user-list-item__subtitle {\n  max-width: 40%;\n}\n.sendbird-user-list-item .sendbird-user-list-item__checkbox {\n  position: absolute;\n  top: 16px;\n  right: 16px;\n}\n.sendbird-user-list-item .sendbird-user-list-item__action {\n  position: absolute;\n  right: 0;\n  top: 10px;\n}\n.sendbird-user-list-item .sendbird-user-list-item__operator {\n  position: absolute;\n  right: 40px;\n  top: 22px;\n}\n.sendbird-user-list-item .sendbird-user-list-item__operator.checkbox {\n  right: 66px;\n}\n.sendbird-muted-avatar {\n  border-radius: 50%;\n  display: inline-block;\n}\n.sendbird-muted-avatar .sendbird-muted-avatar__icon {\n  position: relative;\n}\n.sendbird-muted-avatar .sendbird-muted-avatar__icon .sendbird-icon {\n  position: absolute;\n  top: 4px;\n  left: 4px;\n}\n.sendbird-muted-avatar .sendbird-muted-avatar__bg {\n  opacity: 0.5;\n  position: absolute;\n  border-radius: 50%;\n  top: 0;\n  left: 0;\n}\n.sendbird-theme--light .sendbird-muted-avatar .sendbird-muted-avatar__bg {\n  background-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-muted-avatar .sendbird-muted-avatar__bg {\n  background-color: var(--sendbird-dark-primary-300);\n}\n.sendbird-checkbox {\n  display: inline-block;\n  position: relative;\n  padding-left: 35px;\n  margin-bottom: 12px;\n  cursor: pointer;\n  font-size: 22px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\n.sendbird-checkbox input {\n  position: absolute;\n  opacity: 0;\n  cursor: pointer;\n  height: 0;\n  width: 0;\n}\n\n.sendbird-checkbox--checkmark {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 18px;\n  width: 18px;\n  border-radius: 2px;\n  background-color: inherit;\n}\n.sendbird-theme--light .sendbird-checkbox--checkmark {\n  border: solid 2px var(--sendbird-light-background-400);\n}\n.sendbird-theme--dark .sendbird-checkbox--checkmark {\n  border: solid 2px var(--sendbird-dark-background-300);\n}\n.sendbird-theme--light .sendbird-checkbox--checkmark.disabled {\n  border: solid 2px var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-checkbox--checkmark.disabled {\n  border: solid 2px var(--sendbird-dark-ondark-04);\n}\n\n.sendbird-theme--light .sendbird-checkbox input:focus ~ .sendbird-checkbox--checkmark {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-checkbox input:focus ~ .sendbird-checkbox--checkmark {\n  box-shadow: 0px 0px 0px 2px var(--sendbird-dark-primary-200);\n}\n\n.sendbird-theme--light .sendbird-checkbox input:checked ~ .sendbird-checkbox--checkmark {\n  background-color: var(--sendbird-light-primary-300);\n  border: solid 2px var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-checkbox input:checked ~ .sendbird-checkbox--checkmark {\n  background-color: var(--sendbird-dark-primary-200);\n  border: solid 2px var(--sendbird-dark-primary-200);\n}\n.sendbird-checkbox input:checked ~ .sendbird-checkbox--checkmark.disabled {\n  cursor: default;\n}\n.sendbird-theme--light .sendbird-checkbox input:checked ~ .sendbird-checkbox--checkmark.disabled {\n  background-color: var(--sendbird-light-onlight-04);\n  border: solid 2px var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-checkbox input:checked ~ .sendbird-checkbox--checkmark.disabled {\n  background-color: var(--sendbird-dark-ondark-04);\n  border: solid 2px var(--sendbird-dark-ondark-04);\n}\n\n.sendbird-checkbox--checkmark:after {\n  content: \"\";\n  position: absolute;\n  display: none;\n}\n\n.sendbird-checkbox input:checked ~ .sendbird-checkbox--checkmark:after {\n  display: block;\n}\n\n.sendbird-theme--light .sendbird-checkbox .sendbird-checkbox--checkmark:after {\n  left: 5px;\n  top: -0.5px;\n  width: 7px;\n  height: 12px;\n  border: solid var(--sendbird-light-background-50);\n  border-width: 0 2px 2px 0;\n  transform: rotate(45deg);\n}\n.sendbird-theme--dark .sendbird-checkbox .sendbird-checkbox--checkmark:after {\n  left: 5px;\n  top: -0.5px;\n  width: 7px;\n  height: 12px;\n  border: solid var(--sendbird-dark-background-600);\n  border-width: 0 2px 2px 0;\n  transform: rotate(45deg);\n}\n.sendbird__user-profile {\n  width: 320px;\n  border-radius: 4px;\n  padding: 24px;\n  box-sizing: border-box;\n  text-align: center;\n}\n.sendbird-theme--light .sendbird__user-profile {\n  box-shadow: var(--sendbird-light-shadow-02);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird__user-profile {\n  box-shadow: var(--sendbird-dark-shadow-02);\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird__user-profile .sendbird__user-profile-avatar {\n  margin: 8px 0px;\n}\n.sendbird__user-profile .sendbird__user-profile-name {\n  max-width: 100%;\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-theme--light .sendbird__user-profile .sendbird__user-profile-name {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird__user-profile .sendbird__user-profile-name {\n  color: var(--sendbird-dark-ondark-01);\n}\n.sendbird__user-profile .sendbird__user-profile-message {\n  margin-top: 20px;\n}\n.sendbird__user-profile .sendbird__user-profile-message button {\n  width: 272px;\n}\n.sendbird__user-profile .sendbird__user-profile-separator {\n  margin: 24px 0px;\n  height: 1px;\n}\n.sendbird-theme--light .sendbird__user-profile .sendbird__user-profile-separator {\n  background-color: var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird__user-profile .sendbird__user-profile-separator {\n  background-color: var(--sendbird-dark-ondark-04);\n}\n.sendbird__user-profile .sendbird__user-profile-userId--label,\n.sendbird__user-profile .sendbird__user-profile-userId--value {\n  width: 100%;\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  display: block;\n  text-align: left;\n}\n.sendbird__user-profile .sendbird__user-profile-userId--label {\n  margin-bottom: 8px;\n}\n.sendbird-context-menu {\n  display: \"inline\";\n}\n\n.sendbird__offline .sendbird-dropdown__menu .sendbird-dropdown__menu-item {\n  cursor: not-allowed;\n}\n\n.sendbird-dropdown__menu {\n  z-index: 99999;\n  position: absolute;\n  top: 100%;\n  left: 0;\n  min-width: 140px;\n  margin: 0px;\n  padding: 8px 0px;\n  border-radius: 4px;\n  list-style: none;\n}\n.sendbird-theme--light .sendbird-dropdown__menu {\n  box-shadow: var(--sendbird-light-shadow-02);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-dropdown__menu {\n  box-shadow: var(--sendbird-dark-shadow-02);\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-dropdown__menu .sendbird-dropdown__menu-item {\n  cursor: pointer;\n  white-space: nowrap;\n  padding: 8px 16px;\n}\n.sendbird-dropdown__menu .sendbird-dropdown__menu-item.disable {\n  cursor: not-allowed;\n}\n.sendbird-theme--light .sendbird-dropdown__menu .sendbird-dropdown__menu-item.disable:hover {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-dropdown__menu .sendbird-dropdown__menu-item.disable:hover {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-dropdown__menu .sendbird-dropdown__menu-item:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-dropdown__menu .sendbird-dropdown__menu-item:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n\n.sendbird-dropdown__reaction-bar {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  min-width: 44px;\n  max-width: 352px;\n  max-height: 208px;\n  overflow-y: scroll;\n  margin: 0px;\n  padding: 8px;\n  border-radius: 8px;\n  list-style: none;\n}\n.sendbird-theme--light .sendbird-dropdown__reaction-bar {\n  box-shadow: var(--sendbird-light-shadow-02);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-dropdown__reaction-bar {\n  box-shadow: var(--sendbird-dark-shadow-02);\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-dropdown__reaction-bar .sendbird-dropdown__reaction-bar__row .sendbird-reaction-button, .sendbird-dropdown__reaction-bar .sendbird-dropdown__reaction-bar__row .sendbird-reaction-button--selected {\n  margin: 4px;\n}\n\n.sendbird-dropdown__menu-backdrop {\n  background-color: transparent;\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.sendbird-sort-by-row {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n}\n.sendbird-channel-preview__leave--mobile .sendbird-modal__content {\n  max-width: calc(100% - 80px);\n}\n.sendbird-channel-preview__leave--mobile .sendbird-modal__close {\n  display: none;\n}\n.sendbird-channel-preview__leave--mobile .sendbird-channel-preview__leave-label--mobile {\n  text-decoration: none;\n}\n.sendbird-channel-preview__leave--mobile .sendbird-modal__header span {\n  display: inline-block;\n  width: calc(100% - 120px);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.sendbird__offline .sendbird-channel-preview {\n  cursor: not-allowed;\n}\n\n.sendbird-channel-preview {\n  position: relative;\n  cursor: pointer;\n  box-sizing: border-box;\n  width: 320px;\n  height: 80px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  padding: 12px 16px 12px 16px;\n}\n.sendbird-theme--light .sendbird-channel-preview {\n  border-bottom: solid 1px var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-channel-preview {\n  border-bottom: solid 1px var(--sendbird-dark-ondark-04);\n}\n.sendbird--mobile-mode .sendbird-channel-preview {\n  width: 100%;\n}\n.sendbird-channel-preview:focus {\n  outline: none;\n}\n.sendbird-channel-preview .sendbird-channel-preview__avatar {\n  width: 56px;\n  height: 56px;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content {\n  width: 100%;\n  height: 100%;\n  margin-left: 16px;\n}\n.sendbird--mobile-mode .sendbird-channel-preview .sendbird-channel-preview__content {\n  position: relative;\n  max-width: calc(100% - 72px);\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__upper {\n  display: flex;\n  justify-content: space-between;\n  width: 216px;\n  height: 16px;\n}\n.sendbird--mobile-mode .sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__upper {\n  width: auto;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__upper .sendbird-channel-preview__content__upper__header {\n  display: flex;\n  justify-content: flex-start;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__upper .sendbird-channel-preview__content__upper__header .sendbird-channel-preview__content__upper__header__broadcast-icon {\n  padding-right: 4px;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__upper .sendbird-channel-preview__content__upper__header .sendbird-channel-preview__content__upper__header__channel-name {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 128px;\n  word-break: break-all;\n  white-space: nowrap;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__upper .sendbird-channel-preview__content__upper__header .sendbird-channel-preview__content__upper__header__total-members {\n  margin-top: 2px;\n  margin-left: 4px;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__upper .sendbird-channel-preview__content__upper__header .sendbird-channel-preview__content__upper__header__frozen-icon {\n  padding-left: 4px;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__upper .sendbird-channel-preview__content__upper__last-message-at {\n  margin-left: 4px;\n  margin-bottom: 4px;\n  white-space: nowrap;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__upper .sendbird-channel-preview__content__upper__last-message-at.sendbird-message-status {\n  max-width: 74px;\n  justify-content: flex-end;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__lower {\n  margin-top: 8px;\n  width: 216px;\n  height: 32px;\n  display: flex;\n  justify-content: space-between;\n}\n.sendbird--mobile-mode .sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__lower {\n  width: 100%;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__lower .sendbird-channel-preview__content__lower__last-message {\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__lower .sendbird-channel-preview__content__lower__unread-message-count {\n  display: flex;\n  align-items: center;\n  margin-left: 8px;\n  margin-bottom: 12px;\n}\n.sendbird-channel-preview .sendbird-channel-preview__content .sendbird-channel-preview__content__lower .sendbird-channel-preview__content__lower__unread-message-count .sendbird-channel-preview__content__lower__unread-message-count__mention {\n  display: inline-flex;\n  align-items: center;\n  margin-right: 4px;\n}\n.sendbird-channel-preview .sendbird-channel-preview__action {\n  position: absolute;\n  top: 12px;\n  right: 12px;\n  display: inline-block;\n}\n.sendbird-channel-preview .sendbird-channel-preview__action .sendbird-iconbutton {\n  display: none;\n}\n.sendbird-theme--light .sendbird-channel-preview:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-channel-preview:hover {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-channel-preview:hover .sendbird-channel-preview__action .sendbird-iconbutton {\n  display: inline-block;\n}\n.sendbird-channel-preview:hover .sendbird-channel-preview__content__upper__last-message-at {\n  display: none;\n}\n.sendbird-channel-preview:hover .sendbird-channel-preview__content__lower__unread-message-count {\n  display: none;\n}\n\n.sendbird-channel-preview--active {\n  padding: 12px 16px 12px 12px;\n}\n.sendbird-theme--light .sendbird-channel-preview--active {\n  border-left: solid 4px var(--sendbird-light-primary-300);\n  border-bottom: solid 1px var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-channel-preview--active {\n  border-left: solid 4px var(--sendbird-dark-primary-200);\n  border-bottom: solid 1px var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-theme--light .sendbird-channel-preview--active .sendbird-channel-preview__content__upper__header__channel-name {\n  color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-channel-preview--active .sendbird-channel-preview__content__upper__header__channel-name {\n  color: var(--sendbird-dark-primary-200);\n}\n\n.sendbird--mobile-mode .sendbird-channel-preview__content__lower__unread-message-count {\n  position: absolute;\n  right: 0;\n}\n.sendbird-chat-header--default-avatar {\n  width: 56px;\n  height: 56px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 50%;\n}\n.sendbird-theme--light .sendbird-chat-header--default-avatar {\n  background-color: var(--sendbird-light-secondary-300);\n}\n.sendbird-theme--dark .sendbird-chat-header--default-avatar {\n  background-color: var(--sendbird-dark-secondary-200);\n}\n.sendbird-badge {\n  height: 20px;\n  min-width: 20px;\n  border-radius: 10px;\n  display: inline-block;\n}\n.sendbird-theme--light .sendbird-badge {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-badge {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-badge .sendbird-badge__text {\n  margin: 0px 6px;\n}\n.sendbird-mention-user-label {\n  display: inline-block;\n  font-family: var(--sendbird-font-family-default);\n  font-size: 14px;\n  font-weight: bold;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.43;\n  letter-spacing: normal;\n  white-space: pre-line;\n  width: -moz-fit-content;\n  width: fit-content;\n  max-width: 100%;\n  height: 16px;\n}\n.sendbird-mention-user-label:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-mention-user-label {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-mention-user-label {\n  color: var(--sendbird-dark-ondark-01);\n}\n.sendbird-theme--light .sendbird-mention-user-label.reverse {\n  color: var(--sendbird-light-ondark-01);\n}\n.sendbird-theme--dark .sendbird-mention-user-label.reverse {\n  color: var(--sendbird-dark-onlight-01);\n}\n.sendbird-mention-user-label.purple {\n  font-family: Roboto;\n  font-size: 18px;\n  font-weight: bold;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: normal;\n  letter-spacing: normal;\n}\n.sendbird-theme--light .sendbird-mention-user-label.purple {\n  color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-mention-user-label.purple {\n  color: var(--sendbird-dark-primary-200);\n}\n.sendbird-textbutton {\n  text-decoration: underline;\n  cursor: pointer;\n  display: inline-block;\n}\n\n.sendbird-textbutton--not-underline {\n  text-decoration: none;\n  cursor: pointer;\n}\n\n.sendbird-textbutton--disabled {\n  cursor: not-allowed;\n}\n.sendbird-theme--light .sendbird-textbutton--disabled {\n  color: var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-textbutton--disabled {\n  color: var(--sendbird-dark-ondark-03);\n}\n.sendbird-theme--light .sendbird-color--onbackground-1 {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-color--onbackground-1 {\n  color: var(--sendbird-dark-ondark-01);\n}\n.sendbird-theme--light .sendbird-color--onbackground-1--background-color {\n  background-color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-color--onbackground-1--background-color {\n  background-color: var(--sendbird-dark-ondark-01);\n}\n\n.sendbird-theme--light .sendbird-color--onbackground-2 {\n  color: var(--sendbird-light-onlight-02);\n}\n.sendbird-theme--dark .sendbird-color--onbackground-2 {\n  color: var(--sendbird-dark-ondark-02);\n}\n.sendbird-theme--light .sendbird-color--onbackground-2--background-color {\n  background-color: var(--sendbird-light-onlight-02);\n}\n.sendbird-theme--dark .sendbird-color--onbackground-2--background-color {\n  background-color: var(--sendbird-dark-ondark-02);\n}\n\n.sendbird-theme--light .sendbird-color--onbackground-3 {\n  color: var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-color--onbackground-3 {\n  color: var(--sendbird-dark-ondark-03);\n}\n.sendbird-theme--light .sendbird-color--onbackground-3--background-color {\n  background-color: var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-color--onbackground-3--background-color {\n  background-color: var(--sendbird-dark-ondark-03);\n}\n\n.sendbird-theme--light .sendbird-color--onbackground-4 {\n  color: var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-color--onbackground-4 {\n  color: var(--sendbird-dark-ondark-04);\n}\n.sendbird-theme--light .sendbird-color--onbackground-4--background-color {\n  background-color: var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-color--onbackground-4--background-color {\n  background-color: var(--sendbird-dark-ondark-04);\n}\n\n.sendbird-theme--light .sendbird-color--oncontent-1 {\n  color: var(--sendbird-light-ondark-01);\n}\n.sendbird-theme--dark .sendbird-color--oncontent-1 {\n  color: var(--sendbird-dark-onlight-01);\n}\n.sendbird-theme--light .sendbird-color--oncontent-1--background-color {\n  background-color: var(--sendbird-light-ondark-01);\n}\n.sendbird-theme--dark .sendbird-color--oncontent-1--background-color {\n  background-color: var(--sendbird-dark-onlight-01);\n}\n\n.sendbird-theme--light .sendbird-color--primary {\n  color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-color--primary {\n  color: var(--sendbird-dark-primary-200);\n}\n.sendbird-theme--light .sendbird-color--primary--background-color {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-color--primary--background-color {\n  background-color: var(--sendbird-dark-primary-200);\n}\n\n.sendbird-theme--light .sendbird-color--error {\n  color: var(--sendbird-light-error-300);\n}\n.sendbird-theme--dark .sendbird-color--error {\n  color: var(--sendbird-dark-error-200);\n}\n.sendbird-theme--light .sendbird-color--error--background-color {\n  background-color: var(--sendbird-light-error-300);\n}\n.sendbird-theme--dark .sendbird-color--error--background-color {\n  background-color: var(--sendbird-dark-error-300);\n}\n.sendbird-message-status {\n  position: relative;\n  display: inline-flex;\n  align-items: flex-start;\n  width: 100%;\n  height: 100%;\n}\n.sendbird-message-status .sendbird-message-status__icon {\n  position: relative;\n  display: inline-block;\n  top: -2px;\n}\n.sendbird-message-status .sendbird-message-status__icon.hide-icon {\n  display: none;\n}\n.sendbird-message-status .sendbird-message-status__text {\n  position: relative;\n  display: inline-block;\n  margin-left: 4px;\n}\n.sendbird-message-status .sendbird-message-status__text .sendbird-message-status__text__try-again {\n  text-decoration: underline;\n}\n.sendbird-message-status .sendbird-message-status__text .sendbird-message-status__text__try-again:hover {\n  cursor: pointer;\n}\n.sendbird-message-status .sendbird-message-status__text .sendbird-message-status__text__delete {\n  text-decoration: underline;\n}\n.sendbird-message-status .sendbird-message-status__text .sendbird-message-status__text__delete:hover {\n  cursor: pointer;\n}\n.sendbird-loader {\n  display: inline-block;\n  animation: 1s infinite linear;\n  animation-name: rotate;\n}\n\n@keyframes rotate {\n  from {\n    transform: rotate(0);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.sendbird-edit-user-profile section {\n  margin-top: 16px;\n}\n.sendbird-edit-user-profile section .sendbird-input-label {\n  display: block;\n  margin-bottom: 12px;\n}\n.sendbird-edit-user-profile .sendbird-edit-user-profile__img .sendbird-input-label {\n  margin-bottom: 12px;\n}\n\n.sendbird-edit-user-profile__img {\n  position: relative;\n}\n\n.sendbird-edit-user-profile__img__avatar-button {\n  position: absolute;\n  top: 50px;\n  left: 96px;\n}\n\n.sendbird-edit-user-profile__theme__theme-icon .sendbird-icon {\n  cursor: pointer;\n}\n.sendbird-input {\n  display: inline-block;\n  width: 100%;\n  height: 40px;\n  position: relative;\n}\n.sendbird-input .sendbird-input__input {\n  width: 100%;\n  height: 100%;\n  border-radius: 4px;\n  font-family: var(--sendbird-font-family-default);\n  font-size: 14px;\n  font-weight: normal;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.43;\n  letter-spacing: normal;\n  padding: 10px 16px;\n  box-sizing: border-box;\n  background-color: inherit;\n}\n.sendbird-theme--light .sendbird-input .sendbird-input__input {\n  color: var(--sendbird-light-onlight-01);\n  caret-color: var(--sendbird-light-primary-300);\n  border: solid 1px var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-input .sendbird-input__input {\n  color: var(--sendbird-dark-ondark-01);\n  caret-color: var(--sendbird-dark-primary-200);\n  border: solid 1px var(--sendbird-dark-ondark-03);\n}\n.sendbird-input .sendbird-input__input:focus {\n  outline: none;\n}\n.sendbird-theme--light .sendbird-input .sendbird-input__input:focus {\n  box-shadow: 0 1px 5px 0 var(--sendbird-light-onlight-04), 0 0 1px 0 rgba(0, 0, 0, 0.16), 0 2px 1px 0 rgba(0, 0, 0, 0.08);\n  color: var(--sendbird-light-onlight-01);\n  border: solid 2px var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-input .sendbird-input__input:focus {\n  box-shadow: 0 1px 5px 0 var(--sendbird-dark-ondark-04), 0 0 1px 0 rgba(0, 0, 0, 0.16), 0 2px 1px 0 rgba(0, 0, 0, 0.08);\n  color: var(--sendbird-dark-ondark-01);\n  border: solid 2px var(--sendbird-dark-primary-200);\n}\n.sendbird-theme--light .sendbird-input .sendbird-input__input:active {\n  box-shadow: 0 1px 5px 0 var(--sendbird-light-onlight-04), 0 0 1px 0 rgba(0, 0, 0, 0.16), 0 2px 1px 0 rgba(0, 0, 0, 0.08);\n  color: var(--sendbird-light-onlight-01);\n  border: solid 1px var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-input .sendbird-input__input:active {\n  box-shadow: 0 1px 5px 0 var(--sendbird-dark-ondark-04), 0 0 1px 0 rgba(0, 0, 0, 0.16), 0 2px 1px 0 rgba(0, 0, 0, 0.08);\n  color: var(--sendbird-dark-ondark-01);\n  border: solid 1px var(--sendbird-dark-primary-200);\n}\n.sendbird-input .sendbird-input__input:disabled {\n  cursor: not-allowed;\n}\n.sendbird-theme--light .sendbird-input .sendbird-input__input:disabled {\n  background-color: var(--sendbird-light-background-100);\n  color: var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-input .sendbird-input__input:disabled {\n  background-color: var(--sendbird-dark-background-500);\n  color: var(--sendbird-dark-ondark-03);\n}\n.sendbird-input .sendbird-input__placeholder {\n  position: absolute;\n  pointer-events: none;\n  top: 10px;\n  left: 16px;\n  font-family: var(--sendbird-font-family-default);\n  font-size: 14px;\n  line-height: 1.43;\n}\n.sendbird-theme--light .sendbird-input .sendbird-input__placeholder {\n  color: var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-input .sendbird-input__placeholder {\n  color: var(--sendbird-dark-ondark-03);\n}\n\n.sendbird-input-label {\n  margin: 4px 0;\n}\n.sendbird-place-holder {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n}\n.sendbird-place-holder .sendbird-place-holder__body {\n  display: flex;\n  flex-direction: column;\n  height: 104px;\n  align-items: center;\n}\n.sendbird-place-holder .sendbird-place-holder__body .sendbird-place-holder__body__icon {\n  margin-bottom: 10px;\n}\n.sendbird-place-holder .sendbird-place-holder__body .sendbird-place-holder__body__text {\n  margin-top: 10px;\n}\n.sendbird-place-holder .sendbird-place-holder__body__reconnect {\n  margin-top: 18px;\n  display: flex;\n  flex-direction: row;\n  cursor: pointer;\n}\n.sendbird-place-holder .sendbird-place-holder__body__reconnect .sendbird-place-holder__body__reconnect__icon {\n  margin-right: 4px;\n}\n.sendbird-place-holder .sendbird-place-holder__body--align-top {\n  position: absolute;\n  top: 24px;\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  justify-content: center;\n}\n.sendbird-place-holder .sendbird-place-holder__body--align-top .sendbird-place-holder__body--align-top__text {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  padding-left: 16px;\n  padding-right: 16px;\n}\n.sendbird-place-holder .sendbird-place-holder__body--align-top .sendbird-place-holder__body--align-top__text .sendbird-place-holder__body--align-top__text__search-in {\n  display: flex;\n  min-width: 60px;\n  margin-right: 2px;\n}\n.sendbird-place-holder .sendbird-place-holder__body--align-top .sendbird-place-holder__body--align-top__text .sendbird-place-holder__body--align-top__text__channel-name {\n  display: block;\n  max-width: calc(100% - 62px);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-place-holder .sendbird-place-holder__body--align-top .sendbird-place-hlder__body--align-top__searching,\n.sendbird-place-holder .sendbird-place-holder__body--align-top .sendbird-place-hlder__body--align-top__no-result {\n  display: flex;\n  justify-content: center;\n}\n.sendbird-conversation {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-conversation {\n  background-color: var(--sendbird-light-background-50);\n  border: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-conversation {\n  background-color: var(--sendbird-dark-background-600);\n  border: 1px solid var(--sendbird-dark-ondark-04);\n}\n\n.sendbird-conversation__messages {\n  overflow: hidden;\n  flex: 1 1 0;\n  order: 2;\n}\n\n.sendbird-conversation__messages-list {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  justify-content: flex-end;\n}\n\n.sendbird-conversation__footer {\n  width: 100%;\n  order: 3;\n  padding: 0px 0px 24px 0px;\n}\n\n@keyframes sbHighlight {\n  0% {\n    background-color: #FFF2B6;\n  }\n  99% {\n    background-color: #FFF2B6;\n  }\n}\n@keyframes sbTextHighlight {\n  0% {\n    color: var(--sendbird-dark-onlight-01);\n  }\n  99% {\n    color: var(--sendbird-dark-onlight-01);\n  }\n}\n@keyframes sbHighlightBlock {\n  0% {\n    opacity: 0.5;\n    background-color: #FFF2B6;\n  }\n  99% {\n    opacity: 0.5;\n    background-color: #FFF2B6;\n  }\n}\n.sendbird-msg-hoc__animated .sendbird-message-content {\n  animation: bounce 1s ease;\n}\n@keyframes bounce {\n  50% {\n    transform: translateY(-10px);\n  }\n  60% {\n    transform: translateY(0);\n  }\n  90% {\n    transform: translateY(-10px);\n  }\n  100% {\n    transform: translateY(0);\n  }\n}\n\n.sendbird-msg-hoc__highlighted .sendbird-text-message-item-body,\n.sendbird-msg-hoc__highlighted .sendbird-file-message-item-body {\n  animation-name: sbHighlight;\n  animation-duration: 1.6s;\n  animation-fill-mode: forwards;\n}\n.sendbird-msg-hoc__highlighted .sendbird-text-message-item-body__message,\n.sendbird-msg-hoc__highlighted .sendbird-file-message-item-body__file-name__text {\n  animation-name: sbTextHighlight;\n  animation-duration: 1.6s;\n  animation-fill-mode: forwards;\n}\n.sendbird-msg-hoc__highlighted .sendbird-voice-message-item-body {\n  display: block;\n  animation-name: sbHighlightBlock;\n  animation-duration: 1.6s;\n  animation-fill-mode: forwards;\n}\n.sendbird-msg-hoc__highlighted .sendbird-thumbnail-message-item-body .sendbird-thumbnail-message-item-body__image-cover {\n  display: block;\n  animation-name: sbHighlightBlock;\n  animation-duration: 1.6s;\n  animation-fill-mode: forwards;\n}\n.sendbird-msg-hoc__highlighted .sendbird-og-message-item-body .sendbird-og-message-item-body__cover {\n  display: block;\n  animation-name: sbHighlightBlock;\n  animation-duration: 1.6s;\n  animation-fill-mode: forwards;\n}\n.sendbird-msg-hoc__highlighted .sendbird-message-content-reactions {\n  animation-name: sbHighlight;\n  animation-duration: 1.6s;\n  animation-fill-mode: forwards;\n}\n\n.sendbird-conversation__scroll-container {\n  display: flex;\n  height: 100%;\n  overflow-y: auto;\n  overflow-x: hidden;\n  flex-direction: column;\n}\n.sendbird-conversation__scroll-container .sendbird-conversation__padding {\n  flex: 1 1 0;\n}\n\n.sendbird-conversation__footer {\n  position: relative;\n  box-sizing: border-box;\n  margin-top: 6px;\n}\n.sendbird-conversation__footer .sendbird-conversation__footer__typing-indicator {\n  position: absolute;\n  display: inline-flex;\n  bottom: 8px;\n}\n.sendbird-conversation__footer .sendbird-conversation__footer__typing-indicator .sendbird-conversation__footer__typing-indicator__text {\n  margin-left: 24px;\n  margin-right: 10px;\n}\n.sendbird-connection-status {\n  display: flex;\n  align-items: center;\n  padding-top: 5px;\n}\n.sendbird-chat-header {\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  height: 64px;\n  min-height: 64px;\n  padding-left: 20px;\n  padding-right: 16px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-chat-header {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-chat-header {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-chat-header__left {\n  margin-right: 24px;\n}\n.sendbird-chat-header__left, .sendbird-chat-header__right {\n  overflow: hidden;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n.sendbird-chat-header .sendbird-chat-header__left__title {\n  margin-left: 8px;\n  margin-right: 16px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  max-width: 780px;\n}\n.sendbird--mobile-mode .sendbird-chat-header .sendbird-chat-header__left__title {\n  max-width: calc(100vw - 240px);\n}\n.sendbird-chat-header .sendbird-chat-header__left__subtitle {\n  max-width: 240px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-chat-header .sendbird-chat-header__right__mute {\n  margin-right: 18px;\n}\n.sendbird-chat-header .sendbird-iconbutton--pressed {\n  background-color: inherit;\n}\n.sendbird-chat-header .sendbird-chat-header__right__info {\n  margin-left: 16px;\n}\n\n.sendbird-chat-header__icon_back {\n  margin-right: 8px;\n}\n.sendbird-conversation__messages {\n  position: relative;\n}\n.sendbird-conversation__messages .sendbird-conversation__messages-padding {\n  position: relative;\n  padding-left: 24px;\n  padding-right: 24px;\n  height: 100%;\n  overflow-x: hidden;\n  overflow-y: scroll;\n}\n.sendbird-conversation__messages .sendbird-separator,\n.sendbird-conversation__messages .sendbird-admin-message {\n  padding-top: 8px;\n  padding-bottom: 8px;\n}\n\n.sendbird-conversation__messages__notification {\n  position: fixed;\n  top: 0px;\n  width: calc(100% - 50px);\n  margin-left: 25px;\n}\n\n.sendbird-conversation__scroll-bottom-button {\n  position: sticky;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  bottom: 30px;\n  left: calc(100% - 65px);\n  width: 40px;\n  height: 40px;\n  border-radius: 24px;\n}\n.sendbird-theme--light .sendbird-conversation__scroll-bottom-button {\n  background-color: var(--sendbird-light-background-50);\n  box-shadow: var(--sendbird-light-shadow-05);\n}\n.sendbird-theme--dark .sendbird-conversation__scroll-bottom-button {\n  background-color: var(--sendbird-dark-background-400);\n  box-shadow: var(--sendbird-dark-shadow-05);\n}\n.sendbird-conversation__scroll-bottom-button:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-conversation__scroll-bottom-button:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-conversation__scroll-bottom-button:hover {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-conversation__scroll-bottom-button:active {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-conversation__scroll-bottom-button:active {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-conversation__scroll-bottom-button:focus {\n  outline: none;\n}\n.sendbird-mention-suggest-list {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  width: calc(100% - 56px);\n  max-height: 260px;\n  overflow: scroll;\n  margin-left: 28px;\n  margin-right: 28px;\n}\n.sendbird-theme--light .sendbird-mention-suggest-list {\n  border: 1px solid var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-mention-suggest-list {\n  border: 1px solid var(--sendbird-dark-background-500);\n}\n.sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item {\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 16px 8px;\n}\n.sendbird-theme--light .sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-theme--light .sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item.focused {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item.focused {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__avatar {\n  position: relative;\n  display: inline-block;\n}\n.sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__nickname {\n  position: relative;\n  display: inline-block;\n  margin-left: 16px;\n  max-width: calc(100% - 250px);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird--mobile-mode .sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__nickname {\n  max-width: calc(100% - 150px);\n}\n.sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__user-id {\n  position: absolute;\n  display: inline-block;\n  right: 16px;\n  max-width: 180px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird--mobile-mode .sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__user-id {\n  max-width: 100px;\n}\n.sendbird-mention-suggest-list .sendbird-mention-suggest-list__notice-item {\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 16px 8px;\n}\n.sendbird-theme--light .sendbird-mention-suggest-list .sendbird-mention-suggest-list__notice-item {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-mention-suggest-list .sendbird-mention-suggest-list__notice-item {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-mention-suggest-list .sendbird-mention-suggest-list__notice-item .sendbird-mention-suggest-list__notice-item__icon {\n  margin-right: 4px;\n}\n.sendbird-separator {\n  width: 100%;\n  display: flex;\n  align-items: center;\n}\n.sendbird-separator .sendbird-separator__left {\n  border: none;\n  height: 1px;\n  display: inline-block;\n  width: 100%;\n}\n.sendbird-separator .sendbird-separator__right {\n  border: none;\n  height: 1px;\n  display: inline-block;\n  width: 100%;\n}\n.sendbird-separator .sendbird-separator__text {\n  margin: 0px 16px;\n  display: flex;\n  white-space: nowrap;\n}\n.sendbird-message-input {\n  display: inline-block;\n  width: 100%;\n  position: relative;\n}\n.sendbird-message-input .sendbird-message-input--textarea {\n  position: relative;\n  width: 100%;\n  border-radius: 4px;\n  font-size: 14px;\n  font-weight: normal;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.43;\n  height: 56px;\n  overflow-y: scroll;\n  letter-spacing: normal;\n  padding: 18px 64px 18px 16px;\n  box-sizing: border-box;\n  resize: none;\n  font-family: var(--sendbird-font-family-default);\n  background-color: inherit;\n  white-space: pre-wrap;\n}\n.sendbird-theme--light .sendbird-message-input .sendbird-message-input--textarea {\n  color: var(--sendbird-light-onlight-01);\n  caret-color: var(--sendbird-light-primary-300);\n  border: solid 1px var(--sendbird-light-onlight-03);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-message-input .sendbird-message-input--textarea {\n  color: var(--sendbird-dark-ondark-01);\n  caret-color: var(--sendbird-dark-primary-200);\n  border: solid 1px var(--sendbird-dark-ondark-03);\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-message-input .sendbird-message-input--textarea:focus {\n  outline: none;\n}\n.sendbird-theme--light .sendbird-message-input .sendbird-message-input--textarea:focus {\n  color: var(--sendbird-light-onlight-01);\n  border: solid 1px var(--sendbird-light-primary-300);\n  box-shadow: var(--sendbird-light-shadow-message-input);\n}\n.sendbird-theme--dark .sendbird-message-input .sendbird-message-input--textarea:focus {\n  color: var(--sendbird-dark-ondark-01);\n  border: solid 1px var(--sendbird-dark-primary-200);\n  box-shadow: var(--sendbird-dark-shadow-message-input);\n}\n.sendbird-theme--light .sendbird-message-input .sendbird-message-input--textarea:active {\n  border: solid 1px var(--sendbird-message-input-border-active);\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-message-input .sendbird-message-input--textarea:active {\n  border: solid 1px var(--sendbird-message-input-border-active);\n  color: var(--sendbird-dark-ondark-01);\n}\n.sendbird-message-input .sendbird-message-input--placeholder {\n  position: absolute;\n  pointer-events: none;\n  top: 18px;\n  left: 16px;\n  font-family: var(--sendbird-font-family-default);\n  font-size: 14px;\n  line-height: 1.43;\n}\n.sendbird-message-input .sendbird-message-input--attach {\n  position: absolute;\n  padding: 6px;\n  right: 16px;\n  bottom: 14px;\n}\n.sendbird-message-input .sendbird-message-input--attach.is-voice-message-enabled {\n  right: 48px;\n}\n.sendbird-message-input .sendbird-message-input--voice-message {\n  position: absolute;\n  padding: 6px;\n  right: 16px;\n  bottom: 14px;\n}\n.sendbird-message-input .sendbird-message-input--send {\n  position: absolute;\n  padding: 6px;\n  right: 16px;\n  bottom: 14px;\n}\n.sendbird-message-input .sendbird-message-input--attach-input {\n  display: none;\n}\n\n.sendbird-message-input__edit {\n  padding: 16px;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-message-input__edit {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-message-input__edit {\n  background-color: var(--sendbird-dark-background-700);\n}\n\n.sendbird-message-input--edit-action {\n  text-align: right;\n  margin-top: 4px;\n}\n.sendbird-message-input--edit-action button:last-child {\n  margin-left: 8px;\n}\n.sendbird-message-input--edit-action .sendbird-message-input--edit-action__cancel {\n  width: 80px;\n}\n.sendbird-theme--light .sendbird-message-input--edit-action .sendbird-message-input--edit-action__cancel {\n  border: solid 1px var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-message-input--edit-action .sendbird-message-input--edit-action__cancel {\n  border: solid 1px var(--sendbird-dark-ondark-03);\n}\n.sendbird-message-input--edit-action .sendbird-message-input--edit-action__save {\n  width: 80px;\n}\n\n.sendbird-message-input-form__disabled {\n  cursor: not-allowed;\n}\n\n.sendbird-message-input__disabled {\n  pointer-events: none;\n  cursor: not-allowed;\n}\n.sendbird-theme--light .sendbird-message-input__disabled .sendbird-message-input--textarea {\n  color: var(--sendbird-light-onlight-04);\n  border: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-message-input__disabled .sendbird-message-input--textarea {\n  color: var(--sendbird-dark-ondark-04);\n  border: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-message-content {\n  position: relative;\n  display: inline-flex;\n  flex-direction: row;\n  width: 100%;\n  height: 100%;\n}\n.sendbird-message-content.incoming {\n  justify-content: flex-start;\n}\n.sendbird-message-content.outgoing {\n  justify-content: flex-end;\n}\n.sendbird-message-content .sendbird-message-content__middle {\n  max-width: 400px;\n}\n.sendbird--mobile-mode .sendbird-message-content .sendbird-message-content__middle {\n  max-width: calc(100vw - 140px);\n}\n.sendbird-message-content .sendbird-message-content__middle .sendbird-message-content__middle__quote-message.use-quote {\n  margin-top: -8px;\n  bottom: -8px;\n}\n\n.sendbird-message-content__middle__quote-message__quote {\n  width: 100%;\n}\n\n.sendbird-message-content.incoming .sendbird-message-content__left {\n  position: relative;\n  display: inline-flex;\n  min-width: 40px;\n}\n.sendbird-message-content.incoming .sendbird-message-content__left .sendbird-message-content__left__avatar {\n  position: absolute;\n  left: 0px;\n  bottom: 2px;\n}\n.sendbird-message-content.incoming .sendbird-message-content__left .sendbird-message-content__left__avatar.use-thread-replies {\n  bottom: 35px;\n}\n.sendbird-message-content.incoming .sendbird-message-content__middle {\n  position: relative;\n  display: inline-flex;\n  flex-direction: column;\n  align-items: flex-start;\n}\n.sendbird-message-content.incoming .sendbird-message-content__middle .sendbird-message-content__middle__body-container .sendbird-message-content__middle__body-container__created-at {\n  position: absolute;\n  bottom: 6px;\n  right: -84px;\n  white-space: nowrap;\n  display: flex;\n  flex-direction: row;\n  min-width: 80px;\n}\n.sendbird-message-content.incoming .sendbird-message-content__middle .sendbird-message-content__middle__body-container .sendbird-message-content__middle__body-container__created-at.sendbird-mouse-hover {\n  display: none;\n}\n.sendbird-message-content.incoming .sendbird-message-content__middle .sendbird-message-content__middle__sender-name {\n  position: relative;\n  margin-left: 12px;\n  margin-bottom: 4px;\n  width: 100%;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-message-content.incoming .sendbird-message-content__middle .sendbird-message-content__middle__quote-message {\n  position: relative;\n  width: 100%;\n  display: inline-flex;\n}\n.sendbird-message-content.incoming .sendbird-message-content__middle .sendbird-message-content__middle__quote-message.outgoing {\n  justify-content: flex-end;\n}\n.sendbird-message-content.incoming .sendbird-message-content__middle .sendbird-message-content__middle__quote-message.incoming {\n  justify-content: flex-start;\n}\n.sendbird-message-content.incoming .sendbird-message-content__middle .sendbird-message-content__middle__quote-message:hover {\n  cursor: pointer;\n}\n.sendbird-message-content.incoming .sendbird-message-content__right {\n  position: relative;\n  display: inline-flex;\n  width: 50px;\n  margin-left: 4px;\n  padding-top: 18px;\n}\n.sendbird-message-content.incoming .sendbird-message-content__right.use-reactions {\n  width: 70px;\n}\n.sendbird-message-content.incoming .sendbird-message-content__right.chain-top {\n  padding-top: 2px;\n}\n.sendbird-message-content.incoming .sendbird-message-content__right.chain-top.use-quote {\n  padding-top: 18px;\n}\n.sendbird-message-content.incoming .sendbird-message-content__right .sendbird-message-content-menu {\n  position: relative;\n  flex-direction: row;\n  height: 32px;\n  display: none;\n}\n.sendbird-message-content.incoming .sendbird-message-content__right .sendbird-message-content-menu.sendbird-mouse-hover {\n  display: inline-flex;\n}\n.sendbird-message-content.incoming:hover .sendbird-message-content__right .sendbird-message-content-menu {\n  display: inline-flex;\n}\n.sendbird-message-content.incoming:hover .sendbird-message-content__middle .sendbird-message-content__middle__body-container .sendbird-message-content__middle__body-container__created-at {\n  display: none;\n}\n.sendbird--mobile-mode .sendbird-message-content.incoming:hover .sendbird-message-content__middle .sendbird-message-content__middle__body-container .sendbird-message-content__middle__body-container__created-at {\n  display: inline-flex;\n}\n\n.sendbird-message-content.outgoing .sendbird-message-content__left {\n  position: relative;\n  box-sizing: border-box;\n  display: inline-flex;\n  justify-content: flex-end;\n  width: 50px;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__left.use-reactions {\n  width: 70px;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__left.use-quote .sendbird-message-content-menu {\n  top: 18px;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__left .sendbird-message-content-menu {\n  position: absolute;\n  top: 2px;\n  right: 4px;\n  flex-direction: row;\n  display: none;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__left .sendbird-message-content-menu.sendbird-mouse-hover {\n  display: inline-flex;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__middle {\n  position: relative;\n  display: inline-flex;\n  flex-direction: column;\n  align-items: flex-end;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__middle .sendbird-message-content__middle__quote-message {\n  position: relative;\n  width: 100%;\n  display: inline-flex;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__middle .sendbird-message-content__middle__quote-message.outgoing {\n  justify-content: flex-end;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__middle .sendbird-message-content__middle__quote-message.incoming {\n  justify-content: flex-start;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__middle .sendbird-message-content__middle__body-container {\n  position: relative;\n  width: 100%;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__middle .sendbird-message-content__middle__body-container .sendbird-message-content__middle__body-container__created-at {\n  position: absolute;\n  bottom: 2px;\n  left: -84px;\n  white-space: nowrap;\n  display: flex;\n  justify-content: flex-end;\n  box-sizing: content-box;\n  min-width: 80px;\n  min-height: 16px;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__middle .sendbird-message-content__middle__body-container .sendbird-message-content__middle__body-container__created-at.sendbird-mouse-hover {\n  display: none;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__middle .sendbird-message-content__middle__body-container .sendbird-message-content__middle__body-container__created-at .sendbird-message-content__middle__body-container__created-at__component-container {\n  position: relative;\n  display: inline-flex;\n}\n.sendbird-message-content.outgoing .sendbird-message-content__right {\n  display: none;\n}\n.sendbird-message-content.outgoing:hover .sendbird-message-content__left .sendbird-message-content-menu {\n  display: inline-flex;\n}\n.sendbird-message-content.outgoing:hover .sendbird-message-content__middle .sendbird-message-content__middle__body-container .sendbird-message-content__middle__body-container__created-at {\n  display: none;\n}\n.sendbird--mobile-mode .sendbird-message-content.outgoing:hover .sendbird-message-content__middle .sendbird-message-content__middle__body-container .sendbird-message-content__middle__body-container__created-at {\n  display: inline-flex;\n}\n\n.sendbird-message-content__middle__body-container {\n  position: relative;\n  width: -moz-fit-content;\n  width: fit-content;\n  display: flex;\n  flex-direction: column;\n}\n.sendbird-message-content__middle__body-container .sendbird-message-content__middle__message-item-body {\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.sendbird-message-content-reactions {\n  position: relative;\n  width: 100%;\n  max-width: 400px;\n  border-radius: 0px 0px 16px 16px;\n}\n.sendbird-theme--light .sendbird-message-content-reactions {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-message-content-reactions {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-message-content-reactions.primary {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-message-content-reactions.primary {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-theme--light .sendbird-message-content-reactions.mouse-hover, .sendbird-theme--light .sendbird-message-content-reactions:hover {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-message-content-reactions.mouse-hover, .sendbird-theme--dark .sendbird-message-content-reactions:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-theme--light .sendbird-message-content-reactions.mouse-hover.primary, .sendbird-theme--light .sendbird-message-content-reactions:hover.primary {\n  background-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-message-content-reactions.mouse-hover.primary, .sendbird-theme--dark .sendbird-message-content-reactions:hover.primary {\n  background-color: var(--sendbird-dark-primary-300);\n}\n\n.sendbird-message-content__middle__thread-replies {\n  margin-top: 4px;\n}\n\n.sendbird-voice-message-item-body.sendbird-message-content__middle__message-item-body {\n  min-width: 136px;\n  height: 50px;\n}\n.sendbird-message-item-menu__list__menu-item:focus-visible {\n  outline: none;\n}\n.sendbird-text {\n  color: var(--primary-1);\n}\n.sendbird-reaction-button {\n  border-radius: 8px;\n  display: inline-block;\n  border: solid 1px transparent;\n  box-sizing: border-box;\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-reaction-button:hover {\n  border: solid 1px var(--sendbird-light-background-100);\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-reaction-button:hover {\n  border: solid 1px var(--sendbird-dark-background-400);\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-reaction-button__inner {\n  margin: 3px;\n}\n\n.sendbird-reaction-button--selected {\n  cursor: pointer;\n  border-radius: 8px;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-reaction-button--selected {\n  border: solid 1px var(--sendbird-light-primary-100);\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-reaction-button--selected {\n  border: solid 1px var(--sendbird-dark-primary-400);\n  background-color: var(--sendbird-dark-primary-400);\n}\n.sendbird-reaction-button--selected:hover {\n  border: solid 1px var(--sendbird-selected-reaction-button-border-hover);\n}\n.sendbird-reaction-button--selected__inner {\n  margin: 3px;\n}\n.sendbird-reaction-button--selected.sendbird-reactions--pressed {\n  display: block !important;\n}\n.sendbird-emoji-reactions {\n  display: inline-block;\n  border-radius: 16px;\n  box-sizing: border-box;\n  width: 100%;\n  max-width: var(--sendbird-message-balloon-width);\n  min-height: 24px;\n  padding: 7px 5px 3px 5px;\n}\n.sendbird-theme--light .sendbird-emoji-reactions {\n  background-color: var(--sendbird-light-background-50);\n  border: 1px solid var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-emoji-reactions {\n  background-color: var(--sendbird-dark-background-600);\n  border: 1px solid var(--sendbird-dark-background-500);\n}\n.sendbird-emoji-reactions .sendbird-emoji-reactions__reaction-badge {\n  margin-left: 2px;\n  margin-right: 1px;\n  margin-bottom: 4px;\n}\n.sendbird-emoji-reactions:focus {\n  outline: none;\n}\n\n.sendbird-emoji-reactions .sendbird-context-menu {\n  height: 26px;\n}\n\n.sendbird-emoji-reactions__add-reaction-badge {\n  position: relative;\n  top: -4px;\n  display: inline-flex;\n  width: 36px;\n  height: 24px;\n}\n\n.sendbird-emoji-reactions .sendbird-context-menu {\n  margin-left: 2px;\n}\n.sendbird-reaction-badge {\n  display: inline-block;\n  border-radius: 15px;\n  width: 50px;\n  height: 24px;\n}\n.sendbird-theme--light .sendbird-reaction-badge {\n  background-color: var(--sendbird-light-background-100);\n  border: solid 1px var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-reaction-badge {\n  background-color: var(--sendbird-dark-background-500);\n  border: solid 1px var(--sendbird-dark-background-500);\n}\n.sendbird-reaction-badge:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-reaction-badge:hover {\n  border: solid 1px var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-reaction-badge:hover {\n  border: solid 1px var(--sendbird-dark-primary-200);\n}\n\n.sendbird-reaction-badge--is-add {\n  display: inline-block;\n  border-radius: 15px;\n  width: 36px;\n  height: 24px;\n}\n.sendbird-theme--light .sendbird-reaction-badge--is-add {\n  background-color: var(--sendbird-light-background-100);\n  border: solid 1px var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-reaction-badge--is-add {\n  background-color: var(--sendbird-dark-background-500);\n  border: solid 1px var(--sendbird-dark-background-500);\n}\n.sendbird-reaction-badge--is-add:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-reaction-badge--is-add:hover {\n  border: solid 1px var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-reaction-badge--is-add:hover {\n  border: solid 1px var(--sendbird-dark-primary-200);\n}\n.sendbird-reaction-badge--is-add .sendbird-reaction-badge__inner .sendbird-reaction-badge__inner__icon {\n  left: 8px;\n}\n\n.sendbird-reaction-badge--selected {\n  display: inline-block;\n  border-radius: 15px;\n  width: 50px;\n  height: 24px;\n}\n.sendbird-theme--light .sendbird-reaction-badge--selected {\n  background-color: var(--sendbird-light-primary-100);\n  border: solid 1px var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-reaction-badge--selected {\n  background-color: var(--sendbird-dark-primary-400);\n  border: solid 1px var(--sendbird-dark-primary-400);\n}\n.sendbird-reaction-badge--selected:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-reaction-badge--selected:hover {\n  border: solid 1px var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-reaction-badge--selected:hover {\n  border: solid 1px var(--sendbird-dark-primary-200);\n}\n\n.sendbird-reaction-badge__inner {\n  position: relative;\n  display: flex;\n  height: 24px;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  padding-left: 20px;\n  padding-right: 4px;\n}\n.sendbird-reaction-badge__inner .sendbird-reaction-badge__inner__icon {\n  position: absolute;\n  top: 2px;\n  left: 4px;\n}\n.sendbird-reaction-badge__inner .sendbird-reaction-badge__inner__count {\n  margin-left: 4px;\n}\n.sendbird-message__bottomsheet__reacted-members {\n  position: relative;\n  padding: 0px 16px;\n  box-sizing: border-box;\n  width: 100%;\n  height: 46px;\n  overflow-x: scroll;\n  display: inline-flex;\n  flex-direction: row;\n  justify-content: center;\n  gap: 16px;\n}\n\n.sendbird-message__bottomsheet__reacted-members__item {\n  position: relative;\n  height: 100%;\n  display: inline-flex;\n  gap: 4px;\n  flex-direction: row;\n  align-items: center;\n}\n\n.sendbird-message__bottomsheet__reactor-list {\n  position: relative;\n  padding: 0px 16px;\n  width: 100%;\n  height: 216px;\n  box-sizing: border-box;\n  display: inline-flex;\n  flex-direction: column;\n  overflow-y: scroll;\n}\n\n.sendbird-message__bottomsheet__reactor-list__item.sendbird-user-list-item {\n  border-bottom: 0px;\n  min-height: 48px;\n}\n.sendbird-bottomsheet {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n\n.sendbird-bottomsheet__content {\n  z-index: 10001;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n}\n\n.sendbird-bottomsheet__backdrop {\n  position: fixed;\n  z-index: 10000;\n  height: 100%;\n  width: 100%;\n  top: 0;\n  left: 0;\n}\n.sendbird-theme--light .sendbird-bottomsheet__backdrop {\n  background-color: var(--sendbird-light-overlay-02);\n}\n.sendbird-theme--dark .sendbird-bottomsheet__backdrop {\n  background-color: var(--sendbird-dark-overlay-02);\n}\n.sendbird-tooltip {\n  position: relative;\n  display: inline-flex;\n  justify-content: center;\n  max-width: 200px;\n  border-radius: 8px;\n  padding: 8px 16px;\n}\n.sendbird-theme--light .sendbird-tooltip {\n  background-color: var(--sendbird-light-background-700);\n}\n.sendbird-theme--dark .sendbird-tooltip {\n  background-color: var(--sendbird-dark-background-300);\n}\n.sendbird-tooltip::after {\n  content: \"\";\n  position: absolute;\n  bottom: -4px;\n  width: 8px;\n  height: 8px;\n  transform: rotate(45deg);\n}\n.sendbird-theme--light .sendbird-tooltip::after {\n  background-color: var(--sendbird-light-background-700);\n}\n.sendbird-theme--dark .sendbird-tooltip::after {\n  background-color: var(--sendbird-dark-background-300);\n}\n.sendbird-tooltip__text {\n  font-family: var(--sendbird-font-family-default);\n  font-size: 12px;\n  font-weight: bold;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: 1.33;\n  letter-spacing: normal;\n  word-break: keep-all;\n  max-width: 180px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-tooltip-wrapper {\n  position: relative;\n  display: inline-flex;\n}\n.sendbird-tooltip-wrapper__hover-tooltip {\n  position: absolute;\n  display: inline-flex;\n  width: 200px;\n}\n.sendbird-tooltip-wrapper__hover-tooltip__inner__tooltip-container {\n  position: relative;\n  display: inline-flex;\n}\n.sendbird-admin-message {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.sendbird-admin-message .sendbird-admin-message__text {\n  display: flex;\n  text-align: center;\n}\n.sendbird-text-message-item-body {\n  position: relative;\n  display: inline-block;\n  box-sizing: content-box;\n  padding: 8px 12px;\n  border-radius: 16px;\n  white-space: pre-line;\n  word-break: break-word;\n}\n.sendbird-text-message-item-body.reactions {\n  border-radius: 16px 16px 0px 0px;\n}\n.sendbird-theme--light .sendbird-text-message-item-body.incoming {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-text-message-item-body.incoming {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-text-message-item-body.outgoing {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-text-message-item-body.outgoing {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-theme--light .sendbird-text-message-item-body.mouse-hover.incoming, .sendbird-theme--light .sendbird-text-message-item-body:hover.incoming {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-text-message-item-body.mouse-hover.incoming, .sendbird-theme--dark .sendbird-text-message-item-body:hover.incoming {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-theme--light .sendbird-text-message-item-body.mouse-hover.outgoing, .sendbird-theme--light .sendbird-text-message-item-body:hover.outgoing {\n  background-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-text-message-item-body.mouse-hover.outgoing, .sendbird-theme--dark .sendbird-text-message-item-body:hover.outgoing {\n  background-color: var(--sendbird-dark-primary-300);\n}\n.sendbird-text-message-item-body .sendbird-text-message-item-body__text-bubble__message {\n  display: inline;\n  margin: 0px 2px;\n}\n\ndiv.sendbird-text-message-item-body {\n  margin: 0px;\n}\n.sendbird-word {\n  white-space: break-spaces;\n}\n.sendbird-word .sendbird-word__mention {\n  display: inline-block;\n}\n.sendbird-word .sendbird-word__mention:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-word .sendbird-word__mention.sendbird-word__mention--me {\n  background-color: var(--sendbird-highlight-100);\n}\n.sendbird-theme--dark .sendbird-word .sendbird-word__mention.sendbird-word__mention--me {\n  background-color: var(--sendbird-highlight-100);\n}\n.sendbird-theme--light .sendbird-word .sendbird-word__mention.sendbird-word__mention--me .sendbird-label {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-word .sendbird-word__mention.sendbird-word__mention--me .sendbird-label {\n  color: var(--sendbird-dark-onlight-01);\n}\n.sendbird-link-label {\n  text-decoration: unset;\n}\n.sendbird-link-label:hover {\n  cursor: pointer;\n  text-decoration: underline;\n}\n.sendbird-link-label:focus {\n  outline: none;\n}\n.sendbird-link-label__label {\n  display: inline;\n}\n\n.sendbird-theme--light .sendbird-link-label .sendbird-label--color-onbackground-1 {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-link-label .sendbird-label--color-onbackground-1 {\n  color: var(--sendbird-dark-ondark-01);\n}\n\n.sendbird-theme--light .sendbird-link-label .sendbird-label--color-onbackground-2 {\n  color: var(--sendbird-light-onlight-02);\n}\n.sendbird-theme--dark .sendbird-link-label .sendbird-label--color-onbackground-2 {\n  color: var(--sendbird-dark-ondark-02);\n}\n\n.sendbird-theme--light .sendbird-link-label .sendbird-label--color-onbackground-3 {\n  color: var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-link-label .sendbird-label--color-onbackground-3 {\n  color: var(--sendbird-dark-ondark-03);\n}\n\n.sendbird-theme--light .sendbird-link-label .sendbird-label--color-oncontent-1 {\n  color: var(--sendbird-light-ondark-01);\n}\n.sendbird-theme--dark .sendbird-link-label .sendbird-label--color-oncontent-1 {\n  color: var(--sendbird-dark-onlight-01);\n}\n\n.sendbird-theme--light .sendbird-link-label .sendbird-label--color-oncontent-2 {\n  color: var(--sendbird-light-ondark-02);\n}\n.sendbird-theme--dark .sendbird-link-label .sendbird-label--color-oncontent-2 {\n  color: var(--sendbird-dark-onlight-02);\n}\n\n.sendbird-theme--light .sendbird-link-label .sendbird-label--color-primary {\n  color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-link-label .sendbird-label--color-primary {\n  color: var(--sendbird-dark-primary-200);\n}\n\n.sendbird-theme--light .sendbird-link-label .sendbird-label--color-error {\n  color: var(--sendbird-light-error-300);\n}\n.sendbird-theme--dark .sendbird-link-label .sendbird-label--color-error {\n  color: var(--sendbird-dark-error-200);\n}\n\n.sendbird-theme--light .sendbird-link-label .sendbird-label--color-secondary-3 {\n  color: var(--sendbird-light-secondary-300);\n}\n.sendbird-theme--dark .sendbird-link-label .sendbird-label--color-secondary-3 {\n  color: var(--sendbird-dark-secondary-200);\n}\n.sendbird-file-message-item-body {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n  padding: 8px 12px;\n  align-items: center;\n  border-radius: 16px;\n}\n.sendbird-file-message-item-body.reactions {\n  border-radius: 16px 16px 0px 0px;\n}\n.sendbird-theme--light .sendbird-file-message-item-body.outgoing {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-file-message-item-body.outgoing {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-theme--light .sendbird-file-message-item-body.incoming {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-file-message-item-body.incoming {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-file-message-item-body.mouse-hover.outgoing, .sendbird-theme--light .sendbird-file-message-item-body:hover.outgoing {\n  background-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-file-message-item-body.mouse-hover.outgoing, .sendbird-theme--dark .sendbird-file-message-item-body:hover.outgoing {\n  background-color: var(--sendbird-dark-primary-300);\n}\n.sendbird-theme--light .sendbird-file-message-item-body.mouse-hover.incoming, .sendbird-theme--light .sendbird-file-message-item-body:hover.incoming {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-file-message-item-body.mouse-hover.incoming, .sendbird-theme--dark .sendbird-file-message-item-body:hover.incoming {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-file-message-item-body .sendbird-file-message-item-body__file-icon {\n  width: 28px;\n  height: 28px;\n  min-width: 28px;\n  min-height: 28px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 8px;\n  margin-right: 8px;\n}\n.sendbird-theme--light .sendbird-file-message-item-body .sendbird-file-message-item-body__file-icon {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-file-message-item-body .sendbird-file-message-item-body__file-icon {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-file-message-item-body .sendbird-file-message-item-body__file-name {\n  position: relative;\n  top: -6px;\n}\n.sendbird-thumbnail-message-item-body {\n  position: relative;\n  display: block;\n  box-sizing: border-box;\n  overflow: hidden;\n  width: 100%;\n  min-width: 360px;\n  max-width: 400px;\n  height: 270px;\n  border-radius: 16px;\n}\n.sendbird--mobile-mode .sendbird-thumbnail-message-item-body {\n  min-width: 160px;\n}\n.sendbird-thumbnail-message-item-body.reactions {\n  border-radius: 16px 16px 0px 0px;\n}\n.sendbird-theme--light .sendbird-thumbnail-message-item-body {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-thumbnail-message-item-body {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-thumbnail-message-item-body.mouse-hover, .sendbird-theme--light .sendbird-thumbnail-message-item-body:hover {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-thumbnail-message-item-body.mouse-hover, .sendbird-theme--dark .sendbird-thumbnail-message-item-body:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-thumbnail-message-item-body .sendbird-thumbnail-message-item-body__thumbnail {\n  position: absolute;\n  border-radius: 16px;\n}\n.sendbird-thumbnail-message-item-body .sendbird-thumbnail-message-item-body__placeholder {\n  position: absolute;\n  width: 100%;\n  height: 270px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.sendbird-thumbnail-message-item-body .sendbird-thumbnail-message-item-body__placeholder .sendbird-thumbnail-message-item-body__placeholder__icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 56px;\n  height: 56px;\n  border-radius: 50%;\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-thumbnail-message-item-body .sendbird-thumbnail-message-item-body__image-cover {\n  position: absolute;\n  top: 0px;\n  display: none;\n  width: 100%;\n  height: 270px;\n  border-radius: 16px;\n  background-color: var(--sendbird-light-overlay-01);\n}\n.sendbird-thumbnail-message-item-body .sendbird-thumbnail-message-item-body__video {\n  position: absolute;\n  width: 100%;\n  height: 270px;\n  border-radius: 16px;\n}\n.sendbird-thumbnail-message-item-body .sendbird-thumbnail-message-item-body__icon-wrapper {\n  position: absolute;\n  width: 100%;\n  height: 270px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.sendbird-thumbnail-message-item-body .sendbird-thumbnail-message-item-body__icon-wrapper .sendbird-thumbnail-message-item-body__icon-wrapper__icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 56px;\n  height: 56px;\n  border-radius: 50%;\n  background-color: var(--sendbird-light-background-50);\n}\n\n.sendbird-thumbnail-message-item-body:hover {\n  cursor: pointer;\n}\n.sendbird-thumbnail-message-item-body:hover .sendbird-thumbnail-message-item-body__image-cover {\n  display: inline-flex;\n}\n.sendbird-og-message-item-body {\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  min-width: 320px;\n  max-width: 400px;\n}\n.sendbird--mobile-mode .sendbird-og-message-item-body {\n  min-width: 160px;\n}\n.sendbird-og-message-item-body .sendbird-og-message-item-body__text-bubble {\n  position: relative;\n  padding: 8px 12px;\n  box-sizing: border-box;\n  border-radius: 16px 16px 0px 0px;\n  word-break: break-word;\n  white-space: pre-line;\n}\n.sendbird-og-message-item-body .sendbird-og-message-item-body__text-bubble .sendbird-og-message-item-body__text-bubble__message {\n  display: inline;\n  margin: 0px 2px;\n}\n.sendbird-og-message-item-body .sendbird-og-message-item-body__og-thumbnail {\n  position: relative;\n  overflow: hidden;\n}\n.sendbird-og-message-item-body .sendbird-og-message-item-body__og-thumbnail .sendbird-og-message-item-body__og-thumbnail__image {\n  width: 100%;\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.sendbird-og-message-item-body.reactions .sendbird-og-message-item-body__description {\n  border-radius: 0px;\n}\n.sendbird-og-message-item-body .sendbird-og-message-item-body__description {\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  padding: 8px 12px;\n  display: flex;\n  flex-direction: column;\n  border-radius: 0px 0px 16px 16px;\n}\n.sendbird-theme--light .sendbird-og-message-item-body .sendbird-og-message-item-body__description {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-og-message-item-body .sendbird-og-message-item-body__description {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-og-message-item-body .sendbird-og-message-item-body__description .sendbird-og-message-item-body__description__title,\n.sendbird-og-message-item-body .sendbird-og-message-item-body__description .sendbird-og-message-item-body__description__description {\n  margin-bottom: 4px;\n  width: 100%;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  display: inline-block;\n}\n.sendbird-og-message-item-body .sendbird-og-message-item-body__description .sendbird-og-message-item-body__description__url {\n  width: 100%;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  display: inline-block;\n  margin: 4px 0px;\n}\n.sendbird-og-message-item-body .sendbird-og-message-item-body__og-thumbnail:hover,\n.sendbird-og-message-item-body .sendbird-og-message-item-body__description:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-og-message-item-body.outgoing .sendbird-og-message-item-body__text-bubble {\n  background-color: var(--sendbird-light-primary-300);\n  color: var(--sendbird-light-ondark-01);\n}\n.sendbird-theme--dark .sendbird-og-message-item-body.outgoing .sendbird-og-message-item-body__text-bubble {\n  background-color: var(--sendbird-dark-primary-200);\n  color: var(--sendbird-dark-onlight-01);\n}\n.sendbird-theme--light .sendbird-og-message-item-body.incoming .sendbird-og-message-item-body__text-bubble {\n  background-color: var(--sendbird-light-background-100);\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-og-message-item-body.incoming .sendbird-og-message-item-body__text-bubble {\n  background-color: var(--sendbird-dark-background-500);\n  color: var(--sendbird-dark-ondark-01);\n}\n.sendbird-theme--light .sendbird-og-message-item-body.mouse-hover .sendbird-og-message-item-body__description, .sendbird-theme--light .sendbird-og-message-item-body:hover .sendbird-og-message-item-body__description {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-og-message-item-body.mouse-hover .sendbird-og-message-item-body__description, .sendbird-theme--dark .sendbird-og-message-item-body:hover .sendbird-og-message-item-body__description {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-theme--light .sendbird-og-message-item-body.mouse-hover.outgoing .sendbird-og-message-item-body__text-bubble, .sendbird-theme--light .sendbird-og-message-item-body:hover.outgoing .sendbird-og-message-item-body__text-bubble {\n  background-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-og-message-item-body.mouse-hover.outgoing .sendbird-og-message-item-body__text-bubble, .sendbird-theme--dark .sendbird-og-message-item-body:hover.outgoing .sendbird-og-message-item-body__text-bubble {\n  background-color: var(--sendbird-dark-primary-300);\n}\n.sendbird-theme--light .sendbird-og-message-item-body.mouse-hover.incoming .sendbird-og-message-item-body__text-bubble, .sendbird-theme--light .sendbird-og-message-item-body:hover.incoming .sendbird-og-message-item-body__text-bubble {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-og-message-item-body.mouse-hover.incoming .sendbird-og-message-item-body__text-bubble, .sendbird-theme--dark .sendbird-og-message-item-body:hover.incoming .sendbird-og-message-item-body__text-bubble {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-og-message-item-body .sendbird-og-message-item-body__cover {\n  display: none;\n  position: absolute;\n  top: 0%;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  border-radius: 16px 16px 0px 0px;\n}\n\ndiv.sendbird-og-message-item-body__text-bubble {\n  margin: 0px;\n}\n.sendbird-unknown-message-item-body {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n  padding: 8px 12px;\n  border-radius: 16px;\n}\n.sendbird-unknown-message-item-body.reactions {\n  border-radius: 16px 16px 0px 0px;\n}\n.sendbird-theme--light .sendbird-unknown-message-item-body.outgoing {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-unknown-message-item-body.outgoing {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-theme--light .sendbird-unknown-message-item-body.incoming {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-unknown-message-item-body.incoming {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-unknown-message-item-body.mouse-hover.outgoing, .sendbird-theme--light .sendbird-unknown-message-item-body:hover.outgoing {\n  background-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-unknown-message-item-body.mouse-hover.outgoing, .sendbird-theme--dark .sendbird-unknown-message-item-body:hover.outgoing {\n  background-color: var(--sendbird-dark-primary-300);\n}\n.sendbird-theme--light .sendbird-unknown-message-item-body.mouse-hover.incoming, .sendbird-theme--light .sendbird-unknown-message-item-body:hover.incoming {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-unknown-message-item-body.mouse-hover.incoming, .sendbird-theme--dark .sendbird-unknown-message-item-body:hover.incoming {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-unknown-message-item-body .sendbird-unknown-message-item-body__header {\n  display: block;\n}\n.sendbird-unknown-message-item-body .sendbird-unknown-message-item-body__description {\n  display: block;\n}\n.sendbird-quote-message {\n  position: relative;\n  display: inline-flex;\n  box-sizing: border-box;\n  flex-direction: column;\n  width: 100%;\n  max-width: 400px;\n}\n.sendbird-quote-message.incoming {\n  align-items: flex-start;\n}\n.sendbird-quote-message.outgoing {\n  align-items: flex-end;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-to {\n  position: relative;\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n  height: 16px;\n  padding: 0px 12px;\n  width: 100%;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-to .sendbird-quote-message__replied-to__icon {\n  position: relative;\n  margin-bottom: 4px;\n  margin-right: 4px;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-to .sendbird-quote-message__replied-to__text {\n  position: relative;\n  max-width: 360px;\n  overflow: hidden;\n  overflow-x: hidden;\n  white-space: nowrap;\n  word-break: keep-all;\n  text-overflow: ellipsis;\n  font-size: 12px;\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-to .sendbird-quote-message__replied-to__text .sendbird-quote-message__replied-to__text__nickname {\n  display: inline-block;\n  max-width: 148px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-to .sendbird-quote-message__replied-to__text .sendbird-quote-message__replied-to__text__text {\n  margin: 0px 4px;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message {\n  position: relative;\n  display: inline-flex;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__text-message {\n  position: relative;\n  white-space: pre-wrap;\n  word-break: break-all;\n  font-size: 12px;\n  padding: 8px 12px 16px 12px;\n  border-radius: 16px;\n  opacity: 0.5;\n}\n.sendbird-theme--light .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__text-message {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__text-message {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__text-message .sendbird-quote-message__replied-message__text-message__word {\n  position: relative;\n  display: inline-flex;\n  max-height: 30px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message {\n  position: relative;\n  width: 144px;\n  height: 108px;\n  border-radius: 6.4px;\n  overflow: hidden;\n}\n.sendbird-theme--light .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message .sendbird-quote-message__replied-message__thumbnail-message__video,\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message .sendbird-quote-message__replied-message__thumbnail-message__image {\n  position: absolute;\n  top: 0px;\n  display: inline-flex;\n  width: 100%;\n  height: 100%;\n  opacity: 0.5;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message .sendbird-quote-message__replied-message__thumbnail-message__placeholder {\n  position: absolute;\n  display: inline-flex;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message .sendbird-quote-message__replied-message__thumbnail-message__placeholder .sendbird-quote-message__replied-message__thumbnail-message__placeholder__icon {\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  width: 22px;\n  height: 22px;\n  border-radius: 50%;\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message .sendbird-quote-message__replied-message__thumbnail-message__cover {\n  position: absolute;\n  display: inline-flex;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n  top: 0px;\n}\n.sendbird-theme--light .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message .sendbird-quote-message__replied-message__thumbnail-message__cover {\n  background-color: rgba(255, 255, 255, 0.4);\n}\n.sendbird-theme--dark .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message .sendbird-quote-message__replied-message__thumbnail-message__cover {\n  background-color: rgba(255, 255, 255, 0.4);\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message .sendbird-quote-message__replied-message__thumbnail-message__cover .sendbird-quote-message__replied-message__thumbnail-message__cover__icon {\n  position: relative;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  width: 22px;\n  height: 22px;\n  border-radius: 50%;\n}\n.sendbird-theme--light .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message .sendbird-quote-message__replied-message__thumbnail-message__cover .sendbird-quote-message__replied-message__thumbnail-message__cover__icon {\n  background-color: rgb(255, 255, 255);\n}\n.sendbird-theme--dark .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__thumbnail-message .sendbird-quote-message__replied-message__thumbnail-message__cover .sendbird-quote-message__replied-message__thumbnail-message__cover__icon {\n  background-color: rgb(255, 255, 255);\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__file-message {\n  position: relative;\n  display: inline-flex;\n  flex-direction: row;\n  font-size: 12px;\n  padding: 8px 12px 16px 12px;\n  border-radius: 16px;\n  opacity: 0.5;\n}\n.sendbird-theme--light .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__file-message {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__file-message {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-quote-message .sendbird-quote-message__replied-message .sendbird-quote-message__replied-message__file-message .sendbird-quote-message__replied-message__file-message__type-icon {\n  margin-right: 2px;\n}\n.sendbird-quote-message:hover {\n  cursor: pointer;\n}\n\n.sendbird-quote-message.unavailable:hover {\n  cursor: default;\n}\n\n.sendbird-message-content.outgoing .sendbird-quote-message__replied-to {\n  flex-direction: row-reverse;\n  padding-right: 0px;\n}\n\n.sendbird-message-content.incoming .sendbird-quote-message__replied-to {\n  padding-left: 0px;\n}\n.sendbird-message__mobile-context-menu {\n  border-radius: 8px;\n  width: 180px;\n}\n\n.sendbird-message__contextmenu--hyperlink {\n  display: flex;\n  justify-content: space-between;\n}\n\n.sendbird-message__bottomsheet--hyperlink {\n  display: block;\n}\n\n.sendbird-message__bottomsheet--hyperlink,\n.sendbird-message__contextmenu--hyperlink {\n  width: 100%;\n  text-decoration: none;\n  color: inherit;\n  font-size: inherit;\n  font-weight: inherit;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: inherit;\n  letter-spacing: inherit;\n  font-family: inherit;\n}\n\n.sendbird-message__mobile-context-menu-item .sendbird-dropdown__menu-item__text {\n  display: flex;\n  justify-content: space-between;\n}\n.sendbird-theme--light .sendbird-message__mobile-context-menu-item:not(:last-child) {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-message__mobile-context-menu-item:not(:last-child) {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n\n.sendbird-message__bottomsheet {\n  width: 100vw;\n  border-top-left-radius: 8px;\n  border-top-right-radius: 8px;\n  padding-top: 16px;\n}\n.sendbird-theme--light .sendbird-message__bottomsheet {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-message__bottomsheet {\n  background-color: var(--sendbird-dark-background-600);\n}\n\n.sendbird-message__bottomsheet-reaction-bar {\n  padding-left: 0;\n  display: flex;\n  justify-content: center;\n  margin-bottom: 0px;\n  margin-top: 0;\n}\n\n.sendbird-message__bottomsheet-reaction-bar__row {\n  display: inline-block;\n}\n.sendbird-message__bottomsheet-reaction-bar__row.sendbird-message__bottomsheet-reaction-bar__all {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n}\n\n.sendbird-message__bottomsheet--action {\n  cursor: pointer;\n  height: 48px;\n  display: flex;\n  align-items: center;\n  padding-left: 16px;\n}\n.sendbird-message__bottomsheet--action .sendbird-icon {\n  margin-right: 24px;\n}\n\n.sendbird-message__bottomsheet--action-disabled {\n  cursor: not-allowed;\n}\n.sendbird-theme--light .sendbird-message__bottomsheet--action-disabled {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-message__bottomsheet--action-disabled {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-ui-thread-replies {\n  position: relative;\n  width: -moz-fit-content;\n  width: fit-content;\n  height: 20px;\n  min-height: 20px;\n  display: inline-flex;\n  flex-direction: row;\n  justify-content: flex-start;\n  align-items: center;\n  padding: 4px 10px;\n  gap: 4px;\n  border-radius: 16px;\n  flex: none;\n  order: 0;\n  flex-grow: 0;\n}\n.sendbird-theme--light .sendbird-ui-thread-replies {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-ui-thread-replies {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-ui-thread-replies:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-ui-thread-replies:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-ui-thread-replies:hover {\n  background-color: var(--sendbird-dark-background-500);\n}\n\n.sendbird-ui-thread-replies__user-profiles {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  gap: 4px;\n  display: inline-flex;\n  flex-direction: row;\n}\n\n.sendbird-ui-thread-replies__user-profiles__avatar {\n  position: relative;\n  width: 20px;\n  height: 20px;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.sendbird-ui-thread-replies__user-profiles__avatar__image {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 20px;\n  height: 20px;\n}\n\n.sendbird-ui-thread-replies__user-profiles__avatar__cover {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  background-color: var(--sendbird-light-overlay-01);\n}\n\n.sendbird-ui-thread-replies__user-profiles__avatar__plus {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 20px;\n  height: 20px;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.sendbird-ui-thread-replies__reply-counts {\n  position: relative;\n  min-width: -moz-fit-content;\n  min-width: fit-content;\n  height: 12px;\n  display: inline-flex;\n  flex-direction: row;\n  justify-content: flex-start;\n  align-items: center;\n  white-space: nowrap;\n}\n\n.sendbird-ui-thread-replies__icon {\n  position: relative;\n  display: inline-flex;\n}\n.sendbird-voice-message-item-body {\n  position: relative;\n  display: inline-flex;\n  width: 100%;\n  border-radius: 16px;\n  overflow: hidden;\n}\n\n.sendbird-voice-message-item-body.is-reactions-contained {\n  border-radius: 16px 16px 0px 0px;\n}\n\n.sendbird-voice-message-item-body__progress-bar {\n  position: absolute;\n  width: 100%;\n  height: 50px;\n}\n\n.sendbird-voice-message-item-body__status-button {\n  position: relative;\n  top: 8px;\n  left: 12px;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  width: 34px;\n  height: 34px;\n  min-width: 34px;\n  min-height: 34px;\n}\n\n.sendbird-voice-message-item-body__status-button__button {\n  width: 100%;\n  height: 100%;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 50%;\n}\n.sendbird-theme--light .sendbird-voice-message-item-body__status-button__button {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-voice-message-item-body__status-button__button {\n  background-color: var(--sendbird-dark-background-600);\n}\n\n.sendbird-voice-message-item-body__playback-time {\n  position: absolute;\n  top: 15px;\n  right: 12px;\n}\n\n.sendbird-voice-message-item-body__status-button__button__pause {\n  position: relative;\n  display: inline-flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 13.75px;\n  height: 13.75px;\n}\n\n.sendbird-voice-message-item-body__status-button__button__pause__inner {\n  position: relative;\n  display: inline-flex;\n  width: 4.38px;\n  height: 13.75px;\n  border-radius: 2px;\n}\n.sendbird-theme--light .sendbird-voice-message-item-body__status-button__button__pause__inner {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-voice-message-item-body__status-button__button__pause__inner {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-progress-bar, .sendbird-progress-bar__fill {\n  display: inline-flex;\n  width: 100%;\n  height: 100%;\n}\n\n.sendbird-progress-bar {\n  justify-content: flex-start;\n}\n\n.sendbird-theme--light .sendbird-progress-bar__fill {\n  background-color: var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-progress-bar__fill {\n  background-color: var(--sendbird-dark-ondark-03);\n}\n\n.sendbird-theme--light .progress-bar-color--primary {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .progress-bar-color--primary {\n  background-color: var(--sendbird-dark-primary-200);\n}\n\n.sendbird-theme--light .sendbird-progress-bar.progress-bar--disabled, .sendbird-theme--light .progress-bar-color--gray {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-progress-bar.progress-bar--disabled, .sendbird-theme--dark .progress-bar-color--gray {\n  background-color: var(--sendbird-dark-background-500);\n}\n\n.sendbird-progress-bar.progress-bar--disabled .sendbird-progress-bar__fill {\n  background-color: transparent;\n}\n.sendbird-fileviewer__header__right__actions__download,\n.sendbird-fileviewer__header__right__actions__delete,\n.sendbird-fileviewer__header__right__actions__close {\n  width: 64px;\n  padding: 21px;\n  box-sizing: border-box;\n  cursor: pointer;\n}\n.sendbird-fileviewer__header__right__actions__download .disabled,\n.sendbird-fileviewer__header__right__actions__delete .disabled,\n.sendbird-fileviewer__header__right__actions__close .disabled {\n  cursor: not-allowed;\n}\n\n.sendbird-fileviewer {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 100000;\n}\n.sendbird-theme--light .sendbird-fileviewer {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-fileviewer {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-fileviewer .sendbird-fileviewer__header {\n  height: 64px;\n  min-height: 64px;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: space-between;\n}\n.sendbird--mobile-mode .sendbird-fileviewer .sendbird-fileviewer__header {\n  position: relative;\n}\n.sendbird-theme--light .sendbird-fileviewer .sendbird-fileviewer__header {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-fileviewer .sendbird-fileviewer__header {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__left {\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 64px;\n  padding: 16px 20px;\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__left .sendbird-fileviewer__header__left__avatar {\n  margin-right: 8px;\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__left .sendbird-fileviewer__header__left__filename {\n  max-width: 500px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: inline-block;\n}\n.sendbird--mobile-mode .sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__left .sendbird-fileviewer__header__left__filename {\n  position: absolute;\n  left: 64px;\n  top: 10px;\n  display: block;\n  max-width: calc(100vw - 240px);\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__left .sendbird-fileviewer__header__left__sender-name {\n  max-width: 200px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: inline-flex;\n  margin-left: 8px;\n  padding-top: 5px;\n}\n.sendbird--mobile-mode .sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__left .sendbird-fileviewer__header__left__sender-name {\n  position: absolute;\n  left: 56px;\n  top: 24px;\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__right {\n  display: flex;\n  width: 160px;\n  justify-content: flex-end;\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__right .sendbird-fileviewer__header__right__actions {\n  right: 0;\n  display: flex;\n  flex-direction: row;\n}\n.sendbird-theme--light .sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__right .sendbird-fileviewer__header__right__actions__close {\n  border-left: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__right .sendbird-fileviewer__header__right__actions__close {\n  border-left: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-fileviewer .sendbird-fileviewer__content {\n  height: calc(100% - 72px);\n  margin-top: 8px;\n  overflow-y: auto;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.sendbird-fileviewer .sendbird-fileviewer__content .sendbird-fileviewer__content__video {\n  max-width: 100%;\n  max-height: 100%;\n}\n.sendbird-fileviewer .sendbird-fileviewer__content .sendbird-fileviewer__content__img {\n  max-width: 90%;\n  max-height: 90%;\n}\n.sendbird-fileviewer .sendbird-fileviewer__content .sendbird-fileviewer__content__unsupported {\n  max-width: 100%;\n  max-height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.sendbird-notification--hide,\n.sendbird-notification {\n  position: absolute;\n}\n\n.sendbird-notification {\n  margin-top: 8px;\n  margin-left: 24px;\n  margin-right: 24px;\n  border-radius: 4px;\n  padding: 0px 2px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.sendbird-theme--light .sendbird-notification {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-notification {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-notification:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-notification:hover {\n  background-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-notification:hover {\n  background-color: var(--sendbird-dark-primary-300);\n}\n.sendbird-theme--light .sendbird-notification.sendbird-notification--frozen {\n  background-color: var(--sendbird-light-information-100);\n}\n.sendbird-theme--dark .sendbird-notification.sendbird-notification--frozen {\n  background-color: var(--sendbird-dark-information-100);\n}\n.sendbird-theme--light .sendbird-notification.sendbird-notification--frozen .sendbird-notification__text {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-notification.sendbird-notification--frozen .sendbird-notification__text {\n  color: var(--sendbird-dark-onlight-01);\n}\n.sendbird-notification .sendbird-notification__text {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-right: 8px;\n}\n\n.sendbird-notification--hide {\n  display: none;\n}\n.sendbird-notification {\n  margin-top: 8px;\n  margin-left: 24px;\n  margin-right: 24px;\n  border-radius: 4px;\n  padding: 0px 2px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.sendbird-theme--light .sendbird-notification {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-notification {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-notification:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-notification:hover {\n  background-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-notification:hover {\n  background-color: var(--sendbird-dark-primary-300);\n}\n.sendbird-theme--light .sendbird-notification.sendbird-notification--frozen {\n  background-color: var(--sendbird-light-information-100);\n}\n.sendbird-theme--dark .sendbird-notification.sendbird-notification--frozen {\n  background-color: var(--sendbird-dark-information-100);\n}\n.sendbird-theme--light .sendbird-notification.sendbird-notification--frozen .sendbird-notification__text {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-notification.sendbird-notification--frozen .sendbird-notification__text {\n  color: var(--sendbird-dark-onlight-01);\n}\n.sendbird-notification .sendbird-notification__text {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-right: 8px;\n}\n.sendbird-message-input-wrapper--voice-message,\n.sendbird-message-input-wrapper {\n  position: relative;\n  width: 100%;\n}\n.sendbird-message-input-wrapper--voice-message .sendbird-message-input-wrapper__quote-message-input,\n.sendbird-message-input-wrapper .sendbird-message-input-wrapper__quote-message-input {\n  position: relative;\n  width: 100%;\n}\n.sendbird-theme--light .sendbird-message-input-wrapper--voice-message .sendbird-message-input-wrapper__quote-message-input,\n.sendbird-theme--light .sendbird-message-input-wrapper .sendbird-message-input-wrapper__quote-message-input {\n  border-top: solid 1px var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-message-input-wrapper--voice-message .sendbird-message-input-wrapper__quote-message-input,\n.sendbird-theme--dark .sendbird-message-input-wrapper .sendbird-message-input-wrapper__quote-message-input {\n  border-top: solid 1px var(--sendbird-dark-ondark-04);\n}\n.sendbird-message-input-wrapper--voice-message .sendbird-message-input-wrapper__message-input,\n.sendbird-message-input-wrapper .sendbird-message-input-wrapper__message-input {\n  position: relative;\n  width: 100%;\n  box-sizing: border-box;\n  padding-left: 24px;\n  padding-right: 24px;\n}\n\n.sendbird-theme--light .sendbird-message-input-wrapper--voice-message {\n  border-top: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-message-input-wrapper--voice-message {\n  border-top: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-quote_message_input {\n  position: relative;\n  padding: 16px 80px 16px 40px;\n  width: 100%;\n  height: 76px;\n  display: flex;\n  flex-direction: row;\n  box-sizing: border-box;\n}\n.sendbird-quote_message_input .sendbird-quote_message_input__avatar {\n  width: 44px;\n  min-width: 44px;\n  height: 44px;\n  min-height: 44px;\n  position: relative;\n  border-radius: 8px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.sendbird-theme--light .sendbird-quote_message_input .sendbird-quote_message_input__avatar {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-quote_message_input .sendbird-quote_message_input__avatar {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-quote_message_input .sendbird-quote_message_input__body {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  overflow: hidden;\n}\n.sendbird-quote_message_input .sendbird-quote_message_input__body .sendbird-quote_message_input__body__sender-name {\n  position: relative;\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  box-sizing: border-box;\n  margin-bottom: 8px;\n}\n.sendbird-quote_message_input .sendbird-quote_message_input__body .sendbird-quote_message_input__body__message-content {\n  position: relative;\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  box-sizing: border-box;\n}\n.sendbird-quote_message_input .sendbird-quote_message_input__close-button {\n  position: absolute;\n  top: 26px;\n  right: 40px;\n}\n.sendbird-quote_message_input .sendbird-quote_message_input__close-button:hover {\n  cursor: pointer;\n}\n.sendbird-voice-message-input-wrapper .sendbird-voice-message-input__indicator {\n  height: 40px;\n}\n\n.sendbird-voice-message-input-wrapper-alert__body {\n  position: relative;\n  display: flex;\n  justify-content: flex-end;\n  align-items: flex-end;\n  width: 100%;\n  height: 74px;\n}\n\n.sendbird-voice-message-input-wrapper-alert__body__ok-button {\n  width: 74px;\n}\n.sendbird-voice-message-input {\n  position: relative;\n  display: inline-flex;\n  flex-direction: column;\n  width: 100%;\n  height: 110px;\n  padding-top: 22px;\n  padding-left: 24px;\n  padding-right: 24px;\n  box-sizing: border-box;\n}\n\n.sendbird-voice-message-input__indicator {\n  position: relative;\n  display: inline-flex;\n  width: 100%;\n}\n\n.sendbird-voice-message-input__indicator__progress-bar {\n  position: relative;\n  display: inline-flex;\n  width: 100%;\n  border-radius: 28px;\n  overflow: hidden;\n}\n\n.sendbird-voice-message-input__indicator__on-rec {\n  position: absolute;\n  top: 14px;\n  right: 53px;\n}\n\n.sendbird-voice-message-input__indicator__playback-time {\n  position: absolute;\n  top: 10px;\n  right: 16px;\n}\n\n.sendbird-voice-message-input__controler {\n  position: relative;\n  display: inline-flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 14px;\n  height: 34px;\n  min-height: 34px;\n}\n\n.sendbird-voice-message-input__controler__main {\n  position: relative;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  width: 34px;\n  height: 34px;\n  min-width: 34px;\n  min-height: 34px;\n  border-radius: 50%;\n}\n.sendbird-theme--light .sendbird-voice-message-input__controler__main {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-voice-message-input__controler__main {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-voice-message-input__controler__main:hover {\n  cursor: pointer;\n}\n\n.sendbird-voice-message-input__controler__submit {\n  position: relative;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  width: 34px;\n  height: 34px;\n  min-width: 34px;\n  min-height: 34px;\n  border-radius: 50%;\n}\n.sendbird-theme--light .sendbird-voice-message-input__controler__submit {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-voice-message-input__controler__submit {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-voice-message-input__controler__submit:hover {\n  cursor: pointer;\n}\n\n.sendbird-theme--light .sendbird-voice-message-input__controler__submit.voice-message--disabled {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-voice-message-input__controler__submit.voice-message--disabled {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-voice-message-input__controler__submit.voice-message--disabled:hover {\n  cursor: default;\n}\n\n@keyframes flickerAnimation {\n  0% {\n    opacity: 0;\n  }\n  50% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n.sendbird-voice-message-input__indicator__on-rec {\n  width: 12px;\n  height: 12px;\n  min-width: 12px;\n  min-height: 12px;\n  border-radius: 50%;\n  animation: flickerAnimation 1s infinite;\n}\n.sendbird-theme--light .sendbird-voice-message-input__indicator__on-rec {\n  background-color: var(--sendbird-light-error-300);\n}\n.sendbird-theme--dark .sendbird-voice-message-input__indicator__on-rec {\n  background-color: var(--sendbird-dark-error-300);\n}\n\n.sendbird-voice-message-input__indicator__progress-bar__bar {\n  height: 40px;\n}\n\n.sendbird-controler-icon {\n  position: relative;\n  display: inline-block;\n}\n\n.sendbird-controler-icon.record-icon {\n  width: 20px;\n  height: 20px;\n  min-width: 20px;\n  min-height: 20px;\n  border-radius: 50%;\n}\n.sendbird-theme--light .sendbird-controler-icon.record-icon {\n  background-color: var(--sendbird-light-error-300);\n}\n.sendbird-theme--dark .sendbird-controler-icon.record-icon {\n  background-color: var(--sendbird-dark-error-300);\n}\n\n.sendbird-controler-icon.stop-icon {\n  width: 14px;\n  height: 14px;\n  min-width: 14px;\n  min-height: 14px;\n  border-radius: 2px;\n}\n.sendbird-theme--light .sendbird-controler-icon.stop-icon {\n  background-color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-controler-icon.stop-icon {\n  background-color: var(--sendbird-dark-ondark-01);\n}\n\n.sendbird-controler-icon.pause-icon {\n  display: inline-flex;\n  width: 100%;\n  gap: 3.75px;\n  width: 13.75px;\n  height: 13.75px;\n  min-width: 13.75px;\n  min-height: 13.75px;\n}\n\n.sendbird-controler-icon.pause-icon-inner {\n  display: inline-flex;\n  min-width: 4.38px;\n  border-radius: 2px;\n}\n.sendbird-theme--light .sendbird-controler-icon.pause-icon-inner {\n  background-color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-controler-icon.pause-icon-inner {\n  background-color: var(--sendbird-dark-ondark-01);\n}\n.sendbird-channel-settings {\n  height: 100%;\n  width: 320px;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.sendbird--mobile-mode .sendbird-channel-settings {\n  width: 100%;\n}\n.sendbird-theme--light .sendbird-channel-settings {\n  background-color: var(--sendbird-light-background-50);\n  border-left: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-channel-settings {\n  background-color: var(--sendbird-dark-background-600);\n  border-left: 1px solid var(--sendbird-dark-background-600);\n}\n.sendbird-channel-settings .sendbird-channel-settings__header-icon {\n  cursor: pointer;\n  position: absolute;\n  top: 16px;\n  right: 16px;\n}\n.sendbird-theme--light .sendbird-channel-settings .sendbird-channel-settings__header-icon .sendbird-channel-settings__close-icon path {\n  fill: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-channel-settings .sendbird-channel-settings__header-icon .sendbird-channel-settings__close-icon path {\n  fill: var(--sendbird-dark-ondark-01);\n}\n.sendbird-channel-settings .sendbird-channel-settings__members .sendbird-badge__text {\n  margin-top: -2px;\n}\n.sendbird-channel-settings .sendbird-channel-settings__header {\n  height: 64px;\n  min-height: 64px;\n  position: relative;\n  padding: 20px 24px;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-channel-settings .sendbird-channel-settings__header {\n  border-bottom: solid 1px var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-channel-settings .sendbird-channel-settings__header {\n  border-bottom: solid 1px var(--sendbird-dark-ondark-04);\n}\n.sendbird-channel-settings .sendbird-channel-settings__scroll-area {\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n  height: calc(100% - 64px);\n  overflow-y: auto;\n}\n.sendbird-channel-settings .sendbird-channel-settings__panel-item {\n  cursor: pointer;\n  position: relative;\n  padding: 12px 22px 10px 56px;\n}\n.sendbird-theme--light .sendbird-channel-settings .sendbird-channel-settings__panel-item {\n  background-color: var(--sendbird-light-background-50);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-channel-settings .sendbird-channel-settings__panel-item {\n  background-color: var(--sendbird-dark-background-600);\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-channel-settings .sendbird-channel-settings__panel-item:focus {\n  outline: none;\n}\n.sendbird-channel-settings .sendbird-channel-settings__panel-item.sendbird-channel-settings__panel-item__disabled {\n  cursor: not-allowed;\n}\n.sendbird-channel-settings .sendbird-channel-settings__panel-icon-left,\n.sendbird-channel-settings .sendbird-channel-settings__panel-icon-right {\n  position: absolute;\n  top: 10px;\n}\n.sendbird-channel-settings .sendbird-channel-settings__panel-icon-left {\n  left: 16px;\n}\n.sendbird-channel-settings .sendbird-channel-settings__panel-icon-right {\n  right: 16px;\n}\n.sendbird-channel-settings .sendbird-channel-settings__panel-icon--open {\n  transform: rotate(90deg);\n}\n.sendbird-theme--light .sendbird-channel-settings .sendbird-channel-settings__panel-icon--chevron path {\n  fill: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-channel-settings .sendbird-channel-settings__panel-icon--chevron path {\n  fill: var(--sendbird-dark-ondark-01);\n}\n.sendbird-channel-profile {\n  position: relative;\n  text-align: center;\n  padding: 32px 40px 27px 40px;\n}\n.sendbird-theme--light .sendbird-channel-profile {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-channel-profile {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-channel-profile .sendbird-channel-profile--inner {\n  height: 92px;\n}\n.sendbird-channel-profile .sendbird-channel-profile__avatar {\n  margin-bottom: 16px;\n  display: flex;\n  justify-content: center;\n}\n.sendbird-channel-profile .sendbird-channel-profile__title {\n  display: block;\n  max-width: 240px;\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  height: 18px;\n}\n.sendbird--mobile-mode .sendbird-channel-profile .sendbird-channel-profile__title {\n  max-width: 100%;\n}\n.sendbird-channel-profile .sendbird-channel-profile__edit {\n  position: absolute;\n  top: 10px;\n  right: 16px;\n}\n\n.channel-profile-form .channel-profile-form__img-section {\n  position: relative;\n}\n.channel-profile-form .channel-profile-form__avatar-button {\n  position: absolute;\n  top: 54px;\n  left: 96px;\n}\n.channel-profile-form .channel-profile-form__avatar {\n  margin-top: 16px;\n}\n.channel-profile-form .channel-profile-form__name-section {\n  margin-top: 12px;\n}\n.channel-profile-form .channel-profile-form__name-section .sendbird-input {\n  height: 40px;\n}\n.sendbird-channel-settings__operator .sendbird-channel-settings__accordion-icon {\n  position: absolute;\n  left: 14px;\n}\n.sendbird-channel-settings__operator .sendbird-accordion__panel-heder {\n  position: relative;\n}\n\n.sendbird-more-members__popup-scroll {\n  max-height: 420px;\n  overflow-x: hidden;\n  overflow-y: scroll;\n}\n.sendbird--mobile-mode .sendbird-more-members__popup-scroll {\n  max-height: 100%;\n}\n.sendbird-more-members__popup-scroll .sendbird-user-list-item__operator {\n  right: 72px;\n}\n.sendbird-more-members__popup-scroll .sendbird-user-list-item__title {\n  max-width: 240px;\n}\n\n.sendbird-channel-settings__empty-list {\n  text-align: center;\n  margin-top: 12px;\n  margin-bottom: 4px;\n  display: block;\n}\n\n.sendbird-channel-settings-accordion__footer {\n  padding-top: 16px;\n  display: flex;\n  justify-content: left;\n  padding-left: 12px;\n}\n.sendbird-channel-settings-accordion__footer .sendbird-button:nth-child(2) {\n  margin-left: 8px;\n}\n\n.sendbird-channel-settings__freeze {\n  max-width: 320px;\n  position: relative;\n  padding: 12px 22px 10px 56px;\n}\n.sendbird--mobile-mode .sendbird-channel-settings__freeze {\n  max-width: 100%;\n}\n.sendbird-theme--light .sendbird-channel-settings__freeze {\n  background-color: var(--sendbird-light-background-50);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-channel-settings__freeze {\n  background-color: var(--sendbird-dark-background-600);\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n\n.sendbird-channel-settings__frozen-icon {\n  position: absolute;\n  right: 20px;\n  top: 12px;\n}\n.sendbird-channel-settings__frozen-icon .sendbird-icon {\n  cursor: pointer;\n}\n\n.sendbird-channel-settings__members-list .sendbird-badge,\n.sendbird-channel-settings__members .sendbird-badge {\n  position: absolute;\n  right: 44px;\n  top: 12px;\n}\n.sendbird-theme--light .sendbird-channel-settings__members-list .sendbird-badge,\n.sendbird-theme--light .sendbird-channel-settings__members .sendbird-badge {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-channel-settings__members-list .sendbird-badge,\n.sendbird-theme--dark .sendbird-channel-settings__members .sendbird-badge {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-theme--light .sendbird-channel-settings__members-list .sendbird-badge .sendbird-label,\n.sendbird-theme--light .sendbird-channel-settings__members .sendbird-badge .sendbird-label {\n  color: var(--sendbird-light-onlight-02);\n}\n.sendbird-theme--dark .sendbird-channel-settings__members-list .sendbird-badge .sendbird-label,\n.sendbird-theme--dark .sendbird-channel-settings__members .sendbird-badge .sendbird-label {\n  color: var(--sendbird-dark-ondark-02);\n}\n.sendbird-accordion {\n  padding: 8px 0px 16px 0px;\n  position: relative;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-accordion {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-accordion {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-accordion .sendbird-accordion__member {\n  position: relative;\n  padding: 12px 0px 12px 44px;\n  height: 40px;\n  box-sizing: border-box;\n}\n.sendbird-accordion .sendbird-accordion__footer {\n  display: flex;\n  justify-content: flex-start;\n  margin-top: 8px;\n}\n\n.sendbird-accordion__panel-header {\n  cursor: pointer;\n  position: relative;\n  padding: 12px 22px 10px 56px;\n}\n.sendbird-theme--light .sendbird-accordion__panel-header {\n  background-color: var(--sendbird-light-background-50);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-accordion__panel-header {\n  background-color: var(--sendbird-dark-background-600);\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-accordion__panel-header:focus {\n  outline: none;\n}\n.sendbird-accordion__panel-header.sendbird-accordion__panel-item__disabled {\n  cursor: not-allowed;\n}\n\n.sendbird-accordion__panel-icon-left,\n.sendbird-accordion__panel-icon-right {\n  position: absolute;\n  top: 10px;\n}\n\n.sendbird-accordion__panel-icon-left {\n  left: 16px;\n}\n\n.sendbird-accordion__panel-icon-right {\n  right: 16px;\n}\n\n.sendbird-accordion__panel-icon--open {\n  transform: rotate(90deg);\n}\n\n.sendbird-theme--light .sendbird-accordion__panel-icon--chevron path {\n  fill: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-accordion__panel-icon--chevron path {\n  fill: var(--sendbird-dark-ondark-01);\n}\n\n.sendbird-theme--light .sendbird-accordion__panel-icon__leave path {\n  fill: var(--sendbird-light-error-300);\n}\n.sendbird-theme--dark .sendbird-accordion__panel-icon__leave path {\n  fill: var(--sendbird-dark-error-300);\n}\n.sendbird-input-toggle-button {\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  box-sizing: border-box;\n  cursor: pointer;\n}\n\n.sendbird-theme--light .sendbird-input-toggle-button--checked {\n  background-color: var(--sendbird-light-primary-300);\n  border: 1px solid var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-input-toggle-button--checked {\n  background-color: var(--sendbird-dark-primary-200);\n  border: 1px solid var(--sendbird-dark-primary-200);\n}\n\n.sendbird-theme--light .sendbird-input-toggle-button--unchecked {\n  background-color: var(--sendbird-light-background-300);\n  border: 1px solid var(--sendbird-light-background-300);\n}\n.sendbird-theme--dark .sendbird-input-toggle-button--unchecked {\n  background-color: var(--sendbird-dark-background-400);\n  border: 1px solid var(--sendbird-dark-background-400);\n}\n\n.sendbird-input-toggle-button--disabled {\n  cursor: not-allowed;\n}\n.sendbird-theme--light .sendbird-input-toggle-button--disabled {\n  background-color: var(--sendbird-light-background-200);\n  border: 1px solid var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-input-toggle-button--disabled {\n  background-color: var(--sendbird-dark-background-400);\n  border: 1px solid var(--sendbird-dark-background-400);\n}\n\n.sendbird-input-toggle-button input {\n  position: absolute;\n  display: none;\n}\n\n.sendbird-input-toggle-button__inner-dot {\n  position: absolute;\n  border-radius: 50%;\n  animation-iteration-count: 1;\n}\n.sendbird-theme--light .sendbird-input-toggle-button__inner-dot {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-input-toggle-button__inner-dot {\n  background-color: var(--sendbird-dark-background-600);\n}\n\n/* Manage animation and position by status */\n@keyframes sendbirdMoveToRight {\n  0% {\n    right: 60%;\n  }\n  100% {\n    right: 10%;\n  }\n}\n@keyframes sendbirdMoveToLeft {\n  0% {\n    right: 10%;\n  }\n  100% {\n    right: 60%;\n  }\n}\n.sendbird-input-toggle-button--turned-on .sendbird-input-toggle-button__inner-dot {\n  animation-name: sendbirdMoveToRight;\n}\n\n.sendbird-input-toggle-button--turned-off .sendbird-input-toggle-button__inner-dot {\n  animation-name: sendbirdMoveToLeft;\n}\n\n.sendbird-input-toggle-button--unchecked .sendbird-input-toggle-button__inner-dot {\n  right: 60%;\n}\n\n.sendbird-input-toggle-button--checked .sendbird-input-toggle-button__inner-dot {\n  right: 10%;\n}\n\n.sendbird-input-toggle-button--reversed .sendbird-input-toggle-button--turned-on .sendbird-input-toggle-button__inner-dot {\n  animation-name: sendbirdMoveToLeft;\n}\n.sendbird-input-toggle-button--reversed .sendbird-input-toggle-button--turned-off .sendbird-input-toggle-button__inner-dot {\n  animation-name: sendbirdMoveToRight;\n}\n.sendbird-input-toggle-button--reversed.sendbird-input-toggle-button--unchecked .sendbird-input-toggle-button__inner-dot {\n  right: 10%;\n}\n.sendbird-input-toggle-button--reversed.sendbird-input-toggle-button--checked .sendbird-input-toggle-button__inner-dot {\n  right: 60%;\n}\n.sendbird-user-list-item--small {\n  display: block;\n  position: relative;\n  box-sizing: border-box;\n  height: 40px;\n}\n.sendbird-user-list-item--small__avatar {\n  cursor: pointer;\n  position: absolute;\n  top: 10px;\n  left: 12px;\n}\n.sendbird-user-list-item--small .sendbird-muted-avatar {\n  position: absolute;\n  top: 10px;\n  left: 12px;\n  pointer-events: none;\n}\n.sendbird-user-list-item--small__title {\n  position: absolute;\n  top: 10px;\n  left: 54px;\n  width: 160px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-user-list-item--small__subtitle {\n  position: absolute;\n  top: 23px;\n  left: 140px;\n  max-width: 237px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird--mobile-mode .sendbird-user-list-item--small__subtitle {\n  max-width: 40%;\n}\n.sendbird-user-list-item--small__checkbox {\n  position: absolute;\n  top: 16px;\n  right: 16px;\n}\n.sendbird-user-list-item--small__action {\n  display: none;\n  position: absolute;\n  right: 10px;\n  top: 4px;\n}\n.sendbird-user-list-item--small__operator {\n  position: absolute;\n  right: 24px;\n  top: 10px;\n}\n.sendbird-theme--light .sendbird-user-list-item--small:hover, .sendbird-theme--light .sendbird-user-list-item--small.sendbird-icon--pressed {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-user-list-item--small:hover, .sendbird-theme--dark .sendbird-user-list-item--small.sendbird-icon--pressed {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-user-list-item--small:hover .sendbird-user-list-item--small__action, .sendbird-user-list-item--small.sendbird-icon--pressed .sendbird-user-list-item--small__action {\n  display: block;\n}\n.sendbird-user-list-item--small:hover .sendbird-user-list-item--small__operator, .sendbird-user-list-item--small.sendbird-icon--pressed .sendbird-user-list-item--small__operator {\n  display: none;\n}\n.sendbird-theme--light .sendbird-user-list-item--small.sendbird-icon--pressed .sendbird-iconbutton {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-user-list-item--small.sendbird-icon--pressed .sendbird-iconbutton {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-channel-settings__leave-label--mobile {\n  text-decoration: none;\n}\n\n.sendbird-channel-settings__leave--mobile .sendbird-modal__content {\n  max-width: calc(100% - 80px);\n}\n.sendbird-channel-settings__leave--mobile .sendbird-modal__close {\n  display: none;\n}\n.sendbird-channel-settings__leave--mobile .sendbird-channel-preview__leave-label--mobile {\n  text-decoration: none;\n}\n.sendbird-channel-settings__leave--mobile .sendbird-modal__header span {\n  display: inline-block;\n  width: calc(100% - 120px);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-more-members__popup-scroll {\n  max-height: 420px;\n  overflow-x: hidden;\n  overflow-y: scroll;\n}\n.sendbird--mobile-mode .sendbird-more-members__popup-scroll {\n  max-height: 100%;\n}\n.sendbird-more-members__popup-scroll .sendbird-user-list-item__operator {\n  right: 72px;\n}\n.sendbird-more-members__popup-scroll .sendbird-user-list-item__title {\n  max-width: 240px;\n}\n\n.sendbird-channel-settings__badge {\n  position: absolute;\n  right: 48px;\n}\n.sendbird-theme--light .sendbird-channel-settings__badge {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-channel-settings__badge {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-theme--light .sendbird-channel-settings__badge .sendbird-label {\n  color: var(--sendbird-light-onlight-02);\n}\n.sendbird-theme--dark .sendbird-channel-settings__badge .sendbird-label {\n  color: var(--sendbird-dark-ondark-02);\n}\n\n.sendbird-channel-settings__user-panel .sendbird-channel-settings-accordion__footer {\n  padding-left: 14px;\n  padding-top: 14px;\n}\n.sendbird-message-search-pannel {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  width: 320px;\n  height: 100%;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-message-search-pannel {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-message-search-pannel {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird--mobile-mode .sendbird-message-search-pannel {\n  width: 100%;\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__input__container__input-area {\n  position: absolute;\n  top: 14px;\n  left: 48px;\n  margin: 0px;\n  padding: 0px;\n  border: 0px;\n  outline: none;\n  font-size: 14px;\n  width: calc(100% - 90px);\n}\n.sendbird-theme--light .sendbird-message-search-pannel .sendbird-message-search-pannel__input__container__input-area {\n  color: var(--sendbird-light-onlight-01);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-message-search-pannel .sendbird-message-search-pannel__input__container__input-area {\n  color: var(--sendbird-dark-ondark-01);\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__header {\n  position: relative;\n  display: flex;\n  width: 100%;\n  height: 64px;\n  min-height: 64px;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-message-search-pannel .sendbird-message-search-pannel__header {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-message-search-pannel .sendbird-message-search-pannel__header {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__header .sendbird-message-search-pannel__header__title {\n  position: absolute;\n  top: 20px;\n  left: 24px;\n  width: calc(100% - 74px);\n  overflow-x: hidden;\n  word-break: keep-all;\n  text-overflow: ellipsis;\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__header .sendbird-message-search-pannel__header__close-button {\n  position: absolute;\n  top: 16px;\n  right: 16px;\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__input {\n  display: flex;\n  position: relative;\n  padding: 16px;\n  box-sizing: border-box;\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__input .sendbird-message-search-pannel__input__container {\n  position: relative;\n  border-radius: 4px;\n  width: 100%;\n  height: 44px;\n}\n.sendbird-theme--light .sendbird-message-search-pannel .sendbird-message-search-pannel__input .sendbird-message-search-pannel__input__container {\n  border: 1px solid var(--sendbird-light-onlight-03);\n}\n.sendbird-theme--dark .sendbird-message-search-pannel .sendbird-message-search-pannel__input .sendbird-message-search-pannel__input__container {\n  border: 1px solid var(--sendbird-dark-ondark-03);\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__input .sendbird-message-search-pannel__input__container .sendbird-message-search-pannel__input__container__search-icon {\n  position: absolute;\n  top: 10px;\n  left: 16px;\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__input .sendbird-message-search-pannel__input__container .sendbird-message-search-pannel__input__container__spinner {\n  position: absolute;\n  top: 12px;\n  right: 12px;\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__input .sendbird-message-search-pannel__input__container .sendbird-message-search-pannel__input__container__reset-input-button {\n  position: absolute;\n  top: 12px;\n  right: 12px;\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__input .sendbird-message-search-pannel__input__container .sendbird-message-search-pannel__input__container__reset-input-button:hover {\n  cursor: pointer;\n}\n.sendbird-message-search-pannel .sendbird-message-search-pannel__message-search {\n  position: relative;\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n  overflow-y: hidden;\n}\n.sendbird-message-search {\n  position: relative;\n  height: 100%;\n  overflow-x: hidden;\n  overflow-y: scroll;\n}\n.sendbird-theme--light .sendbird-message-search {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-message-search {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-message-search-item {\n  display: inline-flex;\n  flex-direction: row;\n  width: 100%;\n  height: 80px;\n  position: relative;\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-message-search-item {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-message-search-item {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-theme--light .sendbird-message-search-item:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-message-search-item:hover {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-message-search-item .sendbird-message-search-item__left {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 90px;\n  height: 80px;\n}\n.sendbird-message-search-item .sendbird-message-search-item__right {\n  display: flex;\n  flex-direction: column;\n  width: calc(100% - 106px);\n}\n.sendbird-message-search-item .sendbird-message-search-item__right .sendbird-message-search-item__right__sender-name {\n  position: absolute;\n  top: 12px;\n  display: inline;\n  max-width: 150px;\n  height: 16px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  word-break: keep-all;\n}\n.sendbird-message-search-item .sendbird-message-search-item__right .sendbird-message-search-item__right__message-text {\n  box-sizing: border-box;\n  display: flex;\n  width: inherit;\n  height: 32px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  position: absolute;\n  top: 36px;\n  word-break: break-word;\n}\n.sendbird-message-search-item .sendbird-message-search-item__right .sendbird-message-search-item__right__message-created-at {\n  position: absolute;\n  top: 12px;\n  right: 18px;\n}\n.sendbird-message-search-item .sendbird-message-search-item__right-footer {\n  width: 16px;\n}\n\n.sendbird-theme--light .sendbird-message-search-item.sendbird-message-search-item--selected {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-message-search-item.sendbird-message-search-item--selected {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-theme--light .sendbird-message-search-item.sendbird-message-search-item--selected .sendbird-message-search-item__left {\n  border-left: 4px solid var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-message-search-item.sendbird-message-search-item--selected .sendbird-message-search-item__left {\n  border-left: 4px solid var(--sendbird-dark-primary-200);\n}\n.sendbird-message-search-file-item {\n  position: relative;\n  display: inline-flex;\n  flex-direction: row;\n  width: 100%;\n  height: 80px;\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-message-search-file-item {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-message-search-file-item {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-theme--light .sendbird-message-search-file-item:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-message-search-file-item:hover {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-message-search-file-item .sendbird-message-search-file-item__left {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 90px;\n  height: 80px;\n}\n.sendbird-message-search-file-item .sendbird-message-search-file-item__right {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  width: calc(100% - 106px);\n}\n.sendbird-message-search-file-item .sendbird-message-search-file-item__right .sendbird-message-search-file-item__right__sender-name {\n  position: absolute;\n  top: 12px;\n  display: inline-block;\n  max-width: 146px;\n  height: 16px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-message-search-file-item .sendbird-message-search-file-item__right .sendbird-message-search-file-item__right__content {\n  position: absolute;\n  top: 36px;\n  box-sizing: border-box;\n  width: 100%;\n  height: 32px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n.sendbird-message-search-file-item .sendbird-message-search-file-item__right .sendbird-message-search-file-item__right__content .sendbird-message-search-file-item__right__content__type-icon {\n  position: relative;\n  margin-right: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 26px;\n  min-width: 26px;\n  height: 26px;\n  border-radius: 8px;\n}\n.sendbird-theme--light .sendbird-message-search-file-item .sendbird-message-search-file-item__right .sendbird-message-search-file-item__right__content .sendbird-message-search-file-item__right__content__type-icon {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-message-search-file-item .sendbird-message-search-file-item__right .sendbird-message-search-file-item__right__content .sendbird-message-search-file-item__right__content__type-icon {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-message-search-file-item .sendbird-message-search-file-item__right .sendbird-message-search-file-item__right__content .sendbird-message-search-file-item__right__content__url {\n  height: 16px;\n  position: relative;\n  display: inline;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  word-break: keep-all;\n  white-space: nowrap;\n}\n.sendbird-message-search-file-item .sendbird-message-search-file-item__message-created-at {\n  position: absolute;\n  top: 12px;\n  right: 18px;\n}\n.sendbird-message-search-file-item .sendbird-message-search-file-item__right-footer {\n  width: 16px;\n}\n\n.sendbird-theme--light .sendbird-message-search-file-item.sendbird-message-search-file-item--selected {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-message-search-file-item.sendbird-message-search-file-item--selected {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-theme--light .sendbird-message-search-file-item.sendbird-message-search-file-item--selected .sendbird-message-search-file-item__left {\n  border-left: 4px solid var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-message-search-file-item.sendbird-message-search-file-item--selected .sendbird-message-search-file-item__left {\n  border-left: 4px solid var(--sendbird-dark-primary-200);\n}\n.sendbird-thread-ui {\n  position: relative;\n  max-width: 320px;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n}\n.sendbird-theme--light .sendbird-thread-ui {\n  border-right: 1px solid var(--sendbird-light-onlight-04);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-thread-ui {\n  border-right: 1px solid var(--sendbird-dark-ondark-04);\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-600);\n}\n\n.sendbird-thread-ui__header {\n  width: 100%;\n}\n.sendbird-theme--light .sendbird-thread-ui__header {\n  border-top: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-thread-ui__header {\n  border-top: 1px solid var(--sendbird-dark-ondark-04);\n}\n\n.sendbird-thread-ui--scroll {\n  overflow-y: scroll;\n  overflow-x: hidden;\n  height: 100%;\n  display: inline-flex;\n  flex-direction: column;\n  justify-content: flex-start;\n}\n\n.sendbird-theme--light .sendbird-thread-ui__parent-message-info {\n  border-top: 1px solid var(--sendbird-light-onlight-04);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-thread-ui__parent-message-info {\n  border-top: 1px solid var(--sendbird-dark-ondark-04);\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-theme--light .sendbird-thread-ui__parent-message-info .sendbird-word__mention .sendbird-label {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-thread-ui__parent-message-info .sendbird-word__mention .sendbird-label {\n  color: var(--sendbird-dark-ondark-01);\n}\n\n.sendbird-thread-ui__reply-counts {\n  position: relative;\n  box-sizing: border-box;\n  width: 100%;\n  height: 42px;\n  display: inline-flex;\n  justify-content: flex-start;\n  align-items: center;\n  padding: 16px 11px;\n}\n.sendbird-theme--light .sendbird-thread-ui__reply-counts {\n  border-top: 1px solid var(--sendbird-light-onlight-04);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-thread-ui__reply-counts {\n  border-top: 1px solid var(--sendbird-dark-ondark-04);\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n\n.sendbird-thread-ui__thread-list {\n  padding: 16px;\n}\n\n.sendbird-thread-ui__message-input {\n  padding: 0px 16px;\n  margin-bottom: 24px;\n}\n\n.sendbird-thread-ui__thread-list.sendbird-place-holder {\n  box-sizing: border-box;\n}\n.sendbird-parent-message-info {\n  position: relative;\n  width: 100%;\n  height: -moz-fit-content;\n  height: fit-content;\n  padding: 12px 12px 12px 16px;\n  display: inline-flex;\n  flex-direction: row;\n  align-items: flex-start;\n  box-sizing: border-box;\n}\n\n.sendbird-parent-message-info__sender {\n  position: relative;\n  min-width: 40px;\n  min-height: 40px;\n}\n\n.sendbird-parent-message-info__content {\n  position: relative;\n  margin-left: 12px;\n  display: inline-flex;\n  flex-direction: column;\n}\n\n.sendbird-parent-message-info__content__info {\n  position: relative;\n  max-width: 188px;\n  height: 16px;\n  display: inline-flex;\n  flex-direction: row;\n  justify-content: flex-start;\n  align-items: center;\n}\n\n.sendbird-parent-message-info__content__info__sender-name,\n.sendbird-parent-message-info__content__info__sender-name--use-reaction {\n  position: relative;\n  margin-right: 6px;\n  word-break: keep-all;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.sendbird-parent-message-info__content__info__sender-name {\n  max-width: 142px;\n}\n\n.sendbird-parent-message-info__content__info__sender-name--use-reaction {\n  max-width: 110px;\n}\n\n.sendbird-parent-message-info__content__info__sent-at {\n  position: relative;\n  max-width: 52px;\n  height: 12px;\n  display: inline-flex;\n  justify-content: flex-start;\n  align-items: center;\n  white-space: nowrap;\n  word-break: keep-all;\n}\n\n.sendbird-parent-message-info__content__body {\n  position: relative;\n  max-width: 210px;\n  overflow: hidden;\n}\n\n.sendbird-parent-message-info__content__body.sendbird-thumbnail-message-item-body.incoming {\n  min-width: 200px;\n  height: 148px;\n}\n\n.sendbird-parent-message-info__content__reactions {\n  position: relative;\n  max-width: 240px;\n  width: 100%;\n  height: 100%;\n}\n\n.sendbird-parent-message-info__context-menu {\n  position: absolute;\n  top: 6px;\n  right: 12px;\n  display: none;\n}\n\n.sendbird-parent-message-info__context-menu.use-reaction {\n  right: 44px;\n}\n\n.sendbird-parent-message-info__reaction-menu {\n  position: absolute;\n  top: 6px;\n  right: 12px;\n  display: none;\n}\n\n.sendbird-parent-message-info .sendbird-text-message-item-body.reactions {\n  border-radius: 16px;\n}\n\n.sendbird-theme--light .sendbird-parent-message-info .sendbird-emoji-reactions {\n  border: 1px solid var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-parent-message-info .sendbird-emoji-reactions {\n  border: 1px solid var(--sendbird-dark-background-600);\n}\n\n.sendbird-parent-message-info:hover .sendbird-parent-message-info__context-menu,\n.sendbird-parent-message-info:hover .sendbird-parent-message-info__reaction-menu,\n.sendbird-parent-message-info__context-menu.sendbird-mouse-hover,\n.sendbird-parent-message-info__reaction-menu.sendbird-mouse-hover {\n  display: inline-flex;\n}\n\n.sendbird-theme--light .sendbird-parent-message-info .sendbird-parent-message-info__content__body {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-parent-message-info .sendbird-parent-message-info__content__body {\n  background-color: var(--sendbird-dark-background-600);\n}\n\n.sendbird-theme--light .sendbird-parent-message-info:hover,\n.sendbird-theme--light .sendbird-parent-message-info:hover .sendbird-parent-message-info__content__body {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-parent-message-info:hover,\n.sendbird-theme--dark .sendbird-parent-message-info:hover .sendbird-parent-message-info__content__body {\n  background-color: var(--sendbird-dark-background-500);\n}\n\n.sendbird--mobile-mode .sendbird-parent-message-info.sendbird-thread-ui__parent-message-info:hover {\n  background-color: transparent;\n}\n\n.sendbird-theme--light .sendbird-parent-message-info:hover .sendbird-emoji-reactions {\n  border: 1px solid var(--sendbird-light-background-100);\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-parent-message-info:hover .sendbird-emoji-reactions {\n  border: 1px solid var(--sendbird-dark-background-500);\n  background-color: var(--sendbird-dark-background-500);\n}\n\n.parent-message-info--suggested-mention-list {\n  width: 100%;\n  margin-left: 0px;\n  margin-right: 0px;\n  min-height: 200px;\n}\n\n.parent-message-info--suggested-mention-list .sendbird-mention-suggest-list__user-item {\n  padding-left: 16px;\n  padding-right: 16px;\n}\n\n.parent-message-info--suggested-mention-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__nickname {\n  max-width: 166px;\n}\n\n.parent-message-info--suggested-mention-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__user-id {\n  max-width: 68px;\n}\n.sendbird-parent-message-info-item {\n  position: relative;\n  margin-top: 8px;\n}\n\n.sendbird-parent-message-info-item__text-message,\n.sendbird-parent-message-info-item__og-field {\n  padding-right: 4px;\n  display: inline-block;\n  white-space: pre-line;\n  word-break: break-all;\n}\n\n.sendbird-parent-message-info-item__og-field {\n  display: inline-flex;\n  flex-direction: column;\n  margin-top: 4px;\n}\n\n.sendbird-parent-message-info-item__og-field__content {\n  display: inline-flex;\n  flex-direction: column;\n  padding: 8px 12px;\n  gap: 4px;\n}\n\n.sendbird-parent-message-info-item__file-message {\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 8px;\n}\n\n.sendbird-parent-message-info-item__file-message__file-name {\n  display: inline-block;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  max-width: 200px;\n}\n\n.sendbird-parent-message-info-item__thumbnail-message {\n  position: relative;\n  display: block;\n  width: 200px;\n  height: 148px;\n}\n\n.sendbird-parent-message-info-item__thumbnail-message__thumbnail {\n  position: absolute;\n  border-radius: 16px;\n}\n\n.sendbird-parent-message-info-item__thumbnail-message__placeholder {\n  position: absolute;\n  width: 100%;\n  height: 148px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.sendbird-parent-message-info-item__thumbnail-message__placeholder__icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 56px;\n  height: 56px;\n  border-radius: 50%;\n  background-color: var(--sendbird-light-background-50);\n}\n\n.sendbird-parent-message-info-item__thumbnail-message__image-cover {\n  position: absolute;\n  top: 0px;\n  display: none;\n  width: 100%;\n  height: 148px;\n  border-radius: 16px;\n  background-color: var(--sendbird-light-overlay-01);\n}\n\n.sendbird-parent-message-info-item__thumbnail-message__video {\n  position: absolute;\n  width: 100%;\n  height: 148px;\n  border-radius: 16px;\n}\n\n.sendbird-parent-message-info-item__thumbnail-message__icon-wrapper {\n  position: absolute;\n  width: 100%;\n  height: 148px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.sendbird-parent-message-info-item__thumbnail-message__icon-wrapper__icon {\n  width: 56px;\n  height: 56px;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 50%;\n  background-color: var(--sendbird-light-background-50);\n}\n\n.sendbird-parent-message-info-item__thumbnail-message:hover {\n  cursor: pointer;\n}\n.sendbird-parent-message-info-item__thumbnail-message:hover .sendbird-parent-message-info-item__thumbnail-message__image-cover {\n  display: inline-flex;\n}\n\n.sendbird-parent-message-info-item__voice-message__item {\n  min-width: 136px;\n  height: 50px;\n}\n.sendbird-fileviewer__header__right__actions__download,\n.sendbird-fileviewer__header__right__actions__delete,\n.sendbird-fileviewer__header__right__actions__close {\n  width: 64px;\n  padding: 21px;\n  box-sizing: border-box;\n  cursor: pointer;\n}\n.sendbird-fileviewer__header__right__actions__download .disabled,\n.sendbird-fileviewer__header__right__actions__delete .disabled,\n.sendbird-fileviewer__header__right__actions__close .disabled {\n  cursor: not-allowed;\n}\n\n.sendbird-fileviewer {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 100000;\n}\n.sendbird-theme--light .sendbird-fileviewer {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-fileviewer {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-fileviewer .sendbird-fileviewer__header {\n  height: 64px;\n  min-height: 64px;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: space-between;\n}\n.sendbird-theme--light .sendbird-fileviewer .sendbird-fileviewer__header {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-fileviewer .sendbird-fileviewer__header {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__left {\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 64px;\n  padding: 16px 20px;\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__left .sendbird-fileviewer__header__left__avatar {\n  margin-right: 8px;\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__left .sendbird-fileviewer__header__left__filename {\n  max-width: 500px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: inline-block;\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__left .sendbird-fileviewer__header__left__sender-name {\n  max-width: 200px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: inline-flex;\n  margin-left: 8px;\n  padding-top: 5px;\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__right {\n  display: flex;\n  width: 160px;\n  justify-content: flex-end;\n}\n.sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__right .sendbird-fileviewer__header__right__actions {\n  right: 0;\n  display: flex;\n  flex-direction: row;\n}\n.sendbird-theme--light .sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__right .sendbird-fileviewer__header__right__actions__close {\n  border-left: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-fileviewer .sendbird-fileviewer__header .sendbird-fileviewer__header__right .sendbird-fileviewer__header__right__actions__close {\n  border-left: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-fileviewer .sendbird-fileviewer__content {\n  height: calc(100% - 72px);\n  margin-top: 8px;\n  overflow-y: auto;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.sendbird-fileviewer .sendbird-fileviewer__content .sendbird-fileviewer__content__video {\n  max-width: 100%;\n  max-height: 100%;\n}\n.sendbird-fileviewer .sendbird-fileviewer__content .sendbird-fileviewer__content__img {\n  max-width: 90%;\n  max-height: 90%;\n}\n.sendbird-fileviewer .sendbird-fileviewer__content .sendbird-fileviewer__content__unsupported {\n  max-width: 100%;\n  max-height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.sendbird-thread-header {\n  position: relative;\n  min-width: 320px;\n  width: 320px;\n  min-height: 64px;\n  height: 64px;\n  display: inline;\n  padding: 13px 24px;\n  box-sizing: border-box;\n}\n\n.sendbird-thread-header__title {\n  position: relative;\n  max-width: 254px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.sendbird-thread-header__channel-name {\n  position: relative;\n  max-width: 254px;\n  height: 12px;\n  display: inline-block;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.sendbird-thread-header__action {\n  position: absolute;\n  top: 0px;\n  right: 0px;\n  width: 56px;\n  height: 100%;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n.sendbird-thread-list-item .sendbird-separator {\n  margin: 4px 0px;\n}\n\n.sendbird-thread-list .sendbird-message-content__middle__sender-name {\n  white-space: nowrap;\n  max-width: 210px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.sendbird-thread-list .sendbird-message-content.incoming .sendbird-message-content__middle {\n  max-width: 200px;\n}\n\n.sendbird-thread-list .sendbird-thumbnail-message-item-body.outgoing {\n  min-width: 200px;\n  min-height: 148px;\n  height: 148px;\n}\n\n.sendbird-thread-list .sendbird-message-content .sendbird-message-content__middle {\n  max-width: 230px;\n}\n\n.sendbird-thread-list .sendbird-message-status__icon.sendbird-message-status--sent {\n  display: none;\n}\n\n.sendbird-thread-list .sendbird-mention-suggest-list {\n  width: 100%;\n  margin-left: 0px;\n  margin-right: 0px;\n}\n\n.sendbird-thread-list .sendbird-mention-suggest-list__user-item {\n  padding-left: 16px;\n  padding-right: 16px;\n}\n\n.sendbird-thread-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__nickname {\n  max-width: 134px;\n}\n\n.sendbird-thread-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__user-id {\n  max-width: 46px;\n}\n.sendbird-thread-list-item-content {\n  position: relative;\n  display: inline-flex;\n  flex-direction: row;\n  width: 100%;\n  height: 100%;\n}\n.sendbird-thread-list-item-content.incoming {\n  justify-content: flex-start;\n}\n.sendbird-thread-list-item-content.outgoing {\n  justify-content: flex-end;\n}\n.sendbird-thread-list-item-content .sendbird-thread-list-item-content__middle {\n  max-width: 200px;\n}\n.sendbird--mobile-mode .sendbird-thread-list-item-content .sendbird-thread-list-item-content__middle {\n  max-width: calc(100vw - 100px);\n}\n.sendbird-thread-list-item-content .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__quote-message.use-quote {\n  margin-top: -8px;\n  bottom: -8px;\n}\n\n.sendbird-thread-list-item-content__middle__body-container {\n  width: 100%;\n}\n\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__left {\n  position: relative;\n  display: inline-flex;\n  min-width: 40px;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__left .sendbird-thread-list-item-content__left__avatar {\n  position: absolute;\n  left: 0px;\n  bottom: 2px;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__middle {\n  position: relative;\n  display: inline-flex;\n  flex-direction: column;\n  align-items: flex-start;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__body-container .sendbird-thread-list-item-content__middle__body-container__created-at {\n  position: absolute;\n  bottom: 6px;\n  right: -84px;\n  white-space: nowrap;\n  display: flex;\n  flex-direction: row;\n  min-width: 80px;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__body-container .sendbird-thread-list-item-content__middle__body-container__created-at.sendbird-mouse-hover {\n  display: none;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__sender-name {\n  position: relative;\n  margin-left: 12px;\n  margin-bottom: 4px;\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__quote-message {\n  position: relative;\n  width: 100%;\n  display: inline-flex;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__quote-message.outgoing {\n  justify-content: flex-end;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__quote-message.incoming {\n  justify-content: flex-start;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__quote-message:hover {\n  cursor: pointer;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__right {\n  position: relative;\n  display: inline-flex;\n  width: 50px;\n  margin-left: 4px;\n  padding-top: 18px;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__right.use-reactions {\n  width: 70px;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__right.chain-top {\n  padding-top: 2px;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__right.chain-top.use-quote {\n  padding-top: 18px;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__right .sendbird-thread-list-item-content-menu {\n  position: relative;\n  flex-direction: row;\n  height: 32px;\n  display: none;\n}\n.sendbird-thread-list-item-content.incoming .sendbird-thread-list-item-content__right .sendbird-thread-list-item-content-menu.sendbird-mouse-hover {\n  display: inline-flex;\n}\n.sendbird-thread-list-item-content.incoming:hover .sendbird-thread-list-item-content__right .sendbird-thread-list-item-content-menu {\n  display: inline-flex;\n}\n.sendbird-thread-list-item-content.incoming:hover .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__body-container .sendbird-thread-list-item-content__middle__body-container__created-at {\n  display: none;\n}\n\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__left {\n  position: relative;\n  box-sizing: border-box;\n  display: inline-flex;\n  justify-content: flex-end;\n  width: 50px;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__left.use-reactions {\n  width: 70px;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__left.use-quote .sendbird-thread-list-item-content-menu {\n  top: 18px;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__left .sendbird-thread-list-item-content-menu {\n  position: absolute;\n  top: 2px;\n  right: 4px;\n  flex-direction: row;\n  display: none;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__left .sendbird-thread-list-item-content-menu.sendbird-mouse-hover {\n  display: inline-flex;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__middle {\n  position: relative;\n  display: inline-flex;\n  flex-direction: column;\n  align-items: flex-end;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__quote-message {\n  position: relative;\n  width: 100%;\n  display: inline-flex;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__quote-message.outgoing {\n  justify-content: flex-end;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__quote-message.incoming {\n  justify-content: flex-start;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__body-container {\n  position: relative;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__body-container .sendbird-thread-list-item-content__middle__body-container__created-at {\n  position: absolute;\n  bottom: 2px;\n  left: -84px;\n  white-space: nowrap;\n  display: flex;\n  justify-content: flex-end;\n  box-sizing: content-box;\n  min-width: 80px;\n  min-height: 16px;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__body-container .sendbird-thread-list-item-content__middle__body-container__created-at.sendbird-mouse-hover {\n  display: none;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__body-container .sendbird-thread-list-item-content__middle__body-container__created-at .sendbird-thread-list-item-content__middle__body-container__created-at__component-container {\n  position: relative;\n  display: inline-flex;\n}\n.sendbird-thread-list-item-content.outgoing .sendbird-thread-list-item-content__right {\n  display: none;\n}\n.sendbird-thread-list-item-content.outgoing:hover .sendbird-thread-list-item-content__left .sendbird-thread-list-item-content-menu {\n  display: inline-flex;\n}\n.sendbird-thread-list-item-content.outgoing:hover .sendbird-thread-list-item-content__middle .sendbird-thread-list-item-content__middle__body-container .sendbird-thread-list-item-content__middle__body-container__created-at {\n  display: none;\n}\n\n.sendbird-thread-list-item-content__middle__body-container {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n}\n.sendbird-thread-list-item-content__middle__body-container .sendbird-thread-list-item-content__middle__message-item-body {\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.sendbird-thread-list-item-content-reactions {\n  position: relative;\n  width: 100%;\n  max-width: 400px;\n  border-radius: 0px 0px 16px 16px;\n}\n.sendbird-theme--light .sendbird-thread-list-item-content-reactions {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-thread-list-item-content-reactions {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-thread-list-item-content-reactions.primary {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-thread-list-item-content-reactions.primary {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.sendbird-theme--light .sendbird-thread-list-item-content-reactions.mouse-hover, .sendbird-theme--light .sendbird-thread-list-item-content-reactions:hover {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-thread-list-item-content-reactions.mouse-hover, .sendbird-theme--dark .sendbird-thread-list-item-content-reactions:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-theme--light .sendbird-thread-list-item-content-reactions.mouse-hover.primary, .sendbird-theme--light .sendbird-thread-list-item-content-reactions:hover.primary {\n  background-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-thread-list-item-content-reactions.mouse-hover.primary, .sendbird-theme--dark .sendbird-thread-list-item-content-reactions:hover.primary {\n  background-color: var(--sendbird-dark-primary-300);\n}\n\n.sendbird-thread-list-item-content__middle__thread-replies {\n  margin-top: 4px;\n}\n\n.sendbird-thread-list-item-content__middle__message-item-body.sendbird-og-message-item-body,\n.sendbird-thread-list-item-content__middle__message-item-body.sendbird-thumbnail-message-item-body {\n  min-width: 200px;\n  max-width: 200px;\n}\n\n.sendbird-thread-list-item-content__middle__message-item-body.sendbird-thumbnail-message-item-body {\n  height: 148px;\n}\n\n.sendbird-thread-list-item-content__middle__message-item-body .sendbird-thumbnail-message-item-body__placeholder,\n.sendbird-thread-list-item-content__middle__message-item-body .sendbird-thumbnail-message-item-body__icon-wrapper,\n.sendbird-thread-list-item-content__middle__message-item-body .sendbird-thumbnail-message-item-body__video {\n  height: 148px;\n}\n\n.sendbird-voice-message-item-body.sendbird-thread-list-item-content__middle__message-item-body {\n  min-width: 136px;\n  height: 50px;\n}\n.sendbird-thread-message-input .sendbird-mention-suggest-list {\n  width: 100%;\n  margin-left: 0px;\n  margin-right: 0px;\n}\n\n.sendbird-thread-message-input .sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item {\n  padding-left: 16px;\n  padding-right: 16px;\n}\n\n.sendbird-thread-message-input .sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__nickname {\n  max-width: 134px;\n}\n\n.sendbird-thread-message-input .sendbird-mention-suggest-list .sendbird-mention-suggest-list__user-item .sendbird-mention-suggest-list__user-item__user-id {\n  max-width: 46px;\n}\n\n.sendbird-theme--light .sendbird-thread-message-input--voice-message {\n  border-top: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-thread-message-input--voice-message {\n  border-top: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sb_mobile {\n  height: 100%;\n}\n\n.sb_mobile__panelwrap {\n  height: 100%;\n}\n\n.sb-show-main {\n  padding: 0 !important;\n}\n\n.sb_mobile__panelwrap .sendbird-thread {\n  width: 100%;\n  height: 100%;\n}\n.sb_mobile__panelwrap .sendbird-thread .sendbird-thread-ui {\n  max-width: 100%;\n}\n.sb_mobile__panelwrap .sendbird-thread .sendbird-thread-ui .sendbird-thread-ui__header {\n  width: 100%;\n}\n.sendbird-app__wrap {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  box-sizing: border-box;\n}\n.sendbird-app__wrap .sendbird-app__searchpanel-wrap {\n  width: 320px;\n  min-width: 320px;\n  overflow-x: hidden;\n  overflow-y: scroll;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-app__wrap .sendbird-app__searchpanel-wrap {\n  border-top: 1px solid var(--sendbird-light-onlight-04);\n  border-right: 1px solid var(--sendbird-light-onlight-04);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-app__wrap .sendbird-app__searchpanel-wrap {\n  border-top: 1px solid var(--sendbird-dark-background-600);\n  border-right: 1px solid var(--sendbird-dark-background-600);\n  border-bottom: 1px solid var(--sendbird-dark-background-600);\n}\n.sendbird-app__wrap .sendbird-app__conversation-wrap {\n  flex: 1;\n  position: relative;\n  width: calc(100% - 320px);\n}\n.sendbird-app__wrap .sendbird-app__channellist-wrap {\n  max-width: 320px;\n}\n.sendbird-theme--light .sendbird-app__wrap .sendbird-app__channellist-wrap {\n  border-top: 1px solid var(--sendbird-light-onlight-04);\n  border-left: 1px solid var(--sendbird-light-onlight-04);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-app__wrap .sendbird-app__channellist-wrap {\n  border-top: 1px solid var(--sendbird-dark-background-600);\n  border-left: 1px solid var(--sendbird-dark-background-600);\n  border-bottom: 1px solid var(--sendbird-dark-background-600);\n}\n.sendbird-theme--light .sendbird-app__wrap .sendbird-app__conversation--settings-open .sendbird-chat-header__info {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-app__wrap .sendbird-app__conversation--settings-open .sendbird-chat-header__info {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-app__wrap .sendbird-chat-header__search {\n  margin-right: 16px;\n}\n.sendbird-theme--light .sendbird-app__wrap .sendbird-app__conversation--search-open .sendbird-chat-header__search {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-app__wrap .sendbird-app__conversation--search-open .sendbird-chat-header__search {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-app__wrap .sendbird-channel-settings {\n  border-left: none;\n}\n.sendbird-theme--light .sendbird-app__wrap .sendbird-channel-settings {\n  border-top: 1px solid var(--sendbird-light-onlight-04);\n  border-right: 1px solid var(--sendbird-light-onlight-04);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-app__wrap .sendbird-channel-settings {\n  border-top: 1px solid var(--sendbird-dark-background-600);\n  border-right: 1px solid var(--sendbird-dark-background-600);\n  border-bottom: 1px solid var(--sendbird-dark-background-600);\n}\n.sendbird-app__wrap .sendbird-channel-settings .sendbird-channel-settings__header {\n  height: 64px;\n}\n.sendbird-openchannel-conversation {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n}\n.sendbird-theme--light .sendbird-openchannel-conversation {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-openchannel-conversation {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-openchannel-conversation .sendbird-openchannel-conversation-scroll {\n  overflow-y: auto;\n  flex: 1 1 0;\n  order: 2;\n  width: 100%;\n}\n.sendbird-openchannel-conversation .sendbird-openchannel-footer {\n  order: 3;\n  padding: 12px 24px 24px 24px;\n}\n.sendbird-openchannel-conversation .sendbird-openchannel-conversation-scroll-container {\n  display: flex;\n  height: 100%;\n  overflow-y: auto;\n  overflow-x: hidden;\n  flex-direction: column;\n}\n.sendbird-openchannel-conversation .sendbird-openchannel-conversation-scroll-container .sendbird-openchannel-conversation-scroll-padding {\n  flex: 1 1 0;\n}\n.sendbird-frozen-channel-notification {\n  position: relative;\n  margin-top: 8px;\n  margin-right: 24px;\n  margin-left: 24px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 4px;\n}\n.sendbird-theme--light .sendbird-frozen-channel-notification {\n  background-color: var(--sendbird-light-information-100);\n}\n.sendbird-theme--dark .sendbird-frozen-channel-notification {\n  background-color: var(--sendbird-dark-information-100);\n}\n.sendbird-oepnchannel-header__icon_back {\n  position: absolute;\n  left: 12px;\n  top: 18px;\n}\n\n.sendbird-openchannel-conversation-header {\n  position: relative;\n  min-height: 64px;\n  box-sizing: border-box;\n}\n.sendbird-theme--light .sendbird-openchannel-conversation-header {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-openchannel-conversation-header {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-openchannel-conversation-header .sendbird-openchannel-conversation-header__left__title {\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  max-width: calc(100% - 120px);\n}\n.sendbird--mobile-mode .sendbird-openchannel-conversation-header .sendbird-openchannel-conversation-header__left__title {\n  max-width: calc(100% - 160px);\n}\n.sendbird-openchannel-conversation-header__left [class*=sendbird-openchannel-conversation-header__left__cover-image] {\n  position: absolute;\n  left: 20px;\n  top: 16px;\n}\n.sendbird--mobile-mode .sendbird-openchannel-conversation-header__left [class*=sendbird-openchannel-conversation-header__left__cover-image] {\n  left: 50px;\n}\n.sendbird-openchannel-conversation-header__left__title {\n  position: absolute;\n  left: 60px;\n  top: 12px;\n}\n.sendbird--mobile-mode .sendbird-openchannel-conversation-header__left__title {\n  left: 90px;\n}\n.sendbird-openchannel-conversation-header__left__sub-title {\n  position: absolute;\n  left: 60px;\n  top: 36px;\n}\n.sendbird--mobile-mode .sendbird-openchannel-conversation-header__left__sub-title {\n  left: 90px;\n}\n.sendbird-openchannel-conversation-header__right {\n  position: absolute;\n  top: 0px;\n  right: 0px;\n  width: 64px;\n  height: 64px;\n}\n.sendbird-openchannel-conversation-header__right__trigger {\n  position: absolute;\n  top: 16px;\n  right: 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.sendbird-openchannel-conversation-header__left__cover-image--icon {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 50%;\n}\n.sendbird-theme--light .sendbird-openchannel-conversation-header__left__cover-image--icon {\n  background-color: var(--sendbird-light-background-300);\n}\n.sendbird-theme--dark .sendbird-openchannel-conversation-header__left__cover-image--icon {\n  background-color: var(--sendbird-dark-background-300);\n}\n.sendbird-openchannel-conversation-scroll {\n  position: relative;\n  width: 100%;\n}\n.sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container {\n  position: sticky;\n  width: 100%;\n  bottom: 0px;\n  height: 100%;\n  overflow: hidden;\n}\n.sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container .sendbird-openchannel-conversation-scroll__container__padding {\n  height: 8px;\n}\n.sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container .sendbird-openchannel-conversation-scroll__container__item-container {\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n}\n.sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container .sendbird-openchannel-conversation-scroll__container__item-container.no-messages {\n  width: 100%;\n  height: 100%;\n}\n.sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container .sendbird-openchannel-conversation-scroll__container__item-container.no-messages .sendbird-openchannel-conversation-scroll__container__place-holder {\n  width: 100%;\n  height: 100%;\n}\n.sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container__scroll-bottom-button {\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  bottom: 8px;\n  left: calc(50% - 20px);\n  width: 40px;\n  height: 40px;\n  border-radius: 24px;\n  z-index: 1;\n}\n.sendbird-theme--light .sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container__scroll-bottom-button {\n  background-color: var(--sendbird-light-primary-300);\n  box-shadow: var(--sendbird-light-shadow-05);\n}\n.sendbird-theme--dark .sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container__scroll-bottom-button {\n  background-color: var(--sendbird-dark-primary-200);\n  box-shadow: var(--sendbird-dark-shadow-05);\n}\n.sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container__scroll-bottom-button:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container__scroll-bottom-button:hover {\n  background-color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container__scroll-bottom-button:hover {\n  background-color: var(--sendbird-dark-primary-300);\n}\n.sendbird-theme--light .sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container__scroll-bottom-button:active {\n  background-color: var(--sendbird-light-primary-500);\n}\n.sendbird-theme--dark .sendbird-openchannel-conversation-scroll .sendbird-openchannel-conversation-scroll__container__scroll-bottom-button:active {\n  background-color: var(--sendbird-dark-primary-400);\n}\n.sendbird-openchannel-user-message {\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n}\n.sendbird-theme--light .sendbird-openchannel-user-message:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-user-message:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-openchannel-user-message:hover .sendbird-openchannel-user-message__context-menu {\n  display: block;\n}\n.sendbird-openchannel-user-message .sendbird-openchannel-user-message__left {\n  position: relative;\n  display: flex;\n  width: 52px;\n  min-width: 52px;\n}\n.sendbird-openchannel-user-message .sendbird-openchannel-user-message__left .sendbird-openchannel-user-message__left__avatar {\n  position: relative;\n  display: flex;\n  margin-top: 8px;\n  margin-left: 24px;\n}\n.sendbird-openchannel-user-message .sendbird-openchannel-user-message__right {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  margin: 8px 24px 8px 12px;\n}\n.sendbird-openchannel-user-message .sendbird-openchannel-user-message__right .sendbird-openchannel-user-message__right__top {\n  position: relative;\n  display: flex;\n  margin-bottom: 2px;\n}\n.sendbird-openchannel-user-message .sendbird-openchannel-user-message__right .sendbird-openchannel-user-message__right__top .sendbird-openchannel-user-message__right__top__sender-name {\n  position: relative;\n  display: flex;\n}\n.sendbird-openchannel-user-message .sendbird-openchannel-user-message__right .sendbird-openchannel-user-message__right__top .sendbird-openchannel-user-message__right__top__sent-at {\n  position: relative;\n  display: flex;\n  margin-left: 4px;\n}\n.sendbird-openchannel-user-message .sendbird-openchannel-user-message__right .sendbird-openchannel-user-message__right__bottom {\n  position: relative;\n  display: flex;\n  width: 100%;\n}\n.sendbird-openchannel-user-message .sendbird-openchannel-user-message__right .sendbird-openchannel-user-message__right__bottom .sendbird-openchannel-user-message__right__bottom__message {\n  position: relative;\n  word-break: break-all;\n  white-space: pre-line;\n}\n.sendbird-openchannel-user-message .sendbird-openchannel-user-message__right .sendbird-openchannel-user-message__right__tail {\n  position: relative;\n  top: 2px;\n}\n.sendbird-openchannel-user-message .sendbird-openchannel-user-message__context-menu {\n  position: absolute;\n  right: 16px;\n  display: none;\n}\n.sendbird-theme--light .sendbird-openchannel-user-message .sendbird-openchannel-user-message__context-menu .sendbird-openchannel-user-message__context-menu--icon {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-openchannel-user-message .sendbird-openchannel-user-message__context-menu .sendbird-openchannel-user-message__context-menu--icon {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-openchannel-user-message .sendbird-openchannel-user-message__context-menu .sendbird-openchannel-user-message__context-menu--icon:hover {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-user-message .sendbird-openchannel-user-message__context-menu .sendbird-openchannel-user-message__context-menu--icon:hover {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-openchannel__mobile-menu-hyperlink {\n  display: block;\n  width: 100%;\n  text-decoration: none;\n  color: inherit;\n  font-size: inherit;\n  font-weight: inherit;\n  font-stretch: normal;\n  font-style: normal;\n  line-height: inherit;\n  letter-spacing: inherit;\n  font-family: inherit;\n}\n.sendbird-openchannel-admin-message {\n  position: relative;\n  margin: 16px 24px;\n  padding: 12px 16px;\n  border-radius: 4px;\n}\n.sendbird-theme--light .sendbird-openchannel-admin-message {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-admin-message {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-openchannel-admin-message:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-admin-message:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-openchannel-admin-message .sendbird-openchannel-admin-message__text {\n  word-wrap: break-word;\n}\n.sendbird-openchannel-og-message {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n}\n.sendbird-theme--light .sendbird-openchannel-og-message:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-og-message:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-openchannel-og-message:hover .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__context-menu {\n  display: block;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__top {\n  box-sizing: border-box;\n  position: relative;\n  display: flex;\n  flex-direction: row;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__left {\n  position: relative;\n  display: flex;\n  width: 52px;\n  min-width: 52px;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__left .sendbird-openchannel-og-message__top__left__avatar {\n  position: absolute;\n  display: flex;\n  top: 8px;\n  left: 24px;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__right {\n  position: relative;\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: column;\n  margin: 8px 24px 8px 12px;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__right .sendbird-openchannel-og-message__top__right__title {\n  position: relative;\n  display: flex;\n  margin-bottom: 2px;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__right .sendbird-openchannel-og-message__top__right__title .sendbird-openchannel-og-message__top__right__title__sender-name {\n  position: relative;\n  display: flex;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__right .sendbird-openchannel-og-message__top__right__title .sendbird-openchannel-og-message__top__right__title__sent-at {\n  position: relative;\n  display: flex;\n  margin-left: 4px;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__right .sendbird-openchannel-og-message__top__right__description .sendbird-openchannel-og-message__top__right__description__message {\n  position: relative;\n  display: inline;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n.sendbird-theme--light .sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__right .sendbird-openchannel-og-message__top__right__description .sendbird-openchannel-og-message__top__right__description__message .sendbird-word .sendbird-word__url {\n  color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__right .sendbird-openchannel-og-message__top__right__description .sendbird-openchannel-og-message__top__right__description__message .sendbird-word .sendbird-word__url {\n  color: var(--sendbird-dark-primary-200);\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__context-menu {\n  position: absolute;\n  right: 16px;\n  display: none;\n}\n.sendbird-theme--light .sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__context-menu .sendbird-openchannel-og-message__top__context-menu--icon {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__context-menu .sendbird-openchannel-og-message__top__context-menu--icon {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__context-menu .sendbird-openchannel-og-message__top__context-menu--icon:hover {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-og-message .sendbird-openchannel-og-message__top .sendbird-openchannel-og-message__top__context-menu .sendbird-openchannel-og-message__top__context-menu--icon:hover {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom {\n  position: relative;\n  display: inline;\n  margin-bottom: 8px;\n  width: 100%;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n  width: calc(100% - 64px);\n  max-width: 360px;\n  left: 64px;\n  padding: 12px 12px 4px 12px;\n  border-radius: 8px;\n}\n.sendbird-theme--light .sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag {\n  border: solid 1px var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag {\n  border: solid 1px var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag .sendbird-openchannel-og-message__bottom__og-tag__url {\n  position: relative;\n  display: block;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-bottom: 8px;\n  max-width: 336px;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag .sendbird-openchannel-og-message__bottom__og-tag__title {\n  position: relative;\n  display: inline-block;\n  white-space: pre-wrap;\n  overflow-wrap: normal;\n  margin-bottom: 8px;\n  max-width: 336px;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag .sendbird-openchannel-og-message__bottom__og-tag__title:hover {\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag .sendbird-openchannel-og-message__bottom__og-tag__title:hover {\n  color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag .sendbird-openchannel-og-message__bottom__og-tag__title:hover {\n  color: var(--sendbird-dark-primary-200);\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag .sendbird-openchannel-og-message__bottom__og-tag__description {\n  position: relative;\n  display: block;\n  white-space: pre-wrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  word-break: break-all;\n  max-height: 32px;\n  margin-bottom: 8px;\n  width: 100%;\n  max-width: 336px;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag .sendbird-openchannel-og-message__bottom__og-tag__thumbnail {\n  box-sizing: border-box;\n  position: relative;\n  display: block;\n  margin-top: 4px;\n  margin-bottom: 8px;\n  width: 100%;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag .sendbird-openchannel-og-message__bottom__og-tag__thumbnail:hover {\n  cursor: pointer;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag .sendbird-openchannel-og-message__bottom__og-tag__thumbnail .sendbird-openchannel-og-message__bottom__og-tag__thumbnail__image {\n  border-radius: 8px;\n  width: 100%;\n  min-width: 200px;\n  max-width: 336px;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__bottom .sendbird-openchannel-og-message__bottom__og-tag .sendbird-openchannel-og-message__bottom__og-tag__thumbnail .sendbird-openchannel-og-message__bottom__og-tag__thumbnail__image--placeholder {\n  border-radius: 8px;\n  width: 100%;\n  min-width: 200px;\n  max-width: 336px;\n}\n.sendbird-openchannel-og-message .sendbird-openchannel-og-message__top__right__tail {\n  position: relative;\n  left: 64px;\n  top: 2px;\n}\n\n.sendbird-openchannel-og-message--word {\n  display: inline;\n  margin: 0px 2px;\n  word-break: break-all;\n}\n.sendbird-openchannel-thumbnail-message {\n  position: relative;\n  display: flex;\n  flex-direction: row;\n}\n.sendbird-theme--light .sendbird-openchannel-thumbnail-message:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-thumbnail-message:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-openchannel-thumbnail-message:hover .sendbird-openchannel-thumbnail-message__context-menu {\n  display: block;\n}\n.sendbird-theme--light .sendbird-openchannel-thumbnail-message:hover .sendbird-openchannel-thumbnail-message__context-menu .sendbird-openchannel-thumbnail-message__context-menu--icon {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-openchannel-thumbnail-message:hover .sendbird-openchannel-thumbnail-message__context-menu .sendbird-openchannel-thumbnail-message__context-menu--icon {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-openchannel-thumbnail-message:hover .sendbird-openchannel-thumbnail-message__context-menu .sendbird-openchannel-thumbnail-message__context-menu--icon:hover {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-thumbnail-message:hover .sendbird-openchannel-thumbnail-message__context-menu .sendbird-openchannel-thumbnail-message__context-menu--icon:hover {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__left {\n  position: relative;\n  display: flex;\n  width: 52px;\n  min-width: 52px;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__left .sendbird-openchannel-thumbnail-message__left__avatar {\n  position: absolute;\n  display: inline;\n  margin-top: 8px;\n  margin-left: 28px;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  margin-top: 8px;\n  margin-bottom: 8px;\n  margin-left: 12px;\n  width: calc(100% - 64px);\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__title {\n  position: relative;\n  display: inline;\n  margin-bottom: 4px;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__title .sendbird-openchannel-thumbnail-message__right__title__sender-name {\n  position: relative;\n  display: inline;\n  margin-right: 4px;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__title .sendbird-openchannel-thumbnail-message__right__title__sent-at {\n  position: relative;\n  display: inline;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body {\n  position: relative;\n  display: flex;\n  border-radius: 8px;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body:hover .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__overlay {\n  opacity: 1;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap {\n  position: relative;\n  box-sizing: content-box;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__overlay {\n  position: absolute;\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  max-width: 360px;\n  top: 0px;\n  left: 0px;\n  border-radius: 8px;\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__overlay {\n  background-color: var(--sendbird-light-overlay-02);\n}\n.sendbird-theme--dark .sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__overlay {\n  background-color: var(--sendbird-dark-overlay-02);\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__video {\n  max-width: 360px;\n  max-height: 360px;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__video:hover {\n  cursor: pointer;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__video .sendbird-openchannel-thumbnail-message__right__body__wrap__video__video {\n  max-width: 360px;\n  max-height: 360px;\n  border-radius: 8px;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__video .sendbird-openchannel-thumbnail-message__right__body__wrap__video__icon {\n  position: absolute;\n  top: calc(50% - 28px);\n  left: calc(50% - 28px);\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__video--icon {\n  padding: 107px 152px 107px 152px;\n  border-radius: 8px;\n}\n.sendbird-theme--light .sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__video--icon {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__video--icon {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__image {\n  border-radius: 8px;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__image--icon {\n  padding: 107px 152px 107px 152px;\n  border-radius: 8px;\n}\n.sendbird-theme--light .sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__image--icon {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__image--icon {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__unknown {\n  padding: 107px 152px 107px 152px;\n  border-radius: 8px;\n}\n.sendbird-theme--light .sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__unknown {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__body .sendbird-openchannel-thumbnail-message__right__body__wrap .sendbird-openchannel-thumbnail-message__right__body__wrap__unknown {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__right .sendbird-openchannel-thumbnail-message__right__tail {\n  position: relative;\n  top: 2px;\n}\n.sendbird-openchannel-thumbnail-message .sendbird-openchannel-thumbnail-message__context-menu {\n  position: absolute;\n  display: none;\n  top: 8px;\n  right: 16px;\n}\n.sendbird-openchannel-file-message {\n  position: relative;\n  display: flex;\n  flex-direction: row;\n}\n.sendbird-theme--light .sendbird-openchannel-file-message:hover {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-file-message:hover {\n  background-color: var(--sendbird-dark-background-400);\n}\n.sendbird-openchannel-file-message:hover .sendbird-openchannel-file-message__context-menu {\n  display: block;\n}\n.sendbird-openchannel-file-message .sendbird-openchannel-file-message__left {\n  position: relative;\n  display: flex;\n  width: 52px;\n  min-width: 52px;\n}\n.sendbird-openchannel-file-message .sendbird-openchannel-file-message__left .sendbird-openchannel-file-message__left__avatar {\n  position: absolute;\n  display: block;\n  margin-top: 8px;\n  margin-left: 24px;\n}\n.sendbird-openchannel-file-message .sendbird-openchannel-file-message__right {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  margin-left: 12px;\n  margin-bottom: 4px;\n  width: calc(100% - 64px);\n}\n.sendbird-openchannel-file-message .sendbird-openchannel-file-message__right .sendbird-openchannel-file-message__right__title {\n  position: relative;\n  display: flex;\n  margin-top: 8px;\n}\n.sendbird-openchannel-file-message .sendbird-openchannel-file-message__right .sendbird-openchannel-file-message__right__title .sendbird-openchannel-file-message__right__title__sender-name {\n  position: relative;\n  display: flex;\n}\n.sendbird-openchannel-file-message .sendbird-openchannel-file-message__right .sendbird-openchannel-file-message__right__title .sendbird-openchannel-file-message__right__title__sent-at {\n  position: relative;\n  display: flex;\n  margin-left: 4px;\n}\n.sendbird-openchannel-file-message .sendbird-openchannel-file-message__right .sendbird-openchannel-file-message__right__body {\n  position: relative;\n  display: flex;\n  margin-top: 4px;\n  margin-bottom: 4px;\n  border-radius: 8px;\n}\n.sendbird-theme--light .sendbird-openchannel-file-message .sendbird-openchannel-file-message__right .sendbird-openchannel-file-message__right__body {\n  background-color: var(--sendbird-light-background-100);\n  border: solid 1px var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-openchannel-file-message .sendbird-openchannel-file-message__right .sendbird-openchannel-file-message__right__body {\n  background-color: var(--sendbird-dark-background-500);\n  border: solid 1px var(--sendbird-dark-ondark-04);\n}\n.sendbird-openchannel-file-message .sendbird-openchannel-file-message__right .sendbird-openchannel-file-message__right__body .sendbird-openchannel-file-message__right__body__icon {\n  position: relative;\n  display: inline-block;\n  margin: 8px;\n  border-radius: 8.6px;\n}\n.sendbird-theme--light .sendbird-openchannel-file-message .sendbird-openchannel-file-message__right .sendbird-openchannel-file-message__right__body .sendbird-openchannel-file-message__right__body__icon {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-openchannel-file-message .sendbird-openchannel-file-message__right .sendbird-openchannel-file-message__right__body .sendbird-openchannel-file-message__right__body__icon {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-openchannel-file-message .sendbird-openchannel-file-message__right .sendbird-openchannel-file-message__right__body .sendbird-openchannel-file-message__right__body__file-name {\n  position: relative;\n  display: flex;\n  margin-top: 22px;\n  margin-right: 16px;\n  margin-left: 4px;\n  overflow: hidden;\n  height: 20px;\n  max-height: 20px;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.sendbird-openchannel-file-message .sendbird-openchannel-file-message__context-menu {\n  position: absolute;\n  display: none;\n  top: 8px;\n  right: 16px;\n}\n.sendbird-theme--light .sendbird-openchannel-file-message .sendbird-openchannel-file-message__context-menu .sendbird-openchannel-file-message__context-menu__icon {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .sendbird-openchannel-file-message .sendbird-openchannel-file-message__context-menu .sendbird-openchannel-file-message__context-menu__icon {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbird-theme--light .sendbird-openchannel-file-message .sendbird-openchannel-file-message__context-menu .sendbird-openchannel-file-message__context-menu__icon:hover {\n  background-color: var(--sendbird-light-primary-100);\n}\n.sendbird-theme--dark .sendbird-openchannel-file-message .sendbird-openchannel-file-message__context-menu .sendbird-openchannel-file-message__context-menu__icon:hover {\n  background-color: var(--sendbird-dark-background-700);\n}\n.sendbird-openchannel-settings {\n  height: 100%;\n  width: 320px;\n  display: inline-block;\n  overflow-y: scroll;\n  position: relative;\n}\n.sendbird--mobile-mode .sendbird-openchannel-settings {\n  width: 100%;\n}\n.sendbird-theme--light .sendbird-openchannel-settings {\n  background-color: var(--sendbird-light-background-50);\n  border-left: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-openchannel-settings {\n  background-color: var(--sendbird-dark-background-600);\n  border-left: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-openchannel-settings .sendbird-participants-accordion__footer {\n  text-align: left;\n  padding-top: 16px;\n  padding-left: 16px;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__operator-accordion-icon {\n  position: absolute;\n  left: 14px;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__accordion-icon,\n.sendbird-openchannel-settings .sendbird-openchannel-settings__panel-icon__delete {\n  position: absolute;\n  left: 16px;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__participant {\n  height: 100%;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__participant .sendbird-openchannel-settings__participant-list {\n  padding-top: 64px;\n  height: calc(100% - 64px);\n  overflow-y: scroll;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__participant .sendbird-openchannel-settings__header {\n  display: block;\n  width: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n.sendbird-theme--light .sendbird-openchannel-settings .sendbird-openchannel-settings__participant .sendbird-openchannel-settings__header {\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-openchannel-settings .sendbird-openchannel-settings__participant .sendbird-openchannel-settings__header {\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-openchannel-settings .sendbird-participants-accordion,\n.sendbird-openchannel-settings .sendbird-openchannel-settings__delete-channel {\n  text-align: left;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__members .sendbird-badge__text {\n  margin-top: -2px;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__header {\n  height: 64px;\n  min-height: 64px;\n  position: relative;\n  padding: 20px 24px;\n  box-sizing: border-box;\n  text-align: left;\n}\n.sendbird-theme--light .sendbird-openchannel-settings .sendbird-openchannel-settings__header {\n  border-bottom: solid 1px var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-openchannel-settings .sendbird-openchannel-settings__header {\n  border-bottom: solid 1px var(--sendbird-dark-ondark-04);\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__close-icon {\n  cursor: pointer;\n  position: absolute;\n  top: 20px;\n  right: 16px;\n}\n.sendbird-theme--light .sendbird-openchannel-settings .sendbird-openchannel-settings__close-icon path {\n  fill: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-openchannel-settings .sendbird-openchannel-settings__close-icon path {\n  fill: var(--sendbird-dark-ondark-01);\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__placeholder {\n  margin-top: 40%;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__url {\n  padding: 16px;\n  box-sizing: border-box;\n  position: relative;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__url:hover .sendbird-openchannel-settings__copy-icon {\n  display: inline-block;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__url .sendbird-openchannel-settings__copy-icon {\n  cursor: pointer;\n  position: absolute;\n  display: none;\n  top: 10px;\n  right: 18px;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__url .sendbird-openchannel-settings__url-value {\n  margin-top: 8px;\n}\n.sendbird-theme--light .sendbird-openchannel-settings .sendbird-openchannel-settings__url .sendbird-openchannel-settings__url-value {\n  color: var(--sendbird-light-onlight-01);\n}\n.sendbird-theme--dark .sendbird-openchannel-settings .sendbird-openchannel-settings__url .sendbird-openchannel-settings__url-value {\n  color: var(--sendbird-dark-ondark-01);\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__url .sendbird-openchannel-settings__url-value,\n.sendbird-openchannel-settings .sendbird-openchannel-settings__url .sendbird-openchannel-settings__url-label {\n  text-align: left;\n  display: block;\n  word-wrap: break-word;\n}\n.sendbird-theme--light .sendbird-openchannel-settings .sendbird-openchannel-settings__url {\n  background-color: var(--sendbird-light-background-50);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-openchannel-settings .sendbird-openchannel-settings__url {\n  background-color: var(--sendbird-dark-background-600);\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__panel-item {\n  display: block;\n  cursor: pointer;\n  box-sizing: border-box;\n  position: relative;\n  padding: 12px 22px 10px 56px;\n}\n.sendbird-theme--light .sendbird-openchannel-settings .sendbird-openchannel-settings__panel-item {\n  background-color: var(--sendbird-light-background-50);\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.sendbird-theme--dark .sendbird-openchannel-settings .sendbird-openchannel-settings__panel-item {\n  background-color: var(--sendbird-dark-background-600);\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__panel-item:focus {\n  outline: none;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-settings__panel-item.sendbird-channel-settings__panel-item__disabled {\n  cursor: not-allowed;\n}\n.sendbird-openchannel-settings .sendbird-participants-accordion__member {\n  position: relative;\n  padding: 12px 0px 12px 56px;\n  width: 100%;\n  height: 40px;\n  box-sizing: border-box;\n  text-align: left;\n}\n.sendbird-openchannel-settings .sendbird-participants-accordion__member .sendbird-label {\n  max-width: 190px;\n  display: inline-block;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sendbird-openchannel-settings .sendbird-participants-accordion__member .sendbird-participants-accordion__member__title.self-operator,\n.sendbird-openchannel-settings .sendbird-participants-accordion__member .sendbird-participants-accordion__member__title.operator,\n.sendbird-openchannel-settings .sendbird-participants-accordion__member .sendbird-participants-accordion__member__title.user-id {\n  position: absolute;\n  right: 16px;\n}\n.sendbird-openchannel-settings .sendbird-participants-accordion__member .sendbird-participants-accordion__member__action {\n  display: none;\n}\n.sendbird-openchannel-settings .sendbird-participants-accordion__member:hover .sendbird-participants-accordion__member__title.operator,\n.sendbird-openchannel-settings .sendbird-participants-accordion__member:hover .sendbird-participants-accordion__member__title.user-id {\n  display: none;\n}\n.sendbird-openchannel-settings .sendbird-participants-accordion__member:hover .sendbird-participants-accordion__member__action {\n  display: inline-block;\n}\n.sendbird-openchannel-settings .sendbird-participants-accordion__member-avatar {\n  position: absolute;\n  left: 16px;\n  top: 10px;\n  cursor: pointer;\n}\n.sendbird-openchannel-settings .sendbird-participants-accordion__member__action {\n  position: absolute;\n  display: none;\n  top: 4px;\n  right: 8px;\n  cursor: pointer;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-operator-list__footer,\n.sendbird-openchannel-settings .sendbird-openchannel-participant-list__footer,\n.sendbird-openchannel-settings .sendbird-channel-settings-muted-participant-list__footer,\n.sendbird-openchannel-settings .sendbird-channel-settings-banned-user-list__footer {\n  padding-top: 16px;\n  display: flex;\n  justify-content: left;\n  padding-left: 12px;\n}\n.sendbird-openchannel-settings .sendbird-openchannel-operator-list__footer .sendbird-button:nth-child(2),\n.sendbird-openchannel-settings .sendbird-openchannel-participant-list__footer .sendbird-button:nth-child(2),\n.sendbird-openchannel-settings .sendbird-channel-settings-muted-participant-list__footer .sendbird-button:nth-child(2),\n.sendbird-openchannel-settings .sendbird-channel-settings-banned-user-list__footer .sendbird-button:nth-child(2) {\n  margin-left: 8px;\n}\n\n.sendbird-participants-accordion__member-avatar__avatar {\n  position: absolute;\n}\n\n.sendbird-more-users__popup-scroll {\n  max-height: 420px;\n  overflow: scroll;\n}\n.sendbird-openchannel-profile {\n  position: relative;\n  text-align: center;\n  padding: 32px 40px 27px 40px;\n}\n.sendbird-theme--light .sendbird-openchannel-profile {\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-50);\n}\n.sendbird-theme--dark .sendbird-openchannel-profile {\n  border-bottom: 1px solid var(--sendbird-dark-ondark-04);\n  background-color: var(--sendbird-dark-background-600);\n}\n.sendbird-openchannel-profile .sendbird-openchannel-profile--inner {\n  height: 116px;\n}\n.sendbird-openchannel-profile .sendbird-openchannel-profile__avatar {\n  margin-bottom: 16px;\n  text-align: center;\n}\n.sendbird-openchannel-profile .sendbird-openchannel-profile__title {\n  display: inline-block;\n  max-width: 240px;\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  height: 18px;\n}\n.sendbird-openchannel-profile .sendbird-openchannel-profile__edit {\n  position: absolute;\n  top: 10px;\n  right: 16px;\n}";
styleInject(css_248z$f);

var init = function (_a) {
    var userId = _a.userId, appId = _a.appId, accessToken = _a.accessToken, chatInstance = _a.chatInstance;
    return __awaiter$2(void 0, void 0, void 0, function () {
        var e_1;
        return __generator(this, function (_b) {
            switch (_b.label) {
                case 0:
                    _b.trys.push([0, 2, , 3]);
                    sendbirdLive_min.exports.SendbirdLive.init({
                        appId: appId,
                        chatInstance: chatInstance,
                    });
                    return [4 /*yield*/, sendbirdLive_min.exports.SendbirdLive.authenticate(userId, accessToken)];
                case 1:
                    _b.sent();
                    return [3 /*break*/, 3];
                case 2:
                    e_1 = _b.sent();
                    console.error(e_1);
                    return [3 /*break*/, 3];
                case 3: return [2 /*return*/];
            }
        });
    });
};

var PubSub = /** @class */ (function () {
    function PubSub() {
        this._topics = {};
        this._topics = {};
    }
    PubSub.prototype.subscribe = function (topic, listener) {
        var _this = this;
        if (!this._topics[topic])
            this._topics[topic] = [];
        var index = this._topics[topic].push(listener) - 1;
        return {
            remove: function () {
                delete _this._topics[topic][index];
            }
        };
    };
    PubSub.prototype.publish = function (topic) {
        var info = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            info[_i - 1] = arguments[_i];
        }
        // If the topic doesn't exist, or there's no listeners in queue, just leave
        if (!this._topics[topic])
            return;
        // Cycle through topics queue, fire!
        this._topics[topic].forEach(function (handler) {
            handler.apply(void 0, info);
        });
    };
    return PubSub;
}());

// @ts-ignore
var SendbirdLiveContext = React__default__default.createContext({});

function SendbirdLiveInternal(props) {
    var _this = this;
    var _a, _b, _c, _d;
    var userId = props.userId, appId = props.appId, accessToken = props.accessToken, customApiHost = props.customApiHost, customWebSocketHost = props.customWebSocketHost, children = props.children, theme = props.theme, colorSet = props.colorSet, stringSet = props.stringSet, imageSet = props.imageSet, fontSet = props.fontSet;
    var _e = useState(false), initialized = _e[0], setInitialized = _e[1];
    var _f = useState(), pubSub = _f[0], setPubSub = _f[1];
    var globalStore = useSendbirdStateContext();
    var sdk = (_b = (_a = globalStore === null || globalStore === void 0 ? void 0 : globalStore.stores) === null || _a === void 0 ? void 0 : _a.sdkStore) === null || _b === void 0 ? void 0 : _b.sdk;
    var sdkInit = (_d = (_c = globalStore === null || globalStore === void 0 ? void 0 : globalStore.stores) === null || _c === void 0 ? void 0 : _c.sdkStore) === null || _d === void 0 ? void 0 : _d.initialized;
    useEffect(function () {
        // init
        var doInit = function () { return __awaiter$2(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!sdkInit)
                            return [2 /*return*/];
                        return [4 /*yield*/, init({
                                userId: userId,
                                appId: appId,
                                accessToken: accessToken,
                                chatInstance: sdk,
                            })];
                    case 1:
                        _a.sent();
                        setPubSub(new PubSub());
                        setInitialized(true);
                        return [2 /*return*/];
                }
            });
        }); };
        doInit();
    }, [userId, appId, accessToken, sdkInit]);
    return (React__default__default.createElement(SendbirdLiveContext.Provider, { value: {
            userId: userId,
            appId: appId,
            accessToken: accessToken,
            customApiHost: customApiHost,
            customWebSocketHost: customWebSocketHost,
            children: children,
            theme: theme,
            colorSet: colorSet,
            stringSet: stringSet,
            imageSet: imageSet,
            fontSet: fontSet,
            pubSub: pubSub,
        } }, !initialized
        ? React__default__default.createElement("div", null)
        : children));
}

var getStringSet = function () {
    return {
        LIST_HEADER_TITLE: 'Live events',
        LIST_HEADER_BUTTON: 'Create',
        LIST_EMPTY_DESCRIPTION: 'No live events',
        NO_LIVE_EVENT_TITLE: 'No live events selected',
        NO_LIVE_EVENT_DESCRIPTION: 'Select a live event from the list or create a live event',
        EVENT_STATUS_CREATED: 'UPCOMING',
        EVENT_STATUS_READY: 'OPEN',
        EVENT_STATUS_ONGOING: 'LIVE',
        EVENT_STATUS_ENDED: 'ENDED',
        PARTICIPANT_COUNT: function (participantCount) { return "".concat(participantCount, "K"); },
        LIST_HOST_NICKNAME_PLACEHOLDER: 'â',
        LIVE_EVENT_ENTER_ROLE_DIALOG_TITLE: 'Choose your role',
        LIVE_EVENT_ENTER_ROLE_DIALOG_OPTION_HOST: 'Host',
        LIVE_EVENT_ENTER_ROLE_DIALOG_OPTION_PARTICIPANT: 'Participant',
        LIVE_EVENT_ENTER_ALERT_TITLE: "Can't enter yet",
        LIVE_EVENT_ENTER_ALERT_DESCRIPTION: 'This live event will open soon.',
        LIVE_EVENT_CREATE_HEADER_TITLE: 'New live event',
        LIVE_EVENT_CREATE_EVENT_TITLE: 'Title',
        LIVE_EVENT_CREATE_EVENT_TITLE_PLACEHOLDER: 'Add a title',
        CREATE_EVENT_DEFAULT_TITLE: 'Live event',
        LIVE_EVENT_CREATE_EVENT_USERS_FOR_HOST: 'Users who can be host',
        LIVE_EVENT_CREATE_EVENT_COVER_IMAGE_TITLE: 'Cover image',
        LIVE_EVENT_CREATE_EVENT_COVER_IMAGE_BUTTON: 'Upload photo',
        LIVE_EVENT_CREATE_HEADER_BUTTON: 'Create',
        LIST_USERS_FOR_HOST_HEADER_TITLE: 'Users who can be host',
        ADD_USERS_FOR_HOST_HEADER_TITLE: 'Users',
        ADD_USERS_FOR_HOST_HEADER_BUTTON: 'Add ${}',
        USER_FOR_HOST_NICKNAME: function (nickname) { return "".concat(nickname, " (You)"); },
        USER_ID_PLACEHOLDER: 'Enter user ID',
        ADD_USERS_FOR_HOST_DIALOG_TITLE: 'Add user',
        NICKNAME: 'Nickname',
        USER_ID: 'User ID',
        USER_SEARCH_USER_COUNT_LIMIT: function (count) { return " / 10 users"; },
        USER_SEARCH_USER_COUNT_DESCRIPTION: 'You can add up to 10 users to be host.',
        USER_SEARCH_EXACT_MATCH_DESCRIPTION: 'Only an exact match can be found.',
        USER_SEARCH_NO_MATCH_DESCRIPTION: function (keyword) { return "No matches found with \"{keyword}\""; },
        USER_SEARCH_NO_USERS_DESCRIPTION: 'There are no users.',
        USER_SEARCH_ERROR_DESCRIPTION: 'Something went wrong. Try again.',
        USER_SEARCH_COUNT_EXCEED_DESCRIPTION: "Can't add more than 10 users",
        START_LIVE_EVENT_HEADER_BUTTON: 'Start live event',
        LIVE_EVENT_PARTICIPANT_COUNT: function (participantCount) { return "".concat(participantCount); },
        LIVE_EVENT_MESSAGE_INPUT_PLACEHOLDER: 'Enter message',
        LIVE_EVENT_INFORMATION_TITLE: 'Live event information',
        HOST: 'Host',
        PARTICIPANTS: 'Participants',
        FREEZE_CHAT: 'Freeze chat',
        FREEZE_CHAT_DESCRIPTION: 'Only operators can send a message. This doesn\'t stop the live event.',
        LIVE_EVENT_ID: 'Live event ID',
        CREATED_AT: 'Created on',
        CREATED_BY: 'Created by',
        STARTED_AT: 'Started on',
        STARTED_BY: 'Started by',
        EDIT_EVENT: 'Edit this event?',
        CHANGE_TITLE: 'Change title',
        CHANGE_COVER_IMAGE: 'Change cover image',
        CHANGE_EVENT_TITLE: 'Change event title',
        CHANGE_EVENT_TITLE_PLACEHOLDER: 'Enter title',
        CHANGE_EVENT_INFO_TITLE: 'Edit live event information',
        TITLE: 'Title',
        COVER_IMAGE: 'Cover image',
        UPLOAD_IMAGE: 'Upload photo',
        EDIT_LIVE_EVENT_USERS_FOR_HOST: 'Users who can be host',
        REMOVE_IMAGE: 'Remove photo',
        CHOOSE_IMAGE: 'Choose photo',
        HOSTS: 'Host',
        HOST_LABEL: 'Host',
        USERS_FOR_HOST: 'Users who can be host',
        USERS_FOR_HOST_DESCRIPTION: 'Any one of the users in the list below can act as a host for the live event. If the current host leaves the event, another user can act as the host.',
        PARTICIPANT_LIST_HEADER_TITLE: 'Participants',
        LIVE_EVENT_END_DIALOG_TITLE: 'End live event?',
        LIVE_EVENT_END_DIALOG_DESCRIPTION: 'Do you want to end this live event?',
        LIVE_EVENT_END_DIALOG_OPTION_END: 'End live event',
        LIVE_EVENT_END_DIALOG_OPTION_EXIT: 'Exit without ending',
        TOTAL_PARTICIPANTS_COUNT: 'Total participants',
        LIVE_EVENT_SUMMARY_DIALOG_TITLE: 'Live event ended',
        PEAK_CONCURRENT_PARTICIPANTS_COUNT: 'Peak concurrent participants',
        DURATION: 'Duration',
        LIVE_EVENT_DISCONNECTED_ALERT_TITLE: 'Disconnected temporarily',
        LIVE_EVENT_DISCONNECTED_ALERT_DESCRIPTION: 'Try entering the live event again.',
        LIVE_EVENT_LIVE_PARTICIPANT_COUNT_DURATION: '1,282 watching now â Started 30 mins ago',
        LIVE_EVENT_READY_BANNER_DESCRIPTION: 'Live event will begin soon.',
        LIVE_EVENT_LIVE_BANNER_HOST_MUTED_DESCRIPTION: 'Host is muted.',
        LIVE_EVENT_LIVE_BANNER_HOST_UNAVAILABLE_DESCRIPTION: 'Host is temporarily unavailable.',
        LIVE_EVENT_ENDED_DESCRIPTION: 'Live event has ended.',
        LIVE_EVENT_ENDED_DIALOG_DESCRIPTION: 'Host has ended this live event.',
        LIVE_EVENT_ENDED_ENTER_DIALOG_DESCRIPTION: 'Can\'t enter an ended live event.',
        UNKNOWN_ERROR_ALERT_TITLE: 'Oops!',
        UNKNOWN_ERROR_ALERT_DESCRIPTION: 'Something went wrong.',
    };
};

function SendbirdLive(props) {
    var userId = props.userId, appId = props.appId, nickname = props.nickname, accessToken = props.accessToken; props.customApiHost; props.customWebSocketHost; props.children; props.theme; var colorSet = props.colorSet, stringSet = props.stringSet;
    var _stringSet = useMemo(function () {
        if (!stringSet)
            return getStringSet();
        return __assign(__assign({}, getStringSet()), stringSet);
    }, [stringSet]);
    return (React__default__default.createElement(Sendbird, { userId: userId, appId: appId, nickname: nickname, accessToken: accessToken, colorSet: colorSet },
        React__default__default.createElement(SendbirdLiveInternal, __assign({}, props, { stringSet: _stringSet }))));
}

var _defs$6, _path$b, _g$8;

function _extends$o() { _extends$o = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$o.apply(this, arguments); }

var SvgImgThumbnailDefault1 = function SvgImgThumbnailDefault1(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$o({
    width: 112,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _defs$6 || (_defs$6 = /*#__PURE__*/React__default.createElement("defs", null, /*#__PURE__*/React__default.createElement("clipPath", {
    id: "img-thumbnail-default-1_svg__a"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M1368 0v1600H0V0h1368z"
  })), /*#__PURE__*/React__default.createElement("clipPath", {
    id: "img-thumbnail-default-1_svg__b"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M112 0v64H0V0h112z"
  })), /*#__PURE__*/React__default.createElement("clipPath", {
    id: "img-thumbnail-default-1_svg__c"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M13.333 10.667A2.667 2.667 0 0 1 15 15.415v11.149c-.544.067-1.099.102-1.661.103h-.01c-.564 0-1.118-.036-1.662-.103V15.415a2.667 2.667 0 0 1 1.667-4.748zm0-10.667c7.364 0 13.334 5.97 13.334 13.333 0 6.092-4.086 11.23-9.667 12.823V22.64a10.004 10.004 0 0 0 6.333-9.307c0-5.523-4.477-10-10-10s-10 4.477-10 10c0 4.229 2.625 7.844 6.334 9.307v3.516C4.086 24.563 0 19.426 0 13.333 0 5.97 5.97 0 13.333 0zm0 5.333A8 8 0 0 1 17 20.445V16.22a4.667 4.667 0 1 0-7.333 0v4.225a8 8 0 0 1 3.667-15.112z"
  })))), _path$b || (_path$b = /*#__PURE__*/React__default.createElement("path", {
    fill: "#FFF",
    d: "M-64-876h1368V724H-64z"
  })), _g$8 || (_g$8 = /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#img-thumbnail-default-1_svg__a)",
    transform: "translate(-64 -876)"
  }, /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#img-thumbnail-default-1_svg__b)",
    transform: "translate(64 876)"
  }, /*#__PURE__*/React__default.createElement("path", {
    fill: "#5858D3",
    d: "M0 0h112v64H0V0z"
  }), /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#img-thumbnail-default-1_svg__c)",
    transform: "translate(42.667 18.667)"
  }, /*#__PURE__*/React__default.createElement("path", {
    fill: "#FFF",
    d: "M0 0h26.667v26.667H0V0z"
  }))))));
};

var css_248z$e = "@import url(\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\");\nbody {\n  font-family: \"Roboto\", \"Verdana\", sans-serif;\n  font-size: 14px;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.spin {\n  animation: spin 1s linear infinite;\n}\n\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n.live-event-list-view {\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  width: 320px;\n  height: 100vh;\n  border: 1px solid var(--sendbird-light-onlight-04);\n  background-color: var(--sendbird-light-background-50);\n}\n.live-event-list-view .header {\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  height: 80px;\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.live-event-list-view .header .title {\n  width: 92px;\n  height: 21px;\n  margin: 0 13px 0 24px;\n  font-size: 18px;\n  font-weight: bold;\n  color: rgba(0, 0, 0, 0.88);\n}\n.live-event-list-view .header .refresh {\n  cursor: pointer;\n  width: 22px;\n  height: 22px;\n  object-fit: contain;\n}\n.live-event-list-view .header .create-button {\n  cursor: pointer;\n  height: 24px;\n  margin: 0 16px 0 auto;\n  padding: 2px 0;\n  font-size: 14px;\n  font-weight: 500;\n  line-height: 1.43;\n  color: #742ddd;\n}\n.live-event-list-view .list {\n  overflow-y: scroll;\n}\n.live-event-list-view .list .live-event-elem {\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  width: 100%;\n  height: 80px;\n  padding: 8px;\n  border-bottom: 1px solid var(--sendbird-light-onlight-04);\n}\n.live-event-list-view .list .cover-image__wrapper {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-shrink: 0;\n  width: 112px;\n  height: 64px;\n  margin: 7px 12px 7px 8px;\n}\n.live-event-list-view .list .cover-image__wrapper .cover-image {\n  max-width: 100%;\n  max-height: 100%;\n}\n.live-event-list-view .list .detail {\n  width: 100%;\n}\n.live-event-list-view .list .detail .title__wrapper {\n  margin: 7px 12px 2px 12px;\n  display: flex;\n  height: 16px;\n}\n.live-event-list-view .list .detail .title__wrapper .title {\n  font-size: 14px;\n  font-weight: 500;\n  color: rgba(0, 0, 0, 0.88);\n  overflow: hidden;\n  text-overflow: ellipsis;\n  text-align: center;\n}\n.live-event-list-view .list .detail .title__wrapper .participant-count__wrapper {\n  display: flex;\n  align-items: center;\n  margin-left: auto;\n}\n.live-event-list-view .list .detail .title__wrapper .participant-count__wrapper .participant-icon, .live-event-list-view .list .detail .title__wrapper .participant-count__wrapper .participant-icon--grey, .live-event-list-view .list .detail .title__wrapper .participant-count__wrapper .participant-icon--red {\n  width: 8px;\n  height: 8px;\n  margin: 0 4px;\n  border-radius: 50%;\n}\n.live-event-list-view .list .detail .title__wrapper .participant-count__wrapper .participant-icon--red {\n  background-color: #de360b;\n}\n.live-event-list-view .list .detail .title__wrapper .participant-count__wrapper .participant-icon--grey {\n  background-color: #bdbdbd;\n}\n.live-event-list-view .list .detail .title__wrapper .participant-count__wrapper .participant-count {\n  width: 32px;\n  height: 100%;\n}\n.live-event-list-view .list .detail .created-by {\n  height: 16px;\n  margin: 2px 4px 10px 12px;\n  font-size: 12px;\n  line-height: 1.33;\n  color: rgba(0, 0, 0, 0.5);\n}\n.live-event-list-view .list .detail .event-state, .live-event-list-view .list .detail .event-state--ended, .live-event-list-view .list .detail .event-state--ongoing, .live-event-list-view .list .detail .event-state--ready, .live-event-list-view .list .detail .event-state--created {\n  width: fit-content;\n  box-sizing: border-box;\n  height: 20px;\n  margin: 10px 0 0 12px;\n  padding: 4px;\n  border-radius: 2px;\n  font-size: 12px;\n  font-weight: bold;\n  line-height: 1;\n}\n.live-event-list-view .list .detail .event-state--created {\n  background-color: var(--sendbird-light-primary-100);\n  color: #6211c8;\n}\n.live-event-list-view .list .detail .event-state--ready {\n  background-color: #c8d9fa;\n  color: #30308f;\n}\n.live-event-list-view .list .detail .event-state--ongoing {\n  background-color: var(--sendbird-light-error-300);\n  color: rgba(255, 255, 255, 0.88);\n}\n.live-event-list-view .list .detail .event-state--ended {\n  color: rgba(0, 0, 0, 0.5);\n}\n.sendbird-theme--light .live-event-list-view .list .detail .event-state--ended {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .live-event-list-view .list .detail .event-state--ended {\n  background-color: var(--sendbird-dark-background-400);\n}";
styleInject(css_248z$e);

function LiveEventElem(props) {
    var _a, _b;
    var liveEvent = props.liveEvent, onClick = props.onClick, _c = props.showHostNickname, showHostNickname = _c === void 0 ? true : _c, _d = props.showStatusLabel, showStatusLabel = _d === void 0 ? true : _d;
    var stringSet = useContext(SendbirdLiveContext).stringSet;
    var mapStateName = function (name) {
        switch (name) {
            case 'created':
                return stringSet.EVENT_STATUS_CREATED;
            case 'ready':
                return stringSet.EVENT_STATUS_READY;
            case 'ongoing':
                return stringSet.EVENT_STATUS_ONGOING;
            case 'ended':
                return stringSet.EVENT_STATUS_ENDED;
        }
    };
    return (React__default__default.createElement("div", { className: "live-event-elem", onClick: function () { return onClick(liveEvent); } },
        React__default__default.createElement("div", { className: "cover-image__wrapper" }, liveEvent.coverUrl
            ? React__default__default.createElement("img", { src: liveEvent.coverUrl, alt: "cover_image", className: "cover-image" })
            : React__default__default.createElement(SvgImgThumbnailDefault1, { viewBox: "0 0 112 64", width: 112, height: 64 })),
        React__default__default.createElement("div", { className: "detail" },
            React__default__default.createElement("div", { className: "title__wrapper" },
                React__default__default.createElement("div", { className: "title" }, liveEvent.title ? liveEvent.title : stringSet.CREATE_EVENT_DEFAULT_TITLE),
                React__default__default.createElement("div", { className: "participant-count__wrapper" },
                    (liveEvent.state === sendbirdLive_min.exports.LiveEventState.ONGOING)
                        ? React__default__default.createElement("div", { className: "participant-icon--red" })
                        : React__default__default.createElement("div", { className: "participant-icon--grey" }),
                    React__default__default.createElement("div", { className: "participant-count" }, (_a = liveEvent.participantCount) !== null && _a !== void 0 ? _a : 0))),
            showHostNickname && React__default__default.createElement("div", { className: "created-by" }, liveEvent.host ? ((_b = liveEvent.host.nickname) !== null && _b !== void 0 ? _b : 'HOST') : stringSet.LIST_HOST_NICKNAME_PLACEHOLDER),
            showStatusLabel && React__default__default.createElement("div", { className: "event-state--".concat(liveEvent.state) }, mapStateName(liveEvent.state)))));
}

var _path$a;

function _extends$n() { _extends$n = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$n.apply(this, arguments); }

var SvgIconsRefresh = function SvgIconsRefresh(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$n({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$a || (_path$a = /*#__PURE__*/React__default.createElement("path", {
    d: "m46.14 14.43.562.537 6.631 6.167v-7.8a2.667 2.667 0 0 1 2.356-2.65l.311-.017a2.667 2.667 0 0 1 2.649 2.355l.018.311v16a2.667 2.667 0 0 1-2.356 2.65L56 32H40a2.667 2.667 0 0 1-.311-5.315l.311-.018h11.452l-8.44-7.85c-5.964-5.893-15.168-7.182-22.563-3.156-7.38 4.018-11.172 12.357-9.314 20.455 1.859 8.107 8.935 14.032 17.362 14.518 8.43.487 16.162-4.585 18.967-12.426a2.667 2.667 0 1 1 5.022 1.797C48.88 50.082 38.973 56.582 28.19 55.959c-10.785-.623-19.862-8.222-22.254-18.65C3.542 26.872 8.426 16.135 17.9 10.977c9.227-5.024 20.65-3.579 28.241 3.453z",
    fillRule: "evenodd"
  })));
};

function LiveEventList(props) {
    var _this = this;
    var onClickCreate = props.onClickCreate, onClickElem = props.onClickElem, queryParams = props.queryParams, renderTitle = props.renderTitle, renderCreateButton = props.renderCreateButton, renderLiveEventElem = props.renderLiveEventElem, _a = props.showStatusLabel, showStatusLabel = _a === void 0 ? true : _a, _b = props.showHostNickname, showHostNickname = _b === void 0 ? true : _b;
    var stringSet = useContext(SendbirdLiveContext).stringSet;
    var params = queryParams || { limit: 20 };
    var _c = useState(sendbirdLive_min.exports.SendbirdLive.createLiveEventListQuery(params)), query = _c[0], setQuery = _c[1];
    var liveEventList = useRef(null);
    var _d = useState([]), liveEvents = _d[0], setLiveEvents = _d[1];
    var refresh = function () { return __awaiter$2(_this, void 0, void 0, function () {
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0:
                    setQuery(sendbirdLive_min.exports.SendbirdLive.createLiveEventListQuery(params));
                    if (liveEventList.current) {
                        liveEventList.current.scrollTop = 0;
                    }
                    return [4 /*yield*/, getLiveEvents(true)];
                case 1:
                    _a.sent();
                    return [2 /*return*/];
            }
        });
    }); };
    var getLiveEvents = function (refresh) { return __awaiter$2(_this, void 0, void 0, function () {
        var result;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0:
                    if (!query.hasNext)
                        return [2 /*return*/];
                    _a.label = 1;
                case 1:
                    _a.trys.push([1, 3, , 4]);
                    return [4 /*yield*/, query.next()];
                case 2:
                    result = _a.sent();
                    if (refresh) {
                        setLiveEvents(result);
                    }
                    else {
                        setQuery(query);
                        setLiveEvents(__spreadArray(__spreadArray([], liveEvents, true), result, true));
                    }
                    return [3 /*break*/, 4];
                case 3:
                    _a.sent();
                    return [3 /*break*/, 4];
                case 4: return [2 /*return*/];
            }
        });
    }); };
    var onScroll = function () {
        if (liveEventList.current) {
            var _a = liveEventList.current, scrollTop = _a.scrollTop, scrollHeight = _a.scrollHeight, clientHeight = _a.clientHeight;
            if (scrollTop + clientHeight === scrollHeight) {
                getLiveEvents(false);
            }
        }
    };
    useEffect(function () {
        refresh();
    }, [queryParams]);
    return (React__default__default.createElement("div", { className: "live-event-list-view" },
        React__default__default.createElement("div", { className: "header" },
            (renderTitle === null || renderTitle === void 0 ? void 0 : renderTitle()) ||
                React__default__default.createElement("div", { className: "title" }, stringSet.LIST_HEADER_TITLE),
            React__default__default.createElement("div", { className: "refresh", onClick: refresh },
                React__default__default.createElement(SvgIconsRefresh, { viewBox: "0 0 64 64", width: 22, height: 22 })),
            (renderCreateButton === null || renderCreateButton === void 0 ? void 0 : renderCreateButton()) ||
                React__default__default.createElement("div", { className: "create-button", onClick: onClickCreate }, stringSet.LIST_HEADER_BUTTON)),
        React__default__default.createElement("div", { className: "list", ref: liveEventList, onScroll: onScroll }, liveEvents.map(function (liveEvent) {
            return (renderLiveEventElem === null || renderLiveEventElem === void 0 ? void 0 : renderLiveEventElem({ liveEvent: liveEvent, onClick: onClickElem })) ||
                React__default__default.createElement(LiveEventElem, { key: liveEvent.liveEventId, liveEvent: liveEvent, showStatusLabel: showStatusLabel, showHostNickname: showHostNickname, onClick: onClickElem });
        }))));
}

const PUBSUB_TOPICS = {
  // Group Channel
  USER_UPDATED: 'USER_UPDATED',
  SEND_MESSAGE_START: 'SEND_MESSAGE_START',
  SEND_USER_MESSAGE: 'SEND_USER_MESSAGE',
  SEND_FILE_MESSAGE: 'SEND_FILE_MESSAGE',
  UPDATE_USER_MESSAGE: 'UPDATE_USER_MESSAGE',
  DELETE_MESSAGE: 'DELETE_MESSAGE',
  LEAVE_CHANNEL: 'LEAVE_CHANNEL',
  CREATE_CHANNEL: 'CREATE_CHANNEL',
  // Open Channel
  UPDATE_OPEN_CHANNEL: 'UPDATE_OPEN_CHANNEL'
};

const noop$1 = () => {};

/**
 * user profile goes deep inside the component tree
 * use this context as a short circuit to send in values
 */

const UserProfileContext = /*#__PURE__*/React__default__default.createContext({
  disableUserProfile: true,
  isOpenChannel: false,
  renderUserProfile: null,
  onUserProfileMessage: null
});

const UserProfileProvider = props => {
  const {
    children
  } = props;
  return /*#__PURE__*/React__default__default.createElement(UserProfileContext.Provider, {
    value: props
  }, children);
};

UserProfileProvider.propTypes = {
  children: propTypes.exports.oneOfType([propTypes.exports.element, propTypes.exports.arrayOf(propTypes.exports.element), propTypes.exports.any]).isRequired,
  // eslint-disable-next-line react/no-unused-prop-types
  isOpenChannel: propTypes.exports.bool,
  // eslint-disable-next-line react/no-unused-prop-types
  disableUserProfile: propTypes.exports.bool,
  // eslint-disable-next-line react/no-unused-prop-types
  renderUserProfile: propTypes.exports.func,
  // eslint-disable-next-line react/no-unused-prop-types
  onUserProfileMessage: propTypes.exports.func
};
UserProfileProvider.defaultProps = {
  isOpenChannel: false,
  disableUserProfile: false,
  renderUserProfile: null,
  onUserProfileMessage: null
};

/*
  ImageRenderer displays image with url or source
  it checks if the source exist with img tag first
  if it exists onLoad is called, if not onError is called
  and those properties switch img tag to real purposing element
*/

const ImageRenderer = _ref => {
  let {
    className = '',
    url,
    alt = '',
    width = null,
    height = null,
    circle = false,
    fixedSize = false,
    placeHolder = null,
    defaultComponent = null,
    onLoad = () => {
      /* noop */
    },
    onError = () => {
      /* noop */
    }
  } = _ref;
  const [showDefaultComponent, setShowDefaultComponent] = useState(false);
  const [showPlaceHolder, setShowPlaceHolder] = useState(true);
  const DefaultComponent = useMemo(() => {
    return typeof defaultComponent === 'function' ? defaultComponent() : defaultComponent;
  }, [defaultComponent]);
  const PlaceHolder = useMemo(() => {
    return placeHolder && typeof placeHolder === 'function' ? placeHolder({
      style: {
        width: '100%',
        minWidth: width,
        maxWidth: fixedSize ? width : '400px',
        height,
        position: 'absolute',
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'center'
      }
    }) : null;
  }, [placeHolder]);
  const HiddenImageLoader = useMemo(() => {
    setShowDefaultComponent(false); // reset the state when url is changed

    return /*#__PURE__*/React__default__default.createElement("img", {
      className: "sendbird-image-renderer__hidden-image-loader",
      src: url,
      alt: alt,
      onLoad: () => {
        setShowPlaceHolder(false);
        onLoad();
      },
      onError: () => {
        setShowDefaultComponent(true);
        onError();
      }
    });
  }, [url]);
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-image-renderer'].join(' '),
    style: {
      width: '100%',
      minWidth: width,
      maxWidth: fixedSize ? width : '400px',
      height
    }
  }, showPlaceHolder && PlaceHolder, showDefaultComponent ? DefaultComponent : /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-image-renderer__image",
    style: {
      width: '100%',
      minWidth: width,
      maxWidth: fixedSize ? width : '400px',
      height,
      position: 'absolute',
      backgroundRepeat: 'no-repeat',
      backgroundPosition: 'center',
      backgroundSize: 'cover',
      backgroundImage: `url(${url})`,
      borderRadius: circle ? '50%' : null
    }
  }), HiddenImageLoader);
};

var pxToNumber$1 = px => {
  if (typeof px === 'number') {
    return px;
  }

  if (typeof px === 'string') {
    const parsed = Number.parseFloat(px);

    if (!Number.isNaN(parsed)) {
      return parsed;
    }
  }

  return null;
};

const imageRendererClassName = 'sendbird-avatar-img';

const DefaultComponent = _ref => {
  let {
    width,
    height
  } = _ref;
  let iconWidth = pxToNumber$1(width);
  let iconHeight = pxToNumber$1(height);

  if (typeof iconWidth === 'number') {
    iconWidth *= 0.575;
  }

  if (typeof iconHeight === 'number') {
    iconHeight *= 0.575;
  }

  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-avatar-img--default",
    style: {
      width,
      height
    }
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    type: IconTypes.USER,
    fillColor: IconColors.CONTENT,
    width: iconWidth,
    height: iconHeight
  }));
};

const _defaultComponent = _ref2 => {
  let {
    width,
    height
  } = _ref2;
  return /*#__PURE__*/React__default__default.createElement(DefaultComponent, {
    width: width,
    height: height
  });
};

const AvatarInner = _ref3 => {
  let {
    src = '',
    alt = '',
    height,
    width,
    customDefaultComponent
  } = _ref3;

  const defaultComponent = () => customDefaultComponent ? customDefaultComponent({
    width,
    height
  }) : _defaultComponent({
    width,
    height
  });

  if (typeof src === 'string') {
    return /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
      className: imageRendererClassName,
      url: src,
      height: height,
      width: width,
      alt: alt,
      defaultComponent: defaultComponent
    });
  }

  if (src && src.length) {
    if (src.length === 1) {
      return /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
        className: imageRendererClassName,
        url: src[0],
        height: height,
        width: width,
        alt: alt,
        defaultComponent: defaultComponent
      });
    }

    if (src.length === 2) {
      return /*#__PURE__*/React__default__default.createElement("div", {
        className: "sendbird-avatar--inner__two-child"
      }, /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
        className: imageRendererClassName,
        url: src[0],
        height: height,
        width: width,
        alt: alt,
        defaultComponent: defaultComponent
      }), /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
        className: imageRendererClassName,
        url: src[1],
        height: height,
        width: width,
        alt: alt,
        defaultComponent: defaultComponent
      }));
    }

    if (src.length === 3) {
      return /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, /*#__PURE__*/React__default__default.createElement("div", {
        className: "sendbird-avatar--inner__three-child--upper"
      }, /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
        className: imageRendererClassName,
        url: src[0],
        height: height,
        width: width,
        alt: alt,
        defaultComponent: defaultComponent
      })), /*#__PURE__*/React__default__default.createElement("div", {
        className: "sendbird-avatar--inner__three-child--lower"
      }, /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
        className: imageRendererClassName,
        url: src[1],
        height: height,
        width: width,
        alt: alt,
        defaultComponent: defaultComponent
      }), /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
        className: imageRendererClassName,
        url: src[2],
        height: height,
        width: width,
        alt: alt,
        defaultComponent: defaultComponent
      })));
    }

    return /*#__PURE__*/React__default__default.createElement("div", {
      className: "sendbird-avatar--inner__four-child"
    }, src.slice(0, 4).map(i => /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
      className: imageRendererClassName,
      url: i,
      height: height,
      width: width,
      alt: alt,
      key: uuidv4(),
      defaultComponent: defaultComponent
    })));
  } // default img


  return /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
    className: imageRendererClassName,
    url: "",
    height: height,
    width: width,
    alt: alt,
    defaultComponent: defaultComponent
  });
};

function Avatar(_ref4, ref) {
  let {
    className = '',
    src = '',
    alt = '',
    width = '56px',
    height = '56px',
    onClick,
    customDefaultComponent
  } = _ref4;
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-avatar'].join(' '),
    role: "button",
    ref: ref,
    style: {
      height,
      width
    },
    onClick: onClick,
    onKeyDown: onClick,
    tabIndex: 0
  }, /*#__PURE__*/React__default__default.createElement(AvatarInner, {
    src: src,
    width: width,
    height: height,
    alt: alt,
    customDefaultComponent: customDefaultComponent
  }));
}

var Avatar$1 = /*#__PURE__*/React__default__default.forwardRef(Avatar);

/**
 * 1. UIKit Instances
 *    a. getSdk
 *    b. getPubSub
 * 2. Chat & Connection
 *    a. getConnect
 *    b. getDisconnect
 *    c. getUpdateUserInfo
 * 3. Channel
 *    a. getCreateGroupChannel
 *    b. getCreateOpenChannel
 *    c. getGetGroupChannel
 *    d. getGetOpenChannel
 *    e. getLeaveGroupChannel
 *    f. getEnterOpenChannel
 *    g. getExitOpenChannel
 *    h. getFreezeChannel
 *    i. getUnfreezeChannel
 * 4. Message
 *    a. getSendUserMessage
 *    b. getSendFileMessage
 *    c. getUpdateUserMessage
 *    d. x - getUpdateFileMessage
 *    e. getDeleteMessage
 *    f. getResendUserMessage
 *    g. getResendFileMessage
 */

/**
 * import useSendbirdStateContext from '@sendbird-uikit/useSendbirdStateContext'
 * import selectors from '@sendbird-uikit/send'
 * const state = useSendbirdStateContext();
 */
// 1. UIKit Instances

/**
 * const sdk = selectors.getSdk(state);
 */

const getSdk = state => {
  const {
    stores = {}
  } = state;
  const {
    sdkStore = {}
  } = stores;
  const {
    sdk
  } = sdkStore;
  return sdk;
};
/**
 * const pubSub = selectors.getPubSub(state);
 */


const getPubSub = state => {
  const {
    config = {}
  } = state;
  const {
    pubSub
  } = config;
  return pubSub;
}; // 2. Chat & Connection

/**
 * const connect = selectors.getConnect(state);
 * connect('user-id-sendbirdian', 'access-token-0000')
 *  .then((user) => {})
 *  .catch((error) => {})
 */


const getConnect = state => (userId, accessToken) => new Promise((resolve, reject) => {
  const sdk = getSdk(state);

  if (!sdk) {
    reject(new Error('Sdk not found'));
  }

  if (!(sdk !== null && sdk !== void 0 && sdk.connect && typeof sdk.connect === 'function')) {
    reject(new Error('Not found the function "connect'));
  }

  if (!accessToken) {
    sdk.connect(userId).then(res => resolve(res)).catch(err => reject(err));
  } else {
    sdk.connect(userId, accessToken).then(res => resolve(res)).catch(err => reject(err));
  }
});
/**
 * const disconnect = selectors.getDisconnect(state);
 * disconnect()
 *  .then(() => {})
 *  .catch((error) => {})
 */


const getDisconnect = state => () => new Promise((resolve, reject) => {
  const sdk = getSdk(state);

  if (!sdk) {
    reject(new Error('Sdk not found'));
  }

  if (!(sdk.disconnect && typeof sdk.disconnect === 'function')) {
    reject(new Error('Not found the function "disconnect'));
  }

  sdk.disconnect().then(res => resolve(res)).catch(err => reject(err));
});
/**
 * const updateUserInfo = selectors.getUpdateUserInfo(state);
 * updateUserInfo('new-nickname', 'new-profile-url')
 *  .then((user) => {})
 *  .catch((error) => {})
 */


const getUpdateUserInfo = state => (nickname, profileUrl) => new Promise((resolve, reject) => {
  const sdk = getSdk(state);

  if (!sdk) {
    reject(new Error('Sdk not found'));
  }

  if (!(sdk.updateCurrentUserInfo && typeof sdk.updateCurrentUserInfo === 'function')) {
    reject(new Error('Not found the function "updateCurrentUserInfo"'));
  }

  const userParams = {
    nickname
  };

  if (profileUrl) {
    userParams.profileUrl = profileUrl;
  }

  sdk.updateCurrentUserInfo(userParams).then(res => resolve(res)).catch(err => reject(err));
}); // 3. Channel

/**
 * const createGroupChannel = selectors.getCreateGroupChannel(state);
 * createGroupChannel(channelParams: GroupChannelCreateParams)
 *  .then((channel) => {})
 *  .catch((error) => {})
 */


const getCreateGroupChannel = state => params => new Promise((resolve, reject) => {
  const sdk = getSdk(state);
  const pubSub = getPubSub(state);

  if (!sdk) {
    reject(new Error('Sdk not found'));
  }

  if (!sdk.groupChannel) {
    reject(new Error('Not found GroupChannelModule'));
  }

  if (!(sdk.groupChannel.createChannel && typeof sdk.groupChannel.createChannel === 'function')) {
    reject(new Error('Not found the function "createChannel"'));
  }

  sdk.groupChannel.createChannel(params).then(channel => {
    resolve(channel);
    pubSub.publish(PUBSUB_TOPICS.CREATE_CHANNEL, {
      channel
    });
  }).catch(reject);
});
/**
 * const createOpenChannel = selectors.getCreateOpenChannel(state);
 * createOpenChannel(channelParams: OpenChannelCreateParams)
 *  .then((channel) => {})
 *  .catch((error) => {})
 */


const getCreateOpenChannel = state => params => new Promise((resolve, reject) => {
  const sdk = getSdk(state); // const pubSub = getPubSub(state);

  if (!sdk) {
    reject(new Error('Sdk not found'));
  }

  if (!sdk.openChannel) {
    reject(new Error('Not found OpenChannelModule'));
  }

  if (!(sdk.openChannel.createChannel && typeof sdk.openChannel.createChannel === 'function')) {
    reject(new Error('Not found the function "createChannel"'));
  }

  sdk.openChannel.createChannel(params).then(channel => {
    resolve(channel); // Consider pubSub process
  }).catch(reject);
});
/**
 * const getGroupChannel = selectors.getGetGroupChannel(state);
 * getGroupChannel('channel-url-1234', isSelected)
 *  .then((channel) => {
 *    // groupChannel = channel;
 *    // or
 *    // setCurrentChannel(channel);
 *  })
 *  .catch((error) => {})
 */


const getGetGroupChannel = state => channelUrl => new Promise((resolve, reject) => {
  const sdk = getSdk(state); // const pubSub = getPubSub(state);

  if (!sdk) {
    reject(new Error('Sdk not found'));
  }

  if (!sdk.groupChannel) {
    reject(new Error('Not found GroupChannelModule'));
  }

  if (!(sdk.groupChannel.getChannel && typeof sdk.groupChannel.getChannel === 'function')) {
    reject(new Error('Not found the function "getChannel"'));
  }

  sdk.groupChannel.getChannel(channelUrl).then(channel => {
    resolve(channel); // Add pubSub with isSelected
  }).catch(reject);
});
/**
 * const getOpenChannel = selectors.getGetOpenChannel(state);
 * getOpenChannel('channel-url-12345')
 *  .then((channel) => {
 *    // openChannel = channel;
 *    // or
 *    // setCurrentChannel(channel);
 *  })
 *  .catch((error) => {})
 */


const getGetOpenChannel = state => channelUrl => new Promise((resolve, reject) => {
  const sdk = getSdk(state); // const pubSub = getPubSub(state);

  if (!sdk) {
    reject(new Error('Sdk not found'));
  }

  if (!sdk.openChannel) {
    reject(new Error('Not found OpenChannelModule'));
  }

  if (!(sdk.openChannel.getChannel && typeof sdk.openChannel.getChannel === 'function')) {
    reject(new Error('Not found the function "getChannel"'));
  }

  sdk.openChannel.getChannel(channelUrl).then(channel => {
    resolve(channel); // Add pubSub with isSelected
  }).catch(reject);
});
/**
 * const leaveChannel = selectors.getLeaveGroupChannel(state);
 * leaveChannel('group-channel-url')
 *  .then((channel) => {})
 *  .catch((error) => {})
 */


const getLeaveGroupChannel = state => channelUrl => new Promise((resolve, reject) => {
  var _getGetGroupChannel;

  (_getGetGroupChannel = getGetGroupChannel(state)) === null || _getGetGroupChannel === void 0 ? void 0 : _getGetGroupChannel(channelUrl).then(channel => {
    channel.leave().then(() => {
      resolve(); // Add pubSub process
    }).catch(reject);
  }).catch(reject);
});
/**
 * const enterChannel = selectors.getEnterOpenChannel(state);
 * enterChannel('open-channel-url')
 *  .then((channel) => {})
 *  .catch((error) => {})
 */


const getEnterOpenChannel = state => channelUrl => new Promise((resolve, reject) => {
  var _getGetOpenChannel;

  (_getGetOpenChannel = getGetOpenChannel(state)) === null || _getGetOpenChannel === void 0 ? void 0 : _getGetOpenChannel(channelUrl).then(channel => {
    channel.enter().then(() => {
      resolve(channel); // Add pubSub process
    }).catch(reject);
  }).catch(reject);
});
/**
 * const exitChannel = selectors.getExitOpenChannel(state);
 * exitChannel('open-channel-url')
 *  .then((channel) => {})
 *  .catch((error) => {})
 */


const getExitOpenChannel = state => channelUrl => new Promise((resolve, reject) => {
  var _getGetOpenChannel2;

  (_getGetOpenChannel2 = getGetOpenChannel(state)) === null || _getGetOpenChannel2 === void 0 ? void 0 : _getGetOpenChannel2(channelUrl).then(channel => {
    channel.exit().then(() => {
      resolve(channel); // Add pubSub process
    }).catch(reject);
  }).catch(reject);
});
/**
 * const freezeChannel = selectors.getFreezeChannel(currentChannel);
 * freezeChannel()
 *  .then(() => {})
 *  .catch((error) => {})
 */


const getFreezeChannel = () => channel => new Promise((resolve, reject) => {
  if (!(channel.freeze && typeof (channel === null || channel === void 0 ? void 0 : channel.freeze) === 'function')) {
    reject(new Error('Not found the function "freeze"'));
  }

  channel.freeze().then(() => {
    resolve(); // Add pubSub process

    /**
     * consider divide the logic to
     * _freezeGroupChannel and _freezeOpenChannel
     */
  }).catch(reject);
});
/**
 * const unfreezeChannel = selectors.getUnfreezeChannel(currentChannel);
 * unfreezeChannel()
 *  .then((channel) => {})
 *  .catch((error) => {})
 */


const getUnfreezeChannel = () => channel => new Promise((resolve, reject) => {
  if (!(channel.unfreeze && typeof (channel === null || channel === void 0 ? void 0 : channel.unfreeze) === 'function')) {
    reject(new Error('Not found the function "unfreeze"'));
  }

  channel.unfreeze().then(() => {
    resolve(); // Add pubSub process

    /**
     * consider divide the logic to
     * _unfreezeGroupChannel and _unfreezeOpenChannel
     */
  }).catch(reject);
}); // 4. Message


class UikitMessageHandler {
  constructor() {
    _defineProperty(this, "_onPending", noop$1);

    _defineProperty(this, "_onFailed", noop$1);

    _defineProperty(this, "_onSucceeded", noop$1);
  }

  triggerPending(message) {
    this._onPending(message);
  }

  triggerFailed(error, message) {
    this._onFailed(error, message.isResendable ? message : null);
  }

  triggerSucceeded(message) {
    this._onSucceeded(message);
  }

  onPending(handler) {
    if (typeof handler === 'function') {
      this._onPending = handler;
    }

    return this;
  }

  onFailed(handler) {
    if (typeof handler === 'function') {
      this._onFailed = handler;
    }

    return this;
  }

  onSucceeded(handler) {
    if (typeof handler === 'function') {
      this._onSucceeded = handler;
    }

    return this;
  }

}
/**
 * const sendUserMessage = selectors.getSendUserMessage(state);
 * sendUserMessage(
 *  channel: GroupChannel | OpenChannel,
 *  params: UserMessageCreateParams,
 * )
 *  .onPending((message) => {})
 *  .onFailed((error, message) => {})
 *  .onSucceeded((message) => {})
 */


const getSendUserMessage = state => (channel, params) => {
  const handler = new UikitMessageHandler();
  const pubSub = getPubSub(state);
  channel.sendUserMessage(params).onFailed((error, message) => handler.triggerFailed(error, message)).onPending(message => {
    pubSub.publish(PUBSUB_TOPICS.SEND_MESSAGE_START, {
      message,
      channel
    });
    handler.triggerPending(message);
  }).onSucceeded(message => {
    pubSub.publish(PUBSUB_TOPICS.SEND_USER_MESSAGE, {
      message,
      channel
    });
    handler.triggerSucceeded(message);
  });
  return handler;
};
/**
 * const sendFileMessage = selectors.getSendFileMessage(state);
 * sendFileMessage(
 *  channel: GroupChannel | OpenChannel,
 *  params: FileMessageCreateParams,
 * )
 *  .onPending((message) => {})
 *  .onFailed((error, message) => {})
 *  .onSucceeded((message) => {})
 */


const getSendFileMessage = state => (channel, params) => {
  const handler = new UikitMessageHandler();
  const pubSub = getPubSub(state);
  channel.sendFileMessage(params).onFailed((error, message) => handler.triggerFailed(error, message)).onPending(message => {
    pubSub.publish(PUBSUB_TOPICS.SEND_MESSAGE_START, {
      message,
      channel
    });
    handler.triggerPending(message);
  }).onSucceeded(message => {
    pubSub.publish(PUBSUB_TOPICS.SEND_FILE_MESSAGE, {
      message,
      channel
    });
    handler.triggerSucceeded(message);
  });
  return handler;
};
/**
 * const updateUserMessage = selectors.getUpdateUserMessage(state);
 * updateUserMessage(
 *  channel: GroupChannel | OpenChannel,
 *  messageId: number,
 *  messageParams: UserMessageUpdateParams,
 * )
 *  .then((message) => {})
 *  .catch((error) => {})
 */


const getUpdateUserMessage = state => (channel, messageId, params) => new Promise((resolve, reject) => {
  const pubSub = getPubSub(state);
  channel.updateUserMessage(messageId, params).then(message => {
    pubSub.publish(PUBSUB_TOPICS.UPDATE_USER_MESSAGE, {
      message,
      channel,
      fromSelector: true
    });
    resolve(message);
  }).catch(reject);
}); // TODO: We will provie this function in the future

/**
 * const updateFileMessage = selectors.getUpdateFileMessage(state);
 * updateFileMessage(
 *  channel: GroupChannel | OpenChannel,
 *  messageId: number,
 *  params: FileMessageUpdateParams,
 * )
 *  .then((message) => {})
 *  .catch((error) => {})
 */
// const getUpdateFileMessage = (state: SendBirdState) => (
//   (channel: GroupChannel | OpenChannel, messageId: number, params: FileMessageUpdateParams) => (
//     new Promise((resolve, reject) => {
//       const pubSub = getPubSub(state);
//       channel.updateFileMessage(messageId, params)
//         .then((message) => {
//           pubSub.publish(
//             topics.UPDATE_USER_MESSAGE,
//             { message, channel, fromSelector: true },
//           );
//           resolve(message);
//         })
//         .catch(reject);
//     })
//   )
// );

/**
 * const deleteMessage = selectors.getDeleteMessage(state);
 * deleteMessage(
 *  channel: GroupChannel | OpenChannel,
 *  message: SendableMessage,
 * )
 *  .then((deletedMessage) => {})
 *  .catch((error) => {})
 */


const getDeleteMessage = state => (channel, message) => new Promise((resolve, reject) => {
  const pubSub = getPubSub(state);
  const {
    messageId
  } = message;
  channel.deleteMessage(message).then(() => {
    pubSub.publish(PUBSUB_TOPICS.DELETE_MESSAGE, {
      messageId,
      channel
    });
    resolve(message);
  }).catch(reject);
});
/**
 * const resendUserMessage = selectors.getResendUserMessage(state);
 * resendUserMessage(
 *  channel: GroupChannel | OpenChannel,
 *  failedMessage: UserMessage,
 * )
 *  .then(() => {})
 *  .catch((error) => {})
 */


const getResendUserMessage = state => (channel, failedMessage) => new Promise((resolve, reject) => {
  const pubSub = getPubSub(state);
  channel.resendUserMessage(failedMessage).then(message => {
    pubSub.publish(PUBSUB_TOPICS.SEND_USER_MESSAGE, {
      message,
      channel
    });
    resolve(message);
  }).catch(reject);
});
/**
 * const resendFileMessage = selectors.getResendFileMessage(state);
 * resendFileMessage(
 *  channel: GroupChannel | OpenChannel,
 *  failedMessage: FileMessage,
 *  blob: Blob,
 * )
 *  .then(() => {})
 *  .catch((error) => {})
 */


const getResendFileMessage = state => (channel, failedMessage, blob) => new Promise((resolve, reject) => {
  const pubSub = getPubSub(state);
  channel.resendFileMessage(failedMessage, blob).then(message => {
    pubSub.publish(PUBSUB_TOPICS.SEND_FILE_MESSAGE, {
      message,
      channel
    });
    resolve(message);
  }).catch(reject);
});

const sendbirdSelectors = {
  getSdk,
  getPubSub,
  getConnect,
  getDisconnect,
  getUpdateUserInfo,
  getCreateGroupChannel,
  getCreateOpenChannel,
  getGetGroupChannel,
  getGetOpenChannel,
  getLeaveGroupChannel,
  getEnterOpenChannel,
  getExitOpenChannel,
  getFreezeChannel,
  getUnfreezeChannel,
  getSendUserMessage,
  getSendFileMessage,
  getUpdateUserMessage,
  getDeleteMessage,
  getResendUserMessage,
  getResendFileMessage
};

function UserProfile(_ref) {
  var _store$config, _store$config2;

  let {
    user,
    currentUserId,
    disableMessaging = false,
    onSuccess
  } = _ref;
  const store = useSendbirdStateContext();
  const createChannel = getCreateGroupChannel(store);
  const logger = store === null || store === void 0 ? void 0 : (_store$config = store.config) === null || _store$config === void 0 ? void 0 : _store$config.logger;
  const {
    stringSet
  } = useContext(LocalizationContext);
  const currentUserId_ = currentUserId || (store === null || store === void 0 ? void 0 : (_store$config2 = store.config) === null || _store$config2 === void 0 ? void 0 : _store$config2.userId); // @ts-ignore

  const {
    onUserProfileMessage
  } = useContext(UserProfileContext);
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird__user-profile"
  }, /*#__PURE__*/React__default__default.createElement("section", {
    className: "sendbird__user-profile-avatar"
  }, /*#__PURE__*/React__default__default.createElement(Avatar$1, {
    height: "80px",
    width: "80px",
    src: user === null || user === void 0 ? void 0 : user.profileUrl
  })), /*#__PURE__*/React__default__default.createElement("section", {
    className: "sendbird__user-profile-name"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    type: LabelTypography.H_2,
    color: LabelColors.ONBACKGROUND_1
  }, (user === null || user === void 0 ? void 0 : user.nickname) || stringSet.NO_NAME)), (user === null || user === void 0 ? void 0 : user.userId) !== currentUserId_ && !disableMessaging && /*#__PURE__*/React__default__default.createElement("section", {
    className: "sendbird__user-profile-message"
  }, /*#__PURE__*/React__default__default.createElement(Button, {
    type: ButtonTypes.SECONDARY,
    onClick: () => {
      // Create 1:1 channel
      const params = {
        isDistinct: false,
        invitedUserIds: [user === null || user === void 0 ? void 0 : user.userId],
        operatorUserIds: [currentUserId_]
      };
      onSuccess();
      createChannel(params).then(groupChannel => {
        logger.info('UserProfile, channel create', groupChannel);

        if (typeof onUserProfileMessage === 'function') {
          onUserProfileMessage === null || onUserProfileMessage === void 0 ? void 0 : onUserProfileMessage(groupChannel);
        }
      });
    }
  }, stringSet.USER_PROFILE__MESSAGE)), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird__user-profile-separator"
  }), /*#__PURE__*/React__default__default.createElement("section", {
    className: "sendbird__user-profile-userId"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird__user-profile-userId--label",
    type: LabelTypography.CAPTION_2,
    color: LabelColors.ONBACKGROUND_2
  }, stringSet.USER_PROFILE__USER_ID), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird__user-profile-userId--value",
    type: LabelTypography.BODY_1,
    color: LabelColors.ONBACKGROUND_1
  }, user === null || user === void 0 ? void 0 : user.userId)));
}

const HEIGHT_PADDING = 60;

class MenuItems$1 extends React__default__default.Component {
  constructor(props) {
    super(props);

    _defineProperty(this, "menuRef", /*#__PURE__*/React__default__default.createRef());

    _defineProperty(this, "setupEvents", () => {
      const {
        closeDropdown
      } = this.props;
      const {
        menuRef
      } = this;

      const handleClickOutside = event => {
        var _menuRef$current, _menuRef$current$cont;

        if (menuRef !== null && menuRef !== void 0 && menuRef.current && !(menuRef !== null && menuRef !== void 0 && (_menuRef$current = menuRef.current) !== null && _menuRef$current !== void 0 && (_menuRef$current$cont = _menuRef$current.contains) !== null && _menuRef$current$cont !== void 0 && _menuRef$current$cont.call(_menuRef$current, event.target))) {
          closeDropdown === null || closeDropdown === void 0 ? void 0 : closeDropdown();
        }
      };

      this.setState({
        handleClickOutside
      });
      document.addEventListener('mousedown', handleClickOutside);
    });

    _defineProperty(this, "cleanUpEvents", () => {
      const {
        handleClickOutside
      } = this.state;
      document.removeEventListener('mousedown', handleClickOutside);
    });

    _defineProperty(this, "getMenuPosition", () => {
      var _parentRef$current, _parentRef$current$ge;

      const {
        parentRef,
        openLeft
      } = this.props;
      const parentRect = parentRef === null || parentRef === void 0 ? void 0 : (_parentRef$current = parentRef.current) === null || _parentRef$current === void 0 ? void 0 : (_parentRef$current$ge = _parentRef$current.getBoundingClientRect) === null || _parentRef$current$ge === void 0 ? void 0 : _parentRef$current$ge.call(_parentRef$current);
      const x = (parentRect === null || parentRect === void 0 ? void 0 : parentRect.x) || (parentRect === null || parentRect === void 0 ? void 0 : parentRect.left) || 0;
      const y = (parentRect === null || parentRect === void 0 ? void 0 : parentRect.y) || (parentRect === null || parentRect === void 0 ? void 0 : parentRect.top) || 0;
      const menuStyle = {
        top: y,
        left: x
      };
      if (!this.menuRef.current) return menuStyle;
      const {
        innerWidth,
        innerHeight
      } = window;
      const rect = this.menuRef.current.getBoundingClientRect();

      if (y + rect.height + HEIGHT_PADDING > innerHeight) {
        menuStyle.top -= rect.height;
      }

      if (x + rect.width > innerWidth && !openLeft) {
        menuStyle.left -= rect.width;
      }

      if (menuStyle.top < 0) {
        menuStyle.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;
      }

      menuStyle.top += 32;

      if (openLeft) {
        const padding = Number.isNaN(rect.width - 30) ? 108 // default
        : rect.width - 30;
        menuStyle.left -= padding;
      } // warning: this section has to be executed after the openLeft is calculated
      // menu is outside viewport


      if (menuStyle.left < 0) {
        menuStyle.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;
      }

      this.setState({
        menuStyle
      });
      return menuStyle;
    });

    this.state = {
      menuStyle: {},
      handleClickOutside: () => {
        /* noop */
      }
    };
  }

  componentDidMount() {
    this.setupEvents();
    this.getMenuPosition();
  }

  componentWillUnmount() {
    this.cleanUpEvents();
  }

  render() {
    var _this$props;

    const {
      menuStyle
    } = this.state;
    const {
      children,
      style,
      className = ''
    } = this.props;
    return /*#__PURE__*/createPortal( /*#__PURE__*/React__default__default.createElement("div", {
      className: (_this$props = this.props) === null || _this$props === void 0 ? void 0 : _this$props.className
    }, /*#__PURE__*/React__default__default.createElement("div", {
      className: "sendbird-dropdown__menu-backdrop"
    }), /*#__PURE__*/React__default__default.createElement("ul", {
      className: `${className} sendbird-dropdown__menu`,
      ref: this.menuRef,
      style: _objectSpread2({
        display: 'inline-block',
        position: 'fixed',
        left: `${Math.round(menuStyle.left)}px`,
        top: `${Math.round(menuStyle.top)}px`
      }, style)
    }, children)), document.getElementById('sendbird-dropdown-portal'));
  }

}

const ENTER_KEY = 13;
const MenuItems = MenuItems$1;

const MenuItem = _ref => {
  let {
    className = '',
    children,
    onClick,
    disable = false,
    dataSbId = ''
  } = _ref;

  const handleClickEvent = e => {
    if (!disable && onClick) {
      onClick === null || onClick === void 0 ? void 0 : onClick(e);
    }
  };

  return /*#__PURE__*/React__default__default.createElement("li", {
    className: getClassName([className, 'sendbird-dropdown__menu-item', disable ? 'disable' : '']),
    role: "menuitem",
    "aria-disabled": disable ? true : false,
    onClick: handleClickEvent,
    onKeyPress: e => {
      if (e.keyCode === ENTER_KEY) handleClickEvent(e);
    },
    tabIndex: 0,
    "data-sb-id": dataSbId
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-dropdown__menu-item__text",
    type: LabelTypography.SUBTITLE_2,
    color: disable ? LabelColors.ONBACKGROUND_4 : LabelColors.ONBACKGROUND_1
  }, children));
};

function ContextMenu(_ref2) {
  let {
    menuTrigger,
    menuItems,
    isOpen
  } = _ref2;
  const [showMenu, setShowMenu] = useState(false);
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-context-menu",
    style: {
      display: 'inline'
    }
  }, menuTrigger === null || menuTrigger === void 0 ? void 0 : menuTrigger(() => setShowMenu(!showMenu)), (showMenu || isOpen) && menuItems(() => setShowMenu(false)));
}

function requiredArgs$1(required, args) {
  if (args.length < required) {
    throw new TypeError(required + ' argument' + (required > 1 ? 's' : '') + ' required, but only ' + args.length + ' present');
  }
}

function _typeof$1$1(obj) {
  "@babel/helpers - typeof";

  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    _typeof$1$1 = function _typeof(obj) {
      return typeof obj;
    };
  } else {
    _typeof$1$1 = function _typeof(obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };
  }

  return _typeof$1$1(obj);
}
/**
 * @name toDate
 * @category Common Helpers
 * @summary Convert the given argument to an instance of Date.
 *
 * @description
 * Convert the given argument to an instance of Date.
 *
 * If the argument is an instance of Date, the function returns its clone.
 *
 * If the argument is a number, it is treated as a timestamp.
 *
 * If the argument is none of the above, the function returns Invalid Date.
 *
 * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.
 *
 * @param {Date|Number} argument - the value to convert
 * @returns {Date} the parsed date in the local time zone
 * @throws {TypeError} 1 argument required
 *
 * @example
 * // Clone the date:
 * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))
 * //=> Tue Feb 11 2014 11:30:30
 *
 * @example
 * // Convert the timestamp to date:
 * const result = toDate(1392098430000)
 * //=> Tue Feb 11 2014 11:30:30
 */


function toDate$1(argument) {
  requiredArgs$1(1, arguments);
  var argStr = Object.prototype.toString.call(argument); // Clone the date

  if (argument instanceof Date || _typeof$1$1(argument) === 'object' && argStr === '[object Date]') {
    // Prevent the date to lose the milliseconds when passed to new Date() in IE10
    return new Date(argument.getTime());
  } else if (typeof argument === 'number' || argStr === '[object Number]') {
    return new Date(argument);
  } else {
    if ((typeof argument === 'string' || argStr === '[object String]') && typeof console !== 'undefined') {
      // eslint-disable-next-line no-console
      console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"); // eslint-disable-next-line no-console

      console.warn(new Error().stack);
    }

    return new Date(NaN);
  }
}

function _typeof$2(obj) {
  "@babel/helpers - typeof";

  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    _typeof$2 = function _typeof(obj) {
      return typeof obj;
    };
  } else {
    _typeof$2 = function _typeof(obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };
  }

  return _typeof$2(obj);
}
/**
 * @name isDate
 * @category Common Helpers
 * @summary Is the given value a date?
 *
 * @description
 * Returns true if the given value is an instance of Date. The function works for dates transferred across iframes.
 *
 * @param {*} value - the value to check
 * @returns {boolean} true if the given value is a date
 * @throws {TypeError} 1 arguments required
 *
 * @example
 * // For a valid date:
 * const result = isDate(new Date())
 * //=> true
 *
 * @example
 * // For an invalid date:
 * const result = isDate(new Date(NaN))
 * //=> true
 *
 * @example
 * // For some value:
 * const result = isDate('2014-02-31')
 * //=> false
 *
 * @example
 * // For an object:
 * const result = isDate({})
 * //=> false
 */


function isDate$1(value) {
  requiredArgs$1(1, arguments);
  return value instanceof Date || _typeof$2(value) === 'object' && Object.prototype.toString.call(value) === '[object Date]';
}
/**
 * @name isValid
 * @category Common Helpers
 * @summary Is the given date valid?
 *
 * @description
 * Returns false if argument is Invalid Date and true otherwise.
 * Argument is converted to Date using `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}
 * Invalid Date is a Date, whose time value is NaN.
 *
 * Time value of Date: http://es5.github.io/#x15.9.1.1
 *
 * @param {*} date - the date to check
 * @returns {Boolean} the date is valid
 * @throws {TypeError} 1 argument required
 *
 * @example
 * // For the valid date:
 * const result = isValid(new Date(2014, 1, 31))
 * //=> true
 *
 * @example
 * // For the value, convertable into a date:
 * const result = isValid(1393804800000)
 * //=> true
 *
 * @example
 * // For the invalid date:
 * const result = isValid(new Date(''))
 * //=> false
 */


function isValid$1(dirtyDate) {
  requiredArgs$1(1, arguments);

  if (!isDate$1(dirtyDate) && typeof dirtyDate !== 'number') {
    return false;
  }

  var date = toDate$1(dirtyDate);
  return !isNaN(Number(date));
}

function toInteger$1(dirtyNumber) {
  if (dirtyNumber === null || dirtyNumber === true || dirtyNumber === false) {
    return NaN;
  }

  var number = Number(dirtyNumber);

  if (isNaN(number)) {
    return number;
  }

  return number < 0 ? Math.ceil(number) : Math.floor(number);
}
/**
 * @name addMilliseconds
 * @category Millisecond Helpers
 * @summary Add the specified number of milliseconds to the given date.
 *
 * @description
 * Add the specified number of milliseconds to the given date.
 *
 * @param {Date|Number} date - the date to be changed
 * @param {Number} amount - the amount of milliseconds to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.
 * @returns {Date} the new date with the milliseconds added
 * @throws {TypeError} 2 arguments required
 *
 * @example
 * // Add 750 milliseconds to 10 July 2014 12:45:30.000:
 * const result = addMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)
 * //=> Thu Jul 10 2014 12:45:30.750
 */


function addMilliseconds$1(dirtyDate, dirtyAmount) {
  requiredArgs$1(2, arguments);
  var timestamp = toDate$1(dirtyDate).getTime();
  var amount = toInteger$1(dirtyAmount);
  return new Date(timestamp + amount);
}
/**
 * @name subMilliseconds
 * @category Millisecond Helpers
 * @summary Subtract the specified number of milliseconds from the given date.
 *
 * @description
 * Subtract the specified number of milliseconds from the given date.
 *
 * @param {Date|Number} date - the date to be changed
 * @param {Number} amount - the amount of milliseconds to be subtracted. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.
 * @returns {Date} the new date with the milliseconds subtracted
 * @throws {TypeError} 2 arguments required
 *
 * @example
 * // Subtract 750 milliseconds from 10 July 2014 12:45:30.000:
 * const result = subMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)
 * //=> Thu Jul 10 2014 12:45:29.250
 */


function subMilliseconds$1(dirtyDate, dirtyAmount) {
  requiredArgs$1(2, arguments);
  var amount = toInteger$1(dirtyAmount);
  return addMilliseconds$1(dirtyDate, -amount);
}

var MILLISECONDS_IN_DAY$1 = 86400000;

function getUTCDayOfYear$1(dirtyDate) {
  requiredArgs$1(1, arguments);
  var date = toDate$1(dirtyDate);
  var timestamp = date.getTime();
  date.setUTCMonth(0, 1);
  date.setUTCHours(0, 0, 0, 0);
  var startOfYearTimestamp = date.getTime();
  var difference = timestamp - startOfYearTimestamp;
  return Math.floor(difference / MILLISECONDS_IN_DAY$1) + 1;
}

function startOfUTCISOWeek$1(dirtyDate) {
  requiredArgs$1(1, arguments);
  var weekStartsOn = 1;
  var date = toDate$1(dirtyDate);
  var day = date.getUTCDay();
  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;
  date.setUTCDate(date.getUTCDate() - diff);
  date.setUTCHours(0, 0, 0, 0);
  return date;
}

function getUTCISOWeekYear$1(dirtyDate) {
  requiredArgs$1(1, arguments);
  var date = toDate$1(dirtyDate);
  var year = date.getUTCFullYear();
  var fourthOfJanuaryOfNextYear = new Date(0);
  fourthOfJanuaryOfNextYear.setUTCFullYear(year + 1, 0, 4);
  fourthOfJanuaryOfNextYear.setUTCHours(0, 0, 0, 0);
  var startOfNextYear = startOfUTCISOWeek$1(fourthOfJanuaryOfNextYear);
  var fourthOfJanuaryOfThisYear = new Date(0);
  fourthOfJanuaryOfThisYear.setUTCFullYear(year, 0, 4);
  fourthOfJanuaryOfThisYear.setUTCHours(0, 0, 0, 0);
  var startOfThisYear = startOfUTCISOWeek$1(fourthOfJanuaryOfThisYear);

  if (date.getTime() >= startOfNextYear.getTime()) {
    return year + 1;
  } else if (date.getTime() >= startOfThisYear.getTime()) {
    return year;
  } else {
    return year - 1;
  }
}

function startOfUTCISOWeekYear$1(dirtyDate) {
  requiredArgs$1(1, arguments);
  var year = getUTCISOWeekYear$1(dirtyDate);
  var fourthOfJanuary = new Date(0);
  fourthOfJanuary.setUTCFullYear(year, 0, 4);
  fourthOfJanuary.setUTCHours(0, 0, 0, 0);
  var date = startOfUTCISOWeek$1(fourthOfJanuary);
  return date;
}

var MILLISECONDS_IN_WEEK$1$1 = 604800000;

function getUTCISOWeek$1(dirtyDate) {
  requiredArgs$1(1, arguments);
  var date = toDate$1(dirtyDate);
  var diff = startOfUTCISOWeek$1(date).getTime() - startOfUTCISOWeekYear$1(date).getTime(); // Round the number of days to the nearest integer
  // because the number of milliseconds in a week is not constant
  // (e.g. it's different in the week of the daylight saving time clock shift)

  return Math.round(diff / MILLISECONDS_IN_WEEK$1$1) + 1;
}

var defaultOptions$1 = {};

function getDefaultOptions$1() {
  return defaultOptions$1;
}

function startOfUTCWeek$1(dirtyDate, options) {
  var _ref, _ref2, _ref3, _options$weekStartsOn, _options$locale, _options$locale$optio, _defaultOptions$local, _defaultOptions$local2;

  requiredArgs$1(1, arguments);
  var defaultOptions = getDefaultOptions$1();
  var weekStartsOn = toInteger$1((_ref = (_ref2 = (_ref3 = (_options$weekStartsOn = options === null || options === void 0 ? void 0 : options.weekStartsOn) !== null && _options$weekStartsOn !== void 0 ? _options$weekStartsOn : options === null || options === void 0 ? void 0 : (_options$locale = options.locale) === null || _options$locale === void 0 ? void 0 : (_options$locale$optio = _options$locale.options) === null || _options$locale$optio === void 0 ? void 0 : _options$locale$optio.weekStartsOn) !== null && _ref3 !== void 0 ? _ref3 : defaultOptions.weekStartsOn) !== null && _ref2 !== void 0 ? _ref2 : (_defaultOptions$local = defaultOptions.locale) === null || _defaultOptions$local === void 0 ? void 0 : (_defaultOptions$local2 = _defaultOptions$local.options) === null || _defaultOptions$local2 === void 0 ? void 0 : _defaultOptions$local2.weekStartsOn) !== null && _ref !== void 0 ? _ref : 0); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN

  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {
    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');
  }

  var date = toDate$1(dirtyDate);
  var day = date.getUTCDay();
  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;
  date.setUTCDate(date.getUTCDate() - diff);
  date.setUTCHours(0, 0, 0, 0);
  return date;
}

function getUTCWeekYear$1(dirtyDate, options) {
  var _ref, _ref2, _ref3, _options$firstWeekCon, _options$locale, _options$locale$optio, _defaultOptions$local, _defaultOptions$local2;

  requiredArgs$1(1, arguments);
  var date = toDate$1(dirtyDate);
  var year = date.getUTCFullYear();
  var defaultOptions = getDefaultOptions$1();
  var firstWeekContainsDate = toInteger$1((_ref = (_ref2 = (_ref3 = (_options$firstWeekCon = options === null || options === void 0 ? void 0 : options.firstWeekContainsDate) !== null && _options$firstWeekCon !== void 0 ? _options$firstWeekCon : options === null || options === void 0 ? void 0 : (_options$locale = options.locale) === null || _options$locale === void 0 ? void 0 : (_options$locale$optio = _options$locale.options) === null || _options$locale$optio === void 0 ? void 0 : _options$locale$optio.firstWeekContainsDate) !== null && _ref3 !== void 0 ? _ref3 : defaultOptions.firstWeekContainsDate) !== null && _ref2 !== void 0 ? _ref2 : (_defaultOptions$local = defaultOptions.locale) === null || _defaultOptions$local === void 0 ? void 0 : (_defaultOptions$local2 = _defaultOptions$local.options) === null || _defaultOptions$local2 === void 0 ? void 0 : _defaultOptions$local2.firstWeekContainsDate) !== null && _ref !== void 0 ? _ref : 1); // Test if weekStartsOn is between 1 and 7 _and_ is not NaN

  if (!(firstWeekContainsDate >= 1 && firstWeekContainsDate <= 7)) {
    throw new RangeError('firstWeekContainsDate must be between 1 and 7 inclusively');
  }

  var firstWeekOfNextYear = new Date(0);
  firstWeekOfNextYear.setUTCFullYear(year + 1, 0, firstWeekContainsDate);
  firstWeekOfNextYear.setUTCHours(0, 0, 0, 0);
  var startOfNextYear = startOfUTCWeek$1(firstWeekOfNextYear, options);
  var firstWeekOfThisYear = new Date(0);
  firstWeekOfThisYear.setUTCFullYear(year, 0, firstWeekContainsDate);
  firstWeekOfThisYear.setUTCHours(0, 0, 0, 0);
  var startOfThisYear = startOfUTCWeek$1(firstWeekOfThisYear, options);

  if (date.getTime() >= startOfNextYear.getTime()) {
    return year + 1;
  } else if (date.getTime() >= startOfThisYear.getTime()) {
    return year;
  } else {
    return year - 1;
  }
}

function startOfUTCWeekYear$1(dirtyDate, options) {
  var _ref, _ref2, _ref3, _options$firstWeekCon, _options$locale, _options$locale$optio, _defaultOptions$local, _defaultOptions$local2;

  requiredArgs$1(1, arguments);
  var defaultOptions = getDefaultOptions$1();
  var firstWeekContainsDate = toInteger$1((_ref = (_ref2 = (_ref3 = (_options$firstWeekCon = options === null || options === void 0 ? void 0 : options.firstWeekContainsDate) !== null && _options$firstWeekCon !== void 0 ? _options$firstWeekCon : options === null || options === void 0 ? void 0 : (_options$locale = options.locale) === null || _options$locale === void 0 ? void 0 : (_options$locale$optio = _options$locale.options) === null || _options$locale$optio === void 0 ? void 0 : _options$locale$optio.firstWeekContainsDate) !== null && _ref3 !== void 0 ? _ref3 : defaultOptions.firstWeekContainsDate) !== null && _ref2 !== void 0 ? _ref2 : (_defaultOptions$local = defaultOptions.locale) === null || _defaultOptions$local === void 0 ? void 0 : (_defaultOptions$local2 = _defaultOptions$local.options) === null || _defaultOptions$local2 === void 0 ? void 0 : _defaultOptions$local2.firstWeekContainsDate) !== null && _ref !== void 0 ? _ref : 1);
  var year = getUTCWeekYear$1(dirtyDate, options);
  var firstWeek = new Date(0);
  firstWeek.setUTCFullYear(year, 0, firstWeekContainsDate);
  firstWeek.setUTCHours(0, 0, 0, 0);
  var date = startOfUTCWeek$1(firstWeek, options);
  return date;
}

var MILLISECONDS_IN_WEEK$2 = 604800000;

function getUTCWeek$1(dirtyDate, options) {
  requiredArgs$1(1, arguments);
  var date = toDate$1(dirtyDate);
  var diff = startOfUTCWeek$1(date, options).getTime() - startOfUTCWeekYear$1(date, options).getTime(); // Round the number of days to the nearest integer
  // because the number of milliseconds in a week is not constant
  // (e.g. it's different in the week of the daylight saving time clock shift)

  return Math.round(diff / MILLISECONDS_IN_WEEK$2) + 1;
}

function addLeadingZeros$1(number, targetLength) {
  var sign = number < 0 ? '-' : '';
  var output = Math.abs(number).toString();

  while (output.length < targetLength) {
    output = '0' + output;
  }

  return sign + output;
}
/*
 * |     | Unit                           |     | Unit                           |
 * |-----|--------------------------------|-----|--------------------------------|
 * |  a  | AM, PM                         |  A* |                                |
 * |  d  | Day of month                   |  D  |                                |
 * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |
 * |  m  | Minute                         |  M  | Month                          |
 * |  s  | Second                         |  S  | Fraction of second             |
 * |  y  | Year (abs)                     |  Y  |                                |
 *
 * Letters marked by * are not implemented but reserved by Unicode standard.
 */


var formatters$2$1 = {
  // Year
  y: function y(date, token) {
    // From http://www.unicode.org/reports/tr35/tr35-31/tr35-dates.html#Date_Format_tokens
    // | Year     |     y | yy |   yyy |  yyyy | yyyyy |
    // |----------|-------|----|-------|-------|-------|
    // | AD 1     |     1 | 01 |   001 |  0001 | 00001 |
    // | AD 12    |    12 | 12 |   012 |  0012 | 00012 |
    // | AD 123   |   123 | 23 |   123 |  0123 | 00123 |
    // | AD 1234  |  1234 | 34 |  1234 |  1234 | 01234 |
    // | AD 12345 | 12345 | 45 | 12345 | 12345 | 12345 |
    var signedYear = date.getUTCFullYear(); // Returns 1 for 1 BC (which is year 0 in JavaScript)

    var year = signedYear > 0 ? signedYear : 1 - signedYear;
    return addLeadingZeros$1(token === 'yy' ? year % 100 : year, token.length);
  },
  // Month
  M: function M(date, token) {
    var month = date.getUTCMonth();
    return token === 'M' ? String(month + 1) : addLeadingZeros$1(month + 1, 2);
  },
  // Day of the month
  d: function d(date, token) {
    return addLeadingZeros$1(date.getUTCDate(), token.length);
  },
  // AM or PM
  a: function a(date, token) {
    var dayPeriodEnumValue = date.getUTCHours() / 12 >= 1 ? 'pm' : 'am';

    switch (token) {
      case 'a':
      case 'aa':
        return dayPeriodEnumValue.toUpperCase();

      case 'aaa':
        return dayPeriodEnumValue;

      case 'aaaaa':
        return dayPeriodEnumValue[0];

      case 'aaaa':
      default:
        return dayPeriodEnumValue === 'am' ? 'a.m.' : 'p.m.';
    }
  },
  // Hour [1-12]
  h: function h(date, token) {
    return addLeadingZeros$1(date.getUTCHours() % 12 || 12, token.length);
  },
  // Hour [0-23]
  H: function H(date, token) {
    return addLeadingZeros$1(date.getUTCHours(), token.length);
  },
  // Minute
  m: function m(date, token) {
    return addLeadingZeros$1(date.getUTCMinutes(), token.length);
  },
  // Second
  s: function s(date, token) {
    return addLeadingZeros$1(date.getUTCSeconds(), token.length);
  },
  // Fraction of second
  S: function S(date, token) {
    var numberOfDigits = token.length;
    var milliseconds = date.getUTCMilliseconds();
    var fractionalSeconds = Math.floor(milliseconds * Math.pow(10, numberOfDigits - 3));
    return addLeadingZeros$1(fractionalSeconds, token.length);
  }
};
var dayPeriodEnum$1 = {
  am: 'am',
  pm: 'pm',
  midnight: 'midnight',
  noon: 'noon',
  morning: 'morning',
  afternoon: 'afternoon',
  evening: 'evening',
  night: 'night'
};
/*
 * |     | Unit                           |     | Unit                           |
 * |-----|--------------------------------|-----|--------------------------------|
 * |  a  | AM, PM                         |  A* | Milliseconds in day            |
 * |  b  | AM, PM, noon, midnight         |  B  | Flexible day period            |
 * |  c  | Stand-alone local day of week  |  C* | Localized hour w/ day period   |
 * |  d  | Day of month                   |  D  | Day of year                    |
 * |  e  | Local day of week              |  E  | Day of week                    |
 * |  f  |                                |  F* | Day of week in month           |
 * |  g* | Modified Julian day            |  G  | Era                            |
 * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |
 * |  i! | ISO day of week                |  I! | ISO week of year               |
 * |  j* | Localized hour w/ day period   |  J* | Localized hour w/o day period  |
 * |  k  | Hour [1-24]                    |  K  | Hour [0-11]                    |
 * |  l* | (deprecated)                   |  L  | Stand-alone month              |
 * |  m  | Minute                         |  M  | Month                          |
 * |  n  |                                |  N  |                                |
 * |  o! | Ordinal number modifier        |  O  | Timezone (GMT)                 |
 * |  p! | Long localized time            |  P! | Long localized date            |
 * |  q  | Stand-alone quarter            |  Q  | Quarter                        |
 * |  r* | Related Gregorian year         |  R! | ISO week-numbering year        |
 * |  s  | Second                         |  S  | Fraction of second             |
 * |  t! | Seconds timestamp              |  T! | Milliseconds timestamp         |
 * |  u  | Extended year                  |  U* | Cyclic year                    |
 * |  v* | Timezone (generic non-locat.)  |  V* | Timezone (location)            |
 * |  w  | Local week of year             |  W* | Week of month                  |
 * |  x  | Timezone (ISO-8601 w/o Z)      |  X  | Timezone (ISO-8601)            |
 * |  y  | Year (abs)                     |  Y  | Local week-numbering year      |
 * |  z  | Timezone (specific non-locat.) |  Z* | Timezone (aliases)             |
 *
 * Letters marked by * are not implemented but reserved by Unicode standard.
 *
 * Letters marked by ! are non-standard, but implemented by date-fns:
 * - `o` modifies the previous token to turn it into an ordinal (see `format` docs)
 * - `i` is ISO day of week. For `i` and `ii` is returns numeric ISO week days,
 *   i.e. 7 for Sunday, 1 for Monday, etc.
 * - `I` is ISO week of year, as opposed to `w` which is local week of year.
 * - `R` is ISO week-numbering year, as opposed to `Y` which is local week-numbering year.
 *   `R` is supposed to be used in conjunction with `I` and `i`
 *   for universal ISO week-numbering date, whereas
 *   `Y` is supposed to be used in conjunction with `w` and `e`
 *   for week-numbering date specific to the locale.
 * - `P` is long localized date format
 * - `p` is long localized time format
 */

var formatters$3 = {
  // Era
  G: function G(date, token, localize) {
    var era = date.getUTCFullYear() > 0 ? 1 : 0;

    switch (token) {
      // AD, BC
      case 'G':
      case 'GG':
      case 'GGG':
        return localize.era(era, {
          width: 'abbreviated'
        });
      // A, B

      case 'GGGGG':
        return localize.era(era, {
          width: 'narrow'
        });
      // Anno Domini, Before Christ

      case 'GGGG':
      default:
        return localize.era(era, {
          width: 'wide'
        });
    }
  },
  // Year
  y: function y(date, token, localize) {
    // Ordinal number
    if (token === 'yo') {
      var signedYear = date.getUTCFullYear(); // Returns 1 for 1 BC (which is year 0 in JavaScript)

      var year = signedYear > 0 ? signedYear : 1 - signedYear;
      return localize.ordinalNumber(year, {
        unit: 'year'
      });
    }

    return formatters$2$1.y(date, token);
  },
  // Local week-numbering year
  Y: function Y(date, token, localize, options) {
    var signedWeekYear = getUTCWeekYear$1(date, options); // Returns 1 for 1 BC (which is year 0 in JavaScript)

    var weekYear = signedWeekYear > 0 ? signedWeekYear : 1 - signedWeekYear; // Two digit year

    if (token === 'YY') {
      var twoDigitYear = weekYear % 100;
      return addLeadingZeros$1(twoDigitYear, 2);
    } // Ordinal number


    if (token === 'Yo') {
      return localize.ordinalNumber(weekYear, {
        unit: 'year'
      });
    } // Padding


    return addLeadingZeros$1(weekYear, token.length);
  },
  // ISO week-numbering year
  R: function R(date, token) {
    var isoWeekYear = getUTCISOWeekYear$1(date); // Padding

    return addLeadingZeros$1(isoWeekYear, token.length);
  },
  // Extended year. This is a single number designating the year of this calendar system.
  // The main difference between `y` and `u` localizers are B.C. years:
  // | Year | `y` | `u` |
  // |------|-----|-----|
  // | AC 1 |   1 |   1 |
  // | BC 1 |   1 |   0 |
  // | BC 2 |   2 |  -1 |
  // Also `yy` always returns the last two digits of a year,
  // while `uu` pads single digit years to 2 characters and returns other years unchanged.
  u: function u(date, token) {
    var year = date.getUTCFullYear();
    return addLeadingZeros$1(year, token.length);
  },
  // Quarter
  Q: function Q(date, token, localize) {
    var quarter = Math.ceil((date.getUTCMonth() + 1) / 3);

    switch (token) {
      // 1, 2, 3, 4
      case 'Q':
        return String(quarter);
      // 01, 02, 03, 04

      case 'QQ':
        return addLeadingZeros$1(quarter, 2);
      // 1st, 2nd, 3rd, 4th

      case 'Qo':
        return localize.ordinalNumber(quarter, {
          unit: 'quarter'
        });
      // Q1, Q2, Q3, Q4

      case 'QQQ':
        return localize.quarter(quarter, {
          width: 'abbreviated',
          context: 'formatting'
        });
      // 1, 2, 3, 4 (narrow quarter; could be not numerical)

      case 'QQQQQ':
        return localize.quarter(quarter, {
          width: 'narrow',
          context: 'formatting'
        });
      // 1st quarter, 2nd quarter, ...

      case 'QQQQ':
      default:
        return localize.quarter(quarter, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // Stand-alone quarter
  q: function q(date, token, localize) {
    var quarter = Math.ceil((date.getUTCMonth() + 1) / 3);

    switch (token) {
      // 1, 2, 3, 4
      case 'q':
        return String(quarter);
      // 01, 02, 03, 04

      case 'qq':
        return addLeadingZeros$1(quarter, 2);
      // 1st, 2nd, 3rd, 4th

      case 'qo':
        return localize.ordinalNumber(quarter, {
          unit: 'quarter'
        });
      // Q1, Q2, Q3, Q4

      case 'qqq':
        return localize.quarter(quarter, {
          width: 'abbreviated',
          context: 'standalone'
        });
      // 1, 2, 3, 4 (narrow quarter; could be not numerical)

      case 'qqqqq':
        return localize.quarter(quarter, {
          width: 'narrow',
          context: 'standalone'
        });
      // 1st quarter, 2nd quarter, ...

      case 'qqqq':
      default:
        return localize.quarter(quarter, {
          width: 'wide',
          context: 'standalone'
        });
    }
  },
  // Month
  M: function M(date, token, localize) {
    var month = date.getUTCMonth();

    switch (token) {
      case 'M':
      case 'MM':
        return formatters$2$1.M(date, token);
      // 1st, 2nd, ..., 12th

      case 'Mo':
        return localize.ordinalNumber(month + 1, {
          unit: 'month'
        });
      // Jan, Feb, ..., Dec

      case 'MMM':
        return localize.month(month, {
          width: 'abbreviated',
          context: 'formatting'
        });
      // J, F, ..., D

      case 'MMMMM':
        return localize.month(month, {
          width: 'narrow',
          context: 'formatting'
        });
      // January, February, ..., December

      case 'MMMM':
      default:
        return localize.month(month, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // Stand-alone month
  L: function L(date, token, localize) {
    var month = date.getUTCMonth();

    switch (token) {
      // 1, 2, ..., 12
      case 'L':
        return String(month + 1);
      // 01, 02, ..., 12

      case 'LL':
        return addLeadingZeros$1(month + 1, 2);
      // 1st, 2nd, ..., 12th

      case 'Lo':
        return localize.ordinalNumber(month + 1, {
          unit: 'month'
        });
      // Jan, Feb, ..., Dec

      case 'LLL':
        return localize.month(month, {
          width: 'abbreviated',
          context: 'standalone'
        });
      // J, F, ..., D

      case 'LLLLL':
        return localize.month(month, {
          width: 'narrow',
          context: 'standalone'
        });
      // January, February, ..., December

      case 'LLLL':
      default:
        return localize.month(month, {
          width: 'wide',
          context: 'standalone'
        });
    }
  },
  // Local week of year
  w: function w(date, token, localize, options) {
    var week = getUTCWeek$1(date, options);

    if (token === 'wo') {
      return localize.ordinalNumber(week, {
        unit: 'week'
      });
    }

    return addLeadingZeros$1(week, token.length);
  },
  // ISO week of year
  I: function I(date, token, localize) {
    var isoWeek = getUTCISOWeek$1(date);

    if (token === 'Io') {
      return localize.ordinalNumber(isoWeek, {
        unit: 'week'
      });
    }

    return addLeadingZeros$1(isoWeek, token.length);
  },
  // Day of the month
  d: function d(date, token, localize) {
    if (token === 'do') {
      return localize.ordinalNumber(date.getUTCDate(), {
        unit: 'date'
      });
    }

    return formatters$2$1.d(date, token);
  },
  // Day of year
  D: function D(date, token, localize) {
    var dayOfYear = getUTCDayOfYear$1(date);

    if (token === 'Do') {
      return localize.ordinalNumber(dayOfYear, {
        unit: 'dayOfYear'
      });
    }

    return addLeadingZeros$1(dayOfYear, token.length);
  },
  // Day of week
  E: function E(date, token, localize) {
    var dayOfWeek = date.getUTCDay();

    switch (token) {
      // Tue
      case 'E':
      case 'EE':
      case 'EEE':
        return localize.day(dayOfWeek, {
          width: 'abbreviated',
          context: 'formatting'
        });
      // T

      case 'EEEEE':
        return localize.day(dayOfWeek, {
          width: 'narrow',
          context: 'formatting'
        });
      // Tu

      case 'EEEEEE':
        return localize.day(dayOfWeek, {
          width: 'short',
          context: 'formatting'
        });
      // Tuesday

      case 'EEEE':
      default:
        return localize.day(dayOfWeek, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // Local day of week
  e: function e(date, token, localize, options) {
    var dayOfWeek = date.getUTCDay();
    var localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;

    switch (token) {
      // Numerical value (Nth day of week with current locale or weekStartsOn)
      case 'e':
        return String(localDayOfWeek);
      // Padded numerical value

      case 'ee':
        return addLeadingZeros$1(localDayOfWeek, 2);
      // 1st, 2nd, ..., 7th

      case 'eo':
        return localize.ordinalNumber(localDayOfWeek, {
          unit: 'day'
        });

      case 'eee':
        return localize.day(dayOfWeek, {
          width: 'abbreviated',
          context: 'formatting'
        });
      // T

      case 'eeeee':
        return localize.day(dayOfWeek, {
          width: 'narrow',
          context: 'formatting'
        });
      // Tu

      case 'eeeeee':
        return localize.day(dayOfWeek, {
          width: 'short',
          context: 'formatting'
        });
      // Tuesday

      case 'eeee':
      default:
        return localize.day(dayOfWeek, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // Stand-alone local day of week
  c: function c(date, token, localize, options) {
    var dayOfWeek = date.getUTCDay();
    var localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;

    switch (token) {
      // Numerical value (same as in `e`)
      case 'c':
        return String(localDayOfWeek);
      // Padded numerical value

      case 'cc':
        return addLeadingZeros$1(localDayOfWeek, token.length);
      // 1st, 2nd, ..., 7th

      case 'co':
        return localize.ordinalNumber(localDayOfWeek, {
          unit: 'day'
        });

      case 'ccc':
        return localize.day(dayOfWeek, {
          width: 'abbreviated',
          context: 'standalone'
        });
      // T

      case 'ccccc':
        return localize.day(dayOfWeek, {
          width: 'narrow',
          context: 'standalone'
        });
      // Tu

      case 'cccccc':
        return localize.day(dayOfWeek, {
          width: 'short',
          context: 'standalone'
        });
      // Tuesday

      case 'cccc':
      default:
        return localize.day(dayOfWeek, {
          width: 'wide',
          context: 'standalone'
        });
    }
  },
  // ISO day of week
  i: function i(date, token, localize) {
    var dayOfWeek = date.getUTCDay();
    var isoDayOfWeek = dayOfWeek === 0 ? 7 : dayOfWeek;

    switch (token) {
      // 2
      case 'i':
        return String(isoDayOfWeek);
      // 02

      case 'ii':
        return addLeadingZeros$1(isoDayOfWeek, token.length);
      // 2nd

      case 'io':
        return localize.ordinalNumber(isoDayOfWeek, {
          unit: 'day'
        });
      // Tue

      case 'iii':
        return localize.day(dayOfWeek, {
          width: 'abbreviated',
          context: 'formatting'
        });
      // T

      case 'iiiii':
        return localize.day(dayOfWeek, {
          width: 'narrow',
          context: 'formatting'
        });
      // Tu

      case 'iiiiii':
        return localize.day(dayOfWeek, {
          width: 'short',
          context: 'formatting'
        });
      // Tuesday

      case 'iiii':
      default:
        return localize.day(dayOfWeek, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // AM or PM
  a: function a(date, token, localize) {
    var hours = date.getUTCHours();
    var dayPeriodEnumValue = hours / 12 >= 1 ? 'pm' : 'am';

    switch (token) {
      case 'a':
      case 'aa':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'abbreviated',
          context: 'formatting'
        });

      case 'aaa':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'abbreviated',
          context: 'formatting'
        }).toLowerCase();

      case 'aaaaa':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'narrow',
          context: 'formatting'
        });

      case 'aaaa':
      default:
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // AM, PM, midnight, noon
  b: function b(date, token, localize) {
    var hours = date.getUTCHours();
    var dayPeriodEnumValue;

    if (hours === 12) {
      dayPeriodEnumValue = dayPeriodEnum$1.noon;
    } else if (hours === 0) {
      dayPeriodEnumValue = dayPeriodEnum$1.midnight;
    } else {
      dayPeriodEnumValue = hours / 12 >= 1 ? 'pm' : 'am';
    }

    switch (token) {
      case 'b':
      case 'bb':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'abbreviated',
          context: 'formatting'
        });

      case 'bbb':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'abbreviated',
          context: 'formatting'
        }).toLowerCase();

      case 'bbbbb':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'narrow',
          context: 'formatting'
        });

      case 'bbbb':
      default:
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // in the morning, in the afternoon, in the evening, at night
  B: function B(date, token, localize) {
    var hours = date.getUTCHours();
    var dayPeriodEnumValue;

    if (hours >= 17) {
      dayPeriodEnumValue = dayPeriodEnum$1.evening;
    } else if (hours >= 12) {
      dayPeriodEnumValue = dayPeriodEnum$1.afternoon;
    } else if (hours >= 4) {
      dayPeriodEnumValue = dayPeriodEnum$1.morning;
    } else {
      dayPeriodEnumValue = dayPeriodEnum$1.night;
    }

    switch (token) {
      case 'B':
      case 'BB':
      case 'BBB':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'abbreviated',
          context: 'formatting'
        });

      case 'BBBBB':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'narrow',
          context: 'formatting'
        });

      case 'BBBB':
      default:
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // Hour [1-12]
  h: function h(date, token, localize) {
    if (token === 'ho') {
      var hours = date.getUTCHours() % 12;
      if (hours === 0) hours = 12;
      return localize.ordinalNumber(hours, {
        unit: 'hour'
      });
    }

    return formatters$2$1.h(date, token);
  },
  // Hour [0-23]
  H: function H(date, token, localize) {
    if (token === 'Ho') {
      return localize.ordinalNumber(date.getUTCHours(), {
        unit: 'hour'
      });
    }

    return formatters$2$1.H(date, token);
  },
  // Hour [0-11]
  K: function K(date, token, localize) {
    var hours = date.getUTCHours() % 12;

    if (token === 'Ko') {
      return localize.ordinalNumber(hours, {
        unit: 'hour'
      });
    }

    return addLeadingZeros$1(hours, token.length);
  },
  // Hour [1-24]
  k: function k(date, token, localize) {
    var hours = date.getUTCHours();
    if (hours === 0) hours = 24;

    if (token === 'ko') {
      return localize.ordinalNumber(hours, {
        unit: 'hour'
      });
    }

    return addLeadingZeros$1(hours, token.length);
  },
  // Minute
  m: function m(date, token, localize) {
    if (token === 'mo') {
      return localize.ordinalNumber(date.getUTCMinutes(), {
        unit: 'minute'
      });
    }

    return formatters$2$1.m(date, token);
  },
  // Second
  s: function s(date, token, localize) {
    if (token === 'so') {
      return localize.ordinalNumber(date.getUTCSeconds(), {
        unit: 'second'
      });
    }

    return formatters$2$1.s(date, token);
  },
  // Fraction of second
  S: function S(date, token) {
    return formatters$2$1.S(date, token);
  },
  // Timezone (ISO-8601. If offset is 0, output is always `'Z'`)
  X: function X(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timezoneOffset = originalDate.getTimezoneOffset();

    if (timezoneOffset === 0) {
      return 'Z';
    }

    switch (token) {
      // Hours and optional minutes
      case 'X':
        return formatTimezoneWithOptionalMinutes$1(timezoneOffset);
      // Hours, minutes and optional seconds without `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `XX`

      case 'XXXX':
      case 'XX':
        // Hours and minutes without `:` delimiter
        return formatTimezone$1(timezoneOffset);
      // Hours, minutes and optional seconds with `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `XXX`

      case 'XXXXX':
      case 'XXX': // Hours and minutes with `:` delimiter

      default:
        return formatTimezone$1(timezoneOffset, ':');
    }
  },
  // Timezone (ISO-8601. If offset is 0, output is `'+00:00'` or equivalent)
  x: function x(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timezoneOffset = originalDate.getTimezoneOffset();

    switch (token) {
      // Hours and optional minutes
      case 'x':
        return formatTimezoneWithOptionalMinutes$1(timezoneOffset);
      // Hours, minutes and optional seconds without `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `xx`

      case 'xxxx':
      case 'xx':
        // Hours and minutes without `:` delimiter
        return formatTimezone$1(timezoneOffset);
      // Hours, minutes and optional seconds with `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `xxx`

      case 'xxxxx':
      case 'xxx': // Hours and minutes with `:` delimiter

      default:
        return formatTimezone$1(timezoneOffset, ':');
    }
  },
  // Timezone (GMT)
  O: function O(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timezoneOffset = originalDate.getTimezoneOffset();

    switch (token) {
      // Short
      case 'O':
      case 'OO':
      case 'OOO':
        return 'GMT' + formatTimezoneShort$1(timezoneOffset, ':');
      // Long

      case 'OOOO':
      default:
        return 'GMT' + formatTimezone$1(timezoneOffset, ':');
    }
  },
  // Timezone (specific non-location)
  z: function z(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timezoneOffset = originalDate.getTimezoneOffset();

    switch (token) {
      // Short
      case 'z':
      case 'zz':
      case 'zzz':
        return 'GMT' + formatTimezoneShort$1(timezoneOffset, ':');
      // Long

      case 'zzzz':
      default:
        return 'GMT' + formatTimezone$1(timezoneOffset, ':');
    }
  },
  // Seconds timestamp
  t: function t(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timestamp = Math.floor(originalDate.getTime() / 1000);
    return addLeadingZeros$1(timestamp, token.length);
  },
  // Milliseconds timestamp
  T: function T(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timestamp = originalDate.getTime();
    return addLeadingZeros$1(timestamp, token.length);
  }
};

function formatTimezoneShort$1(offset, dirtyDelimiter) {
  var sign = offset > 0 ? '-' : '+';
  var absOffset = Math.abs(offset);
  var hours = Math.floor(absOffset / 60);
  var minutes = absOffset % 60;

  if (minutes === 0) {
    return sign + String(hours);
  }

  var delimiter = dirtyDelimiter || '';
  return sign + String(hours) + delimiter + addLeadingZeros$1(minutes, 2);
}

function formatTimezoneWithOptionalMinutes$1(offset, dirtyDelimiter) {
  if (offset % 60 === 0) {
    var sign = offset > 0 ? '-' : '+';
    return sign + addLeadingZeros$1(Math.abs(offset) / 60, 2);
  }

  return formatTimezone$1(offset, dirtyDelimiter);
}

function formatTimezone$1(offset, dirtyDelimiter) {
  var delimiter = dirtyDelimiter || '';
  var sign = offset > 0 ? '-' : '+';
  var absOffset = Math.abs(offset);
  var hours = addLeadingZeros$1(Math.floor(absOffset / 60), 2);
  var minutes = addLeadingZeros$1(absOffset % 60, 2);
  return sign + hours + delimiter + minutes;
}

var formatters$1$1 = formatters$3;

var dateLongFormatter$1 = function dateLongFormatter(pattern, formatLong) {
  switch (pattern) {
    case 'P':
      return formatLong.date({
        width: 'short'
      });

    case 'PP':
      return formatLong.date({
        width: 'medium'
      });

    case 'PPP':
      return formatLong.date({
        width: 'long'
      });

    case 'PPPP':
    default:
      return formatLong.date({
        width: 'full'
      });
  }
};

var timeLongFormatter$1 = function timeLongFormatter(pattern, formatLong) {
  switch (pattern) {
    case 'p':
      return formatLong.time({
        width: 'short'
      });

    case 'pp':
      return formatLong.time({
        width: 'medium'
      });

    case 'ppp':
      return formatLong.time({
        width: 'long'
      });

    case 'pppp':
    default:
      return formatLong.time({
        width: 'full'
      });
  }
};

var dateTimeLongFormatter$1 = function dateTimeLongFormatter(pattern, formatLong) {
  var matchResult = pattern.match(/(P+)(p+)?/) || [];
  var datePattern = matchResult[1];
  var timePattern = matchResult[2];

  if (!timePattern) {
    return dateLongFormatter$1(pattern, formatLong);
  }

  var dateTimeFormat;

  switch (datePattern) {
    case 'P':
      dateTimeFormat = formatLong.dateTime({
        width: 'short'
      });
      break;

    case 'PP':
      dateTimeFormat = formatLong.dateTime({
        width: 'medium'
      });
      break;

    case 'PPP':
      dateTimeFormat = formatLong.dateTime({
        width: 'long'
      });
      break;

    case 'PPPP':
    default:
      dateTimeFormat = formatLong.dateTime({
        width: 'full'
      });
      break;
  }

  return dateTimeFormat.replace('{{date}}', dateLongFormatter$1(datePattern, formatLong)).replace('{{time}}', timeLongFormatter$1(timePattern, formatLong));
};

var longFormatters$2 = {
  p: timeLongFormatter$1,
  P: dateTimeLongFormatter$1
};
var longFormatters$1$1 = longFormatters$2;
/**
 * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.
 * They usually appear for dates that denote time before the timezones were introduced
 * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891
 * and GMT+01:00:00 after that date)
 *
 * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,
 * which would lead to incorrect calculations.
 *
 * This function returns the timezone offset in milliseconds that takes seconds in account.
 */

function getTimezoneOffsetInMilliseconds$1(date) {
  var utcDate = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds()));
  utcDate.setUTCFullYear(date.getFullYear());
  return date.getTime() - utcDate.getTime();
}

var protectedDayOfYearTokens$1 = ['D', 'DD'];
var protectedWeekYearTokens$1 = ['YY', 'YYYY'];

function isProtectedDayOfYearToken$1(token) {
  return protectedDayOfYearTokens$1.indexOf(token) !== -1;
}

function isProtectedWeekYearToken$1(token) {
  return protectedWeekYearTokens$1.indexOf(token) !== -1;
}

function throwProtectedError$1(token, format, input) {
  if (token === 'YYYY') {
    throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(format, "`) for formatting years to the input `").concat(input, "`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));
  } else if (token === 'YY') {
    throw new RangeError("Use `yy` instead of `YY` (in `".concat(format, "`) for formatting years to the input `").concat(input, "`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));
  } else if (token === 'D') {
    throw new RangeError("Use `d` instead of `D` (in `".concat(format, "`) for formatting days of the month to the input `").concat(input, "`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));
  } else if (token === 'DD') {
    throw new RangeError("Use `dd` instead of `DD` (in `".concat(format, "`) for formatting days of the month to the input `").concat(input, "`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));
  }
} // - [yYQqMLwIdDecihHKkms]o matches any available ordinal number token
//   (one of the certain letters followed by `o`)
// - (\w)\1* matches any sequences of the same letter
// - '' matches two quote characters in a row
// - '(''|[^'])+('|$) matches anything surrounded by two quote characters ('),
//   except a single quote symbol, which ends the sequence.
//   Two quote characters do not end the sequence.
//   If there is no matching single quote
//   then the sequence will continue until the end of the string.
// - . matches any single character unmatched by previous parts of the RegExps


var formattingTokensRegExp$1 = /[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g; // This RegExp catches symbols escaped by quotes, and also
// sequences of symbols P, p, and the combinations like `PPPPPPPppppp`

var longFormattingTokensRegExp$1 = /P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;
var escapedStringRegExp$1 = /^'([^]*?)'?$/;
var doubleQuoteRegExp$1 = /''/g;
var unescapedLatinCharacterRegExp$1 = /[a-zA-Z]/;
/**
 * @name format
 * @category Common Helpers
 * @summary Format the date.
 *
 * @description
 * Return the formatted date string in the given format. The result may vary by locale.
 *
 * > â ï¸ Please note that the `format` tokens differ from Moment.js and other libraries.
 * > See: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 *
 * The characters wrapped between two single quotes characters (') are escaped.
 * Two single quotes in a row, whether inside or outside a quoted sequence, represent a 'real' single quote.
 * (see the last example)
 *
 * Format of the string is based on Unicode Technical Standard #35:
 * https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table
 * with a few additions (see note 7 below the table).
 *
 * Accepted patterns:
 * | Unit                            | Pattern | Result examples                   | Notes |
 * |---------------------------------|---------|-----------------------------------|-------|
 * | Era                             | G..GGG  | AD, BC                            |       |
 * |                                 | GGGG    | Anno Domini, Before Christ        | 2     |
 * |                                 | GGGGG   | A, B                              |       |
 * | Calendar year                   | y       | 44, 1, 1900, 2017                 | 5     |
 * |                                 | yo      | 44th, 1st, 0th, 17th              | 5,7   |
 * |                                 | yy      | 44, 01, 00, 17                    | 5     |
 * |                                 | yyy     | 044, 001, 1900, 2017              | 5     |
 * |                                 | yyyy    | 0044, 0001, 1900, 2017            | 5     |
 * |                                 | yyyyy   | ...                               | 3,5   |
 * | Local week-numbering year       | Y       | 44, 1, 1900, 2017                 | 5     |
 * |                                 | Yo      | 44th, 1st, 1900th, 2017th         | 5,7   |
 * |                                 | YY      | 44, 01, 00, 17                    | 5,8   |
 * |                                 | YYY     | 044, 001, 1900, 2017              | 5     |
 * |                                 | YYYY    | 0044, 0001, 1900, 2017            | 5,8   |
 * |                                 | YYYYY   | ...                               | 3,5   |
 * | ISO week-numbering year         | R       | -43, 0, 1, 1900, 2017             | 5,7   |
 * |                                 | RR      | -43, 00, 01, 1900, 2017           | 5,7   |
 * |                                 | RRR     | -043, 000, 001, 1900, 2017        | 5,7   |
 * |                                 | RRRR    | -0043, 0000, 0001, 1900, 2017     | 5,7   |
 * |                                 | RRRRR   | ...                               | 3,5,7 |
 * | Extended year                   | u       | -43, 0, 1, 1900, 2017             | 5     |
 * |                                 | uu      | -43, 01, 1900, 2017               | 5     |
 * |                                 | uuu     | -043, 001, 1900, 2017             | 5     |
 * |                                 | uuuu    | -0043, 0001, 1900, 2017           | 5     |
 * |                                 | uuuuu   | ...                               | 3,5   |
 * | Quarter (formatting)            | Q       | 1, 2, 3, 4                        |       |
 * |                                 | Qo      | 1st, 2nd, 3rd, 4th                | 7     |
 * |                                 | QQ      | 01, 02, 03, 04                    |       |
 * |                                 | QQQ     | Q1, Q2, Q3, Q4                    |       |
 * |                                 | QQQQ    | 1st quarter, 2nd quarter, ...     | 2     |
 * |                                 | QQQQQ   | 1, 2, 3, 4                        | 4     |
 * | Quarter (stand-alone)           | q       | 1, 2, 3, 4                        |       |
 * |                                 | qo      | 1st, 2nd, 3rd, 4th                | 7     |
 * |                                 | qq      | 01, 02, 03, 04                    |       |
 * |                                 | qqq     | Q1, Q2, Q3, Q4                    |       |
 * |                                 | qqqq    | 1st quarter, 2nd quarter, ...     | 2     |
 * |                                 | qqqqq   | 1, 2, 3, 4                        | 4     |
 * | Month (formatting)              | M       | 1, 2, ..., 12                     |       |
 * |                                 | Mo      | 1st, 2nd, ..., 12th               | 7     |
 * |                                 | MM      | 01, 02, ..., 12                   |       |
 * |                                 | MMM     | Jan, Feb, ..., Dec                |       |
 * |                                 | MMMM    | January, February, ..., December  | 2     |
 * |                                 | MMMMM   | J, F, ..., D                      |       |
 * | Month (stand-alone)             | L       | 1, 2, ..., 12                     |       |
 * |                                 | Lo      | 1st, 2nd, ..., 12th               | 7     |
 * |                                 | LL      | 01, 02, ..., 12                   |       |
 * |                                 | LLL     | Jan, Feb, ..., Dec                |       |
 * |                                 | LLLL    | January, February, ..., December  | 2     |
 * |                                 | LLLLL   | J, F, ..., D                      |       |
 * | Local week of year              | w       | 1, 2, ..., 53                     |       |
 * |                                 | wo      | 1st, 2nd, ..., 53th               | 7     |
 * |                                 | ww      | 01, 02, ..., 53                   |       |
 * | ISO week of year                | I       | 1, 2, ..., 53                     | 7     |
 * |                                 | Io      | 1st, 2nd, ..., 53th               | 7     |
 * |                                 | II      | 01, 02, ..., 53                   | 7     |
 * | Day of month                    | d       | 1, 2, ..., 31                     |       |
 * |                                 | do      | 1st, 2nd, ..., 31st               | 7     |
 * |                                 | dd      | 01, 02, ..., 31                   |       |
 * | Day of year                     | D       | 1, 2, ..., 365, 366               | 9     |
 * |                                 | Do      | 1st, 2nd, ..., 365th, 366th       | 7     |
 * |                                 | DD      | 01, 02, ..., 365, 366             | 9     |
 * |                                 | DDD     | 001, 002, ..., 365, 366           |       |
 * |                                 | DDDD    | ...                               | 3     |
 * | Day of week (formatting)        | E..EEE  | Mon, Tue, Wed, ..., Sun           |       |
 * |                                 | EEEE    | Monday, Tuesday, ..., Sunday      | 2     |
 * |                                 | EEEEE   | M, T, W, T, F, S, S               |       |
 * |                                 | EEEEEE  | Mo, Tu, We, Th, Fr, Sa, Su        |       |
 * | ISO day of week (formatting)    | i       | 1, 2, 3, ..., 7                   | 7     |
 * |                                 | io      | 1st, 2nd, ..., 7th                | 7     |
 * |                                 | ii      | 01, 02, ..., 07                   | 7     |
 * |                                 | iii     | Mon, Tue, Wed, ..., Sun           | 7     |
 * |                                 | iiii    | Monday, Tuesday, ..., Sunday      | 2,7   |
 * |                                 | iiiii   | M, T, W, T, F, S, S               | 7     |
 * |                                 | iiiiii  | Mo, Tu, We, Th, Fr, Sa, Su        | 7     |
 * | Local day of week (formatting)  | e       | 2, 3, 4, ..., 1                   |       |
 * |                                 | eo      | 2nd, 3rd, ..., 1st                | 7     |
 * |                                 | ee      | 02, 03, ..., 01                   |       |
 * |                                 | eee     | Mon, Tue, Wed, ..., Sun           |       |
 * |                                 | eeee    | Monday, Tuesday, ..., Sunday      | 2     |
 * |                                 | eeeee   | M, T, W, T, F, S, S               |       |
 * |                                 | eeeeee  | Mo, Tu, We, Th, Fr, Sa, Su        |       |
 * | Local day of week (stand-alone) | c       | 2, 3, 4, ..., 1                   |       |
 * |                                 | co      | 2nd, 3rd, ..., 1st                | 7     |
 * |                                 | cc      | 02, 03, ..., 01                   |       |
 * |                                 | ccc     | Mon, Tue, Wed, ..., Sun           |       |
 * |                                 | cccc    | Monday, Tuesday, ..., Sunday      | 2     |
 * |                                 | ccccc   | M, T, W, T, F, S, S               |       |
 * |                                 | cccccc  | Mo, Tu, We, Th, Fr, Sa, Su        |       |
 * | AM, PM                          | a..aa   | AM, PM                            |       |
 * |                                 | aaa     | am, pm                            |       |
 * |                                 | aaaa    | a.m., p.m.                        | 2     |
 * |                                 | aaaaa   | a, p                              |       |
 * | AM, PM, noon, midnight          | b..bb   | AM, PM, noon, midnight            |       |
 * |                                 | bbb     | am, pm, noon, midnight            |       |
 * |                                 | bbbb    | a.m., p.m., noon, midnight        | 2     |
 * |                                 | bbbbb   | a, p, n, mi                       |       |
 * | Flexible day period             | B..BBB  | at night, in the morning, ...     |       |
 * |                                 | BBBB    | at night, in the morning, ...     | 2     |
 * |                                 | BBBBB   | at night, in the morning, ...     |       |
 * | Hour [1-12]                     | h       | 1, 2, ..., 11, 12                 |       |
 * |                                 | ho      | 1st, 2nd, ..., 11th, 12th         | 7     |
 * |                                 | hh      | 01, 02, ..., 11, 12               |       |
 * | Hour [0-23]                     | H       | 0, 1, 2, ..., 23                  |       |
 * |                                 | Ho      | 0th, 1st, 2nd, ..., 23rd          | 7     |
 * |                                 | HH      | 00, 01, 02, ..., 23               |       |
 * | Hour [0-11]                     | K       | 1, 2, ..., 11, 0                  |       |
 * |                                 | Ko      | 1st, 2nd, ..., 11th, 0th          | 7     |
 * |                                 | KK      | 01, 02, ..., 11, 00               |       |
 * | Hour [1-24]                     | k       | 24, 1, 2, ..., 23                 |       |
 * |                                 | ko      | 24th, 1st, 2nd, ..., 23rd         | 7     |
 * |                                 | kk      | 24, 01, 02, ..., 23               |       |
 * | Minute                          | m       | 0, 1, ..., 59                     |       |
 * |                                 | mo      | 0th, 1st, ..., 59th               | 7     |
 * |                                 | mm      | 00, 01, ..., 59                   |       |
 * | Second                          | s       | 0, 1, ..., 59                     |       |
 * |                                 | so      | 0th, 1st, ..., 59th               | 7     |
 * |                                 | ss      | 00, 01, ..., 59                   |       |
 * | Fraction of second              | S       | 0, 1, ..., 9                      |       |
 * |                                 | SS      | 00, 01, ..., 99                   |       |
 * |                                 | SSS     | 000, 001, ..., 999                |       |
 * |                                 | SSSS    | ...                               | 3     |
 * | Timezone (ISO-8601 w/ Z)        | X       | -08, +0530, Z                     |       |
 * |                                 | XX      | -0800, +0530, Z                   |       |
 * |                                 | XXX     | -08:00, +05:30, Z                 |       |
 * |                                 | XXXX    | -0800, +0530, Z, +123456          | 2     |
 * |                                 | XXXXX   | -08:00, +05:30, Z, +12:34:56      |       |
 * | Timezone (ISO-8601 w/o Z)       | x       | -08, +0530, +00                   |       |
 * |                                 | xx      | -0800, +0530, +0000               |       |
 * |                                 | xxx     | -08:00, +05:30, +00:00            | 2     |
 * |                                 | xxxx    | -0800, +0530, +0000, +123456      |       |
 * |                                 | xxxxx   | -08:00, +05:30, +00:00, +12:34:56 |       |
 * | Timezone (GMT)                  | O...OOO | GMT-8, GMT+5:30, GMT+0            |       |
 * |                                 | OOOO    | GMT-08:00, GMT+05:30, GMT+00:00   | 2     |
 * | Timezone (specific non-locat.)  | z...zzz | GMT-8, GMT+5:30, GMT+0            | 6     |
 * |                                 | zzzz    | GMT-08:00, GMT+05:30, GMT+00:00   | 2,6   |
 * | Seconds timestamp               | t       | 512969520                         | 7     |
 * |                                 | tt      | ...                               | 3,7   |
 * | Milliseconds timestamp          | T       | 512969520900                      | 7     |
 * |                                 | TT      | ...                               | 3,7   |
 * | Long localized date             | P       | 04/29/1453                        | 7     |
 * |                                 | PP      | Apr 29, 1453                      | 7     |
 * |                                 | PPP     | April 29th, 1453                  | 7     |
 * |                                 | PPPP    | Friday, April 29th, 1453          | 2,7   |
 * | Long localized time             | p       | 12:00 AM                          | 7     |
 * |                                 | pp      | 12:00:00 AM                       | 7     |
 * |                                 | ppp     | 12:00:00 AM GMT+2                 | 7     |
 * |                                 | pppp    | 12:00:00 AM GMT+02:00             | 2,7   |
 * | Combination of date and time    | Pp      | 04/29/1453, 12:00 AM              | 7     |
 * |                                 | PPpp    | Apr 29, 1453, 12:00:00 AM         | 7     |
 * |                                 | PPPppp  | April 29th, 1453 at ...           | 7     |
 * |                                 | PPPPpppp| Friday, April 29th, 1453 at ...   | 2,7   |
 * Notes:
 * 1. "Formatting" units (e.g. formatting quarter) in the default en-US locale
 *    are the same as "stand-alone" units, but are different in some languages.
 *    "Formatting" units are declined according to the rules of the language
 *    in the context of a date. "Stand-alone" units are always nominative singular:
 *
 *    `format(new Date(2017, 10, 6), 'do LLLL', {locale: cs}) //=> '6. listopad'`
 *
 *    `format(new Date(2017, 10, 6), 'do MMMM', {locale: cs}) //=> '6. listopadu'`
 *
 * 2. Any sequence of the identical letters is a pattern, unless it is escaped by
 *    the single quote characters (see below).
 *    If the sequence is longer than listed in table (e.g. `EEEEEEEEEEE`)
 *    the output will be the same as default pattern for this unit, usually
 *    the longest one (in case of ISO weekdays, `EEEE`). Default patterns for units
 *    are marked with "2" in the last column of the table.
 *
 *    `format(new Date(2017, 10, 6), 'MMM') //=> 'Nov'`
 *
 *    `format(new Date(2017, 10, 6), 'MMMM') //=> 'November'`
 *
 *    `format(new Date(2017, 10, 6), 'MMMMM') //=> 'N'`
 *
 *    `format(new Date(2017, 10, 6), 'MMMMMM') //=> 'November'`
 *
 *    `format(new Date(2017, 10, 6), 'MMMMMMM') //=> 'November'`
 *
 * 3. Some patterns could be unlimited length (such as `yyyyyyyy`).
 *    The output will be padded with zeros to match the length of the pattern.
 *
 *    `format(new Date(2017, 10, 6), 'yyyyyyyy') //=> '00002017'`
 *
 * 4. `QQQQQ` and `qqqqq` could be not strictly numerical in some locales.
 *    These tokens represent the shortest form of the quarter.
 *
 * 5. The main difference between `y` and `u` patterns are B.C. years:
 *
 *    | Year | `y` | `u` |
 *    |------|-----|-----|
 *    | AC 1 |   1 |   1 |
 *    | BC 1 |   1 |   0 |
 *    | BC 2 |   2 |  -1 |
 *
 *    Also `yy` always returns the last two digits of a year,
 *    while `uu` pads single digit years to 2 characters and returns other years unchanged:
 *
 *    | Year | `yy` | `uu` |
 *    |------|------|------|
 *    | 1    |   01 |   01 |
 *    | 14   |   14 |   14 |
 *    | 376  |   76 |  376 |
 *    | 1453 |   53 | 1453 |
 *
 *    The same difference is true for local and ISO week-numbering years (`Y` and `R`),
 *    except local week-numbering years are dependent on `options.weekStartsOn`
 *    and `options.firstWeekContainsDate` (compare [getISOWeekYear]{@link https://date-fns.org/docs/getISOWeekYear}
 *    and [getWeekYear]{@link https://date-fns.org/docs/getWeekYear}).
 *
 * 6. Specific non-location timezones are currently unavailable in `date-fns`,
 *    so right now these tokens fall back to GMT timezones.
 *
 * 7. These patterns are not in the Unicode Technical Standard #35:
 *    - `i`: ISO day of week
 *    - `I`: ISO week of year
 *    - `R`: ISO week-numbering year
 *    - `t`: seconds timestamp
 *    - `T`: milliseconds timestamp
 *    - `o`: ordinal number modifier
 *    - `P`: long localized date
 *    - `p`: long localized time
 *
 * 8. `YY` and `YYYY` tokens represent week-numbering years but they are often confused with years.
 *    You should enable `options.useAdditionalWeekYearTokens` to use them. See: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 *
 * 9. `D` and `DD` tokens represent days of the year but they are often confused with days of the month.
 *    You should enable `options.useAdditionalDayOfYearTokens` to use them. See: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 *
 * @param {Date|Number} date - the original date
 * @param {String} format - the string of tokens
 * @param {Object} [options] - an object with options.
 * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}
 * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)
 * @param {Number} [options.firstWeekContainsDate=1] - the day of January, which is
 * @param {Boolean} [options.useAdditionalWeekYearTokens=false] - if true, allows usage of the week-numbering year tokens `YY` and `YYYY`;
 *   see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @param {Boolean} [options.useAdditionalDayOfYearTokens=false] - if true, allows usage of the day of year tokens `D` and `DD`;
 *   see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @returns {String} the formatted date string
 * @throws {TypeError} 2 arguments required
 * @throws {RangeError} `date` must not be Invalid Date
 * @throws {RangeError} `options.locale` must contain `localize` property
 * @throws {RangeError} `options.locale` must contain `formatLong` property
 * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6
 * @throws {RangeError} `options.firstWeekContainsDate` must be between 1 and 7
 * @throws {RangeError} use `yyyy` instead of `YYYY` for formatting years using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @throws {RangeError} use `yy` instead of `YY` for formatting years using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @throws {RangeError} use `d` instead of `D` for formatting days of the month using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @throws {RangeError} use `dd` instead of `DD` for formatting days of the month using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @throws {RangeError} format string contains an unescaped latin alphabet character
 *
 * @example
 * // Represent 11 February 2014 in middle-endian format:
 * const result = format(new Date(2014, 1, 11), 'MM/dd/yyyy')
 * //=> '02/11/2014'
 *
 * @example
 * // Represent 2 July 2014 in Esperanto:
 * import { eoLocale } from 'date-fns/locale/eo'
 * const result = format(new Date(2014, 6, 2), "do 'de' MMMM yyyy", {
 *   locale: eoLocale
 * })
 * //=> '2-a de julio 2014'
 *
 * @example
 * // Escape string by single quote characters:
 * const result = format(new Date(2014, 6, 2, 15), "h 'o''clock'")
 * //=> "3 o'clock"
 */

function format$1(dirtyDate, dirtyFormatStr, options) {
  var _ref, _options$locale, _ref2, _ref3, _ref4, _options$firstWeekCon, _options$locale2, _options$locale2$opti, _defaultOptions$local, _defaultOptions$local2, _ref5, _ref6, _ref7, _options$weekStartsOn, _options$locale3, _options$locale3$opti, _defaultOptions$local3, _defaultOptions$local4;

  requiredArgs$1(2, arguments);
  var formatStr = String(dirtyFormatStr);
  var defaultOptions = getDefaultOptions$1();
  var locale = (_ref = (_options$locale = options === null || options === void 0 ? void 0 : options.locale) !== null && _options$locale !== void 0 ? _options$locale : defaultOptions.locale) !== null && _ref !== void 0 ? _ref : defaultLocale$1;
  var firstWeekContainsDate = toInteger$1((_ref2 = (_ref3 = (_ref4 = (_options$firstWeekCon = options === null || options === void 0 ? void 0 : options.firstWeekContainsDate) !== null && _options$firstWeekCon !== void 0 ? _options$firstWeekCon : options === null || options === void 0 ? void 0 : (_options$locale2 = options.locale) === null || _options$locale2 === void 0 ? void 0 : (_options$locale2$opti = _options$locale2.options) === null || _options$locale2$opti === void 0 ? void 0 : _options$locale2$opti.firstWeekContainsDate) !== null && _ref4 !== void 0 ? _ref4 : defaultOptions.firstWeekContainsDate) !== null && _ref3 !== void 0 ? _ref3 : (_defaultOptions$local = defaultOptions.locale) === null || _defaultOptions$local === void 0 ? void 0 : (_defaultOptions$local2 = _defaultOptions$local.options) === null || _defaultOptions$local2 === void 0 ? void 0 : _defaultOptions$local2.firstWeekContainsDate) !== null && _ref2 !== void 0 ? _ref2 : 1); // Test if weekStartsOn is between 1 and 7 _and_ is not NaN

  if (!(firstWeekContainsDate >= 1 && firstWeekContainsDate <= 7)) {
    throw new RangeError('firstWeekContainsDate must be between 1 and 7 inclusively');
  }

  var weekStartsOn = toInteger$1((_ref5 = (_ref6 = (_ref7 = (_options$weekStartsOn = options === null || options === void 0 ? void 0 : options.weekStartsOn) !== null && _options$weekStartsOn !== void 0 ? _options$weekStartsOn : options === null || options === void 0 ? void 0 : (_options$locale3 = options.locale) === null || _options$locale3 === void 0 ? void 0 : (_options$locale3$opti = _options$locale3.options) === null || _options$locale3$opti === void 0 ? void 0 : _options$locale3$opti.weekStartsOn) !== null && _ref7 !== void 0 ? _ref7 : defaultOptions.weekStartsOn) !== null && _ref6 !== void 0 ? _ref6 : (_defaultOptions$local3 = defaultOptions.locale) === null || _defaultOptions$local3 === void 0 ? void 0 : (_defaultOptions$local4 = _defaultOptions$local3.options) === null || _defaultOptions$local4 === void 0 ? void 0 : _defaultOptions$local4.weekStartsOn) !== null && _ref5 !== void 0 ? _ref5 : 0); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN

  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {
    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');
  }

  if (!locale.localize) {
    throw new RangeError('locale must contain localize property');
  }

  if (!locale.formatLong) {
    throw new RangeError('locale must contain formatLong property');
  }

  var originalDate = toDate$1(dirtyDate);

  if (!isValid$1(originalDate)) {
    throw new RangeError('Invalid time value');
  } // Convert the date in system timezone to the same date in UTC+00:00 timezone.
  // This ensures that when UTC functions will be implemented, locales will be compatible with them.
  // See an issue about UTC functions: https://github.com/date-fns/date-fns/issues/376


  var timezoneOffset = getTimezoneOffsetInMilliseconds$1(originalDate);
  var utcDate = subMilliseconds$1(originalDate, timezoneOffset);
  var formatterOptions = {
    firstWeekContainsDate: firstWeekContainsDate,
    weekStartsOn: weekStartsOn,
    locale: locale,
    _originalDate: originalDate
  };
  var result = formatStr.match(longFormattingTokensRegExp$1).map(function (substring) {
    var firstCharacter = substring[0];

    if (firstCharacter === 'p' || firstCharacter === 'P') {
      var longFormatter = longFormatters$1$1[firstCharacter];
      return longFormatter(substring, locale.formatLong);
    }

    return substring;
  }).join('').match(formattingTokensRegExp$1).map(function (substring) {
    // Replace two single quote characters with one single quote character
    if (substring === "''") {
      return "'";
    }

    var firstCharacter = substring[0];

    if (firstCharacter === "'") {
      return cleanEscapedString$1(substring);
    }

    var formatter = formatters$1$1[firstCharacter];

    if (formatter) {
      if (!(options !== null && options !== void 0 && options.useAdditionalWeekYearTokens) && isProtectedWeekYearToken$1(substring)) {
        throwProtectedError$1(substring, dirtyFormatStr, String(dirtyDate));
      }

      if (!(options !== null && options !== void 0 && options.useAdditionalDayOfYearTokens) && isProtectedDayOfYearToken$1(substring)) {
        throwProtectedError$1(substring, dirtyFormatStr, String(dirtyDate));
      }

      return formatter(utcDate, substring, locale.localize, formatterOptions);
    }

    if (firstCharacter.match(unescapedLatinCharacterRegExp$1)) {
      throw new RangeError('Format string contains an unescaped latin alphabet character `' + firstCharacter + '`');
    }

    return substring;
  }).join('');
  return result;
}

function cleanEscapedString$1(input) {
  var matched = input.match(escapedStringRegExp$1);

  if (!matched) {
    return input;
  }

  return matched[1].replace(doubleQuoteRegExp$1, "'");
}

function Loader(_ref) {
  let {
    className = '',
    width = '26px',
    height = '26px',
    children
  } = _ref;
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-loader'].join(' '),
    style: {
      width: typeof width === 'string' ? width : `${width}px`,
      height: typeof height === 'string' ? height : `${height}px`
    }
  }, children || /*#__PURE__*/React__default__default.createElement(Icon, {
    type: IconTypes.SPINNER,
    width: "26px",
    height: "26px"
  }));
}

/**
 * @name startOfDay
 * @category Day Helpers
 * @summary Return the start of a day for the given date.
 *
 * @description
 * Return the start of a day for the given date.
 * The result will be in the local timezone.
 *
 * @param {Date|Number} date - the original date
 * @returns {Date} the start of a day
 * @throws {TypeError} 1 argument required
 *
 * @example
 * // The start of a day for 2 September 2014 11:55:00:
 * const result = startOfDay(new Date(2014, 8, 2, 11, 55, 0))
 * //=> Tue Sep 02 2014 00:00:00
 */

function startOfDay(dirtyDate) {
  requiredArgs$1(1, arguments);
  var date = toDate$1(dirtyDate);
  date.setHours(0, 0, 0, 0);
  return date;
}
/**
 * @name isSameDay
 * @category Day Helpers
 * @summary Are the given dates in the same day (and year and month)?
 *
 * @description
 * Are the given dates in the same day (and year and month)?
 *
 * @param {Date|Number} dateLeft - the first date to check
 * @param {Date|Number} dateRight - the second date to check
 * @returns {Boolean} the dates are in the same day (and year and month)
 * @throws {TypeError} 2 arguments required
 *
 * @example
 * // Are 4 September 06:00:00 and 4 September 18:00:00 in the same day?
 * const result = isSameDay(new Date(2014, 8, 4, 6, 0), new Date(2014, 8, 4, 18, 0))
 * //=> true
 *
 * @example
 * // Are 4 September and 4 October in the same day?
 * const result = isSameDay(new Date(2014, 8, 4), new Date(2014, 9, 4))
 * //=> false
 *
 * @example
 * // Are 4 September, 2014 and 4 September, 2015 in the same day?
 * const result = isSameDay(new Date(2014, 8, 4), new Date(2015, 8, 4))
 * //=> false
 */


function isSameDay(dirtyDateLeft, dirtyDateRight) {
  requiredArgs$1(2, arguments);
  var dateLeftStartOfDay = startOfDay(dirtyDateLeft);
  var dateRightStartOfDay = startOfDay(dirtyDateRight);
  return dateLeftStartOfDay.getTime() === dateRightStartOfDay.getTime();
}

const MENTION_USER_LABEL_CLASSNAME = 'sendbird-mention-user-label';

let Colors = /*#__PURE__*/function (Colors) {
  Colors["ONBACKGROUND_1"] = "ONBACKGROUND_1";
  Colors["ONBACKGROUND_2"] = "ONBACKGROUND_2";
  Colors["ONBACKGROUND_3"] = "ONBACKGROUND_3";
  Colors["ONBACKGROUND_4"] = "ONBACKGROUND_4";
  Colors["ONCONTENT_1"] = "ONCONTENT_1";
  Colors["ONCONTENT_2"] = "ONCONTENT_2";
  Colors["PRIMARY"] = "PRIMARY";
  Colors["ERROR"] = "ERROR";
  return Colors;
}({});

const changeColorToClassName = color => {
  switch (color) {
    case Colors.ONBACKGROUND_1:
      return 'sendbird-color--onbackground-1';

    case Colors.ONBACKGROUND_2:
      return 'sendbird-color--onbackground-2';

    case Colors.ONBACKGROUND_3:
      return 'sendbird-color--onbackground-3';

    case Colors.ONBACKGROUND_4:
      return 'sendbird-color--onbackground-4';

    case Colors.ONCONTENT_1:
      return 'sendbird-color--oncontent-1';

    case Colors.PRIMARY:
      return 'sendbird-color--primary';

    case Colors.ERROR:
      return 'sendbird-color--error';

    default:
      return null;
  }
};

const TextButton = _ref => {
  let {
    className = '',
    color = Colors.ONBACKGROUND_1,
    disabled = false,
    disableUnderline = false,
    onClick = () => {
      /* noop */
    },
    children
  } = _ref;
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), changeColorToClassName(color), disableUnderline ? 'sendbird-textbutton--not-underline' : 'sendbird-textbutton', disabled ? 'sendbird-textbutton--disabled' : ''].join(' '),
    role: "button",
    tabIndex: 0,
    onClick: e => onClick(e),
    onKeyPress: e => onClick(e)
  }, children);
};

const USER_MENTION_TEMP_CHAR = '@';

const isEmpty = val => val === null || val === undefined; // Some Ids return string and number inconsistently
// only use to comapre IDs


function compareIds(a, b) {
  if (isEmpty(a) || isEmpty(b)) {
    return false;
  }

  const aString = a.toString();
  const bString = b.toString();
  return aString === bString;
}

getSendingMessageStatus();
getSendingMessageStatus();

const DEFAULT_DURATION = 300;

function preventDefault(e) {
  if (!isTouchEvent(e)) {
    return;
  }

  if (e.touches.length < 2 && e.preventDefault) {
    e.preventDefault();
  }
}

function isTouchEvent(e) {
  return e && 'touches' in e;
}

function useLongPress(_ref) {
  let {
    onLongPress,
    onClick
  } = _ref;
  let {
    delay = DEFAULT_DURATION,
    shouldPreventDefault = true,
    shouldStopPropagation = false
  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  const {
    isMobile
  } = useMediaQueryContext();
  const [longPressTriggered, setLongPressTriggered] = useState(false);
  const [dragTriggered, setDragTriggered] = useState(false); // https://www.typescriptlang.org/docs/handbook/utility-types.html#returntypetype

  const timeout = useRef();
  const target = useRef();
  const start = useCallback(e => {
    e.persist();

    const clonedEvent = _objectSpread2({}, e);

    setDragTriggered(false);

    if (shouldStopPropagation) {
      e.stopPropagation();
    }

    if (shouldPreventDefault && e.target) {
      e.target.addEventListener('touchend', preventDefault, {
        passive: false
      });
      target.current = e.target;
    }

    timeout.current = setTimeout(() => {
      onLongPress(clonedEvent);
      setLongPressTriggered(true);
    }, delay);
  }, [onLongPress, delay, shouldPreventDefault, shouldStopPropagation, isMobile]);
  const clear = useCallback(function (e) {
    let shouldTriggerClick = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
    let onDrag = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

    if (onDrag) {
      setDragTriggered(true);
    } else {
      setDragTriggered(false);
    }

    if (timeout !== null && timeout !== void 0 && timeout.current) {
      clearTimeout(timeout.current);
    }

    if (shouldTriggerClick && !longPressTriggered && !dragTriggered) {
      onClick === null || onClick === void 0 ? void 0 : onClick(e);
    }

    setLongPressTriggered(false);

    if (shouldPreventDefault && target.current) {
      target.current.removeEventListener('touchend', preventDefault);
    }
  }, [shouldPreventDefault, onClick, longPressTriggered, dragTriggered]);
  return {
    onMouseDown: e => start(e),
    onMouseUp: e => clear(e),
    onMouseLeave: e => clear(e, false),
    onTouchStart: e => start(e),
    // setDragTriggered as true on touchmove, so that next onTouchEnd is ignored
    // if we dont do it, onClick?.(e) will be triggred, see inside clear()
    onTouchMove: e => clear(e, false, true),
    onTouchEnd: e => clear(e)
  };
}

({
  disabled: propTypes.exports.bool,
  onLeaveChannel: propTypes.exports.func.isRequired,
  channel: propTypes.exports.shape({})
});

function Types() {
  return {
    LOADING: 'LOADING',
    NO_CHANNELS: 'NO_CHANNELS',
    NO_MESSAGES: 'NO_MESSAGES',
    WRONG: 'WRONG',
    SEARCH_IN: 'SEARCH_IN',
    SEARCHING: 'SEARCHING',
    NO_RESULTS: 'NO_RESULTS'
  };
}

var PlaceHolderTypes$1 = Types();
const PlaceHolderTypes = PlaceHolderTypes$1;

function PlaceHolder(_ref) {
  let {
    className = '',
    type,
    iconSize,
    searchInString = '',
    retryToConnect = null
  } = _ref;
  const {
    stringSet
  } = useContext(LocalizationContext);
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-place-holder'].join(' ')
  }, type === PlaceHolderTypes.LOADING && /*#__PURE__*/React__default__default.createElement(Loader, {
    width: iconSize || '48px',
    height: iconSize || '48px'
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    type: IconTypes.SPINNER,
    fillColor: IconColors.PRIMARY,
    width: iconSize || '48px',
    height: iconSize || '48px'
  })), (type === PlaceHolderTypes.NO_CHANNELS || type === PlaceHolderTypes.NO_MESSAGES || type === PlaceHolderTypes.WRONG) && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-place-holder__body"
  }, type === PlaceHolderTypes.NO_CHANNELS && /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-place-holder__body__icon",
    type: IconTypes.CHAT,
    fillColor: IconColors.ON_BACKGROUND_3,
    width: iconSize || '64px',
    height: iconSize || '64px'
  }), type === PlaceHolderTypes.WRONG && /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-place-holder__body__icon",
    type: IconTypes.ERROR,
    fillColor: IconColors.ON_BACKGROUND_3,
    width: iconSize || '64px',
    height: iconSize || '64px'
  }), type === PlaceHolderTypes.NO_MESSAGES && /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-place-holder__body__icon",
    type: IconTypes.MESSAGE,
    fillColor: IconColors.ON_BACKGROUND_3,
    width: iconSize || '64px',
    height: iconSize || '64px'
  }), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-place-holder__body__text",
    type: LabelTypography.BODY_1,
    color: LabelColors.ONBACKGROUND_2
  }, type === PlaceHolderTypes.NO_CHANNELS && stringSet.PLACE_HOLDER__NO_CHANNEL, type === PlaceHolderTypes.WRONG && stringSet.PLACE_HOLDER__WRONG, type === PlaceHolderTypes.NO_MESSAGES && stringSet.PLACE_HOLDER__NO_MESSAGES), retryToConnect && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-place-holder__body__reconnect",
    role: "button",
    onClick: retryToConnect,
    onKeyPress: retryToConnect,
    tabIndex: 0
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-place-holder__body__reconnect__icon",
    type: IconTypes.REFRESH,
    fillColor: IconColors.PRIMARY,
    width: "20px",
    height: "20px"
  }), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-place-holder__body__reconnect__text",
    type: LabelTypography.BUTTON_1,
    color: LabelColors.PRIMARY
  }, stringSet.PLACE_HOLDER__RETRY_TO_CONNECT))), (type === PlaceHolderTypes.NO_RESULTS || type === PlaceHolderTypes.SEARCH_IN || type === PlaceHolderTypes.SEARCHING) && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-place-holder__body--align-top"
  }, type === PlaceHolderTypes.SEARCH_IN && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-place-holder__body--align-top__text"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-place-holder__body--align-top__text__search-in",
    type: LabelTypography.BUTTON_2,
    color: LabelColors.ONBACKGROUND_2
  }, stringSet.SEARCH_IN), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-place-holder__body--align-top__text__channel-name",
    type: LabelTypography.BUTTON_2,
    color: LabelColors.PRIMARY
  }, `'${searchInString}`), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-place-holder__body--align-top__text__quote",
    type: LabelTypography.BUTTON_2,
    color: LabelColors.PRIMARY
  }, '\'')), type === PlaceHolderTypes.SEARCHING && /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-place-hlder__body--align-top__searching",
    type: LabelTypography.BODY_1,
    color: LabelColors.ONBACKGROUND_2
  }, stringSet.SEARCHING), type === PlaceHolderTypes.NO_RESULTS && /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-place-hlder__body--align-top__no-result",
    type: LabelTypography.BODY_1,
    color: LabelColors.ONBACKGROUND_2
  }, stringSet.NO_SEARCHED_MESSAGE)));
}

const MessageInputKeys = {
  Enter: 'Enter',
  ArrowUp: 'ArrowUp',
  ArrowDown: 'ArrowDown',
  Backspace: 'Backspace'
};
const NodeTypes = {
  ElementNode: 1,
  TextNode: 3
};
const NodeNames = {
  Span: 'SPAN',
  Br: 'BR',
  Div: 'DIV'
};

// Initializing status
let ChannelStateTypes = /*#__PURE__*/function (ChannelStateTypes) {
  ChannelStateTypes["NIL"] = "NIL";
  ChannelStateTypes["LOADING"] = "LOADING";
  ChannelStateTypes["INVALID"] = "INVALID";
  ChannelStateTypes["INITIALIZED"] = "INITIALIZED";
  return ChannelStateTypes;
}({});

let ParentMessageStateTypes = /*#__PURE__*/function (ParentMessageStateTypes) {
  ParentMessageStateTypes["NIL"] = "NIL";
  ParentMessageStateTypes["LOADING"] = "LOADING";
  ParentMessageStateTypes["INVALID"] = "INVALID";
  ParentMessageStateTypes["INITIALIZED"] = "INITIALIZED";
  return ParentMessageStateTypes;
}({});

let ThreadListStateTypes = /*#__PURE__*/function (ThreadListStateTypes) {
  ThreadListStateTypes["NIL"] = "NIL";
  ThreadListStateTypes["LOADING"] = "LOADING";
  ThreadListStateTypes["INVALID"] = "INVALID";
  ThreadListStateTypes["INITIALIZED"] = "INITIALIZED";
  return ThreadListStateTypes;
}({});

({
  currentChannel: null,
  allThreadMessages: [],
  parentMessage: null,
  channelState: ChannelStateTypes.NIL,
  parentMessageState: ParentMessageStateTypes.NIL,
  threadListState: ThreadListStateTypes.NIL,
  hasMorePrev: false,
  hasMoreNext: false,
  emojiContainer: {},
  isMuted: false,
  isChannelFrozen: false,
  currentUserId: ''
});

const DateSeparator = _ref => {
  let {
    children = null,
    className = '',
    separatorColor = Colors.ONBACKGROUND_4
  } = _ref;
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-separator'].join(' ')
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: ['sendbird-separator__left', `${changeColorToClassName(separatorColor)}--background-color`].join(' ')
  }), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-separator__text"
  }, children || /*#__PURE__*/React__default__default.createElement(Label, {
    type: LabelTypography.CAPTION_2,
    color: LabelColors.ONBACKGROUND_2
  }, "Date Separator")), /*#__PURE__*/React__default__default.createElement("div", {
    className: ['sendbird-separator__right', `${changeColorToClassName(separatorColor)}--background-color`].join(' ')
  }));
};

/*! @license DOMPurify 3.0.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.3/LICENSE */

const {
  entries,
  setPrototypeOf,
  isFrozen,
  getPrototypeOf,
  getOwnPropertyDescriptor
} = Object;
let {
  freeze,
  seal,
  create
} = Object; // eslint-disable-line import/no-mutable-exports

let {
  apply,
  construct
} = typeof Reflect !== 'undefined' && Reflect;

if (!apply) {
  apply = function apply(fun, thisValue, args) {
    return fun.apply(thisValue, args);
  };
}

if (!freeze) {
  freeze = function freeze(x) {
    return x;
  };
}

if (!seal) {
  seal = function seal(x) {
    return x;
  };
}

if (!construct) {
  construct = function construct(Func, args) {
    return new Func(...args);
  };
}

const arrayForEach = unapply(Array.prototype.forEach);
const arrayPop = unapply(Array.prototype.pop);
const arrayPush = unapply(Array.prototype.push);
const stringToLowerCase = unapply(String.prototype.toLowerCase);
const stringToString = unapply(String.prototype.toString);
const stringMatch = unapply(String.prototype.match);
const stringReplace = unapply(String.prototype.replace);
const stringIndexOf = unapply(String.prototype.indexOf);
const stringTrim = unapply(String.prototype.trim);
const regExpTest = unapply(RegExp.prototype.test);
const typeErrorCreate = unconstruct(TypeError);

function unapply(func) {
  return function (thisArg) {
    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    return apply(func, thisArg, args);
  };
}

function unconstruct(func) {
  return function () {
    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    return construct(func, args);
  };
}
/* Add properties to a lookup table */


function addToSet(set, array, transformCaseFunc) {
  var _transformCaseFunc;

  transformCaseFunc = (_transformCaseFunc = transformCaseFunc) !== null && _transformCaseFunc !== void 0 ? _transformCaseFunc : stringToLowerCase;

  if (setPrototypeOf) {
    // Make 'in' and truthy checks like Boolean(set.constructor)
    // independent of any properties defined on Object.prototype.
    // Prevent prototype setters from intercepting set as a this value.
    setPrototypeOf(set, null);
  }

  let l = array.length;

  while (l--) {
    let element = array[l];

    if (typeof element === 'string') {
      const lcElement = transformCaseFunc(element);

      if (lcElement !== element) {
        // Config presets (e.g. tags.js, attrs.js) are immutable.
        if (!isFrozen(array)) {
          array[l] = lcElement;
        }

        element = lcElement;
      }
    }

    set[element] = true;
  }

  return set;
}
/* Shallow clone an object */


function clone(object) {
  const newObject = create(null);

  for (const [property, value] of entries(object)) {
    newObject[property] = value;
  }

  return newObject;
}
/* This method automatically checks if the prop is function
 * or getter and behaves accordingly. */


function lookupGetter(object, prop) {
  while (object !== null) {
    const desc = getOwnPropertyDescriptor(object, prop);

    if (desc) {
      if (desc.get) {
        return unapply(desc.get);
      }

      if (typeof desc.value === 'function') {
        return unapply(desc.value);
      }
    }

    object = getPrototypeOf(object);
  }

  function fallbackValue(element) {
    console.warn('fallback value for', element);
    return null;
  }

  return fallbackValue;
}

const html$1 = freeze(['a', 'abbr', 'acronym', 'address', 'area', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'content', 'data', 'datalist', 'dd', 'decorator', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'img', 'input', 'ins', 'kbd', 'label', 'legend', 'li', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meter', 'nav', 'nobr', 'ol', 'optgroup', 'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr']); // SVG

const svg$1 = freeze(['svg', 'a', 'altglyph', 'altglyphdef', 'altglyphitem', 'animatecolor', 'animatemotion', 'animatetransform', 'circle', 'clippath', 'defs', 'desc', 'ellipse', 'filter', 'font', 'g', 'glyph', 'glyphref', 'hkern', 'image', 'line', 'lineargradient', 'marker', 'mask', 'metadata', 'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialgradient', 'rect', 'stop', 'style', 'switch', 'symbol', 'text', 'textpath', 'title', 'tref', 'tspan', 'view', 'vkern']);
const svgFilters = freeze(['feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feDropShadow', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence']); // List of SVG elements that are disallowed by default.
// We still need to know them so that we can do namespace
// checks properly in case one wants to add them to
// allow-list.

const svgDisallowed = freeze(['animate', 'color-profile', 'cursor', 'discard', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignobject', 'hatch', 'hatchpath', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'missing-glyph', 'script', 'set', 'solidcolor', 'unknown', 'use']);
const mathMl$1 = freeze(['math', 'menclose', 'merror', 'mfenced', 'mfrac', 'mglyph', 'mi', 'mlabeledtr', 'mmultiscripts', 'mn', 'mo', 'mover', 'mpadded', 'mphantom', 'mroot', 'mrow', 'ms', 'mspace', 'msqrt', 'mstyle', 'msub', 'msup', 'msubsup', 'mtable', 'mtd', 'mtext', 'mtr', 'munder', 'munderover', 'mprescripts']); // Similarly to SVG, we want to know all MathML elements,
// even those that we disallow by default.

const mathMlDisallowed = freeze(['maction', 'maligngroup', 'malignmark', 'mlongdiv', 'mscarries', 'mscarry', 'msgroup', 'mstack', 'msline', 'msrow', 'semantics', 'annotation', 'annotation-xml', 'mprescripts', 'none']);
const text = freeze(['#text']);
const html = freeze(['accept', 'action', 'align', 'alt', 'autocapitalize', 'autocomplete', 'autopictureinpicture', 'autoplay', 'background', 'bgcolor', 'border', 'capture', 'cellpadding', 'cellspacing', 'checked', 'cite', 'class', 'clear', 'color', 'cols', 'colspan', 'controls', 'controlslist', 'coords', 'crossorigin', 'datetime', 'decoding', 'default', 'dir', 'disabled', 'disablepictureinpicture', 'disableremoteplayback', 'download', 'draggable', 'enctype', 'enterkeyhint', 'face', 'for', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'id', 'inputmode', 'integrity', 'ismap', 'kind', 'label', 'lang', 'list', 'loading', 'loop', 'low', 'max', 'maxlength', 'media', 'method', 'min', 'minlength', 'multiple', 'muted', 'name', 'nonce', 'noshade', 'novalidate', 'nowrap', 'open', 'optimum', 'pattern', 'placeholder', 'playsinline', 'poster', 'preload', 'pubdate', 'radiogroup', 'readonly', 'rel', 'required', 'rev', 'reversed', 'role', 'rows', 'rowspan', 'spellcheck', 'scope', 'selected', 'shape', 'size', 'sizes', 'span', 'srclang', 'start', 'src', 'srcset', 'step', 'style', 'summary', 'tabindex', 'title', 'translate', 'type', 'usemap', 'valign', 'value', 'width', 'xmlns', 'slot']);
const svg = freeze(['accent-height', 'accumulate', 'additive', 'alignment-baseline', 'ascent', 'attributename', 'attributetype', 'azimuth', 'basefrequency', 'baseline-shift', 'begin', 'bias', 'by', 'class', 'clip', 'clippathunits', 'clip-path', 'clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cx', 'cy', 'd', 'dx', 'dy', 'diffuseconstant', 'direction', 'display', 'divisor', 'dur', 'edgemode', 'elevation', 'end', 'fill', 'fill-opacity', 'fill-rule', 'filter', 'filterunits', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'fx', 'fy', 'g1', 'g2', 'glyph-name', 'glyphref', 'gradientunits', 'gradienttransform', 'height', 'href', 'id', 'image-rendering', 'in', 'in2', 'k', 'k1', 'k2', 'k3', 'k4', 'kerning', 'keypoints', 'keysplines', 'keytimes', 'lang', 'lengthadjust', 'letter-spacing', 'kernelmatrix', 'kernelunitlength', 'lighting-color', 'local', 'marker-end', 'marker-mid', 'marker-start', 'markerheight', 'markerunits', 'markerwidth', 'maskcontentunits', 'maskunits', 'max', 'mask', 'media', 'method', 'mode', 'min', 'name', 'numoctaves', 'offset', 'operator', 'opacity', 'order', 'orient', 'orientation', 'origin', 'overflow', 'paint-order', 'path', 'pathlength', 'patterncontentunits', 'patterntransform', 'patternunits', 'points', 'preservealpha', 'preserveaspectratio', 'primitiveunits', 'r', 'rx', 'ry', 'radius', 'refx', 'refy', 'repeatcount', 'repeatdur', 'restart', 'result', 'rotate', 'scale', 'seed', 'shape-rendering', 'specularconstant', 'specularexponent', 'spreadmethod', 'startoffset', 'stddeviation', 'stitchtiles', 'stop-color', 'stop-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke', 'stroke-width', 'style', 'surfacescale', 'systemlanguage', 'tabindex', 'targetx', 'targety', 'transform', 'transform-origin', 'text-anchor', 'text-decoration', 'text-rendering', 'textlength', 'type', 'u1', 'u2', 'unicode', 'values', 'viewbox', 'visibility', 'version', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'width', 'word-spacing', 'wrap', 'writing-mode', 'xchannelselector', 'ychannelselector', 'x', 'x1', 'x2', 'xmlns', 'y', 'y1', 'y2', 'z', 'zoomandpan']);
const mathMl = freeze(['accent', 'accentunder', 'align', 'bevelled', 'close', 'columnsalign', 'columnlines', 'columnspan', 'denomalign', 'depth', 'dir', 'display', 'displaystyle', 'encoding', 'fence', 'frame', 'height', 'href', 'id', 'largeop', 'length', 'linethickness', 'lspace', 'lquote', 'mathbackground', 'mathcolor', 'mathsize', 'mathvariant', 'maxsize', 'minsize', 'movablelimits', 'notation', 'numalign', 'open', 'rowalign', 'rowlines', 'rowspacing', 'rowspan', 'rspace', 'rquote', 'scriptlevel', 'scriptminsize', 'scriptsizemultiplier', 'selection', 'separator', 'separators', 'stretchy', 'subscriptshift', 'supscriptshift', 'symmetric', 'voffset', 'width', 'xmlns']);
const xml = freeze(['xlink:href', 'xml:id', 'xlink:title', 'xml:space', 'xmlns:xlink']);
const MUSTACHE_EXPR = seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode

const ERB_EXPR = seal(/<%[\w\W]*|[\w\W]*%>/gm);
const TMPLIT_EXPR = seal(/\${[\w\W]*}/gm);
const DATA_ATTR = seal(/^data-[\-\w.\u00B7-\uFFFF]/); // eslint-disable-line no-useless-escape

const ARIA_ATTR = seal(/^aria-[\-\w]+$/); // eslint-disable-line no-useless-escape

const IS_ALLOWED_URI = seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i // eslint-disable-line no-useless-escape
);
const IS_SCRIPT_OR_DATA = seal(/^(?:\w+script|data):/i);
const ATTR_WHITESPACE = seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g // eslint-disable-line no-control-regex
);
const DOCTYPE_NAME = seal(/^html$/i);
var EXPRESSIONS = /*#__PURE__*/Object.freeze({
  __proto__: null,
  MUSTACHE_EXPR: MUSTACHE_EXPR,
  ERB_EXPR: ERB_EXPR,
  TMPLIT_EXPR: TMPLIT_EXPR,
  DATA_ATTR: DATA_ATTR,
  ARIA_ATTR: ARIA_ATTR,
  IS_ALLOWED_URI: IS_ALLOWED_URI,
  IS_SCRIPT_OR_DATA: IS_SCRIPT_OR_DATA,
  ATTR_WHITESPACE: ATTR_WHITESPACE,
  DOCTYPE_NAME: DOCTYPE_NAME
});

const getGlobal = () => typeof window === 'undefined' ? null : window;
/**
 * Creates a no-op policy for internal use only.
 * Don't export this function outside this module!
 * @param {?TrustedTypePolicyFactory} trustedTypes The policy factory.
 * @param {HTMLScriptElement} purifyHostElement The Script element used to load DOMPurify (to determine policy name suffix).
 * @return {?TrustedTypePolicy} The policy created (or null, if Trusted Types
 * are not supported or creating the policy failed).
 */


const _createTrustedTypesPolicy = function _createTrustedTypesPolicy(trustedTypes, purifyHostElement) {
  if (typeof trustedTypes !== 'object' || typeof trustedTypes.createPolicy !== 'function') {
    return null;
  } // Allow the callers to control the unique policy name
  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.
  // Policy creation with duplicate names throws in Trusted Types.


  let suffix = null;
  const ATTR_NAME = 'data-tt-policy-suffix';

  if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {
    suffix = purifyHostElement.getAttribute(ATTR_NAME);
  }

  const policyName = 'dompurify' + (suffix ? '#' + suffix : '');

  try {
    return trustedTypes.createPolicy(policyName, {
      createHTML(html) {
        return html;
      },

      createScriptURL(scriptUrl) {
        return scriptUrl;
      }

    });
  } catch (_) {
    // Policy creation failed (most likely another DOMPurify script has
    // already run). Skip creating the policy, as this will only cause errors
    // if TT are enforced.
    console.warn('TrustedTypes policy ' + policyName + ' could not be created.');
    return null;
  }
};

function createDOMPurify() {
  let window = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getGlobal();

  const DOMPurify = root => createDOMPurify(root);
  /**
   * Version label, exposed for easier checks
   * if DOMPurify is up to date or not
   */


  DOMPurify.version = '3.0.3';
  /**
   * Array of elements that DOMPurify removed during sanitation.
   * Empty if nothing was removed.
   */

  DOMPurify.removed = [];

  if (!window || !window.document || window.document.nodeType !== 9) {
    // Not running in a browser, provide a factory function
    // so that you can pass your own Window
    DOMPurify.isSupported = false;
    return DOMPurify;
  }

  const originalDocument = window.document;
  const currentScript = originalDocument.currentScript;
  let {
    document
  } = window;
  const {
    DocumentFragment,
    HTMLTemplateElement,
    Node,
    Element,
    NodeFilter,
    NamedNodeMap = window.NamedNodeMap || window.MozNamedAttrMap,
    HTMLFormElement,
    DOMParser,
    trustedTypes
  } = window;
  const ElementPrototype = Element.prototype;
  const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');
  const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');
  const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');
  const getParentNode = lookupGetter(ElementPrototype, 'parentNode'); // As per issue #47, the web-components registry is inherited by a
  // new document created via createHTMLDocument. As per the spec
  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)
  // a new empty registry is used when creating a template contents owner
  // document, so we use that as our parent document to ensure nothing
  // is inherited.

  if (typeof HTMLTemplateElement === 'function') {
    const template = document.createElement('template');

    if (template.content && template.content.ownerDocument) {
      document = template.content.ownerDocument;
    }
  }

  let trustedTypesPolicy;
  let emptyHTML = '';
  const {
    implementation,
    createNodeIterator,
    createDocumentFragment,
    getElementsByTagName
  } = document;
  const {
    importNode
  } = originalDocument;
  let hooks = {};
  /**
   * Expose whether this browser supports running the full DOMPurify.
   */

  DOMPurify.isSupported = typeof entries === 'function' && typeof getParentNode === 'function' && implementation && implementation.createHTMLDocument !== undefined;
  const {
    MUSTACHE_EXPR,
    ERB_EXPR,
    TMPLIT_EXPR,
    DATA_ATTR,
    ARIA_ATTR,
    IS_SCRIPT_OR_DATA,
    ATTR_WHITESPACE
  } = EXPRESSIONS;
  let {
    IS_ALLOWED_URI: IS_ALLOWED_URI$1
  } = EXPRESSIONS;
  /**
   * We consider the elements and attributes below to be safe. Ideally
   * don't add any new ones but feel free to remove unwanted ones.
   */

  /* allowed element names */

  let ALLOWED_TAGS = null;
  const DEFAULT_ALLOWED_TAGS = addToSet({}, [...html$1, ...svg$1, ...svgFilters, ...mathMl$1, ...text]);
  /* Allowed attribute names */

  let ALLOWED_ATTR = null;
  const DEFAULT_ALLOWED_ATTR = addToSet({}, [...html, ...svg, ...mathMl, ...xml]);
  /*
   * Configure how DOMPUrify should handle custom elements and their attributes as well as customized built-in elements.
   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)
   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)
   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.
   */

  let CUSTOM_ELEMENT_HANDLING = Object.seal(Object.create(null, {
    tagNameCheck: {
      writable: true,
      configurable: false,
      enumerable: true,
      value: null
    },
    attributeNameCheck: {
      writable: true,
      configurable: false,
      enumerable: true,
      value: null
    },
    allowCustomizedBuiltInElements: {
      writable: true,
      configurable: false,
      enumerable: true,
      value: false
    }
  }));
  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */

  let FORBID_TAGS = null;
  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */

  let FORBID_ATTR = null;
  /* Decide if ARIA attributes are okay */

  let ALLOW_ARIA_ATTR = true;
  /* Decide if custom data attributes are okay */

  let ALLOW_DATA_ATTR = true;
  /* Decide if unknown protocols are okay */

  let ALLOW_UNKNOWN_PROTOCOLS = false;
  /* Decide if self-closing tags in attributes are allowed.
   * Usually removed due to a mXSS issue in jQuery 3.0 */

  let ALLOW_SELF_CLOSE_IN_ATTR = true;
  /* Output should be safe for common template engines.
   * This means, DOMPurify removes data attributes, mustaches and ERB
   */

  let SAFE_FOR_TEMPLATES = false;
  /* Decide if document with <html>... should be returned */

  let WHOLE_DOCUMENT = false;
  /* Track whether config is already set on this instance of DOMPurify. */

  let SET_CONFIG = false;
  /* Decide if all elements (e.g. style, script) must be children of
   * document.body. By default, browsers might move them to document.head */

  let FORCE_BODY = false;
  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html
   * string (or a TrustedHTML object if Trusted Types are supported).
   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead
   */

  let RETURN_DOM = false;
  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html
   * string  (or a TrustedHTML object if Trusted Types are supported) */

  let RETURN_DOM_FRAGMENT = false;
  /* Try to return a Trusted Type object instead of a string, return a string in
   * case Trusted Types are not supported  */

  let RETURN_TRUSTED_TYPE = false;
  /* Output should be free from DOM clobbering attacks?
   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.
   */

  let SANITIZE_DOM = true;
  /* Achieve full DOM Clobbering protection by isolating the namespace of named
   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.
   *
   * HTML/DOM spec rules that enable DOM Clobbering:
   *   - Named Access on Window (Â§7.3.3)
   *   - DOM Tree Accessors (Â§3.1.5)
   *   - Form Element Parent-Child Relations (Â§4.10.3)
   *   - Iframe srcdoc / Nested WindowProxies (Â§4.8.5)
   *   - HTMLCollection (Â§4.2.10.2)
   *
   * Namespace isolation is implemented by prefixing `id` and `name` attributes
   * with a constant string, i.e., `user-content-`
   */

  let SANITIZE_NAMED_PROPS = false;
  const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';
  /* Keep element content when removing element? */

  let KEEP_CONTENT = true;
  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead
   * of importing it into a new Document and returning a sanitized copy */

  let IN_PLACE = false;
  /* Allow usage of profiles like html, svg and mathMl */

  let USE_PROFILES = {};
  /* Tags to ignore content of when KEEP_CONTENT is true */

  let FORBID_CONTENTS = null;
  const DEFAULT_FORBID_CONTENTS = addToSet({}, ['annotation-xml', 'audio', 'colgroup', 'desc', 'foreignobject', 'head', 'iframe', 'math', 'mi', 'mn', 'mo', 'ms', 'mtext', 'noembed', 'noframes', 'noscript', 'plaintext', 'script', 'style', 'svg', 'template', 'thead', 'title', 'video', 'xmp']);
  /* Tags that are safe for data: URIs */

  let DATA_URI_TAGS = null;
  const DEFAULT_DATA_URI_TAGS = addToSet({}, ['audio', 'video', 'img', 'source', 'image', 'track']);
  /* Attributes safe for values like "javascript:" */

  let URI_SAFE_ATTRIBUTES = null;
  const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ['alt', 'class', 'for', 'id', 'label', 'name', 'pattern', 'placeholder', 'role', 'summary', 'title', 'value', 'style', 'xmlns']);
  const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';
  const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';
  const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';
  /* Document namespace */

  let NAMESPACE = HTML_NAMESPACE;
  let IS_EMPTY_INPUT = false;
  /* Allowed XHTML+XML namespaces */

  let ALLOWED_NAMESPACES = null;
  const DEFAULT_ALLOWED_NAMESPACES = addToSet({}, [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE], stringToString);
  /* Parsing of strict XHTML documents */

  let PARSER_MEDIA_TYPE;
  const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];
  const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';
  let transformCaseFunc;
  /* Keep a reference to config to pass to hooks */

  let CONFIG = null;
  /* Ideally, do not touch anything below this line */

  /* ______________________________________________ */

  const formElement = document.createElement('form');

  const isRegexOrFunction = function isRegexOrFunction(testValue) {
    return testValue instanceof RegExp || testValue instanceof Function;
  };
  /**
   * _parseConfig
   *
   * @param  {Object} cfg optional config literal
   */
  // eslint-disable-next-line complexity


  const _parseConfig = function _parseConfig(cfg) {
    if (CONFIG && CONFIG === cfg) {
      return;
    }
    /* Shield configuration object from tampering */


    if (!cfg || typeof cfg !== 'object') {
      cfg = {};
    }
    /* Shield configuration object from prototype pollution */


    cfg = clone(cfg);
    PARSER_MEDIA_TYPE = // eslint-disable-next-line unicorn/prefer-includes
    SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? PARSER_MEDIA_TYPE = DEFAULT_PARSER_MEDIA_TYPE : PARSER_MEDIA_TYPE = cfg.PARSER_MEDIA_TYPE; // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.

    transformCaseFunc = PARSER_MEDIA_TYPE === 'application/xhtml+xml' ? stringToString : stringToLowerCase;
    /* Set configuration parameters */

    ALLOWED_TAGS = 'ALLOWED_TAGS' in cfg ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;
    ALLOWED_ATTR = 'ALLOWED_ATTR' in cfg ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;
    ALLOWED_NAMESPACES = 'ALLOWED_NAMESPACES' in cfg ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString) : DEFAULT_ALLOWED_NAMESPACES;
    URI_SAFE_ATTRIBUTES = 'ADD_URI_SAFE_ATTR' in cfg ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES), // eslint-disable-line indent
    cfg.ADD_URI_SAFE_ATTR, // eslint-disable-line indent
    transformCaseFunc // eslint-disable-line indent
    ) // eslint-disable-line indent
    : DEFAULT_URI_SAFE_ATTRIBUTES;
    DATA_URI_TAGS = 'ADD_DATA_URI_TAGS' in cfg ? addToSet(clone(DEFAULT_DATA_URI_TAGS), // eslint-disable-line indent
    cfg.ADD_DATA_URI_TAGS, // eslint-disable-line indent
    transformCaseFunc // eslint-disable-line indent
    ) // eslint-disable-line indent
    : DEFAULT_DATA_URI_TAGS;
    FORBID_CONTENTS = 'FORBID_CONTENTS' in cfg ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;
    FORBID_TAGS = 'FORBID_TAGS' in cfg ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : {};
    FORBID_ATTR = 'FORBID_ATTR' in cfg ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : {};
    USE_PROFILES = 'USE_PROFILES' in cfg ? cfg.USE_PROFILES : false;
    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true

    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true

    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false

    ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true

    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false

    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false

    RETURN_DOM = cfg.RETURN_DOM || false; // Default false

    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false

    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false

    FORCE_BODY = cfg.FORCE_BODY || false; // Default false

    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true

    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false

    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true

    IN_PLACE = cfg.IN_PLACE || false; // Default false

    IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI;
    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;
    CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};

    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {
      CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;
    }

    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {
      CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;
    }

    if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === 'boolean') {
      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;
    }

    if (SAFE_FOR_TEMPLATES) {
      ALLOW_DATA_ATTR = false;
    }

    if (RETURN_DOM_FRAGMENT) {
      RETURN_DOM = true;
    }
    /* Parse profile info */


    if (USE_PROFILES) {
      ALLOWED_TAGS = addToSet({}, [...text]);
      ALLOWED_ATTR = [];

      if (USE_PROFILES.html === true) {
        addToSet(ALLOWED_TAGS, html$1);
        addToSet(ALLOWED_ATTR, html);
      }

      if (USE_PROFILES.svg === true) {
        addToSet(ALLOWED_TAGS, svg$1);
        addToSet(ALLOWED_ATTR, svg);
        addToSet(ALLOWED_ATTR, xml);
      }

      if (USE_PROFILES.svgFilters === true) {
        addToSet(ALLOWED_TAGS, svgFilters);
        addToSet(ALLOWED_ATTR, svg);
        addToSet(ALLOWED_ATTR, xml);
      }

      if (USE_PROFILES.mathMl === true) {
        addToSet(ALLOWED_TAGS, mathMl$1);
        addToSet(ALLOWED_ATTR, mathMl);
        addToSet(ALLOWED_ATTR, xml);
      }
    }
    /* Merge configuration parameters */


    if (cfg.ADD_TAGS) {
      if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {
        ALLOWED_TAGS = clone(ALLOWED_TAGS);
      }

      addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);
    }

    if (cfg.ADD_ATTR) {
      if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {
        ALLOWED_ATTR = clone(ALLOWED_ATTR);
      }

      addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);
    }

    if (cfg.ADD_URI_SAFE_ATTR) {
      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);
    }

    if (cfg.FORBID_CONTENTS) {
      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {
        FORBID_CONTENTS = clone(FORBID_CONTENTS);
      }

      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);
    }
    /* Add #text in case KEEP_CONTENT is set to true */


    if (KEEP_CONTENT) {
      ALLOWED_TAGS['#text'] = true;
    }
    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */


    if (WHOLE_DOCUMENT) {
      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);
    }
    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */


    if (ALLOWED_TAGS.table) {
      addToSet(ALLOWED_TAGS, ['tbody']);
      delete FORBID_TAGS.tbody;
    }

    if (cfg.TRUSTED_TYPES_POLICY) {
      if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== 'function') {
        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');
      }

      if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== 'function') {
        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');
      } // Overwrite existing TrustedTypes policy.


      trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY; // Sign local variables required by `sanitize`.

      emptyHTML = trustedTypesPolicy.createHTML('');
    } else {
      // Uninitialized policy, attempt to initialize the internal dompurify policy.
      if (trustedTypesPolicy === undefined) {
        trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, currentScript);
      } // If creating the internal policy succeeded sign internal variables.


      if (trustedTypesPolicy !== null && typeof emptyHTML === 'string') {
        emptyHTML = trustedTypesPolicy.createHTML('');
      }
    } // Prevent further manipulation of configuration.
    // Not available in IE8, Safari 5, etc.


    if (freeze) {
      freeze(cfg);
    }

    CONFIG = cfg;
  };

  const MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ['mi', 'mo', 'mn', 'ms', 'mtext']);
  const HTML_INTEGRATION_POINTS = addToSet({}, ['foreignobject', 'desc', 'title', 'annotation-xml']); // Certain elements are allowed in both SVG and HTML
  // namespace. We need to specify them explicitly
  // so that they don't get erroneously deleted from
  // HTML namespace.

  const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ['title', 'style', 'font', 'a', 'script']);
  /* Keep track of all possible SVG and MathML tags
   * so that we can perform the namespace checks
   * correctly. */

  const ALL_SVG_TAGS = addToSet({}, svg$1);
  addToSet(ALL_SVG_TAGS, svgFilters);
  addToSet(ALL_SVG_TAGS, svgDisallowed);
  const ALL_MATHML_TAGS = addToSet({}, mathMl$1);
  addToSet(ALL_MATHML_TAGS, mathMlDisallowed);
  /**
   *
   *
   * @param  {Element} element a DOM element whose namespace is being checked
   * @returns {boolean} Return false if the element has a
   *  namespace that a spec-compliant parser would never
   *  return. Return true otherwise.
   */

  const _checkValidNamespace = function _checkValidNamespace(element) {
    let parent = getParentNode(element); // In JSDOM, if we're inside shadow DOM, then parentNode
    // can be null. We just simulate parent in this case.

    if (!parent || !parent.tagName) {
      parent = {
        namespaceURI: NAMESPACE,
        tagName: 'template'
      };
    }

    const tagName = stringToLowerCase(element.tagName);
    const parentTagName = stringToLowerCase(parent.tagName);

    if (!ALLOWED_NAMESPACES[element.namespaceURI]) {
      return false;
    }

    if (element.namespaceURI === SVG_NAMESPACE) {
      // The only way to switch from HTML namespace to SVG
      // is via <svg>. If it happens via any other tag, then
      // it should be killed.
      if (parent.namespaceURI === HTML_NAMESPACE) {
        return tagName === 'svg';
      } // The only way to switch from MathML to SVG is via`
      // svg if parent is either <annotation-xml> or MathML
      // text integration points.


      if (parent.namespaceURI === MATHML_NAMESPACE) {
        return tagName === 'svg' && (parentTagName === 'annotation-xml' || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);
      } // We only allow elements that are defined in SVG
      // spec. All others are disallowed in SVG namespace.


      return Boolean(ALL_SVG_TAGS[tagName]);
    }

    if (element.namespaceURI === MATHML_NAMESPACE) {
      // The only way to switch from HTML namespace to MathML
      // is via <math>. If it happens via any other tag, then
      // it should be killed.
      if (parent.namespaceURI === HTML_NAMESPACE) {
        return tagName === 'math';
      } // The only way to switch from SVG to MathML is via
      // <math> and HTML integration points


      if (parent.namespaceURI === SVG_NAMESPACE) {
        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];
      } // We only allow elements that are defined in MathML
      // spec. All others are disallowed in MathML namespace.


      return Boolean(ALL_MATHML_TAGS[tagName]);
    }

    if (element.namespaceURI === HTML_NAMESPACE) {
      // The only way to switch from SVG to HTML is via
      // HTML integration points, and from MathML to HTML
      // is via MathML text integration points
      if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {
        return false;
      }

      if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {
        return false;
      } // We disallow tags that are specific for MathML
      // or SVG and should never appear in HTML namespace


      return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);
    } // For XHTML and XML documents that support custom namespaces


    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && ALLOWED_NAMESPACES[element.namespaceURI]) {
      return true;
    } // The code should never reach this place (this means
    // that the element somehow got namespace that is not
    // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).
    // Return false just in case.


    return false;
  };
  /**
   * _forceRemove
   *
   * @param  {Node} node a DOM node
   */


  const _forceRemove = function _forceRemove(node) {
    arrayPush(DOMPurify.removed, {
      element: node
    });

    try {
      // eslint-disable-next-line unicorn/prefer-dom-node-remove
      node.parentNode.removeChild(node);
    } catch (_) {
      node.remove();
    }
  };
  /**
   * _removeAttribute
   *
   * @param  {String} name an Attribute name
   * @param  {Node} node a DOM node
   */


  const _removeAttribute = function _removeAttribute(name, node) {
    try {
      arrayPush(DOMPurify.removed, {
        attribute: node.getAttributeNode(name),
        from: node
      });
    } catch (_) {
      arrayPush(DOMPurify.removed, {
        attribute: null,
        from: node
      });
    }

    node.removeAttribute(name); // We void attribute values for unremovable "is"" attributes

    if (name === 'is' && !ALLOWED_ATTR[name]) {
      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {
        try {
          _forceRemove(node);
        } catch (_) {}
      } else {
        try {
          node.setAttribute(name, '');
        } catch (_) {}
      }
    }
  };
  /**
   * _initDocument
   *
   * @param  {String} dirty a string of dirty markup
   * @return {Document} a DOM, filled with the dirty markup
   */


  const _initDocument = function _initDocument(dirty) {
    /* Create a HTML document */
    let doc;
    let leadingWhitespace;

    if (FORCE_BODY) {
      dirty = '<remove></remove>' + dirty;
    } else {
      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */
      const matches = stringMatch(dirty, /^[\r\n\t ]+/);
      leadingWhitespace = matches && matches[0];
    }

    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && NAMESPACE === HTML_NAMESPACE) {
      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)
      dirty = '<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>' + dirty + '</body></html>';
    }

    const dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;
    /*
     * Use the DOMParser API by default, fallback later if needs be
     * DOMParser not work for svg when has multiple root element.
     */

    if (NAMESPACE === HTML_NAMESPACE) {
      try {
        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);
      } catch (_) {}
    }
    /* Use createHTMLDocument in case DOMParser is not available */


    if (!doc || !doc.documentElement) {
      doc = implementation.createDocument(NAMESPACE, 'template', null);

      try {
        doc.documentElement.innerHTML = IS_EMPTY_INPUT ? emptyHTML : dirtyPayload;
      } catch (_) {// Syntax error if dirtyPayload is invalid xml
      }
    }

    const body = doc.body || doc.documentElement;

    if (dirty && leadingWhitespace) {
      body.insertBefore(document.createTextNode(leadingWhitespace), body.childNodes[0] || null);
    }
    /* Work on whole document or just its body */


    if (NAMESPACE === HTML_NAMESPACE) {
      return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? 'html' : 'body')[0];
    }

    return WHOLE_DOCUMENT ? doc.documentElement : body;
  };
  /**
   * _createIterator
   *
   * @param  {Document} root document/fragment to create iterator for
   * @return {Iterator} iterator instance
   */


  const _createIterator = function _createIterator(root) {
    return createNodeIterator.call(root.ownerDocument || root, root, // eslint-disable-next-line no-bitwise
    NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT, null, false);
  };
  /**
   * _isClobbered
   *
   * @param  {Node} elm element to check for clobbering attacks
   * @return {Boolean} true if clobbered, false if safe
   */


  const _isClobbered = function _isClobbered(elm) {
    return elm instanceof HTMLFormElement && (typeof elm.nodeName !== 'string' || typeof elm.textContent !== 'string' || typeof elm.removeChild !== 'function' || !(elm.attributes instanceof NamedNodeMap) || typeof elm.removeAttribute !== 'function' || typeof elm.setAttribute !== 'function' || typeof elm.namespaceURI !== 'string' || typeof elm.insertBefore !== 'function' || typeof elm.hasChildNodes !== 'function');
  };
  /**
   * _isNode
   *
   * @param  {Node} obj object to check whether it's a DOM node
   * @return {Boolean} true is object is a DOM node
   */


  const _isNode = function _isNode(object) {
    return typeof Node === 'object' ? object instanceof Node : object && typeof object === 'object' && typeof object.nodeType === 'number' && typeof object.nodeName === 'string';
  };
  /**
   * _executeHook
   * Execute user configurable hooks
   *
   * @param  {String} entryPoint  Name of the hook's entry point
   * @param  {Node} currentNode node to work on with the hook
   * @param  {Object} data additional hook parameters
   */


  const _executeHook = function _executeHook(entryPoint, currentNode, data) {
    if (!hooks[entryPoint]) {
      return;
    }

    arrayForEach(hooks[entryPoint], hook => {
      hook.call(DOMPurify, currentNode, data, CONFIG);
    });
  };
  /**
   * _sanitizeElements
   *
   * @protect nodeName
   * @protect textContent
   * @protect removeChild
   *
   * @param   {Node} currentNode to check for permission to exist
   * @return  {Boolean} true if node was killed, false if left alive
   */


  const _sanitizeElements = function _sanitizeElements(currentNode) {
    let content;
    /* Execute a hook if present */

    _executeHook('beforeSanitizeElements', currentNode, null);
    /* Check if element is clobbered or can clobber */


    if (_isClobbered(currentNode)) {
      _forceRemove(currentNode);

      return true;
    }
    /* Now let's check the element's type and name */


    const tagName = transformCaseFunc(currentNode.nodeName);
    /* Execute a hook if present */

    _executeHook('uponSanitizeElement', currentNode, {
      tagName,
      allowedTags: ALLOWED_TAGS
    });
    /* Detect mXSS attempts abusing namespace confusion */


    if (currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && (!_isNode(currentNode.content) || !_isNode(currentNode.content.firstElementChild)) && regExpTest(/<[/\w]/g, currentNode.innerHTML) && regExpTest(/<[/\w]/g, currentNode.textContent)) {
      _forceRemove(currentNode);

      return true;
    }
    /* Remove element if anything forbids its presence */


    if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {
      /* Check if we have a custom element to handle */
      if (!FORBID_TAGS[tagName] && _basicCustomElementTest(tagName)) {
        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)) return false;
        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)) return false;
      }
      /* Keep content except for bad-listed elements */


      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {
        const parentNode = getParentNode(currentNode) || currentNode.parentNode;
        const childNodes = getChildNodes(currentNode) || currentNode.childNodes;

        if (childNodes && parentNode) {
          const childCount = childNodes.length;

          for (let i = childCount - 1; i >= 0; --i) {
            parentNode.insertBefore(cloneNode(childNodes[i], true), getNextSibling(currentNode));
          }
        }
      }

      _forceRemove(currentNode);

      return true;
    }
    /* Check whether element has a valid namespace */


    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {
      _forceRemove(currentNode);

      return true;
    }
    /* Make sure that older browsers don't get noscript mXSS */


    if ((tagName === 'noscript' || tagName === 'noembed') && regExpTest(/<\/no(script|embed)/i, currentNode.innerHTML)) {
      _forceRemove(currentNode);

      return true;
    }
    /* Sanitize element content to be template-safe */


    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === 3) {
      /* Get the element's text content */
      content = currentNode.textContent;
      content = stringReplace(content, MUSTACHE_EXPR, ' ');
      content = stringReplace(content, ERB_EXPR, ' ');
      content = stringReplace(content, TMPLIT_EXPR, ' ');

      if (currentNode.textContent !== content) {
        arrayPush(DOMPurify.removed, {
          element: currentNode.cloneNode()
        });
        currentNode.textContent = content;
      }
    }
    /* Execute a hook if present */


    _executeHook('afterSanitizeElements', currentNode, null);

    return false;
  };
  /**
   * _isValidAttribute
   *
   * @param  {string} lcTag Lowercase tag name of containing element.
   * @param  {string} lcName Lowercase attribute name.
   * @param  {string} value Attribute value.
   * @return {Boolean} Returns true if `value` is valid, otherwise false.
   */
  // eslint-disable-next-line complexity


  const _isValidAttribute = function _isValidAttribute(lcTag, lcName, value) {
    /* Make sure attribute cannot clobber */
    if (SANITIZE_DOM && (lcName === 'id' || lcName === 'name') && (value in document || value in formElement)) {
      return false;
    }
    /* Allow valid data-* attributes: At least one character after "-"
        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)
        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)
        We don't need to check the value; it's always URI safe. */


    if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR, lcName)) ;else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) ;else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {
      if ( // First condition does a very basic check if a) it's basically a valid custom element tagname AND
      // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck
      // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck
      _basicCustomElementTest(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)) || // Alternative, second condition checks if it's an `is`-attribute, AND
      // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck
      lcName === 'is' && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))) ;else {
        return false;
      }
      /* Check value is safe. First, is attr inert? If so, is safe */
    } else if (URI_SAFE_ATTRIBUTES[lcName]) ;else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE, ''))) ;else if ((lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') && lcTag !== 'script' && stringIndexOf(value, 'data:') === 0 && DATA_URI_TAGS[lcTag]) ;else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))) ;else if (value) {
      return false;
    } else ;
    return true;
  };
  /**
   * _basicCustomElementCheck
   * checks if at least one dash is included in tagName, and it's not the first char
   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name
   * @param {string} tagName name of the tag of the node to sanitize
   */


  const _basicCustomElementTest = function _basicCustomElementTest(tagName) {
    return tagName.indexOf('-') > 0;
  };
  /**
   * _sanitizeAttributes
   *
   * @protect attributes
   * @protect nodeName
   * @protect removeAttribute
   * @protect setAttribute
   *
   * @param  {Node} currentNode to sanitize
   */


  const _sanitizeAttributes = function _sanitizeAttributes(currentNode) {
    let attr;
    let value;
    let lcName;
    let l;
    /* Execute a hook if present */

    _executeHook('beforeSanitizeAttributes', currentNode, null);

    const {
      attributes
    } = currentNode;
    /* Check if we have attributes; if not we might have a text node */

    if (!attributes) {
      return;
    }

    const hookEvent = {
      attrName: '',
      attrValue: '',
      keepAttr: true,
      allowedAttributes: ALLOWED_ATTR
    };
    l = attributes.length;
    /* Go backwards over all attributes; safely remove bad ones */

    while (l--) {
      attr = attributes[l];
      const {
        name,
        namespaceURI
      } = attr;
      value = name === 'value' ? attr.value : stringTrim(attr.value);
      lcName = transformCaseFunc(name);
      /* Execute a hook if present */

      hookEvent.attrName = lcName;
      hookEvent.attrValue = value;
      hookEvent.keepAttr = true;
      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set

      _executeHook('uponSanitizeAttribute', currentNode, hookEvent);

      value = hookEvent.attrValue;
      /* Did the hooks approve of the attribute? */

      if (hookEvent.forceKeepAttr) {
        continue;
      }
      /* Remove attribute */


      _removeAttribute(name, currentNode);
      /* Did the hooks approve of the attribute? */


      if (!hookEvent.keepAttr) {
        continue;
      }
      /* Work around a security issue in jQuery 3.0 */


      if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\/>/i, value)) {
        _removeAttribute(name, currentNode);

        continue;
      }
      /* Sanitize attribute content to be template-safe */


      if (SAFE_FOR_TEMPLATES) {
        value = stringReplace(value, MUSTACHE_EXPR, ' ');
        value = stringReplace(value, ERB_EXPR, ' ');
        value = stringReplace(value, TMPLIT_EXPR, ' ');
      }
      /* Is `value` valid for this attribute? */


      const lcTag = transformCaseFunc(currentNode.nodeName);

      if (!_isValidAttribute(lcTag, lcName, value)) {
        continue;
      }
      /* Full DOM Clobbering protection via namespace isolation,
       * Prefix id and name attributes with `user-content-`
       */


      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {
        // Remove the attribute with this value
        _removeAttribute(name, currentNode); // Prefix the value and later re-create the attribute with the sanitized value


        value = SANITIZE_NAMED_PROPS_PREFIX + value;
      }
      /* Handle attributes that require Trusted Types */


      if (trustedTypesPolicy && typeof trustedTypes === 'object' && typeof trustedTypes.getAttributeType === 'function') {
        if (namespaceURI) ;else {
          switch (trustedTypes.getAttributeType(lcTag, lcName)) {
            case 'TrustedHTML':
              {
                value = trustedTypesPolicy.createHTML(value);
                break;
              }

            case 'TrustedScriptURL':
              {
                value = trustedTypesPolicy.createScriptURL(value);
                break;
              }
          }
        }
      }
      /* Handle invalid data-* attribute set by try-catching it */


      try {
        if (namespaceURI) {
          currentNode.setAttributeNS(namespaceURI, name, value);
        } else {
          /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. "x-schema". */
          currentNode.setAttribute(name, value);
        }

        arrayPop(DOMPurify.removed);
      } catch (_) {}
    }
    /* Execute a hook if present */


    _executeHook('afterSanitizeAttributes', currentNode, null);
  };
  /**
   * _sanitizeShadowDOM
   *
   * @param  {DocumentFragment} fragment to iterate over recursively
   */


  const _sanitizeShadowDOM = function _sanitizeShadowDOM(fragment) {
    let shadowNode;

    const shadowIterator = _createIterator(fragment);
    /* Execute a hook if present */


    _executeHook('beforeSanitizeShadowDOM', fragment, null);

    while (shadowNode = shadowIterator.nextNode()) {
      /* Execute a hook if present */
      _executeHook('uponSanitizeShadowNode', shadowNode, null);
      /* Sanitize tags and elements */


      if (_sanitizeElements(shadowNode)) {
        continue;
      }
      /* Deep shadow DOM detected */


      if (shadowNode.content instanceof DocumentFragment) {
        _sanitizeShadowDOM(shadowNode.content);
      }
      /* Check attributes, sanitize if necessary */


      _sanitizeAttributes(shadowNode);
    }
    /* Execute a hook if present */


    _executeHook('afterSanitizeShadowDOM', fragment, null);
  };
  /**
   * Sanitize
   * Public method providing core sanitation functionality
   *
   * @param {String|Node} dirty string or DOM node
   * @param {Object} configuration object
   */
  // eslint-disable-next-line complexity


  DOMPurify.sanitize = function (dirty) {
    let cfg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    let body;
    let importedNode;
    let currentNode;
    let returnNode;
    /* Make sure we have a string to sanitize.
      DO NOT return early, as this will return the wrong type if
      the user has requested a DOM object rather than a string */

    IS_EMPTY_INPUT = !dirty;

    if (IS_EMPTY_INPUT) {
      dirty = '<!-->';
    }
    /* Stringify, in case dirty is an object */


    if (typeof dirty !== 'string' && !_isNode(dirty)) {
      if (typeof dirty.toString === 'function') {
        dirty = dirty.toString();

        if (typeof dirty !== 'string') {
          throw typeErrorCreate('dirty is not a string, aborting');
        }
      } else {
        throw typeErrorCreate('toString is not a function');
      }
    }
    /* Return dirty HTML if DOMPurify cannot run */


    if (!DOMPurify.isSupported) {
      return dirty;
    }
    /* Assign config vars */


    if (!SET_CONFIG) {
      _parseConfig(cfg);
    }
    /* Clean up removed elements */


    DOMPurify.removed = [];
    /* Check if dirty is correctly typed for IN_PLACE */

    if (typeof dirty === 'string') {
      IN_PLACE = false;
    }

    if (IN_PLACE) {
      /* Do some early pre-sanitization to avoid unsafe root nodes */
      if (dirty.nodeName) {
        const tagName = transformCaseFunc(dirty.nodeName);

        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {
          throw typeErrorCreate('root node is forbidden and cannot be sanitized in-place');
        }
      }
    } else if (dirty instanceof Node) {
      /* If dirty is a DOM element, append to an empty document to avoid
         elements being stripped by the parser */
      body = _initDocument('<!---->');
      importedNode = body.ownerDocument.importNode(dirty, true);

      if (importedNode.nodeType === 1 && importedNode.nodeName === 'BODY') {
        /* Node is already a body, use as is */
        body = importedNode;
      } else if (importedNode.nodeName === 'HTML') {
        body = importedNode;
      } else {
        // eslint-disable-next-line unicorn/prefer-dom-node-append
        body.appendChild(importedNode);
      }
    } else {
      /* Exit directly if we have nothing to do */
      if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT && // eslint-disable-next-line unicorn/prefer-includes
      dirty.indexOf('<') === -1) {
        return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;
      }
      /* Initialize the document to work on */


      body = _initDocument(dirty);
      /* Check we have a DOM node from the data */

      if (!body) {
        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';
      }
    }
    /* Remove first element node (ours) if FORCE_BODY is set */


    if (body && FORCE_BODY) {
      _forceRemove(body.firstChild);
    }
    /* Get node iterator */


    const nodeIterator = _createIterator(IN_PLACE ? dirty : body);
    /* Now start iterating over the created document */


    while (currentNode = nodeIterator.nextNode()) {
      /* Sanitize tags and elements */
      if (_sanitizeElements(currentNode)) {
        continue;
      }
      /* Shadow DOM detected, sanitize it */


      if (currentNode.content instanceof DocumentFragment) {
        _sanitizeShadowDOM(currentNode.content);
      }
      /* Check attributes, sanitize if necessary */


      _sanitizeAttributes(currentNode);
    }
    /* If we sanitized `dirty` in-place, return it. */


    if (IN_PLACE) {
      return dirty;
    }
    /* Return sanitized string or DOM */


    if (RETURN_DOM) {
      if (RETURN_DOM_FRAGMENT) {
        returnNode = createDocumentFragment.call(body.ownerDocument);

        while (body.firstChild) {
          // eslint-disable-next-line unicorn/prefer-dom-node-append
          returnNode.appendChild(body.firstChild);
        }
      } else {
        returnNode = body;
      }

      if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmod) {
        /*
          AdoptNode() is not used because internal state is not reset
          (e.g. the past names map of a HTMLFormElement), this is safe
          in theory but we would rather not risk another attack vector.
          The state that is cloned by importNode() is explicitly defined
          by the specs.
        */
        returnNode = importNode.call(originalDocument, returnNode, true);
      }

      return returnNode;
    }

    let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;
    /* Serialize doctype if allowed */

    if (WHOLE_DOCUMENT && ALLOWED_TAGS['!doctype'] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {
      serializedHTML = '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\n' + serializedHTML;
    }
    /* Sanitize final string template-safe */


    if (SAFE_FOR_TEMPLATES) {
      serializedHTML = stringReplace(serializedHTML, MUSTACHE_EXPR, ' ');
      serializedHTML = stringReplace(serializedHTML, ERB_EXPR, ' ');
      serializedHTML = stringReplace(serializedHTML, TMPLIT_EXPR, ' ');
    }

    return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;
  };
  /**
   * Public method to set the configuration once
   * setConfig
   *
   * @param {Object} cfg configuration object
   */


  DOMPurify.setConfig = function (cfg) {
    _parseConfig(cfg);

    SET_CONFIG = true;
  };
  /**
   * Public method to remove the configuration
   * clearConfig
   *
   */


  DOMPurify.clearConfig = function () {
    CONFIG = null;
    SET_CONFIG = false;
  };
  /**
   * Public method to check if an attribute value is valid.
   * Uses last set config, if any. Otherwise, uses config defaults.
   * isValidAttribute
   *
   * @param  {string} tag Tag name of containing element.
   * @param  {string} attr Attribute name.
   * @param  {string} value Attribute value.
   * @return {Boolean} Returns true if `value` is valid. Otherwise, returns false.
   */


  DOMPurify.isValidAttribute = function (tag, attr, value) {
    /* Initialize shared config vars if necessary. */
    if (!CONFIG) {
      _parseConfig({});
    }

    const lcTag = transformCaseFunc(tag);
    const lcName = transformCaseFunc(attr);
    return _isValidAttribute(lcTag, lcName, value);
  };
  /**
   * AddHook
   * Public method to add DOMPurify hooks
   *
   * @param {String} entryPoint entry point for the hook to add
   * @param {Function} hookFunction function to execute
   */


  DOMPurify.addHook = function (entryPoint, hookFunction) {
    if (typeof hookFunction !== 'function') {
      return;
    }

    hooks[entryPoint] = hooks[entryPoint] || [];
    arrayPush(hooks[entryPoint], hookFunction);
  };
  /**
   * RemoveHook
   * Public method to remove a DOMPurify hook at a given entryPoint
   * (pops it from the stack of hooks if more are present)
   *
   * @param {String} entryPoint entry point for the hook to remove
   * @return {Function} removed(popped) hook
   */


  DOMPurify.removeHook = function (entryPoint) {
    if (hooks[entryPoint]) {
      return arrayPop(hooks[entryPoint]);
    }
  };
  /**
   * RemoveHooks
   * Public method to remove all DOMPurify hooks at a given entryPoint
   *
   * @param  {String} entryPoint entry point for the hooks to remove
   */


  DOMPurify.removeHooks = function (entryPoint) {
    if (hooks[entryPoint]) {
      hooks[entryPoint] = [];
    }
  };
  /**
   * RemoveAllHooks
   * Public method to remove all DOMPurify hooks
   *
   */


  DOMPurify.removeAllHooks = function () {
    hooks = {};
  };

  return DOMPurify;
}

var purify = createDOMPurify();
var purify_cjs = purify;

const TEXT_MESSAGE_BODY_CLASSNAME = 'sendbird-text-message-item-body';

const OG_MESSAGE_BODY_CLASSNAME = 'sendbird-og-message-item-body__text-bubble';

const USER_MENTION_PREFIX = '@';
const TOKEN_TYPES = {
  string: 'string',
  mention: 'mention',
  url: 'url',
  undetermined: 'undetermined'
};

function getUserMentionRegex(mentionedUsers, templatePrefix_) {
  const templatePrefix = templatePrefix_ || USER_MENTION_PREFIX;
  return RegExp(`(${mentionedUsers.map(u => {
    const userId = u.userId.replace( // If user.id includes these patterns, need to convert it into an escaped one
    /([.*+?^${}()|[\]\\])/g, '\\$1');
    /**
     * //{ And //} are also for escaping
     * because curly braces `{}` are metacharacters in regular expressions used to specify repetition
     */

    return `${templatePrefix}\\{${userId}\\}`;
  }).join('|')})`, 'g');
}

function identifyMentions(_ref) {
  let {
    tokens,
    mentionedUsers = [],
    templatePrefix = USER_MENTION_PREFIX
  } = _ref;

  if (!(mentionedUsers !== null && mentionedUsers !== void 0 && mentionedUsers.length)) {
    return tokens;
  }

  const userMentionRegex = getUserMentionRegex(mentionedUsers, templatePrefix);
  const results = tokens.map(token => {
    // if the token is not undetermined, return it as is
    // is kinda unnecessary with TS, but just in case
    if (token.type !== TOKEN_TYPES.undetermined) {
      return token;
    }

    const {
      value
    } = token;
    const parts = value.split(userMentionRegex);
    const tokens = parts.map(part => {
      if (part.match(userMentionRegex)) {
        const matchedUser = mentionedUsers.find(user => `@{${user === null || user === void 0 ? void 0 : user.userId}}` === part);
        const nickname = (matchedUser === null || matchedUser === void 0 ? void 0 : matchedUser.nickname) || '(No name)';
        return {
          value: nickname,
          type: TOKEN_TYPES.mention,
          userId: matchedUser === null || matchedUser === void 0 ? void 0 : matchedUser.userId
        };
      } else {
        return {
          value: part,
          type: TOKEN_TYPES.undetermined
        };
      }
    });
    return tokens;
  }).flat();
  return results;
}

function identifyUrlsAndStrings(token) {
  const results = token.map(token => {
    if (token.type !== TOKEN_TYPES.undetermined) {
      return token;
    }

    const {
      value = ''
    } = token;
    const parts = value.split(' ');
    const tokens = parts.map(part => {
      if (isUrl(part)) {
        return {
          value: part,
          type: TOKEN_TYPES.url
        };
      } else {
        return {
          value: part,
          type: TOKEN_TYPES.string
        };
      }
    });
    return tokens;
  }).flat();
  return results;
}

function combineNearbyStrings(tokens) {
  const results = tokens.reduce((acc, token) => {
    const lastToken = acc[acc.length - 1];

    if ((lastToken === null || lastToken === void 0 ? void 0 : lastToken.type) === TOKEN_TYPES.string && token.type === TOKEN_TYPES.string) {
      lastToken.value = `${lastToken.value} ${token.value}`;
      return acc;
    }

    return [...acc, token];
  }, []);
  return results;
}
/**
 * Converts text into set of rich tokens
 */


function tokenizeMessage(_ref2) {
  let {
    messageText,
    mentionedUsers = [],
    templatePrefix = USER_MENTION_PREFIX
  } = _ref2; // mention can be squeezed-in(no-space-between) with other mentions and urls
  // if no users are mentioned, return the messageText as a single token

  const partialResult = [{
    type: TOKEN_TYPES.undetermined,
    value: messageText
  }]; // order is important because we want to identify mentions first
  // identifyMentions will return a token with type mention or undetermined

  const partialWithMentions = identifyMentions({
    tokens: partialResult,
    mentionedUsers,
    templatePrefix
  });
  const partialsWithUrlsAndMentions = identifyUrlsAndStrings(partialWithMentions);
  const result = combineNearbyStrings(partialsWithUrlsAndMentions);
  return result;
}
/**
 * Don't need to use this util in DOM element since the white spaces will be kept as is,
 * but will need if the text is wrapped \w React.Fragement or </>
 * @link https://sendbird.slack.com/archives/GPGHESTL3/p1681180484341369
 * Or!!! -> convert any space or tab in leading/trailing to nbsp
 * to preserve the leading & trailing white spaces
 */


function getWhiteSpacePreservedText(text) {
  const NON_BREAKING_SPACE = '\u00A0'; // Split the input string into lines

  const lines = text.split('\n'); // Process each line and convert leading and trailing white spaces to "\u00A0"

  const processedLines = lines.map(line => {
    var _line$match, _line$match2;

    const leadingWhitespace = ((_line$match = line.match(/^\s*/)) === null || _line$match === void 0 ? void 0 : _line$match[0]) || '';
    const trailingWhitespace = ((_line$match2 = line.match(/\s*$/)) === null || _line$match2 === void 0 ? void 0 : _line$match2[0]) || '';
    const convertedLeadingWhitespace = leadingWhitespace.replace(/ /g, NON_BREAKING_SPACE);
    const convertedTrailingWhitespace = trailingWhitespace.replace(/ /g, NON_BREAKING_SPACE);
    return convertedLeadingWhitespace + line.trim() + convertedTrailingWhitespace;
  }); // Combine the processed lines into a new string with "\n"

  const result = processedLines.join('\n');
  return result;
}

function renderToString(_ref) {
  let {
    userId,
    nickname
  } = _ref; // donot change this template, it wont work

  const el = `<span data-userid="${userId}" data-sb-mention="true" class="${MENTION_USER_LABEL_CLASSNAME}">${nickname}</span>`;
  const purifier = purify_cjs(window);
  const sanitized_ = purifier.sanitize(el);
  const token = sanitized_.split(' ');
  const [spanTag, ...rest] = token; // we do this because DOMPurify removes the contenteditable attribute

  const sanitized = [spanTag, 'contenteditable="false"', ...rest].join(' ');
  return sanitized;
} // https://davidwalsh.name/javascript-debounce-function
// Sanitize that special characters of HTML tags cause XSS issue


const sanitizeString = str => str === null || str === void 0 ? void 0 : str.replace(/[\u00A0-\u9999<>]/gim, i => ''.concat('&#', i.charCodeAt(0), ';'));
/**
 * NodeList cannot be used with Array methods
 * @param {childNodes} NodeList
 * @returns Array of child nodes
 */


const nodeListToArray = childNodes => {
  try {
    return Array.from(childNodes);
  } catch (error) {
    return [];
  }
};

function inserTemplateToDOM(templateList) {
  const nodes = templateList.map(template => {
    const {
      text,
      userId
    } = template;

    if (userId) {
      return renderToString({
        userId,
        nickname: text
      });
    }

    return sanitizeString(text);
  }).join(' ') // add a space at the end of the mention, else cursor/caret wont work
  .concat(' ');
  document.execCommand('insertHTML', false, nodes);
}

const PASTE_NODE = 'sendbird-uikit__paste-node';
const TEXT_MESSAGE_CLASS = 'sendbird-word';
const MENTION_CLASS = 'sendbird-word__mention';
const MENTION_CLASS_IN_INPUT = 'sendbird-mention-user-label';
const MENTION_CLASS_COMBINED_QUERY = `.${MENTION_CLASS}, .${MENTION_CLASS_IN_INPUT}`;

function querySelectorIncludingSelf(master, selector) {
  const result = [master, ...Array.from(master.querySelectorAll(selector))].find(el => el.matches(selector));
  return result;
} // Pasted dom node can be OG_MESSAGE or partial message or full message
// full messsage would have TEXT_MESSAGE_BODY_CLASSNAME and have childNodes
// partial message would not have TEXT_MESSAGE_BODY_CLASSNAME


function getLeafNodes(master) {
  // og message
  const ogMessage = querySelectorIncludingSelf(master, `.${OG_MESSAGE_BODY_CLASSNAME}`);

  if (ogMessage) {
    return nodeListToArray(ogMessage.childNodes);
  }

  const textMessageBody = querySelectorIncludingSelf(master, `.${TEXT_MESSAGE_BODY_CLASSNAME}`);

  if (textMessageBody) {
    return nodeListToArray(textMessageBody.childNodes);
  }

  return nodeListToArray(master.childNodes);
}

function createPasteNode() {
  const pasteNode = document.body.querySelector(`#${PASTE_NODE}`); // remove existing paste node

  if (pasteNode) {
    pasteNode === null || pasteNode === void 0 ? void 0 : pasteNode.remove();
  } // create new paste node and return


  const node = document.createElement('div');
  node.id = PASTE_NODE;
  node.style.display = 'none';
  return node;
}

function hasMention(parent) {
  return parent !== null && parent !== void 0 && parent.querySelector(MENTION_CLASS_COMBINED_QUERY) ? true : false;
}

const extractTextFromNodes = nodes => {
  let text = '';
  nodes.forEach(node => {
    // to preserve space between words
    const textNodes = node.querySelectorAll(`.${TEXT_MESSAGE_CLASS}`);

    if (textNodes.length > 0) {
      text += extractTextFromNodes(Array.from(textNodes)) + ' ';
    }

    text += node.innerText + ' ';
  });
  return text;
};

function domToMessageTemplate(nodeArray) {
  const templates = nodeArray === null || nodeArray === void 0 ? void 0 : nodeArray.reduce((accumulator, currentValue) => {
    // currentValue can be node(from messageBody or messageInput) or text
    let mentionNode; // this looks awkward, but it is a fallback to set default text

    let text = currentValue === null || currentValue === void 0 ? void 0 : currentValue.innerText; // if text node, set text

    if (currentValue instanceof Text) {
      mentionNode = false;
      text = currentValue.textContent;
    }

    if (currentValue instanceof HTMLElement) {
      mentionNode = currentValue.classList.contains(MENTION_CLASS) || currentValue.classList.contains(MENTION_CLASS_IN_INPUT) ? currentValue : currentValue.querySelector(MENTION_CLASS_COMBINED_QUERY);
    } // if mentionNode is not null, it is a mention


    if (mentionNode) {
      var _mentionNode$dataset;

      const text = currentValue === null || currentValue === void 0 ? void 0 : currentValue.innerText;
      const userId = (_mentionNode$dataset = mentionNode.dataset) === null || _mentionNode$dataset === void 0 ? void 0 : _mentionNode$dataset.userid;
      return [...accumulator, {
        text,
        userId
      }];
    }

    return [...accumulator, {
      text
    }];
  }, []);
  return templates;
}

function getUsersFromWords(templates, channel) {
  const userMap = {};
  const users = channel.members;
  templates.forEach(template => {
    if (template.userId) {
      const mentionedMember = users.find(user => user.userId === template.userId); // Object.values would return array-> [undefined] if the user is not in the channel

      if (mentionedMember) {
        userMap[template.userId] = mentionedMember;
      }
    }
  });
  return Object.values(userMap);
} // conditions to test:
// 1. paste simple text
// 2. paste text with mention
// 3. paste text with mention and text
// 4. paste text with mention and text and paste again before and after
// 5. copy message with mention(only one mention, no other text) and paste
// 6. copy message with mention from input and paste(before and after)


function usePaste(_ref) {
  let {
    ref,
    setIsInput,
    setHeight,
    channel,
    setMentionedUsers
  } = _ref;
  return useCallback(e => {
    e.preventDefault();
    const html = e === null || e === void 0 ? void 0 : e.clipboardData.getData('text/html'); // simple text, continue as normal

    if (!html) {
      const text = e === null || e === void 0 ? void 0 : e.clipboardData.getData('text');
      document.execCommand('insertHTML', false, sanitizeString(text));
      setIsInput(true);
      setHeight();
      return;
    } // has html, check if there are mentions, sanitize and insert


    const purifier = purify_cjs(window);
    const clean = purifier.sanitize(html);
    const pasteNode = createPasteNode();
    pasteNode.innerHTML = clean; // does not have mention, continue as normal

    if (!hasMention(pasteNode)) {
      // to preserve space between words
      const text = extractTextFromNodes(Array.from(pasteNode.children));
      document.execCommand('insertHTML', false, sanitizeString(text));
      pasteNode.remove();
      setIsInput(true);
      setHeight();
      return;
    } // has mention, collect leaf nodes and parse words


    const leafNodes = getLeafNodes(pasteNode);
    const words = domToMessageTemplate(leafNodes);
    const mentionedUsers = getUsersFromWords(words, channel); // side effects

    setMentionedUsers(mentionedUsers);
    inserTemplateToDOM(words);
    pasteNode.remove();
    setIsInput(true);
    setHeight();
  }, [ref, setIsInput, setHeight, channel, setMentionedUsers]);
}
/**
 * Write new utils here
 * Migrate old utils as needed, and delete utils.js
 */

/**
 * FIXME:
 * Import this ChannelType enum from @sendbird/chat
 * once MessageInput.spec unit tests can be run \wo jest <-> ESM issue
 */


var ChannelType = /*#__PURE__*/function (ChannelType) {
  ChannelType["BASE"] = "base";
  ChannelType["GROUP"] = "group";
  ChannelType["OPEN"] = "open";
  return ChannelType;
}(ChannelType || {});
/**
 * FIXME: Simplify this in UIKit@v4
 * If customer is using MessageInput inside our modules(ie: Channel, Thread, etc),
 * we should use the config from the module.
 * If customer is using MessageInput outside our modules(ie: custom UI),
 * we expect Channel to be undefined and customer gets control to show/hide file-upload.
 * @param {*} channel GroupChannel | OpenChannel
 * @param {*} config SendBirdStateConfig
 * @returns boolean
 */


const checkIfFileUploadEnabled = _ref => {
  let {
    channel,
    config
  } = _ref;
  const isEnabled = K$1(channel === null || channel === void 0 ? void 0 : channel.channelType).with(ChannelType.GROUP, () => {
    var _config$groupChannel;

    return config === null || config === void 0 ? void 0 : (_config$groupChannel = config.groupChannel) === null || _config$groupChannel === void 0 ? void 0 : _config$groupChannel.enableDocument;
  }).with(ChannelType.OPEN, () => {
    var _config$openChannel;

    return config === null || config === void 0 ? void 0 : (_config$openChannel = config.openChannel) === null || _config$openChannel === void 0 ? void 0 : _config$openChannel.enableDocument;
  }).otherwise(() => true);
  return isEnabled;
};

const TEXT_FIELD_ID = 'sendbird-message-input-text-field';
const LINE_HEIGHT = 76;

const noop = () => {};

const handleUploadFile = callback => event => {
  if (event.target.files && event.target.files[0]) {
    callback(event.target.files[0]);
  } // eslint-disable-next-line no-param-reassign


  event.target.value = '';
};

const displayCaret = (element, position) => {
  const range = document.createRange();
  const sel = window.getSelection();
  range.setStart(element.childNodes[0], position);
  range.collapse(true);
  sel.removeAllRanges();
  sel.addRange(range);
  element.focus();
};

const resetInput = ref => {
  try {
    /* eslint-disable no-param-reassign */
    ref.current.innerHTML = '';
  } catch (_unused) {//
  }
};

const initialTargetStringInfo = {
  targetString: '',
  startNodeIndex: null,
  startOffsetIndex: null,
  endNodeIndex: null,
  endOffsetIndex: null
};
const MessageInput = /*#__PURE__*/React__default__default.forwardRef((props, ref) => {
  var _ref$current, _ref$current$textCont, _textField$innerText;

  const {
    className,
    messageFieldId,
    isEdit,
    isMentionEnabled,
    isVoiceMessageEnabled,
    disabled,
    message,
    placeholder,
    maxLength,
    onFileUpload,
    onSendMessage,
    onUpdateMessage,
    onCancelEdit,
    onStartTyping,
    channelUrl,
    channel,
    mentionSelectedUser,
    onUserMentioned,
    onMentionStringChange,
    onMentionedUserIdsUpdated,
    onVoiceMessageIconClick,
    onKeyUp,
    onKeyDown,
    renderFileUploadIcon,
    renderVoiceMessageIcon,
    renderSendMessageIcon,
    setMentionedUsers
  } = props;
  const textFieldId = messageFieldId || TEXT_FIELD_ID;
  const {
    stringSet
  } = useLocalization();
  const {
    config
  } = useSendbirdStateContext();
  const isFileUploadEnabled = checkIfFileUploadEnabled({
    channel,
    config
  });
  const fileInputRef = useRef(null);
  const [isInput, setIsInput] = useState(false);
  const [mentionedUserIds, setMentionedUserIds] = useState([]);
  const [targetStringInfo, setTargetStringInfo] = useState(_objectSpread2({}, initialTargetStringInfo));
  const setHeight = useMemo(() => () => {
    try {
      const elem = ref === null || ref === void 0 ? void 0 : ref.current;
      const MAX_HEIGHT = window.document.body.offsetHeight * 0.6;

      if (elem && elem.scrollHeight >= LINE_HEIGHT) {
        if (MAX_HEIGHT < elem.scrollHeight) {
          elem.style.height = 'auto';
          elem.style.height = `${MAX_HEIGHT}px`;
        } else {
          elem.style.height = 'auto';
          elem.style.height = `${elem.scrollHeight}px`;
        }
      } else {
        elem.style.height = '';
      }
    } catch (error) {// error
    }
  }, []); // #Edit mode
  // for easilly initialize input value from outside, but
  // useEffect(_, [channelUrl]) erase it

  const initialValue = props === null || props === void 0 ? void 0 : props.value;
  useEffect(() => {
    var _textField$textConten;

    const textField = ref === null || ref === void 0 ? void 0 : ref.current;

    try {
      textField.innerHTML = initialValue;
      displayCaret(textField, initialValue === null || initialValue === void 0 ? void 0 : initialValue.length);
    } catch (_unused2) {//
    }

    setMentionedUserIds([]);
    setIsInput((textField === null || textField === void 0 ? void 0 : (_textField$textConten = textField.textContent) === null || _textField$textConten === void 0 ? void 0 : _textField$textConten.trim().length) > 0);
    setHeight();
  }, [initialValue]); // #Mention | Clear input value when channel changes

  useEffect(() => {
    if (!isEdit) {
      setIsInput(false);
      resetInput(ref);
    }
  }, [channelUrl]); // #Mention & #Edit | Fill message input values

  useEffect(() => {
    if (isEdit && message !== null && message !== void 0 && message.messageId) {
      var _message$mentionedUse, _message$mentionedMes, _textField$textConten2; // const textField = document.getElementById(textFieldId);


      const textField = ref === null || ref === void 0 ? void 0 : ref.current;

      if (isMentionEnabled && (message === null || message === void 0 ? void 0 : (_message$mentionedUse = message.mentionedUsers) === null || _message$mentionedUse === void 0 ? void 0 : _message$mentionedUse.length) > 0 && (message === null || message === void 0 ? void 0 : (_message$mentionedMes = message.mentionedMessageTemplate) === null || _message$mentionedMes === void 0 ? void 0 : _message$mentionedMes.length) > 0) {
        /* mention enabled */
        const {
          mentionedUsers = []
        } = message;
        const tokens = tokenizeMessage({
          messageText: message === null || message === void 0 ? void 0 : message.mentionedMessageTemplate,
          mentionedUsers
        });
        textField.innerHTML = tokens.map(token => {
          if (token.type === TOKEN_TYPES.mention) {
            const mentionedUser = mentionedUsers.find(user => user.userId === token.userId);
            const nickname = `${USER_MENTION_PREFIX}${(mentionedUser === null || mentionedUser === void 0 ? void 0 : mentionedUser.nickname) || token.value || stringSet.MENTION_NAME__NO_NAME}`;
            return renderToString({
              userId: token.userId,
              nickname
            });
          }

          return sanitizeString(token.value);
        }).join(' ');
      } else {
        /* mention disabled */
        try {
          textField.innerHTML = sanitizeString(message === null || message === void 0 ? void 0 : message.message);
        } catch (_unused3) {//
        }

        setMentionedUserIds([]);
      }

      setIsInput((textField === null || textField === void 0 ? void 0 : (_textField$textConten2 = textField.textContent) === null || _textField$textConten2 === void 0 ? void 0 : _textField$textConten2.trim().length) > 0);
      setHeight();
    }
  }, [isEdit, message]); // #Mention | Detect MentionedLabel modified

  const useMentionedLabelDetection = useCallback(() => {
    var _textField$textConten3;

    const textField = ref === null || ref === void 0 ? void 0 : ref.current;

    if (isMentionEnabled) {
      const newMentionedUserIds = [...textField.getElementsByClassName('sendbird-mention-user-label')].map(node => {
        var _node$dataset;

        return node === null || node === void 0 ? void 0 : (_node$dataset = node.dataset) === null || _node$dataset === void 0 ? void 0 : _node$dataset.userid;
      });

      if (!arrayEqual(mentionedUserIds, newMentionedUserIds) || newMentionedUserIds.length === 0) {
        onMentionedUserIdsUpdated(newMentionedUserIds);
        setMentionedUserIds(newMentionedUserIds);
      }
    }

    setIsInput(((_textField$textConten3 = textField.textContent) === null || _textField$textConten3 === void 0 ? void 0 : _textField$textConten3.trim().length) > 0);
  }, [targetStringInfo, isMentionEnabled]); // #Mention | Replace selected user nickname to the MentionedUserLabel

  useEffect(() => {
    if (isMentionEnabled && mentionSelectedUser) {
      const {
        targetString,
        startNodeIndex,
        startOffsetIndex,
        endNodeIndex,
        endOffsetIndex
      } = targetStringInfo;

      if (targetString && startNodeIndex !== null && startOffsetIndex !== null) {
        var _document, _childNodes$startNode, _document2, _childNodes$endNodeIn; // const textField = document.getElementById(textFieldId);


        const textField = ref === null || ref === void 0 ? void 0 : ref.current;
        const childNodes = nodeListToArray(textField === null || textField === void 0 ? void 0 : textField.childNodes);
        const frontTextNode = (_document = document) === null || _document === void 0 ? void 0 : _document.createTextNode((_childNodes$startNode = childNodes[startNodeIndex]) === null || _childNodes$startNode === void 0 ? void 0 : _childNodes$startNode.textContent.slice(0, startOffsetIndex));
        const backTextNode = (_document2 = document) === null || _document2 === void 0 ? void 0 : _document2.createTextNode(`\u00A0${(_childNodes$endNodeIn = childNodes[endNodeIndex]) === null || _childNodes$endNodeIn === void 0 ? void 0 : _childNodes$endNodeIn.textContent.slice(endOffsetIndex)}`);
        const mentionLabel = renderToString({
          userId: mentionSelectedUser === null || mentionSelectedUser === void 0 ? void 0 : mentionSelectedUser.userId,
          nickname: `${USER_MENTION_TEMP_CHAR}${(mentionSelectedUser === null || mentionSelectedUser === void 0 ? void 0 : mentionSelectedUser.nickname) || stringSet.MENTION_NAME__NO_NAME}`
        });
        const div = document.createElement('div');
        div.innerHTML = mentionLabel;
        const newNodes = [...childNodes.slice(0, startNodeIndex), frontTextNode, div.childNodes[0], backTextNode, ...childNodes.slice(endNodeIndex + 1)];
        textField.innerHTML = '';
        newNodes.forEach(newNode => {
          textField.appendChild(newNode);
        });
        onUserMentioned(mentionSelectedUser);

        if (window.getSelection || document.getSelection) {
          // set caret postion
          const selection = window.getSelection() || document.getSelection();
          selection.removeAllRanges();
          const range = new Range();
          range.selectNodeContents(textField);
          range.setStart(textField.childNodes[startNodeIndex + 2], 1);
          range.setEnd(textField.childNodes[startNodeIndex + 2], 1);
          range.collapse(false);
          selection.addRange(range);
          textField.focus();
        }

        setTargetStringInfo(_objectSpread2({}, initialTargetStringInfo));
        setHeight();
        useMentionedLabelDetection();
      }
    }
  }, [mentionSelectedUser, isMentionEnabled]); // #Mention | Detect mentioning user nickname

  const useMentionInputDetection = useCallback(() => {
    var _window, _window$getSelection, _document3, _document3$getSelecti;

    const selection = ((_window = window) === null || _window === void 0 ? void 0 : (_window$getSelection = _window.getSelection) === null || _window$getSelection === void 0 ? void 0 : _window$getSelection.call(_window)) || ((_document3 = document) === null || _document3 === void 0 ? void 0 : (_document3$getSelecti = _document3.getSelection) === null || _document3$getSelecti === void 0 ? void 0 : _document3$getSelecti.call(_document3));
    const textField = ref === null || ref === void 0 ? void 0 : ref.current;

    if (selection.anchorNode === textField) {
      onMentionStringChange('');
    }

    if (isMentionEnabled && selection && selection.anchorNode === selection.focusNode && selection.anchorOffset === selection.focusOffset) {
      let textStack = '';
      let startNodeIndex = null;
      let startOffsetIndex = null;

      for (let index = 0; index < textField.childNodes.length; index += 1) {
        const currentNode = textField.childNodes[index];

        if (currentNode.nodeType === NodeTypes.TextNode) {
          /* text node */
          const textContent = currentNode === selection.anchorNode ? (currentNode === null || currentNode === void 0 ? void 0 : currentNode.textContent.slice(0, selection.anchorOffset)) || '' : (currentNode === null || currentNode === void 0 ? void 0 : currentNode.textContent) || '';

          if (textStack.length > 0) {
            textStack += textContent;
          } else {
            let charLastIndex = textContent.lastIndexOf(USER_MENTION_TEMP_CHAR);

            for (let i = charLastIndex - 1; i > -1; i -= 1) {
              if (textContent[i] === USER_MENTION_TEMP_CHAR) {
                charLastIndex = i;
              } else {
                break;
              }
            }

            if (charLastIndex > -1) {
              textStack = textContent;
              startNodeIndex = index;
              startOffsetIndex = charLastIndex;
            }
          }
        } else {
          /* other nodes */
          textStack = '';
          startNodeIndex = null;
          startOffsetIndex = null;
        }

        if (currentNode === selection.anchorNode) {
          /**
           * targetString could be ''
           * startNodeIndex and startOffsetIndex could be null
           */
          const targetString = textStack ? textStack.slice(startOffsetIndex) : ''; // include template character

          setTargetStringInfo({
            targetString,
            startNodeIndex,
            startOffsetIndex,
            endNodeIndex: index,
            endOffsetIndex: selection.anchorOffset
          });
          onMentionStringChange(targetString);
          return;
        }
      }
    }
  }, [isMentionEnabled]);

  const sendMessage = () => {
    const textField = ref === null || ref === void 0 ? void 0 : ref.current;

    if (!isEdit && textField !== null && textField !== void 0 && textField.textContent) {
      let messageText = '';
      let mentionTemplate = '';
      textField.childNodes.forEach(node => {
        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {
          const {
            innerText,
            dataset = {}
          } = node;
          const {
            userid = ''
          } = dataset;
          messageText += innerText;
          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;
        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Br) {
          messageText += '\n';
          mentionTemplate += '\n';
        } else if ((node === null || node === void 0 ? void 0 : node.nodeType) === NodeTypes.ElementNode && (node === null || node === void 0 ? void 0 : node.nodeName) === NodeNames.Div) {
          // handles newline in safari
          const {
            textContent = ''
          } = node;
          messageText += `\n${textContent}`;
          mentionTemplate += `\n${textContent}`;
        } else {
          // other nodes including text node
          const {
            textContent = ''
          } = node;
          messageText += textContent;
          mentionTemplate += textContent;
        }
      });
      const params = {
        message: messageText,
        mentionTemplate
      };
      onSendMessage(params);
      resetInput(ref); // important: keeps the keyboard open -> must add test on refactor

      textField.focus();
      setIsInput(false);
      setHeight();
    }
  };

  const isEditDisabled = !(ref !== null && ref !== void 0 && (_ref$current = ref.current) !== null && _ref$current !== void 0 && (_ref$current$textCont = _ref$current.textContent) !== null && _ref$current$textCont !== void 0 && _ref$current$textCont.trim());

  const editMessage = () => {
    const textField = ref === null || ref === void 0 ? void 0 : ref.current;
    const messageId = message === null || message === void 0 ? void 0 : message.messageId;

    if (isEdit && messageId) {
      let messageText = '';
      let mentionTemplate = '';
      textField.childNodes.forEach(node => {
        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {
          const {
            innerText,
            dataset = {}
          } = node;
          const {
            userid = ''
          } = dataset;
          messageText += innerText;
          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;
          messageText += '\n';
          mentionTemplate += '\n';
        } else {
          // other nodes including text node
          const {
            textContent = ''
          } = node;
          messageText += textContent;
          mentionTemplate += textContent;
        }
      });
      const params = {
        messageId,
        message: messageText,
        mentionTemplate
      };
      onUpdateMessage(params);
      resetInput(ref);
    }
  };

  const onPaste = usePaste({
    ref,
    setMentionedUserIds,
    setMentionedUsers,
    channel,
    setIsInput,
    setHeight
  });
  const textField = ref === null || ref === void 0 ? void 0 : ref.current;
  return /*#__PURE__*/React__default__default.createElement("form", {
    className: getClassName([className, isEdit ? 'sendbird-message-input__edit' : '', disabled ? 'sendbird-message-input-form__disabled' : ''])
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: getClassName(['sendbird-message-input', disabled ? 'sendbird-message-input__disabled' : ''])
  }, /*#__PURE__*/React__default__default.createElement("div", {
    id: `${textFieldId}${isEdit ? message === null || message === void 0 ? void 0 : message.messageId : ''}`,
    className: `sendbird-message-input--textarea ${textFieldId}`,
    contentEditable: !disabled,
    role: "textbox",
    "aria-label": "Text Input",
    disabled: disabled,
    ref: ref,
    maxLength: maxLength,
    onKeyDown: e => {
      const preventEvent = onKeyDown(e);

      if (preventEvent) {
        e.preventDefault();
      } else {
        var _textField$textConten4, _e$nativeEvent, _ref$current2, _ref$current2$childNo, _ref$current3, _ref$current3$childNo, _ref$current3$childNo2, _ref$current$childNod, _ref$current$childNod2;

        if (!e.shiftKey && e.key === MessageInputKeys.Enter && (textField === null || textField === void 0 ? void 0 : (_textField$textConten4 = textField.textContent) === null || _textField$textConten4 === void 0 ? void 0 : _textField$textConten4.trim().length) > 0 && (e === null || e === void 0 ? void 0 : (_e$nativeEvent = e.nativeEvent) === null || _e$nativeEvent === void 0 ? void 0 : _e$nativeEvent.isComposing) !== true) {
          e.preventDefault();
          sendMessage();
        }

        if (e.key === MessageInputKeys.Backspace && (ref === null || ref === void 0 ? void 0 : (_ref$current2 = ref.current) === null || _ref$current2 === void 0 ? void 0 : (_ref$current2$childNo = _ref$current2.childNodes) === null || _ref$current2$childNo === void 0 ? void 0 : _ref$current2$childNo.length) === 2 && !(ref !== null && ref !== void 0 && (_ref$current3 = ref.current) !== null && _ref$current3 !== void 0 && (_ref$current3$childNo = _ref$current3.childNodes) !== null && _ref$current3$childNo !== void 0 && (_ref$current3$childNo2 = _ref$current3$childNo[0]) !== null && _ref$current3$childNo2 !== void 0 && _ref$current3$childNo2.textContent) && (ref === null || ref === void 0 ? void 0 : (_ref$current$childNod = ref.current.childNodes) === null || _ref$current$childNod === void 0 ? void 0 : (_ref$current$childNod2 = _ref$current$childNod[1]) === null || _ref$current$childNod2 === void 0 ? void 0 : _ref$current$childNod2.nodeType) === NodeTypes.ElementNode) {
          ref === null || ref === void 0 ? void 0 : ref.current.removeChild(ref === null || ref === void 0 ? void 0 : ref.current.childNodes[1]);
        }
      }
    },
    onKeyUp: e => {
      const preventEvent = onKeyUp(e);

      if (preventEvent) {
        e.preventDefault();
      } else {
        useMentionInputDetection();
      }
    },
    onClick: () => {
      useMentionInputDetection();
    },
    onInput: () => {
      var _textField$textConten5;

      setHeight();
      onStartTyping();
      setIsInput((textField === null || textField === void 0 ? void 0 : (_textField$textConten5 = textField.textContent) === null || _textField$textConten5 === void 0 ? void 0 : _textField$textConten5.trim().length) > 0);
      useMentionedLabelDetection();
    },
    onPaste: onPaste
  }), (textField === null || textField === void 0 ? void 0 : (_textField$innerText = textField.innerText) === null || _textField$innerText === void 0 ? void 0 : _textField$innerText.length) === 0 && /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-message-input--placeholder",
    type: LabelTypography.BODY_1,
    color: disabled ? LabelColors.ONBACKGROUND_4 : LabelColors.ONBACKGROUND_3
  }, placeholder || stringSet.MESSAGE_INPUT__PLACE_HOLDER), !isEdit && isInput && /*#__PURE__*/React__default__default.createElement(IconButton, {
    className: "sendbird-message-input--send",
    height: "32px",
    width: "32px",
    onClick: () => sendMessage()
  }, (renderSendMessageIcon === null || renderSendMessageIcon === void 0 ? void 0 : renderSendMessageIcon()) || /*#__PURE__*/React__default__default.createElement(Icon, {
    type: IconTypes.SEND,
    fillColor: disabled ? IconColors.ON_BACKGROUND_4 : IconColors.PRIMARY,
    width: "20px",
    height: "20px"
  })), !isEdit && !isInput && ((renderFileUploadIcon === null || renderFileUploadIcon === void 0 ? void 0 : renderFileUploadIcon() // UIKit Dashboard configuration should have lower priority than
  // renderFileUploadIcon which is set in code level
  ) || isFileUploadEnabled && /*#__PURE__*/React__default__default.createElement(IconButton, {
    className: `sendbird-message-input--attach ${isVoiceMessageEnabled ? 'is-voice-message-enabled' : ''}`,
    height: "32px",
    width: "32px",
    onClick: () => {
      var _fileInputRef$current, _fileInputRef$current2; // todo: clear previous input


      fileInputRef === null || fileInputRef === void 0 ? void 0 : (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : (_fileInputRef$current2 = _fileInputRef$current.click) === null || _fileInputRef$current2 === void 0 ? void 0 : _fileInputRef$current2.call(_fileInputRef$current);
    }
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    type: IconTypes.ATTACH,
    fillColor: disabled ? IconColors.ON_BACKGROUND_4 : IconColors.CONTENT_INVERSE,
    width: "20px",
    height: "20px"
  }), /*#__PURE__*/React__default__default.createElement("input", {
    className: "sendbird-message-input--attach-input",
    type: "file",
    ref: fileInputRef,
    onChange: handleUploadFile(onFileUpload)
  }))), isVoiceMessageEnabled && !isEdit && !isInput && /*#__PURE__*/React__default__default.createElement(IconButton, {
    className: "sendbird-message-input--voice-message",
    width: "32px",
    height: "32px",
    onClick: onVoiceMessageIconClick
  }, (renderVoiceMessageIcon === null || renderVoiceMessageIcon === void 0 ? void 0 : renderVoiceMessageIcon()) || /*#__PURE__*/React__default__default.createElement(Icon, {
    type: IconTypes.AUDIO_ON_LINED,
    fillColor: disabled ? IconColors.ON_BACKGROUND_4 : IconColors.CONTENT_INVERSE,
    width: "20px",
    height: "20px"
  }))), isEdit && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-message-input--edit-action"
  }, /*#__PURE__*/React__default__default.createElement(Button, {
    className: "sendbird-message-input--edit-action__cancel",
    type: ButtonTypes.SECONDARY,
    size: ButtonSizes.SMALL,
    onClick: onCancelEdit
  }, stringSet.BUTTON__CANCEL), /*#__PURE__*/React__default__default.createElement(Button, {
    className: "sendbird-message-input--edit-action__save",
    type: ButtonTypes.PRIMARY,
    size: ButtonSizes.SMALL,
    disabled: isEditDisabled,
    onClick: () => editMessage()
  }, stringSet.BUTTON__SAVE)));
});
MessageInput.propTypes = {
  className: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.arrayOf(propTypes.exports.string)]),
  messageFieldId: propTypes.exports.string,
  placeholder: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.bool]),
  value: propTypes.exports.string,
  isEdit: propTypes.exports.bool,
  isMentionEnabled: propTypes.exports.bool,
  isVoiceMessageEnabled: propTypes.exports.bool,
  onVoiceMessageIconClick: propTypes.exports.func,
  message: propTypes.exports.shape({
    messageId: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.number]),
    message: propTypes.exports.string,
    mentionedMessageTemplate: propTypes.exports.string,
    mentionedUsers: propTypes.exports.arrayOf(propTypes.exports.shape({}))
  }),
  disabled: propTypes.exports.bool,
  maxLength: propTypes.exports.number,
  onFileUpload: propTypes.exports.func,
  onSendMessage: propTypes.exports.func,
  onUpdateMessage: propTypes.exports.func,
  onStartTyping: propTypes.exports.func,
  onCancelEdit: propTypes.exports.func,
  channelUrl: propTypes.exports.string,
  mentionSelectedUser: propTypes.exports.shape({
    userId: propTypes.exports.string,
    nickname: propTypes.exports.string
  }),
  setMentionedUsers: propTypes.exports.func,
  onUserMentioned: propTypes.exports.func,
  onMentionStringChange: propTypes.exports.func,
  onMentionedUserIdsUpdated: propTypes.exports.func,
  onKeyUp: propTypes.exports.func,
  onKeyDown: propTypes.exports.func,
  renderVoiceMessageIcon: propTypes.exports.func,
  renderSendMessageIcon: propTypes.exports.func,
  renderFileUploadIcon: propTypes.exports.func,
  channel: propTypes.exports.shape({
    channelType: propTypes.exports.string
  }).isRequired
};
MessageInput.defaultProps = {
  className: '',
  messageFieldId: '',
  channelUrl: '',
  onSendMessage: noop,
  onUpdateMessage: noop,
  value: null,
  message: null,
  isEdit: false,
  isMentionEnabled: false,
  isVoiceMessageEnabled: true,
  onVoiceMessageIconClick: noop,
  disabled: false,
  placeholder: '',
  maxLength: 5000,
  onFileUpload: noop,
  onCancelEdit: noop,
  onStartTyping: noop,
  mentionSelectedUser: null,
  onUserMentioned: noop,
  onMentionStringChange: noop,
  onMentionedUserIdsUpdated: noop,
  onKeyUp: noop,
  onKeyDown: noop,
  setMentionedUsers: noop,
  renderVoiceMessageIcon: noop,
  renderFileUploadIcon: noop,
  renderSendMessageIcon: noop
};

const defaultValue = {
  message: {},
  isByMe: false
};
const MessageContext = /*#__PURE__*/React__default__default.createContext(defaultValue);

const MessageProvider = props => {
  const {
    children,
    message,
    isByMe = false
  } = props;
  return /*#__PURE__*/React__default__default.createElement(MessageContext.Provider, {
    value: {
      message,
      isByMe
    }
  }, children);
};

const useMessageContext = () => {
  const value = React__default__default.useContext(MessageContext);

  if (value === undefined) {
    throw new Error('useMessageContext must be used within a MessageProvider');
  }

  return value;
};

function MentionLabel(props) {
  var _sendbirdState$config, _sendbirdState$stores, _sendbirdState$stores2;

  const {
    mentionTemplate,
    mentionedUserId,
    mentionedUserNickname,
    isByMe
  } = props;
  const mentionRef = useRef();
  const sendbirdState = useSendbirdStateContext();
  const userId = sendbirdState === null || sendbirdState === void 0 ? void 0 : (_sendbirdState$config = sendbirdState.config) === null || _sendbirdState$config === void 0 ? void 0 : _sendbirdState$config.userId;
  const sdk = sendbirdState === null || sendbirdState === void 0 ? void 0 : (_sendbirdState$stores = sendbirdState.stores) === null || _sendbirdState$stores === void 0 ? void 0 : (_sendbirdState$stores2 = _sendbirdState$stores.sdkStore) === null || _sendbirdState$stores2 === void 0 ? void 0 : _sendbirdState$stores2.sdk;
  const amIBeingMentioned = userId === mentionedUserId;
  const [user, setUser] = useState();
  const fetchUser = useCallback(toggleDropdown => {
    if (user || !(sdk !== null && sdk !== void 0 && sdk.createApplicationUserListQuery)) {
      toggleDropdown();
      return;
    }

    const query = sdk === null || sdk === void 0 ? void 0 : sdk.createApplicationUserListQuery({
      userIdsFilter: [mentionedUserId]
    });
    query.next().then(members => {
      if ((members === null || members === void 0 ? void 0 : members.length) > 0) {
        setUser(members[0]);
      }

      toggleDropdown();
    });
  }, [sdk, mentionedUserId]);
  return /*#__PURE__*/React__default__default.createElement(ContextMenu, {
    menuTrigger: toggleDropdown => /*#__PURE__*/React__default__default.createElement("a", {
      className: `
            sendbird-word__mention
            ${amIBeingMentioned ? 'sendbird-word__mention--me' : ''}
          `,
      onClick: () => fetchUser(toggleDropdown),
      ref: mentionRef,
      "data-userid": mentionedUserId,
      "data-nickname": mentionedUserNickname,
      "data-sb-mention": true
    }, /*#__PURE__*/React__default__default.createElement(Label, {
      type: LabelTypography.CAPTION_1,
      color: isByMe ? LabelColors.ONCONTENT_1 : LabelColors.ONBACKGROUND_1
    }, `${mentionTemplate}${mentionedUserNickname}`)),
    menuItems: closeDropdown => /*#__PURE__*/React__default__default.createElement(MenuItems
    /**
    * parentRef: For catching location(x, y) of MenuItems
    * parentContainRef: For toggling more options(menus & reactions)
    */
    , {
      parentRef: mentionRef,
      parentContainRef: mentionRef,
      closeDropdown: closeDropdown,
      style: {
        paddingTop: '0px',
        paddingBottom: '0px'
      }
    }, /*#__PURE__*/React__default__default.createElement(UserProfile, {
      user: user,
      onSuccess: closeDropdown,
      currentUserId: userId
    }))
  });
}

const http = /https?:\/\//;

function LinkLabel(_ref) {
  let {
    className,
    src,
    type,
    color,
    children
  } = _ref;
  const url = http.test(src) ? src : `http://${src}`;
  return /*#__PURE__*/React__default__default.createElement("a", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-link-label', color ? changeColorToClassName$2(color) : ''].join(' '),
    href: url,
    target: "_blank",
    rel: "noopener noreferrer" // for mobile
    ,
    onTouchEnd: e => {
      e.preventDefault();
      e.nativeEvent.stopImmediatePropagation();
      window.open(url, '_blank', 'noopener,noreferrer');
    }
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-link-label__label",
    type: type,
    color: color
  }, children));
}

LinkLabel.propTypes = {
  className: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.arrayOf(propTypes.exports.string)]),
  src: propTypes.exports.string.isRequired,
  type: propTypes.exports.string,
  color: propTypes.exports.string,
  children: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.element, propTypes.exports.arrayOf(propTypes.exports.string), propTypes.exports.arrayOf(propTypes.exports.element)]).isRequired
};
LinkLabel.defaultProps = {
  className: '',
  type: '',
  color: ''
};

// it changes with updated time and index
// messageUpdatedAt is the key part of this key generator

function keyGenerator(createdAt, messageUpdatedAt, index) {
  return `sb-msg_${createdAt}_${messageUpdatedAt}_${index}`;
}

function TextFragment(_ref) {
  let {
    tokens
  } = _ref;
  const messageStore = useMessageContext();
  const message = messageStore === null || messageStore === void 0 ? void 0 : messageStore.message;
  const isByMe = messageStore === null || messageStore === void 0 ? void 0 : messageStore.isByMe;
  const {
    updatedAt,
    createdAt
  } = message;
  return /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, tokens === null || tokens === void 0 ? void 0 : tokens.map((token, idx) => {
    const key = keyGenerator(createdAt, updatedAt, idx);
    return K$1(token.type).with(TOKEN_TYPES.mention, () => /*#__PURE__*/React__default__default.createElement("span", {
      className: "sendbird-word",
      key: key
    }, /*#__PURE__*/React__default__default.createElement(MentionLabel, {
      mentionTemplate: USER_MENTION_PREFIX,
      mentionedUserId: token.userId,
      mentionedUserNickname: token.value,
      isByMe: isByMe
    }))).with(TOKEN_TYPES.url, () => /*#__PURE__*/React__default__default.createElement("span", {
      className: "sendbird-word",
      key: key
    }, /*#__PURE__*/React__default__default.createElement(LinkLabel, {
      className: "sendbird-word__url",
      src: token.value,
      type: LabelTypography.BODY_1
    }, token.value))).otherwise(() => /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, {
      key: key
    }, getWhiteSpacePreservedText(token.value)));
  }));
}

function useDebounce(callback, delay) {
  const timeoutRef = useRef(null);
  useEffect(() => {
    // Cleanup the timeout on unmount
    return () => {
      if (timeoutRef.current) {
        clearTimeout(timeoutRef.current);
      }
    };
  }, []);

  function debounceFunction() {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    if (timeoutRef.current) {
      clearTimeout(timeoutRef.current);
    }

    timeoutRef.current = setTimeout(() => {
      callback(...args);
    }, delay);
  }

  return debounceFunction;
}

const DELAY = 500;

function calcScrollBottom(scrollHeight, scrollTop) {
  return scrollHeight - scrollTop;
}

function useHandleOnScrollCallback(_ref) {
  let {
    hasMore,
    hasNext,
    onScroll,
    scrollRef,
    setShowScrollDownButton
  } = _ref;
  const scrollCb = useCallback(() => {
    const element = scrollRef === null || scrollRef === void 0 ? void 0 : scrollRef.current;

    if (element == null) {
      return;
    }

    const {
      scrollTop,
      scrollHeight,
      clientHeight
    } = element; // https://sendbird.atlassian.net/browse/SBISSUE-11759
    // the edge case where channel is inside a page that already has scroll
    // scrollintoView will move the whole page, which we dont want

    const scrollBottom = calcScrollBottom(scrollHeight, scrollTop); // even if there is more to fetch or not,
    // we still have to show the scroll to bottom button

    if (typeof setShowScrollDownButton === 'function') {
      setShowScrollDownButton(scrollHeight > scrollTop + clientHeight + 1);
    }

    if (hasMore && scrollTop < SCROLL_BUFFER) {
      onScroll(() => {
        // sets the scroll position to the bottom of the new messages
        element.scrollTop = element.scrollHeight - scrollBottom;
      });
    }

    if (hasNext) {
      onScroll(() => {
        // sets the scroll position to the top of the new messages
        element.scrollTop = scrollTop - (scrollHeight - element.scrollHeight);
      });
    }
  }, [setShowScrollDownButton, hasMore, onScroll, scrollRef]);
  return useDebounce(scrollCb, DELAY);
}

const Context = /*#__PURE__*/React__default__default.createContext({
  opened: '',
  // mock default value
  setOpened: noop$1
});
Context.Consumer;
Context.Provider;

const FileViewerComponent = _ref => {
  let {
    profileUrl,
    nickname,
    name,
    type,
    url,
    isByMe = true,
    disableDelete = false,
    onClose,
    onDelete
  } = _ref;
  const {
    stringSet
  } = useContext(LocalizationContext);
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-fileviewer"
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-fileviewer__header"
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-fileviewer__header__left"
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-fileviewer__header__left__avatar"
  }, /*#__PURE__*/React__default__default.createElement(Avatar$1, {
    height: "32px",
    width: "32px",
    src: profileUrl
  })), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-fileviewer__header__left__filename",
    type: LabelTypography.H_2,
    color: LabelColors.ONBACKGROUND_1
  }, name), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-fileviewer__header__left__sender-name",
    type: LabelTypography.BODY_1,
    color: LabelColors.ONBACKGROUND_2
  }, nickname)), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-fileviewer__header__right"
  }, isSupportedFileView(type) && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-fileviewer__header__right__actions"
  }, /*#__PURE__*/React__default__default.createElement("a", {
    className: "sendbird-fileviewer__header__right__actions__download",
    rel: "noopener noreferrer",
    href: url,
    target: "_blank"
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    type: IconTypes.DOWNLOAD,
    fillColor: IconColors.ON_BACKGROUND_1,
    height: "24px",
    width: "24px"
  })), onDelete && isByMe && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-fileviewer__header__right__actions__delete"
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    className: disableDelete ? 'disabled' : '',
    type: IconTypes.DELETE,
    fillColor: disableDelete ? IconColors.GRAY : IconColors.ON_BACKGROUND_1,
    height: "24px",
    width: "24px",
    onClick: e => {
      if (!disableDelete) {
        onDelete === null || onDelete === void 0 ? void 0 : onDelete(e);
      }
    }
  }))), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-fileviewer__header__right__actions__close"
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    type: IconTypes.CLOSE,
    fillColor: IconColors.ON_BACKGROUND_1,
    height: "24px",
    width: "24px",
    onClick: e => onClose === null || onClose === void 0 ? void 0 : onClose(e)
  })))), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-fileviewer__content"
  }, isVideo$1(type) && /*#__PURE__*/React__default__default.createElement("video", {
    controls: true,
    className: "sendbird-fileviewer__content__video"
  }, /*#__PURE__*/React__default__default.createElement("source", {
    src: url,
    type: type
  })), isImage$1(type) && /*#__PURE__*/React__default__default.createElement("img", {
    src: url,
    alt: name,
    className: "sendbird-fileviewer__content__img"
  }), !isSupportedFileView(type) && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-fileviewer__content__unsupported"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    type: LabelTypography.H_1,
    color: LabelColors.ONBACKGROUND_1
  }, (stringSet === null || stringSet === void 0 ? void 0 : stringSet.UI__FILE_VIEWER__UNSUPPORT) || 'Unsupported message'))));
};

function FileViewer(_ref2) {
  var _message$sender, _message$sender2, _message$threadInfo;

  let {
    message,
    isByMe = false,
    onClose,
    onDelete
  } = _ref2;
  return /*#__PURE__*/createPortal( /*#__PURE__*/React__default__default.createElement(FileViewerComponent, {
    profileUrl: message === null || message === void 0 ? void 0 : (_message$sender = message.sender) === null || _message$sender === void 0 ? void 0 : _message$sender.profileUrl,
    nickname: message === null || message === void 0 ? void 0 : (_message$sender2 = message.sender) === null || _message$sender2 === void 0 ? void 0 : _message$sender2.nickname,
    name: message === null || message === void 0 ? void 0 : message.name,
    type: message === null || message === void 0 ? void 0 : message.type,
    url: message === null || message === void 0 ? void 0 : message.url,
    isByMe: isByMe,
    disableDelete: (message === null || message === void 0 ? void 0 : (_message$threadInfo = message.threadInfo) === null || _message$threadInfo === void 0 ? void 0 : _message$threadInfo.replyCount) > 0,
    onClose: onClose,
    onDelete: onDelete
  }), document.getElementById(MODAL_ROOT));
}

function toInteger(dirtyNumber) {
  if (dirtyNumber === null || dirtyNumber === true || dirtyNumber === false) {
    return NaN;
  }

  var number = Number(dirtyNumber);

  if (isNaN(number)) {
    return number;
  }

  return number < 0 ? Math.ceil(number) : Math.floor(number);
}

function requiredArgs(required, args) {
  if (args.length < required) {
    throw new TypeError(required + ' argument' + (required > 1 ? 's' : '') + ' required, but only ' + args.length + ' present');
  }
}

function _typeof$1(obj) {
  "@babel/helpers - typeof";

  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    _typeof$1 = function _typeof(obj) {
      return typeof obj;
    };
  } else {
    _typeof$1 = function _typeof(obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };
  }

  return _typeof$1(obj);
}
/**
 * @name toDate
 * @category Common Helpers
 * @summary Convert the given argument to an instance of Date.
 *
 * @description
 * Convert the given argument to an instance of Date.
 *
 * If the argument is an instance of Date, the function returns its clone.
 *
 * If the argument is a number, it is treated as a timestamp.
 *
 * If the argument is none of the above, the function returns Invalid Date.
 *
 * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.
 *
 * @param {Date|Number} argument - the value to convert
 * @returns {Date} the parsed date in the local time zone
 * @throws {TypeError} 1 argument required
 *
 * @example
 * // Clone the date:
 * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))
 * //=> Tue Feb 11 2014 11:30:30
 *
 * @example
 * // Convert the timestamp to date:
 * const result = toDate(1392098430000)
 * //=> Tue Feb 11 2014 11:30:30
 */

function toDate(argument) {
  requiredArgs(1, arguments);
  var argStr = Object.prototype.toString.call(argument); // Clone the date

  if (argument instanceof Date || _typeof$1(argument) === 'object' && argStr === '[object Date]') {
    // Prevent the date to lose the milliseconds when passed to new Date() in IE10
    return new Date(argument.getTime());
  } else if (typeof argument === 'number' || argStr === '[object Number]') {
    return new Date(argument);
  } else {
    if ((typeof argument === 'string' || argStr === '[object String]') && typeof console !== 'undefined') {
      // eslint-disable-next-line no-console
      console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"); // eslint-disable-next-line no-console

      console.warn(new Error().stack);
    }

    return new Date(NaN);
  }
}

/**
 * @name addMilliseconds
 * @category Millisecond Helpers
 * @summary Add the specified number of milliseconds to the given date.
 *
 * @description
 * Add the specified number of milliseconds to the given date.
 *
 * @param {Date|Number} date - the date to be changed
 * @param {Number} amount - the amount of milliseconds to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.
 * @returns {Date} the new date with the milliseconds added
 * @throws {TypeError} 2 arguments required
 *
 * @example
 * // Add 750 milliseconds to 10 July 2014 12:45:30.000:
 * const result = addMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)
 * //=> Thu Jul 10 2014 12:45:30.750
 */

function addMilliseconds(dirtyDate, dirtyAmount) {
  requiredArgs(2, arguments);
  var timestamp = toDate(dirtyDate).getTime();
  var amount = toInteger(dirtyAmount);
  return new Date(timestamp + amount);
}

var defaultOptions = {};
function getDefaultOptions() {
  return defaultOptions;
}

/**
 * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.
 * They usually appear for dates that denote time before the timezones were introduced
 * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891
 * and GMT+01:00:00 after that date)
 *
 * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,
 * which would lead to incorrect calculations.
 *
 * This function returns the timezone offset in milliseconds that takes seconds in account.
 */
function getTimezoneOffsetInMilliseconds(date) {
  var utcDate = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds()));
  utcDate.setUTCFullYear(date.getFullYear());
  return date.getTime() - utcDate.getTime();
}

function _typeof(obj) {
  "@babel/helpers - typeof";

  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    _typeof = function _typeof(obj) {
      return typeof obj;
    };
  } else {
    _typeof = function _typeof(obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };
  }

  return _typeof(obj);
}
/**
 * @name isDate
 * @category Common Helpers
 * @summary Is the given value a date?
 *
 * @description
 * Returns true if the given value is an instance of Date. The function works for dates transferred across iframes.
 *
 * @param {*} value - the value to check
 * @returns {boolean} true if the given value is a date
 * @throws {TypeError} 1 arguments required
 *
 * @example
 * // For a valid date:
 * const result = isDate(new Date())
 * //=> true
 *
 * @example
 * // For an invalid date:
 * const result = isDate(new Date(NaN))
 * //=> true
 *
 * @example
 * // For some value:
 * const result = isDate('2014-02-31')
 * //=> false
 *
 * @example
 * // For an object:
 * const result = isDate({})
 * //=> false
 */

function isDate(value) {
  requiredArgs(1, arguments);
  return value instanceof Date || _typeof(value) === 'object' && Object.prototype.toString.call(value) === '[object Date]';
}

/**
 * @name isValid
 * @category Common Helpers
 * @summary Is the given date valid?
 *
 * @description
 * Returns false if argument is Invalid Date and true otherwise.
 * Argument is converted to Date using `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}
 * Invalid Date is a Date, whose time value is NaN.
 *
 * Time value of Date: http://es5.github.io/#x15.9.1.1
 *
 * @param {*} date - the date to check
 * @returns {Boolean} the date is valid
 * @throws {TypeError} 1 argument required
 *
 * @example
 * // For the valid date:
 * const result = isValid(new Date(2014, 1, 31))
 * //=> true
 *
 * @example
 * // For the value, convertable into a date:
 * const result = isValid(1393804800000)
 * //=> true
 *
 * @example
 * // For the invalid date:
 * const result = isValid(new Date(''))
 * //=> false
 */

function isValid(dirtyDate) {
  requiredArgs(1, arguments);

  if (!isDate(dirtyDate) && typeof dirtyDate !== 'number') {
    return false;
  }

  var date = toDate(dirtyDate);
  return !isNaN(Number(date));
}

/**
 * @name subMilliseconds
 * @category Millisecond Helpers
 * @summary Subtract the specified number of milliseconds from the given date.
 *
 * @description
 * Subtract the specified number of milliseconds from the given date.
 *
 * @param {Date|Number} date - the date to be changed
 * @param {Number} amount - the amount of milliseconds to be subtracted. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.
 * @returns {Date} the new date with the milliseconds subtracted
 * @throws {TypeError} 2 arguments required
 *
 * @example
 * // Subtract 750 milliseconds from 10 July 2014 12:45:30.000:
 * const result = subMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)
 * //=> Thu Jul 10 2014 12:45:29.250
 */

function subMilliseconds(dirtyDate, dirtyAmount) {
  requiredArgs(2, arguments);
  var amount = toInteger(dirtyAmount);
  return addMilliseconds(dirtyDate, -amount);
}

var MILLISECONDS_IN_DAY = 86400000;
function getUTCDayOfYear(dirtyDate) {
  requiredArgs(1, arguments);
  var date = toDate(dirtyDate);
  var timestamp = date.getTime();
  date.setUTCMonth(0, 1);
  date.setUTCHours(0, 0, 0, 0);
  var startOfYearTimestamp = date.getTime();
  var difference = timestamp - startOfYearTimestamp;
  return Math.floor(difference / MILLISECONDS_IN_DAY) + 1;
}

function startOfUTCISOWeek(dirtyDate) {
  requiredArgs(1, arguments);
  var weekStartsOn = 1;
  var date = toDate(dirtyDate);
  var day = date.getUTCDay();
  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;
  date.setUTCDate(date.getUTCDate() - diff);
  date.setUTCHours(0, 0, 0, 0);
  return date;
}

function getUTCISOWeekYear(dirtyDate) {
  requiredArgs(1, arguments);
  var date = toDate(dirtyDate);
  var year = date.getUTCFullYear();
  var fourthOfJanuaryOfNextYear = new Date(0);
  fourthOfJanuaryOfNextYear.setUTCFullYear(year + 1, 0, 4);
  fourthOfJanuaryOfNextYear.setUTCHours(0, 0, 0, 0);
  var startOfNextYear = startOfUTCISOWeek(fourthOfJanuaryOfNextYear);
  var fourthOfJanuaryOfThisYear = new Date(0);
  fourthOfJanuaryOfThisYear.setUTCFullYear(year, 0, 4);
  fourthOfJanuaryOfThisYear.setUTCHours(0, 0, 0, 0);
  var startOfThisYear = startOfUTCISOWeek(fourthOfJanuaryOfThisYear);

  if (date.getTime() >= startOfNextYear.getTime()) {
    return year + 1;
  } else if (date.getTime() >= startOfThisYear.getTime()) {
    return year;
  } else {
    return year - 1;
  }
}

function startOfUTCISOWeekYear(dirtyDate) {
  requiredArgs(1, arguments);
  var year = getUTCISOWeekYear(dirtyDate);
  var fourthOfJanuary = new Date(0);
  fourthOfJanuary.setUTCFullYear(year, 0, 4);
  fourthOfJanuary.setUTCHours(0, 0, 0, 0);
  var date = startOfUTCISOWeek(fourthOfJanuary);
  return date;
}

var MILLISECONDS_IN_WEEK$1 = 604800000;
function getUTCISOWeek(dirtyDate) {
  requiredArgs(1, arguments);
  var date = toDate(dirtyDate);
  var diff = startOfUTCISOWeek(date).getTime() - startOfUTCISOWeekYear(date).getTime(); // Round the number of days to the nearest integer
  // because the number of milliseconds in a week is not constant
  // (e.g. it's different in the week of the daylight saving time clock shift)

  return Math.round(diff / MILLISECONDS_IN_WEEK$1) + 1;
}

function startOfUTCWeek(dirtyDate, options) {
  var _ref, _ref2, _ref3, _options$weekStartsOn, _options$locale, _options$locale$optio, _defaultOptions$local, _defaultOptions$local2;

  requiredArgs(1, arguments);
  var defaultOptions = getDefaultOptions();
  var weekStartsOn = toInteger((_ref = (_ref2 = (_ref3 = (_options$weekStartsOn = options === null || options === void 0 ? void 0 : options.weekStartsOn) !== null && _options$weekStartsOn !== void 0 ? _options$weekStartsOn : options === null || options === void 0 ? void 0 : (_options$locale = options.locale) === null || _options$locale === void 0 ? void 0 : (_options$locale$optio = _options$locale.options) === null || _options$locale$optio === void 0 ? void 0 : _options$locale$optio.weekStartsOn) !== null && _ref3 !== void 0 ? _ref3 : defaultOptions.weekStartsOn) !== null && _ref2 !== void 0 ? _ref2 : (_defaultOptions$local = defaultOptions.locale) === null || _defaultOptions$local === void 0 ? void 0 : (_defaultOptions$local2 = _defaultOptions$local.options) === null || _defaultOptions$local2 === void 0 ? void 0 : _defaultOptions$local2.weekStartsOn) !== null && _ref !== void 0 ? _ref : 0); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN

  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {
    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');
  }

  var date = toDate(dirtyDate);
  var day = date.getUTCDay();
  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;
  date.setUTCDate(date.getUTCDate() - diff);
  date.setUTCHours(0, 0, 0, 0);
  return date;
}

function getUTCWeekYear(dirtyDate, options) {
  var _ref, _ref2, _ref3, _options$firstWeekCon, _options$locale, _options$locale$optio, _defaultOptions$local, _defaultOptions$local2;

  requiredArgs(1, arguments);
  var date = toDate(dirtyDate);
  var year = date.getUTCFullYear();
  var defaultOptions = getDefaultOptions();
  var firstWeekContainsDate = toInteger((_ref = (_ref2 = (_ref3 = (_options$firstWeekCon = options === null || options === void 0 ? void 0 : options.firstWeekContainsDate) !== null && _options$firstWeekCon !== void 0 ? _options$firstWeekCon : options === null || options === void 0 ? void 0 : (_options$locale = options.locale) === null || _options$locale === void 0 ? void 0 : (_options$locale$optio = _options$locale.options) === null || _options$locale$optio === void 0 ? void 0 : _options$locale$optio.firstWeekContainsDate) !== null && _ref3 !== void 0 ? _ref3 : defaultOptions.firstWeekContainsDate) !== null && _ref2 !== void 0 ? _ref2 : (_defaultOptions$local = defaultOptions.locale) === null || _defaultOptions$local === void 0 ? void 0 : (_defaultOptions$local2 = _defaultOptions$local.options) === null || _defaultOptions$local2 === void 0 ? void 0 : _defaultOptions$local2.firstWeekContainsDate) !== null && _ref !== void 0 ? _ref : 1); // Test if weekStartsOn is between 1 and 7 _and_ is not NaN

  if (!(firstWeekContainsDate >= 1 && firstWeekContainsDate <= 7)) {
    throw new RangeError('firstWeekContainsDate must be between 1 and 7 inclusively');
  }

  var firstWeekOfNextYear = new Date(0);
  firstWeekOfNextYear.setUTCFullYear(year + 1, 0, firstWeekContainsDate);
  firstWeekOfNextYear.setUTCHours(0, 0, 0, 0);
  var startOfNextYear = startOfUTCWeek(firstWeekOfNextYear, options);
  var firstWeekOfThisYear = new Date(0);
  firstWeekOfThisYear.setUTCFullYear(year, 0, firstWeekContainsDate);
  firstWeekOfThisYear.setUTCHours(0, 0, 0, 0);
  var startOfThisYear = startOfUTCWeek(firstWeekOfThisYear, options);

  if (date.getTime() >= startOfNextYear.getTime()) {
    return year + 1;
  } else if (date.getTime() >= startOfThisYear.getTime()) {
    return year;
  } else {
    return year - 1;
  }
}

function startOfUTCWeekYear(dirtyDate, options) {
  var _ref, _ref2, _ref3, _options$firstWeekCon, _options$locale, _options$locale$optio, _defaultOptions$local, _defaultOptions$local2;

  requiredArgs(1, arguments);
  var defaultOptions = getDefaultOptions();
  var firstWeekContainsDate = toInteger((_ref = (_ref2 = (_ref3 = (_options$firstWeekCon = options === null || options === void 0 ? void 0 : options.firstWeekContainsDate) !== null && _options$firstWeekCon !== void 0 ? _options$firstWeekCon : options === null || options === void 0 ? void 0 : (_options$locale = options.locale) === null || _options$locale === void 0 ? void 0 : (_options$locale$optio = _options$locale.options) === null || _options$locale$optio === void 0 ? void 0 : _options$locale$optio.firstWeekContainsDate) !== null && _ref3 !== void 0 ? _ref3 : defaultOptions.firstWeekContainsDate) !== null && _ref2 !== void 0 ? _ref2 : (_defaultOptions$local = defaultOptions.locale) === null || _defaultOptions$local === void 0 ? void 0 : (_defaultOptions$local2 = _defaultOptions$local.options) === null || _defaultOptions$local2 === void 0 ? void 0 : _defaultOptions$local2.firstWeekContainsDate) !== null && _ref !== void 0 ? _ref : 1);
  var year = getUTCWeekYear(dirtyDate, options);
  var firstWeek = new Date(0);
  firstWeek.setUTCFullYear(year, 0, firstWeekContainsDate);
  firstWeek.setUTCHours(0, 0, 0, 0);
  var date = startOfUTCWeek(firstWeek, options);
  return date;
}

var MILLISECONDS_IN_WEEK = 604800000;
function getUTCWeek(dirtyDate, options) {
  requiredArgs(1, arguments);
  var date = toDate(dirtyDate);
  var diff = startOfUTCWeek(date, options).getTime() - startOfUTCWeekYear(date, options).getTime(); // Round the number of days to the nearest integer
  // because the number of milliseconds in a week is not constant
  // (e.g. it's different in the week of the daylight saving time clock shift)

  return Math.round(diff / MILLISECONDS_IN_WEEK) + 1;
}

function addLeadingZeros(number, targetLength) {
  var sign = number < 0 ? '-' : '';
  var output = Math.abs(number).toString();

  while (output.length < targetLength) {
    output = '0' + output;
  }

  return sign + output;
}

/*
 * |     | Unit                           |     | Unit                           |
 * |-----|--------------------------------|-----|--------------------------------|
 * |  a  | AM, PM                         |  A* |                                |
 * |  d  | Day of month                   |  D  |                                |
 * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |
 * |  m  | Minute                         |  M  | Month                          |
 * |  s  | Second                         |  S  | Fraction of second             |
 * |  y  | Year (abs)                     |  Y  |                                |
 *
 * Letters marked by * are not implemented but reserved by Unicode standard.
 */

var formatters$2 = {
  // Year
  y: function y(date, token) {
    // From http://www.unicode.org/reports/tr35/tr35-31/tr35-dates.html#Date_Format_tokens
    // | Year     |     y | yy |   yyy |  yyyy | yyyyy |
    // |----------|-------|----|-------|-------|-------|
    // | AD 1     |     1 | 01 |   001 |  0001 | 00001 |
    // | AD 12    |    12 | 12 |   012 |  0012 | 00012 |
    // | AD 123   |   123 | 23 |   123 |  0123 | 00123 |
    // | AD 1234  |  1234 | 34 |  1234 |  1234 | 01234 |
    // | AD 12345 | 12345 | 45 | 12345 | 12345 | 12345 |
    var signedYear = date.getUTCFullYear(); // Returns 1 for 1 BC (which is year 0 in JavaScript)

    var year = signedYear > 0 ? signedYear : 1 - signedYear;
    return addLeadingZeros(token === 'yy' ? year % 100 : year, token.length);
  },
  // Month
  M: function M(date, token) {
    var month = date.getUTCMonth();
    return token === 'M' ? String(month + 1) : addLeadingZeros(month + 1, 2);
  },
  // Day of the month
  d: function d(date, token) {
    return addLeadingZeros(date.getUTCDate(), token.length);
  },
  // AM or PM
  a: function a(date, token) {
    var dayPeriodEnumValue = date.getUTCHours() / 12 >= 1 ? 'pm' : 'am';

    switch (token) {
      case 'a':
      case 'aa':
        return dayPeriodEnumValue.toUpperCase();

      case 'aaa':
        return dayPeriodEnumValue;

      case 'aaaaa':
        return dayPeriodEnumValue[0];

      case 'aaaa':
      default:
        return dayPeriodEnumValue === 'am' ? 'a.m.' : 'p.m.';
    }
  },
  // Hour [1-12]
  h: function h(date, token) {
    return addLeadingZeros(date.getUTCHours() % 12 || 12, token.length);
  },
  // Hour [0-23]
  H: function H(date, token) {
    return addLeadingZeros(date.getUTCHours(), token.length);
  },
  // Minute
  m: function m(date, token) {
    return addLeadingZeros(date.getUTCMinutes(), token.length);
  },
  // Second
  s: function s(date, token) {
    return addLeadingZeros(date.getUTCSeconds(), token.length);
  },
  // Fraction of second
  S: function S(date, token) {
    var numberOfDigits = token.length;
    var milliseconds = date.getUTCMilliseconds();
    var fractionalSeconds = Math.floor(milliseconds * Math.pow(10, numberOfDigits - 3));
    return addLeadingZeros(fractionalSeconds, token.length);
  }
};

var dayPeriodEnum = {
  am: 'am',
  pm: 'pm',
  midnight: 'midnight',
  noon: 'noon',
  morning: 'morning',
  afternoon: 'afternoon',
  evening: 'evening',
  night: 'night'
};
/*
 * |     | Unit                           |     | Unit                           |
 * |-----|--------------------------------|-----|--------------------------------|
 * |  a  | AM, PM                         |  A* | Milliseconds in day            |
 * |  b  | AM, PM, noon, midnight         |  B  | Flexible day period            |
 * |  c  | Stand-alone local day of week  |  C* | Localized hour w/ day period   |
 * |  d  | Day of month                   |  D  | Day of year                    |
 * |  e  | Local day of week              |  E  | Day of week                    |
 * |  f  |                                |  F* | Day of week in month           |
 * |  g* | Modified Julian day            |  G  | Era                            |
 * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |
 * |  i! | ISO day of week                |  I! | ISO week of year               |
 * |  j* | Localized hour w/ day period   |  J* | Localized hour w/o day period  |
 * |  k  | Hour [1-24]                    |  K  | Hour [0-11]                    |
 * |  l* | (deprecated)                   |  L  | Stand-alone month              |
 * |  m  | Minute                         |  M  | Month                          |
 * |  n  |                                |  N  |                                |
 * |  o! | Ordinal number modifier        |  O  | Timezone (GMT)                 |
 * |  p! | Long localized time            |  P! | Long localized date            |
 * |  q  | Stand-alone quarter            |  Q  | Quarter                        |
 * |  r* | Related Gregorian year         |  R! | ISO week-numbering year        |
 * |  s  | Second                         |  S  | Fraction of second             |
 * |  t! | Seconds timestamp              |  T! | Milliseconds timestamp         |
 * |  u  | Extended year                  |  U* | Cyclic year                    |
 * |  v* | Timezone (generic non-locat.)  |  V* | Timezone (location)            |
 * |  w  | Local week of year             |  W* | Week of month                  |
 * |  x  | Timezone (ISO-8601 w/o Z)      |  X  | Timezone (ISO-8601)            |
 * |  y  | Year (abs)                     |  Y  | Local week-numbering year      |
 * |  z  | Timezone (specific non-locat.) |  Z* | Timezone (aliases)             |
 *
 * Letters marked by * are not implemented but reserved by Unicode standard.
 *
 * Letters marked by ! are non-standard, but implemented by date-fns:
 * - `o` modifies the previous token to turn it into an ordinal (see `format` docs)
 * - `i` is ISO day of week. For `i` and `ii` is returns numeric ISO week days,
 *   i.e. 7 for Sunday, 1 for Monday, etc.
 * - `I` is ISO week of year, as opposed to `w` which is local week of year.
 * - `R` is ISO week-numbering year, as opposed to `Y` which is local week-numbering year.
 *   `R` is supposed to be used in conjunction with `I` and `i`
 *   for universal ISO week-numbering date, whereas
 *   `Y` is supposed to be used in conjunction with `w` and `e`
 *   for week-numbering date specific to the locale.
 * - `P` is long localized date format
 * - `p` is long localized time format
 */

var formatters = {
  // Era
  G: function G(date, token, localize) {
    var era = date.getUTCFullYear() > 0 ? 1 : 0;

    switch (token) {
      // AD, BC
      case 'G':
      case 'GG':
      case 'GGG':
        return localize.era(era, {
          width: 'abbreviated'
        });
      // A, B

      case 'GGGGG':
        return localize.era(era, {
          width: 'narrow'
        });
      // Anno Domini, Before Christ

      case 'GGGG':
      default:
        return localize.era(era, {
          width: 'wide'
        });
    }
  },
  // Year
  y: function y(date, token, localize) {
    // Ordinal number
    if (token === 'yo') {
      var signedYear = date.getUTCFullYear(); // Returns 1 for 1 BC (which is year 0 in JavaScript)

      var year = signedYear > 0 ? signedYear : 1 - signedYear;
      return localize.ordinalNumber(year, {
        unit: 'year'
      });
    }

    return formatters$2.y(date, token);
  },
  // Local week-numbering year
  Y: function Y(date, token, localize, options) {
    var signedWeekYear = getUTCWeekYear(date, options); // Returns 1 for 1 BC (which is year 0 in JavaScript)

    var weekYear = signedWeekYear > 0 ? signedWeekYear : 1 - signedWeekYear; // Two digit year

    if (token === 'YY') {
      var twoDigitYear = weekYear % 100;
      return addLeadingZeros(twoDigitYear, 2);
    } // Ordinal number


    if (token === 'Yo') {
      return localize.ordinalNumber(weekYear, {
        unit: 'year'
      });
    } // Padding


    return addLeadingZeros(weekYear, token.length);
  },
  // ISO week-numbering year
  R: function R(date, token) {
    var isoWeekYear = getUTCISOWeekYear(date); // Padding

    return addLeadingZeros(isoWeekYear, token.length);
  },
  // Extended year. This is a single number designating the year of this calendar system.
  // The main difference between `y` and `u` localizers are B.C. years:
  // | Year | `y` | `u` |
  // |------|-----|-----|
  // | AC 1 |   1 |   1 |
  // | BC 1 |   1 |   0 |
  // | BC 2 |   2 |  -1 |
  // Also `yy` always returns the last two digits of a year,
  // while `uu` pads single digit years to 2 characters and returns other years unchanged.
  u: function u(date, token) {
    var year = date.getUTCFullYear();
    return addLeadingZeros(year, token.length);
  },
  // Quarter
  Q: function Q(date, token, localize) {
    var quarter = Math.ceil((date.getUTCMonth() + 1) / 3);

    switch (token) {
      // 1, 2, 3, 4
      case 'Q':
        return String(quarter);
      // 01, 02, 03, 04

      case 'QQ':
        return addLeadingZeros(quarter, 2);
      // 1st, 2nd, 3rd, 4th

      case 'Qo':
        return localize.ordinalNumber(quarter, {
          unit: 'quarter'
        });
      // Q1, Q2, Q3, Q4

      case 'QQQ':
        return localize.quarter(quarter, {
          width: 'abbreviated',
          context: 'formatting'
        });
      // 1, 2, 3, 4 (narrow quarter; could be not numerical)

      case 'QQQQQ':
        return localize.quarter(quarter, {
          width: 'narrow',
          context: 'formatting'
        });
      // 1st quarter, 2nd quarter, ...

      case 'QQQQ':
      default:
        return localize.quarter(quarter, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // Stand-alone quarter
  q: function q(date, token, localize) {
    var quarter = Math.ceil((date.getUTCMonth() + 1) / 3);

    switch (token) {
      // 1, 2, 3, 4
      case 'q':
        return String(quarter);
      // 01, 02, 03, 04

      case 'qq':
        return addLeadingZeros(quarter, 2);
      // 1st, 2nd, 3rd, 4th

      case 'qo':
        return localize.ordinalNumber(quarter, {
          unit: 'quarter'
        });
      // Q1, Q2, Q3, Q4

      case 'qqq':
        return localize.quarter(quarter, {
          width: 'abbreviated',
          context: 'standalone'
        });
      // 1, 2, 3, 4 (narrow quarter; could be not numerical)

      case 'qqqqq':
        return localize.quarter(quarter, {
          width: 'narrow',
          context: 'standalone'
        });
      // 1st quarter, 2nd quarter, ...

      case 'qqqq':
      default:
        return localize.quarter(quarter, {
          width: 'wide',
          context: 'standalone'
        });
    }
  },
  // Month
  M: function M(date, token, localize) {
    var month = date.getUTCMonth();

    switch (token) {
      case 'M':
      case 'MM':
        return formatters$2.M(date, token);
      // 1st, 2nd, ..., 12th

      case 'Mo':
        return localize.ordinalNumber(month + 1, {
          unit: 'month'
        });
      // Jan, Feb, ..., Dec

      case 'MMM':
        return localize.month(month, {
          width: 'abbreviated',
          context: 'formatting'
        });
      // J, F, ..., D

      case 'MMMMM':
        return localize.month(month, {
          width: 'narrow',
          context: 'formatting'
        });
      // January, February, ..., December

      case 'MMMM':
      default:
        return localize.month(month, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // Stand-alone month
  L: function L(date, token, localize) {
    var month = date.getUTCMonth();

    switch (token) {
      // 1, 2, ..., 12
      case 'L':
        return String(month + 1);
      // 01, 02, ..., 12

      case 'LL':
        return addLeadingZeros(month + 1, 2);
      // 1st, 2nd, ..., 12th

      case 'Lo':
        return localize.ordinalNumber(month + 1, {
          unit: 'month'
        });
      // Jan, Feb, ..., Dec

      case 'LLL':
        return localize.month(month, {
          width: 'abbreviated',
          context: 'standalone'
        });
      // J, F, ..., D

      case 'LLLLL':
        return localize.month(month, {
          width: 'narrow',
          context: 'standalone'
        });
      // January, February, ..., December

      case 'LLLL':
      default:
        return localize.month(month, {
          width: 'wide',
          context: 'standalone'
        });
    }
  },
  // Local week of year
  w: function w(date, token, localize, options) {
    var week = getUTCWeek(date, options);

    if (token === 'wo') {
      return localize.ordinalNumber(week, {
        unit: 'week'
      });
    }

    return addLeadingZeros(week, token.length);
  },
  // ISO week of year
  I: function I(date, token, localize) {
    var isoWeek = getUTCISOWeek(date);

    if (token === 'Io') {
      return localize.ordinalNumber(isoWeek, {
        unit: 'week'
      });
    }

    return addLeadingZeros(isoWeek, token.length);
  },
  // Day of the month
  d: function d(date, token, localize) {
    if (token === 'do') {
      return localize.ordinalNumber(date.getUTCDate(), {
        unit: 'date'
      });
    }

    return formatters$2.d(date, token);
  },
  // Day of year
  D: function D(date, token, localize) {
    var dayOfYear = getUTCDayOfYear(date);

    if (token === 'Do') {
      return localize.ordinalNumber(dayOfYear, {
        unit: 'dayOfYear'
      });
    }

    return addLeadingZeros(dayOfYear, token.length);
  },
  // Day of week
  E: function E(date, token, localize) {
    var dayOfWeek = date.getUTCDay();

    switch (token) {
      // Tue
      case 'E':
      case 'EE':
      case 'EEE':
        return localize.day(dayOfWeek, {
          width: 'abbreviated',
          context: 'formatting'
        });
      // T

      case 'EEEEE':
        return localize.day(dayOfWeek, {
          width: 'narrow',
          context: 'formatting'
        });
      // Tu

      case 'EEEEEE':
        return localize.day(dayOfWeek, {
          width: 'short',
          context: 'formatting'
        });
      // Tuesday

      case 'EEEE':
      default:
        return localize.day(dayOfWeek, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // Local day of week
  e: function e(date, token, localize, options) {
    var dayOfWeek = date.getUTCDay();
    var localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;

    switch (token) {
      // Numerical value (Nth day of week with current locale or weekStartsOn)
      case 'e':
        return String(localDayOfWeek);
      // Padded numerical value

      case 'ee':
        return addLeadingZeros(localDayOfWeek, 2);
      // 1st, 2nd, ..., 7th

      case 'eo':
        return localize.ordinalNumber(localDayOfWeek, {
          unit: 'day'
        });

      case 'eee':
        return localize.day(dayOfWeek, {
          width: 'abbreviated',
          context: 'formatting'
        });
      // T

      case 'eeeee':
        return localize.day(dayOfWeek, {
          width: 'narrow',
          context: 'formatting'
        });
      // Tu

      case 'eeeeee':
        return localize.day(dayOfWeek, {
          width: 'short',
          context: 'formatting'
        });
      // Tuesday

      case 'eeee':
      default:
        return localize.day(dayOfWeek, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // Stand-alone local day of week
  c: function c(date, token, localize, options) {
    var dayOfWeek = date.getUTCDay();
    var localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;

    switch (token) {
      // Numerical value (same as in `e`)
      case 'c':
        return String(localDayOfWeek);
      // Padded numerical value

      case 'cc':
        return addLeadingZeros(localDayOfWeek, token.length);
      // 1st, 2nd, ..., 7th

      case 'co':
        return localize.ordinalNumber(localDayOfWeek, {
          unit: 'day'
        });

      case 'ccc':
        return localize.day(dayOfWeek, {
          width: 'abbreviated',
          context: 'standalone'
        });
      // T

      case 'ccccc':
        return localize.day(dayOfWeek, {
          width: 'narrow',
          context: 'standalone'
        });
      // Tu

      case 'cccccc':
        return localize.day(dayOfWeek, {
          width: 'short',
          context: 'standalone'
        });
      // Tuesday

      case 'cccc':
      default:
        return localize.day(dayOfWeek, {
          width: 'wide',
          context: 'standalone'
        });
    }
  },
  // ISO day of week
  i: function i(date, token, localize) {
    var dayOfWeek = date.getUTCDay();
    var isoDayOfWeek = dayOfWeek === 0 ? 7 : dayOfWeek;

    switch (token) {
      // 2
      case 'i':
        return String(isoDayOfWeek);
      // 02

      case 'ii':
        return addLeadingZeros(isoDayOfWeek, token.length);
      // 2nd

      case 'io':
        return localize.ordinalNumber(isoDayOfWeek, {
          unit: 'day'
        });
      // Tue

      case 'iii':
        return localize.day(dayOfWeek, {
          width: 'abbreviated',
          context: 'formatting'
        });
      // T

      case 'iiiii':
        return localize.day(dayOfWeek, {
          width: 'narrow',
          context: 'formatting'
        });
      // Tu

      case 'iiiiii':
        return localize.day(dayOfWeek, {
          width: 'short',
          context: 'formatting'
        });
      // Tuesday

      case 'iiii':
      default:
        return localize.day(dayOfWeek, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // AM or PM
  a: function a(date, token, localize) {
    var hours = date.getUTCHours();
    var dayPeriodEnumValue = hours / 12 >= 1 ? 'pm' : 'am';

    switch (token) {
      case 'a':
      case 'aa':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'abbreviated',
          context: 'formatting'
        });

      case 'aaa':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'abbreviated',
          context: 'formatting'
        }).toLowerCase();

      case 'aaaaa':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'narrow',
          context: 'formatting'
        });

      case 'aaaa':
      default:
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // AM, PM, midnight, noon
  b: function b(date, token, localize) {
    var hours = date.getUTCHours();
    var dayPeriodEnumValue;

    if (hours === 12) {
      dayPeriodEnumValue = dayPeriodEnum.noon;
    } else if (hours === 0) {
      dayPeriodEnumValue = dayPeriodEnum.midnight;
    } else {
      dayPeriodEnumValue = hours / 12 >= 1 ? 'pm' : 'am';
    }

    switch (token) {
      case 'b':
      case 'bb':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'abbreviated',
          context: 'formatting'
        });

      case 'bbb':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'abbreviated',
          context: 'formatting'
        }).toLowerCase();

      case 'bbbbb':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'narrow',
          context: 'formatting'
        });

      case 'bbbb':
      default:
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // in the morning, in the afternoon, in the evening, at night
  B: function B(date, token, localize) {
    var hours = date.getUTCHours();
    var dayPeriodEnumValue;

    if (hours >= 17) {
      dayPeriodEnumValue = dayPeriodEnum.evening;
    } else if (hours >= 12) {
      dayPeriodEnumValue = dayPeriodEnum.afternoon;
    } else if (hours >= 4) {
      dayPeriodEnumValue = dayPeriodEnum.morning;
    } else {
      dayPeriodEnumValue = dayPeriodEnum.night;
    }

    switch (token) {
      case 'B':
      case 'BB':
      case 'BBB':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'abbreviated',
          context: 'formatting'
        });

      case 'BBBBB':
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'narrow',
          context: 'formatting'
        });

      case 'BBBB':
      default:
        return localize.dayPeriod(dayPeriodEnumValue, {
          width: 'wide',
          context: 'formatting'
        });
    }
  },
  // Hour [1-12]
  h: function h(date, token, localize) {
    if (token === 'ho') {
      var hours = date.getUTCHours() % 12;
      if (hours === 0) hours = 12;
      return localize.ordinalNumber(hours, {
        unit: 'hour'
      });
    }

    return formatters$2.h(date, token);
  },
  // Hour [0-23]
  H: function H(date, token, localize) {
    if (token === 'Ho') {
      return localize.ordinalNumber(date.getUTCHours(), {
        unit: 'hour'
      });
    }

    return formatters$2.H(date, token);
  },
  // Hour [0-11]
  K: function K(date, token, localize) {
    var hours = date.getUTCHours() % 12;

    if (token === 'Ko') {
      return localize.ordinalNumber(hours, {
        unit: 'hour'
      });
    }

    return addLeadingZeros(hours, token.length);
  },
  // Hour [1-24]
  k: function k(date, token, localize) {
    var hours = date.getUTCHours();
    if (hours === 0) hours = 24;

    if (token === 'ko') {
      return localize.ordinalNumber(hours, {
        unit: 'hour'
      });
    }

    return addLeadingZeros(hours, token.length);
  },
  // Minute
  m: function m(date, token, localize) {
    if (token === 'mo') {
      return localize.ordinalNumber(date.getUTCMinutes(), {
        unit: 'minute'
      });
    }

    return formatters$2.m(date, token);
  },
  // Second
  s: function s(date, token, localize) {
    if (token === 'so') {
      return localize.ordinalNumber(date.getUTCSeconds(), {
        unit: 'second'
      });
    }

    return formatters$2.s(date, token);
  },
  // Fraction of second
  S: function S(date, token) {
    return formatters$2.S(date, token);
  },
  // Timezone (ISO-8601. If offset is 0, output is always `'Z'`)
  X: function X(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timezoneOffset = originalDate.getTimezoneOffset();

    if (timezoneOffset === 0) {
      return 'Z';
    }

    switch (token) {
      // Hours and optional minutes
      case 'X':
        return formatTimezoneWithOptionalMinutes(timezoneOffset);
      // Hours, minutes and optional seconds without `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `XX`

      case 'XXXX':
      case 'XX':
        // Hours and minutes without `:` delimiter
        return formatTimezone(timezoneOffset);
      // Hours, minutes and optional seconds with `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `XXX`

      case 'XXXXX':
      case 'XXX': // Hours and minutes with `:` delimiter

      default:
        return formatTimezone(timezoneOffset, ':');
    }
  },
  // Timezone (ISO-8601. If offset is 0, output is `'+00:00'` or equivalent)
  x: function x(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timezoneOffset = originalDate.getTimezoneOffset();

    switch (token) {
      // Hours and optional minutes
      case 'x':
        return formatTimezoneWithOptionalMinutes(timezoneOffset);
      // Hours, minutes and optional seconds without `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `xx`

      case 'xxxx':
      case 'xx':
        // Hours and minutes without `:` delimiter
        return formatTimezone(timezoneOffset);
      // Hours, minutes and optional seconds with `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `xxx`

      case 'xxxxx':
      case 'xxx': // Hours and minutes with `:` delimiter

      default:
        return formatTimezone(timezoneOffset, ':');
    }
  },
  // Timezone (GMT)
  O: function O(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timezoneOffset = originalDate.getTimezoneOffset();

    switch (token) {
      // Short
      case 'O':
      case 'OO':
      case 'OOO':
        return 'GMT' + formatTimezoneShort(timezoneOffset, ':');
      // Long

      case 'OOOO':
      default:
        return 'GMT' + formatTimezone(timezoneOffset, ':');
    }
  },
  // Timezone (specific non-location)
  z: function z(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timezoneOffset = originalDate.getTimezoneOffset();

    switch (token) {
      // Short
      case 'z':
      case 'zz':
      case 'zzz':
        return 'GMT' + formatTimezoneShort(timezoneOffset, ':');
      // Long

      case 'zzzz':
      default:
        return 'GMT' + formatTimezone(timezoneOffset, ':');
    }
  },
  // Seconds timestamp
  t: function t(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timestamp = Math.floor(originalDate.getTime() / 1000);
    return addLeadingZeros(timestamp, token.length);
  },
  // Milliseconds timestamp
  T: function T(date, token, _localize, options) {
    var originalDate = options._originalDate || date;
    var timestamp = originalDate.getTime();
    return addLeadingZeros(timestamp, token.length);
  }
};

function formatTimezoneShort(offset, dirtyDelimiter) {
  var sign = offset > 0 ? '-' : '+';
  var absOffset = Math.abs(offset);
  var hours = Math.floor(absOffset / 60);
  var minutes = absOffset % 60;

  if (minutes === 0) {
    return sign + String(hours);
  }

  var delimiter = dirtyDelimiter || '';
  return sign + String(hours) + delimiter + addLeadingZeros(minutes, 2);
}

function formatTimezoneWithOptionalMinutes(offset, dirtyDelimiter) {
  if (offset % 60 === 0) {
    var sign = offset > 0 ? '-' : '+';
    return sign + addLeadingZeros(Math.abs(offset) / 60, 2);
  }

  return formatTimezone(offset, dirtyDelimiter);
}

function formatTimezone(offset, dirtyDelimiter) {
  var delimiter = dirtyDelimiter || '';
  var sign = offset > 0 ? '-' : '+';
  var absOffset = Math.abs(offset);
  var hours = addLeadingZeros(Math.floor(absOffset / 60), 2);
  var minutes = addLeadingZeros(absOffset % 60, 2);
  return sign + hours + delimiter + minutes;
}

var formatters$1 = formatters;

var dateLongFormatter = function dateLongFormatter(pattern, formatLong) {
  switch (pattern) {
    case 'P':
      return formatLong.date({
        width: 'short'
      });

    case 'PP':
      return formatLong.date({
        width: 'medium'
      });

    case 'PPP':
      return formatLong.date({
        width: 'long'
      });

    case 'PPPP':
    default:
      return formatLong.date({
        width: 'full'
      });
  }
};

var timeLongFormatter = function timeLongFormatter(pattern, formatLong) {
  switch (pattern) {
    case 'p':
      return formatLong.time({
        width: 'short'
      });

    case 'pp':
      return formatLong.time({
        width: 'medium'
      });

    case 'ppp':
      return formatLong.time({
        width: 'long'
      });

    case 'pppp':
    default:
      return formatLong.time({
        width: 'full'
      });
  }
};

var dateTimeLongFormatter = function dateTimeLongFormatter(pattern, formatLong) {
  var matchResult = pattern.match(/(P+)(p+)?/) || [];
  var datePattern = matchResult[1];
  var timePattern = matchResult[2];

  if (!timePattern) {
    return dateLongFormatter(pattern, formatLong);
  }

  var dateTimeFormat;

  switch (datePattern) {
    case 'P':
      dateTimeFormat = formatLong.dateTime({
        width: 'short'
      });
      break;

    case 'PP':
      dateTimeFormat = formatLong.dateTime({
        width: 'medium'
      });
      break;

    case 'PPP':
      dateTimeFormat = formatLong.dateTime({
        width: 'long'
      });
      break;

    case 'PPPP':
    default:
      dateTimeFormat = formatLong.dateTime({
        width: 'full'
      });
      break;
  }

  return dateTimeFormat.replace('{{date}}', dateLongFormatter(datePattern, formatLong)).replace('{{time}}', timeLongFormatter(timePattern, formatLong));
};

var longFormatters = {
  p: timeLongFormatter,
  P: dateTimeLongFormatter
};
var longFormatters$1 = longFormatters;

var protectedDayOfYearTokens = ['D', 'DD'];
var protectedWeekYearTokens = ['YY', 'YYYY'];
function isProtectedDayOfYearToken(token) {
  return protectedDayOfYearTokens.indexOf(token) !== -1;
}
function isProtectedWeekYearToken(token) {
  return protectedWeekYearTokens.indexOf(token) !== -1;
}
function throwProtectedError(token, format, input) {
  if (token === 'YYYY') {
    throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(format, "`) for formatting years to the input `").concat(input, "`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));
  } else if (token === 'YY') {
    throw new RangeError("Use `yy` instead of `YY` (in `".concat(format, "`) for formatting years to the input `").concat(input, "`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));
  } else if (token === 'D') {
    throw new RangeError("Use `d` instead of `D` (in `".concat(format, "`) for formatting days of the month to the input `").concat(input, "`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));
  } else if (token === 'DD') {
    throw new RangeError("Use `dd` instead of `DD` (in `".concat(format, "`) for formatting days of the month to the input `").concat(input, "`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));
  }
}

var formatDistanceLocale = {
  lessThanXSeconds: {
    one: 'less than a second',
    other: 'less than {{count}} seconds'
  },
  xSeconds: {
    one: '1 second',
    other: '{{count}} seconds'
  },
  halfAMinute: 'half a minute',
  lessThanXMinutes: {
    one: 'less than a minute',
    other: 'less than {{count}} minutes'
  },
  xMinutes: {
    one: '1 minute',
    other: '{{count}} minutes'
  },
  aboutXHours: {
    one: 'about 1 hour',
    other: 'about {{count}} hours'
  },
  xHours: {
    one: '1 hour',
    other: '{{count}} hours'
  },
  xDays: {
    one: '1 day',
    other: '{{count}} days'
  },
  aboutXWeeks: {
    one: 'about 1 week',
    other: 'about {{count}} weeks'
  },
  xWeeks: {
    one: '1 week',
    other: '{{count}} weeks'
  },
  aboutXMonths: {
    one: 'about 1 month',
    other: 'about {{count}} months'
  },
  xMonths: {
    one: '1 month',
    other: '{{count}} months'
  },
  aboutXYears: {
    one: 'about 1 year',
    other: 'about {{count}} years'
  },
  xYears: {
    one: '1 year',
    other: '{{count}} years'
  },
  overXYears: {
    one: 'over 1 year',
    other: 'over {{count}} years'
  },
  almostXYears: {
    one: 'almost 1 year',
    other: 'almost {{count}} years'
  }
};

var formatDistance = function formatDistance(token, count, options) {
  var result;
  var tokenValue = formatDistanceLocale[token];

  if (typeof tokenValue === 'string') {
    result = tokenValue;
  } else if (count === 1) {
    result = tokenValue.one;
  } else {
    result = tokenValue.other.replace('{{count}}', count.toString());
  }

  if (options !== null && options !== void 0 && options.addSuffix) {
    if (options.comparison && options.comparison > 0) {
      return 'in ' + result;
    } else {
      return result + ' ago';
    }
  }

  return result;
};

function buildFormatLongFn(args) {
  return function () {
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}; // TODO: Remove String()

    var width = options.width ? String(options.width) : args.defaultWidth;
    var format = args.formats[width] || args.formats[args.defaultWidth];
    return format;
  };
}

var dateFormats = {
  full: 'EEEE, MMMM do, y',
  long: 'MMMM do, y',
  medium: 'MMM d, y',
  short: 'MM/dd/yyyy'
};
var timeFormats = {
  full: 'h:mm:ss a zzzz',
  long: 'h:mm:ss a z',
  medium: 'h:mm:ss a',
  short: 'h:mm a'
};
var dateTimeFormats = {
  full: "{{date}} 'at' {{time}}",
  long: "{{date}} 'at' {{time}}",
  medium: '{{date}}, {{time}}',
  short: '{{date}}, {{time}}'
};
var formatLong = {
  date: buildFormatLongFn({
    formats: dateFormats,
    defaultWidth: 'full'
  }),
  time: buildFormatLongFn({
    formats: timeFormats,
    defaultWidth: 'full'
  }),
  dateTime: buildFormatLongFn({
    formats: dateTimeFormats,
    defaultWidth: 'full'
  })
};

var formatRelativeLocale = {
  lastWeek: "'last' eeee 'at' p",
  yesterday: "'yesterday at' p",
  today: "'today at' p",
  tomorrow: "'tomorrow at' p",
  nextWeek: "eeee 'at' p",
  other: 'P'
};

var formatRelative = function formatRelative(token, _date, _baseDate, _options) {
  return formatRelativeLocale[token];
};

function buildLocalizeFn(args) {
  return function (dirtyIndex, options) {
    var context = options !== null && options !== void 0 && options.context ? String(options.context) : 'standalone';
    var valuesArray;

    if (context === 'formatting' && args.formattingValues) {
      var defaultWidth = args.defaultFormattingWidth || args.defaultWidth;
      var width = options !== null && options !== void 0 && options.width ? String(options.width) : defaultWidth;
      valuesArray = args.formattingValues[width] || args.formattingValues[defaultWidth];
    } else {
      var _defaultWidth = args.defaultWidth;

      var _width = options !== null && options !== void 0 && options.width ? String(options.width) : args.defaultWidth;

      valuesArray = args.values[_width] || args.values[_defaultWidth];
    }

    var index = args.argumentCallback ? args.argumentCallback(dirtyIndex) : dirtyIndex; // @ts-ignore: For some reason TypeScript just don't want to match it, no matter how hard we try. I challenge you to try to remove it!

    return valuesArray[index];
  };
}

var eraValues = {
  narrow: ['B', 'A'],
  abbreviated: ['BC', 'AD'],
  wide: ['Before Christ', 'Anno Domini']
};
var quarterValues = {
  narrow: ['1', '2', '3', '4'],
  abbreviated: ['Q1', 'Q2', 'Q3', 'Q4'],
  wide: ['1st quarter', '2nd quarter', '3rd quarter', '4th quarter']
}; // Note: in English, the names of days of the week and months are capitalized.
// If you are making a new locale based on this one, check if the same is true for the language you're working on.
// Generally, formatted dates should look like they are in the middle of a sentence,
// e.g. in Spanish language the weekdays and months should be in the lowercase.

var monthValues = {
  narrow: ['J', 'F', 'M', 'A', 'M', 'J', 'J', 'A', 'S', 'O', 'N', 'D'],
  abbreviated: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
  wide: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
};
var dayValues = {
  narrow: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],
  short: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
  abbreviated: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
  wide: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
};
var dayPeriodValues = {
  narrow: {
    am: 'a',
    pm: 'p',
    midnight: 'mi',
    noon: 'n',
    morning: 'morning',
    afternoon: 'afternoon',
    evening: 'evening',
    night: 'night'
  },
  abbreviated: {
    am: 'AM',
    pm: 'PM',
    midnight: 'midnight',
    noon: 'noon',
    morning: 'morning',
    afternoon: 'afternoon',
    evening: 'evening',
    night: 'night'
  },
  wide: {
    am: 'a.m.',
    pm: 'p.m.',
    midnight: 'midnight',
    noon: 'noon',
    morning: 'morning',
    afternoon: 'afternoon',
    evening: 'evening',
    night: 'night'
  }
};
var formattingDayPeriodValues = {
  narrow: {
    am: 'a',
    pm: 'p',
    midnight: 'mi',
    noon: 'n',
    morning: 'in the morning',
    afternoon: 'in the afternoon',
    evening: 'in the evening',
    night: 'at night'
  },
  abbreviated: {
    am: 'AM',
    pm: 'PM',
    midnight: 'midnight',
    noon: 'noon',
    morning: 'in the morning',
    afternoon: 'in the afternoon',
    evening: 'in the evening',
    night: 'at night'
  },
  wide: {
    am: 'a.m.',
    pm: 'p.m.',
    midnight: 'midnight',
    noon: 'noon',
    morning: 'in the morning',
    afternoon: 'in the afternoon',
    evening: 'in the evening',
    night: 'at night'
  }
};

var ordinalNumber = function ordinalNumber(dirtyNumber, _options) {
  var number = Number(dirtyNumber); // If ordinal numbers depend on context, for example,
  // if they are different for different grammatical genders,
  // use `options.unit`.
  //
  // `unit` can be 'year', 'quarter', 'month', 'week', 'date', 'dayOfYear',
  // 'day', 'hour', 'minute', 'second'.

  var rem100 = number % 100;

  if (rem100 > 20 || rem100 < 10) {
    switch (rem100 % 10) {
      case 1:
        return number + 'st';

      case 2:
        return number + 'nd';

      case 3:
        return number + 'rd';
    }
  }

  return number + 'th';
};

var localize = {
  ordinalNumber: ordinalNumber,
  era: buildLocalizeFn({
    values: eraValues,
    defaultWidth: 'wide'
  }),
  quarter: buildLocalizeFn({
    values: quarterValues,
    defaultWidth: 'wide',
    argumentCallback: function argumentCallback(quarter) {
      return quarter - 1;
    }
  }),
  month: buildLocalizeFn({
    values: monthValues,
    defaultWidth: 'wide'
  }),
  day: buildLocalizeFn({
    values: dayValues,
    defaultWidth: 'wide'
  }),
  dayPeriod: buildLocalizeFn({
    values: dayPeriodValues,
    defaultWidth: 'wide',
    formattingValues: formattingDayPeriodValues,
    defaultFormattingWidth: 'wide'
  })
};

function buildMatchFn(args) {
  return function (string) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var width = options.width;
    var matchPattern = width && args.matchPatterns[width] || args.matchPatterns[args.defaultMatchWidth];
    var matchResult = string.match(matchPattern);

    if (!matchResult) {
      return null;
    }

    var matchedString = matchResult[0];
    var parsePatterns = width && args.parsePatterns[width] || args.parsePatterns[args.defaultParseWidth];
    var key = Array.isArray(parsePatterns) ? findIndex(parsePatterns, function (pattern) {
      return pattern.test(matchedString);
    }) : findKey(parsePatterns, function (pattern) {
      return pattern.test(matchedString);
    });
    var value;
    value = args.valueCallback ? args.valueCallback(key) : key;
    value = options.valueCallback ? options.valueCallback(value) : value;
    var rest = string.slice(matchedString.length);
    return {
      value: value,
      rest: rest
    };
  };
}

function findKey(object, predicate) {
  for (var key in object) {
    if (object.hasOwnProperty(key) && predicate(object[key])) {
      return key;
    }
  }

  return undefined;
}

function findIndex(array, predicate) {
  for (var key = 0; key < array.length; key++) {
    if (predicate(array[key])) {
      return key;
    }
  }

  return undefined;
}

function buildMatchPatternFn(args) {
  return function (string) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var matchResult = string.match(args.matchPattern);
    if (!matchResult) return null;
    var matchedString = matchResult[0];
    var parseResult = string.match(args.parsePattern);
    if (!parseResult) return null;
    var value = args.valueCallback ? args.valueCallback(parseResult[0]) : parseResult[0];
    value = options.valueCallback ? options.valueCallback(value) : value;
    var rest = string.slice(matchedString.length);
    return {
      value: value,
      rest: rest
    };
  };
}

var matchOrdinalNumberPattern = /^(\d+)(th|st|nd|rd)?/i;
var parseOrdinalNumberPattern = /\d+/i;
var matchEraPatterns = {
  narrow: /^(b|a)/i,
  abbreviated: /^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,
  wide: /^(before christ|before common era|anno domini|common era)/i
};
var parseEraPatterns = {
  any: [/^b/i, /^(a|c)/i]
};
var matchQuarterPatterns = {
  narrow: /^[1234]/i,
  abbreviated: /^q[1234]/i,
  wide: /^[1234](th|st|nd|rd)? quarter/i
};
var parseQuarterPatterns = {
  any: [/1/i, /2/i, /3/i, /4/i]
};
var matchMonthPatterns = {
  narrow: /^[jfmasond]/i,
  abbreviated: /^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,
  wide: /^(january|february|march|april|may|june|july|august|september|october|november|december)/i
};
var parseMonthPatterns = {
  narrow: [/^j/i, /^f/i, /^m/i, /^a/i, /^m/i, /^j/i, /^j/i, /^a/i, /^s/i, /^o/i, /^n/i, /^d/i],
  any: [/^ja/i, /^f/i, /^mar/i, /^ap/i, /^may/i, /^jun/i, /^jul/i, /^au/i, /^s/i, /^o/i, /^n/i, /^d/i]
};
var matchDayPatterns = {
  narrow: /^[smtwf]/i,
  short: /^(su|mo|tu|we|th|fr|sa)/i,
  abbreviated: /^(sun|mon|tue|wed|thu|fri|sat)/i,
  wide: /^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i
};
var parseDayPatterns = {
  narrow: [/^s/i, /^m/i, /^t/i, /^w/i, /^t/i, /^f/i, /^s/i],
  any: [/^su/i, /^m/i, /^tu/i, /^w/i, /^th/i, /^f/i, /^sa/i]
};
var matchDayPeriodPatterns = {
  narrow: /^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,
  any: /^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i
};
var parseDayPeriodPatterns = {
  any: {
    am: /^a/i,
    pm: /^p/i,
    midnight: /^mi/i,
    noon: /^no/i,
    morning: /morning/i,
    afternoon: /afternoon/i,
    evening: /evening/i,
    night: /night/i
  }
};
var match = {
  ordinalNumber: buildMatchPatternFn({
    matchPattern: matchOrdinalNumberPattern,
    parsePattern: parseOrdinalNumberPattern,
    valueCallback: function valueCallback(value) {
      return parseInt(value, 10);
    }
  }),
  era: buildMatchFn({
    matchPatterns: matchEraPatterns,
    defaultMatchWidth: 'wide',
    parsePatterns: parseEraPatterns,
    defaultParseWidth: 'any'
  }),
  quarter: buildMatchFn({
    matchPatterns: matchQuarterPatterns,
    defaultMatchWidth: 'wide',
    parsePatterns: parseQuarterPatterns,
    defaultParseWidth: 'any',
    valueCallback: function valueCallback(index) {
      return index + 1;
    }
  }),
  month: buildMatchFn({
    matchPatterns: matchMonthPatterns,
    defaultMatchWidth: 'wide',
    parsePatterns: parseMonthPatterns,
    defaultParseWidth: 'any'
  }),
  day: buildMatchFn({
    matchPatterns: matchDayPatterns,
    defaultMatchWidth: 'wide',
    parsePatterns: parseDayPatterns,
    defaultParseWidth: 'any'
  }),
  dayPeriod: buildMatchFn({
    matchPatterns: matchDayPeriodPatterns,
    defaultMatchWidth: 'any',
    parsePatterns: parseDayPeriodPatterns,
    defaultParseWidth: 'any'
  })
};

/**
 * @type {Locale}
 * @category Locales
 * @summary English locale (United States).
 * @language English
 * @iso-639-2 eng
 * @author Sasha Koss [@kossnocorp]{@link https://github.com/kossnocorp}
 * @author Lesha Koss [@leshakoss]{@link https://github.com/leshakoss}
 */

var locale = {
  code: 'en-US',
  formatDistance: formatDistance,
  formatLong: formatLong,
  formatRelative: formatRelative,
  localize: localize,
  match: match,
  options: {
    weekStartsOn: 0
    /* Sunday */
    ,
    firstWeekContainsDate: 1
  }
};
var defaultLocale = locale;

// - [yYQqMLwIdDecihHKkms]o matches any available ordinal number token
//   (one of the certain letters followed by `o`)
// - (\w)\1* matches any sequences of the same letter
// - '' matches two quote characters in a row
// - '(''|[^'])+('|$) matches anything surrounded by two quote characters ('),
//   except a single quote symbol, which ends the sequence.
//   Two quote characters do not end the sequence.
//   If there is no matching single quote
//   then the sequence will continue until the end of the string.
// - . matches any single character unmatched by previous parts of the RegExps

var formattingTokensRegExp = /[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g; // This RegExp catches symbols escaped by quotes, and also
// sequences of symbols P, p, and the combinations like `PPPPPPPppppp`

var longFormattingTokensRegExp = /P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;
var escapedStringRegExp = /^'([^]*?)'?$/;
var doubleQuoteRegExp = /''/g;
var unescapedLatinCharacterRegExp = /[a-zA-Z]/;
/**
 * @name format
 * @category Common Helpers
 * @summary Format the date.
 *
 * @description
 * Return the formatted date string in the given format. The result may vary by locale.
 *
 * > â ï¸ Please note that the `format` tokens differ from Moment.js and other libraries.
 * > See: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 *
 * The characters wrapped between two single quotes characters (') are escaped.
 * Two single quotes in a row, whether inside or outside a quoted sequence, represent a 'real' single quote.
 * (see the last example)
 *
 * Format of the string is based on Unicode Technical Standard #35:
 * https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table
 * with a few additions (see note 7 below the table).
 *
 * Accepted patterns:
 * | Unit                            | Pattern | Result examples                   | Notes |
 * |---------------------------------|---------|-----------------------------------|-------|
 * | Era                             | G..GGG  | AD, BC                            |       |
 * |                                 | GGGG    | Anno Domini, Before Christ        | 2     |
 * |                                 | GGGGG   | A, B                              |       |
 * | Calendar year                   | y       | 44, 1, 1900, 2017                 | 5     |
 * |                                 | yo      | 44th, 1st, 0th, 17th              | 5,7   |
 * |                                 | yy      | 44, 01, 00, 17                    | 5     |
 * |                                 | yyy     | 044, 001, 1900, 2017              | 5     |
 * |                                 | yyyy    | 0044, 0001, 1900, 2017            | 5     |
 * |                                 | yyyyy   | ...                               | 3,5   |
 * | Local week-numbering year       | Y       | 44, 1, 1900, 2017                 | 5     |
 * |                                 | Yo      | 44th, 1st, 1900th, 2017th         | 5,7   |
 * |                                 | YY      | 44, 01, 00, 17                    | 5,8   |
 * |                                 | YYY     | 044, 001, 1900, 2017              | 5     |
 * |                                 | YYYY    | 0044, 0001, 1900, 2017            | 5,8   |
 * |                                 | YYYYY   | ...                               | 3,5   |
 * | ISO week-numbering year         | R       | -43, 0, 1, 1900, 2017             | 5,7   |
 * |                                 | RR      | -43, 00, 01, 1900, 2017           | 5,7   |
 * |                                 | RRR     | -043, 000, 001, 1900, 2017        | 5,7   |
 * |                                 | RRRR    | -0043, 0000, 0001, 1900, 2017     | 5,7   |
 * |                                 | RRRRR   | ...                               | 3,5,7 |
 * | Extended year                   | u       | -43, 0, 1, 1900, 2017             | 5     |
 * |                                 | uu      | -43, 01, 1900, 2017               | 5     |
 * |                                 | uuu     | -043, 001, 1900, 2017             | 5     |
 * |                                 | uuuu    | -0043, 0001, 1900, 2017           | 5     |
 * |                                 | uuuuu   | ...                               | 3,5   |
 * | Quarter (formatting)            | Q       | 1, 2, 3, 4                        |       |
 * |                                 | Qo      | 1st, 2nd, 3rd, 4th                | 7     |
 * |                                 | QQ      | 01, 02, 03, 04                    |       |
 * |                                 | QQQ     | Q1, Q2, Q3, Q4                    |       |
 * |                                 | QQQQ    | 1st quarter, 2nd quarter, ...     | 2     |
 * |                                 | QQQQQ   | 1, 2, 3, 4                        | 4     |
 * | Quarter (stand-alone)           | q       | 1, 2, 3, 4                        |       |
 * |                                 | qo      | 1st, 2nd, 3rd, 4th                | 7     |
 * |                                 | qq      | 01, 02, 03, 04                    |       |
 * |                                 | qqq     | Q1, Q2, Q3, Q4                    |       |
 * |                                 | qqqq    | 1st quarter, 2nd quarter, ...     | 2     |
 * |                                 | qqqqq   | 1, 2, 3, 4                        | 4     |
 * | Month (formatting)              | M       | 1, 2, ..., 12                     |       |
 * |                                 | Mo      | 1st, 2nd, ..., 12th               | 7     |
 * |                                 | MM      | 01, 02, ..., 12                   |       |
 * |                                 | MMM     | Jan, Feb, ..., Dec                |       |
 * |                                 | MMMM    | January, February, ..., December  | 2     |
 * |                                 | MMMMM   | J, F, ..., D                      |       |
 * | Month (stand-alone)             | L       | 1, 2, ..., 12                     |       |
 * |                                 | Lo      | 1st, 2nd, ..., 12th               | 7     |
 * |                                 | LL      | 01, 02, ..., 12                   |       |
 * |                                 | LLL     | Jan, Feb, ..., Dec                |       |
 * |                                 | LLLL    | January, February, ..., December  | 2     |
 * |                                 | LLLLL   | J, F, ..., D                      |       |
 * | Local week of year              | w       | 1, 2, ..., 53                     |       |
 * |                                 | wo      | 1st, 2nd, ..., 53th               | 7     |
 * |                                 | ww      | 01, 02, ..., 53                   |       |
 * | ISO week of year                | I       | 1, 2, ..., 53                     | 7     |
 * |                                 | Io      | 1st, 2nd, ..., 53th               | 7     |
 * |                                 | II      | 01, 02, ..., 53                   | 7     |
 * | Day of month                    | d       | 1, 2, ..., 31                     |       |
 * |                                 | do      | 1st, 2nd, ..., 31st               | 7     |
 * |                                 | dd      | 01, 02, ..., 31                   |       |
 * | Day of year                     | D       | 1, 2, ..., 365, 366               | 9     |
 * |                                 | Do      | 1st, 2nd, ..., 365th, 366th       | 7     |
 * |                                 | DD      | 01, 02, ..., 365, 366             | 9     |
 * |                                 | DDD     | 001, 002, ..., 365, 366           |       |
 * |                                 | DDDD    | ...                               | 3     |
 * | Day of week (formatting)        | E..EEE  | Mon, Tue, Wed, ..., Sun           |       |
 * |                                 | EEEE    | Monday, Tuesday, ..., Sunday      | 2     |
 * |                                 | EEEEE   | M, T, W, T, F, S, S               |       |
 * |                                 | EEEEEE  | Mo, Tu, We, Th, Fr, Sa, Su        |       |
 * | ISO day of week (formatting)    | i       | 1, 2, 3, ..., 7                   | 7     |
 * |                                 | io      | 1st, 2nd, ..., 7th                | 7     |
 * |                                 | ii      | 01, 02, ..., 07                   | 7     |
 * |                                 | iii     | Mon, Tue, Wed, ..., Sun           | 7     |
 * |                                 | iiii    | Monday, Tuesday, ..., Sunday      | 2,7   |
 * |                                 | iiiii   | M, T, W, T, F, S, S               | 7     |
 * |                                 | iiiiii  | Mo, Tu, We, Th, Fr, Sa, Su        | 7     |
 * | Local day of week (formatting)  | e       | 2, 3, 4, ..., 1                   |       |
 * |                                 | eo      | 2nd, 3rd, ..., 1st                | 7     |
 * |                                 | ee      | 02, 03, ..., 01                   |       |
 * |                                 | eee     | Mon, Tue, Wed, ..., Sun           |       |
 * |                                 | eeee    | Monday, Tuesday, ..., Sunday      | 2     |
 * |                                 | eeeee   | M, T, W, T, F, S, S               |       |
 * |                                 | eeeeee  | Mo, Tu, We, Th, Fr, Sa, Su        |       |
 * | Local day of week (stand-alone) | c       | 2, 3, 4, ..., 1                   |       |
 * |                                 | co      | 2nd, 3rd, ..., 1st                | 7     |
 * |                                 | cc      | 02, 03, ..., 01                   |       |
 * |                                 | ccc     | Mon, Tue, Wed, ..., Sun           |       |
 * |                                 | cccc    | Monday, Tuesday, ..., Sunday      | 2     |
 * |                                 | ccccc   | M, T, W, T, F, S, S               |       |
 * |                                 | cccccc  | Mo, Tu, We, Th, Fr, Sa, Su        |       |
 * | AM, PM                          | a..aa   | AM, PM                            |       |
 * |                                 | aaa     | am, pm                            |       |
 * |                                 | aaaa    | a.m., p.m.                        | 2     |
 * |                                 | aaaaa   | a, p                              |       |
 * | AM, PM, noon, midnight          | b..bb   | AM, PM, noon, midnight            |       |
 * |                                 | bbb     | am, pm, noon, midnight            |       |
 * |                                 | bbbb    | a.m., p.m., noon, midnight        | 2     |
 * |                                 | bbbbb   | a, p, n, mi                       |       |
 * | Flexible day period             | B..BBB  | at night, in the morning, ...     |       |
 * |                                 | BBBB    | at night, in the morning, ...     | 2     |
 * |                                 | BBBBB   | at night, in the morning, ...     |       |
 * | Hour [1-12]                     | h       | 1, 2, ..., 11, 12                 |       |
 * |                                 | ho      | 1st, 2nd, ..., 11th, 12th         | 7     |
 * |                                 | hh      | 01, 02, ..., 11, 12               |       |
 * | Hour [0-23]                     | H       | 0, 1, 2, ..., 23                  |       |
 * |                                 | Ho      | 0th, 1st, 2nd, ..., 23rd          | 7     |
 * |                                 | HH      | 00, 01, 02, ..., 23               |       |
 * | Hour [0-11]                     | K       | 1, 2, ..., 11, 0                  |       |
 * |                                 | Ko      | 1st, 2nd, ..., 11th, 0th          | 7     |
 * |                                 | KK      | 01, 02, ..., 11, 00               |       |
 * | Hour [1-24]                     | k       | 24, 1, 2, ..., 23                 |       |
 * |                                 | ko      | 24th, 1st, 2nd, ..., 23rd         | 7     |
 * |                                 | kk      | 24, 01, 02, ..., 23               |       |
 * | Minute                          | m       | 0, 1, ..., 59                     |       |
 * |                                 | mo      | 0th, 1st, ..., 59th               | 7     |
 * |                                 | mm      | 00, 01, ..., 59                   |       |
 * | Second                          | s       | 0, 1, ..., 59                     |       |
 * |                                 | so      | 0th, 1st, ..., 59th               | 7     |
 * |                                 | ss      | 00, 01, ..., 59                   |       |
 * | Fraction of second              | S       | 0, 1, ..., 9                      |       |
 * |                                 | SS      | 00, 01, ..., 99                   |       |
 * |                                 | SSS     | 000, 001, ..., 999                |       |
 * |                                 | SSSS    | ...                               | 3     |
 * | Timezone (ISO-8601 w/ Z)        | X       | -08, +0530, Z                     |       |
 * |                                 | XX      | -0800, +0530, Z                   |       |
 * |                                 | XXX     | -08:00, +05:30, Z                 |       |
 * |                                 | XXXX    | -0800, +0530, Z, +123456          | 2     |
 * |                                 | XXXXX   | -08:00, +05:30, Z, +12:34:56      |       |
 * | Timezone (ISO-8601 w/o Z)       | x       | -08, +0530, +00                   |       |
 * |                                 | xx      | -0800, +0530, +0000               |       |
 * |                                 | xxx     | -08:00, +05:30, +00:00            | 2     |
 * |                                 | xxxx    | -0800, +0530, +0000, +123456      |       |
 * |                                 | xxxxx   | -08:00, +05:30, +00:00, +12:34:56 |       |
 * | Timezone (GMT)                  | O...OOO | GMT-8, GMT+5:30, GMT+0            |       |
 * |                                 | OOOO    | GMT-08:00, GMT+05:30, GMT+00:00   | 2     |
 * | Timezone (specific non-locat.)  | z...zzz | GMT-8, GMT+5:30, GMT+0            | 6     |
 * |                                 | zzzz    | GMT-08:00, GMT+05:30, GMT+00:00   | 2,6   |
 * | Seconds timestamp               | t       | 512969520                         | 7     |
 * |                                 | tt      | ...                               | 3,7   |
 * | Milliseconds timestamp          | T       | 512969520900                      | 7     |
 * |                                 | TT      | ...                               | 3,7   |
 * | Long localized date             | P       | 04/29/1453                        | 7     |
 * |                                 | PP      | Apr 29, 1453                      | 7     |
 * |                                 | PPP     | April 29th, 1453                  | 7     |
 * |                                 | PPPP    | Friday, April 29th, 1453          | 2,7   |
 * | Long localized time             | p       | 12:00 AM                          | 7     |
 * |                                 | pp      | 12:00:00 AM                       | 7     |
 * |                                 | ppp     | 12:00:00 AM GMT+2                 | 7     |
 * |                                 | pppp    | 12:00:00 AM GMT+02:00             | 2,7   |
 * | Combination of date and time    | Pp      | 04/29/1453, 12:00 AM              | 7     |
 * |                                 | PPpp    | Apr 29, 1453, 12:00:00 AM         | 7     |
 * |                                 | PPPppp  | April 29th, 1453 at ...           | 7     |
 * |                                 | PPPPpppp| Friday, April 29th, 1453 at ...   | 2,7   |
 * Notes:
 * 1. "Formatting" units (e.g. formatting quarter) in the default en-US locale
 *    are the same as "stand-alone" units, but are different in some languages.
 *    "Formatting" units are declined according to the rules of the language
 *    in the context of a date. "Stand-alone" units are always nominative singular:
 *
 *    `format(new Date(2017, 10, 6), 'do LLLL', {locale: cs}) //=> '6. listopad'`
 *
 *    `format(new Date(2017, 10, 6), 'do MMMM', {locale: cs}) //=> '6. listopadu'`
 *
 * 2. Any sequence of the identical letters is a pattern, unless it is escaped by
 *    the single quote characters (see below).
 *    If the sequence is longer than listed in table (e.g. `EEEEEEEEEEE`)
 *    the output will be the same as default pattern for this unit, usually
 *    the longest one (in case of ISO weekdays, `EEEE`). Default patterns for units
 *    are marked with "2" in the last column of the table.
 *
 *    `format(new Date(2017, 10, 6), 'MMM') //=> 'Nov'`
 *
 *    `format(new Date(2017, 10, 6), 'MMMM') //=> 'November'`
 *
 *    `format(new Date(2017, 10, 6), 'MMMMM') //=> 'N'`
 *
 *    `format(new Date(2017, 10, 6), 'MMMMMM') //=> 'November'`
 *
 *    `format(new Date(2017, 10, 6), 'MMMMMMM') //=> 'November'`
 *
 * 3. Some patterns could be unlimited length (such as `yyyyyyyy`).
 *    The output will be padded with zeros to match the length of the pattern.
 *
 *    `format(new Date(2017, 10, 6), 'yyyyyyyy') //=> '00002017'`
 *
 * 4. `QQQQQ` and `qqqqq` could be not strictly numerical in some locales.
 *    These tokens represent the shortest form of the quarter.
 *
 * 5. The main difference between `y` and `u` patterns are B.C. years:
 *
 *    | Year | `y` | `u` |
 *    |------|-----|-----|
 *    | AC 1 |   1 |   1 |
 *    | BC 1 |   1 |   0 |
 *    | BC 2 |   2 |  -1 |
 *
 *    Also `yy` always returns the last two digits of a year,
 *    while `uu` pads single digit years to 2 characters and returns other years unchanged:
 *
 *    | Year | `yy` | `uu` |
 *    |------|------|------|
 *    | 1    |   01 |   01 |
 *    | 14   |   14 |   14 |
 *    | 376  |   76 |  376 |
 *    | 1453 |   53 | 1453 |
 *
 *    The same difference is true for local and ISO week-numbering years (`Y` and `R`),
 *    except local week-numbering years are dependent on `options.weekStartsOn`
 *    and `options.firstWeekContainsDate` (compare [getISOWeekYear]{@link https://date-fns.org/docs/getISOWeekYear}
 *    and [getWeekYear]{@link https://date-fns.org/docs/getWeekYear}).
 *
 * 6. Specific non-location timezones are currently unavailable in `date-fns`,
 *    so right now these tokens fall back to GMT timezones.
 *
 * 7. These patterns are not in the Unicode Technical Standard #35:
 *    - `i`: ISO day of week
 *    - `I`: ISO week of year
 *    - `R`: ISO week-numbering year
 *    - `t`: seconds timestamp
 *    - `T`: milliseconds timestamp
 *    - `o`: ordinal number modifier
 *    - `P`: long localized date
 *    - `p`: long localized time
 *
 * 8. `YY` and `YYYY` tokens represent week-numbering years but they are often confused with years.
 *    You should enable `options.useAdditionalWeekYearTokens` to use them. See: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 *
 * 9. `D` and `DD` tokens represent days of the year but they are often confused with days of the month.
 *    You should enable `options.useAdditionalDayOfYearTokens` to use them. See: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 *
 * @param {Date|Number} date - the original date
 * @param {String} format - the string of tokens
 * @param {Object} [options] - an object with options.
 * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}
 * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)
 * @param {Number} [options.firstWeekContainsDate=1] - the day of January, which is
 * @param {Boolean} [options.useAdditionalWeekYearTokens=false] - if true, allows usage of the week-numbering year tokens `YY` and `YYYY`;
 *   see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @param {Boolean} [options.useAdditionalDayOfYearTokens=false] - if true, allows usage of the day of year tokens `D` and `DD`;
 *   see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @returns {String} the formatted date string
 * @throws {TypeError} 2 arguments required
 * @throws {RangeError} `date` must not be Invalid Date
 * @throws {RangeError} `options.locale` must contain `localize` property
 * @throws {RangeError} `options.locale` must contain `formatLong` property
 * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6
 * @throws {RangeError} `options.firstWeekContainsDate` must be between 1 and 7
 * @throws {RangeError} use `yyyy` instead of `YYYY` for formatting years using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @throws {RangeError} use `yy` instead of `YY` for formatting years using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @throws {RangeError} use `d` instead of `D` for formatting days of the month using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @throws {RangeError} use `dd` instead of `DD` for formatting days of the month using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md
 * @throws {RangeError} format string contains an unescaped latin alphabet character
 *
 * @example
 * // Represent 11 February 2014 in middle-endian format:
 * const result = format(new Date(2014, 1, 11), 'MM/dd/yyyy')
 * //=> '02/11/2014'
 *
 * @example
 * // Represent 2 July 2014 in Esperanto:
 * import { eoLocale } from 'date-fns/locale/eo'
 * const result = format(new Date(2014, 6, 2), "do 'de' MMMM yyyy", {
 *   locale: eoLocale
 * })
 * //=> '2-a de julio 2014'
 *
 * @example
 * // Escape string by single quote characters:
 * const result = format(new Date(2014, 6, 2, 15), "h 'o''clock'")
 * //=> "3 o'clock"
 */

function format(dirtyDate, dirtyFormatStr, options) {
  var _ref, _options$locale, _ref2, _ref3, _ref4, _options$firstWeekCon, _options$locale2, _options$locale2$opti, _defaultOptions$local, _defaultOptions$local2, _ref5, _ref6, _ref7, _options$weekStartsOn, _options$locale3, _options$locale3$opti, _defaultOptions$local3, _defaultOptions$local4;

  requiredArgs(2, arguments);
  var formatStr = String(dirtyFormatStr);
  var defaultOptions = getDefaultOptions();
  var locale = (_ref = (_options$locale = options === null || options === void 0 ? void 0 : options.locale) !== null && _options$locale !== void 0 ? _options$locale : defaultOptions.locale) !== null && _ref !== void 0 ? _ref : defaultLocale;
  var firstWeekContainsDate = toInteger((_ref2 = (_ref3 = (_ref4 = (_options$firstWeekCon = options === null || options === void 0 ? void 0 : options.firstWeekContainsDate) !== null && _options$firstWeekCon !== void 0 ? _options$firstWeekCon : options === null || options === void 0 ? void 0 : (_options$locale2 = options.locale) === null || _options$locale2 === void 0 ? void 0 : (_options$locale2$opti = _options$locale2.options) === null || _options$locale2$opti === void 0 ? void 0 : _options$locale2$opti.firstWeekContainsDate) !== null && _ref4 !== void 0 ? _ref4 : defaultOptions.firstWeekContainsDate) !== null && _ref3 !== void 0 ? _ref3 : (_defaultOptions$local = defaultOptions.locale) === null || _defaultOptions$local === void 0 ? void 0 : (_defaultOptions$local2 = _defaultOptions$local.options) === null || _defaultOptions$local2 === void 0 ? void 0 : _defaultOptions$local2.firstWeekContainsDate) !== null && _ref2 !== void 0 ? _ref2 : 1); // Test if weekStartsOn is between 1 and 7 _and_ is not NaN

  if (!(firstWeekContainsDate >= 1 && firstWeekContainsDate <= 7)) {
    throw new RangeError('firstWeekContainsDate must be between 1 and 7 inclusively');
  }

  var weekStartsOn = toInteger((_ref5 = (_ref6 = (_ref7 = (_options$weekStartsOn = options === null || options === void 0 ? void 0 : options.weekStartsOn) !== null && _options$weekStartsOn !== void 0 ? _options$weekStartsOn : options === null || options === void 0 ? void 0 : (_options$locale3 = options.locale) === null || _options$locale3 === void 0 ? void 0 : (_options$locale3$opti = _options$locale3.options) === null || _options$locale3$opti === void 0 ? void 0 : _options$locale3$opti.weekStartsOn) !== null && _ref7 !== void 0 ? _ref7 : defaultOptions.weekStartsOn) !== null && _ref6 !== void 0 ? _ref6 : (_defaultOptions$local3 = defaultOptions.locale) === null || _defaultOptions$local3 === void 0 ? void 0 : (_defaultOptions$local4 = _defaultOptions$local3.options) === null || _defaultOptions$local4 === void 0 ? void 0 : _defaultOptions$local4.weekStartsOn) !== null && _ref5 !== void 0 ? _ref5 : 0); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN

  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {
    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');
  }

  if (!locale.localize) {
    throw new RangeError('locale must contain localize property');
  }

  if (!locale.formatLong) {
    throw new RangeError('locale must contain formatLong property');
  }

  var originalDate = toDate(dirtyDate);

  if (!isValid(originalDate)) {
    throw new RangeError('Invalid time value');
  } // Convert the date in system timezone to the same date in UTC+00:00 timezone.
  // This ensures that when UTC functions will be implemented, locales will be compatible with them.
  // See an issue about UTC functions: https://github.com/date-fns/date-fns/issues/376


  var timezoneOffset = getTimezoneOffsetInMilliseconds(originalDate);
  var utcDate = subMilliseconds(originalDate, timezoneOffset);
  var formatterOptions = {
    firstWeekContainsDate: firstWeekContainsDate,
    weekStartsOn: weekStartsOn,
    locale: locale,
    _originalDate: originalDate
  };
  var result = formatStr.match(longFormattingTokensRegExp).map(function (substring) {
    var firstCharacter = substring[0];

    if (firstCharacter === 'p' || firstCharacter === 'P') {
      var longFormatter = longFormatters$1[firstCharacter];
      return longFormatter(substring, locale.formatLong);
    }

    return substring;
  }).join('').match(formattingTokensRegExp).map(function (substring) {
    // Replace two single quote characters with one single quote character
    if (substring === "''") {
      return "'";
    }

    var firstCharacter = substring[0];

    if (firstCharacter === "'") {
      return cleanEscapedString(substring);
    }

    var formatter = formatters$1[firstCharacter];

    if (formatter) {
      if (!(options !== null && options !== void 0 && options.useAdditionalWeekYearTokens) && isProtectedWeekYearToken(substring)) {
        throwProtectedError(substring, dirtyFormatStr, String(dirtyDate));
      }

      if (!(options !== null && options !== void 0 && options.useAdditionalDayOfYearTokens) && isProtectedDayOfYearToken(substring)) {
        throwProtectedError(substring, dirtyFormatStr, String(dirtyDate));
      }

      return formatter(utcDate, substring, locale.localize, formatterOptions);
    }

    if (firstCharacter.match(unescapedLatinCharacterRegExp)) {
      throw new RangeError('Format string contains an unescaped latin alphabet character `' + firstCharacter + '`');
    }

    return substring;
  }).join('');
  return result;
}

function cleanEscapedString(input) {
  var matched = input.match(escapedStringRegExp);

  if (!matched) {
    return input;
  }

  return matched[1].replace(doubleQuoteRegExp, "'");
}

({
  appId: propTypes.exports.string.isRequired,
  userId: propTypes.exports.string.isRequired,
  accessToken: propTypes.exports.string,
  customApiHost: propTypes.exports.string,
  customWebSocketHost: propTypes.exports.string,
  theme: propTypes.exports.string,
  userListQuery: propTypes.exports.func,
  nickname: propTypes.exports.string,
  profileUrl: propTypes.exports.string,
  breakpoint: propTypes.exports.oneOf([propTypes.exports.string, propTypes.exports.bool]),
  allowProfileEdit: propTypes.exports.bool,
  disableUserProfile: propTypes.exports.bool,
  disableMarkAsDelivered: propTypes.exports.bool,
  renderUserProfile: propTypes.exports.func,
  onProfileEditSuccess: propTypes.exports.func,
  dateLocale: propTypes.exports.shape({}),
  config: propTypes.exports.shape({
    // None Error Warning Info 'All/Debug'
    logLevel: propTypes.exports.oneOfType([propTypes.exports.string, propTypes.exports.arrayOf(propTypes.exports.string)]),
    isREMUnitEnabled: propTypes.exports.bool
  }),
  uikitOptions: propTypes.exports.shape({}),
  isReactionEnabled: propTypes.exports.bool,
  replyType: propTypes.exports.oneOf(['NONE', 'QUOTE_REPLY', 'THREAD']),
  showSearchIcon: propTypes.exports.bool,
  isMessageGroupingEnabled: propTypes.exports.bool,
  stringSet: propTypes.exports.objectOf(propTypes.exports.string),
  colorSet: propTypes.exports.objectOf(propTypes.exports.string),
  imageCompression: propTypes.exports.shape({
    compressionRate: propTypes.exports.number,
    resizingWidth: propTypes.exports.oneOfType([propTypes.exports.number, propTypes.exports.string]),
    resizingHeight: propTypes.exports.oneOfType([propTypes.exports.number, propTypes.exports.string])
  }),
  disableAutoSelect: propTypes.exports.bool,
  isMentionEnabled: propTypes.exports.bool,
  isVoiceMessageEnabled: propTypes.exports.bool,
  voiceRecord: propTypes.exports.shape({
    maxRecordingTime: propTypes.exports.number,
    minRecordingTime: propTypes.exports.number
  }),
  isTypingIndicatorEnabledOnChannelList: propTypes.exports.bool,
  isMessageReceiptStatusEnabledOnChannelList: propTypes.exports.bool,
  isUserIdUsedForNickname: propTypes.exports.bool,
  sdkInitParams: propTypes.exports.shape({}),
  customExtensionParams: propTypes.exports.shape({})
});

const getMessageCreatedAt = message => format$1(message.createdAt, 'p');

const shouldFetchMore = (messageLength, maxMessages) => {
  if (typeof maxMessages !== 'number') {
    return true;
  }

  if (typeof maxMessages === 'number' && maxMessages > messageLength) {
    return true;
  }

  return false;
};
/* eslint-disable default-param-last */


const scrollIntoLast = function () {
  let initialTry = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
  let scrollRef = arguments.length > 1 ? arguments[1] : undefined;
  const MAX_TRIES = 10;
  const currentTry = initialTry;

  if (currentTry > MAX_TRIES) {
    return;
  }

  try {
    const scrollDOM = (scrollRef === null || scrollRef === void 0 ? void 0 : scrollRef.current) || document.querySelector('.sendbird-openchannel-conversation-scroll__container__item-container'); // eslint-disable-next-line no-multi-assign

    scrollDOM.scrollTop = scrollDOM.scrollHeight;
  } catch (error) {
    setTimeout(() => {
      scrollIntoLast(currentTry + 1, scrollRef);
    }, 500 * currentTry);
  }
};

const isSameGroup = (message, comparingMessage) => {
  var _sender, _sender2, _message_$sender, _comparingMessage_$se;

  if (!(message && comparingMessage && message !== null && message !== void 0 && message.messageType && message.messageType !== 'admin' && comparingMessage !== null && comparingMessage !== void 0 && comparingMessage.messageType && comparingMessage.messageType !== 'admin' && message !== null && message !== void 0 && message.sender && comparingMessage !== null && comparingMessage !== void 0 && comparingMessage.sender && message !== null && message !== void 0 && message.createdAt && comparingMessage !== null && comparingMessage !== void 0 && comparingMessage.createdAt && message !== null && message !== void 0 && (_sender = message.sender) !== null && _sender !== void 0 && _sender.userId && comparingMessage !== null && comparingMessage !== void 0 && (_sender2 = comparingMessage.sender) !== null && _sender2 !== void 0 && _sender2.userId)) {
    return false;
  } // to fix typecasting


  const message_ = message;
  const comparingMessage_ = comparingMessage;
  return (message_ === null || message_ === void 0 ? void 0 : message_.sendingStatus) === (comparingMessage_ === null || comparingMessage_ === void 0 ? void 0 : comparingMessage_.sendingStatus) && (message_ === null || message_ === void 0 ? void 0 : (_message_$sender = message_.sender) === null || _message_$sender === void 0 ? void 0 : _message_$sender.userId) === (comparingMessage_ === null || comparingMessage_ === void 0 ? void 0 : (_comparingMessage_$se = comparingMessage_.sender) === null || _comparingMessage_$se === void 0 ? void 0 : _comparingMessage_$se.userId) && getMessageCreatedAt(message) === getMessageCreatedAt(comparingMessage);
};

const compareMessagesForGrouping = (prevMessage, currMessage, nextMessage) => [isSameGroup(prevMessage, currMessage), isSameGroup(currMessage, nextMessage)];

const kFormatter = num => {
  if (Math.abs(num) > 999999) {
    return `${(Math.abs(num) / 1000000).toFixed(1)}M`;
  }

  if (Math.abs(num) > 999) {
    return `${(Math.abs(num) / 1000).toFixed(1)}K`;
  }

  return `${num}`;
};

const isOperator = (openChannel, userId) => {
  const operators = openChannel === null || openChannel === void 0 ? void 0 : openChannel.operators;

  if (operators.map(operator => operator.userId).indexOf(userId) < 0) {
    return false;
  }

  return true;
};

const isDisabledBecauseFrozen = (openChannel, userId) => {
  const isFrozen = openChannel === null || openChannel === void 0 ? void 0 : openChannel.isFrozen;
  return isFrozen && !isOperator(openChannel, userId);
};

const isDisabledBecauseMuted = (mutedParticipantIds, userId) => {
  return mutedParticipantIds.indexOf(userId) > -1;
};

const fetchWithListQuery = (listQuery, logger, eachQueryNextCallback) => {
  const fetchList = query => {
    const {
      hasNext
    } = query;

    if (hasNext) {
      query.next().then(users => {
        eachQueryNextCallback(users);
        fetchList(query);
      }).catch(error => {
        logger.warning('OpenChannel | FetchUserList failed', error);
      });
    } else {
      logger.info('OpenChannel | FetchUserList finished');
    }
  };

  logger.info('OpenChannel | FetchUserList start', listQuery);
  fetchList(listQuery);
};

const pxToNumber = px => {
  if (typeof px === 'number') {
    return px;
  }

  if (typeof px === 'string') {
    const parsed = Number.parseFloat(px);

    if (!Number.isNaN(parsed)) {
      return parsed;
    }
  }

  return null;
};

const SET_CURRENT_CHANNEL = 'SET_CURRENT_CHANNEL';
const SET_CHANNEL_INVALID = 'SET_CHANNEL_INVALID';
const RESET_MESSAGES = 'RESET_MESSAGES';
const EXIT_CURRENT_CHANNEL = 'EXIT_CURRENT_CHANNEL';
const GET_PREV_MESSAGES_START = 'GET_PREV_MESSAGES_START';
const GET_PREV_MESSAGES_SUCESS = 'GET_PREV_MESSAGES_SUCESS';
const GET_PREV_MESSAGES_FAIL = 'GET_PREV_MESSAGES_FAIL';
const SENDING_MESSAGE_FAILED = 'SENDING_MESSAGE_FAILED';
const SENDING_MESSAGE_SUCCEEDED = 'SENDING_MESSAGE_SUCCEEDED';
const SENDING_MESSAGE_START = 'SENDING_MESSAGE_START';
const RESENDING_MESSAGE_START = 'RESENDING_MESSAGE_START';
const FETCH_PARTICIPANT_LIST = 'FETCH_PARTICIPANT_LIST';
const FETCH_BANNED_USER_LIST = 'FETCH_BANNED_USER_LIST';
const FETCH_MUTED_USER_LIST = 'FETCH_MUTED_USER_LIST';
const TRIM_MESSAGE_LIST = 'TRIM_MESSAGE_LIST'; // event handlers

const ON_MESSAGE_RECEIVED = 'ON_MESSAGE_RECEIVED';
const ON_MESSAGE_UPDATED = 'ON_MESSAGE_UPDATED';
const ON_MESSAGE_DELETED = 'ON_MESSAGE_DELETED';
const ON_MESSAGE_DELETED_BY_REQ_ID = 'ON_MESSAGE_DELETED_BY_REQ_ID';
const ON_OPERATOR_UPDATED = 'ON_OPERATOR_UPDATED';
const ON_USER_ENTERED = 'ON_USER_ENTERED';
const ON_USER_EXITED = 'ON_USER_EXITED';
const ON_USER_MUTED = 'ON_USER_MUTED';
const ON_USER_UNMUTED = 'ON_USER_UNMUTED';
const ON_USER_BANNED = 'ON_USER_BANNED';
const ON_USER_UNBANNED = 'ON_USER_UNBANNED';
const ON_CHANNEL_FROZEN = 'ON_CHANNEL_FROZEN';
const ON_CHANNEL_UNFROZEN = 'ON_CHANNEL_UNFROZEN';
const ON_CHANNEL_CHANGED = 'ON_CHANNEL_CHANGED';
const ON_CHANNEL_DELETED = 'ON_CHANNEL_DELETED';
const ON_META_DATA_CREATED = 'ON_META_DATA_CREATED';
const ON_META_DATA_UPDATED = 'ON_META_DATA_UPDATED';
const ON_META_DATA_DELETED = 'ON_META_DATA_DELETED';
const ON_META_COUNTERS_CREATED = 'ON_META_COUNTERS_CREATED';
const ON_META_COUNTERS_UPDATED = 'ON_META_COUNTERS_UPDATED';
const ON_META_COUNTERS_DELETED = 'ON_META_COUNTERS_DELETED';
const ON_MENTION_RECEIVED = 'ON_MENTION_RECEIVED';
/* eslint-disable  @typescript-eslint/no-explicit-any */
// @ts-ignore: Unreachable code error

function reducer(state, action) {
  switch (action.type) {
    case RESET_MESSAGES:
      {
        return _objectSpread2(_objectSpread2({}, state), {}, {
          allMessages: []
        });
      }

    case EXIT_CURRENT_CHANNEL:
      {
        var _action$payload, _state$currentOpenCha;

        if (((_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.url) === ((_state$currentOpenCha = state.currentOpenChannel) === null || _state$currentOpenCha === void 0 ? void 0 : _state$currentOpenCha.url)) {
          return _objectSpread2(_objectSpread2({}, state), {}, {
            currentOpenChannel: null
          });
        }

        return state;
      }

    case SET_CURRENT_CHANNEL:
      {
        const gottenChannel = action.payload;
        const operators = gottenChannel.operators;

        if (!state.isInvalid && state.currentOpenChannel && state.currentOpenChannel.url && state.currentOpenChannel.url === gottenChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          currentOpenChannel: gottenChannel,
          isInvalid: false,
          operators: operators,
          participants: operators,
          bannedParticipantIds: [],
          mutedParticipantIds: []
        });
      }

    case SET_CHANNEL_INVALID:
      {
        return _objectSpread2(_objectSpread2({}, state), {}, {
          isInvalid: true
        });
      }

    case GET_PREV_MESSAGES_START:
      {
        return _objectSpread2(_objectSpread2({}, state), {}, {
          loading: true
        });
      }

    case GET_PREV_MESSAGES_SUCESS:
    case GET_PREV_MESSAGES_FAIL:
      {
        const isFailed = action.type === GET_PREV_MESSAGES_FAIL;
        const {
          currentOpenChannel = {},
          messages = [],
          hasMore,
          lastMessageTimestamp
        } = action.payload;
        const actionChannelUrl = currentOpenChannel.url;
        const receivedMessages = isFailed ? [] : messages;

        const _hasMore = isFailed ? false : hasMore;

        const _lastMessageTimestamp = isFailed ? 0 : lastMessageTimestamp;

        const stateChannel = state.currentOpenChannel;
        const stateChannelUrl = stateChannel.url;

        if (actionChannelUrl !== stateChannelUrl) {
          return state;
        }

        const filteredAllMessages = state.allMessages.filter(message => !receivedMessages.find(_ref => {
          let {
            messageId
          } = _ref;
          return compareIds(messageId, message.messageId);
        }));
        return _objectSpread2(_objectSpread2({}, state), {}, {
          loading: false,
          initialized: true,
          hasMore: _hasMore,
          lastMessageTimestamp: _lastMessageTimestamp,
          allMessages: [...receivedMessages, ...filteredAllMessages]
        });
      }

    case SENDING_MESSAGE_START:
      {
        const {
          message,
          channel
        } = action.payload;

        if ((channel === null || channel === void 0 ? void 0 : channel.url) !== state.currentOpenChannel.url || state.allMessages.some(m => m.reqId === message.reqId) // Handing failed first than sending start issue
        ) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          allMessages: [...state.allMessages, message]
        });
      }

    case SENDING_MESSAGE_SUCCEEDED:
      {
        const sentMessage = action.payload;
        const newMessages = state.allMessages.map(m => compareIds(m.reqId, sentMessage.reqId) ? sentMessage : m);
        return _objectSpread2(_objectSpread2({}, state), {}, {
          allMessages: newMessages
        });
      }

    case SENDING_MESSAGE_FAILED:
      {
        const sentMessage = action.payload;
        sentMessage.sendingStatus = 'failed';

        if (!state.allMessages.some(m => (m === null || m === void 0 ? void 0 : m.reqId) === (sentMessage === null || sentMessage === void 0 ? void 0 : sentMessage.reqId))) {
          // Handling failed first than sending start issue
          return _objectSpread2(_objectSpread2({}, state), {}, {
            allMessages: [...state.allMessages.filter(m => !compareIds(m.reqId, sentMessage)), sentMessage]
          });
        } else {
          return _objectSpread2(_objectSpread2({}, state), {}, {
            allMessages: state.allMessages.map(m => compareIds(m.reqId, sentMessage.reqId) ? sentMessage : m)
          });
        }
      }

    case TRIM_MESSAGE_LIST:
      {
        var _action$payload2;

        const {
          allMessages
        } = state;
        const messageLimit = (_action$payload2 = action.payload) === null || _action$payload2 === void 0 ? void 0 : _action$payload2.messageLimit;

        if (messageLimit && messageLimit > 0 && (allMessages === null || allMessages === void 0 ? void 0 : allMessages.length) > messageLimit) {
          const sliceAt = allMessages.length - messageLimit;
          return _objectSpread2(_objectSpread2({}, state), {}, {
            allMessages: allMessages.slice(sliceAt)
          });
        }

        return state;
      }

    case RESENDING_MESSAGE_START:
      {
        const eventedChannel = action.payload.channel;
        const resentMessage = action.payload.message;

        if (eventedChannel.url !== state.currentOpenChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          allMessages: state.allMessages.map(m => compareIds(m.reqId, resentMessage.reqId) ? resentMessage : m)
        });
      }

    case FETCH_PARTICIPANT_LIST:
      {
        const eventedChannel = action.payload.channel;
        const fetchedParticipantList = action.payload.users;

        if (eventedChannel.url !== state.currentOpenChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          participants: [...state.participants, ...fetchedParticipantList] // Should check duplication

        });
      }

    case FETCH_BANNED_USER_LIST:
      {
        const eventedChannel = action.payload.channel;
        const fetchedBannedUserList = action.payload.users;

        if (eventedChannel.url !== state.currentOpenChannel.url || !fetchedBannedUserList.every(user => typeof user.userId === 'string')) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          bannedParticipantIds: [...state.bannedParticipantIds, ...fetchedBannedUserList.map(user => user.userId)] // Should check duplication

        });
      }

    case FETCH_MUTED_USER_LIST:
      {
        const eventedChannel = action.payload.channel;
        const fetchedMutedUserList = action.payload.users;

        if (eventedChannel.url !== state.currentOpenChannel.url || !fetchedMutedUserList.every(user => typeof user.userId === 'string')) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          mutedParticipantIds: [...state.mutedParticipantIds, ...fetchedMutedUserList.map(user => user.userId)] // Should check duplication

        });
      }
    // events

    case ON_MESSAGE_RECEIVED:
      {
        const eventedChannel = action.payload.channel;
        const receivedMessage = action.payload.message;
        const {
          currentOpenChannel
        } = state;

        if (!compareIds(eventedChannel.url, currentOpenChannel.url) || !(state.allMessages.map(message => message.messageId).indexOf(receivedMessage.messageId) < 0)) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          allMessages: [...state.allMessages, receivedMessage]
        });
      }

    case ON_MESSAGE_UPDATED:
      {
        const eventedChannel = action.payload.channel;
        const updatedMessage = action.payload.message;
        const currentChannel = state.currentOpenChannel;

        if (!currentChannel || currentChannel.url && currentChannel.url !== eventedChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          allMessages: state.allMessages.map(message => message.isIdentical(updatedMessage) ? updatedMessage : message)
        });
      }

    case ON_MESSAGE_DELETED:
      {
        const eventedChannel = action.payload.channel;
        const deletedMessageId = action.payload.messageId;
        const currentChannel = state.currentOpenChannel;

        if (!currentChannel || currentChannel.url && currentChannel.url !== eventedChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          allMessages: state.allMessages.filter(message => !compareIds(message.messageId, deletedMessageId))
        });
      }

    case ON_MESSAGE_DELETED_BY_REQ_ID:
      {
        return _objectSpread2(_objectSpread2({}, state), {}, {
          allMessages: state.allMessages.filter(m => !compareIds(m.reqId, action.payload))
        });
      }

    case ON_OPERATOR_UPDATED:
      {
        const eventedChannel = action.payload.channel;
        const updatedOperators = action.payload.operators;
        const currentChannel = state.currentOpenChannel;

        if (!currentChannel || currentChannel.url && currentChannel.url !== eventedChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          currentOpenChannel: eventedChannel,
          operators: updatedOperators
        });
      }

    case ON_USER_ENTERED:
      {
        const eventedChannel = action.payload.channel;
        const enteredUser = action.payload.user;
        const currentChannel = state.currentOpenChannel;

        if (!currentChannel || currentChannel.url && currentChannel.url !== eventedChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          participants: [...state.participants, enteredUser]
        });
      }

    case ON_USER_EXITED:
      {
        const eventedChannel = action.payload.channel;
        const exitedUser = action.payload.user;
        const currentChannel = state.currentOpenChannel;

        if (!currentChannel || currentChannel.url && currentChannel.url !== eventedChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          participants: state.participants.filter(participant => !compareIds(participant.userId, exitedUser.userId))
        });
      }

    case ON_USER_MUTED:
      {
        const eventedChannel = action.payload.channel;
        const mutedUser = action.payload.user;
        const currentChannel = state.currentOpenChannel;

        if (!currentChannel || currentChannel.url && currentChannel.url !== eventedChannel.url || state.mutedParticipantIds.indexOf(mutedUser.userId) >= 0) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          mutedParticipantIds: [...state.mutedParticipantIds, mutedUser.userId]
        });
      }

    case ON_USER_UNMUTED:
      {
        const eventedChannel = action.payload.channel;
        const unmutedUser = action.payload.user;
        const currentChannel = state.currentOpenChannel;

        if (!currentChannel || currentChannel.url && currentChannel.url !== eventedChannel.url || state.mutedParticipantIds.indexOf(unmutedUser.userId) < 0) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          mutedParticipantIds: state.mutedParticipantIds.filter(userId => userId !== unmutedUser.userId)
        });
      }

    case ON_USER_BANNED:
      {
        const eventedChannel = action.payload.channel;
        const bannedUser = action.payload.user;
        const currentUser = action.payload.currentUser;
        const currentChannel = state.currentOpenChannel;

        if ((currentChannel === null || currentChannel === void 0 ? void 0 : currentChannel.url) === (eventedChannel === null || eventedChannel === void 0 ? void 0 : eventedChannel.url) && (bannedUser === null || bannedUser === void 0 ? void 0 : bannedUser.userId) === (currentUser === null || currentUser === void 0 ? void 0 : currentUser.userId)) {
          return _objectSpread2(_objectSpread2({}, state), {}, {
            currentOpenChannel: null
          });
        } else if ((currentChannel === null || currentChannel === void 0 ? void 0 : currentChannel.url) === (eventedChannel === null || eventedChannel === void 0 ? void 0 : eventedChannel.url)) {
          return _objectSpread2(_objectSpread2({}, state), {}, {
            bannedParticipantIds: [...state.bannedParticipantIds, bannedUser.userId]
          });
        }

        return state;
      }

    case ON_USER_UNBANNED:
      {
        const eventedChannel = action.payload.channel;
        const unbannedUser = action.payload.user;
        const currentChannel = state.currentOpenChannel;

        if ((currentChannel === null || currentChannel === void 0 ? void 0 : currentChannel.url) === (eventedChannel === null || eventedChannel === void 0 ? void 0 : eventedChannel.url)) {
          return _objectSpread2(_objectSpread2({}, state), {}, {
            bannedParticipantIds: state.bannedParticipantIds.filter(userId => userId !== unbannedUser.userId)
          });
        }

        return state;
      }

    case ON_CHANNEL_FROZEN:
      {
        const frozenChannel = action.payload;
        const currentChannel = state.currentOpenChannel;

        if (!currentChannel || currentChannel.url && currentChannel.url !== frozenChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          frozen: true
        });
      }

    case ON_CHANNEL_UNFROZEN:
      {
        const unfrozenChannel = action.payload;
        const currentChannel = state.currentOpenChannel;

        if (!currentChannel || currentChannel.url && currentChannel.url !== unfrozenChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          frozen: false
        });
      }

    case ON_CHANNEL_CHANGED:
      {
        const changedChannel = action.payload;
        const currentChannel = state.currentOpenChannel;

        if (!currentChannel || currentChannel.url && currentChannel.url !== changedChannel.url) {
          return state;
        }

        return _objectSpread2(_objectSpread2({}, state), {}, {
          currentOpenChannel: changedChannel
        });
      }

    case ON_CHANNEL_DELETED:
      {
        const deletedChannelUrl = action.payload;
        const currentChannel = state === null || state === void 0 ? void 0 : state.currentOpenChannel;

        if ((currentChannel === null || currentChannel === void 0 ? void 0 : currentChannel.url) === deletedChannelUrl) {
          return _objectSpread2(_objectSpread2({}, state), {}, {
            currentOpenChannel: null
          });
        }

        return state;
      }

    case ON_META_DATA_CREATED:
      {
        // const eventedChannel = action.payload.channel;
        // const createdMetaData = action.payload.metaData;
        // return {
        //   ...state
        // };
        return state;
      }

    case ON_META_DATA_UPDATED:
      {
        // const eventedChannel = action.payload.channel;
        // const updatedMetaData = action.payload.metaData;
        // return {
        //   ...state
        // };
        return state;
      }

    case ON_META_DATA_DELETED:
      {
        // const eventedChannel = action.payload.channel;
        // const deletedMetaDataKeys = action.payload.metaDataKeys;
        // return {
        //   ...state
        // };
        return state;
      }

    case ON_META_COUNTERS_CREATED:
      {
        // const eventedChannel = action.payload.channel;
        // const createdMetaCounter = action.payload.metaCounter;
        // return {
        //   ...state
        // };
        return state;
      }

    case ON_META_COUNTERS_UPDATED:
      {
        // const eventedChannel = action.payload.channel;
        // const updatedMetaCounter = action.payload.metaCounter;
        // return {
        //   ...state
        // };
        return state;
      }

    case ON_META_COUNTERS_DELETED:
      {
        // const eventedChannel = action.payload.channel;
        // const deletedMetaCounterKeys = action.payload.metaCounterKeys;
        // return {
        //   ...state
        // };
        return state;
      }

    case ON_MENTION_RECEIVED:
      {
        // const eventedChannel = action.payload.channel;
        // const mentionedMessage = action.payload.message;
        // return {
        //   ...state
        // };
        return state;
      }

    default:
      return state;
  }
}

const initialState = {
  allMessages: [],
  loading: false,
  initialized: false,
  currentOpenChannel: null,
  isInvalid: false,
  hasMore: false,
  lastMessageTimestamp: 0,
  frozen: false,
  operators: [],
  participants: [],
  bannedParticipantIds: [],
  mutedParticipantIds: []
};

function useSetChannel(_ref, _ref2) {
  let {
    channelUrl,
    sdkInit,
    fetchingParticipants,
    userId,
    currentOpenChannel
  } = _ref;
  let {
    sdk,
    logger,
    messagesDispatcher
  } = _ref2;
  useEffect(() => {
    if (channelUrl && sdkInit && sdk !== null && sdk !== void 0 && sdk.openChannel) {
      if (currentOpenChannel && currentOpenChannel !== null && currentOpenChannel !== void 0 && currentOpenChannel.exit) {
        var _currentOpenChannel$e;

        (_currentOpenChannel$e = currentOpenChannel.exit) === null || _currentOpenChannel$e === void 0 ? void 0 : _currentOpenChannel$e.call(currentOpenChannel).then(() => {
          logger.info('OpenChannel | useSetChannel: Exit from the previous open channel', currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.url);
          messagesDispatcher({
            type: EXIT_CURRENT_CHANNEL,
            payload: currentOpenChannel
          });
        });
      }

      logger.info('OpenChannel | useSetChannel: Fetching channel', channelUrl);
      sdk.openChannel.getChannel(channelUrl).then(openChannel => {
        logger.info('OpenChannel | useSetChannel: Succeeded to fetch channel', openChannel);
        messagesDispatcher({
          type: SET_CURRENT_CHANNEL,
          payload: openChannel
        });
        openChannel.enter().then(() => {
          if (openChannel.isOperator(userId)) {
            // only operator has a permission to fetch these list
            const bannedParticipantListQuery = openChannel.createBannedUserListQuery();
            const mutedParticipantListQuery = openChannel.createMutedUserListQuery();
            fetchWithListQuery(bannedParticipantListQuery, logger, users => {
              messagesDispatcher({
                type: FETCH_BANNED_USER_LIST,
                payload: {
                  channel: openChannel,
                  users
                }
              });
            });
            fetchWithListQuery(mutedParticipantListQuery, logger, users => {
              messagesDispatcher({
                type: FETCH_MUTED_USER_LIST,
                payload: {
                  channel: openChannel,
                  users
                }
              });
            });
          } else {
            openChannel.getMyMutedInfo().then(mutedInfo => {
              if (mutedInfo !== null && mutedInfo !== void 0 && mutedInfo.isMuted) {
                messagesDispatcher({
                  type: FETCH_MUTED_USER_LIST,
                  payload: {
                    channel: openChannel,
                    users: [sdk === null || sdk === void 0 ? void 0 : sdk.currentUser]
                  }
                });
              }
            });
          }

          if (fetchingParticipants) {
            // fetch participants list
            const participantListQuery = openChannel.createParticipantListQuery({
              limit: openChannel.participantCount
            });
            fetchWithListQuery(participantListQuery, logger, users => {
              messagesDispatcher({
                type: FETCH_PARTICIPANT_LIST,
                payload: {
                  channel: openChannel,
                  users
                }
              });
            });
          }
        }).catch(error => {
          logger.warning('OpenChannel | useSetChannel: Failed to enter channel', {
            channelUrl,
            error
          });
          messagesDispatcher({
            type: SET_CHANNEL_INVALID,
            payload: null
          });
        });
      }).catch(error => {
        logger.warning('OpenChannel | useSetChannel: Failed to fetch channel', {
          channelUrl,
          error
        });
        messagesDispatcher({
          type: SET_CHANNEL_INVALID,
          payload: null
        });
      });
    }
  }, [channelUrl, sdkInit, fetchingParticipants]);
}

function useHandleChannelEvents(_ref, _ref2) {
  let {
    currentOpenChannel,
    checkScrollBottom
  } = _ref;
  let {
    sdk,
    logger,
    messagesDispatcher,
    scrollRef
  } = _ref2;
  useEffect(() => {
    var _sdk$openChannel;

    const messageReceiverId = uuidv4();

    if (currentOpenChannel && currentOpenChannel.url && sdk !== null && sdk !== void 0 && (_sdk$openChannel = sdk.openChannel) !== null && _sdk$openChannel !== void 0 && _sdk$openChannel.addOpenChannelHandler) {
      var _sdk$openChannel2;

      logger.info('OpenChannel | useHandleChannelEvents: Setup evnet handler', messageReceiverId);
      const channelHandlerParams = {
        onMessageReceived: (channel, message) => {
          const scrollToEnd = checkScrollBottom();
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onMessageReceived', {
            channelUrl,
            message
          });
          messagesDispatcher({
            type: ON_MESSAGE_RECEIVED,
            payload: {
              channel,
              message
            }
          });

          if (scrollToEnd) {
            try {
              setTimeout(() => {
                scrollIntoLast(0, scrollRef);
              });
            } catch (error) {
              logger.warning('OpenChannel | onMessageReceived | scroll to end failed');
            }
          }
        },
        onMessageUpdated: (channel, message) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onMessageUpdated', {
            channelUrl,
            message
          });
          messagesDispatcher({
            type: ON_MESSAGE_UPDATED,
            payload: {
              channel,
              message
            }
          });
        },
        onMessageDeleted: (channel, messageId) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onMessageDeleted', {
            channelUrl,
            messageId
          });
          messagesDispatcher({
            type: ON_MESSAGE_DELETED,
            payload: {
              channel,
              messageId
            }
          });
        },
        onOperatorUpdated: (channel, operators) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onOperatorUpdated', {
            channelUrl,
            operators
          });
          messagesDispatcher({
            type: ON_OPERATOR_UPDATED,
            payload: {
              channel,
              operators
            }
          });
        },
        onUserEntered: (channel, user) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onUserEntered', {
            channelUrl,
            user
          });
          messagesDispatcher({
            type: ON_USER_ENTERED,
            payload: {
              channel,
              user
            }
          });
        },
        onUserExited: (channel, user) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onUserExited', {
            channelUrl,
            user
          });
          messagesDispatcher({
            type: ON_USER_EXITED,
            payload: {
              channel,
              user
            }
          });
        },
        onUserMuted: (channel, user) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onUserMuted', {
            channelUrl,
            user
          });
          messagesDispatcher({
            type: ON_USER_MUTED,
            payload: {
              channel,
              user
            }
          });
        },
        onUserUnmuted: (channel, user) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onUserUnmuted', {
            channelUrl,
            user
          });
          messagesDispatcher({
            type: ON_USER_UNMUTED,
            payload: {
              channel,
              user
            }
          });
        },
        onUserBanned: (channel, user) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onUserBanned', {
            channelUrl,
            user
          });
          messagesDispatcher({
            type: ON_USER_BANNED,
            payload: {
              channel,
              user,
              currentUser: sdk === null || sdk === void 0 ? void 0 : sdk.currentUser
            }
          });
        },
        onUserUnbanned: (channel, user) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onUserUnbanned', {
            channelUrl,
            user
          });
          messagesDispatcher({
            type: ON_USER_UNBANNED,
            payload: {
              channel,
              user
            }
          });
        },
        onChannelFrozen: channel => {
          logger.info('OpenChannel | useHandleChannelEvents: onChannelFrozen', channel);
          messagesDispatcher({
            type: ON_CHANNEL_FROZEN,
            payload: channel
          });
        },
        onChannelUnfrozen: channel => {
          logger.info('OpenChannel | useHandleChannelEvents: onChannelUnfrozen', channel);
          messagesDispatcher({
            type: ON_CHANNEL_UNFROZEN,
            payload: channel
          });
        },
        onChannelChanged: channel => {
          logger.info('OpenChannel | useHandleChannelEvents: onChannelChanged', channel);
          messagesDispatcher({
            type: ON_CHANNEL_CHANGED,
            payload: channel
          });
        },
        onMetaDataCreated: (channel, metaData) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onMetaDataCreated', {
            channelUrl,
            metaData
          });
          messagesDispatcher({
            type: ON_META_DATA_CREATED,
            payload: {
              channel,
              metaData
            }
          });
        },
        onMetaDataUpdated: (channel, metaData) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onMetaDataUpdated', {
            channelUrl,
            metaData
          });
          messagesDispatcher({
            type: ON_META_DATA_UPDATED,
            payload: {
              channel,
              metaData
            }
          });
        },
        onMetaDataDeleted: (channel, metaDataKeys) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onMetaDataDeleted', {
            channelUrl,
            metaDataKeys
          });
          messagesDispatcher({
            type: ON_META_DATA_DELETED,
            payload: {
              channel,
              metaDataKeys
            }
          });
        },
        onMetaCounterCreated: (channel, metaCounter) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onMetaCountersCreated', {
            channelUrl,
            metaCounter
          });
          messagesDispatcher({
            type: ON_META_COUNTERS_CREATED,
            payload: {
              channel,
              metaCounter
            }
          });
        },
        onMetaCounterUpdated: (channel, metaCounter) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onMetaCountersUpdated', {
            channelUrl,
            metaCounter
          });
          messagesDispatcher({
            type: ON_META_COUNTERS_UPDATED,
            payload: {
              channel,
              metaCounter
            }
          });
        },
        onMetaCounterDeleted: (channel, metaCounterKeys) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onMetaCountersDeleted', {
            channelUrl,
            metaCounterKeys
          });
          messagesDispatcher({
            type: ON_META_COUNTERS_DELETED,
            payload: {
              channel,
              metaCounterKeys
            }
          });
        },
        onMentionReceived: (channel, message) => {
          const channelUrl = channel === null || channel === void 0 ? void 0 : channel.url;
          logger.info('OpenChannel | useHandleChannelEvents: onMentionReceived', {
            channelUrl,
            message
          });
          messagesDispatcher({
            type: ON_MENTION_RECEIVED,
            payload: {
              channel,
              message
            }
          });
        },
        onChannelDeleted: (channelUrl, channelType) => {
          if (channelType === x.OPEN && (currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.url) === channelUrl) {
            messagesDispatcher({
              type: ON_CHANNEL_DELETED,
              payload: channelUrl
            });
          }
        }
      };
      const ChannelHandler = new De$1(channelHandlerParams);
      sdk === null || sdk === void 0 ? void 0 : (_sdk$openChannel2 = sdk.openChannel) === null || _sdk$openChannel2 === void 0 ? void 0 : _sdk$openChannel2.addOpenChannelHandler(messageReceiverId, ChannelHandler);
    }

    return () => {
      var _sdk$openChannel3;

      if (sdk !== null && sdk !== void 0 && (_sdk$openChannel3 = sdk.openChannel) !== null && _sdk$openChannel3 !== void 0 && _sdk$openChannel3.removeOpenChannelHandler) {
        logger.info('OpenChannel | useHandleChannelEvents: Removing message receiver handler', messageReceiverId);
        sdk.openChannel.removeOpenChannelHandler(messageReceiverId);
      }
    };
  }, [currentOpenChannel]);
}

function useInitialMessagesFetch(_ref, _ref2) {
  let {
    currentOpenChannel,
    userFilledMessageListParams
  } = _ref;
  let {
    logger,
    messagesDispatcher,
    scrollRef
  } = _ref2;
  useEffect(() => {
    logger.info('OpenChannel | useInitialMessagesFetch: Setup started', currentOpenChannel);
    messagesDispatcher({
      type: RESET_MESSAGES,
      payload: null
    });

    if (currentOpenChannel && currentOpenChannel.getMessagesByTimestamp) {
      const messageListParams = {
        nextResultSize: 0,
        prevResultSize: 30,
        isInclusive: true,
        includeReactions: false
      };

      if (userFilledMessageListParams) {
        Object.keys(userFilledMessageListParams).forEach(key => {
          messageListParams[key] = userFilledMessageListParams[key];
        });
        logger.info('OpenChannel | useInitialMessagesFetch: Used customizedMessageListParams');
      }

      logger.info('OpenChannel | useInitialMessagesFetch: Fetching messages', {
        currentOpenChannel,
        messageListParams
      });
      messagesDispatcher({
        type: GET_PREV_MESSAGES_START,
        payload: null
      });
      currentOpenChannel.getMessagesByTimestamp(new Date().getTime(), messageListParams).then(messages => {
        logger.info('OpenChannel | useInitialMessagesFetch: Fetching messages succeeded', messages);
        const hasMore = messages && messages.length > 0;
        const lastMessageTimestamp = hasMore ? messages[0].createdAt : null;
        messagesDispatcher({
          type: GET_PREV_MESSAGES_SUCESS,
          payload: {
            currentOpenChannel,
            messages,
            hasMore,
            lastMessageTimestamp
          }
        });
        setTimeout(() => {
          scrollIntoLast(0, scrollRef);
        });
      }).catch(error => {
        logger.error('OpenChannel | useInitialMessagesFetch: Fetching messages failed', error);
        messagesDispatcher({
          type: GET_PREV_MESSAGES_FAIL,
          payload: {
            currentOpenChannel,
            messages: [],
            hasMore: false,
            lastMessageTimestamp: 0
          }
        });
      });
    }
  }, [currentOpenChannel, userFilledMessageListParams]);
}

function useScrollCallback(_ref, _ref2) {
  let {
    currentOpenChannel,
    lastMessageTimestamp,
    fetchMore
  } = _ref;
  let {
    sdk,
    logger,
    messagesDispatcher,
    hasMore,
    userFilledMessageListParams
  } = _ref2;
  return useCallback(callback => {
    if (fetchMore && hasMore) {
      logger.info('OpenChannel | useScrollCallback: start');
      const messageListParams = {
        prevResultSize: 30,
        includeReactions: false,
        nextResultSize: 0
      };

      if (userFilledMessageListParams) {
        Object.keys(userFilledMessageListParams).forEach(key => {
          messageListParams[key] = userFilledMessageListParams[key];
        });
        logger.info('OpenChannel | useScrollCallback: Used userFilledMessageListParams', userFilledMessageListParams);
      }

      logger.info('OpenChannel | useScrollCallback: Fetching messages', {
        currentOpenChannel,
        messageListParams
      });
      currentOpenChannel.getMessagesByTimestamp(lastMessageTimestamp || new Date().getTime(), messageListParams).then(messages => {
        logger.info('OpenChannel | useScrollCallback: Fetching messages succeeded', messages);
        const hasMore = messages && messages.length > 0;
        const lastMessageTimestamp = hasMore ? messages[0].createdAt : null;
        messagesDispatcher({
          type: GET_PREV_MESSAGES_SUCESS,
          payload: {
            currentOpenChannel,
            messages,
            hasMore,
            lastMessageTimestamp
          }
        });
        setTimeout(() => {
          callback();
        });
      }).catch(error => {
        logger.error('OpenChannel | useScrollCallback: Fetching messages failed', error);
        messagesDispatcher({
          type: GET_PREV_MESSAGES_FAIL,
          payload: {
            currentOpenChannel,
            messages: [],
            hasMore: false,
            lastMessageTimestamp: 0
          }
        });
      });
    }
  }, [currentOpenChannel, lastMessageTimestamp, fetchMore, sdk]);
}

function useCheckScrollBottom(_ref, _ref2) {
  let {
    conversationScrollRef
  } = _ref;
  let {
    logger
  } = _ref2;
  return useCallback(() => {
    let isBottom = true;

    if (conversationScrollRef && conversationScrollRef !== null && conversationScrollRef !== void 0 && conversationScrollRef.current) {
      try {
        const conversationScroll = conversationScrollRef.current;
        isBottom = conversationScroll.scrollHeight <= conversationScroll.scrollTop + conversationScroll.clientHeight;
      } catch (error) {
        logger.error('OpenChannel | useCheckScrollBottom', error);
      }
    }

    return isBottom;
  }, [conversationScrollRef]);
}

function useSendMessageCallback(_ref, _ref2) {
  let {
    currentOpenChannel,
    onBeforeSendUserMessage,
    checkScrollBottom,
    messageInputRef
  } = _ref;
  let {
    sdk,
    logger,
    messagesDispatcher,
    scrollRef
  } = _ref2;
  return useCallback(() => {
    if (sdk) {
      const text = messageInputRef.current.innerText;

      const createParamsDefault = txt => {
        const message = txt;
        const params = {
          message: message
        };
        return params;
      };

      const createCustomParams = onBeforeSendUserMessage && typeof onBeforeSendUserMessage === 'function';

      if (createCustomParams) {
        logger.info('OpenChannel | useSendMessageCallback: Creating params using onBeforeSendUserMessage', onBeforeSendUserMessage);
      }

      const params = onBeforeSendUserMessage ? onBeforeSendUserMessage(text) : createParamsDefault(text);
      logger.info('OpenChannel | useSendMessageCallback: Sending message has started', params);
      const isBottom = checkScrollBottom();
      let pendingMsg = null;
      currentOpenChannel.sendUserMessage(params).onPending(pendingMessage => {
        messagesDispatcher({
          type: SENDING_MESSAGE_START,
          payload: {
            message: pendingMessage,
            channel: currentOpenChannel
          }
        });
        pendingMsg = pendingMessage;
      }).onSucceeded(message => {
        logger.info('OpenChannel | useSendMessageCallback: Sending message succeeded', message);
        messagesDispatcher({
          type: SENDING_MESSAGE_SUCCEEDED,
          payload: message
        });

        if (isBottom) {
          setTimeout(() => {
            scrollIntoLast(0, scrollRef);
          });
        }
      }).onFailed(error => {
        logger.warning('OpenChannel | useSendMessageCallback: Sending message failed', error);
        messagesDispatcher({
          type: SENDING_MESSAGE_FAILED,
          payload: pendingMsg
        }); // https://sendbird.com/docs/chat/v3/javascript/guides/error-codes#2-server-error-codes
        // TODO: Do we need to handle the error cases?
        // @ts-ignore

        if ((error === null || error === void 0 ? void 0 : error.code) === 900041) {
          messagesDispatcher({
            type: ON_USER_MUTED,
            payload: {
              channel: currentOpenChannel,
              user: sdk.currentUser
            }
          });
        }
      });
    }
  }, [currentOpenChannel, onBeforeSendUserMessage, checkScrollBottom, messageInputRef]);
}

function useFileUploadCallback(_ref, _ref2) {
  let {
    currentOpenChannel,
    checkScrollBottom,
    imageCompression = {},
    onBeforeSendFileMessage
  } = _ref;
  let {
    sdk,
    logger,
    messagesDispatcher,
    scrollRef
  } = _ref2;
  return useCallback(file => {
    if (sdk) {
      const {
        compressionRate,
        resizingWidth,
        resizingHeight
      } = imageCompression;
      const createCustomParams = onBeforeSendFileMessage && typeof onBeforeSendFileMessage === 'function';
      const compressibleFileType = file.type === 'image/jpg' || file.type === 'image/png' || file.type === 'image/jpeg';
      const compressibleRatio = compressionRate > 0 && compressionRate < 1; // pxToNumber returns null if values are invalid

      const compressibleDiamensions = pxToNumber(resizingWidth) || pxToNumber(resizingHeight);
      const canCompressImage = compressibleFileType && (compressibleRatio || compressibleDiamensions);

      const createParamsDefault = file_ => {
        const params = {};
        params.file = file_;
        return params;
      };

      if (canCompressImage) {
        // Using image compression
        try {
          const image = document.createElement('img');
          image.src = URL.createObjectURL(file);

          image.onload = () => {
            URL.revokeObjectURL(image.src);
            const canvas = document.createElement('canvas');
            const imageWidth = image.naturalWidth || image.width;
            const imageHeight = image.naturalHeight || image.height;
            let targetWidth = pxToNumber(resizingWidth) || imageWidth;
            let targetHeight = pxToNumber(resizingHeight) || imageHeight; // In canvas.toBlob(callback, mimeType, qualityArgument)
            // qualityArgument doesnt work
            // so in case compressibleDiamensions are not present, we use ratio

            if (file.type === 'image/png' && !compressibleDiamensions) {
              targetWidth *= compressionRate;
              targetHeight *= compressionRate;
            }

            canvas.width = targetWidth;
            canvas.height = targetHeight;
            const context = canvas.getContext('2d');
            context.drawImage(image, 0, 0, targetWidth, targetHeight);
            context.canvas.toBlob(newImageBlob => {
              const compressedFile = new File([newImageBlob], file.name, {
                type: file.type
              });

              if (createCustomParams) {
                logger.info('OpenChannel | useFileUploadCallback: Creating params using onBeforeSendFileMessage', onBeforeSendFileMessage);
              }

              const params = onBeforeSendFileMessage ? onBeforeSendFileMessage(compressedFile) : createParamsDefault(compressedFile);
              logger.info('OpenChannel | useFileUploadCallback: Uploading file message start', params);
              const isBottom = checkScrollBottom();
              currentOpenChannel.sendFileMessage(params).onPending(pendingMessage => {
                messagesDispatcher({
                  type: SENDING_MESSAGE_START,
                  payload: {
                    message: _objectSpread2(_objectSpread2({}, pendingMessage), {}, {
                      url: URL.createObjectURL(file),
                      // pending thumbnail message seems to be failed
                      requestState: 'pending'
                    }),
                    channel: currentOpenChannel
                  }
                });
              }).onSucceeded(message => {
                logger.info('OpenChannel | useFileUploadCallback: Sending message succeeded', message);
                messagesDispatcher({
                  type: SENDING_MESSAGE_SUCCEEDED,
                  payload: message
                });

                if (isBottom) {
                  setTimeout(() => {
                    scrollIntoLast(0, scrollRef);
                  });
                }
              }).onFailed((error, message) => {
                logger.error('OpenChannel | useFileUploadCallback: Sending file message failed', {
                  message,
                  error
                }); // @ts-ignore

                message.localUrl = URL.createObjectURL(file); // @ts-ignore

                message.file = file;
                messagesDispatcher({
                  type: SENDING_MESSAGE_FAILED,
                  payload: message
                });
              });
            }, file.type, compressionRate);
          };
        } catch (error) {
          logger.warning('OpenChannel | useFileUploadCallback: Sending file message with image compression failed', error);
        }
      } else {
        // Not using image compression
        if (createCustomParams) {
          logger.info('OpenChannel | useFileUploadCallback: Creating params using onBeforeSendFileMessage', onBeforeSendFileMessage);
        }

        const params = onBeforeSendFileMessage ? onBeforeSendFileMessage(file) : createParamsDefault(file);
        logger.info('OpenChannel | useFileUploadCallback: Uploading file message start', params);
        const isBottom = checkScrollBottom();
        currentOpenChannel.sendFileMessage(params).onPending(pendingMessage => {
          messagesDispatcher({
            type: SENDING_MESSAGE_START,
            payload: {
              message: _objectSpread2(_objectSpread2({}, pendingMessage), {}, {
                url: URL.createObjectURL(file),
                // pending thumbnail message seems to be failed
                requestState: 'pending'
              }),
              channel: currentOpenChannel
            }
          });
        }).onSucceeded(message => {
          logger.info('OpenChannel | useFileUploadCallback: Sending message succeeded', message);
          messagesDispatcher({
            type: SENDING_MESSAGE_SUCCEEDED,
            payload: message
          });

          if (isBottom) {
            setTimeout(() => {
              scrollIntoLast(0, scrollRef);
            });
          }
        }).onFailed((error, message) => {
          logger.error('OpenChannel | useFileUploadCallback: Sending file message failed', {
            message,
            error
          }); // @ts-ignore

          message.localUrl = URL.createObjectURL(file); // @ts-ignore

          message.file = file;
          messagesDispatcher({
            type: SENDING_MESSAGE_FAILED,
            payload: message
          });
        });
      }
    }
  }, [currentOpenChannel, onBeforeSendFileMessage, checkScrollBottom, imageCompression]);
}

function useUpdateMessageCallback(_ref, _ref2) {
  let {
    currentOpenChannel,
    onBeforeSendUserMessage
  } = _ref;
  let {
    logger,
    messagesDispatcher
  } = _ref2;
  return useCallback((messageId, text, callback) => {
    const createParamsDefault = txt => {
      const params = {
        message: txt
      };
      return params;
    };

    if (onBeforeSendUserMessage && typeof onBeforeSendUserMessage === 'function') {
      logger.info('OpenChannel | useUpdateMessageCallback: Creating params using onBeforeUpdateUserMessage');
    }

    const params = onBeforeSendUserMessage ? onBeforeSendUserMessage(text) : createParamsDefault(text);
    currentOpenChannel.updateUserMessage(messageId, params).then(message => {
      if (callback) {
        callback();
      }

      logger.info('OpenChannel | useUpdateMessageCallback: Updating message succeeded', {
        message,
        params
      });
      messagesDispatcher({
        type: ON_MESSAGE_UPDATED,
        payload: {
          channel: currentOpenChannel,
          message
        }
      });
    });
  }, [currentOpenChannel, onBeforeSendUserMessage]);
}

function useDeleteMessageCallback(_ref, _ref2) {
  let {
    currentOpenChannel
  } = _ref;
  let {
    logger,
    messagesDispatcher
  } = _ref2;
  return useCallback((message, callback) => {
    logger.info('OpenChannel | useDeleteMessageCallback: Deleting message', message);
    const {
      sendingStatus
    } = message;
    logger.info('OpenChannel | useDeleteMessageCallback: Deleting message requestState', sendingStatus);

    if (sendingStatus === 'failed' || sendingStatus === 'pending') {
      logger.info('OpenChannel | useDeleteMessageCallback: Deleted message from local', message);
      messagesDispatcher({
        type: ON_MESSAGE_DELETED_BY_REQ_ID,
        payload: message.reqId
      });

      if (callback) {
        callback();
      }
    } else {
      if (!(message.messageType === 'file' || message.messageType === 'user')) {
        return;
      }

      const messageToDelete = message;
      currentOpenChannel.deleteMessage(messageToDelete).then(() => {
        logger.info('OpenChannel | useDeleteMessageCallback: Deleting message on server', sendingStatus);

        if (callback) {
          callback();
        }

        logger.info('OpenChannel | useDeleteMessageCallback: Deleting message succeeded', message);
        messagesDispatcher({
          type: ON_MESSAGE_DELETED,
          payload: {
            channel: currentOpenChannel,
            messageId: message.messageId
          }
        });
      }).catch(error => {
        logger.warning('OpenChannel | useDeleteMessageCallback: Deleting message failed', error);
      });
    }
  }, [currentOpenChannel]);
}

function useResendMessageCallback(_ref, _ref2) {
  let {
    currentOpenChannel
  } = _ref;
  let {
    logger,
    messagesDispatcher
  } = _ref2;
  return useCallback(failedMessage => {
    logger.info('OpenChannel | useResendMessageCallback: Resending message has started', failedMessage); // eslint-disable-next-line no-param-reassign

    const {
      messageType,
      file
    } = failedMessage;

    if (failedMessage && typeof failedMessage.isResendable === 'function' && failedMessage.isResendable) {
      // eslint-disable-next-line no-param-reassign
      failedMessage.requestState = 'pending';
      messagesDispatcher({
        type: RESENDING_MESSAGE_START,
        payload: {
          channel: currentOpenChannel,
          message: failedMessage
        }
      }); // userMessage

      if (messageType === 'user' && failedMessage.messageType === 'user') {
        currentOpenChannel.resendUserMessage(failedMessage).then(message => {
          logger.info('OpenChannel | useResendMessageCallback: Reseding message succeeded', message);
          messagesDispatcher({
            type: SENDING_MESSAGE_SUCCEEDED,
            payload: message
          });
        }).catch(error => {
          logger.warning('OpenChannel | useResendMessageCallback: Resending message failed', error); // eslint-disable-next-line no-param-reassign

          failedMessage.requestState = 'failed';
          messagesDispatcher({
            type: SENDING_MESSAGE_FAILED,
            payload: failedMessage
          });
        });
      } // fileMessage


      if (messageType === 'file' && failedMessage.messageType === 'file') {
        currentOpenChannel.resendFileMessage(failedMessage, file).then(message => {
          logger.info('OpenChannel | useResendMessageCallback: Resending file message succeeded', message);
          messagesDispatcher({
            type: SENDING_MESSAGE_SUCCEEDED,
            payload: message
          });
        }).catch(error => {
          logger.warning('OpenChannel | useResendMessageCallback: Resending file message failed', error); // eslint-disable-next-line no-param-reassign

          failedMessage.requestState = 'failed';
          messagesDispatcher({
            type: SENDING_MESSAGE_FAILED,
            payload: failedMessage
          });
        });
      }
    } else {
      // to alert user on console
      // eslint-disable-next-line no-console
      console.error('OpenChannel | useResendMessageCallback: Message is not resendable');
      logger.warning('OpenChannel | useResendMessageCallback: Message is not resendable', failedMessage);
    }
  }, [currentOpenChannel]);
}

const THROTTLE_TIMER = 5000; // to trim message list so that we wont keep thousands of messages in memory
// We are throttling here; not debouncing
// it will be called once very 5 sec if messagesLength, messageLimit changes
// we check if messagesLength > messageLimit before dispatching action

function useTrimMessageList(_ref, _ref2) {
  let {
    messagesLength,
    messageLimit
  } = _ref;
  let {
    messagesDispatcher,
    logger
  } = _ref2;
  const [inProgress, setInProgress] = useState(false);
  useEffect(() => {
    if (inProgress) {
      return;
    }

    if (typeof messagesLength === 'number' && messagesLength > messageLimit) {
      logger.info('Trimming MessageList');
      messagesDispatcher({
        type: TRIM_MESSAGE_LIST,
        payload: {
          messageLimit
        }
      });
    }

    setInProgress(true);
    setTimeout(() => {
      setInProgress(false);
    }, THROTTLE_TIMER);
  }, [messagesLength, messageLimit]);
}

const OpenChannelContext = /*#__PURE__*/React__default__default.createContext(undefined);

const OpenChannelProvider = props => {
  var _globalStore$stores, _globalStore$stores$s, _globalStore$stores2, _globalStore$stores2$, _globalStore$stores3, _globalStore$stores3$, _props$disableUserPro;

  const {
    channelUrl,
    children,
    isMessageGroupingEnabled = true,
    queries,
    onBeforeSendUserMessage,
    messageLimit,
    onBeforeSendFileMessage,
    onChatHeaderActionClick,
    onBackClick
  } = props; // We didn't decide to support fetching participant list

  const fetchingParticipants = false;
  const globalStore = useSendbirdStateContext();
  const sdk = globalStore === null || globalStore === void 0 ? void 0 : (_globalStore$stores = globalStore.stores) === null || _globalStore$stores === void 0 ? void 0 : (_globalStore$stores$s = _globalStore$stores.sdkStore) === null || _globalStore$stores$s === void 0 ? void 0 : _globalStore$stores$s.sdk;
  const sdkInit = globalStore === null || globalStore === void 0 ? void 0 : (_globalStore$stores2 = globalStore.stores) === null || _globalStore$stores2 === void 0 ? void 0 : (_globalStore$stores2$ = _globalStore$stores2.sdkStore) === null || _globalStore$stores2$ === void 0 ? void 0 : _globalStore$stores2$.initialized;
  const user = globalStore === null || globalStore === void 0 ? void 0 : (_globalStore$stores3 = globalStore.stores) === null || _globalStore$stores3 === void 0 ? void 0 : (_globalStore$stores3$ = _globalStore$stores3.userStore) === null || _globalStore$stores3$ === void 0 ? void 0 : _globalStore$stores3$.user;
  const config = globalStore === null || globalStore === void 0 ? void 0 : globalStore.config;
  const {
    userId,
    isOnline,
    logger,
    pubSub,
    imageCompression
  } = config; // hook variables

  const [messagesStore, messagesDispatcher] = useReducer(reducer, initialState);
  const {
    allMessages,
    loading,
    initialized,
    currentOpenChannel,
    isInvalid,
    hasMore,
    lastMessageTimestamp,
    operators,
    bannedParticipantIds,
    mutedParticipantIds
  } = messagesStore; // ref

  const messageInputRef = useRef(null); // useSendMessageCallback

  const conversationScrollRef = useRef(null); // useScrollAfterSendMessageCallback
  // const

  const userFilledMessageListParams = queries === null || queries === void 0 ? void 0 : queries.messageListParams;
  const disabled = !initialized || !isOnline || isDisabledBecauseFrozen(currentOpenChannel, userId) || isDisabledBecauseMuted(mutedParticipantIds, userId); // useMemo

  const amIBanned = useMemo(() => {
    return bannedParticipantIds.indexOf(user.userId) >= 0;
  }, [channelUrl, bannedParticipantIds, user]);
  const amIMuted = useMemo(() => {
    return mutedParticipantIds.indexOf(user.userId) >= 0;
  }, [channelUrl, mutedParticipantIds, user]);
  const amIOperator = useMemo(() => {
    return operators.map(operator => operator.userId).indexOf(user.userId) >= 0;
  }, [channelUrl, operators, user]); // use hooks

  useSetChannel({
    channelUrl,
    sdkInit,
    fetchingParticipants,
    userId,
    currentOpenChannel
  }, {
    sdk,
    logger,
    messagesDispatcher
  });
  const checkScrollBottom = useCheckScrollBottom({
    conversationScrollRef
  }, {
    logger
  });
  useHandleChannelEvents({
    currentOpenChannel,
    checkScrollBottom
  }, {
    sdk,
    logger,
    messagesDispatcher,
    scrollRef: conversationScrollRef
  });
  useInitialMessagesFetch({
    currentOpenChannel,
    userFilledMessageListParams
  }, {
    logger,
    messagesDispatcher,
    scrollRef: conversationScrollRef
  });
  const fetchMore = shouldFetchMore(allMessages === null || allMessages === void 0 ? void 0 : allMessages.length, messageLimit); // donot fetch more for streaming

  const onScroll = useScrollCallback({
    currentOpenChannel,
    lastMessageTimestamp,
    fetchMore
  }, {
    sdk,
    logger,
    messagesDispatcher,
    hasMore,
    userFilledMessageListParams
  });
  const handleSendMessage = useSendMessageCallback({
    currentOpenChannel,
    onBeforeSendUserMessage,
    checkScrollBottom,
    messageInputRef
  }, {
    sdk,
    logger,
    messagesDispatcher,
    scrollRef: conversationScrollRef
  });
  const handleFileUpload = useFileUploadCallback({
    currentOpenChannel,
    onBeforeSendFileMessage,
    checkScrollBottom,
    imageCompression
  }, {
    sdk,
    logger,
    messagesDispatcher,
    scrollRef: conversationScrollRef
  });
  const updateMessage = useUpdateMessageCallback({
    currentOpenChannel,
    onBeforeSendUserMessage
  }, {
    logger,
    messagesDispatcher
  });
  const deleteMessage = useDeleteMessageCallback({
    currentOpenChannel
  }, {
    logger,
    messagesDispatcher
  });
  const resendMessage = useResendMessageCallback({
    currentOpenChannel
  }, {
    logger,
    messagesDispatcher
  });
  useTrimMessageList({
    messagesLength: allMessages === null || allMessages === void 0 ? void 0 : allMessages.length,
    messageLimit
  }, {
    messagesDispatcher,
    logger
  }); // handle API calls from withSendbird

  useEffect(() => {
    const subscriber = new Map();

    if (!pubSub || !pubSub.subscribe) {
      return;
    }

    subscriber.set(PUBSUB_TOPICS.SEND_USER_MESSAGE, pubSub.subscribe(PUBSUB_TOPICS.SEND_USER_MESSAGE, msg => {
      const {
        channel,
        message
      } = msg;
      scrollIntoLast(0, conversationScrollRef);

      if (channel && channelUrl === (channel === null || channel === void 0 ? void 0 : channel.url)) {
        messagesDispatcher({
          type: SENDING_MESSAGE_SUCCEEDED,
          payload: message
        });
      }
    }));
    subscriber.set(PUBSUB_TOPICS.SEND_MESSAGE_START, pubSub.subscribe(PUBSUB_TOPICS.SEND_MESSAGE_START, msg => {
      const {
        channel,
        message
      } = msg;

      if (channel && channelUrl === (channel === null || channel === void 0 ? void 0 : channel.url)) {
        messagesDispatcher({
          type: SENDING_MESSAGE_START,
          payload: {
            message,
            channel
          }
        });
      }
    }));
    subscriber.set(PUBSUB_TOPICS.SEND_FILE_MESSAGE, pubSub.subscribe(PUBSUB_TOPICS.SEND_FILE_MESSAGE, msg => {
      const {
        channel,
        message
      } = msg;
      scrollIntoLast(0, conversationScrollRef);

      if (channel && channelUrl === (channel === null || channel === void 0 ? void 0 : channel.url)) {
        messagesDispatcher({
          type: SENDING_MESSAGE_SUCCEEDED,
          payload: {
            message,
            channel
          }
        });
      }
    }));
    subscriber.set(PUBSUB_TOPICS.UPDATE_USER_MESSAGE, pubSub.subscribe(PUBSUB_TOPICS.UPDATE_USER_MESSAGE, msg => {
      const {
        channel,
        message,
        fromSelector
      } = msg;

      if (fromSelector && channel && channelUrl === (channel === null || channel === void 0 ? void 0 : channel.url)) {
        messagesDispatcher({
          type: ON_MESSAGE_UPDATED,
          payload: {
            channel,
            message
          }
        });
      }
    }));
    subscriber.set(PUBSUB_TOPICS.DELETE_MESSAGE, pubSub.subscribe(PUBSUB_TOPICS.DELETE_MESSAGE, msg => {
      const {
        channel,
        messageId
      } = msg;

      if (channel && channelUrl === (channel === null || channel === void 0 ? void 0 : channel.url)) {
        messagesDispatcher({
          type: ON_MESSAGE_DELETED,
          payload: messageId
        });
      }
    }));
    return () => {
      if (subscriber) {
        subscriber.forEach(s => {
          try {
            s.remove();
          } catch (_unused) {//
          }
        });
      }
    };
  }, [channelUrl, sdkInit]);
  return /*#__PURE__*/React__default__default.createElement(OpenChannelContext.Provider, {
    value: {
      // props
      channelUrl,
      children,
      isMessageGroupingEnabled,
      queries,
      onBeforeSendUserMessage,
      messageLimit,
      onBeforeSendFileMessage,
      onChatHeaderActionClick,
      onBackClick,
      // store
      allMessages,
      loading,
      initialized,
      currentOpenChannel,
      isInvalid,
      hasMore,
      lastMessageTimestamp,
      operators,
      bannedParticipantIds,
      mutedParticipantIds,
      // derived/utils
      messageInputRef,
      conversationScrollRef,
      disabled,
      amIBanned,
      amIMuted,
      amIOperator,
      checkScrollBottom,
      fetchMore,
      onScroll,
      handleSendMessage,
      handleFileUpload,
      updateMessage,
      deleteMessage,
      resendMessage
    }
  }, /*#__PURE__*/React__default__default.createElement(UserProfileProvider, {
    isOpenChannel: true,
    renderUserProfile: props === null || props === void 0 ? void 0 : props.renderUserProfile,
    disableUserProfile: (_props$disableUserPro = props === null || props === void 0 ? void 0 : props.disableUserProfile) !== null && _props$disableUserPro !== void 0 ? _props$disableUserPro : config === null || config === void 0 ? void 0 : config.disableUserProfile
  }, children));
};

const useOpenChannelContext = () => React__default__default.useContext(OpenChannelContext);

const MessageInputWrapper = (props, ref) => {
  const {
    currentOpenChannel,
    disabled,
    handleSendMessage,
    handleFileUpload,
    amIMuted
  } = useOpenChannelContext();
  const channel = currentOpenChannel;
  const {
    stringSet
  } = useContext(LocalizationContext);
  const {
    value
  } = props;

  function getPlaceHolderString() {
    if (amIMuted) {
      return stringSet.MESSAGE_INPUT__PLACE_HOLDER__MUTED;
    }

    if (disabled) {
      return stringSet.MESSAGE_INPUT__PLACE_HOLDER__DISABLED;
    }

    return '';
  }

  if (!channel) {
    return null;
  }

  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-footer"
  }, /*#__PURE__*/React__default__default.createElement(MessageInput, {
    channel: currentOpenChannel,
    ref: ref,
    value: value,
    disabled: disabled,
    isVoiceMessageEnabled: false,
    onSendMessage: handleSendMessage,
    onFileUpload: handleFileUpload,
    placeholder: getPlaceHolderString()
  }));
};

var OpenChannelInput = /*#__PURE__*/React__default__default.forwardRef(MessageInputWrapper);

const FrozenNotification = () => {
  const {
    stringSet
  } = useContext(LocalizationContext);
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-frozen-channel-notification"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-frozen-channel-notification__text",
    type: LabelTypography.CAPTION_2
  }, stringSet.CHANNEL_FROZEN));
};

function OpenchannelConversationHeader() {
  const {
    stringSet
  } = useContext(LocalizationContext);
  const {
    currentOpenChannel,
    onChatHeaderActionClick,
    amIOperator,
    onBackClick
  } = useOpenChannelContext();
  const title = currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.name;
  const subTitle = `${kFormatter(currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.participantCount)} ${stringSet.OPEN_CHANNEL_CONVERSATION__TITLE_PARTICIPANTS}`;
  const coverImage = currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.coverUrl;
  const {
    isMobile
  } = useMediaQueryContext();
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-conversation-header"
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-conversation-header__left"
  }, isMobile && /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-oepnchannel-header__icon_back",
    onClick: onBackClick,
    fillColor: IconColors.PRIMARY,
    width: "24px",
    height: "24px",
    type: IconTypes.ARROW_LEFT
  }), coverImage ? /*#__PURE__*/React__default__default.createElement(Avatar$1, {
    className: "sendbird-openchannel-conversation-header__left__cover-image",
    src: coverImage,
    alt: "channel cover image",
    width: "32px",
    height: "32px"
  }) : /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-conversation-header__left__cover-image--icon",
    style: {
      width: 32,
      height: 32
    }
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    type: IconTypes.CHANNELS,
    fillColor: IconColors.CONTENT,
    width: "18px",
    height: "18px"
  })), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-conversation-header__left__title",
    type: LabelTypography.H_2,
    color: LabelColors.ONBACKGROUND_1
  }, title || stringSet.NO_TITLE), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-conversation-header__left__sub-title",
    type: LabelTypography.BODY_2,
    color: LabelColors.ONBACKGROUND_2
  }, subTitle || stringSet.NO_TITLE)), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-conversation-header__right"
  }, /*#__PURE__*/React__default__default.createElement(IconButton, {
    className: "sendbird-openchannel-conversation-header__right__trigger",
    width: "32px",
    height: "32px",
    onClick: onChatHeaderActionClick
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    type: amIOperator ? IconTypes.INFO : IconTypes.MEMBERS,
    fillColor: IconColors.PRIMARY,
    width: "24px",
    height: "24px"
  }))));
}

const copyToClipboard = text => {
  // @ts-ignore: Unreachable code error
  if (window.clipboardData && window.clipboardData.setData) {
    // Internet Explorer-specific code path to prevent textarea being shown while dialog is visible.
    // @ts-ignore: Unreachable code error
    return window.clipboardData.setData('Text', text);
  }

  if (document.queryCommandSupported && document.queryCommandSupported('copy')) {
    const textarea = document.createElement('textarea');
    textarea.textContent = text;
    textarea.style.position = 'fixed'; // Prevent scrolling to bottom of page in Microsoft Edge.

    document.body.appendChild(textarea);
    textarea.select();

    try {
      return document.execCommand('copy'); // Security exception may be thrown by some browsers.
    } catch (ex) {
      return false;
    } finally {
      document.body.removeChild(textarea);
    }
  }

  return false;
};

const OpenChannelMessageStatusTypes = {
  NONE: 'none',
  PENDING: 'pending',
  FAILED: 'failed',
  CANCELED: 'canceled',
  SUCCEEDED: 'succeeded'
};

const getSenderFromMessage = message => {
  // @ts-ignore
  return message.sender || message._sender;
};

const checkIsSent = status => status === OpenChannelMessageStatusTypes.SUCCEEDED;

const checkIsPending = status => status === OpenChannelMessageStatusTypes.PENDING;

const checkIsFailed = status => status === OpenChannelMessageStatusTypes.FAILED;

const checkIsByMe = (message, userId) => getSenderFromMessage(message).userId === userId;

const isFineCopy = _ref => {
  var _message$message;

  let {
    message
  } = _ref;
  return (message === null || message === void 0 ? void 0 : message.messageType) === 'user' && (message === null || message === void 0 ? void 0 : (_message$message = message.message) === null || _message$message === void 0 ? void 0 : _message$message.length) > 0;
};

const isFineResend = _ref2 => {
  let {
    message,
    status,
    userId
  } = _ref2;
  return checkIsByMe(message, userId) && checkIsFailed(status) // @ts-ignore
  && (message === null || message === void 0 ? void 0 : message.isResendable());
};

const isFineEdit = _ref3 => {
  var _message$isUserMessag;

  let {
    message,
    status,
    userId
  } = _ref3;
  return checkIsByMe(message, userId) && checkIsSent(status) && (message === null || message === void 0 ? void 0 : (_message$isUserMessag = message.isUserMessage) === null || _message$isUserMessag === void 0 ? void 0 : _message$isUserMessag.call(message));
};

const isFineDelete = _ref4 => {
  let {
    message,
    userId
  } = _ref4;
  return checkIsByMe(message, userId);
};

const isFineDownload = _ref5 => {
  var _message$isFileMessag;

  let {
    message,
    status
  } = _ref5;

  if (message !== null && message !== void 0 && (_message$isFileMessag = message.isFileMessage) !== null && _message$isFileMessag !== void 0 && _message$isFileMessag.call(message) && checkIsSent(status)) {
    return true;
  }

  return false;
};

const showMenuTrigger = props => {
  const {
    message,
    status,
    userId
  } = props; // @ts-ignore

  if (message.messageType === 'user') {
    return isFineDelete({
      message,
      status,
      userId
    }) || isFineEdit({
      message,
      status,
      userId
    }) // @ts-ignore
    || isFineCopy({
      message,
      status,
      userId
    }) || isFineResend({
      message,
      status,
      userId
    });
  } else {
    return isFineDelete({
      message,
      status,
      userId
    }) || isFineResend({
      message,
      status,
      userId
    });
  }
};

const OpenChannelMobileMenu = props => {
  var _useSendbirdStateCont, _useSendbirdStateCont2;

  const {
    message,
    parentRef,
    resendMessage,
    showEdit,
    showRemove,
    copyToClipboard,
    hideMenu,
    isEphemeral = false
  } = props;
  const userMessage = message;
  const status = message === null || message === void 0 ? void 0 : message.sendingStatus;
  const {
    stringSet
  } = useLocalization();
  const userId = (_useSendbirdStateCont = useSendbirdStateContext()) === null || _useSendbirdStateCont === void 0 ? void 0 : (_useSendbirdStateCont2 = _useSendbirdStateCont.config) === null || _useSendbirdStateCont2 === void 0 ? void 0 : _useSendbirdStateCont2.userId;
  const fileMessage = message;
  return /*#__PURE__*/React__default__default.createElement(ContextMenu, {
    isOpen: true,
    menuItems: () => /*#__PURE__*/React__default__default.createElement(MenuItems, {
      className: "sendbird-openchannel__mobile-menu",
      parentRef: parentRef,
      parentContainRef: parentRef,
      closeDropdown: hideMenu
    }, isFineCopy({
      message: userMessage,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      className: "sendbird-openchannel-og-message__top__context-menu__copy",
      onClick: () => {
        copyToClipboard();
      },
      dataSbId: "open_channel_mobile_context_menu_copy"
    }, /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, stringSet.CONTEXT_MENU_DROPDOWN__COPY)), !isEphemeral && isFineEdit({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      className: "sendbird-openchannel-og-message__top__context-menu__edit",
      onClick: () => {
        showEdit();
      },
      dataSbId: "open_channel_mobile_context_menu_edit"
    }, /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, stringSet.CONTEXT_MENU_DROPDOWN__EDIT)), isFineResend({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      onClick: () => {
        resendMessage();
      },
      dataSbId: "open_channel_mobile_context_menu_resend"
    }, /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, stringSet.CONTEXT_MENU_DROPDOWN__RESEND)), !isEphemeral && isFineDelete({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      onClick: () => {
        showRemove();
      },
      dataSbId: "open_channel_mobile_context_menu_delete"
    }, /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, stringSet.CONTEXT_MENU_DROPDOWN__DELETE)), isFineDownload({
      message,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      onClick: () => {
        hideMenu();
      },
      dataSbId: "open_channel_mobile_context_menu_download_file"
    }, /*#__PURE__*/React__default__default.createElement("a", {
      className: "sendbird-openchannel__mobile-menu-hyperlink",
      rel: "noopener noreferrer",
      href: fileMessage === null || fileMessage === void 0 ? void 0 : fileMessage.url,
      target: "_blank"
    }, stringSet.CONTEXT_MENU_DROPDOWN__SAVE)))
  });
};

function OpenchannelUserMessage(_ref) {
  let {
    className,
    message,
    isOperator,
    isEphemeral = false,
    userId,
    resendMessage,
    disabled,
    showEdit,
    showRemove,
    chainTop
  } = _ref; // hooks

  const {
    stringSet,
    dateLocale
  } = useLocalization();
  const {
    disableUserProfile,
    renderUserProfile
  } = useContext(UserProfileContext);
  const messageRef = useRef(null);
  const avatarRef = useRef(null);
  const contextMenuRef = useRef(null);
  const mobileMenuRef = useRef(null);
  const [contextStyle, setContextStyle] = useState({});
  const [contextMenu, setContextMenu] = useState(false); // consts

  const status = message === null || message === void 0 ? void 0 : message.sendingStatus;
  const isPending = checkIsPending(status);
  const isFailed = checkIsFailed(status);
  const sender = getSenderFromMessage(message); // place context menu top depending clientHeight of message component

  useEffect(() => {
    var _messageRef$current;

    if ((messageRef === null || messageRef === void 0 ? void 0 : (_messageRef$current = messageRef.current) === null || _messageRef$current === void 0 ? void 0 : _messageRef$current.clientHeight) > 36) {
      setContextStyle({
        top: '8px '
      });
    } else {
      setContextStyle({
        top: '2px'
      });
    }
  }, [window.innerWidth]);
  const onLongPress = useLongPress({
    onLongPress: () => {
      setContextMenu(true);
    }
  });
  const {
    isMobile
  } = useMediaQueryContext();

  if (!message || message.messageType !== 'user') {
    return /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null);
  }

  return /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-openchannel-user-message'].join(' '),
    ref: messageRef
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-user-message__left"
  }, !chainTop && /*#__PURE__*/React__default__default.createElement(ContextMenu, {
    menuTrigger: toggleDropdown => /*#__PURE__*/React__default__default.createElement(Avatar$1, {
      className: "sendbird-openchannel-user-message__left__avatar",
      src: sender.profileUrl || '',
      ref: avatarRef,
      width: "28px",
      height: "28px",
      onClick: () => {
        if (!disableUserProfile) {
          toggleDropdown();
        }
      }
    }),
    menuItems: closeDropdown => /*#__PURE__*/React__default__default.createElement(MenuItems, {
      parentRef: avatarRef,
      parentContainRef: avatarRef,
      closeDropdown: closeDropdown,
      style: {
        paddingTop: '0px',
        paddingBottom: '0px'
      }
    }, renderUserProfile ? renderUserProfile({
      user: sender,
      close: closeDropdown
    }) : /*#__PURE__*/React__default__default.createElement(UserProfile, {
      user: sender,
      onSuccess: closeDropdown,
      disableMessaging: true
    }))
  })), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-user-message__right"
  }, !chainTop && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-user-message__right__top"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-user-message__right__top__sender-name",
    type: LabelTypography.CAPTION_2,
    color: isOperator ? LabelColors.SECONDARY_3 : LabelColors.ONBACKGROUND_2
  }, sender && (sender.friendName || sender.nickname || sender.userId)), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-user-message__right__top__sent-at",
    type: LabelTypography.CAPTION_3,
    color: LabelColors.ONBACKGROUND_3
  }, (message === null || message === void 0 ? void 0 : message.createdAt) && format$1(message === null || message === void 0 ? void 0 : message.createdAt, 'p', {
    locale: dateLocale
  }))), /*#__PURE__*/React__default__default.createElement("div", _extends$X({}, isMobile ? _objectSpread2({}, onLongPress) : {}, {
    className: "sendbird-openchannel-user-message__right__bottom",
    ref: mobileMenuRef
  }), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-user-message__right__bottom__message",
    type: LabelTypography.BODY_1,
    color: LabelColors.ONBACKGROUND_1
  }, message === null || message === void 0 ? void 0 : message.message, isEditedMessage(message) && /*#__PURE__*/React__default__default.createElement(Label, {
    key: uuidv4(),
    type: LabelTypography.BODY_1,
    color: LabelColors.ONBACKGROUND_2,
    calssName: "sendbird-openchannel-user-message-word"
  }, ` ${stringSet.MESSAGE_EDITED} `))), (isPending || isFailed) && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-user-message__right__tail"
  }, isPending && /*#__PURE__*/React__default__default.createElement(Loader, {
    width: "16px",
    height: "16px"
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-openchannel-user-message__right__tail__pending",
    type: IconTypes.SPINNER,
    fillColor: IconColors.PRIMARY,
    width: "16px",
    height: "16px"
  })), isFailed && /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-openchannel-user-message__right__tail__failed",
    type: IconTypes.ERROR,
    fillColor: IconColors.ERROR,
    width: "16px",
    height: "16px"
  }))), !isMobile && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-user-message__context-menu",
    ref: contextMenuRef,
    style: contextStyle
  }, /*#__PURE__*/React__default__default.createElement(ContextMenu, {
    menuTrigger: toggleDropdown => showMenuTrigger({
      message: message,
      userId: userId,
      status: status
    }) && /*#__PURE__*/React__default__default.createElement(IconButton, {
      className: "sendbird-openchannel-user-message__context-menu--icon",
      width: "32px",
      height: "32px",
      onClick: () => {
        toggleDropdown();
      }
    }, /*#__PURE__*/React__default__default.createElement(Icon, {
      type: IconTypes.MORE,
      fillColor: IconColors.CONTENT_INVERSE,
      width: "24px",
      height: "24px"
    })),
    menuItems: closeDropdown => /*#__PURE__*/React__default__default.createElement(MenuItems, {
      parentRef: contextMenuRef,
      parentContainRef: contextMenuRef,
      closeDropdown: closeDropdown,
      openLeft: true
    }, isFineCopy({
      message: message,
      userId: userId,
      status: status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      className: "sendbird-openchannel-user-message__context-menu__copy",
      onClick: () => {
        copyToClipboard(message.message);
        closeDropdown();
      },
      dataSbId: "open_channel_user_message_menu_copy"
    }, stringSet.CONTEXT_MENU_DROPDOWN__COPY), !isEphemeral && isFineEdit({
      message: message,
      userId: userId,
      status: status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      className: "sendbird-openchannel-user-message__context-menu__edit",
      onClick: () => {
        if (disabled) {
          return;
        }

        showEdit(true);
        closeDropdown();
      },
      dataSbId: "open_channel_user_message_menu_edit"
    }, stringSet.CONTEXT_MENU_DROPDOWN__EDIT), isFineResend({
      message: message,
      userId: userId,
      status: status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      className: "sendbird-openchannel-user-message__context-menu__resend",
      onClick: () => {
        resendMessage(message);
        closeDropdown();
      },
      dataSbId: "open_channel_user_message_menu_resend"
    }, stringSet.CONTEXT_MENU_DROPDOWN__RESEND), !isEphemeral && isFineDelete({
      message: message,
      userId: userId,
      status: status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      className: "sendbird-openchannel-user-message__context-menu__delete",
      onClick: () => {
        if (disabled) {
          return;
        }

        showRemove(true);
        closeDropdown();
      },
      dataSbId: "open_channel_user_message_menu_delete"
    }, stringSet.CONTEXT_MENU_DROPDOWN__DELETE))
  }))), contextMenu && /*#__PURE__*/React__default__default.createElement(OpenChannelMobileMenu, {
    message: message,
    parentRef: mobileMenuRef,
    hideMenu: () => {
      setContextMenu(false);
    },
    showRemove: () => {
      setContextMenu(false);
      showRemove(true);
    },
    showEdit: () => {
      setContextMenu(false);
      showEdit(true);
    },
    copyToClipboard: () => {
      setContextMenu(false);
      copyToClipboard(message === null || message === void 0 ? void 0 : message.message);
    },
    resendMessage: () => {
      setContextMenu(false);
      resendMessage(message);
    }
  }));
}

function OpenChannelAdminMessage(_ref) {
  let {
    className,
    message
  } = _ref;
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-openchannel-admin-message'].join(' ')
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-admin-message__text",
    type: LabelTypography.CAPTION_2,
    color: LabelColors.ONBACKGROUND_2
  }, message.message || ''));
}

const checkOGIsEnalbed = message => {
  const {
    ogMetaData
  } = message;

  if (!ogMetaData) {
    return false;
  }

  const {
    url
  } = ogMetaData;

  if (!url) {
    return false;
  }

  return true;
};

function OpenchannelOGMessage(_ref) {
  var _message$ogMetaData, _message$updatedAt;

  let {
    message,
    isOperator,
    isEphemeral = false,
    className,
    disabled,
    showEdit,
    showRemove,
    resendMessage,
    chainTop,
    userId
  } = _ref;
  const status = message === null || message === void 0 ? void 0 : message.sendingStatus;
  const ogMetaData = (_message$ogMetaData = message.ogMetaData) !== null && _message$ogMetaData !== void 0 ? _message$ogMetaData : null;
  const defaultImage = ogMetaData === null || ogMetaData === void 0 ? void 0 : ogMetaData.defaultImage;
  const {
    stringSet,
    dateLocale
  } = useLocalization();
  const {
    isMobile
  } = useMediaQueryContext();
  const {
    disableUserProfile,
    renderUserProfile
  } = useContext(UserProfileContext);
  const [contextStyle, setContextStyle] = useState({});
  const [showContextMenu, setShowContextMenu] = useState(false);

  const openLink = () => {
    if (checkOGIsEnalbed(message) && ogMetaData !== null && ogMetaData !== void 0 && ogMetaData.url) {
      window.open(ogMetaData.url, '_blank', 'noopener,noreferrer');
    }
  };

  const onLongPress = useLongPress({
    onLongPress: () => setShowContextMenu(true),
    onClick: openLink
  }, {
    delay: 300
  });
  const messageComponentRef = useRef(null);
  const contextMenuRef = useRef(null);
  const mobileMenuRef = useRef(null);
  const avatarRef = useRef(null);
  const isPending = checkIsPending(status);
  const isFailed = checkIsFailed(status);
  const sender = getSenderFromMessage(message);
  const tokens = useMemo(() => {
    return tokenizeMessage({
      messageText: message.message
    });
  }, [message === null || message === void 0 ? void 0 : message.updatedAt]); // place conxt menu top depending clientHeight of message component

  useEffect(() => {
    var _messageComponentRef$;

    if ((messageComponentRef === null || messageComponentRef === void 0 ? void 0 : (_messageComponentRef$ = messageComponentRef.current) === null || _messageComponentRef$ === void 0 ? void 0 : _messageComponentRef$.clientHeight) > 36) {
      setContextStyle({
        top: '8px '
      });
    } else {
      setContextStyle({
        top: '2px'
      });
    }
  }, [window.innerWidth]);

  if (!message || message.messageType !== 'user') {
    return /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null);
  }

  return /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, /*#__PURE__*/React__default__default.createElement("div", _extends$X({
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-openchannel-og-message'].join(' '),
    ref: messageComponentRef
  }, isMobile ? _objectSpread2({}, onLongPress) : {}), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-og-message__top"
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-og-message__top__left"
  }, !chainTop && /*#__PURE__*/React__default__default.createElement(ContextMenu, {
    menuTrigger: toggleDropdown => /*#__PURE__*/React__default__default.createElement(Avatar$1, {
      className: "sendbird-openchannel-og-message__top__left__avatar",
      src: sender.profileUrl || '',
      ref: avatarRef,
      width: "28px",
      height: "28px",
      onClick: () => {
        if (!disableUserProfile) {
          toggleDropdown();
        }
      }
    }),
    menuItems: closeDropdown => /*#__PURE__*/React__default__default.createElement(MenuItems, {
      parentRef: avatarRef,
      parentContainRef: avatarRef,
      closeDropdown: closeDropdown,
      style: {
        paddingTop: '0px',
        paddingBottom: '0px'
      }
    }, renderUserProfile ? renderUserProfile({
      user: sender,
      close: closeDropdown
    }) : /*#__PURE__*/React__default__default.createElement(UserProfile, {
      user: sender,
      onSuccess: closeDropdown,
      disableMessaging: true
    }))
  })), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-og-message__top__right"
  }, !chainTop && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-og-message__top__right__title"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-og-message__top__right__title__sender-name",
    type: LabelTypography.CAPTION_2,
    color: isOperator ? LabelColors.SECONDARY_3 : LabelColors.ONBACKGROUND_2
  }, sender && (sender.friendName || sender.nickname || sender.userId)), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-og-message__top__right__title__sent-at",
    type: LabelTypography.CAPTION_3,
    color: LabelColors.ONBACKGROUND_3
  }, (message === null || message === void 0 ? void 0 : message.createdAt) && format$1(message === null || message === void 0 ? void 0 : message.createdAt, 'p', {
    locale: dateLocale
  }))), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-og-message__top__right__description"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-og-message__top__right__description__message",
    type: LabelTypography.BODY_1,
    color: LabelColors.ONBACKGROUND_1
  }, /*#__PURE__*/React__default__default.createElement(TextFragment, {
    tokens: tokens
  }), ((_message$updatedAt = message === null || message === void 0 ? void 0 : message.updatedAt) !== null && _message$updatedAt !== void 0 ? _message$updatedAt : 0) > 0 && /*#__PURE__*/React__default__default.createElement(Label, {
    key: uuidv4(),
    className: "sendbird-openchannel-og-message--word",
    type: LabelTypography.BODY_1,
    color: LabelColors.ONBACKGROUND_2
  }, stringSet.MESSAGE_EDITED)))), !isMobile && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-og-message__top__context-menu",
    ref: contextMenuRef,
    style: contextStyle
  }, /*#__PURE__*/React__default__default.createElement(ContextMenu, {
    menuTrigger: toggleDropdown => showMenuTrigger({
      message: message,
      userId: userId,
      status: status
    }) && /*#__PURE__*/React__default__default.createElement(IconButton, {
      className: "sendbird-openchannel-og-message__top__context-menu--icon",
      width: "32px",
      height: "32px",
      onClick: () => {
        toggleDropdown();
      }
    }, /*#__PURE__*/React__default__default.createElement(Icon, {
      type: IconTypes.MORE,
      fillColor: IconColors.CONTENT_INVERSE,
      width: "24px",
      height: "24px"
    })),
    menuItems: closeDropdown => /*#__PURE__*/React__default__default.createElement(MenuItems, {
      parentRef: contextMenuRef,
      parentContainRef: contextMenuRef,
      closeDropdown: closeDropdown,
      openLeft: true
    }, isFineCopy({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      className: "sendbird-openchannel-og-message__top__context-menu__copy",
      onClick: () => {
        copyToClipboard(message.message);
        closeDropdown();
      },
      dataSbId: "open_channel_og_message_menu_copy"
    }, stringSet.CONTEXT_MENU_DROPDOWN__COPY), !isEphemeral && isFineEdit({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      className: "sendbird-openchannel-og-message__top__context-menu__edit",
      onClick: () => {
        if (disabled) {
          return;
        }

        showEdit(true);
        closeDropdown();
      },
      dataSbId: "open_channel_og_message_menu_edit"
    }, stringSet.CONTEXT_MENU_DROPDOWN__EDIT), isFineResend({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      className: "sendbird-openchannel-og-message__top__context-menu__resend",
      onClick: () => {
        resendMessage(message);
        closeDropdown();
      },
      dataSbId: "open_channel_og_message_menu_resend"
    }, stringSet.CONTEXT_MENU_DROPDOWN__RESEND), !isEphemeral && isFineDelete({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      className: "sendbird-openchannel-og-message__top__context-menu__delete",
      onClick: () => {
        if (disabled) {
          return;
        }

        showRemove(true);
        closeDropdown();
      },
      dataSbId: "open_channel_og_message_menu_delete"
    }, stringSet.CONTEXT_MENU_DROPDOWN__DELETE))
  }))), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-og-message__bottom"
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-og-message__bottom__og-tag",
    ref: mobileMenuRef
  }, ogMetaData.url && /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-og-message__bottom__og-tag__url",
    type: LabelTypography.CAPTION_3,
    color: LabelColors.ONBACKGROUND_2
  }, ogMetaData.url), ogMetaData.title && /*#__PURE__*/React__default__default.createElement(LinkLabel, {
    className: "sendbird-openchannel-og-message__bottom__og-tag__title",
    src: ogMetaData.url,
    type: LabelTypography.SUBTITLE_2,
    color: LabelColors.PRIMARY
  }, ogMetaData.title), ogMetaData.description && /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-og-message__bottom__og-tag__description",
    type: LabelTypography.BODY_2,
    color: LabelColors.ONBACKGROUND_1
  }, ogMetaData.description), ogMetaData.url && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-og-message__bottom__og-tag__thumbnail",
    role: "button",
    onClick: openLink,
    onKeyDown: openLink,
    tabIndex: 0
  }, defaultImage && /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
    className: "sendbird-openchannel-og-message__bottom__og-tag__thumbnail__image",
    url: defaultImage.url || '',
    alt: defaultImage.alt || '',
    height: "189px",
    defaultComponent: /*#__PURE__*/React__default__default.createElement("div", {
      className: "sendbird-openchannel-og-message__bottom__og-tag__thumbnail__image--placeholder"
    }, /*#__PURE__*/React__default__default.createElement(Icon, {
      type: IconTypes.THUMBNAIL_NONE,
      width: "56px",
      height: "56px"
    }))
  }))), (isPending || isFailed) && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-og-message__top__right__tail"
  }, isPending && /*#__PURE__*/React__default__default.createElement(Loader, {
    width: "16px",
    height: "16px"
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-openchannel-og-message__top__right__tail__pending",
    type: IconTypes.SPINNER,
    fillColor: IconColors.PRIMARY,
    width: "16px",
    height: "16px"
  })), isFailed && /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-openchannel-og-message__top__right__tail__failed",
    type: IconTypes.ERROR,
    fillColor: IconColors.ERROR,
    width: "16px",
    height: "16px"
  })))), showContextMenu && /*#__PURE__*/React__default__default.createElement(OpenChannelMobileMenu, {
    message: message,
    parentRef: mobileMenuRef,
    hideMenu: () => {
      setShowContextMenu(false);
    },
    showRemove: () => {
      setShowContextMenu(false);
      showRemove(true);
    },
    showEdit: () => {
      setShowContextMenu(false);
      showEdit(true);
    },
    copyToClipboard: () => {
      setShowContextMenu(false);
      copyToClipboard(message === null || message === void 0 ? void 0 : message.message);
    },
    resendMessage: () => {
      setShowContextMenu(false);
      resendMessage(message);
    }
  }));
}

const SUPPORTING_TYPES = {
  IMAGE: 'IMAGE',
  VIDEO: 'VIDEO',
  UNSUPPORTED: 'UNSUPPORTED'
};
const SUPPORTED_MIMES$1 = {
  IMAGE: ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp'],
  VIDEO: ['video/mpeg', 'video/ogg', 'video/webm', 'video/mp4']
};

const getSupportingFileType = type => {
  if (SUPPORTED_MIMES$1.IMAGE.indexOf(type) >= 0) {
    return SUPPORTING_TYPES.IMAGE;
  }

  if (SUPPORTED_MIMES$1.VIDEO.indexOf(type) >= 0) {
    return SUPPORTING_TYPES.VIDEO;
  }

  return SUPPORTING_TYPES.UNSUPPORTED;
};

function OpenchannelThumbnailMessage(_ref) {
  let {
    className,
    message,
    isOperator,
    isEphemeral = false,
    disabled,
    userId,
    chainTop,
    onClick,
    showRemove,
    resendMessage
  } = _ref;
  const {
    type,
    url,
    thumbnails,
    localUrl
  } = message;
  const status = message === null || message === void 0 ? void 0 : message.sendingStatus;
  const thumbnailUrl = thumbnails && thumbnails.length > 0 && thumbnails[0].url || null;
  const {
    stringSet,
    dateLocale
  } = useLocalization();
  const {
    disableUserProfile,
    renderUserProfile
  } = useContext(UserProfileContext);
  const [messageWidth, setMessageWidth] = useState(360);
  const [contextMenu, setContextMenu] = useState(false);
  const messageRef = useRef(null);
  const mobileMenuRef = useRef(null);
  const contextMenuRef = useRef(null);
  const avatarRef = useRef(null);
  const onLongPress = useLongPress({
    onLongPress: () => {
      setContextMenu(true);
    },
    onClick: () => {
      onClick(true);
    }
  });
  const {
    isMobile
  } = useMediaQueryContext();
  const memorizedThumbnailPlaceHolder = useMemo(() => type => _ref2 => {
    let {
      style
    } = _ref2;
    return (
      /*#__PURE__*/
      // eslint-disable-line
      React__default__default.createElement("div", {
        style: style
      }, /*#__PURE__*/React__default__default.createElement(Icon, {
        type: type,
        fillColor: IconColors.ON_BACKGROUND_2,
        width: "56px",
        height: "56px"
      }))
    );
  }, []);
  const isMessageSent = checkIsSent(status);
  const isPending = checkIsPending(status);
  const isFailed = checkIsFailed(status);
  const sender = getSenderFromMessage(message);
  useEffect(() => {
    var _messageRef$current$c, _messageRef$current;

    const thumbnailWidth = ((_messageRef$current$c = messageRef === null || messageRef === void 0 ? void 0 : (_messageRef$current = messageRef.current) === null || _messageRef$current === void 0 ? void 0 : _messageRef$current.clientWidth) !== null && _messageRef$current$c !== void 0 ? _messageRef$current$c : 0) - 80;
    setMessageWidth(thumbnailWidth > 360 ? 360 : thumbnailWidth);
  }, []);
  return /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-openchannel-thumbnail-message'].join(' '),
    ref: messageRef
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-thumbnail-message__left"
  }, !chainTop && /*#__PURE__*/React__default__default.createElement(ContextMenu, {
    menuTrigger: toggleDropdown => /*#__PURE__*/React__default__default.createElement(Avatar$1, {
      className: "sendbird-openchannel-thumbnail-message__left__avatar",
      src: sender.profileUrl || '',
      ref: avatarRef,
      width: "28px",
      height: "28px",
      onClick: () => {
        if (!disableUserProfile) {
          toggleDropdown();
        }
      }
    }),
    menuItems: closeDropdown => /*#__PURE__*/React__default__default.createElement(MenuItems, {
      parentRef: avatarRef,
      parentContainRef: avatarRef,
      closeDropdown: closeDropdown,
      style: {
        paddingTop: '0px',
        paddingBottom: '0px'
      }
    }, renderUserProfile ? renderUserProfile({
      user: sender,
      close: closeDropdown
    }) : /*#__PURE__*/React__default__default.createElement(UserProfile, {
      user: sender,
      onSuccess: closeDropdown,
      disableMessaging: true
    }))
  })), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-thumbnail-message__right"
  }, !chainTop && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-thumbnail-message__right__title"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-thumbnail-message__right__title__sender-name",
    type: LabelTypography.CAPTION_2,
    color: isOperator ? LabelColors.SECONDARY_3 : LabelColors.ONBACKGROUND_2
  }, sender && (sender.friendName || sender.nickname || sender.userId)), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-thumbnail-message__right__title__sent-at",
    type: LabelTypography.CAPTION_3,
    color: LabelColors.ONBACKGROUND_3
  }, (message === null || message === void 0 ? void 0 : message.createdAt) && format$1(message.createdAt, 'p', {
    locale: dateLocale
  }))), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-thumbnail-message__right__body",
    ref: mobileMenuRef
  }, /*#__PURE__*/React__default__default.createElement("div", _extends$X({
    className: "sendbird-openchannel-thumbnail-message__right__body__wrap",
    role: "button",
    onClick: () => {
      if (isMessageSent) {
        onClick(true);
      }
    },
    onKeyDown: () => {
      if (isMessageSent) {
        onClick(true);
      }
    },
    tabIndex: 0
  }, isMobile ? _objectSpread2({}, onLongPress) : {}), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-thumbnail-message__right__body__wrap__overlay"
  }), {
    [SUPPORTING_TYPES.VIDEO]: url || localUrl ? /*#__PURE__*/React__default__default.createElement("div", {
      className: "sendbird-openchannel-thumbnail-message__right__body__wrap__video"
    }, thumbnailUrl ? /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
      className: "sendbird-openchannel-thumbnail-message__right__body__wrap__video",
      url: thumbnailUrl,
      width: messageWidth,
      height: "270px",
      alt: "image",
      placeHolder: memorizedThumbnailPlaceHolder(IconTypes.PLAY)
    }) : /*#__PURE__*/React__default__default.createElement("video", {
      className: "sendbird-openchannel-thumbnail-message__right__body__wrap__video__video"
    }, /*#__PURE__*/React__default__default.createElement("source", {
      src: url || localUrl,
      type: type
    })), /*#__PURE__*/React__default__default.createElement(Icon, {
      className: "sendbird-openchannel-thumbnail-message__right__body__wrap__video__icon",
      type: IconTypes.PLAY,
      fillColor: IconColors.ON_BACKGROUND_2,
      width: "56px",
      height: "56px"
    })) : /*#__PURE__*/React__default__default.createElement(Icon, {
      className: "sendbird-openchannel-thumbnail-message__right__body__wrap__video--icon",
      type: IconTypes.PHOTO,
      fillColor: IconColors.ON_BACKGROUND_2,
      width: "56px",
      height: "56px"
    }),
    [SUPPORTING_TYPES.IMAGE]: url || localUrl ? /*#__PURE__*/React__default__default.createElement(ImageRenderer, {
      className: "sendbird-openchannel-thumbnail-message__right__body__wrap__image",
      url: thumbnailUrl || url || localUrl,
      alt: "image",
      width: messageWidth,
      height: "270px",
      placeHolder: memorizedThumbnailPlaceHolder(IconTypes.PHOTO)
    }) : /*#__PURE__*/React__default__default.createElement(Icon, {
      className: "sendbird-openchannel-thumbnail-message__right__body__wrap__image--icon",
      type: IconTypes.PHOTO,
      fillColor: IconColors.ON_BACKGROUND_2,
      width: "56px",
      height: "56px"
    }),
    [SUPPORTING_TYPES.UNSUPPORTED]: /*#__PURE__*/React__default__default.createElement(Icon, {
      className: "sendbird-openchannel-thumbnail-message__right__body__wrap__unknown",
      type: IconTypes.PHOTO,
      fillColor: IconColors.ON_BACKGROUND_2,
      width: "56px",
      height: "56px"
    })
  }[getSupportingFileType(type)])), (isPending || isFailed) && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-thumbnail-message__right__tail"
  }, isPending && /*#__PURE__*/React__default__default.createElement(Loader, {
    width: "16px",
    height: "16px"
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-openchannel-thumbnail-message__right__tail__pending",
    type: IconTypes.SPINNER,
    fillColor: IconColors.PRIMARY,
    width: "16px",
    height: "16px"
  })), isFailed && /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-openchannel-thumbnail-message__right__tail__failed",
    type: IconTypes.ERROR,
    fillColor: IconColors.ERROR,
    width: "16px",
    height: "16px"
  }))), !isMobile && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-thumbnail-message__context-menu",
    ref: contextMenuRef
  }, (isFineResend({
    message,
    userId,
    status
  }) || !isEphemeral) && /*#__PURE__*/React__default__default.createElement(ContextMenu, {
    menuTrigger: toggleDropdown => showMenuTrigger({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(IconButton, {
      className: "sendbird-openchannel-thumbnail-message__context-menu--icon",
      width: "32px",
      height: "32px",
      onClick: toggleDropdown
    }, /*#__PURE__*/React__default__default.createElement(Icon, {
      type: IconTypes.MORE,
      fillColor: IconColors.CONTENT_INVERSE,
      width: "24px",
      height: "24px"
    })),
    menuItems: closeDropdown => /*#__PURE__*/React__default__default.createElement(MenuItems, {
      parentRef: contextMenuRef,
      parentContainRef: contextMenuRef,
      closeDropdown: closeDropdown,
      openLeft: true
    }, isFineResend({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      onClick: () => {
        resendMessage(message);
        closeDropdown();
      },
      dataSbId: "open_channel_thumbnail_message_menu_resend"
    }, stringSet.CONTEXT_MENU_DROPDOWN__RESEND), !isEphemeral && isFineDelete({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      onClick: () => {
        if (disabled) {
          return;
        }

        showRemove(true);
        closeDropdown();
      },
      dataSbId: "open_channel_thumbnail_message_menu_delete"
    }, stringSet.CONTEXT_MENU_DROPDOWN__DELETE))
  }))), contextMenu && /*#__PURE__*/React__default__default.createElement(OpenChannelMobileMenu, {
    message: message,
    parentRef: mobileMenuRef,
    hideMenu: () => {
      setContextMenu(false);
    },
    showRemove: () => {
      setContextMenu(false);
      showRemove(true);
    },
    resendMessage: () => {
      setContextMenu(false);
      resendMessage(message);
    }
  }));
}

const checkFileType = fileUrl => {
  const audioFile = /(\.mp3)$/i;
  const gifFile = /(\.gif)$/i;

  if (audioFile.test(fileUrl)) {
    return IconTypes.FILE_AUDIO;
  }

  if (gifFile.test(fileUrl)) {
    return IconTypes.GIF;
  }

  return IconTypes.FILE_DOCUMENT;
};

const truncate = (fullStr, strLen) => {
  if (fullStr === null || fullStr === undefined) return '';
  if (fullStr.length <= strLen) return fullStr;
  const separator = '...';
  const sepLen = separator.length;
  const charsToShow = strLen - sepLen;
  const frontChars = Math.ceil(charsToShow / 2);
  const backChars = Math.floor(charsToShow / 2);
  return fullStr.substr(0, frontChars) + separator + fullStr.substr(fullStr.length - backChars);
};

function OpenchannelFileMessage(_ref) {
  let {
    className,
    message,
    isOperator,
    isEphemeral = false,
    userId,
    disabled,
    chainTop,
    showRemove,
    resendMessage
  } = _ref;
  const status = message === null || message === void 0 ? void 0 : message.sendingStatus;
  const {
    dateLocale,
    stringSet
  } = useLocalization();
  const contextMenuRef = useRef(null);
  const mobileMenuRef = useRef(null);
  const avatarRef = useRef(null);
  const {
    disableUserProfile,
    renderUserProfile
  } = useContext(UserProfileContext);
  const {
    isMobile
  } = useMediaQueryContext();

  const openFileUrl = () => {
    window.open(message.url);
  };

  const isPending = checkIsPending(status);
  const isFailed = checkIsFailed(status);
  const sender = getSenderFromMessage(message);
  const [contextMenu, setContextMenu] = useState(false);
  const longPress = useLongPress({
    onLongPress: () => {
      if (isMobile) {
        setContextMenu(true);
      }
    },
    onClick: openFileUrl
  }, {
    delay: 300
  });
  return /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, /*#__PURE__*/React__default__default.createElement("div", {
    className: [...(Array.isArray(className) ? className : [className]), 'sendbird-openchannel-file-message'].join(' '),
    ref: mobileMenuRef
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-file-message__left"
  }, !chainTop && /*#__PURE__*/React__default__default.createElement(ContextMenu, {
    menuTrigger: toggleDropdown => /*#__PURE__*/React__default__default.createElement(Avatar$1, {
      className: "sendbird-openchannel-file-message__left__avatar",
      src: sender.profileUrl || '',
      ref: avatarRef,
      width: "28px",
      height: "28px",
      onClick: () => {
        if (!disableUserProfile) {
          toggleDropdown();
        }
      }
    }),
    menuItems: closeDropdown => /*#__PURE__*/React__default__default.createElement(MenuItems, {
      parentRef: avatarRef,
      parentContainRef: avatarRef,
      closeDropdown: closeDropdown,
      style: {
        paddingTop: '0px',
        paddingBottom: '0px'
      }
    }, renderUserProfile ? renderUserProfile({
      user: sender,
      close: closeDropdown
    }) : /*#__PURE__*/React__default__default.createElement(UserProfile, {
      user: sender,
      onSuccess: closeDropdown,
      disableMessaging: true
    }))
  })), /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-file-message__right"
  }, !chainTop && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-file-message__right__title"
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-file-message__right__title__sender-name",
    type: LabelTypography.CAPTION_2,
    color: isOperator ? LabelColors.SECONDARY_3 : LabelColors.ONBACKGROUND_2
  }, sender && (sender.friendName || sender.nickname || sender.userId)), /*#__PURE__*/React__default__default.createElement(Label, {
    className: "sendbird-openchannel-file-message__right__title__sent-at",
    type: LabelTypography.CAPTION_3,
    color: LabelColors.ONBACKGROUND_3
  }, (message === null || message === void 0 ? void 0 : message.createdAt) && format$1(message.createdAt, 'p', {
    locale: dateLocale
  }))), /*#__PURE__*/React__default__default.createElement("div", _extends$X({
    className: "sendbird-openchannel-file-message__right__body"
  }, isMobile ? _objectSpread2({}, longPress) : {}), checkFileType(message.url) && /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-openchannel-file-message__right__body__icon",
    type: checkFileType(message.url),
    fillColor: IconColors.PRIMARY,
    width: "48px",
    height: "48px"
  }), /*#__PURE__*/React__default__default.createElement(TextButton, {
    className: "sendbird-openchannel-file-message__right__body__file-name",
    onClick: openFileUrl
  }, /*#__PURE__*/React__default__default.createElement(Label, {
    type: LabelTypography.BODY_1,
    color: LabelColors.ONBACKGROUND_1
  }, truncate(message.name || message.url, 40)))), (isPending || isFailed) && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-file-message__right__tail"
  }, isPending && /*#__PURE__*/React__default__default.createElement(Loader, {
    width: "16px",
    height: "16px"
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-openchannel-file-message__right__tail__pending",
    type: IconTypes.SPINNER,
    fillColor: IconColors.PRIMARY,
    width: "16px",
    height: "16px"
  })), isFailed && /*#__PURE__*/React__default__default.createElement(Icon, {
    className: "sendbird-openchannel-file-message__right__tail__failed",
    type: IconTypes.ERROR,
    fillColor: IconColors.ERROR,
    width: "16px",
    height: "16px"
  }))), !isMobile && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-file-message__context-menu",
    ref: contextMenuRef
  }, (isFineResend({
    message,
    userId,
    status
  }) || !isEphemeral) && /*#__PURE__*/React__default__default.createElement(ContextMenu, {
    menuTrigger: toggleDropdown => showMenuTrigger({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(IconButton, {
      className: "sendbird-openchannel-file-message__context-menu__icon",
      width: "32px",
      height: "32px",
      onClick: toggleDropdown
    }, /*#__PURE__*/React__default__default.createElement(Icon, {
      type: IconTypes.MORE,
      width: "24px",
      height: "24px"
    })),
    menuItems: closeDropdown => /*#__PURE__*/React__default__default.createElement(MenuItems, {
      parentRef: contextMenuRef,
      parentContainRef: contextMenuRef,
      closeDropdown: closeDropdown,
      openLeft: true
    }, isFineResend({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      onClick: () => {
        if (disabled) {
          return;
        }

        resendMessage(message);
        closeDropdown();
      },
      dataSbId: "open_channel_file_message_context_menu_resend"
    }, stringSet.CONTEXT_MENU_DROPDOWN__RESEND), !isEphemeral && isFineDelete({
      message,
      userId,
      status
    }) && /*#__PURE__*/React__default__default.createElement(MenuItem, {
      onClick: () => {
        if (disabled) {
          return;
        }

        showRemove(true);
        closeDropdown();
      },
      dataSbId: "open_channel_file_message_context_menu_delete"
    }, stringSet.CONTEXT_MENU_DROPDOWN__DELETE))
  }))), contextMenu && /*#__PURE__*/React__default__default.createElement(OpenChannelMobileMenu, {
    message: message,
    hideMenu: () => {
      setContextMenu(false);
    },
    parentRef: mobileMenuRef,
    showRemove: () => {
      setContextMenu(false);
      showRemove(true);
    }
  }));
}

function RemoveMessageModal(_ref) {
  let {
    onCloseModal,
    onDeleteMessage
  } = _ref;
  const {
    stringSet
  } = useContext(LocalizationContext);
  return /*#__PURE__*/React__default__default.createElement(Modal, {
    onCancel: onCloseModal,
    onSubmit: onDeleteMessage,
    submitText: stringSet.MESSAGE_MENU__DELETE,
    titleText: stringSet.MODAL__DELETE_MESSAGE__TITLE
  });
} // https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Complete_list_of_MIME_types


const SUPPORTED_MIMES = {
  IMAGE: ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/svg+xml', 'image/webp'],
  VIDEO: ['video/mpeg', 'video/ogg', 'video/webm', 'video/mp4']
};

const isImage = type => SUPPORTED_MIMES.IMAGE.indexOf(type) >= 0;

const isVideo = type => SUPPORTED_MIMES.VIDEO.indexOf(type) >= 0;

_objectSpread2({}, SUPPORTED_MIMES);

const MessageTypes = {
  ADMIN: 'ADMIN',
  USER: 'USER',
  FILE: 'FILE',
  THUMBNAIL: 'THUMBNAIL',
  OG: 'OG',
  UNKNOWN: 'UNKNOWN'
};
const SendingMessageStatus = {
  NONE: 'none',
  SUCCEEDED: 'succeeded',
  FAILED: 'failed',
  PENDING: 'pending'
};

const getMessageType = (message, options) => {
  var _message$isUserMessag, _message$isAdminMessa;

  const isOgMessageEnabledInOpenChannel = options === null || options === void 0 ? void 0 : options.isOgMessageEnabledInOpenChannel;

  if (message !== null && message !== void 0 && (_message$isUserMessag = message.isUserMessage) !== null && _message$isUserMessag !== void 0 && _message$isUserMessag.call(message) || (message === null || message === void 0 ? void 0 : message.messageType) === 'user') {
    return message !== null && message !== void 0 && message.ogMetaData && isOgMessageEnabledInOpenChannel ? MessageTypes.OG : MessageTypes.USER;
  }

  if (message !== null && message !== void 0 && (_message$isAdminMessa = message.isAdminMessage) !== null && _message$isAdminMessa !== void 0 && _message$isAdminMessa.call(message)) {
    return MessageTypes.ADMIN;
  }

  if ((message === null || message === void 0 ? void 0 : message.messageType) === 'file') {
    return isImage(message.type) || isVideo(message.type) ? MessageTypes.THUMBNAIL : MessageTypes.FILE;
  }

  return MessageTypes.UNKNOWN;
};

function MessagOpenChannelMessageeHoc(props) {
  var _globalState$config;

  const {
    message,
    chainTop,
    chainBottom,
    hasSeparator,
    renderMessage
  } = props;
  const {
    currentOpenChannel,
    deleteMessage,
    updateMessage,
    resendMessage
  } = useOpenChannelContext();
  const {
    dateLocale
  } = useLocalization();
  const editDisabled = currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.isFrozen;
  const globalState = useSendbirdStateContext();
  const userId = globalState === null || globalState === void 0 ? void 0 : (_globalState$config = globalState.config) === null || _globalState$config === void 0 ? void 0 : _globalState$config.userId;
  const isOgMessageEnabledInOpenChannel = globalState.config.openChannel.enableOgtag;
  let sender = null;

  if ((message === null || message === void 0 ? void 0 : message.messageType) !== 'admin') {
    sender = message === null || message === void 0 ? void 0 : message.sender;
  }

  const RenderedMessage = useMemo(() => props => {
    return /*#__PURE__*/React__default__default.createElement(React__default__default.Fragment, null, renderMessage ? renderMessage(props) : null);
  }, [message, renderMessage]);
  const [showEdit, setShowEdit] = useState(false);
  const [showRemove, setShowRemove] = useState(false);
  const [showFileViewer, setShowFileViewer] = useState(false);
  const editMessageInputRef = useRef(null);
  let isByMe = false;

  if (sender && (message === null || message === void 0 ? void 0 : message.messageType) !== 'admin') {
    // pending and failed messages are by me
    isByMe = userId === sender.userId || (message === null || message === void 0 ? void 0 : message.sendingStatus) === SendingMessageStatus.PENDING || (message === null || message === void 0 ? void 0 : message.sendingStatus) === SendingMessageStatus.FAILED;
  }

  if (renderMessage && RenderedMessage) {
    return /*#__PURE__*/React__default__default.createElement("div", {
      className: "sendbird-msg-hoc sendbird-msg--scroll-ref"
    }, /*#__PURE__*/React__default__default.createElement(RenderedMessage, {
      message: message,
      chainTop: chainTop,
      chainBottom: chainBottom
    }));
  }

  if ((message === null || message === void 0 ? void 0 : message.messageType) === 'user' && showEdit) {
    return /*#__PURE__*/React__default__default.createElement(MessageInput, {
      isEdit: true,
      channel: currentOpenChannel,
      disabled: editDisabled,
      ref: editMessageInputRef,
      message: message,
      name: message === null || message === void 0 ? void 0 : message.messageId,
      onUpdateMessage: _ref => {
        let {
          messageId,
          message
        } = _ref;
        updateMessage(messageId, message);
        setShowEdit(false);
      },
      onCancelEdit: () => {
        setShowEdit(false);
      }
    });
  }

  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-msg-hoc sendbird-msg--scroll-ref"
  }, hasSeparator && (message === null || message === void 0 ? void 0 : message.createdAt) && /*#__PURE__*/React__default__default.createElement(DateSeparator, null, /*#__PURE__*/React__default__default.createElement(Label, {
    type: LabelTypography.CAPTION_2,
    color: LabelColors.ONBACKGROUND_2
  }, format$1(message === null || message === void 0 ? void 0 : message.createdAt, 'MMMM dd, yyyy', {
    locale: dateLocale
  }))), {
    [MessageTypes.ADMIN]: (() => {
      if ((message === null || message === void 0 ? void 0 : message.messageType) === 'admin') {
        return /*#__PURE__*/React__default__default.createElement(OpenChannelAdminMessage, {
          message: message
        });
      }
    })(),
    [MessageTypes.FILE]: (() => {
      if ((message === null || message === void 0 ? void 0 : message.messageType) === 'file') {
        var _sender;

        return /*#__PURE__*/React__default__default.createElement(OpenchannelFileMessage, {
          message: message,
          isOperator: currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.isOperator(message === null || message === void 0 ? void 0 : (_sender = message.sender) === null || _sender === void 0 ? void 0 : _sender.userId),
          isEphemeral: currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.isEphemeral,
          disabled: editDisabled,
          userId: userId,
          showRemove: setShowRemove,
          resendMessage: resendMessage,
          chainTop: chainTop,
          chainBottom: chainBottom
        });
      }
    })(),
    [MessageTypes.OG]: (() => {
      if ((message === null || message === void 0 ? void 0 : message.messageType) === 'user' && isOgMessageEnabledInOpenChannel) {
        var _sender2;

        return /*#__PURE__*/React__default__default.createElement(OpenchannelOGMessage, {
          message: message,
          isOperator: currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.isOperator(message === null || message === void 0 ? void 0 : (_sender2 = message.sender) === null || _sender2 === void 0 ? void 0 : _sender2.userId),
          isEphemeral: currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.isEphemeral,
          userId: userId,
          showEdit: setShowEdit,
          disabled: editDisabled,
          showRemove: setShowRemove,
          resendMessage: resendMessage,
          chainTop: chainTop,
          chainBottom: chainBottom
        });
      }
    })(),
    [MessageTypes.THUMBNAIL]: (() => {
      if ((message === null || message === void 0 ? void 0 : message.messageType) === 'file') {
        var _sender3;

        return /*#__PURE__*/React__default__default.createElement(OpenchannelThumbnailMessage, {
          message: message,
          isOperator: currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.isOperator(message === null || message === void 0 ? void 0 : (_sender3 = message.sender) === null || _sender3 === void 0 ? void 0 : _sender3.userId),
          isEphemeral: currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.isEphemeral,
          disabled: editDisabled,
          userId: userId,
          showRemove: setShowRemove,
          resendMessage: resendMessage,
          onClick: setShowFileViewer,
          chainTop: chainTop,
          chainBottom: chainBottom
        });
      }
    })(),
    [MessageTypes.USER]: (() => {
      if ((message === null || message === void 0 ? void 0 : message.messageType) === 'user') {
        var _sender4;

        return /*#__PURE__*/React__default__default.createElement(OpenchannelUserMessage, {
          message: message,
          isOperator: currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.isOperator(message === null || message === void 0 ? void 0 : (_sender4 = message.sender) === null || _sender4 === void 0 ? void 0 : _sender4.userId),
          isEphemeral: currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.isEphemeral,
          userId: userId,
          disabled: editDisabled,
          showEdit: setShowEdit,
          showRemove: setShowRemove,
          resendMessage: resendMessage,
          chainTop: chainTop,
          chainBottom: chainBottom
        });
      }
    })(),
    [MessageTypes.UNKNOWN]: (() => {// return (
      //   <OpenChannelUnknownMessage message={message} />
      // );
    })()
  }[getMessageType(message, {
    isOgMessageEnabledInOpenChannel
  })], showRemove && /*#__PURE__*/React__default__default.createElement(RemoveMessageModal, {
    onCloseModal: () => setShowRemove(false),
    onDeleteMessage: () => {
      if ((message === null || message === void 0 ? void 0 : message.messageType) !== 'admin') {
        deleteMessage(message);
      }
    }
  }), showFileViewer && (message === null || message === void 0 ? void 0 : message.messageType) === 'file' && /*#__PURE__*/React__default__default.createElement(FileViewer, {
    onClose: () => setShowFileViewer(false),
    message: message,
    onDelete: () => deleteMessage(message),
    isByMe: isByMe
  }));
}

function OpenchannelMessageList(props, ref) {
  const {
    isMessageGroupingEnabled = true,
    allMessages,
    hasMore,
    onScroll
  } = useOpenChannelContext();
  const store = useSendbirdStateContext();
  const userId = store.config.userId;
  const scrollRef = ref || useRef(null);
  const [showScrollDownButton, setShowScrollDownButton] = useState(false);

  const scrollToBottom = () => {
    if (scrollRef && scrollRef.current) {
      scrollRef.current.scrollTo(0, scrollRef.current.scrollHeight);
      setShowScrollDownButton(false);
    }
  };

  const handleOnScroll = useHandleOnScrollCallback({
    setShowScrollDownButton,
    hasMore,
    onScroll,
    scrollRef
  });
  const memoizedMessageList = useMemo(() => {
    var _props$renderPlaceHol;

    if (allMessages.length > 0) {
      return allMessages.map((message, index) => {
        var _sender;

        const previousMessage = allMessages[index - 1];
        const nextMessage = allMessages[index - 1];
        const previousMessageCreatedAt = previousMessage && previousMessage.createdAt;
        const currentCreatedAt = message === null || message === void 0 ? void 0 : message.createdAt; // https://stackoverflow.com/a/41855608

        const hasSeparator = !(previousMessageCreatedAt && isSameDay(currentCreatedAt, previousMessageCreatedAt));
        const [chainTop, chainBottom] = isMessageGroupingEnabled ? compareMessagesForGrouping(previousMessage, message, nextMessage) : [false, false];
        const isByMe = (message === null || message === void 0 ? void 0 : (_sender = message.sender) === null || _sender === void 0 ? void 0 : _sender.userId) === userId;
        const key = (message === null || message === void 0 ? void 0 : message.messageId) || (message === null || message === void 0 ? void 0 : message.reqId);
        return /*#__PURE__*/React__default__default.createElement(MessageProvider, {
          message: message,
          isByMe: isByMe,
          key: key
        }, /*#__PURE__*/React__default__default.createElement(MessagOpenChannelMessageeHoc, {
          message: message,
          chainTop: chainTop,
          chainBottom: chainBottom,
          hasSeparator: hasSeparator,
          renderMessage: props === null || props === void 0 ? void 0 : props.renderMessage
        }));
      });
    }

    return (props === null || props === void 0 ? void 0 : (_props$renderPlaceHol = props.renderPlaceHolderEmptyList) === null || _props$renderPlaceHol === void 0 ? void 0 : _props$renderPlaceHol.call(props)) || /*#__PURE__*/React__default__default.createElement(PlaceHolder, {
      className: "sendbird-openchannel-conversation-scroll__container__place-holder",
      type: PlaceHolderTypes.NO_MESSAGES
    });
  }, [allMessages]);
  return /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-conversation-scroll"
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-conversation-scroll__container"
  }, /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-conversation-scroll__container__padding"
  }), /*#__PURE__*/React__default__default.createElement("div", {
    className: ['sendbird-openchannel-conversation-scroll__container__item-container', allMessages.length > 0 ? '' : 'no-messages'].join(' '),
    onScroll: handleOnScroll,
    ref: scrollRef
  }, memoizedMessageList)), showScrollDownButton && /*#__PURE__*/React__default__default.createElement("div", {
    className: "sendbird-openchannel-conversation-scroll__container__scroll-bottom-button",
    onClick: scrollToBottom,
    onKeyDown: scrollToBottom,
    tabIndex: 0,
    role: "button"
  }, /*#__PURE__*/React__default__default.createElement(Icon, {
    width: "24px",
    height: "24px",
    type: IconTypes.CHEVRON_DOWN,
    fillColor: IconColors.CONTENT
  })));
}

var OpenChannelMessageList = /*#__PURE__*/React__default__default.forwardRef(OpenchannelMessageList);

const COMPONENT_CLASS_NAME = 'sendbird-openchannel-conversation';

const OpenChannelUI = _ref => {
  let {
    renderMessage,
    renderHeader,
    renderInput,
    renderPlaceHolderEmptyList,
    renderPlaceHolderError,
    renderPlaceHolderLoading
  } = _ref;
  const {
    currentOpenChannel,
    amIBanned,
    loading,
    isInvalid,
    messageInputRef,
    conversationScrollRef
  } = useOpenChannelContext();

  if (!currentOpenChannel || !(currentOpenChannel !== null && currentOpenChannel !== void 0 && currentOpenChannel.url) || amIBanned) {
    return (renderPlaceHolderError === null || renderPlaceHolderError === void 0 ? void 0 : renderPlaceHolderError()) || /*#__PURE__*/React__default__default.createElement("div", {
      className: COMPONENT_CLASS_NAME
    }, /*#__PURE__*/React__default__default.createElement(PlaceHolder, {
      type: PlaceHolderTypes.NO_CHANNELS
    }));
  }

  if (loading) {
    return (renderPlaceHolderLoading === null || renderPlaceHolderLoading === void 0 ? void 0 : renderPlaceHolderLoading()) || /*#__PURE__*/React__default__default.createElement("div", {
      className: COMPONENT_CLASS_NAME
    }, /*#__PURE__*/React__default__default.createElement(PlaceHolder, {
      type: PlaceHolderTypes.LOADING
    }));
  }

  if (isInvalid) {
    return (renderPlaceHolderError === null || renderPlaceHolderError === void 0 ? void 0 : renderPlaceHolderError()) || /*#__PURE__*/React__default__default.createElement("div", {
      className: COMPONENT_CLASS_NAME
    }, /*#__PURE__*/React__default__default.createElement(PlaceHolder, {
      type: PlaceHolderTypes.WRONG
    }));
  }

  return /*#__PURE__*/React__default__default.createElement("div", {
    className: COMPONENT_CLASS_NAME
  }, (renderHeader === null || renderHeader === void 0 ? void 0 : renderHeader()) || /*#__PURE__*/React__default__default.createElement(OpenchannelConversationHeader, null), (currentOpenChannel === null || currentOpenChannel === void 0 ? void 0 : currentOpenChannel.isFrozen) && /*#__PURE__*/React__default__default.createElement(FrozenNotification, null), /*#__PURE__*/React__default__default.createElement(OpenChannelMessageList, {
    ref: conversationScrollRef,
    renderMessage: renderMessage,
    renderPlaceHolderEmptyList: renderPlaceHolderEmptyList
  }), (renderInput === null || renderInput === void 0 ? void 0 : renderInput()) || /*#__PURE__*/React__default__default.createElement(OpenChannelInput, {
    ref: messageInputRef
  }));
};

const OpenChannel = props => {
  return /*#__PURE__*/React__default__default.createElement(OpenChannelProvider, {
    channelUrl: props === null || props === void 0 ? void 0 : props.channelUrl,
    isMessageGroupingEnabled: props === null || props === void 0 ? void 0 : props.isMessageGroupingEnabled,
    queries: props === null || props === void 0 ? void 0 : props.queries,
    messageLimit: props === null || props === void 0 ? void 0 : props.messageLimit,
    onBeforeSendUserMessage: props === null || props === void 0 ? void 0 : props.onBeforeSendUserMessage,
    onBeforeSendFileMessage: props === null || props === void 0 ? void 0 : props.onBeforeSendFileMessage,
    onChatHeaderActionClick: props === null || props === void 0 ? void 0 : props.onChatHeaderActionClick,
    disableUserProfile: props === null || props === void 0 ? void 0 : props.disableUserProfile,
    renderUserProfile: props === null || props === void 0 ? void 0 : props.renderUserProfile,
    onBackClick: props === null || props === void 0 ? void 0 : props.onBackClick
  }, /*#__PURE__*/React__default__default.createElement(OpenChannelUI, {
    renderMessage: props === null || props === void 0 ? void 0 : props.renderMessage,
    renderHeader: props === null || props === void 0 ? void 0 : props.renderHeader,
    renderInput: props === null || props === void 0 ? void 0 : props.renderInput,
    renderPlaceHolderEmptyList: props === null || props === void 0 ? void 0 : props.renderPlaceHolderEmptyList,
    renderPlaceHolderError: props === null || props === void 0 ? void 0 : props.renderPlaceHolderError,
    renderPlaceHolderLoading: props === null || props === void 0 ? void 0 : props.renderPlaceHolderLoading
  }));
};

// Unique ID creation requires a high quality random # generator. In the browser we therefore
// require the crypto API and do not support built-in fallback to lower quality random number
// generators (like Math.random()).
let getRandomValues;
const rnds8 = new Uint8Array(16);
function rng() {
  // lazy load so that environments that need to polyfill have a chance to do so
  if (!getRandomValues) {
    // getRandomValues needs to be invoked in a context where "this" is a Crypto implementation.
    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);

    if (!getRandomValues) {
      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');
    }
  }

  return getRandomValues(rnds8);
}

var REGEX = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;

function validate(uuid) {
  return typeof uuid === 'string' && REGEX.test(uuid);
}

/**
 * Convert array of 16 byte values to UUID string format of the form:
 * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
 */

const byteToHex = [];

for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 0x100).toString(16).slice(1));
}

function unsafeStringify(arr, offset = 0) {
  // Note: Be careful editing this code!  It's been tuned for performance
  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434
  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();
}

function parse(uuid) {
  if (!validate(uuid)) {
    throw TypeError('Invalid UUID');
  }

  let v;
  const arr = new Uint8Array(16); // Parse ########-....-....-....-............

  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;
  arr[1] = v >>> 16 & 0xff;
  arr[2] = v >>> 8 & 0xff;
  arr[3] = v & 0xff; // Parse ........-####-....-....-............

  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;
  arr[5] = v & 0xff; // Parse ........-....-####-....-............

  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;
  arr[7] = v & 0xff; // Parse ........-....-....-####-............

  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;
  arr[9] = v & 0xff; // Parse ........-....-....-....-############
  // (Use "/" to avoid 32-bit truncation when bit-shifting high-order bytes)

  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000 & 0xff;
  arr[11] = v / 0x100000000 & 0xff;
  arr[12] = v >>> 24 & 0xff;
  arr[13] = v >>> 16 & 0xff;
  arr[14] = v >>> 8 & 0xff;
  arr[15] = v & 0xff;
  return arr;
}

function stringToBytes(str) {
  str = unescape(encodeURIComponent(str)); // UTF8 escape

  const bytes = [];

  for (let i = 0; i < str.length; ++i) {
    bytes.push(str.charCodeAt(i));
  }

  return bytes;
}

const DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';
const URL$1 = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';
function v35(name, version, hashfunc) {
  function generateUUID(value, namespace, buf, offset) {
    var _namespace;

    if (typeof value === 'string') {
      value = stringToBytes(value);
    }

    if (typeof namespace === 'string') {
      namespace = parse(namespace);
    }

    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {
      throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');
    } // Compute hash of namespace and value, Per 4.3
    // Future: Use spread syntax when supported on all platforms, e.g. `bytes =
    // hashfunc([...namespace, ... value])`


    let bytes = new Uint8Array(16 + value.length);
    bytes.set(namespace);
    bytes.set(value, namespace.length);
    bytes = hashfunc(bytes);
    bytes[6] = bytes[6] & 0x0f | version;
    bytes[8] = bytes[8] & 0x3f | 0x80;

    if (buf) {
      offset = offset || 0;

      for (let i = 0; i < 16; ++i) {
        buf[offset + i] = bytes[i];
      }

      return buf;
    }

    return unsafeStringify(bytes);
  } // Function#name is not settable on some platforms (#270)


  try {
    generateUUID.name = name; // eslint-disable-next-line no-empty
  } catch (err) {} // For CommonJS default export support


  generateUUID.DNS = DNS;
  generateUUID.URL = URL$1;
  return generateUUID;
}

/*
 * Browser-compatible JavaScript MD5
 *
 * Modification of JavaScript MD5
 * https://github.com/blueimp/JavaScript-MD5
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * https://opensource.org/licenses/MIT
 *
 * Based on
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */
function md5(bytes) {
  if (typeof bytes === 'string') {
    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape

    bytes = new Uint8Array(msg.length);

    for (let i = 0; i < msg.length; ++i) {
      bytes[i] = msg.charCodeAt(i);
    }
  }

  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));
}
/*
 * Convert an array of little-endian words to an array of bytes
 */


function md5ToHexEncodedArray(input) {
  const output = [];
  const length32 = input.length * 32;
  const hexTab = '0123456789abcdef';

  for (let i = 0; i < length32; i += 8) {
    const x = input[i >> 5] >>> i % 32 & 0xff;
    const hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);
    output.push(hex);
  }

  return output;
}
/**
 * Calculate output length with padding and bit length
 */


function getOutputLength(inputLength8) {
  return (inputLength8 + 64 >>> 9 << 4) + 14 + 1;
}
/*
 * Calculate the MD5 of an array of little-endian words, and a bit length.
 */


function wordsToMd5(x, len) {
  /* append padding */
  x[len >> 5] |= 0x80 << len % 32;
  x[getOutputLength(len) - 1] = len;
  let a = 1732584193;
  let b = -271733879;
  let c = -1732584194;
  let d = 271733878;

  for (let i = 0; i < x.length; i += 16) {
    const olda = a;
    const oldb = b;
    const oldc = c;
    const oldd = d;
    a = md5ff(a, b, c, d, x[i], 7, -680876936);
    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);
    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);
    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);
    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);
    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);
    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);
    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);
    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);
    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);
    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);
    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);
    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);
    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);
    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);
    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);
    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);
    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);
    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);
    b = md5gg(b, c, d, a, x[i], 20, -373897302);
    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);
    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);
    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);
    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);
    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);
    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);
    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);
    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);
    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);
    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);
    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);
    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);
    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);
    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);
    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);
    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);
    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);
    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);
    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);
    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);
    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);
    d = md5hh(d, a, b, c, x[i], 11, -358537222);
    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);
    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);
    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);
    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);
    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);
    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);
    a = md5ii(a, b, c, d, x[i], 6, -198630844);
    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);
    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);
    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);
    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);
    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);
    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);
    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);
    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);
    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);
    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);
    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);
    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);
    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);
    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);
    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);
    a = safeAdd(a, olda);
    b = safeAdd(b, oldb);
    c = safeAdd(c, oldc);
    d = safeAdd(d, oldd);
  }

  return [a, b, c, d];
}
/*
 * Convert an array bytes to an array of little-endian words
 * Characters >255 have their high-byte silently ignored.
 */


function bytesToWords(input) {
  if (input.length === 0) {
    return [];
  }

  const length8 = input.length * 8;
  const output = new Uint32Array(getOutputLength(length8));

  for (let i = 0; i < length8; i += 8) {
    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;
  }

  return output;
}
/*
 * Add integers, wrapping at 2^32. This uses 16-bit operations internally
 * to work around bugs in some JS interpreters.
 */


function safeAdd(x, y) {
  const lsw = (x & 0xffff) + (y & 0xffff);
  const msw = (x >> 16) + (y >> 16) + (lsw >> 16);
  return msw << 16 | lsw & 0xffff;
}
/*
 * Bitwise rotate a 32-bit number to the left.
 */


function bitRotateLeft(num, cnt) {
  return num << cnt | num >>> 32 - cnt;
}
/*
 * These functions implement the four basic operations the algorithm uses.
 */


function md5cmn(q, a, b, x, s, t) {
  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);
}

function md5ff(a, b, c, d, x, s, t) {
  return md5cmn(b & c | ~b & d, a, b, x, s, t);
}

function md5gg(a, b, c, d, x, s, t) {
  return md5cmn(b & d | c & ~d, a, b, x, s, t);
}

function md5hh(a, b, c, d, x, s, t) {
  return md5cmn(b ^ c ^ d, a, b, x, s, t);
}

function md5ii(a, b, c, d, x, s, t) {
  return md5cmn(c ^ (b | ~d), a, b, x, s, t);
}

v35('v3', 0x30, md5);

const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var native = {
  randomUUID
};

function v4(options, buf, offset) {
  if (native.randomUUID && !buf && !options) {
    return native.randomUUID();
  }

  options = options || {};
  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`

  rnds[6] = rnds[6] & 0x0f | 0x40;
  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided

  if (buf) {
    offset = offset || 0;

    for (let i = 0; i < 16; ++i) {
      buf[offset + i] = rnds[i];
    }

    return buf;
  }

  return unsafeStringify(rnds);
}

// Adapted from Chris Veness' SHA1 code at
// http://www.movable-type.co.uk/scripts/sha1.html
function f$1(s, x, y, z) {
  switch (s) {
    case 0:
      return x & y ^ ~x & z;

    case 1:
      return x ^ y ^ z;

    case 2:
      return x & y ^ x & z ^ y & z;

    case 3:
      return x ^ y ^ z;
  }
}

function ROTL(x, n) {
  return x << n | x >>> 32 - n;
}

function sha1(bytes) {
  const K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];
  const H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];

  if (typeof bytes === 'string') {
    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape

    bytes = [];

    for (let i = 0; i < msg.length; ++i) {
      bytes.push(msg.charCodeAt(i));
    }
  } else if (!Array.isArray(bytes)) {
    // Convert Array-like to Array
    bytes = Array.prototype.slice.call(bytes);
  }

  bytes.push(0x80);
  const l = bytes.length / 4 + 2;
  const N = Math.ceil(l / 16);
  const M = new Array(N);

  for (let i = 0; i < N; ++i) {
    const arr = new Uint32Array(16);

    for (let j = 0; j < 16; ++j) {
      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];
    }

    M[i] = arr;
  }

  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);
  M[N - 1][14] = Math.floor(M[N - 1][14]);
  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;

  for (let i = 0; i < N; ++i) {
    const W = new Uint32Array(80);

    for (let t = 0; t < 16; ++t) {
      W[t] = M[i][t];
    }

    for (let t = 16; t < 80; ++t) {
      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);
    }

    let a = H[0];
    let b = H[1];
    let c = H[2];
    let d = H[3];
    let e = H[4];

    for (let t = 0; t < 80; ++t) {
      const s = Math.floor(t / 20);
      const T = ROTL(a, 5) + f$1(s, b, c, d) + e + K[s] + W[t] >>> 0;
      e = d;
      d = c;
      c = ROTL(b, 30) >>> 0;
      b = a;
      a = T;
    }

    H[0] = H[0] + a >>> 0;
    H[1] = H[1] + b >>> 0;
    H[2] = H[2] + c >>> 0;
    H[3] = H[3] + d >>> 0;
    H[4] = H[4] + e >>> 0;
  }

  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];
}

v35('v5', 0x50, sha1);

var css_248z$d = "@import url(\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\");\nbody {\n  font-family: \"Roboto\", \"Verdana\", sans-serif;\n  font-size: 14px;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.spin {\n  animation: spin 1s linear infinite;\n}\n\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n.create-event-view {\n  position: relative;\n  width: 480px;\n  padding: 20px;\n}\n.create-event-view .title {\n  font-size: 20px;\n  font-weight: 700;\n}\n.create-event-view .section-title {\n  font-size: 12px;\n  margin: 20px 0 10px 0;\n}\n.create-event-view .close {\n  position: absolute;\n  top: 20px;\n  right: 20px;\n}\n.create-event-view .close:hover {\n  cursor: pointer;\n}\n.create-event-view .title-form {\n  width: 100%;\n  border: 1px #aaa solid;\n  border-radius: 3px;\n  padding: 10px 16px;\n  box-sizing: border-box;\n}\n.create-event-view .cover-image-box {\n  display: flex;\n  align-items: center;\n}\n.create-event-view .cover-image-box .cover-image-container {\n  display: flex;\n  width: 136px;\n  height: 80px;\n  background: #bbb;\n  margin-right: 16px;\n  justify-content: center;\n  align-items: center;\n}\n.create-event-view .cover-image-box .cover-image {\n  width: 136px;\n  height: 80px;\n}\n.create-event-view .cover-image-box .cover-image-file {\n  width: 0;\n  height: 0;\n}\n.create-event-view .cover-image-box .cover-image-upload {\n  text-decoration: underline;\n}\n.sendbird-theme--light .create-event-view .cover-image-box .cover-image-upload {\n  color: var(--sendbird-light-primary-400);\n}\n.sendbird-theme--dark .create-event-view .cover-image-box .cover-image-upload {\n  color: var(--sendbird-dark-primary-300);\n}\n.create-event-view .cover-image-box .cover-image-upload:hover {\n  cursor: pointer;\n}\n.create-event-view .cover-image-box .cover-image-remove {\n  margin-left: 16px;\n  text-decoration: underline;\n}\n.sendbird-theme--light .create-event-view .cover-image-box .cover-image-remove {\n  color: var(--sendbird-light-error-300);\n}\n.sendbird-theme--dark .create-event-view .cover-image-box .cover-image-remove {\n  color: var(--sendbird-dark-error-300);\n}\n.create-event-view .cover-image-box .cover-image-remove:hover {\n  cursor: pointer;\n}\n.create-event-view .button-box {\n  display: flex;\n  justify-content: right;\n}\n.create-event-view .button-box .minor-button, .create-event-view .button-box .major-button {\n  padding: 10px 12px;\n  margin: 5px;\n  border-radius: 4px;\n}\n.create-event-view .button-box .minor-button:hover, .create-event-view .button-box .major-button:hover {\n  cursor: pointer;\n  opacity: 0.9;\n}\n.create-event-view .button-box .major-button {\n  color: #fff;\n}\n.sendbird-theme--light .create-event-view .button-box .major-button {\n  background-color: var(--sendbird-light-primary-400);\n  border: 1px var(--sendbird-light-primary-400) solid;\n}\n.sendbird-theme--dark .create-event-view .button-box .major-button {\n  background-color: var(--sendbird-dark-primary-300);\n  border: 1px var(--sendbird-dark-primary-300) solid;\n}\n.create-event-view .button-box .major-button:disabled,\n.create-event-view .button-box .major-button[disabled] {\n  border: 1px #eee solid;\n  background: #eee;\n  color: rgba(0, 0, 0, 0.12);\n}\n.create-event-view .button-box .minor-button {\n  color: #333;\n  border: 1px #333 solid;\n  background-color: #fff;\n}\n\n.event-host-form .input {\n  display: flex;\n  max-height: 154px;\n  border: 1px #aaa solid;\n  border-radius: 3px;\n  padding: 6px 12px;\n  box-sizing: border-box;\n  align-content: flex-start;\n  overflow-y: auto;\n}\n.event-host-form .input .search-type-panel .search-type {\n  margin: 4px 4px 0 0;\n  padding: 4px 6px;\n  border: 0;\n}\n.event-host-form .input .form {\n  flex: 1;\n}\n.event-host-form .input .form .host-form {\n  min-width: 240px;\n  margin: 4px;\n  border: 0;\n}\n.event-host-form .input .form .host-form:focus {\n  outline: none;\n}\n.event-host-form .search-result {\n  position: relative;\n  top: -45px;\n}\n.event-host-form .search-result .users, .event-host-form .search-result .status {\n  background: #fff;\n  border-radius: 4px;\n  box-shadow: 0 3px 5px -3px rgba(0, 0, 0, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  overflow: hidden;\n}\n.event-host-form .search-result .status {\n  display: flex;\n  position: absolute;\n  height: 104px;\n  top: 0;\n  left: 0;\n  right: 0;\n  box-sizing: border-box;\n  align-items: center;\n  justify-content: center;\n}\n.event-host-form .search-result .status .no-result {\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.5);\n}\n.event-host-form .search-result .status .error {\n  font-size: 14px;\n  color: #de360b;\n}\n.event-host-form .search-result .users {\n  position: absolute;\n  max-height: 104px;\n  top: 0;\n  left: 0;\n  right: 0;\n  overflow-y: auto;\n}\n\n.event-host-status {\n  display: flex;\n  padding: 6px 4px;\n  margin-bottom: 10px;\n}\n.event-host-status .message {\n  flex: 1;\n  font-size: 12px;\n  color: #666;\n}\n.event-host-status .error {\n  color: #de360b;\n}\n.event-host-status .count {\n  font-size: 12px;\n  color: #666;\n  margin: 0 0 0 8px;\n}\n\n.event-host {\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n  background: #eee;\n  border-radius: 16px;\n  overflow: hidden;\n  margin: 4px;\n  vertical-align: middle;\n}\n.event-host .profile-image {\n  width: 24px;\n  height: 24px;\n  border-radius: 16px;\n  margin-right: -4px;\n  background: #fff;\n}\n.event-host .nickname {\n  font-size: 12px;\n  padding: 6px 10px;\n}\n.event-host .remove-button {\n  width: 18px;\n  height: 18px;\n  border-radius: 12px;\n}\n.event-host .remove-button:hover {\n  cursor: pointer;\n}\n\n.searched-user {\n  display: flex;\n  flex-direction: row;\n  background: #fff;\n  padding: 8px;\n}\n.searched-user:hover {\n  cursor: pointer;\n  background: #eee;\n}\n.searched-user .profile-image {\n  width: 32px;\n  height: 32px;\n  border-radius: 20px;\n  margin-right: 12px;\n  background-color: #bdbdbd;\n}\n.searched-user .info {\n  flex: 1;\n  align-items: center;\n}\n.searched-user .info .nickname {\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.88);\n}\n.searched-user .info .user-id {\n  font-size: 12px;\n  color: rgba(0, 0, 0, 0.5);\n}";
styleInject(css_248z$d);

var _defs$5, _g$7;

function _extends$m() { _extends$m = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$m.apply(this, arguments); }

var SvgIconsUser = function SvgIconsUser(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$m({
    width: 24,
    height: 24,
    viewBox: "-4 -4 20 20",
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _defs$5 || (_defs$5 = /*#__PURE__*/React__default.createElement("defs", null, /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-user_svg__a"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M1368 0v4600H0V0h1368z"
  })), /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-user_svg__b"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M6.19 5.714c1.28 0 2.325 1.01 2.38 2.278l.001.103v.953a.476.476 0 0 1-.949.055l-.003-.055v-.953a1.43 1.43 0 0 0-1.345-1.426l-.084-.002H2.381c-.76 0-1.383.594-1.426 1.344l-.003.084v.953a.476.476 0 0 1-.949.055L0 9.048v-.953c0-1.28 1.01-2.324 2.278-2.379l.103-.002h3.81zM4.286 0a2.381 2.381 0 1 1 0 4.762 2.381 2.381 0 0 1 0-4.762zm0 .952a1.429 1.429 0 1 0 0 2.858 1.429 1.429 0 0 0 0-2.858z"
  })))), _g$7 || (_g$7 = /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-user_svg__a)",
    transform: "translate(-531 -1699)"
  }, /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-user_svg__b)",
    transform: "translate(532.714 1700.238)"
  }, /*#__PURE__*/React__default.createElement("path", {
    fill: "rgba(210, 210, 210, 0.88)",
    d: "M0 0h8.571v9.524H0V0z"
  })))));
};

var _path$9;

function _extends$l() { _extends$l = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$l.apply(this, arguments); }

var SvgIconsClose = function SvgIconsClose(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$l({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$9 || (_path$9 = /*#__PURE__*/React__default.createElement("path", {
    d: "M52.552 11.448a2.667 2.667 0 0 1 .222 3.52l-.222.251-16.781 16.78 16.781 16.782a2.667 2.667 0 0 1-3.52 3.993l-.251-.222L32 35.771 15.219 52.552a2.667 2.667 0 0 1-3.993-3.52l.222-.251L28.228 32l-16.78-16.781a2.667 2.667 0 0 1 3.52-3.993l.251.222 16.78 16.78 16.782-16.78a2.667 2.667 0 0 1 3.771 0z",
    fillRule: "evenodd"
  })));
};

function EventHostView(_a) {
    var key = _a.key, userId = _a.userId, _b = _a.disabled, disabled = _b === void 0 ? false : _b, _c = _a.nickname, nickname = _c === void 0 ? '' : _c, _d = _a.profileUrl, profileUrl = _d === void 0 ? '' : _d, _e = _a.hideProfile, hideProfile = _e === void 0 ? false : _e, _f = _a.onRemove, onRemove = _f === void 0 ? function () { } : _f;
    var profile = profileUrl ?
        React__default__default.createElement("img", { src: profileUrl, className: 'profile-image' }) :
        React__default__default.createElement(SvgIconsUser, { fill: '#ccc', className: 'profile-image' });
    return React__default__default.createElement("div", { className: 'event-host', key: key },
        !hideProfile ? profile : null,
        React__default__default.createElement("div", { className: 'nickname' }, nickname),
        React__default__default.createElement("div", { className: 'remove-button', onClick: function () { if (!disabled)
                onRemove(userId); } },
            React__default__default.createElement(SvgIconsClose, { viewBox: "0 -17 100 100", fill: '#888', width: 18, height: 18 })));
}

var _path$8;

function _extends$k() { _extends$k = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$k.apply(this, arguments); }

var SvgIconsInfo = function SvgIconsInfo(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$k({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$8 || (_path$8 = /*#__PURE__*/React__default.createElement("path", {
    d: "M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667zM32 8C18.745 8 8 18.745 8 32s10.745 24 24 24 24-10.745 24-24S45.255 8 32 8zm1.667 21.333a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1h-3.334a1 1 0 0 1-1-1v-14a1 1 0 0 1 1-1h3.334zm-1.667-8a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z",
    fillRule: "evenodd"
  })));
};

function EventHostStatusView(_a) {
    var message = _a.message, count = _a.count, maxLength = _a.maxLength, _b = _a.error, error = _b === void 0 ? false : _b;
    return React__default__default.createElement("div", { className: 'event-host-status' },
        React__default__default.createElement("div", { className: "message ".concat(error ? 'error' : '') }, message),
        React__default__default.createElement("div", { className: 'count' },
            React__default__default.createElement("span", { className: "value ".concat(error ? 'error' : '') }, count),
            " / ",
            maxLength,
            " users"),
        React__default__default.createElement(SvgIconsInfo, { width: 24, height: 24, viewBox: '-32 0 100 100', fill: '#666' }));
}

var _path$7;

function _extends$j() { _extends$j = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$j.apply(this, arguments); }

var SvgIconsSpinner = function SvgIconsSpinner(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$j({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$7 || (_path$7 = /*#__PURE__*/React__default.createElement("path", {
    d: "M32 61.333C48.2 61.333 61.333 48.2 61.333 32S48.2 2.667 32 2.667 2.667 15.8 2.667 32a2.839 2.839 0 1 0 5.677 0C8.344 18.935 18.935 8.344 32 8.344S55.656 18.935 55.656 32 45.065 55.656 32 55.656a2.839 2.839 0 1 0 0 5.677z",
    fillRule: "evenodd"
  })));
};

function EventHostSearchedUserView(_a) {
    var userId = _a.userId, _b = _a.nickname, nickname = _b === void 0 ? '' : _b, _c = _a.profileUrl, profileUrl = _c === void 0 ? '' : _c, _d = _a.onClick, onClick = _d === void 0 ? function () { } : _d;
    var profile = profileUrl ?
        React__default__default.createElement("img", { src: profileUrl, className: 'profile-image' }) :
        React__default__default.createElement(SvgIconsUser, { fill: '#fff', className: 'profile-image' });
    return React__default__default.createElement("div", { className: 'searched-user', onClick: function () { return onClick(); } },
        profile,
        React__default__default.createElement("div", { className: 'info' },
            React__default__default.createElement("div", { className: 'nickname' }, nickname),
            React__default__default.createElement("div", { className: 'user-id' }, userId)));
}

function EventHostSearchInput(_a) {
    var _b = _a.initialHostUsers, initialHostUsers = _b === void 0 ? [] : _b, _c = _a.maxHostLength, maxHostLength = _c === void 0 ? DEFAULT_MAX_HOST_LENGTH : _c, _d = _a.renderCustomEventHostView, renderCustomEventHostView = _d === void 0 ? EventHostView : _d, _e = _a.onUpdateHost, onUpdateHost = _e === void 0 ? function () { } : _e;
    var _f = useState([]), searchedUsers = _f[0], setSearchedUsers = _f[1];
    var _g = useState(0), searchVersion = _g[0], setSearchVersion = _g[1];
    var _h = useState(false), searching = _h[0], setSearching = _h[1];
    var _j = useState(false), searchError = _j[0], setSearchError = _j[1];
    var _k = useState(initialHostUsers), selectedUsers = _k[0], setSelectedUsers = _k[1];
    var _l = useState('nickname'), searchType = _l[0], setSearchType = _l[1];
    var _m = useState(''), typedText = _m[0], setTypedText = _m[1];
    var _o = useState(''), message = _o[0], setMessage = _o[1];
    var _p = useState(false), error = _p[0], setError = _p[1];
    var context = useSendbirdStateContext();
    useEffect(function () {
        setSelectedUsers(initialHostUsers);
    }, [initialHostUsers]);
    useEffect(function () {
        if (selectedUsers.length > maxHostLength) {
            setError(true);
            setMessage('The number of users allowed has exceeded.');
        }
        else {
            setError(false);
            setMessage('');
        }
    }, [selectedUsers]);
    var search = function (searchType, keyword) {
        var sb = sendbirdSelectors.getSdk(context);
        if (sb && keyword) {
            var query = null;
            switch (searchType) {
                case 'nickname': {
                    query = sb.createApplicationUserListQuery({ nicknameStartsWithFilter: keyword });
                    break;
                }
                case 'user ID': {
                    query = sb.createApplicationUserListQuery({ userIdsFilter: [keyword] });
                    break;
                }
            }
            if (query) {
                var currentSearchVersion_1 = searchVersion + 1;
                setSearchVersion(currentSearchVersion_1);
                setSearching(true);
                setSearchError(false);
                query.next()
                    .then(function (users) {
                    if (currentSearchVersion_1 >= searchVersion) {
                        setSearchedUsers(users);
                        setSearching(false);
                        setSearchError(false);
                        setSearchVersion(currentSearchVersion_1);
                    }
                })
                    .catch(function (err) {
                    if (currentSearchVersion_1 >= searchVersion) {
                        setSearching(false);
                        setSearchError(true);
                        setSearchVersion(currentSearchVersion_1);
                    }
                });
            }
        }
    };
    return React__default__default.createElement("div", { className: 'event-host-form' },
        React__default__default.createElement("div", { className: 'input' },
            React__default__default.createElement("div", { className: 'search-type-panel' },
                React__default__default.createElement("select", { className: 'search-type', value: searchType, onChange: function (event) {
                        var newSearchType = event.target.value;
                        setSearchType(newSearchType);
                        switch (newSearchType) {
                            case 'user ID':
                                setMessage('Only an exact match can be found.');
                                break;
                            default:
                                setMessage('');
                        }
                        setError(false);
                        search(newSearchType, typedText);
                    } },
                    React__default__default.createElement("option", { value: 'nickname' }, "Nickname"),
                    React__default__default.createElement("option", { value: 'user ID' }, "User ID"))),
            React__default__default.createElement("div", { className: 'form' },
                selectedUsers.map(function (user) { return renderCustomEventHostView({
                    key: user.userId,
                    userId: user.userId,
                    disabled: initialHostUsers.map(function (user) { return user.userId; }).includes(user.userId),
                    nickname: user.nickname,
                    profileUrl: user.profileUrl,
                    onRemove: function (targetUserId) {
                        var updatedUsers = selectedUsers.filter(function (user) { return user.userId !== targetUserId; });
                        setSelectedUsers(updatedUsers);
                        onUpdateHost(updatedUsers.map(function (user) { return user.userId; }));
                    },
                }); }),
                React__default__default.createElement("input", { type: 'text', placeholder: "Enter ".concat(searchType), className: 'host-form', value: typedText, onChange: function (event) {
                        var keyword = event.target.value;
                        setTypedText(keyword);
                        search(searchType, keyword);
                    } }))),
        React__default__default.createElement(EventHostStatusView, { message: message, error: error, count: selectedUsers.length, maxLength: maxHostLength }),
        typedText ?
            React__default__default.createElement("div", { className: 'search-result' }, searchedUsers.length > 0 ?
                React__default__default.createElement("div", { className: 'users' }, searchedUsers.map(function (user) { return React__default__default.createElement(EventHostSearchedUserView, { key: user.userId, userId: user.userId, nickname: user.nickname, profileUrl: user.profileUrl, onClick: function () {
                        if (!selectedUsers.map(function (user) { return user.userId; }).includes(user.userId)) {
                            var updatedUsers = __spreadArray(__spreadArray([], selectedUsers, true), [user], false);
                            setSelectedUsers(updatedUsers);
                            onUpdateHost(updatedUsers.map(function (user) { return user.userId; }));
                        }
                        setTypedText('');
                        setSearchedUsers([]);
                        setSearchError(false);
                        setSearching(false);
                    } }); })) :
                React__default__default.createElement("div", { className: 'status' },
                    searching ? React__default__default.createElement(SvgIconsSpinner, { width: 24, height: 24, viewBox: '-18 -18 100 100', fill: '#333', className: 'spin' }) : null,
                    !searching && !searchError && searchedUsers.length === 0 ? React__default__default.createElement("div", { className: 'no-result' },
                        "No matches found with ",
                        typedText) : null,
                    searchError ? React__default__default.createElement("div", { className: 'error' }, "Search request failed.") : null)) :
            null);
}

function EventHostTextInput(_a) {
    var _b = _a.initialHostUsers, initialHostUsers = _b === void 0 ? [] : _b, _c = _a.maxHostLength, maxHostLength = _c === void 0 ? DEFAULT_MAX_HOST_LENGTH : _c, _d = _a.renderCustomEventHostView, renderCustomEventHostView = _d === void 0 ? EventHostView : _d, _e = _a.onUpdateHost, onUpdateHost = _e === void 0 ? function () { } : _e;
    var _f = useState([]), selectedUserIds = _f[0], setSelectedUserIds = _f[1];
    var _g = useState(''), typedText = _g[0], setTypedText = _g[1];
    var _h = useState(''), message = _h[0], setMessage = _h[1];
    var _j = useState(false), error = _j[0], setError = _j[1];
    useEffect(function () {
        setSelectedUserIds(initialHostUsers.map(function (user) { return user.userId; }));
    }, [initialHostUsers]);
    useEffect(function () {
        if (selectedUserIds.length > maxHostLength) {
            setError(true);
            setMessage('The number of users allowed has exceeded.');
        }
        else {
            setError(false);
            setMessage('If the ACL attributes are turned on, you can access user list information from the SDK.');
        }
    }, [selectedUserIds]);
    return React__default__default.createElement("div", { className: 'event-host-form' },
        React__default__default.createElement("div", { className: 'input' },
            React__default__default.createElement("div", { className: 'form' },
                selectedUserIds.map(function (userId) { return renderCustomEventHostView({
                    key: userId,
                    userId: userId,
                    disabled: initialHostUsers.map(function (user) { return user.userId; }).includes(userId),
                    nickname: userId,
                    hideProfile: true,
                    onRemove: function (targetUserId) {
                        var updatedUserIds = selectedUserIds.filter(function (userId) { return userId !== targetUserId; });
                        setSelectedUserIds(updatedUserIds);
                        onUpdateHost(updatedUserIds);
                    },
                }); }),
                React__default__default.createElement("input", { type: 'text', placeholder: 'Separate each user ID with a comma.', className: 'host-form', value: typedText, onChange: function (event) {
                        var _a;
                        var inputValue = event.target.value;
                        var userIds = inputValue.split(',');
                        setTypedText((_a = userIds.pop()) !== null && _a !== void 0 ? _a : '');
                        var addedUserIds = userIds.filter(function (userId, index) {
                            return userId.length > 0
                                && !selectedUserIds.includes(userId)
                                && userIds.indexOf(userId) === index;
                        });
                        if (addedUserIds.length > 0) {
                            var newlySelectedUserIds = __spreadArray(__spreadArray([], selectedUserIds, true), addedUserIds, true);
                            setSelectedUserIds(newlySelectedUserIds);
                            onUpdateHost(newlySelectedUserIds);
                        }
                    } }))),
        React__default__default.createElement(EventHostStatusView, { message: message, error: error, count: selectedUserIds.length, maxLength: maxHostLength }));
}

var _defs$4, _g$6;

function _extends$i() { _extends$i = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$i.apply(this, arguments); }

var SvgIconsLive = function SvgIconsLive(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$i({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _defs$4 || (_defs$4 = /*#__PURE__*/React__default.createElement("defs", null, /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-live_svg__a"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M1368 0v1600H0V0h1368z"
  })), /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-live_svg__b"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M26.667 21.333A5.333 5.333 0 0 1 30 30.83v22.297a26.923 26.923 0 0 1-3.323.206h-.02a26.81 26.81 0 0 1-3.324-.206V30.83a5.333 5.333 0 0 1 3.333-9.497zm0-21.333c14.727 0 26.666 11.94 26.666 26.667 0 12.184-8.171 22.46-19.333 25.645V45.28c7.418-2.924 12.667-10.155 12.667-18.612 0-11.046-8.955-20-20-20-11.046 0-20 8.954-20 20 0 8.457 5.249 15.688 12.666 18.612v7.033C8.172 49.127 0 38.851 0 26.667 0 11.939 11.94 0 26.667 0zm0 10.667c8.836 0 16 7.163 16 16 0 6.193-3.52 11.565-8.667 14.224v-8.45a9.294 9.294 0 0 0 2-5.774 9.333 9.333 0 1 0-18.667 0c0 2.18.748 4.185 2 5.774v8.45c-5.147-2.66-8.666-8.03-8.666-14.224 0-8.837 7.163-16 16-16z"
  })))), _g$6 || (_g$6 = /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-live_svg__a)",
    transform: "translate(-1216 -336)"
  }, /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-live_svg__b)",
    transform: "translate(1221.333 341.333)"
  }, /*#__PURE__*/React__default.createElement("path", {
    fill: "rgba(255, 255, 255, 1)",
    d: "M0 0h53.333v53.333H0V0z"
  })))));
};

var DEFAULT_MAX_HOST_LENGTH = 10;
function CreateEventView(_a) {
    var _this = this;
    var _b, _c;
    var _d = _a.showUserIdsForHostSelectionView, showUserIdsForHostSelectionView = _d === void 0 ? true : _d, _e = _a.disableAcl, disableAcl = _e === void 0 ? false : _e, _f = _a.renderCustomEventHostView, renderCustomEventHostView = _f === void 0 ? EventHostView : _f, _g = _a.onClose, onClose = _g === void 0 ? function () { } : _g;
    var _h = useState(''), title = _h[0], setTitle = _h[1];
    var _j = useState(''), coverImagePath = _j[0], setCoverImagePath = _j[1];
    var coverImage = useRef(null);
    var coverImageFile = useRef(null);
    var stringSet = useContext(SendbirdLiveContext).stringSet;
    var context = useSendbirdStateContext();
    var sb = sendbirdSelectors.getSdk(context);
    var _k = useState([]), initialHostUsers = _k[0], setInitialHostUsers = _k[1];
    useEffect(function () {
        if (showUserIdsForHostSelectionView) {
            if (sb === null || sb === void 0 ? void 0 : sb.currentUser) {
                setInitialHostUsers([sb.currentUser]);
            }
        }
    }, [sb === null || sb === void 0 ? void 0 : sb.currentUser]);
    var _l = useState(initialHostUsers.map(function (user) { return user.userId; })), hostUserIds = _l[0], setHostUserIds = _l[1];
    return React__default__default.createElement("div", { className: 'create-event-view' },
        React__default__default.createElement("div", { className: 'close', onClick: function () { return onClose(); } },
            React__default__default.createElement(SvgIconsClose, { width: 22, height: 22, viewBox: '0 0 60 60' })),
        React__default__default.createElement("div", { className: 'title' }, stringSet.LIVE_EVENT_CREATE_HEADER_TITLE),
        React__default__default.createElement("div", { className: 'section-title' }, stringSet.LIVE_EVENT_CREATE_EVENT_TITLE),
        React__default__default.createElement("div", null,
            React__default__default.createElement("input", { type: 'text', placeholder: stringSet.LIVE_EVENT_CREATE_EVENT_TITLE_PLACEHOLDER, className: 'title-form', value: title, onChange: function (event) {
                    setTitle(event.target.value);
                } })),
        React__default__default.createElement("div", { className: 'section-title' }, stringSet.LIVE_EVENT_CREATE_EVENT_COVER_IMAGE_TITLE),
        React__default__default.createElement("div", { className: 'cover-image-box' },
            React__default__default.createElement("div", { className: 'cover-image-container', ref: coverImage }, !coverImagePath ?
                React__default__default.createElement(SvgIconsLive, { viewBox: '0 0 64 64', width: 32, height: 32, fill: '#fff' }) :
                React__default__default.createElement("img", { src: coverImagePath, alt: 'Cover image', className: 'cover-image' })),
            React__default__default.createElement("input", { type: 'file', className: 'cover-image-file', ref: coverImageFile, accept: 'image/*', onChange: function () {
                    var _a;
                    var target = coverImageFile.current;
                    var files = (_a = target === null || target === void 0 ? void 0 : target.files) !== null && _a !== void 0 ? _a : [];
                    if (files.length === 1) {
                        var reader_1 = new FileReader();
                        reader_1.onload = function () {
                            if (coverImage.current) {
                                setCoverImagePath(reader_1.result);
                            }
                        };
                        reader_1.readAsDataURL(files[0]);
                    }
                } }),
            React__default__default.createElement("div", { className: 'cover-image-upload', onClick: function () { coverImageFile.current.click(); } }, stringSet.LIVE_EVENT_CREATE_EVENT_COVER_IMAGE_BUTTON),
            React__default__default.createElement("div", { className: 'cover-image-remove', onClick: function () {
                    if (coverImageFile.current)
                        coverImageFile.current.value = '';
                    setCoverImagePath('');
                } }, ((_c = (_b = coverImageFile.current) === null || _b === void 0 ? void 0 : _b.files) === null || _c === void 0 ? void 0 : _c.length) ? stringSet.REMOVE_IMAGE : '')),
        React__default__default.createElement("div", { className: 'section-title' }, stringSet.LIST_USERS_FOR_HOST_HEADER_TITLE),
        !disableAcl ?
            React__default__default.createElement(EventHostSearchInput, { initialHostUsers: initialHostUsers, renderCustomEventHostView: renderCustomEventHostView, onUpdateHost: function (userIds) { return setHostUserIds(userIds); } }) :
            React__default__default.createElement(EventHostTextInput, { initialHostUsers: initialHostUsers, renderCustomEventHostView: renderCustomEventHostView, onUpdateHost: function (userIds) { return setHostUserIds(userIds); } }),
        React__default__default.createElement("div", { className: 'button-box' },
            React__default__default.createElement("input", { type: 'button', className: 'minor-button', value: 'Cancel', onClick: function () { return onClose(); } }),
            React__default__default.createElement("input", { type: 'button', className: 'major-button', value: stringSet.LIVE_EVENT_CREATE_HEADER_BUTTON, onClick: function () { return __awaiter$2(_this, void 0, void 0, function () {
                    var file, newFile, blob, liveEvent;
                    var _a, _b;
                    return __generator(this, function (_c) {
                        switch (_c.label) {
                            case 0:
                                file = (_b = (_a = coverImageFile === null || coverImageFile === void 0 ? void 0 : coverImageFile.current) === null || _a === void 0 ? void 0 : _a.files) === null || _b === void 0 ? void 0 : _b[0];
                                newFile = null;
                                if (file) {
                                    blob = file.slice(0, file.size, file.type);
                                    newFile = new File([blob], "".concat(v4(), ".").concat(file.type.split('/').pop()), { type: file.type });
                                }
                                return [4 /*yield*/, sendbirdLive_min.exports.SendbirdLive.createLiveEvent({
                                        userIdsForHost: __spreadArray([], hostUserIds, true),
                                        title: title,
                                        coverFile: newFile !== null && newFile !== void 0 ? newFile : undefined,
                                    })];
                            case 1:
                                liveEvent = _c.sent();
                                return [4 /*yield*/, liveEvent.enterAsHost({ turnAudioOn: true, turnVideoOn: true })];
                            case 2:
                                _c.sent();
                                onClose(liveEvent);
                                return [2 /*return*/];
                        }
                    });
                }); } })));
}

var css_248z$c = "@import url(\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\");\nbody {\n  font-family: \"Roboto\", \"Verdana\", sans-serif;\n  font-size: 14px;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.spin {\n  animation: spin 1s linear infinite;\n}\n\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n.dark-background {\n  background: var(--sendbird-dark-background-500) !important;\n}\n\n.host-view {\n  display: flex;\n  flex-grow: 1;\n}\n.host-view .host-view__main {\n  width: 100%;\n  height: 100%;\n  background-color: var(--sendbird-dark-background-700);\n}\n.host-view .host-view__main .video-wrapper {\n  position: relative;\n  width: 100%;\n}\n.host-view .host-view__main .video-wrapper:before {\n  display: block;\n  content: \"\";\n  padding-top: 56.25%; /*What you want the height to be in relation to the width*/\n}\n.host-view .host-view__main .video-wrapper .host-view__video {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.host-view .host-view__main .host-view__info {\n  display: flex;\n  padding-top: 16px;\n  background-color: var(--sendbird-dark-background-600);\n}\n.host-view .host-view__main .host-view__info .host-view__profile {\n  width: 56px;\n  height: 56px;\n  margin: 0 16px 12px;\n  border-radius: 50%;\n  background-color: var(--sendbird-dark-background-300);\n  overflow: hidden;\n}\n.host-view .host-view__main .host-view__info .host-view__profile .host-view__profile__cover-image {\n  width: 56px;\n  height: 56px;\n  object-fit: contain;\n}\n.host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state, .host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state--ended, .host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state--ongoing, .host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state--ready, .host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state--created {\n  width: fit-content;\n  box-sizing: border-box;\n  height: 20px;\n  margin-right: 8px;\n  padding: 4px;\n  border-radius: 2px;\n  font-size: 12px;\n  font-weight: bold;\n  line-height: 1;\n}\n.host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state--created {\n  background-color: var(--sendbird-light-primary-100);\n  color: #6211c8;\n}\n.host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state--ready {\n  background-color: #c8d9fa;\n  color: #30308f;\n}\n.host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state--ongoing {\n  background-color: var(--sendbird-light-error-300);\n  color: rgba(255, 255, 255, 0.88);\n}\n.host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state--ended {\n  color: rgba(0, 0, 0, 0.5);\n}\n.sendbird-theme--light .host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state--ended {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .host-view .host-view__main .host-view__info .host-view__info__wrapper .event-state--ended {\n  background-color: var(--sendbird-dark-background-400);\n}\n.host-view .host-view__main .host-view__info .host-view__info__wrapper .host-view__title__wrapper {\n  display: flex;\n  align-items: center;\n}\n.host-view .host-view__main .host-view__info .host-view__info__wrapper .host-view__title__wrapper .host-view__title {\n  font-size: 20px;\n  font-weight: 700;\n  line-height: 1.43;\n  color: rgba(255, 255, 255, 0.88);\n}\n.host-view .host-view__main .host-view__info .host-view__info__wrapper .host-view__detail {\n  margin-top: 4px;\n  font-size: 14px;\n  line-height: 1.43;\n  color: rgba(255, 255, 255, 0.5);\n}\n.host-view .host-view__main .host-view__info .host-view__info__wrapper .host-view__host-name {\n  margin-top: 16px;\n  font-size: 14px;\n  font-weight: 700;\n  line-height: 1.43;\n  color: rgba(255, 255, 255, 0.88);\n}";
styleInject(css_248z$c);

var _path$6;

function _extends$h() { _extends$h = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$h.apply(this, arguments); }

var SvgIconsSettingsFilled = function SvgIconsSettingsFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$h({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$6 || (_path$6 = /*#__PURE__*/React__default.createElement("path", {
    d: "M32 2.667A5.333 5.333 0 0 1 37.333 8v.24A4.4 4.4 0 0 0 40 12.267a4.4 4.4 0 0 0 4.853-.88l.16-.16a5.333 5.333 0 0 1 7.547 0 5.333 5.333 0 0 1 0 7.546l-.16.16a4.4 4.4 0 0 0-.88 4.854V24a4.4 4.4 0 0 0 4.027 2.667H56a5.333 5.333 0 1 1 0 10.666h-.24A4.4 4.4 0 0 0 51.733 40a4.4 4.4 0 0 0 .88 4.853l.16.16a5.333 5.333 0 0 1 0 7.547 5.333 5.333 0 0 1-7.546 0l-.16-.16a4.4 4.4 0 0 0-4.854-.88 4.4 4.4 0 0 0-2.666 4.027V56a5.333 5.333 0 0 1-10.667 0v-.24A4.4 4.4 0 0 0 24 51.733a4.4 4.4 0 0 0-4.853.88l-.16.16a5.333 5.333 0 0 1-7.547 0 5.333 5.333 0 0 1 0-7.546l.16-.16a4.4 4.4 0 0 0 .88-4.854 4.4 4.4 0 0 0-4.027-2.666H8A5.333 5.333 0 0 1 8 26.88h.24A4.4 4.4 0 0 0 12.267 24a4.4 4.4 0 0 0-.88-4.853l-.16-.16a5.333 5.333 0 0 1 0-7.547 5.333 5.333 0 0 1 7.546 0l.16.16a4.4 4.4 0 0 0 4.854.88H24a4.4 4.4 0 0 0 2.667-4.027V8A5.333 5.333 0 0 1 32 2.667zM32 24a8 8 0 1 0 0 16 8 8 0 0 0 0-16z",
    fillRule: "evenodd"
  })));
};

var _defs$3, _g$5;

function _extends$g() { _extends$g = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$g.apply(this, arguments); }

var SvgIconsCameraFilled = function SvgIconsCameraFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$g({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _defs$3 || (_defs$3 = /*#__PURE__*/React__default.createElement("defs", null, /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-camera-filled_svg__a"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M1368 0v1600H0V0h1368z"
  })), /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-camera-filled_svg__b"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M37.333 0a5.333 5.333 0 0 1 5.334 5.333v8L56.594 4.05a1.333 1.333 0 0 1 2.073 1.109v32.35a1.333 1.333 0 0 1-2.073 1.11l-13.927-9.285v8a5.333 5.333 0 0 1-5.334 5.334h-32A5.333 5.333 0 0 1 0 37.333v-32A5.333 5.333 0 0 1 5.333 0h32z"
  })))), _g$5 || (_g$5 = /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-camera-filled_svg__a)",
    transform: "translate(-208 -336)"
  }, /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-camera-filled_svg__b)",
    transform: "translate(210.667 346.667)"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M0 0h58.667v42.667H0V0z"
  })))));
};

var _defs$2, _g$4;

function _extends$f() { _extends$f = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$f.apply(this, arguments); }

var SvgIconsCameraOffFilled = function SvgIconsCameraOffFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$f({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _defs$2 || (_defs$2 = /*#__PURE__*/React__default.createElement("defs", null, /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-camera-off-filled_svg__a"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M1368 0v1600H0V0h1368z"
  })), /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-camera-off-filled_svg__b"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "m4.301.56.251.221L57.35 53.578a2.667 2.667 0 0 1-3.52 3.993l-.252-.221-11.007-11.008a5.335 5.335 0 0 1-5.238 4.325h-32A5.333 5.333 0 0 1 0 45.333v-32c0-2.6 1.862-4.767 4.325-5.238L.781 4.552A2.667 2.667 0 0 1 4.301.56zM37.333 8a5.333 5.333 0 0 1 5.334 5.333v8l13.927-9.284a1.333 1.333 0 0 1 2.073 1.109v32.35c0 .195-.042.379-.116.545L20.497 8h16.836z"
  })))), _g$4 || (_g$4 = /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-camera-off-filled_svg__a)",
    transform: "translate(-352 -336)"
  }, /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-camera-off-filled_svg__b)",
    transform: "translate(354.667 338.667)"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M0 0h58.667v58.13H0V0z"
  })))));
};

var _defs$1, _g$3;

function _extends$e() { _extends$e = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$e.apply(this, arguments); }

var SvgIconsMicFilled = function SvgIconsMicFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$e({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _defs$1 || (_defs$1 = /*#__PURE__*/React__default.createElement("defs", null, /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-mic-filled_svg__a"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M1368 0v1600H0V0h1368z"
  })), /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-mic-filled_svg__b"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M34.667 24a2.667 2.667 0 0 1 2.648 2.356l.018.31V32c0 9.408-6.96 17.19-16.01 18.48l.01.187v2.666h5.334a2.667 2.667 0 0 1 .31 5.316l-.31.018h-16a2.667 2.667 0 0 1-.311-5.316l.31-.018H16v-2.666c0-.064.002-.127.007-.19C7.164 49.218.319 41.759.01 32.643L0 32v-5.333a2.667 2.667 0 0 1 5.315-.311l.018.31V32c0 7.364 5.97 13.333 13.334 13.333 7.17 0 13.018-5.66 13.32-12.755L32 32v-5.333A2.667 2.667 0 0 1 34.667 24zm-16-24a8 8 0 0 1 8 8v24a8 8 0 1 1-16 0V8a8 8 0 0 1 8-8z"
  })))), _g$3 || (_g$3 = /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-mic-filled_svg__a)",
    transform: "translate(-496 -336)"
  }, /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-mic-filled_svg__b)",
    transform: "translate(509.79 339.124)"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M0 0h37.333v58.667H0V0z"
  })))));
};

var _defs, _g$2;

function _extends$d() { _extends$d = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$d.apply(this, arguments); }

var SvgIconsMicOffFilled = function SvgIconsMicOffFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$d({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _defs || (_defs = /*#__PURE__*/React__default.createElement("defs", null, /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-mic-off-filled_svg__a"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M1368 0v1600H0V0h1368z"
  })), /*#__PURE__*/React__default.createElement("clipPath", {
    id: "icons-mic-off-filled_svg__b"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "m4.301.56.251.221L57.35 53.578a2.667 2.667 0 0 1-3.52 3.993l-.252-.221-11.152-11.152a18.602 18.602 0 0 1-9.98 4.739l.012.187v2.667h5.333a2.667 2.667 0 0 1 .31 5.315l-.31.018h-16a2.667 2.667 0 0 1-.311-5.315l.31-.018h5.334v-2.667c0-.063.002-.126.007-.189-8.843-1.26-15.688-8.72-15.996-17.836l-.01-.641v-5.334a2.667 2.667 0 0 1 5.315-.31l.018.31v5.334c0 7.363 5.97 13.333 13.333 13.333 3.4 0 6.504-1.273 8.86-3.37l-3.783-3.781a8 8 0 0 1-13.078-6.182V25.56L.781 4.552A2.667 2.667 0 0 1 4.301.56zm41.49 23.898a2.667 2.667 0 0 1 2.649 2.355l.018.311v5.334c0 1.099-.095 2.176-.278 3.223l-5.056-5.055v-3.502a2.667 2.667 0 0 1 2.667-2.666zm-16-24a8 8 0 0 1 8 8v16.834l-16-16v-.834a8 8 0 0 1 8-8z"
  })))), _g$2 || (_g$2 = /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-mic-off-filled_svg__a)",
    transform: "translate(-640 -336)"
  }, /*#__PURE__*/React__default.createElement("g", {
    clipPath: "url(#icons-mic-off-filled_svg__b)",
    transform: "translate(642.667 338.667)"
  }, /*#__PURE__*/React__default.createElement("path", {
    d: "M0 0h58.13v59.124H0V0z"
  })))));
};

var _path$5, _path2;

function _extends$c() { _extends$c = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$c.apply(this, arguments); }

var SvgIconsScreenShareFilled = function SvgIconsScreenShareFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$c({
    width: 22,
    height: 22,
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$5 || (_path$5 = /*#__PURE__*/React__default.createElement("path", {
    fillRule: "evenodd",
    clipRule: "evenodd",
    d: "M.917 4.583a2.75 2.75 0 0 1 2.75-2.75h14.666a2.75 2.75 0 0 1 2.75 2.75v9.167a2.75 2.75 0 0 1-2.75 2.75H3.667a2.75 2.75 0 0 1-2.75-2.75V4.584Zm10.632.901a.916.916 0 0 0-.54-.175l-.059.002a.917.917 0 0 0-.276.06.87.87 0 0 0-.321.203L7.603 8.33a.92.92 0 1 0 1.301 1.3l1.182-1.184-.003 3.96a.92.92 0 0 0 .92.922l.059-.002a.92.92 0 0 0 .862-.917l.003-3.957 1.176 1.178a.918.918 0 1 0 1.302-1.3l-2.74-2.745a1.048 1.048 0 0 0-.074-.067l-.023-.018-.02-.015Z",
    fill: "#fff",
    fillOpacity: 0.88
  })), _path2 || (_path2 = /*#__PURE__*/React__default.createElement("path", {
    d: "M.917 18.334a.917.917 0 0 0 0 1.833h20.166a.917.917 0 1 0 0-1.834H.917Z",
    fill: "#fff",
    fillOpacity: 0.88
  })));
};

var _path$4;

function _extends$b() { _extends$b = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$b.apply(this, arguments); }

var SvgIconsLayoutFilled = function SvgIconsLayoutFilled(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$b({
    width: 22,
    height: 22,
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$4 || (_path$4 = /*#__PURE__*/React__default.createElement("path", {
    fillRule: "evenodd",
    clipRule: "evenodd",
    d: "M3.917 3.667a3 3 0 0 0-3 3v8.666a3 3 0 0 0 3 3h14.166a3 3 0 0 0 3-3V6.667a3 3 0 0 0-3-3H3.917Zm9 7.333a1 1 0 0 0-1 1v3.5a1 1 0 0 0 1 1h5.333a1 1 0 0 0 1-1V12a1 1 0 0 0-1-1h-5.334Z",
    fill: "#fff",
    fillOpacity: 0.88
  })));
};

var css_248z$b = "@import url(\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\");\nbody {\n  font-family: \"Roboto\", \"Verdana\", sans-serif;\n  font-size: 14px;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.spin {\n  animation: spin 1s linear infinite;\n}\n\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n.dark-background__screen-share {\n  background: var(--sendbird-dark-background-500) !important;\n}\n\n.control-bar {\n  display: flex;\n  align-items: center;\n  background-color: var(--sendbird-dark-background-600);\n}\n.control-bar .control-bar__left-buttons {\n  display: flex;\n  margin-left: 16px;\n}\n.control-bar .control-bar__left-buttons .control-bar__settings {\n  width: 22px;\n  height: 22px;\n  margin: 12px 27px 0 0;\n  cursor: pointer;\n}\n.control-bar .control-bar__left-buttons .control-bar__video {\n  width: 22px;\n  height: 22px;\n  margin: 12px 27px 0 0;\n  cursor: pointer;\n}\n.control-bar .control-bar__left-buttons .control-bar__audio__wrapper {\n  display: flex;\n  margin: 12px 27px 0 0;\n}\n.control-bar .control-bar__left-buttons .control-bar__audio__wrapper .control-bar__audio {\n  margin-right: 27px;\n  width: 22px;\n  height: 22px;\n  cursor: pointer;\n}\n.control-bar .control-bar__left-buttons .control-bar__screen-share {\n  display: flex;\n  height: 22px;\n  margin: 12px 27px 0 0;\n  cursor: pointer;\n}\n.control-bar .control-bar__left-buttons .control-bar__screen-share svg {\n  margin-right: 27px;\n}\n.control-bar .control-bar__left-buttons .control-bar__screen-share .control-bar__screen-share__stop {\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: column;\n  align-items: center;\n  padding: 6px 16px;\n  width: 160px;\n  height: 32px;\n  border: 1px solid rgba(255, 255, 255, 0.38);\n  border-radius: 4px;\n  font-weight: 500;\n  font-size: 14px;\n  line-height: 20px;\n  color: #FFFFFF;\n}\n.control-bar .control-bar__right-buttons {\n  display: flex;\n  align-items: center;\n  margin-left: auto;\n  margin-right: 16px;\n}\n.control-bar .control-bar__right-buttons .participant-icon, .control-bar .control-bar__right-buttons .participant-icon--red {\n  width: 8px;\n  height: 8px;\n  margin: 0 4px;\n  border-radius: 50%;\n}\n.control-bar .control-bar__right-buttons .participant-icon--red {\n  background-color: var(--sendbird-dark-error-300);\n}\n.control-bar .control-bar__right-buttons .control-bar__duration {\n  font-size: 14px;\n  color: rgba(255, 255, 255, 0.88);\n}\n.control-bar .control-bar__right-buttons .control-bar__start-live, .control-bar .control-bar__right-buttons .control-bar__end-live {\n  padding: 6px 16px;\n  font-size: 14px;\n  font-weight: 500;\n  color: rgba(0, 0, 0, 0.88);\n  cursor: pointer;\n}\n.control-bar .control-bar__right-buttons .control-bar__end-live {\n  background-color: var(--sendbird-dark-primary-200);\n}\n.control-bar .control-bar__right-buttons .control-bar__start-live {\n  background-color: var(--sendbird-dark-error-200);\n}";
styleInject(css_248z$b);

var _rect$4, _rect2$3;

function _extends$a() { _extends$a = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$a.apply(this, arguments); }

var SvgIconsScreenShareBottomRight = function SvgIconsScreenShareBottomRight(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$a({
    width: 32,
    height: 32,
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _rect$4 || (_rect$4 = /*#__PURE__*/React__default.createElement("rect", {
    x: 2.5,
    y: 6.5,
    width: 27,
    height: 19,
    rx: 1.5,
    stroke: "#fff",
    strokeOpacity: 0.88
  })), _rect2$3 || (_rect2$3 = /*#__PURE__*/React__default.createElement("rect", {
    x: 20,
    y: 18,
    width: 8,
    height: 6,
    rx: 1,
    fill: "#fff",
    fillOpacity: 0.88
  })));
};

var _rect$3, _rect2$2;

function _extends$9() { _extends$9 = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$9.apply(this, arguments); }

var SvgIconsScreenShareBottomLeft = function SvgIconsScreenShareBottomLeft(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$9({
    width: 32,
    height: 32,
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _rect$3 || (_rect$3 = /*#__PURE__*/React__default.createElement("rect", {
    x: 2.5,
    y: 6.5,
    width: 27,
    height: 19,
    rx: 1.5,
    stroke: "#fff",
    strokeOpacity: 0.88
  })), _rect2$2 || (_rect2$2 = /*#__PURE__*/React__default.createElement("rect", {
    x: 4,
    y: 18,
    width: 8,
    height: 6,
    rx: 1,
    fill: "#fff",
    fillOpacity: 0.88
  })));
};

var _rect$2, _rect2$1;

function _extends$8() { _extends$8 = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$8.apply(this, arguments); }

var SvgIconsScreenShareTopRight = function SvgIconsScreenShareTopRight(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$8({
    width: 32,
    height: 32,
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _rect$2 || (_rect$2 = /*#__PURE__*/React__default.createElement("rect", {
    x: 2.5,
    y: 6.5,
    width: 27,
    height: 19,
    rx: 1.5,
    stroke: "#fff",
    strokeOpacity: 0.88
  })), _rect2$1 || (_rect2$1 = /*#__PURE__*/React__default.createElement("rect", {
    x: 20,
    y: 8,
    width: 8,
    height: 6,
    rx: 1,
    fill: "#fff",
    fillOpacity: 0.88
  })));
};

var _rect$1, _rect2;

function _extends$7() { _extends$7 = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$7.apply(this, arguments); }

var SvgIconsScreenShareTopLeft = function SvgIconsScreenShareTopLeft(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$7({
    width: 32,
    height: 32,
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _rect$1 || (_rect$1 = /*#__PURE__*/React__default.createElement("rect", {
    x: 2.5,
    y: 6.5,
    width: 27,
    height: 19,
    rx: 1.5,
    stroke: "#fff",
    strokeOpacity: 0.88
  })), _rect2 || (_rect2 = /*#__PURE__*/React__default.createElement("rect", {
    x: 4,
    y: 8,
    width: 8,
    height: 6,
    rx: 1,
    fill: "#fff",
    fillOpacity: 0.88
  })));
};

var _rect;

function _extends$6() { _extends$6 = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$6.apply(this, arguments); }

var SvgIconsScreenShareHidden = function SvgIconsScreenShareHidden(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$6({
    width: 32,
    height: 32,
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _rect || (_rect = /*#__PURE__*/React__default.createElement("rect", {
    x: 2.5,
    y: 6.5,
    width: 27,
    height: 19,
    rx: 1.5,
    stroke: "#fff",
    strokeOpacity: 0.88
  })));
};

var css_248z$a = "@import url(\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\");\nbody {\n  font-family: \"Roboto\", \"Verdana\", sans-serif;\n  font-size: 14px;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.spin {\n  animation: spin 1s linear infinite;\n}\n\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n.screen-share {\n  width: 480px;\n  padding: 18px 24px;\n  background-color: var(--sendbird-dark-background-500);\n  color: #fff;\n}\n.screen-share .title {\n  font-size: 20px;\n  font-weight: 700;\n  margin-bottom: 20px;\n}\n.screen-share .screen-share__label {\n  font-size: 12px;\n  line-height: 1;\n  margin-bottom: 8px;\n  font-style: normal;\n  font-weight: 400;\n}\n.screen-share .close {\n  position: absolute;\n  top: 20px;\n  right: 20px;\n  cursor: pointer;\n}\n.screen-share .screen-share__label {\n  font-size: 12px;\n  line-height: 1;\n}\n.screen-share .screen-share__preview__container {\n  overflow: auto;\n  max-width: 100%;\n  box-sizing: border-box;\n  margin-bottom: 24px;\n}\n.screen-share .screen-share__preview__container .screen-share__preview__screen {\n  position: relative;\n  background: var(--sendbird-dark-background-600);\n  width: 100%;\n  aspect-ratio: 16/9;\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 300px;\n  color: rgba(255, 255, 255, 0.5);\n  text-align: center;\n}\n.screen-share .screen-share__preview__container .screen-share__preview__screen p {\n  line-height: normal;\n  display: inline-block;\n  vertical-align: middle;\n}\n.screen-share .screen-share__preview__container .screen-share__preview__screen .screen-share__preview__camera, .screen-share .screen-share__preview__container .screen-share__preview__screen .screen-share__preview__camera--top_left, .screen-share .screen-share__preview__container .screen-share__preview__screen .screen-share__preview__camera--top_right, .screen-share .screen-share__preview__container .screen-share__preview__screen .screen-share__preview__camera--bottom_left, .screen-share .screen-share__preview__container .screen-share__preview__screen .screen-share__preview__camera--bottom_right {\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 20%;\n  aspect-ratio: 16/9;\n  background-color: var(--sendbird-dark-background-700);\n  line-height: 1;\n}\n.screen-share .screen-share__preview__container .screen-share__preview__screen .screen-share__preview__camera--bottom_right {\n  top: 75%;\n  left: 75%;\n}\n.screen-share .screen-share__preview__container .screen-share__preview__screen .screen-share__preview__camera--bottom_left {\n  top: 75%;\n  left: 5%;\n}\n.screen-share .screen-share__preview__container .screen-share__preview__screen .screen-share__preview__camera--top_right {\n  top: 5%;\n  left: 75%;\n}\n.screen-share .screen-share__preview__container .screen-share__preview__screen .screen-share__preview__camera--top_left {\n  top: 5%;\n  left: 5%;\n}\n.screen-share .screen-share__preview__container .screen-share__preview__screen .screen-share__preview__camera--hidden {\n  display: none;\n}\n.screen-share .screen-share__layout-container {\n  display: flex;\n}\n.screen-share .screen-share__layout-container svg {\n  margin-right: 8px;\n  padding: 3px;\n  background: var(--sendbird-dark-background-500);\n  border: 1px solid #161616;\n  border-radius: 4px;\n}\n.screen-share .screen-share__layout-container svg:hover {\n  cursor: pointer;\n  background: var(--sendbird-dark-background-700);\n}\n.screen-share .buttons {\n  display: flex;\n  flex-direction: row;\n  justify-content: right;\n  padding-top: 30px;\n}\n.screen-share .buttons .major-button, .screen-share .buttons .minor-button {\n  margin-left: 8px;\n  padding: 10px 16px;\n  border-radius: 4px;\n}\n.screen-share .buttons .major-button:hover, .screen-share .buttons .minor-button:hover {\n  cursor: pointer;\n  opacity: 0.9;\n}\n.screen-share .buttons .minor-button {\n  border: solid 1px rgba(255, 255, 255, 0.38);\n}\n.screen-share .buttons .major-button {\n  color: rgba(255, 255, 255, 0.88);\n}\n.sendbird-theme--light .screen-share .buttons .major-button {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .screen-share .buttons .major-button {\n  background-color: var(--sendbird-dark-primary-200);\n}";
styleInject(css_248z$a);

function ScreenShare(props) {
    var _this = this;
    var liveEvent = props.liveEvent, onClose = props.onClose;
    var CameraOverlayPosition = {
        'TOP_LEFT': 'top_left',
        'TOP_RIGHT': 'top_right',
        'BOTTOM_LEFT': 'bottom_left',
        'BOTTOM_RIGHT': 'bottom_right',
        'HIDDEN': 'hidden',
    };
    var _a = useState(CameraOverlayPosition.BOTTOM_RIGHT), position = _a[0], setPosition = _a[1];
    return (React__default__default.createElement("div", { className: "screen-share" },
        React__default__default.createElement("div", { className: 'close', onClick: function () { return onClose(); } },
            React__default__default.createElement(SvgIconsClose, { width: 22, height: 22, viewBox: '0 0 60 60' })),
        React__default__default.createElement("div", { className: 'title' }, "Share screen"),
        React__default__default.createElement("div", { className: "screen-share__label" }, "Preview"),
        React__default__default.createElement("div", { className: "screen-share__preview__container" },
            React__default__default.createElement("div", { className: "screen-share__preview__screen" },
                React__default__default.createElement("div", { className: "screen-share__preview__camera--".concat(position) }, "Camera"),
                React__default__default.createElement("p", null, "The screen you chose to share will be shown here."))),
        React__default__default.createElement("div", { className: "screen-share__label" }, "Layout"),
        React__default__default.createElement("div", { className: "screen-share__layout-container" },
            React__default__default.createElement(SvgIconsScreenShareBottomRight, { width: 32, height: 32, fill: "#000", onClick: function () { return setPosition(CameraOverlayPosition.BOTTOM_RIGHT); } }),
            React__default__default.createElement(SvgIconsScreenShareBottomLeft, { width: 32, height: 32, fill: "#000", onClick: function () { return setPosition(CameraOverlayPosition.BOTTOM_LEFT); } }),
            React__default__default.createElement(SvgIconsScreenShareTopRight, { width: 32, height: 32, fill: "#000", onClick: function () { return setPosition(CameraOverlayPosition.TOP_RIGHT); } }),
            React__default__default.createElement(SvgIconsScreenShareTopLeft, { width: 32, height: 32, fill: "#000", onClick: function () { return setPosition(CameraOverlayPosition.TOP_LEFT); } }),
            React__default__default.createElement(SvgIconsScreenShareHidden, { width: 32, height: 32, fill: "#000", onClick: function () { return setPosition(CameraOverlayPosition.HIDDEN); } })),
        React__default__default.createElement("div", { className: 'buttons' },
            React__default__default.createElement("div", { className: 'minor-button', onClick: function () { return onClose(); } }, "Cancel"),
            React__default__default.createElement("div", { className: 'major-button', onClick: function () { return __awaiter$2(_this, void 0, void 0, function () {
                    return __generator(this, function (_a) {
                        switch (_a.label) {
                            case 0: return [4 /*yield*/, liveEvent.setScreenShareOptions({
                                    // @ts-ignore
                                    cameraOverlayPosition: position,
                                })];
                            case 1:
                                _a.sent();
                                onClose();
                                return [2 /*return*/];
                        }
                    });
                }); } }, "Save"))));
}

function Duration(props) {
    var liveEvent = props.liveEvent;
    var _a = useState(0), duration = _a[0], setDuration = _a[1];
    useEffect(function () {
        var interval = setInterval(function () {
            setDuration(liveEvent.duration);
        }, 1000);
        return function () { return clearInterval(interval); };
    }, []);
    function padTo2Digits(num) {
        return num.toString().padStart(2, '0');
    }
    function getHHMMSS(milliseconds) {
        var seconds = Math.floor(milliseconds / 1000);
        var minutes = Math.floor(seconds / 60);
        var hours = Math.floor(minutes / 60);
        seconds = seconds % 60;
        minutes = minutes % 60;
        return "".concat(padTo2Digits(hours), ":").concat(padTo2Digits(minutes), ":").concat(padTo2Digits(seconds));
    }
    return (React__default__default.createElement("div", { className: "control-bar__duration" }, getHHMMSS(duration)));
}

function ControlBar(props) {
    var _this = this;
    var liveEvent = props.liveEvent, onStart = props.onStart, onEnd = props.onEnd, onSettings = props.onSettings;
    var _a = useState(liveEvent.state === sendbirdLive_min.exports.LiveEventState.ONGOING), ongoing = _a[0], setOngoing = _a[1];
    var _b = useState(true), audio = _b[0], setAudio = _b[1];
    var _c = useState(true), video = _c[0], setVideo = _c[1];
    var _d = useState(false), isScreenSharing = _d[0], setIsScreenSharing = _d[1];
    useModal('');
    var _f = useModal('', 'dark-background__screen-share'), ScreenShareModal = _f[0], openScreenShareModal = _f[1], closeScreenShareModal = _f[2];
    var stringSet = useContext(SendbirdLiveContext).stringSet;
    var startLiveEvent = function () { return __awaiter$2(_this, void 0, void 0, function () {
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, liveEvent.startEvent({ turnAudioOn: true, turnVideoOn: true })];
                case 1:
                    _a.sent();
                    setOngoing(true);
                    onStart(liveEvent);
                    return [2 /*return*/];
            }
        });
    }); };
    var toggleVideo = function (on) {
        on ? liveEvent.startVideo() : liveEvent.stopVideo();
        setVideo(on);
    };
    var toggleAudio = function (on) {
        on ? liveEvent.unmuteAudioInput() : liveEvent.muteAudioInput();
        setAudio(on);
    };
    var startScreenSharing = function () { return __awaiter$2(_this, void 0, void 0, function () {
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, liveEvent.startScreenShare()];
                case 1:
                    _a.sent();
                    setIsScreenSharing(true);
                    return [2 /*return*/];
            }
        });
    }); };
    var stopScreenSharing = function () {
        liveEvent.stopScreenShare();
        setIsScreenSharing(false);
    };
    return (React__default__default.createElement("div", { className: "control-bar" },
        React__default__default.createElement("div", { className: "control-bar__left-buttons" },
            React__default__default.createElement("div", { className: "control-bar__settings" },
                React__default__default.createElement(SvgIconsSettingsFilled, { viewBox: "0 0 64 64", width: 22, height: 22, fill: "#ccc", onClick: function () { return onSettings(liveEvent); } })),
            React__default__default.createElement("div", { className: "control-bar__video" }, video
                ? React__default__default.createElement(SvgIconsCameraFilled, { viewBox: "0 0 64 64", width: 22, height: 22, fill: "#ccc", onClick: function () { return toggleVideo(false); } })
                : React__default__default.createElement(SvgIconsCameraOffFilled, { viewBox: "0 0 64 64", width: 22, height: 22, fill: "#ccc", onClick: function () { return toggleVideo(true); } })),
            React__default__default.createElement("div", { className: "control-bar__audio__wrapper" },
                React__default__default.createElement("div", { className: "control-bar__audio" }, audio
                    ? React__default__default.createElement(SvgIconsMicFilled, { viewBox: "0 0 64 64", width: 22, height: 22, fill: "#ccc", onClick: function () { return toggleAudio(false); } })
                    : React__default__default.createElement(SvgIconsMicOffFilled, { viewBox: "0 0 64 64", width: 22, height: 22, fill: "#ccc", onClick: function () { return toggleAudio(true); } })),
                React__default__default.createElement("div", { className: "control-bar__volume" })),
            React__default__default.createElement("div", { className: "control-bar__screen-share" },
                React__default__default.createElement(SvgIconsScreenShareFilled, { width: 22, height: 22, fill: "#ccc", onClick: function () { return startScreenSharing(); } }),
                React__default__default.createElement(SvgIconsLayoutFilled, { width: 22, height: 22, fill: "#ccc", onClick: function () { return openScreenShareModal(); } }),
                isScreenSharing && React__default__default.createElement("div", { className: "control-bar__screen-share__stop", onClick: function () { return stopScreenSharing(); } }, "Stop ScreenShare"))),
        React__default__default.createElement("div", { className: "control-bar__right-buttons" },
            ongoing && React__default__default.createElement("div", { className: "participant-icon--red" }),
            ongoing && React__default__default.createElement(Duration, { liveEvent: liveEvent }),
            ongoing
                ? React__default__default.createElement("div", { className: "control-bar__end-live", onClick: function () { onEnd(liveEvent); } }, stringSet.LIVE_EVENT_END_DIALOG_OPTION_END)
                : React__default__default.createElement("div", { className: "control-bar__start-live", onClick: startLiveEvent }, stringSet.START_LIVE_EVENT_HEADER_BUTTON)),
        React__default__default.createElement(ScreenShareModal, null,
            React__default__default.createElement(ScreenShare, { liveEvent: liveEvent, onClose: function () {
                    closeScreenShareModal();
                } }))));
}

var css_248z$9 = ".confirm-end-dialog {\n  width: 480px;\n  padding: 18px 24px;\n  background: #333;\n  color: #fff;\n}\n.confirm-end-dialog .header {\n  display: flex;\n  align-items: center;\n}\n.confirm-end-dialog .header .title {\n  flex: 1;\n  font-size: 18px;\n}\n.confirm-end-dialog .header .close:hover {\n  cursor: pointer;\n}\n.confirm-end-dialog .buttons {\n  display: flex;\n  flex-direction: row;\n  justify-content: right;\n  padding-top: 50px;\n}\n.confirm-end-dialog .buttons .major-button, .confirm-end-dialog .buttons .minor-button {\n  margin-left: 8px;\n  padding: 10px 16px;\n  border-radius: 4px;\n}\n.confirm-end-dialog .buttons .major-button:hover, .confirm-end-dialog .buttons .minor-button:hover {\n  cursor: pointer;\n  opacity: 0.9;\n}\n.confirm-end-dialog .buttons .minor-button {\n  border: solid 1px rgba(255, 255, 255, 0.38);\n}\n.confirm-end-dialog .buttons .major-button {\n  background-color: #f66161;\n}";
styleInject(css_248z$9);

function ConfirmEndDialog(_a) {
    var _b = _a.onExit, onExit = _b === void 0 ? function () { } : _b, _c = _a.onClose, onClose = _c === void 0 ? function () { } : _c;
    var stringSet = useContext(SendbirdLiveContext).stringSet;
    return React__default__default.createElement("div", { className: 'confirm-end-dialog' },
        React__default__default.createElement("div", { className: 'header' },
            React__default__default.createElement("div", { className: 'title' }, stringSet.LIVE_EVENT_END_DIALOG_DESCRIPTION),
            React__default__default.createElement("div", { className: 'close', onClick: function () { return onClose(); } },
                React__default__default.createElement(SvgIconsClose, { width: 22, height: 22, viewBox: '0 0 60 60', fill: '#fff' }))),
        React__default__default.createElement("div", { className: 'buttons' },
            React__default__default.createElement("div", { className: 'minor-button', onClick: function () { return onClose(); } }, "Cancel"),
            React__default__default.createElement("div", { className: 'minor-button', onClick: function () { return onExit(false); } }, stringSet.LIVE_EVENT_END_DIALOG_OPTION_EXIT),
            React__default__default.createElement("div", { className: 'major-button', onClick: function () { return onExit(true); } }, stringSet.LIVE_EVENT_END_DIALOG_OPTION_END)));
}

var _path$3;

function _extends$5() { _extends$5 = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$5.apply(this, arguments); }

var SvgIconsChevronRight = function SvgIconsChevronRight(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$5({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$3 || (_path$3 = /*#__PURE__*/React__default.createElement("path", {
    d: "M22.114 46.114a2.667 2.667 0 0 0 3.772 3.772l16-16a2.667 2.667 0 0 0 0-3.772l-16-16a2.667 2.667 0 0 0-3.772 3.772L36.23 32 22.114 46.114z",
    fillRule: "evenodd"
  })));
};

var _g$1;

function _extends$4() { _extends$4 = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$4.apply(this, arguments); }

var SvgIconsToggleon = function SvgIconsToggleon(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$4({
    width: 88,
    height: 48,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _g$1 || (_g$1 = /*#__PURE__*/React__default.createElement("g", {
    fillRule: "evenodd"
  }, /*#__PURE__*/React__default.createElement("rect", {
    x: 4,
    y: 4,
    width: 80,
    height: 40,
    rx: 20
  }), /*#__PURE__*/React__default.createElement("circle", {
    fill: "#FFF",
    cx: 64,
    cy: 24,
    r: 12
  }), /*#__PURE__*/React__default.createElement("path", {
    d: "M64 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4h40zm0 2H24C14.059 6 6 14.059 6 24c0 9.764 7.774 17.712 17.47 17.992L24 42h40c9.941 0 18-8.059 18-18 0-9.764-7.774-17.712-17.47-17.992L64 6z",
    fill: "#FFF"
  }), /*#__PURE__*/React__default.createElement("path", {
    d: "M64 0H24C10.745 0 0 10.745 0 24s10.745 24 24 24h40c13.255 0 24-10.745 24-24S77.255 0 64 0zm0 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4h40z"
  }))));
};

var _g;

function _extends$3() { _extends$3 = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$3.apply(this, arguments); }

var SvgIconsToggleoff = function SvgIconsToggleoff(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$3({
    width: 88,
    height: 48,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _g || (_g = /*#__PURE__*/React__default.createElement("g", {
    fillRule: "evenodd"
  }, /*#__PURE__*/React__default.createElement("rect", {
    x: 4,
    y: 4,
    width: 80,
    height: 40,
    rx: 20
  }), /*#__PURE__*/React__default.createElement("circle", {
    fill: "#FFF",
    cx: 24,
    cy: 24,
    r: 12
  }), /*#__PURE__*/React__default.createElement("path", {
    d: "M64 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4h40zm0 2H24C14.059 6 6 14.059 6 24c0 9.764 7.774 17.712 17.47 17.992L24 42h40c9.941 0 18-8.059 18-18 0-9.764-7.774-17.712-17.47-17.992L64 6z",
    fill: "#FFF"
  }), /*#__PURE__*/React__default.createElement("path", {
    d: "M64 0H24C10.745 0 0 10.745 0 24s10.745 24 24 24h40c13.255 0 24-10.745 24-24S77.255 0 64 0zm0 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4h40z"
  }))));
};

var _path$2;

function _extends$2() { _extends$2 = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$2.apply(this, arguments); }

var SvgIconsOperator = function SvgIconsOperator(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$2({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$2 || (_path$2 = /*#__PURE__*/React__default.createElement("path", {
    d: "M29.83 6.45a2.667 2.667 0 0 1 4.34 0l11.697 16.374L57 13.918c1.88-1.504 4.573.054 4.32 2.35l-.047.29-8 37.334A2.667 2.667 0 0 1 50.667 56H13.333a2.667 2.667 0 0 1-2.607-2.108l-8-37.333c-.525-2.452 2.315-4.207 4.273-2.641l11.132 8.906zM32 12.587l-11.163 15.63a2.667 2.667 0 0 1-3.836.532l-7.497-5.997 5.984 27.915h33.021l5.984-27.915L47 28.749a2.667 2.667 0 0 1-3.632-.281l-.204-.251L32 12.587zM32 32a5.333 5.333 0 1 1 0 10.667A5.333 5.333 0 0 1 32 32z",
    fillRule: "evenodd"
  })));
};

var _path$1;

function _extends$1() { _extends$1 = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends$1.apply(this, arguments); }

var SvgIconsMembers = function SvgIconsMembers(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends$1({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path$1 || (_path$1 = /*#__PURE__*/React__default.createElement("path", {
    d: "M34.667 37.333c7.17 0 13.018 5.66 13.32 12.755l.013.579V56a2.667 2.667 0 0 1-5.315.311L42.667 56v-5.333a8 8 0 0 0-7.53-7.987l-.47-.013H13.333a8 8 0 0 0-7.986 7.53l-.014.47V56a2.667 2.667 0 0 1-5.315.311L0 56v-5.333c0-7.17 5.66-13.019 12.755-13.321l.578-.013h21.334zM54 37.765a13.334 13.334 0 0 1 9.986 12.297l.014.605V56a2.667 2.667 0 0 1-5.315.311L58.667 56v-5.331a8 8 0 0 0-6-7.74A2.667 2.667 0 0 1 54 37.765zM24 5.333c7.364 0 13.333 5.97 13.333 13.334C37.333 26.03 31.363 32 24 32c-7.364 0-13.333-5.97-13.333-13.333 0-7.364 5.97-13.334 13.333-13.334zm19.328.43a13.333 13.333 0 0 1 0 25.834 2.667 2.667 0 0 1-1.323-5.167 8 8 0 0 0 0-15.5 2.667 2.667 0 1 1 1.323-5.167zM24 10.667a8 8 0 1 0 0 16 8 8 0 0 0 0-16z",
    fillRule: "evenodd"
  })));
};

var _path;

function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

var SvgIconsFreeze = function SvgIconsFreeze(props) {
  return /*#__PURE__*/React__default.createElement("svg", _extends({
    width: 64,
    height: 64,
    xmlns: "http://www.w3.org/2000/svg"
  }, props), _path || (_path = /*#__PURE__*/React__default.createElement("path", {
    d: "m41.636 3.226.251.222a2.667 2.667 0 0 1 .222 3.52l-.222.251-7.219 7.218V27.38l11.209-6.472 2.643-9.86a2.667 2.667 0 0 1 5.218 1.051l-.067.329-2.237 8.35 8.352 2.24a2.667 2.667 0 0 1 1.952 2.938l-.067.328a2.667 2.667 0 0 1-2.937 1.952l-.329-.066-9.861-2.643L37.334 32l11.209 6.47 9.862-2.64.329-.067a2.667 2.667 0 0 1 2.937 1.952l.067.328a2.667 2.667 0 0 1-1.952 2.938l-8.353 2.237 2.238 8.353.067.329a2.667 2.667 0 0 1-5.218 1.052l-2.643-9.861-11.209-6.472v12.944l7.219 7.218a2.667 2.667 0 0 1-3.52 3.993l-.251-.222L32 54.437l-6.114 6.115a2.667 2.667 0 0 1-3.52.222l-.251-.222a2.667 2.667 0 0 1-.222-3.52l.222-.251 7.218-7.22V36.62l-11.209 6.47-2.642 9.863a2.667 2.667 0 0 1-5.218-1.052l.067-.329 2.236-8.351-8.35-2.24a2.667 2.667 0 0 1-1.953-2.937l.067-.328a2.667 2.667 0 0 1 2.937-1.952l.329.066 9.861 2.642L26.667 32l-11.209-6.472-9.86 2.643-.329.066a2.667 2.667 0 0 1-2.937-1.952l-.067-.328a2.667 2.667 0 0 1 1.952-2.938l8.35-2.239-2.235-8.351-.067-.329a2.667 2.667 0 0 1 5.218-1.052l2.642 9.862 11.209 6.47V14.439L22.116 7.22a2.667 2.667 0 0 1 3.52-3.993l.251.222 6.114 6.112 6.115-6.112a2.667 2.667 0 0 1 3.52-.222z",
    fillRule: "evenodd"
  })));
};

var css_248z$8 = ".event-detail-view {\n  position: relative;\n  max-width: 400px;\n  background: #fff;\n}\n.event-detail-view .header {\n  display: flex;\n  align-items: center;\n  padding: 24px;\n  border-bottom: 1px #ddd solid;\n}\n.event-detail-view .header .title {\n  flex: 1;\n  font-size: 18px;\n}\n.event-detail-view .header .close:hover {\n  cursor: pointer;\n}\n.event-detail-view .event-summary {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 24px;\n  border-bottom: 1px #ddd solid;\n}\n.event-detail-view .event-summary .profile {\n  width: 80px;\n  height: 80px;\n  background: #eee;\n  border-radius: 60px;\n  margin-bottom: 8px;\n}\n.event-detail-view .event-summary .title {\n  font-size: 18px;\n  font-weight: bold;\n  color: #333;\n}\n.event-detail-view .event-menu {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-items: center;\n  padding: 10px;\n  border-bottom: 1px #ddd solid;\n}\n.event-detail-view .event-menu .icon {\n  margin-right: 16px;\n}\n.event-detail-view .event-menu .label {\n  flex: 1;\n}\n.event-detail-view .event-menu .count {\n  background: #ddd;\n  padding: 4px 8px;\n  border-radius: 15px;\n  margin: 0 4px;\n}\n.event-detail-view .event-menu .guide {\n  flex-basis: 100%;\n  color: #999;\n  line-height: 1.43;\n  padding: 8px 4px 10px 4px;\n}\n.event-detail-view .event-info {\n  padding: 16px;\n  border-bottom: 1px #ddd solid;\n}\n.event-detail-view .event-info .label {\n  font-size: 12px;\n  font-weight: bold;\n  color: #999;\n  margin-bottom: 8px;\n}\n.event-detail-view .event-info .value {\n  font-size: 14px;\n  color: #333;\n  line-height: 1.43;\n}\n.event-detail-view .button:hover {\n  cursor: pointer;\n  background: #eee;\n}";
styleInject(css_248z$8);

function EventDetailView(_a) {
    var liveEvent = _a.liveEvent, _b = _a.onHostsClick, onHostsClick = _b === void 0 ? function () { } : _b, _c = _a.onParticipantsClick, onParticipantsClick = _c === void 0 ? function () { } : _c, _d = _a.onClose, onClose = _d === void 0 ? function () { } : _d;
    var openChannel = liveEvent.openChannel;
    var _e = useState(''), title = _e[0], setTitle = _e[1];
    var _f = useState(openChannel.isFrozen), frozen = _f[0], setFrozen = _f[1];
    var _g = useState(liveEvent.userIdsForHost.length), hostCount = _g[0], setHostCount = _g[1];
    var _h = useState("".concat(openChannel.participantCount)), participantCount = _h[0], setParticipantCount = _h[1];
    useEffect(function () {
        setTitle(openChannel.name || 'Untitled');
    }, [openChannel.name]);
    useEffect(function () {
        setHostCount(openChannel.operators.length);
    }, [liveEvent.userIdsForHost.length]);
    useEffect(function () {
        if (openChannel.participantCount > 1000)
            setParticipantCount("".concat(Math.floor(openChannel.participantCount / 1000), "k"));
        else
            setParticipantCount("".concat(openChannel.participantCount));
    }, [openChannel.participantCount]);
    useEffect(function () {
        setFrozen(liveEvent.openChannel.isFrozen);
    }, [openChannel.isFrozen]);
    return React__default__default.createElement("div", { className: 'event-detail-view' },
        React__default__default.createElement("div", { className: 'header' },
            React__default__default.createElement("div", { className: 'title' }, "Live event information"),
            React__default__default.createElement("div", { className: 'close', onClick: function () { return onClose(); } },
                React__default__default.createElement(SvgIconsClose, { width: 22, height: 22, viewBox: '0 0 60 60' }))),
        React__default__default.createElement("div", { className: 'event-summary' },
            React__default__default.createElement("div", { className: 'profile' }, liveEvent.host ?
                React__default__default.createElement("img", { src: liveEvent.host.profileURL }) :
                React__default__default.createElement(SvgIconsUser, { width: 80, height: 80, viewBox: '-4 -4 20 20', fill: '#fff' })),
            React__default__default.createElement("div", { className: 'title' }, title)),
        React__default__default.createElement("div", { className: 'event-menu button', onClick: function () { return onHostsClick(); } },
            React__default__default.createElement(SvgIconsOperator, { className: 'icon', width: 24, height: 24, viewBox: '-10 -10 80 80', fill: '#C2A9FA' }),
            React__default__default.createElement("div", { className: 'label' }, "Hosts"),
            React__default__default.createElement("div", { className: 'count' }, hostCount),
            React__default__default.createElement(SvgIconsChevronRight, { width: 24, height: 24, viewBox: '-10 -10 80 80' })),
        React__default__default.createElement("div", { className: 'event-menu button', onClick: function () { return onParticipantsClick(); } },
            React__default__default.createElement(SvgIconsMembers, { className: 'icon', width: 24, height: 24, viewBox: '-10 -10 80 80', fill: '#C2A9FA' }),
            React__default__default.createElement("div", { className: 'label' }, "Participants"),
            React__default__default.createElement("div", { className: 'count' }, participantCount),
            React__default__default.createElement(SvgIconsChevronRight, { width: 24, height: 24, viewBox: '-10 -10 80 80' })),
        React__default__default.createElement("div", { className: 'event-menu' },
            React__default__default.createElement(SvgIconsFreeze, { className: 'icon', width: 24, height: 24, viewBox: '-10 -10 80 80', fill: '#C2A9FA' }),
            React__default__default.createElement("div", { className: 'label' }, "Freeze channel"),
            React__default__default.createElement("div", { className: 'toggle' }, !frozen ?
                React__default__default.createElement(SvgIconsToggleoff, { width: 44, height: 24, viewBox: '2 -8 80 60', fill: '#777' }) :
                React__default__default.createElement(SvgIconsToggleon, { width: 44, height: 24, viewBox: '2 -8 80 60', fill: '#C2A9FA' })),
            React__default__default.createElement("div", { className: 'guide' }, "Freezing a channel lets only operators to communicate in the channel.")),
        React__default__default.createElement("div", { className: 'event-info' },
            React__default__default.createElement("div", { className: 'label' }, "Live event ID"),
            React__default__default.createElement("div", { className: 'value' }, liveEvent.liveEventId)),
        React__default__default.createElement("div", { className: 'event-info' },
            React__default__default.createElement("div", { className: 'label' }, "Created on"),
            React__default__default.createElement("div", { className: 'value' }, format(liveEvent.createdAt, 'PPp'))),
        React__default__default.createElement("div", { className: 'event-info' },
            React__default__default.createElement("div", { className: 'label' }, "Created by"),
            React__default__default.createElement("div", { className: 'value' }, liveEvent.createdBy)),
        React__default__default.createElement("div", { className: 'event-info' },
            React__default__default.createElement("div", { className: 'label' }, "Started on"),
            React__default__default.createElement("div", { className: 'value' }, (liveEvent.startedAt) ? format(liveEvent.startedAt, 'PPp') : '')),
        React__default__default.createElement("div", { className: 'event-info' },
            React__default__default.createElement("div", { className: 'label' }, "Started by"),
            React__default__default.createElement("div", { className: 'value' }, (liveEvent.startedBy) ? liveEvent.startedBy : '')));
}

var css_248z$7 = ".user-list-view {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  max-width: 400px;\n  max-height: 100vh;\n  background: #fff;\n  overflow: hidden;\n}\n.user-list-view .header {\n  display: flex;\n  align-items: center;\n  padding: 24px;\n  border-bottom: 1px #ddd solid;\n}\n.user-list-view .header .title {\n  flex: 1;\n  font-size: 18px;\n}\n.user-list-view .header .title .count {\n  display: inline-block;\n  background: #ddd;\n  padding: 4px 8px;\n  border-radius: 15px;\n  margin: 0 4px;\n}\n.user-list-view .header .close:hover {\n  cursor: pointer;\n}\n.user-list-view .list {\n  flex: 1;\n  padding: 8px 0;\n  overflow-y: auto;\n}\n\n.user-view {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  background: #fff;\n  padding: 8px 16px;\n}\n.user-view .profile-image {\n  width: 24px;\n  height: 24px;\n  border-radius: 16px;\n  background: #eee;\n  margin-right: 16px;\n}\n.user-view .nickname {\n  font-size: 14px;\n  color: #333;\n}";
styleInject(css_248z$7);

function UserView(_a) {
    var _b = _a.nickname, nickname = _b === void 0 ? '' : _b, _c = _a.profileUrl, profileUrl = _c === void 0 ? '' : _c;
    var profile = profileUrl ?
        React__default__default.createElement("img", { src: profileUrl, className: 'profile-image' }) :
        React__default__default.createElement(SvgIconsUser, { fill: '#fff', className: 'profile-image' });
    return React__default__default.createElement("div", { className: 'user-view' },
        profile,
        React__default__default.createElement("div", { className: 'nickname' }, nickname));
}

function UserListView(_a) {
    var title = _a.title, count = _a.count, query = _a.query, _b = _a.onClose, onClose = _b === void 0 ? function () { } : _b;
    var userList = useRef(null);
    var _c = useState([]), users = _c[0], setUsers = _c[1];
    var _d = useState(true), hasNext = _d[0], setHasNext = _d[1];
    useEffect(function () {
        query()
            .then(function (_a) {
            var result = _a.result, hasNext = _a.hasNext;
            setUsers(__spreadArray([], result, true));
            setHasNext(hasNext);
        });
    }, []);
    var onScroll = function () {
        if (userList.current) {
            var _a = userList.current, scrollTop = _a.scrollTop, scrollHeight = _a.scrollHeight, clientHeight = _a.clientHeight;
            if (scrollTop + clientHeight === scrollHeight) {
                if (hasNext) {
                    query()
                        .then(function (_a) {
                        var result = _a.result, hasNext = _a.hasNext;
                        setUsers(__spreadArray(__spreadArray([], users, true), result, true));
                        setHasNext(hasNext);
                    });
                }
            }
        }
    };
    return React__default__default.createElement("div", { className: 'user-list-view' },
        React__default__default.createElement("div", { className: 'header' },
            React__default__default.createElement("div", { className: 'title' },
                title,
                " ",
                React__default__default.createElement("span", { className: 'count' }, count)),
            React__default__default.createElement("div", { className: 'close', onClick: function () { return onClose(); } },
                React__default__default.createElement(SvgIconsClose, { width: 22, height: 22, viewBox: '0 0 60 60' }))),
        React__default__default.createElement("div", { className: 'list', ref: userList, onScroll: onScroll }, users.map(function (user) { return React__default__default.createElement(UserView, { key: user.userId, userId: user.userId, nickname: user.nickname, profileUrl: user.profileUrl }); })));
}

var css_248z$6 = ".sendbirdlive-right__wrapper {\n  width: 400px;\n  height: 100vh;\n}";
styleInject(css_248z$6);

var RightPanelComponentType;
(function (RightPanelComponentType) {
    RightPanelComponentType[RightPanelComponentType["CHAT"] = 0] = "CHAT";
    RightPanelComponentType[RightPanelComponentType["EVENT_INFO"] = 1] = "EVENT_INFO";
    RightPanelComponentType[RightPanelComponentType["HOST_LIST"] = 2] = "HOST_LIST";
    RightPanelComponentType[RightPanelComponentType["PARTICIPANT_LIST"] = 3] = "PARTICIPANT_LIST";
})(RightPanelComponentType || (RightPanelComponentType = {}));
function RightPanel(_a) {
    var _this = this;
    var liveEvent = _a.liveEvent, _b = _a.initialViewStack, initialViewStack = _b === void 0 ? [RightPanelComponentType.CHAT] : _b;
    var openChannel = liveEvent.openChannel;
    var context = useSendbirdStateContext();
    var sb = sendbirdSelectors.getSdk(context);
    var _c = useState(__spreadArray([], initialViewStack, true)), viewStack = _c[0], setViewStack = _c[1];
    var _d = useState(initialViewStack[initialViewStack.length - 1]), currentView = _d[0], setCurrentView = _d[1];
    var pushViewStack = function (componentType) {
        setViewStack(__spreadArray(__spreadArray([], viewStack, true), [componentType], false));
    };
    var popViewStack = function () {
        if (viewStack.length > 1) {
            setViewStack(viewStack.slice(0, -1));
        }
    };
    useEffect(function () {
        liveEvent.openChannel;
        setViewStack(__spreadArray([], initialViewStack, true));
    }, [liveEvent]);
    useEffect(function () {
        setCurrentView(viewStack[viewStack.length - 1]);
    }, [viewStack]);
    return React__default__default.createElement("div", { className: 'sendbirdlive-right__wrapper' },
        currentView === RightPanelComponentType.CHAT ?
            React__default__default.createElement(OpenChannel, { channelUrl: liveEvent.liveEventId, useMessageGrouping: true, onChatHeaderActionClick: function () {
                    var _a;
                    if (((_a = liveEvent.host) === null || _a === void 0 ? void 0 : _a.userId) === (sb === null || sb === void 0 ? void 0 : sb.currentUser.userId)) {
                        pushViewStack(RightPanelComponentType.EVENT_INFO);
                    }
                    else {
                        pushViewStack(RightPanelComponentType.PARTICIPANT_LIST);
                    }
                } }) :
            null,
        currentView === RightPanelComponentType.EVENT_INFO ?
            React__default__default.createElement(EventDetailView, { liveEvent: liveEvent, onHostsClick: function () { return pushViewStack(RightPanelComponentType.HOST_LIST); }, onParticipantsClick: function () { return pushViewStack(RightPanelComponentType.PARTICIPANT_LIST); }, onClose: function () { return popViewStack(); } }) :
            null,
        currentView === RightPanelComponentType.HOST_LIST ?
            React__default__default.createElement(UserListView, { title: 'Hosts', count: openChannel.operators.length, query: function () { return __awaiter$2(_this, void 0, void 0, function () {
                    return __generator(this, function (_a) {
                        return [2 /*return*/, {
                                result: openChannel.operators,
                                hasNext: false,
                            }];
                    });
                }); }, onClose: function () { return popViewStack(); } }) :
            null,
        currentView === RightPanelComponentType.PARTICIPANT_LIST ?
            React__default__default.createElement(UserListView, { title: 'Participants', count: openChannel.participantCount, query: function () { return __awaiter$2(_this, void 0, void 0, function () {
                    var participantListQuery, participants, _a, hasNext;
                    return __generator(this, function (_b) {
                        switch (_b.label) {
                            case 0:
                                participantListQuery = openChannel.createParticipantListQuery({});
                                if (!participantListQuery) return [3 /*break*/, 2];
                                return [4 /*yield*/, participantListQuery.next()];
                            case 1:
                                _a = _b.sent();
                                return [3 /*break*/, 3];
                            case 2:
                                _a = [];
                                _b.label = 3;
                            case 3:
                                participants = _a;
                                hasNext = participantListQuery === null || participantListQuery === void 0 ? void 0 : participantListQuery.hasNext;
                                return [2 /*return*/, {
                                        result: participants,
                                        hasNext: hasNext,
                                    }];
                        }
                    });
                }); }, onClose: function () { return popViewStack(); } }) :
            null);
}

var css_248z$5 = ".settings {\n  width: 480px;\n}\n.settings .title {\n  font-size: 20px;\n  font-weight: 700;\n}\n.settings .close {\n  position: absolute;\n  top: 20px;\n  right: 20px;\n  cursor: pointer;\n}\n.settings .settings__select-container {\n  margin-top: 20px;\n}\n.settings .settings__select-container .settings__select-label {\n  font-size: 12px;\n  line-height: 1;\n}\n.settings .settings__select-container .settings__select-button {\n  width: 100%;\n  height: 40px;\n  margin-top: 8px;\n  padding: 10px 12px 10px 16px;\n  border-radius: 4px;\n  border: solid 1px rgba(255, 255, 255, 0.38);\n}";
styleInject(css_248z$5);

function Settings(props) {
    var liveEvent = props.liveEvent, onClose = props.onClose;
    var _a = useState(), currentAudioInput = _a[0], setCurrentAudioInput = _a[1];
    var _b = useState(), currentVideoInput = _b[0], setCurrentVideoInput = _b[1];
    var _c = useState([]), audioInputs = _c[0], setAudioInputs = _c[1];
    var _d = useState([]), videoInputs = _d[0], setVideoInputs = _d[1];
    useEffect(function () {
        var mediaAccess = sendbirdLive_min.exports.SendbirdLive.useMedia({ audio: true, video: true });
        setAudioInputs(sendbirdLive_min.exports.SendbirdLive.getAvailableAudioInputDevices());
        setVideoInputs(sendbirdLive_min.exports.SendbirdLive.getAvailableVideoInputDevices());
        setCurrentAudioInput(sendbirdLive_min.exports.SendbirdLive.getCurrentAudioInputDevice());
        setCurrentVideoInput(sendbirdLive_min.exports.SendbirdLive.getCurrentVideoInputDevice());
        sendbirdLive_min.exports.SendbirdLive.setAudioInputDeviceChanged(function (current, available) {
            console.log('audio input updated', available);
            setAudioInputs(available);
            if (current.deviceId !== (currentAudioInput === null || currentAudioInput === void 0 ? void 0 : currentAudioInput.deviceId)) {
                setCurrentAudioInput(current);
            }
        });
        sendbirdLive_min.exports.SendbirdLive.setVideoInputDeviceChanged(function (current, available) {
            console.log('video input updated', available);
            setVideoInputs(available);
            if (current.deviceId !== (currentVideoInput === null || currentVideoInput === void 0 ? void 0 : currentVideoInput.deviceId)) {
                setCurrentVideoInput(current);
            }
        });
        sendbirdLive_min.exports.SendbirdLive.updateMediaDevices({ audio: true, video: true });
        return function () {
            if (mediaAccess)
                mediaAccess.dispose();
        };
    });
    return (React__default__default.createElement("div", { className: "settings" },
        React__default__default.createElement("div", { className: 'close', onClick: function () { return onClose(); } },
            React__default__default.createElement(SvgIconsClose, { width: 22, height: 22, viewBox: '0 0 60 60' })),
        React__default__default.createElement("div", { className: 'title' }, "Settings"),
        React__default__default.createElement("div", { className: "settings__select-container" },
            React__default__default.createElement("div", { className: "settings__select-label" }, "Camera"),
            React__default__default.createElement("select", { id: "camera-select", defaultValue: currentVideoInput === null || currentVideoInput === void 0 ? void 0 : currentVideoInput.deviceId, className: "settings__select-button", onChange: function (e) {
                    var value = e.target.value;
                    var mediaInfo = videoInputs.find(function (device) { return device.deviceId === value; });
                    if (mediaInfo)
                        liveEvent.selectVideoInput(mediaInfo);
                    setCurrentVideoInput(mediaInfo);
                } }, videoInputs.map(function (info) { return (React__default__default.createElement("option", { key: info.deviceId, value: info.deviceId }, info.label)); }))),
        React__default__default.createElement("div", { className: "settings__select-container" },
            React__default__default.createElement("div", { className: "settings__select-label" }, "Microphone"),
            React__default__default.createElement("select", { id: "microphone-select", value: currentAudioInput === null || currentAudioInput === void 0 ? void 0 : currentAudioInput.deviceId, className: "settings__select-button", onChange: function (e) {
                    var value = e.target.value;
                    var mediaInfo = audioInputs.find(function (device) { return device.deviceId === value; });
                    if (mediaInfo)
                        liveEvent.selectAudioInput(mediaInfo);
                    setCurrentAudioInput(mediaInfo);
                } }, audioInputs.map(function (info) { return (React__default__default.createElement("option", { key: info.deviceId, value: info.deviceId }, info.label)); })))));
}

var isSafari$1 = function () { return /^((?!chrome|android).)*safari/i.test(navigator.userAgent); };
function HostView(props) {
    var _this = this;
    var liveEvent = props.liveEvent; props.showDuration; props.onEndEventClick; props.showStatusLabel; props.showParticipantCount; props.eventEndViewDisplayTime; props.allowExitWithoutEnding; props.showEventSummaryView; var onClose = props.onClose;
    var stringSet = useContext(SendbirdLiveContext).stringSet;
    var video = useRef(null);
    var _a = useState(liveEvent.title), title = _a[0], setTitle = _a[1];
    var _b = useState(liveEvent.coverUrl), coverUrl = _b[0], setCoverUrl = _b[1];
    var _c = useState(liveEvent.state), state = _c[0], setState = _c[1];
    var _d = useState(liveEvent.participantCount || 0), participantCount = _d[0], setParticipantCount = _d[1];
    var _e = useModal('', 'dark-background'), EndModal = _e[0], openEndModal = _e[1], closeEndModal = _e[2];
    var _f = useModal(''), SettingsModal = _f[0], openSettingsModal = _f[1], closeSettingsModal = _f[2];
    var mapStateName = function (name) {
        switch (name) {
            case 'created':
                return stringSet.EVENT_STATUS_CREATED;
            case 'ready':
                return stringSet.EVENT_STATUS_READY;
            case 'ongoing':
                return stringSet.EVENT_STATUS_ONGOING;
            case 'ended':
                return stringSet.EVENT_STATUS_ENDED;
        }
    };
    useEffect(function () {
        var setup = function () { return __awaiter$2(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(liveEvent.state === sendbirdLive_min.exports.LiveEventState.CREATED)) return [3 /*break*/, 2];
                        return [4 /*yield*/, liveEvent.setEventReady()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        if (!(liveEvent.state === sendbirdLive_min.exports.LiveEventState.ONGOING && !liveEvent.isHostStreaming)) return [3 /*break*/, 4];
                        return [4 /*yield*/, liveEvent.startStreaming({ turnVideoOn: true, turnAudioOn: true })];
                    case 3:
                        _a.sent();
                        liveEvent.setVideoViewForLiveEvent(video.current, liveEvent.host.hostId);
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        }); };
        setup();
    }, [liveEvent]);
    useEffect(function () {
        var unsubscribers = [
            liveEvent.on('participantEntered', function (event, participant) {
                setParticipantCount(liveEvent.participantCount);
            }),
            liveEvent.on('participantExited', function () {
                setParticipantCount(liveEvent.participantCount);
            }),
            liveEvent.on('liveEventUpdated', function () {
                setTitle(liveEvent.title);
                setCoverUrl(liveEvent.coverUrl);
            }),
            liveEvent.on('disconnected', function () {
                onClose(liveEvent);
            }),
        ];
        return function () {
            unsubscribers.map(function (unsubscriber) { return unsubscriber(); });
        };
    }, [liveEvent]);
    function getMM(milliseconds) {
        var seconds = Math.floor(milliseconds / 1000);
        var minutes = Math.floor(seconds / 60);
        minutes = minutes % 60;
        return "".concat(minutes < 0 ? 0 : minutes);
    }
    return (React__default__default.createElement("div", { className: "host-view" },
        React__default__default.createElement("div", { className: "host-view__main" },
            React__default__default.createElement("div", { className: "video-wrapper" },
                React__default__default.createElement("video", { className: "host-view__video", ref: video, playsInline: true, autoPlay: true, muted: true, controls: isSafari$1() })),
            React__default__default.createElement("div", { className: "host-view__info" },
                React__default__default.createElement("div", { className: "host-view__profile" }, (liveEvent.coverUrl) ?
                    React__default__default.createElement("img", { src: coverUrl, alt: 'cover image', className: 'host-view__profile__cover-image' }) :
                    React__default__default.createElement(SvgIconsUser, { viewBox: '-4 -4 20 20', width: 56, height: 56 })),
                React__default__default.createElement("div", { className: "host-view__info__wrapper" },
                    React__default__default.createElement("div", { className: "host-view__title__wrapper" },
                        React__default__default.createElement("div", { className: "event-state--".concat(state) }, mapStateName(state)),
                        React__default__default.createElement("div", { className: "host-view__title" }, title ? title : stringSet.CREATE_EVENT_DEFAULT_TITLE)),
                    React__default__default.createElement("div", { className: "host-view__detail" }, participantCount !== null && participantCount !== void 0 ? participantCount : 0,
                        " watching now ",
                        state === sendbirdLive_min.exports.LiveEventState.ONGOING ? "\u2219 Started ".concat(getMM(liveEvent.duration), " mins ago") : ''),
                    React__default__default.createElement("div", { className: "host-view__host-name" }, liveEvent.host ? liveEvent.host.nickname : 'No Host'))),
            React__default__default.createElement(ControlBar, { liveEvent: liveEvent, onStart: function (liveEvent) {
                    liveEvent.setVideoViewForLiveEvent(video.current, liveEvent.host.hostId);
                    setState(state);
                }, onEnd: function () {
                    openEndModal();
                }, onSettings: function () {
                    openSettingsModal();
                } }),
            React__default__default.createElement(EndModal, null,
                React__default__default.createElement(ConfirmEndDialog, { onExit: function (isEnding) { return __awaiter$2(_this, void 0, void 0, function () {
                        return __generator(this, function (_a) {
                            switch (_a.label) {
                                case 0:
                                    if (!isEnding) return [3 /*break*/, 2];
                                    return [4 /*yield*/, liveEvent.endEvent()];
                                case 1:
                                    _a.sent();
                                    return [3 /*break*/, 4];
                                case 2: return [4 /*yield*/, liveEvent.exitAsHost()];
                                case 3:
                                    _a.sent();
                                    _a.label = 4;
                                case 4:
                                    closeEndModal();
                                    onClose(liveEvent);
                                    return [2 /*return*/];
                            }
                        });
                    }); }, onClose: function () {
                        closeEndModal();
                    } })),
            React__default__default.createElement(SettingsModal, null,
                React__default__default.createElement(Settings, { liveEvent: liveEvent, onClose: function () {
                        closeSettingsModal();
                    } }))),
        React__default__default.createElement(RightPanel, { liveEvent: liveEvent })));
}

var css_248z$4 = "@import url(\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\");\nbody {\n  font-family: \"Roboto\", \"Verdana\", sans-serif;\n  font-size: 14px;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.spin {\n  animation: spin 1s linear infinite;\n}\n\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n.sendbirdlive-app__wrapper {\n  display: flex;\n}\n\n.sendbirdlive-app__no-event {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex-grow: 1;\n  width: 100%;\n}\n.sendbird-theme--light .sendbirdlive-app__no-event {\n  background-color: var(--sendbird-light-background-100);\n}\n.sendbird-theme--dark .sendbirdlive-app__no-event {\n  background-color: var(--sendbird-dark-background-500);\n}\n.sendbirdlive-app__no-event .sendbirdlive-app__no-event__title {\n  margin-bottom: 8px;\n  font-size: 18px;\n  font-weight: bold;\n  color: rgba(0, 0, 0, 0.88);\n}\n.sendbirdlive-app__no-event .sendbirdlive-app__no-event__description {\n  margin-bottom: 16px;\n  font-size: 14px;\n  line-height: 1.43;\n  color: rgba(0, 0, 0, 0.5);\n}\n.sendbirdlive-app__no-event .sendbirdlive-app__no-event__button {\n  padding: 6px 16px;\n  border-radius: 4px;\n  font-size: 14px;\n  font-weight: 500;\n  line-height: 1.43;\n  text-align: center;\n  color: rgba(255, 255, 255, 0.88);\n  cursor: pointer;\n}\n.sendbird-theme--light .sendbirdlive-app__no-event .sendbirdlive-app__no-event__button {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .sendbirdlive-app__no-event .sendbirdlive-app__no-event__button {\n  background-color: var(--sendbird-dark-primary-200);\n}";
styleInject(css_248z$4);

var css_248z$3 = "@import url(\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\");\nbody {\n  font-family: \"Roboto\", \"Verdana\", sans-serif;\n  font-size: 14px;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.spin {\n  animation: spin 1s linear infinite;\n}\n\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n.participant-view {\n  display: flex;\n  flex-grow: 1;\n}\n.participant-view .participant-view__main {\n  width: 100%;\n  background-color: var(--sendbird-light-background-100);\n}\n.participant-view .participant-view__main .toast-container {\n  position: absolute;\n  top: 10px;\n  z-index: 5000;\n}\n.participant-view .participant-view__main .toast-container .toast {\n  width: 500px;\n  margin: auto;\n  padding: 10px 0 10px 0;\n  background-color: var(--sendbird-dark-information-100);\n  font-size: 12px;\n  font-weight: bold;\n  line-height: 1;\n  text-align: center;\n  color: rgba(0, 0, 0, 0.88);\n}\n.participant-view .participant-view__main .video-wrapper {\n  position: relative;\n  width: 100%;\n}\n.participant-view .participant-view__main .video-wrapper:before {\n  display: block;\n  content: \"\";\n  padding-top: 56.25%; /*What you want the height to be in relation to the width*/\n}\n.participant-view .participant-view__main .video-wrapper .participant-view__video {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.participant-view .participant-view__main .participant-view__info {\n  display: flex;\n  padding-top: 16px;\n  background-color: var(--sendbird-light-background-50);\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__profile {\n  width: 56px;\n  height: 56px;\n  margin: 0 16px 12px;\n  border-radius: 50%;\n  background-color: var(--sendbird-dark-background-300);\n  overflow: hidden;\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__profile .participant-view__profile__cover-image {\n  width: 56px;\n  height: 56px;\n  object-fit: contain;\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state, .participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state--ended, .participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state--ongoing, .participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state--ready, .participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state--created {\n  width: fit-content;\n  box-sizing: border-box;\n  height: 20px;\n  margin-right: 8px;\n  padding: 4px;\n  border-radius: 2px;\n  font-size: 12px;\n  font-weight: bold;\n  line-height: 1;\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state--created {\n  background-color: var(--sendbird-light-primary-100);\n  color: #6211c8;\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state--ready {\n  background-color: #c8d9fa;\n  color: #30308f;\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state--ongoing {\n  background-color: var(--sendbird-light-error-300);\n  color: rgba(255, 255, 255, 0.88);\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state--ended {\n  color: rgba(0, 0, 0, 0.5);\n}\n.sendbird-theme--light .participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state--ended {\n  background-color: var(--sendbird-light-background-200);\n}\n.sendbird-theme--dark .participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .event-state--ended {\n  background-color: var(--sendbird-dark-background-400);\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .participant-view__title__wrapper {\n  display: flex;\n  align-items: center;\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .participant-view__title__wrapper .participant-view__title {\n  font-size: 20px;\n  font-weight: 700;\n  line-height: 1.4;\n  color: rgba(0, 0, 0, 0.88);\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .participant-view__detail {\n  margin-top: 4px;\n  font-size: 14px;\n  line-height: 1.43;\n  color: rgba(0, 0, 0, 0.5);\n}\n.participant-view .participant-view__main .participant-view__info .participant-view__info__wrapper .participant-view__host-name {\n  margin-top: 16px;\n  margin-bottom: 16px;\n  font-size: 14px;\n  font-weight: 700;\n  line-height: 1.43;\n  color: rgba(0, 0, 0, 0.88);\n}";
styleInject(css_248z$3);

var Toast = function (props) {
    var message = props.message;
    return (React__default__default.createElement("div", { className: "toast-container" }, message && React__default__default.createElement("div", { className: "toast" }, message)));
};
var useToast = function () {
    var _a = useState(undefined), message = _a[0], setMessage = _a[1];
    var _b = useState(undefined), timer = _b[0], setTimer = _b[1];
    var notify = function (message, time) {
        if (time === void 0) { time = 1000000; }
        setMessage(message);
        var timer = setTimeout(function () {
            reset();
        }, time);
        setTimer(timer);
    };
    var reset = function () {
        clearTimeout(timer);
        setTimer(undefined);
        setMessage(undefined);
    };
    var ToastWrapper = function () { return (React__default__default.createElement(Toast, { message: message })); };
    return [ToastWrapper, notify, reset];
};

var css_248z$2 = "@import url(\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\");\nbody {\n  font-family: \"Roboto\", \"Verdana\", sans-serif;\n  font-size: 14px;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.spin {\n  animation: spin 1s linear infinite;\n}\n\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n.ended-modal {\n  width: 480px;\n  padding: 18px 24px;\n}\n.ended-modal .header {\n  display: flex;\n  align-items: center;\n}\n.ended-modal .header .title {\n  flex: 1;\n  font-size: 20px;\n  font-weight: 700;\n  line-height: 1.4;\n  color: rgba(0, 0, 0, 0.88);\n}\n.ended-modal .header .close:hover {\n  cursor: pointer;\n}\n.ended-modal .buttons {\n  display: flex;\n  flex-direction: row;\n  justify-content: right;\n  padding-top: 50px;\n}\n.ended-modal .buttons .major-button {\n  margin-left: 8px;\n  padding: 10px 16px;\n  border-radius: 4px;\n}\n.ended-modal .buttons .major-button:hover {\n  cursor: pointer;\n  opacity: 0.9;\n}\n.ended-modal .buttons .major-button {\n  color: rgba(255, 255, 255, 0.88);\n}\n.sendbird-theme--light .ended-modal .buttons .major-button {\n  background-color: var(--sendbird-light-primary-300);\n}\n.sendbird-theme--dark .ended-modal .buttons .major-button {\n  background-color: var(--sendbird-dark-primary-200);\n}";
styleInject(css_248z$2);

function EndedModalView(props) {
    var onClose = props.onClose;
    return (React__default__default.createElement("div", { className: 'ended-modal' },
        React__default__default.createElement("div", { className: 'header' },
            React__default__default.createElement("div", { className: 'title' }, "Host has ended this live event."),
            React__default__default.createElement("div", { className: 'close', onClick: onClose },
                React__default__default.createElement(SvgIconsClose, { width: 22, height: 22, viewBox: '0 0 60 60', fill: '#000' }))),
        React__default__default.createElement("div", { className: 'buttons' },
            React__default__default.createElement("div", { className: 'major-button', onClick: onClose }, "End live"))));
}

var isSafari = function () { return /^((?!chrome|android).)*safari/i.test(navigator.userAgent); };
function ParticipantView(props) {
    var _this = this;
    var liveEvent = props.liveEvent, onClose = props.onClose; props.showDuration; props.onEndEventClick; props.showStatusLabel; props.showParticipantCount; var eventEndViewDisplayTime = props.eventEndViewDisplayTime;
    var video = useRef(null);
    var _a = useToast(), Toast = _a[0], notify = _a[1];
    var _b = useState(liveEvent.host), host = _b[0], setHost = _b[1];
    var _c = useState(liveEvent.title), title = _c[0], setTitle = _c[1];
    var _d = useState(liveEvent.coverUrl), coverUrl = _d[0], setCoverUrl = _d[1];
    var _e = useState(liveEvent.state), state = _e[0], setState = _e[1];
    var _f = useState(liveEvent.participantCount || 0), participantCount = _f[0], setParticipantCount = _f[1];
    var _g = useModal('', ''), EndedModal = _g[0], openEndedModal = _g[1], closeEndedModal = _g[2];
    var _h = useState(), modalTimer = _h[0], setModalTimer = _h[1];
    var stringSet = useContext(SendbirdLiveContext).stringSet;
    var mapStateName = function (name) {
        switch (name) {
            case 'created':
                return stringSet.EVENT_STATUS_CREATED;
            case 'ready':
                return stringSet.EVENT_STATUS_READY;
            case 'ongoing':
                return stringSet.EVENT_STATUS_ONGOING;
            case 'ended':
                return stringSet.EVENT_STATUS_ENDED;
        }
    };
    var setup = function () { return __awaiter$2(_this, void 0, void 0, function () {
        return __generator(this, function (_a) {
            if (host)
                liveEvent.setVideoViewForLiveEvent(video.current, host.hostId);
            return [2 /*return*/];
        });
    }); };
    var _openEndedModal = function () {
        openEndedModal();
        var timer = setTimeout(function () {
            exit();
        }, eventEndViewDisplayTime !== null && eventEndViewDisplayTime !== void 0 ? eventEndViewDisplayTime : 3000);
        setModalTimer(timer);
    };
    var exit = function () { return __awaiter$2(_this, void 0, void 0, function () {
        return __generator(this, function (_a) {
            clearTimeout(modalTimer);
            setModalTimer(undefined);
            closeEndedModal();
            onClose(liveEvent);
            return [2 /*return*/];
        });
    }); };
    useEffect(function () {
        setup();
    }, [host, state]);
    useEffect(function () {
        if (liveEvent.state === sendbirdLive_min.exports.LiveEventState.CREATED) {
            notify('Live event will begin soon.');
        }
        var unsubscribers = [
            liveEvent.on('liveEventStarted', function () {
                setState(liveEvent.state);
            }),
            liveEvent.on('liveEventEnded', function () {
                setState(liveEvent.state);
                _openEndedModal();
            }),
            liveEvent.on('hostEntered', function () {
                notify('Host Entered');
                setHost(liveEvent.host);
            }),
            liveEvent.on('hostConnected', function (liveEvent, host) {
                notify('Host Connected');
                setHost(liveEvent.host);
            }),
            liveEvent.on('hostDisconnected', function () {
                notify('Host Disconnected');
                setHost(liveEvent.host);
            }),
            liveEvent.on('hostExited', function () {
                notify('Host Exited');
                setHost(liveEvent.host);
            }),
            liveEvent.on('hostMutedAudio', function () {
                notify('Host is muted');
                setHost(liveEvent.host);
            }),
            liveEvent.on('hostUnmutedAudio', function () {
                notify('Host is unmuted');
                setHost(liveEvent.host);
            }),
            liveEvent.on('participantEntered', function () {
                setParticipantCount(liveEvent.participantCount);
            }),
            liveEvent.on('participantExited', function () {
                setParticipantCount(liveEvent.participantCount);
            }),
            liveEvent.on('liveEventUpdated', function () {
                setTitle(liveEvent.title);
                setCoverUrl(liveEvent.coverUrl);
            }),
            liveEvent.on('disconnected', function () {
                onClose(liveEvent);
            }),
        ];
        return function () {
            unsubscribers.map(function (unsubscriber) { return unsubscriber(); });
        };
    }, [liveEvent]);
    function getMM(milliseconds) {
        var seconds = Math.floor(milliseconds / 1000);
        var minutes = Math.floor(seconds / 60);
        minutes = minutes % 60;
        return "".concat(minutes < 0 ? 0 : minutes);
    }
    return (React__default__default.createElement("div", { className: "participant-view" },
        React__default__default.createElement("div", { className: "participant-view__main" },
            React__default__default.createElement(Toast, null),
            React__default__default.createElement("div", { className: "video-wrapper" },
                React__default__default.createElement("video", { className: "participant-view__video", ref: video, playsInline: true, autoPlay: true, controls: isSafari() })),
            React__default__default.createElement("div", { className: "participant-view__info" },
                React__default__default.createElement("div", { className: "participant-view__profile" }, (coverUrl) ?
                    React__default__default.createElement("img", { src: coverUrl, alt: 'cover image', className: 'participant-view__profile__cover-image' }) :
                    React__default__default.createElement(SvgIconsUser, { viewBox: '-4 -4 20 20', width: 56, height: 56 })),
                React__default__default.createElement("div", { className: "participant-view__info__wrapper" },
                    React__default__default.createElement("div", { className: "participant-view__title__wrapper" },
                        React__default__default.createElement("div", { className: "event-state--".concat(state) }, mapStateName(state)),
                        React__default__default.createElement("div", { className: "participant-view__title" }, title ? title : stringSet.CREATE_EVENT_DEFAULT_TITLE)),
                    React__default__default.createElement("div", { className: "participant-view__detail" }, participantCount !== null && participantCount !== void 0 ? participantCount : 0,
                        " watching now ",
                        state === sendbirdLive_min.exports.LiveEventState.ONGOING ? "\u2219 Started ".concat(getMM(liveEvent.duration), " mins ago") : ''),
                    React__default__default.createElement("div", { className: "participant-view__host-name" }, host ? host.nickname || ' ' : 'No Host')))),
        React__default__default.createElement(RightPanel, { liveEvent: liveEvent }),
        React__default__default.createElement(EndedModal, null,
            React__default__default.createElement(EndedModalView, { onClose: exit }))));
}

var css_248z$1 = ".enter-view {\n  width: 480px;\n}\n.enter-view .title {\n  font-size: 20px;\n  font-weight: 700;\n  margin-bottom: 26px;\n}\n.enter-view .close {\n  position: absolute;\n  top: 20px;\n  right: 20px;\n  cursor: pointer;\n}\n.enter-view .enter-view__item {\n  display: flex;\n  align-items: center;\n  margin: 8px 0;\n  border-radius: 4px;\n  border: solid 1px rgba(0, 0, 0, 0.12);\n  padding: 22px 24px 22px 22px;\n  cursor: pointer;\n}\n.enter-view .enter-view__item .enter-view__item__icon {\n  width: 28px;\n  height: 28px;\n  margin-right: 22px;\n}\n.enter-view .enter-view__item .enter-view__item__text {\n  font-size: 16px;\n  line-height: 1.38;\n  color: rgba(0, 0, 0, 0.88);\n}";
styleInject(css_248z$1);

function EnterView(props) {
    var _this = this;
    var liveEventId = props.liveEventId, onClose = props.onClose;
    var stringSet = useContext(SendbirdLiveContext).stringSet;
    var enterAsHost = function () { return __awaiter$2(_this, void 0, void 0, function () {
        var liveEvent;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, sendbirdLive_min.exports.SendbirdLive.getLiveEvent(liveEventId)];
                case 1:
                    liveEvent = _a.sent();
                    return [4 /*yield*/, liveEvent.enterAsHost({ turnAudioOn: true, turnVideoOn: true })];
                case 2:
                    _a.sent();
                    onClose(liveEvent, true);
                    return [2 /*return*/];
            }
        });
    }); };
    var enter = function () { return __awaiter$2(_this, void 0, void 0, function () {
        var liveEvent;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, sendbirdLive_min.exports.SendbirdLive.getLiveEvent(liveEventId)];
                case 1:
                    liveEvent = _a.sent();
                    return [4 /*yield*/, liveEvent.enter()];
                case 2:
                    _a.sent();
                    onClose(liveEvent, false);
                    return [2 /*return*/];
            }
        });
    }); };
    return (React__default__default.createElement("div", { className: 'enter-view' },
        React__default__default.createElement("div", { className: 'close', onClick: function () { return onClose(); } },
            React__default__default.createElement(SvgIconsClose, { width: 22, height: 22, viewBox: '0 0 60 60' })),
        React__default__default.createElement("div", { className: 'title' }, stringSet.LIVE_EVENT_ENTER_ROLE_DIALOG_TITLE),
        React__default__default.createElement("div", { className: 'enter-view__item', onClick: enterAsHost },
            React__default__default.createElement("div", { className: 'enter-view__item__icon' },
                React__default__default.createElement(SvgIconsOperator, { viewBox: "0 0 64 64", width: 28, height: 28 })),
            React__default__default.createElement("div", { className: 'enter-view__item__text' }, stringSet.LIVE_EVENT_ENTER_ROLE_DIALOG_OPTION_HOST)),
        React__default__default.createElement("div", { className: 'enter-view__item', onClick: enter },
            React__default__default.createElement("div", { className: 'enter-view__item__icon' },
                React__default__default.createElement(SvgIconsMembers, { viewBox: "0 0 64 64", width: 28, height: 28 })),
            React__default__default.createElement("div", { className: 'enter-view__item__text' }, stringSet.LIVE_EVENT_ENTER_ROLE_DIALOG_OPTION_PARTICIPANT))));
}

var css_248z = "@import url(\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\");\nbody {\n  font-family: \"Roboto\", \"Verdana\", sans-serif;\n  font-size: 14px;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.spin {\n  animation: spin 1s linear infinite;\n}\n\n:root {\n  --sendbird-light-primary-500: #491389;\n  --sendbird-light-primary-400: #6211c8;\n  --sendbird-light-primary-300: #742ddd;\n  --sendbird-light-primary-200: #c2a9fa;\n  --sendbird-light-primary-100: #dbd1ff;\n  --sendbird-light-secondary-500: #066858;\n  --sendbird-light-secondary-400: #027d69;\n  --sendbird-light-secondary-300: #259c72;\n  --sendbird-light-secondary-200: #69c085;\n  --sendbird-light-secondary-100: #a8e2ab;\n  --sendbird-light-information-100: #adc9ff;\n  --sendbird-light-error-500: #9d091e;\n  --sendbird-light-error-400: #bf0711;\n  --sendbird-light-error-300: #de360b;\n  --sendbird-light-error-200: #f66161;\n  --sendbird-light-error-100: #fdaaaa;\n  --sendbird-light-background-700: #000000;\n  --sendbird-light-background-600: #161616;\n  --sendbird-light-background-500: #2C2C2C;\n  --sendbird-light-background-400: #393939;\n  --sendbird-light-background-300: #bdbdbd;\n  --sendbird-light-background-200: #e0e0e0;\n  --sendbird-light-background-100: #eeeeee;\n  --sendbird-light-background-50: #FFFFFF;\n  --sendbird-light-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-light-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-light-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-light-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-light-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-light-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-light-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-light-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-light-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-light-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-light-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n:root {\n  --sendbird-dark-primary-500: #491389;\n  --sendbird-dark-primary-400: #6211c8;\n  --sendbird-dark-primary-300: #742ddd;\n  --sendbird-dark-primary-200: #c2a9fa;\n  --sendbird-dark-primary-100: #dbd1ff;\n  --sendbird-dark-secondary-500: #066858;\n  --sendbird-dark-secondary-400: #027d69;\n  --sendbird-dark-secondary-300: #259c72;\n  --sendbird-dark-secondary-200: #69c085;\n  --sendbird-dark-secondary-100: #a8e2ab;\n  --sendbird-dark-information-100: #adc9ff;\n  --sendbird-dark-error-500: #9d091e;\n  --sendbird-dark-error-400: #bf0711;\n  --sendbird-dark-error-300: #de360b;\n  --sendbird-dark-error-200: #f66161;\n  --sendbird-dark-error-100: #fdaaaa;\n  --sendbird-dark-background-700: #000000;\n  --sendbird-dark-background-600: #161616;\n  --sendbird-dark-background-500: #2C2C2C;\n  --sendbird-dark-background-400: #393939;\n  --sendbird-dark-background-300: #bdbdbd;\n  --sendbird-dark-background-200: #e0e0e0;\n  --sendbird-dark-background-100: #eeeeee;\n  --sendbird-dark-background-50: #FFFFFF;\n  --sendbird-dark-overlay-01: rgba(0, 0, 0, 0.55);\n  --sendbird-dark-overlay-02: rgba(0, 0, 0, 0.32);\n  --sendbird-dark-onlight-01: rgba(0, 0, 0, 0.88);\n  --sendbird-dark-onlight-02: rgba(0, 0, 0, 0.50);\n  --sendbird-dark-onlight-03: rgba(0, 0, 0, 0.38);\n  --sendbird-dark-onlight-04: rgba(0, 0, 0, 0.12);\n  --sendbird-dark-ondark-01: rgba(255, 255, 255, 0.88);\n  --sendbird-dark-ondark-02: rgba(255, 255, 255, 0.50);\n  --sendbird-dark-ondark-03: rgba(255, 255, 255, 0.38);\n  --sendbird-dark-ondark-04: rgba(255, 255, 255, 0.12);\n  --sendbird-dark-shadow-01: 0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-02: 0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-03: 0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-04: 0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12);\n  --sendbird-light-shadow-05: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 4px 6px 0 rgba(0, 0, 0, 0.12);\n  --sendbird-dark-shadow-message-input: 0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n}\n\n.enter-error-view {\n  width: 480px;\n}\n.enter-error-view .header {\n  display: flex;\n  align-items: center;\n}\n.enter-error-view .header .title {\n  flex: 1;\n  font-size: 20px;\n  font-weight: bold;\n  line-height: 1.4;\n  color: rgba(0, 0, 0, 0.88);\n}\n.enter-error-view .header .close:hover {\n  cursor: pointer;\n}\n.enter-error-view .buttons {\n  display: flex;\n  flex-direction: row;\n  justify-content: right;\n  padding-top: 50px;\n}\n.enter-error-view .buttons .major-button {\n  margin-left: 8px;\n  padding: 10px 16px;\n  border-radius: 4px;\n}\n.enter-error-view .buttons .major-button:hover {\n  cursor: pointer;\n  opacity: 0.9;\n}\n.enter-error-view .buttons .major-button {\n  color: rgba(255, 255, 255, 0.88);\n  background-color: #742ddd;\n}";
styleInject(css_248z);

function EnterErrorView(props) {
    var liveEvent = props.liveEvent, onClose = props.onClose;
    var stringSet = useContext(SendbirdLiveContext).stringSet;
    var message = useMemo(function () {
        if (liveEvent && liveEvent.state === sendbirdLive_min.exports.LiveEventState.CREATED) {
            return stringSet.LIVE_EVENT_ENTER_ALERT_DESCRIPTION;
        }
        else {
            console.log(liveEvent);
            return stringSet.UNKNOWN_ERROR_ALERT_DESCRIPTION;
        }
    }, [liveEvent]);
    return (React__default__default.createElement("div", { className: 'enter-error-view' },
        React__default__default.createElement("div", { className: 'header' },
            React__default__default.createElement("div", { className: 'title' }, message),
            React__default__default.createElement("div", { className: 'close', onClick: function () { return onClose(); } },
                React__default__default.createElement(SvgIconsClose, { width: 22, height: 22, viewBox: '0 0 60 60' }))),
        React__default__default.createElement("div", { className: 'buttons' },
            React__default__default.createElement("div", { className: 'major-button', onClick: function () { return onClose(); } }, "OK"))));
}

function App(props) {
    var _this = this;
    var userId = props.userId, appId = props.appId, nickname = props.nickname, accessToken = props.accessToken, customApiHost = props.customApiHost, customWebSocketHost = props.customWebSocketHost, theme = props.theme, colorSet = props.colorSet, stringSet = props.stringSet, customize = props.customize;
    var _a = useState(false), isHost = _a[0], setIsHost = _a[1];
    var _b = useState(''), liveEventId = _b[0], setLiveEventId = _b[1];
    var _c = useState(), liveEvent = _c[0], setLiveEvent = _c[1];
    var _d = useModal(''), CreateEventModal = _d[0], openCreateEventModal = _d[1], closeCreateEventModal = _d[2];
    var _e = useModal(''), EnterModal = _e[0], openEnterModal = _e[1], closeEnterModal = _e[2];
    var _f = useModal(''), EnterErrorModal = _f[0], openEnterErrorModal = _f[1], closeEnterErrorModal = _f[2];
    var liveEventListProps = __assign(__assign({}, customize === null || customize === void 0 ? void 0 : customize.liveEventList), { onClickCreate: function () {
            openCreateEventModal();
        }, onClickElem: function (liveEvent) { return __awaiter$2(_this, void 0, void 0, function () {
            var event_1;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 8, , 9]);
                        return [4 /*yield*/, sendbirdLive_min.exports.SendbirdLive.getLiveEvent(liveEvent.liveEventId)];
                    case 1:
                        event_1 = _a.sent();
                        if (event_1.state === sendbirdLive_min.exports.LiveEventState.ENDED) {
                            openEnterErrorModal();
                            return [2 /*return*/];
                        }
                        if (!(event_1.isHost && !event_1.host)) return [3 /*break*/, 5];
                        if (!(event_1.state === sendbirdLive_min.exports.LiveEventState.CREATED)) return [3 /*break*/, 3];
                        return [4 /*yield*/, event_1.enterAsHost({ turnAudioOn: true, turnVideoOn: true })];
                    case 2:
                        _a.sent();
                        setIsHost(true);
                        setLiveEvent(event_1);
                        return [3 /*break*/, 4];
                    case 3:
                        setLiveEventId(liveEvent.liveEventId);
                        openEnterModal();
                        _a.label = 4;
                    case 4: return [3 /*break*/, 7];
                    case 5: return [4 /*yield*/, event_1.enter()];
                    case 6:
                        _a.sent();
                        setLiveEvent(event_1);
                        _a.label = 7;
                    case 7: return [3 /*break*/, 9];
                    case 8:
                        _a.sent();
                        openEnterErrorModal();
                        return [3 /*break*/, 9];
                    case 9: return [2 /*return*/];
                }
            });
        }); } });
    var LiveEventView = function (_a) {
        var onClose = _a.onClose;
        if (!liveEvent)
            return (React__default__default.createElement("div", { className: "sendbirdlive-app__no-event" },
                React__default__default.createElement("div", { className: "sendbirdlive-app__no-event__title" }, "No live events selected"),
                React__default__default.createElement("div", { className: "sendbirdlive-app__no-event__description" }, "Select a live event from the list or create a live event."),
                React__default__default.createElement("div", { className: "sendbirdlive-app__no-event__button", onClick: openCreateEventModal }, "Create")));
        return ((isHost)
            ? React__default__default.createElement(HostView, { liveEvent: liveEvent, onClose: onClose })
            : React__default__default.createElement(ParticipantView, { liveEvent: liveEvent, onClose: onClose }));
    };
    return (React__default__default.createElement(SendbirdLive, { userId: userId, appId: appId, nickname: nickname, accessToken: accessToken, customApiHost: customApiHost, customWebSocketHost: customWebSocketHost, theme: theme, colorSet: colorSet, stringSet: stringSet },
        React__default__default.createElement("div", { className: "sendbirdlive-app__wrapper" },
            React__default__default.createElement("div", { className: "sendbirdlive-app__liveeventlist__wrapper" }, !isHost && React__default__default.createElement(LiveEventList, __assign({}, liveEventListProps))),
            React__default__default.createElement(EnterErrorModal, null,
                React__default__default.createElement(EnterErrorView, { liveEvent: liveEvent, onClose: closeEnterErrorModal })),
            React__default__default.createElement(EnterModal, null,
                React__default__default.createElement(EnterView, { liveEventId: liveEventId, onClose: function (liveEvent, isHost) {
                        setLiveEvent(liveEvent);
                        if (liveEvent && isHost) {
                            setIsHost(true);
                        }
                        closeEnterModal();
                    } })),
            React__default__default.createElement(CreateEventModal, null,
                React__default__default.createElement(CreateEventView, { onClose: function (liveEvent) {
                        setLiveEvent(liveEvent);
                        if (liveEvent === null || liveEvent === void 0 ? void 0 : liveEvent.isHost) {
                            setIsHost(true);
                        }
                        closeCreateEventModal();
                    } })),
            React__default__default.createElement(LiveEventView, { onClose: function () {
                    setIsHost(false);
                    setLiveEvent(undefined);
                } }))));
}

var __bundle2aa1a987$1 = {};

var e$1;
e$1 = function () {
  function e(e, t) {
    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
  }

  function t(e, t) {
    for (var r = 0; r < t.length; r++) {
      var n = t[r];
      n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
    }
  }

  function r(e, r, n) {
    return r && t(e.prototype, r), n && t(e, n), Object.defineProperty(e, "prototype", {
      writable: !1
    }), e;
  }

  function n(e) {
    return n = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (e) {
      return e.__proto__ || Object.getPrototypeOf(e);
    }, n(e);
  }

  function o(e, t) {
    return o = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (e, t) {
      return e.__proto__ = t, e;
    }, o(e, t);
  }

  function i(e) {
    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    return e;
  }

  function a(e) {
    var t = function () {
      if ("undefined" == typeof Reflect || !Reflect.construct) return !1;
      if (Reflect.construct.sham) return !1;
      if ("function" == typeof Proxy) return !0;

      try {
        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})), !0;
      } catch (e) {
        return !1;
      }
    }();

    return function () {
      var r,
          o = n(e);

      if (t) {
        var a = n(this).constructor;
        r = Reflect.construct(o, arguments, a);
      } else r = o.apply(this, arguments);

      return function (e, t) {
        if (t && ("object" == typeof t || "function" == typeof t)) return t;
        if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
        return i(e);
      }(this, r);
    };
  }

  function l() {
    return l = "undefined" != typeof Reflect && Reflect.get ? Reflect.get.bind() : function (e, t, r) {
      var o = function (e, t) {
        for (; !Object.prototype.hasOwnProperty.call(e, t) && null !== (e = n(e)););

        return e;
      }(e, t);

      if (o) {
        var i = Object.getOwnPropertyDescriptor(o, t);
        return i.get ? i.get.call(arguments.length < 3 ? e : r) : i.value;
      }
    }, l.apply(this, arguments);
  }

  var c = function () {
    function t() {
      e(this, t), Object.defineProperty(this, "listeners", {
        value: {},
        writable: !0,
        configurable: !0
      });
    }

    return r(t, [{
      key: "addEventListener",
      value: function (e, t, r) {
        e in this.listeners || (this.listeners[e] = []), this.listeners[e].push({
          callback: t,
          options: r
        });
      }
    }, {
      key: "removeEventListener",
      value: function (e, t) {
        if (e in this.listeners) for (var r = this.listeners[e], n = 0, o = r.length; n < o; n++) if (r[n].callback === t) return void r.splice(n, 1);
      }
    }, {
      key: "dispatchEvent",
      value: function (e) {
        if (e.type in this.listeners) {
          for (var t = this.listeners[e.type].slice(), r = 0, n = t.length; r < n; r++) {
            var o = t[r];

            try {
              o.callback.call(this, e);
            } catch (e) {
              Promise.resolve().then(function () {
                throw e;
              });
            }

            o.options && o.options.once && this.removeEventListener(e.type, o.callback);
          }

          return !e.defaultPrevented;
        }
      }
    }]), t;
  }(),
      u = function (t) {
    !function (e, t) {
      if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
      e.prototype = Object.create(t && t.prototype, {
        constructor: {
          value: e,
          writable: !0,
          configurable: !0
        }
      }), Object.defineProperty(e, "prototype", {
        writable: !1
      }), t && o(e, t);
    }(f, t);
    var u = a(f);

    function f() {
      var t;
      return e(this, f), (t = u.call(this)).listeners || c.call(i(t)), Object.defineProperty(i(t), "aborted", {
        value: !1,
        writable: !0,
        configurable: !0
      }), Object.defineProperty(i(t), "onabort", {
        value: null,
        writable: !0,
        configurable: !0
      }), Object.defineProperty(i(t), "reason", {
        value: void 0,
        writable: !0,
        configurable: !0
      }), t;
    }

    return r(f, [{
      key: "toString",
      value: function () {
        return "[object AbortSignal]";
      }
    }, {
      key: "dispatchEvent",
      value: function (e) {
        "abort" === e.type && (this.aborted = !0, "function" == typeof this.onabort && this.onabort.call(this, e)), l(n(f.prototype), "dispatchEvent", this).call(this, e);
      }
    }]), f;
  }(c),
      f = function () {
    function t() {
      e(this, t), Object.defineProperty(this, "signal", {
        value: new u(),
        writable: !0,
        configurable: !0
      });
    }

    return r(t, [{
      key: "abort",
      value: function (e) {
        var t;

        try {
          t = new Event("abort");
        } catch (e) {
          "undefined" != typeof document ? document.createEvent ? (t = document.createEvent("Event")).initEvent("abort", !1, !1) : (t = document.createEventObject()).type = "abort" : t = {
            type: "abort",
            bubbles: !1,
            cancelable: !1
          };
        }

        var r = e;
        if (void 0 === r) if ("undefined" == typeof document) (r = new Error("This operation was aborted")).name = "AbortError";else try {
          r = new DOMException("signal is aborted without reason");
        } catch (e) {
          (r = new Error("This operation was aborted")).name = "AbortError";
        }
        this.signal.reason = r, this.signal.dispatchEvent(t);
      }
    }, {
      key: "toString",
      value: function () {
        return "[object AbortController]";
      }
    }]), t;
  }();

  function s(e) {
    return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL ? (console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"), !0) : "function" == typeof e.Request && !e.Request.prototype.hasOwnProperty("signal") || !e.AbortController;
  }

  "undefined" != typeof Symbol && Symbol.toStringTag && (f.prototype[Symbol.toStringTag] = "AbortController", u.prototype[Symbol.toStringTag] = "AbortSignal"), function (e) {
    if (s(e)) if (e.fetch) {
      var t = function (e) {
        "function" == typeof e && (e = {
          fetch: e
        });
        var t = e,
            r = t.fetch,
            n = t.Request,
            o = void 0 === n ? r.Request : n,
            i = t.AbortController,
            a = t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,
            l = void 0 !== a && a;
        if (!s({
          fetch: r,
          Request: o,
          AbortController: i,
          __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL: l
        })) return {
          fetch: r,
          Request: c
        };
        var c = o;
        (c && !c.prototype.hasOwnProperty("signal") || l) && ((c = function (e, t) {
          var r;
          t && t.signal && (r = t.signal, delete t.signal);
          var n = new o(e, t);
          return r && Object.defineProperty(n, "signal", {
            writable: !1,
            enumerable: !1,
            configurable: !0,
            value: r
          }), n;
        }).prototype = o.prototype);
        var u = r;
        return {
          fetch: function (e, t) {
            var r = c && c.prototype.isPrototypeOf(e) ? e.signal : t ? t.signal : void 0;

            if (r) {
              var n;

              try {
                n = new DOMException("Aborted", "AbortError");
              } catch (e) {
                (n = new Error("Aborted")).name = "AbortError";
              }

              if (r.aborted) return Promise.reject(n);
              var o = new Promise(function (e, t) {
                r.addEventListener("abort", function () {
                  return t(n);
                }, {
                  once: !0
                });
              });
              return t && t.signal && delete t.signal, Promise.race([o, u(e, t)]);
            }

            return u(e, t);
          },
          Request: c
        };
      }(e),
          r = t.fetch,
          n = t.Request;

      e.fetch = r, e.Request = n, Object.defineProperty(e, "AbortController", {
        writable: !0,
        enumerable: !1,
        configurable: !0,
        value: f
      }), Object.defineProperty(e, "AbortSignal", {
        writable: !0,
        enumerable: !1,
        configurable: !0,
        value: u
      });
    } else console.warn("fetch() is not available, cannot install abortcontroller-polyfill");
  }("undefined" != typeof self ? self : commonjsGlobal);
}, e$1();

var __bundle2aa1a987 = /*#__PURE__*/_mergeNamespaces({
    __proto__: null,
    'default': __bundle2aa1a987$1
}, [__bundle2aa1a987$1]);

var __bundle40c7abbd$1 = {};

var t = "undefined" != typeof globalThis && globalThis || "undefined" != typeof self && self || "undefined" != typeof commonjsGlobal && commonjsGlobal || {},
    e = ("URLSearchParams" in t),
    r = "Symbol" in t && "iterator" in Symbol,
    o = "FileReader" in t && "Blob" in t && function () {
  try {
    return new Blob(), !0;
  } catch (t) {
    return !1;
  }
}(),
    n = ("FormData" in t),
    s = ("ArrayBuffer" in t);

if (s) var i = ["[object Int8Array]", "[object Uint8Array]", "[object Uint8ClampedArray]", "[object Int16Array]", "[object Uint16Array]", "[object Int32Array]", "[object Uint32Array]", "[object Float32Array]", "[object Float64Array]"],
    a = ArrayBuffer.isView || function (t) {
  return t && i.indexOf(Object.prototype.toString.call(t)) > -1;
};

function h(t) {
  if ("string" != typeof t && (t = String(t)), /[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t) || "" === t) throw new TypeError('Invalid character in header field name: "' + t + '"');
  return t.toLowerCase();
}

function u(t) {
  return "string" != typeof t && (t = String(t)), t;
}

function f(t) {
  var e = {
    next: function () {
      var e = t.shift();
      return {
        done: void 0 === e,
        value: e
      };
    }
  };
  return r && (e[Symbol.iterator] = function () {
    return e;
  }), e;
}

function d(t) {
  this.map = {}, t instanceof d ? t.forEach(function (t, e) {
    this.append(e, t);
  }, this) : Array.isArray(t) ? t.forEach(function (t) {
    if (2 != t.length) throw new TypeError("Headers constructor: expected name/value pair to be length 2, found" + t.length);
    this.append(t[0], t[1]);
  }, this) : t && Object.getOwnPropertyNames(t).forEach(function (e) {
    this.append(e, t[e]);
  }, this);
}

function c(t) {
  if (!t._noBody) return t.bodyUsed ? Promise.reject(new TypeError("Already read")) : void (t.bodyUsed = !0);
}

function y(t) {
  return new Promise(function (e, r) {
    t.onload = function () {
      e(t.result);
    }, t.onerror = function () {
      r(t.error);
    };
  });
}

function l(t) {
  var e = new FileReader(),
      r = y(e);
  return e.readAsArrayBuffer(t), r;
}

function p(t) {
  if (t.slice) return t.slice(0);
  var e = new Uint8Array(t.byteLength);
  return e.set(new Uint8Array(t)), e.buffer;
}

function b() {
  return this.bodyUsed = !1, this._initBody = function (t) {
    var r;
    this.bodyUsed = this.bodyUsed, this._bodyInit = t, t ? "string" == typeof t ? this._bodyText = t : o && Blob.prototype.isPrototypeOf(t) ? this._bodyBlob = t : n && FormData.prototype.isPrototypeOf(t) ? this._bodyFormData = t : e && URLSearchParams.prototype.isPrototypeOf(t) ? this._bodyText = t.toString() : s && o && (r = t) && DataView.prototype.isPrototypeOf(r) ? (this._bodyArrayBuffer = p(t.buffer), this._bodyInit = new Blob([this._bodyArrayBuffer])) : s && (ArrayBuffer.prototype.isPrototypeOf(t) || a(t)) ? this._bodyArrayBuffer = p(t) : this._bodyText = t = Object.prototype.toString.call(t) : (this._noBody = !0, this._bodyText = ""), this.headers.get("content-type") || ("string" == typeof t ? this.headers.set("content-type", "text/plain;charset=UTF-8") : this._bodyBlob && this._bodyBlob.type ? this.headers.set("content-type", this._bodyBlob.type) : e && URLSearchParams.prototype.isPrototypeOf(t) && this.headers.set("content-type", "application/x-www-form-urlencoded;charset=UTF-8"));
  }, o && (this.blob = function () {
    var t = c(this);
    if (t) return t;
    if (this._bodyBlob) return Promise.resolve(this._bodyBlob);
    if (this._bodyArrayBuffer) return Promise.resolve(new Blob([this._bodyArrayBuffer]));
    if (this._bodyFormData) throw new Error("could not read FormData body as blob");
    return Promise.resolve(new Blob([this._bodyText]));
  }), this.arrayBuffer = function () {
    if (this._bodyArrayBuffer) {
      var t = c(this);
      return t || (ArrayBuffer.isView(this._bodyArrayBuffer) ? Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset, this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength)) : Promise.resolve(this._bodyArrayBuffer));
    }

    if (o) return this.blob().then(l);
    throw new Error("could not read as ArrayBuffer");
  }, this.text = function () {
    var t,
        e,
        r,
        o,
        n,
        s = c(this);
    if (s) return s;
    if (this._bodyBlob) return t = this._bodyBlob, e = new FileReader(), r = y(e), o = /charset=([A-Za-z0-9_-]+)/.exec(t.type), n = o ? o[1] : "utf-8", e.readAsText(t, n), r;
    if (this._bodyArrayBuffer) return Promise.resolve(function (t) {
      for (var e = new Uint8Array(t), r = new Array(e.length), o = 0; o < e.length; o++) r[o] = String.fromCharCode(e[o]);

      return r.join("");
    }(this._bodyArrayBuffer));
    if (this._bodyFormData) throw new Error("could not read FormData body as text");
    return Promise.resolve(this._bodyText);
  }, n && (this.formData = function () {
    return this.text().then(v);
  }), this.json = function () {
    return this.text().then(JSON.parse);
  }, this;
}

d.prototype.append = function (t, e) {
  t = h(t), e = u(e);
  var r = this.map[t];
  this.map[t] = r ? r + ", " + e : e;
}, d.prototype.delete = function (t) {
  delete this.map[h(t)];
}, d.prototype.get = function (t) {
  return t = h(t), this.has(t) ? this.map[t] : null;
}, d.prototype.has = function (t) {
  return this.map.hasOwnProperty(h(t));
}, d.prototype.set = function (t, e) {
  this.map[h(t)] = u(e);
}, d.prototype.forEach = function (t, e) {
  for (var r in this.map) this.map.hasOwnProperty(r) && t.call(e, this.map[r], r, this);
}, d.prototype.keys = function () {
  var t = [];
  return this.forEach(function (e, r) {
    t.push(r);
  }), f(t);
}, d.prototype.values = function () {
  var t = [];
  return this.forEach(function (e) {
    t.push(e);
  }), f(t);
}, d.prototype.entries = function () {
  var t = [];
  return this.forEach(function (e, r) {
    t.push([r, e]);
  }), f(t);
}, r && (d.prototype[Symbol.iterator] = d.prototype.entries);
var m = ["CONNECT", "DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT", "TRACE"];

function w(e, r) {
  if (!(this instanceof w)) throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');
  var o,
      n,
      s = (r = r || {}).body;

  if (e instanceof w) {
    if (e.bodyUsed) throw new TypeError("Already read");
    this.url = e.url, this.credentials = e.credentials, r.headers || (this.headers = new d(e.headers)), this.method = e.method, this.mode = e.mode, this.signal = e.signal, s || null == e._bodyInit || (s = e._bodyInit, e.bodyUsed = !0);
  } else this.url = String(e);

  if (this.credentials = r.credentials || this.credentials || "same-origin", !r.headers && this.headers || (this.headers = new d(r.headers)), this.method = (o = r.method || this.method || "GET", n = o.toUpperCase(), m.indexOf(n) > -1 ? n : o), this.mode = r.mode || this.mode || null, this.signal = r.signal || this.signal || function () {
    if ("AbortController" in t) return new AbortController().signal;
  }(), this.referrer = null, ("GET" === this.method || "HEAD" === this.method) && s) throw new TypeError("Body not allowed for GET or HEAD requests");

  if (this._initBody(s), !("GET" !== this.method && "HEAD" !== this.method || "no-store" !== r.cache && "no-cache" !== r.cache)) {
    var i = /([?&])_=[^&]*/;
    if (i.test(this.url)) this.url = this.url.replace(i, "$1_=" + new Date().getTime());else {
      this.url += (/\?/.test(this.url) ? "&" : "?") + "_=" + new Date().getTime();
    }
  }
}

function v(t) {
  var e = new FormData();
  return t.trim().split("&").forEach(function (t) {
    if (t) {
      var r = t.split("="),
          o = r.shift().replace(/\+/g, " "),
          n = r.join("=").replace(/\+/g, " ");
      e.append(decodeURIComponent(o), decodeURIComponent(n));
    }
  }), e;
}

function A(t, e) {
  if (!(this instanceof A)) throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');
  if (e || (e = {}), this.type = "default", this.status = void 0 === e.status ? 200 : e.status, this.status < 200 || this.status > 599) throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");
  this.ok = this.status >= 200 && this.status < 300, this.statusText = void 0 === e.statusText ? "" : "" + e.statusText, this.headers = new d(e.headers), this.url = e.url || "", this._initBody(t);
}

w.prototype.clone = function () {
  return new w(this, {
    body: this._bodyInit
  });
}, b.call(w.prototype), b.call(A.prototype), A.prototype.clone = function () {
  return new A(this._bodyInit, {
    status: this.status,
    statusText: this.statusText,
    headers: new d(this.headers),
    url: this.url
  });
}, A.error = function () {
  var t = new A(null, {
    status: 200,
    statusText: ""
  });
  return t.status = 0, t.type = "error", t;
};
var g = [301, 302, 303, 307, 308];

A.redirect = function (t, e) {
  if (-1 === g.indexOf(e)) throw new RangeError("Invalid status code");
  return new A(null, {
    status: e,
    headers: {
      location: t
    }
  });
};

var T = t.DOMException;

try {
  new T();
} catch (t) {
  (T = function (t, e) {
    this.message = t, this.name = e;
    var r = Error(t);
    this.stack = r.stack;
  }).prototype = Object.create(Error.prototype), T.prototype.constructor = T;
}

function _(e, r) {
  return new Promise(function (n, i) {
    var a = new w(e, r);
    if (a.signal && a.signal.aborted) return i(new T("Aborted", "AbortError"));
    var f = new XMLHttpRequest();

    function c() {
      f.abort();
    }

    if (f.onload = function () {
      var t,
          e,
          r = {
        status: f.status,
        statusText: f.statusText,
        headers: (t = f.getAllResponseHeaders() || "", e = new d(), t.replace(/\r?\n[\t ]+/g, " ").split("\r").map(function (t) {
          return 0 === t.indexOf("\n") ? t.substr(1, t.length) : t;
        }).forEach(function (t) {
          var r = t.split(":"),
              o = r.shift().trim();

          if (o) {
            var n = r.join(":").trim();

            try {
              e.append(o, n);
            } catch (t) {
              console.warn("Response " + t.message);
            }
          }
        }), e)
      };
      r.url = "responseURL" in f ? f.responseURL : r.headers.get("X-Request-URL");
      var o = "response" in f ? f.response : f.responseText;
      setTimeout(function () {
        n(new A(o, r));
      }, 0);
    }, f.onerror = function () {
      setTimeout(function () {
        i(new TypeError("Network request failed"));
      }, 0);
    }, f.ontimeout = function () {
      setTimeout(function () {
        i(new TypeError("Network request failed"));
      }, 0);
    }, f.onabort = function () {
      setTimeout(function () {
        i(new T("Aborted", "AbortError"));
      }, 0);
    }, f.open(a.method, function (e) {
      try {
        return "" === e && t.location.href ? t.location.href : e;
      } catch (t) {
        return e;
      }
    }(a.url), !0), "include" === a.credentials ? f.withCredentials = !0 : "omit" === a.credentials && (f.withCredentials = !1), "responseType" in f && (o ? f.responseType = "blob" : s && (f.responseType = "arraybuffer")), r && "object" == typeof r.headers && !(r.headers instanceof d || t.Headers && r.headers instanceof t.Headers)) {
      var y = [];
      Object.getOwnPropertyNames(r.headers).forEach(function (t) {
        y.push(h(t)), f.setRequestHeader(t, u(r.headers[t]));
      }), a.headers.forEach(function (t, e) {
        -1 === y.indexOf(e) && f.setRequestHeader(e, t);
      });
    } else a.headers.forEach(function (t, e) {
      f.setRequestHeader(e, t);
    });

    a.signal && (a.signal.addEventListener("abort", c), f.onreadystatechange = function () {
      4 === f.readyState && a.signal.removeEventListener("abort", c);
    }), f.send(void 0 === a._bodyInit ? null : a._bodyInit);
  });
}

_.polyfill = !0, t.fetch || (t.fetch = _, t.Headers = d, t.Request = w, t.Response = A);

var __bundle40c7abbd = /*#__PURE__*/_mergeNamespaces({
    __proto__: null,
    'default': __bundle40c7abbd$1
}, [__bundle40c7abbd$1]);

function $parcel$export(e, n, v, s) {
  Object.defineProperty(e, n, {
    get: v,
    set: s,
    enumerable: true,
    configurable: true
  });
}

var $parcel$global = typeof globalThis !== 'undefined' ? globalThis : typeof self !== 'undefined' ? self : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : {};
var $parcel$modules = {};
var $parcel$inits = {};
var parcelRequire = $parcel$global["parcelRequire3f09"];

if (parcelRequire == null) {
  parcelRequire = function (id) {
    if (id in $parcel$modules) {
      return $parcel$modules[id].exports;
    }

    if (id in $parcel$inits) {
      var init = $parcel$inits[id];
      delete $parcel$inits[id];
      var module = {
        id: id,
        exports: {}
      };
      $parcel$modules[id] = module;
      init.call(module.exports, module, module.exports);
      return module.exports;
    }

    var err = new Error("Cannot find module '" + id + "'");
    err.code = 'MODULE_NOT_FOUND';
    throw err;
  };

  parcelRequire.register = function register(id, init) {
    $parcel$inits[id] = init;
  };

  $parcel$global["parcelRequire3f09"] = parcelRequire;
}

parcelRequire.register("kk1yk", function (module, exports) {
  var $3YDN3 = parcelRequire("3YDN3");
  var $ecb6e13812bdc08b$var$System = $3YDN3.System;
  var $ecb6e13812bdc08b$var$VbrMode = $3YDN3.VbrMode;
  $3YDN3.Float;
  var $ecb6e13812bdc08b$var$ShortBlock = $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $ecb6e13812bdc08b$var$new_float = $3YDN3.new_float;
  $3YDN3.new_float_n;
  $3YDN3.new_int;
  var $ecb6e13812bdc08b$var$new_int_n = $3YDN3.new_int_n;
  var $ecb6e13812bdc08b$var$new_short_n = $3YDN3.new_short_n;
  var $ecb6e13812bdc08b$var$assert = $3YDN3.assert;
  var $d2VP0 = parcelRequire("d2VP0");
  var $5HJeD = parcelRequire("5HJeD");
  var $4SDnr = parcelRequire("4SDnr");
  var $cU3Yf = parcelRequire("cU3Yf");
  var $2qGTD = parcelRequire("2qGTD");
  var $e32wu = parcelRequire("e32wu");
  var $ctaQC = parcelRequire("ctaQC");
  var $dQDcS = parcelRequire("dQDcS");
  var $cPNKB = parcelRequire("cPNKB");

  function $ecb6e13812bdc08b$var$Lame() {
    var MPEGMode = parcelRequire("jL6I1");
    var self = this;
    var LAME_MAXALBUMART = 131072;
    $ecb6e13812bdc08b$var$Lame.V9 = 410;
    $ecb6e13812bdc08b$var$Lame.V8 = 420;
    $ecb6e13812bdc08b$var$Lame.V7 = 430;
    $ecb6e13812bdc08b$var$Lame.V6 = 440;
    $ecb6e13812bdc08b$var$Lame.V5 = 450;
    $ecb6e13812bdc08b$var$Lame.V4 = 460;
    $ecb6e13812bdc08b$var$Lame.V3 = 470;
    $ecb6e13812bdc08b$var$Lame.V2 = 480;
    $ecb6e13812bdc08b$var$Lame.V1 = 490;
    $ecb6e13812bdc08b$var$Lame.V0 = 500;
    /* still there for compatibility */

    $ecb6e13812bdc08b$var$Lame.R3MIX = 1000;
    $ecb6e13812bdc08b$var$Lame.STANDARD = 1001;
    $ecb6e13812bdc08b$var$Lame.EXTREME = 1002;
    $ecb6e13812bdc08b$var$Lame.INSANE = 1003;
    $ecb6e13812bdc08b$var$Lame.STANDARD_FAST = 1004;
    $ecb6e13812bdc08b$var$Lame.EXTREME_FAST = 1005;
    $ecb6e13812bdc08b$var$Lame.MEDIUM = 1006;
    $ecb6e13812bdc08b$var$Lame.MEDIUM_FAST = 1007;
    /**
    * maximum size of mp3buffer needed if you encode at most 1152 samples for
    * each call to lame_encode_buffer. see lame_encode_buffer() below
    * (LAME_MAXMP3BUFFER is now obsolete)
    */

    var LAME_MAXMP3BUFFER = 16384 + LAME_MAXALBUMART;
    $ecb6e13812bdc08b$var$Lame.LAME_MAXMP3BUFFER = LAME_MAXMP3BUFFER;
    var ga;
    var bs;
    var p;
    var qupvt;
    var qu;
    var psy = new $d2VP0();
    var vbr;
    var id3;
    var mpglib;
    this.enc = new $cPNKB();

    this.setModules = function (_ga, _bs, _p, _qupvt, _qu, _vbr, _ver, _id3, _mpglib) {
      ga = _ga;
      bs = _bs;
      p = _p;
      qupvt = _qupvt;
      qu = _qu;
      vbr = _vbr;
      id3 = _id3;
      mpglib = _mpglib;
      this.enc.setModules(bs, psy, qupvt, vbr);
    };
    /**
    * PSY Model related stuff
    */


    function PSY() {
      /**
      * The dbQ stuff.
      */
      this.mask_adjust = 0.;
      /**
      * The dbQ stuff.
      */

      this.mask_adjust_short = 0.;
      /* at transition from one scalefactor band to next */

      /**
      * Band weight long scalefactor bands.
      */

      this.bo_l_weight = $ecb6e13812bdc08b$var$new_float($cPNKB.SBMAX_l);
      /**
      * Band weight short scalefactor bands.
      */

      this.bo_s_weight = $ecb6e13812bdc08b$var$new_float($cPNKB.SBMAX_s);
    }

    function LowPassHighPass() {
      this.lowerlimit = 0.;
    }

    function BandPass(bitrate, lPass) {
      this.lowpass = lPass;
    }

    var LAME_ID = 0xFFF88E3B;

    function lame_init_old(gfp) {
      var gfc;
      gfp.class_id = LAME_ID;
      gfc = gfp.internal_flags = new $4SDnr();
      /* Global flags. set defaults here for non-zero values */

      /* see lame.h for description */

      /*
      * set integer values to -1 to mean that LAME will compute the best
      * value, UNLESS the calling program as set it (and the value is no
      * longer -1)
      */

      gfp.mode = MPEGMode.NOT_SET;
      gfp.original = 1;
      gfp.in_samplerate = 44100;
      gfp.num_channels = 2;
      gfp.num_samples = -1;
      gfp.bWriteVbrTag = true;
      gfp.quality = -1;
      gfp.short_blocks = null;
      gfc.subblock_gain = -1;
      gfp.lowpassfreq = 0;
      gfp.highpassfreq = 0;
      gfp.lowpasswidth = -1;
      gfp.highpasswidth = -1;
      gfp.VBR = $ecb6e13812bdc08b$var$VbrMode.vbr_off;
      gfp.VBR_q = 4;
      gfp.ATHcurve = -1;
      gfp.VBR_mean_bitrate_kbps = 128;
      gfp.VBR_min_bitrate_kbps = 0;
      gfp.VBR_max_bitrate_kbps = 0;
      gfp.VBR_hard_min = 0;
      gfc.VBR_min_bitrate = 1;
      /* not 0 ????? */

      gfc.VBR_max_bitrate = 13;
      /* not 14 ????? */

      gfp.quant_comp = -1;
      gfp.quant_comp_short = -1;
      gfp.msfix = -1;
      gfc.resample_ratio = 1;
      gfc.OldValue[0] = 180;
      gfc.OldValue[1] = 180;
      gfc.CurrentStep[0] = 4;
      gfc.CurrentStep[1] = 4;
      gfc.masking_lower = 1;
      gfc.nsPsy.attackthre = -1;
      gfc.nsPsy.attackthre_s = -1;
      gfp.scale = -1;
      gfp.athaa_type = -1;
      gfp.ATHtype = -1;
      /* default = -1 = set in lame_init_params */

      gfp.athaa_loudapprox = -1;
      /* 1 = flat loudness approx. (total energy) */

      /* 2 = equal loudness curve */

      gfp.athaa_sensitivity = 0.0;
      /* no offset */

      gfp.useTemporal = null;
      gfp.interChRatio = -1;
      /*
      * The reason for int mf_samples_to_encode = ENCDELAY + POSTDELAY;
      * ENCDELAY = internal encoder delay. And then we have to add
      * POSTDELAY=288 because of the 50% MDCT overlap. A 576 MDCT granule
      * decodes to 1152 samples. To synthesize the 576 samples centered under
      * this granule we need the previous granule for the first 288 samples
      * (no problem), and the next granule for the next 288 samples (not
      * possible if this is last granule). So we need to pad with 288 samples
      * to make sure we can encode the 576 samples we are interested in.
      */

      gfc.mf_samples_to_encode = $cPNKB.ENCDELAY + $cPNKB.POSTDELAY;
      gfp.encoder_padding = 0;
      gfc.mf_size = $cPNKB.ENCDELAY - $cPNKB.MDCTDELAY;
      /*
      * we pad input with this many 0's
      */

      gfp.findReplayGain = false;
      gfp.decode_on_the_fly = false;
      gfc.decode_on_the_fly = false;
      gfc.findReplayGain = false;
      gfc.findPeakSample = false;
      gfc.RadioGain = 0;
      gfc.AudiophileGain = 0;
      gfc.noclipGainChange = 0;
      gfc.noclipScale = -1;
      gfp.preset = 0;
      gfp.write_id3tag_automatic = true;
      return 0;
    }

    this.lame_init = function () {
      var gfp = new $5HJeD();
      lame_init_old(gfp);
      gfp.lame_allocated_gfp = 1;
      return gfp;
    };

    function filter_coef(x) {
      if (x > 1.0) return 0.0;
      if (x <= 0.0) return 1.0;
      return Math.cos(Math.PI / 2 * x);
    }

    this.nearestBitrateFullIndex = function (bitrate) {
      /* borrowed from DM abr presets */
      var full_bitrate_table = [8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320];
      var lower_range = 0,
          lower_range_kbps = 0,
          upper_range = 0,
          upper_range_kbps = 0;
      /* We assume specified bitrate will be 320kbps */

      upper_range_kbps = full_bitrate_table[16];
      upper_range = 16;
      lower_range_kbps = full_bitrate_table[16];
      lower_range = 16;
      /*
      * Determine which significant bitrates the value specified falls
      * between, if loop ends without breaking then we were correct above
      * that the value was 320
      */

      for (var b = 0; b < 16; b++) if (Math.max(bitrate, full_bitrate_table[b + 1]) != bitrate) {
        upper_range_kbps = full_bitrate_table[b + 1];
        upper_range = b + 1;
        lower_range_kbps = full_bitrate_table[b];
        lower_range = b;
        break;
        /* We found upper range */
      }
      /* Determine which range the value specified is closer to */


      if (upper_range_kbps - bitrate > bitrate - lower_range_kbps) return lower_range;
      return upper_range;
    };

    function optimum_samplefreq(lowpassfreq, input_samplefreq) {
      /*
      * Rules:
      *
      * - if possible, sfb21 should NOT be used
      */
      var suggested_samplefreq = 44100;
      if (input_samplefreq >= 48000) suggested_samplefreq = 48000;else if (input_samplefreq >= 44100) suggested_samplefreq = 44100;else if (input_samplefreq >= 32000) suggested_samplefreq = 32000;else if (input_samplefreq >= 24000) suggested_samplefreq = 24000;else if (input_samplefreq >= 22050) suggested_samplefreq = 22050;else if (input_samplefreq >= 16000) suggested_samplefreq = 16000;else if (input_samplefreq >= 12000) suggested_samplefreq = 12000;else if (input_samplefreq >= 11025) suggested_samplefreq = 11025;else if (input_samplefreq >= 8000) suggested_samplefreq = 8000;
      if (lowpassfreq == -1) return suggested_samplefreq;
      if (lowpassfreq <= 15960) suggested_samplefreq = 44100;
      if (lowpassfreq <= 15250) suggested_samplefreq = 32000;
      if (lowpassfreq <= 11220) suggested_samplefreq = 24000;
      if (lowpassfreq <= 9970) suggested_samplefreq = 22050;
      if (lowpassfreq <= 7230) suggested_samplefreq = 16000;
      if (lowpassfreq <= 5420) suggested_samplefreq = 12000;
      if (lowpassfreq <= 4510) suggested_samplefreq = 11025;
      if (lowpassfreq <= 3970) suggested_samplefreq = 8000;

      if (input_samplefreq < suggested_samplefreq) {
        /*
        * choose a valid MPEG sample frequency above the input sample
        * frequency to avoid SFB21/12 bitrate bloat rh 061115
        */
        if (input_samplefreq > 44100) return 48000;
        if (input_samplefreq > 32000) return 44100;
        if (input_samplefreq > 24000) return 32000;
        if (input_samplefreq > 22050) return 24000;
        if (input_samplefreq > 16000) return 22050;
        if (input_samplefreq > 12000) return 16000;
        if (input_samplefreq > 11025) return 12000;
        if (input_samplefreq > 8000) return 11025;
        return 8000;
      }

      return suggested_samplefreq;
    }
    /**
    * convert samp freq in Hz to index
    */


    function SmpFrqIndex(sample_freq, gpf) {
      switch (sample_freq) {
        case 44100:
          gpf.version = 1;
          return 0;

        case 48000:
          gpf.version = 1;
          return 1;

        case 32000:
          gpf.version = 1;
          return 2;

        case 22050:
          gpf.version = 0;
          return 0;

        case 24000:
          gpf.version = 0;
          return 1;

        case 16000:
          gpf.version = 0;
          return 2;

        case 11025:
          gpf.version = 0;
          return 0;

        case 12000:
          gpf.version = 0;
          return 1;

        case 8000:
          gpf.version = 0;
          return 2;

        default:
          gpf.version = 0;
          return -1;
      }
    }
    /**
    * @param bRate
    *            legal rates from 8 to 320
    */


    function FindNearestBitrate(bRate, version, samplerate) {
      /* MPEG-1 or MPEG-2 LSF */
      if (samplerate < 16000) version = 2;
      var bitrate = $dQDcS.bitrate_table[version][1];

      for (var i = 2; i <= 14; i++) {
        if ($dQDcS.bitrate_table[version][i] > 0) {
          if (Math.abs($dQDcS.bitrate_table[version][i] - bRate) < Math.abs(bitrate - bRate)) bitrate = $dQDcS.bitrate_table[version][i];
        }
      }

      return bitrate;
    }
    /**
    * @param bRate
    *            legal rates from 32 to 448 kbps
    * @param version
    *            MPEG-1 or MPEG-2/2.5 LSF
    */


    function BitrateIndex(bRate, version, samplerate) {
      /* convert bitrate in kbps to index */
      if (samplerate < 16000) version = 2;

      for (var i = 0; i <= 14; i++) if ($dQDcS.bitrate_table[version][i] > 0) {
        if ($dQDcS.bitrate_table[version][i] == bRate) return i;
      }

      return -1;
    }

    function optimum_bandwidth(lh, bitrate) {
      /**
      * <PRE>
      *  Input:
      *      bitrate     total bitrate in kbps
      *
      *   Output:
      *      lowerlimit: best lowpass frequency limit for input filter in Hz
      *      upperlimit: best highpass frequency limit for input filter in Hz
      * </PRE>
      */
      var freq_map = [new BandPass(8, 2000), new BandPass(16, 3700), new BandPass(24, 3900), new BandPass(32, 5500), new BandPass(40, 7000), new BandPass(48, 7500), new BandPass(56, 10000), new BandPass(64, 11000), new BandPass(80, 13500), new BandPass(96, 15100), new BandPass(112, 15600), new BandPass(128, 17000), new BandPass(160, 17500), new BandPass(192, 18600), new BandPass(224, 19400), new BandPass(256, 19700), new BandPass(320, 20500)];
      var table_index = self.nearestBitrateFullIndex(bitrate);
      lh.lowerlimit = freq_map[table_index].lowpass;
    }

    function lame_init_params_ppflt(gfp) {
      var gfc = gfp.internal_flags;
      /***************************************************************/

      /* compute info needed for polyphase filter (filter type==0, default) */

      /***************************************************************/

      var lowpass_band = 32;
      var highpass_band = -1;

      if (gfc.lowpass1 > 0) {
        var minband = 999;

        for (var band = 0; band <= 31; band++) {
          var freq = band / 31.0;
          /* this band and above will be zeroed: */

          if (freq >= gfc.lowpass2) lowpass_band = Math.min(lowpass_band, band);
          if (gfc.lowpass1 < freq && freq < gfc.lowpass2) minband = Math.min(minband, band);
        }
        /*
        * compute the *actual* transition band implemented by the polyphase
        * filter
        */


        if (minband == 999) gfc.lowpass1 = (lowpass_band - .75) / 31.0;else gfc.lowpass1 = (minband - .75) / 31.0;
        gfc.lowpass2 = lowpass_band / 31.0;
      }
      /*
      * make sure highpass filter is within 90% of what the effective
      * highpass frequency will be
      */


      if (gfc.highpass2 > 0) {
        if (gfc.highpass2 < .9 * (.75 / 31.0)) {
          gfc.highpass1 = 0;
          gfc.highpass2 = 0;
          $ecb6e13812bdc08b$var$System.err.println("Warning: highpass filter disabled.  highpass frequency too small\n");
        }
      }

      if (gfc.highpass2 > 0) {
        var maxband = -1;

        for (var band = 0; band <= 31; band++) {
          var freq = band / 31.0;
          /* this band and below will be zereod */

          if (freq <= gfc.highpass1) highpass_band = Math.max(highpass_band, band);
          if (gfc.highpass1 < freq && freq < gfc.highpass2) maxband = Math.max(maxband, band);
        }
        /*
        * compute the *actual* transition band implemented by the polyphase
        * filter
        */


        gfc.highpass1 = highpass_band / 31.0;
        if (maxband == -1) gfc.highpass2 = (highpass_band + .75) / 31.0;else gfc.highpass2 = (maxband + .75) / 31.0;
      }

      for (var band = 0; band < 32; band++) {
        var fc1, fc2;
        var freq = band / 31.0;
        if (gfc.highpass2 > gfc.highpass1) fc1 = filter_coef((gfc.highpass2 - freq) / (gfc.highpass2 - gfc.highpass1 + 1e-20));else fc1 = 1.0;
        if (gfc.lowpass2 > gfc.lowpass1) fc2 = filter_coef((freq - gfc.lowpass1) / (gfc.lowpass2 - gfc.lowpass1 + 1e-20));else fc2 = 1.0;
        gfc.amp_filter[band] = fc1 * fc2;
      }
    }

    function lame_init_qval(gfp) {
      var gfc = gfp.internal_flags;

      switch (gfp.quality) {
        default:
        case 9:
          /* no psymodel, no noise shaping */
          gfc.psymodel = 0;
          gfc.noise_shaping = 0;
          gfc.noise_shaping_amp = 0;
          gfc.noise_shaping_stop = 0;
          gfc.use_best_huffman = 0;
          gfc.full_outer_loop = 0;
          break;

        case 8:
          gfp.quality = 7;
        //$FALL-THROUGH$

        case 7:
          /*
                    * use psymodel (for short block and m/s switching), but no noise
                    * shapping
                    */
          gfc.psymodel = 1;
          gfc.noise_shaping = 0;
          gfc.noise_shaping_amp = 0;
          gfc.noise_shaping_stop = 0;
          gfc.use_best_huffman = 0;
          gfc.full_outer_loop = 0;
          break;

        case 6:
          gfc.psymodel = 1;
          if (gfc.noise_shaping == 0) gfc.noise_shaping = 1;
          gfc.noise_shaping_amp = 0;
          gfc.noise_shaping_stop = 0;
          if (gfc.subblock_gain == -1) gfc.subblock_gain = 1;
          gfc.use_best_huffman = 0;
          gfc.full_outer_loop = 0;
          break;

        case 5:
          gfc.psymodel = 1;
          if (gfc.noise_shaping == 0) gfc.noise_shaping = 1;
          gfc.noise_shaping_amp = 0;
          gfc.noise_shaping_stop = 0;
          if (gfc.subblock_gain == -1) gfc.subblock_gain = 1;
          gfc.use_best_huffman = 0;
          gfc.full_outer_loop = 0;
          break;

        case 4:
          gfc.psymodel = 1;
          if (gfc.noise_shaping == 0) gfc.noise_shaping = 1;
          gfc.noise_shaping_amp = 0;
          gfc.noise_shaping_stop = 0;
          if (gfc.subblock_gain == -1) gfc.subblock_gain = 1;
          gfc.use_best_huffman = 1;
          gfc.full_outer_loop = 0;
          break;

        case 3:
          gfc.psymodel = 1;
          if (gfc.noise_shaping == 0) gfc.noise_shaping = 1;
          gfc.noise_shaping_amp = 1;
          gfc.noise_shaping_stop = 1;
          if (gfc.subblock_gain == -1) gfc.subblock_gain = 1;
          gfc.use_best_huffman = 1;
          gfc.full_outer_loop = 0;
          break;

        case 2:
          gfc.psymodel = 1;
          if (gfc.noise_shaping == 0) gfc.noise_shaping = 1;
          if (gfc.substep_shaping == 0) gfc.substep_shaping = 2;
          gfc.noise_shaping_amp = 1;
          gfc.noise_shaping_stop = 1;
          if (gfc.subblock_gain == -1) gfc.subblock_gain = 1;
          gfc.use_best_huffman = 1;
          /* inner loop */

          gfc.full_outer_loop = 0;
          break;

        case 1:
          gfc.psymodel = 1;
          if (gfc.noise_shaping == 0) gfc.noise_shaping = 1;
          if (gfc.substep_shaping == 0) gfc.substep_shaping = 2;
          gfc.noise_shaping_amp = 2;
          gfc.noise_shaping_stop = 1;
          if (gfc.subblock_gain == -1) gfc.subblock_gain = 1;
          gfc.use_best_huffman = 1;
          gfc.full_outer_loop = 0;
          break;

        case 0:
          gfc.psymodel = 1;
          if (gfc.noise_shaping == 0) gfc.noise_shaping = 1;
          if (gfc.substep_shaping == 0) gfc.substep_shaping = 2;
          gfc.noise_shaping_amp = 2;
          gfc.noise_shaping_stop = 1;
          if (gfc.subblock_gain == -1) gfc.subblock_gain = 1;
          gfc.use_best_huffman = 1;
          /*
          * type 2 disabled because of it slowness, in favor of full outer
          * loop search
          */

          gfc.full_outer_loop = 0;
          break;
      }
    }

    function lame_init_bitstream(gfp) {
      var gfc = gfp.internal_flags;
      gfp.frameNum = 0;
      if (gfp.write_id3tag_automatic) id3.id3tag_write_v2(gfp);
      /* initialize histogram data optionally used by frontend */

      gfc.bitrate_stereoMode_Hist = $ecb6e13812bdc08b$var$new_int_n([16, 5]);
      gfc.bitrate_blockType_Hist = $ecb6e13812bdc08b$var$new_int_n([16, 6]);
      gfc.PeakSample = 0.0;
      /* Write initial VBR Header to bitstream and init VBR data */

      if (gfp.bWriteVbrTag) vbr.InitVbrTag(gfp);
    }
    /********************************************************************
    * initialize internal params based on data in gf (globalflags struct filled
    * in by calling program)
    *
    * OUTLINE:
    *
    * We first have some complex code to determine bitrate, output samplerate
    * and mode. It is complicated by the fact that we allow the user to set
    * some or all of these parameters, and need to determine best possible
    * values for the rest of them:
    *
    * 1. set some CPU related flags 2. check if we are mono.mono, stereo.mono
    * or stereo.stereo 3. compute bitrate and output samplerate: user may have
    * set compression ratio user may have set a bitrate user may have set a
    * output samplerate 4. set some options which depend on output samplerate
    * 5. compute the actual compression ratio 6. set mode based on compression
    * ratio
    *
    * The remaining code is much simpler - it just sets options based on the
    * mode & compression ratio:
    *
    * set allow_diff_short based on mode select lowpass filter based on
    * compression ratio & mode set the bitrate index, and min/max bitrates for
    * VBR modes disable VBR tag if it is not appropriate initialize the
    * bitstream initialize scalefac_band data set sideinfo_len (based on
    * channels, CRC, out_samplerate) write an id3v2 tag into the bitstream
    * write VBR tag into the bitstream set mpeg1/2 flag estimate the number of
    * frames (based on a lot of data)
    *
    * now we set more flags: nspsytune: see code VBR modes see code CBR/ABR see
    * code
    *
    * Finally, we set the algorithm flags based on the gfp.quality value
    * lame_init_qval(gfp);
    *
    ********************************************************************/


    this.lame_init_params = function (gfp) {
      var gfc = gfp.internal_flags;
      gfc.Class_ID = 0;
      if (gfc.ATH == null) gfc.ATH = new $cU3Yf();
      if (gfc.PSY == null) gfc.PSY = new PSY();
      if (gfc.rgdata == null) gfc.rgdata = new $2qGTD();
      gfc.channels_in = gfp.num_channels;
      if (gfc.channels_in == 1) gfp.mode = MPEGMode.MONO;
      gfc.channels_out = gfp.mode == MPEGMode.MONO ? 1 : 2;
      gfc.mode_ext = $cPNKB.MPG_MD_MS_LR;
      if (gfp.mode == MPEGMode.MONO) gfp.force_ms = false;
      /*
      * don't allow forced mid/side stereo for mono output
      */

      if (gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_off && gfp.VBR_mean_bitrate_kbps != 128 && gfp.brate == 0) gfp.brate = gfp.VBR_mean_bitrate_kbps;
      if (gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_off || gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_mtrh || gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_mt) ;else gfp.free_format = false;

      if (gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_off && gfp.brate == 0)
        /* no bitrate or compression ratio specified, use 11.025 */
        {
          if ($ctaQC.EQ(gfp.compression_ratio, 0)) gfp.compression_ratio = 11.025;
        }
      /* find bitrate if user specify a compression ratio */


      if (gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_off && gfp.compression_ratio > 0) {
        if (gfp.out_samplerate == 0) gfp.out_samplerate = map2MP3Frequency(int(0.97 * gfp.in_samplerate));
        /*
        * round up with a margin of 3 %
        */

        /*
        * choose a bitrate for the output samplerate which achieves
        * specified compression ratio
        */

        gfp.brate = 0 | gfp.out_samplerate * 16 * gfc.channels_out / (1.e3 * gfp.compression_ratio);
        /* we need the version for the bitrate table look up */

        gfc.samplerate_index = SmpFrqIndex(gfp.out_samplerate, gfp);
        if (!gfp.free_format)
          /*
          * for non Free Format find the nearest allowed
          * bitrate
          */
          gfp.brate = FindNearestBitrate(gfp.brate, gfp.version, gfp.out_samplerate);
      }

      if (gfp.out_samplerate != 0) {
        if (gfp.out_samplerate < 16000) {
          gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps, 8);
          gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps, 64);
        } else if (gfp.out_samplerate < 32000) {
          gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps, 8);
          gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps, 160);
        } else {
          gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps, 32);
          gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps, 320);
        }
      }
      /****************************************************************/

      /* if a filter has not been enabled, see if we should add one: */

      /****************************************************************/


      if (gfp.lowpassfreq == 0) {
        var lowpass = 16000.;

        switch (gfp.VBR) {
          case $ecb6e13812bdc08b$var$VbrMode.vbr_off:
            var lh = new LowPassHighPass();
            optimum_bandwidth(lh, gfp.brate);
            lowpass = lh.lowerlimit;
            break;

          case $ecb6e13812bdc08b$var$VbrMode.vbr_abr:
            var lh = new LowPassHighPass();
            optimum_bandwidth(lh, gfp.VBR_mean_bitrate_kbps);
            lowpass = lh.lowerlimit;
            break;

          case $ecb6e13812bdc08b$var$VbrMode.vbr_rh:
            var x = [19500, 19000, 18600, 18000, 17500, 16000, 15600, 14900, 12500, 10000, 3950];

            if (0 <= gfp.VBR_q && gfp.VBR_q <= 9) {
              var a = x[gfp.VBR_q],
                  b = x[gfp.VBR_q + 1],
                  m = gfp.VBR_q_frac;
              lowpass = linear_int(a, b, m);
            } else lowpass = 19500;

            break;

          default:
            var x = [19500, 19000, 18500, 18000, 17500, 16500, 15500, 14500, 12500, 9500, 3950];

            if (0 <= gfp.VBR_q && gfp.VBR_q <= 9) {
              var a = x[gfp.VBR_q],
                  b = x[gfp.VBR_q + 1],
                  m = gfp.VBR_q_frac;
              lowpass = linear_int(a, b, m);
            } else lowpass = 19500;

        }

        if (gfp.mode == MPEGMode.MONO && (gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_off || gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_abr)) lowpass *= 1.5;
        gfp.lowpassfreq = lowpass | 0;
      }

      if (gfp.out_samplerate == 0) {
        if (2 * gfp.lowpassfreq > gfp.in_samplerate) gfp.lowpassfreq = gfp.in_samplerate / 2;
        gfp.out_samplerate = optimum_samplefreq(gfp.lowpassfreq | 0, gfp.in_samplerate);
      }

      gfp.lowpassfreq = Math.min(20500, gfp.lowpassfreq);
      gfp.lowpassfreq = Math.min(gfp.out_samplerate / 2, gfp.lowpassfreq);
      if (gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_off) gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out / (1.e3 * gfp.brate);
      if (gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_abr) gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out / (1.e3 * gfp.VBR_mean_bitrate_kbps);
      /*
      * do not compute ReplayGain values and do not find the peak sample if
      * we can't store them
      */

      if (!gfp.bWriteVbrTag) {
        gfp.findReplayGain = false;
        gfp.decode_on_the_fly = false;
        gfc.findPeakSample = false;
      }

      gfc.findReplayGain = gfp.findReplayGain;
      gfc.decode_on_the_fly = gfp.decode_on_the_fly;
      if (gfc.decode_on_the_fly) gfc.findPeakSample = true;

      if (gfc.findReplayGain) {
        if (ga.InitGainAnalysis(gfc.rgdata, gfp.out_samplerate) == GainAnalysis.INIT_GAIN_ANALYSIS_ERROR) {
          gfp.internal_flags = null;
          return -6;
        }
      }

      if (gfc.decode_on_the_fly && !gfp.decode_only) {
        if (gfc.hip != null) mpglib.hip_decode_exit(gfc.hip);
        gfc.hip = mpglib.hip_decode_init();
      }

      gfc.mode_gr = gfp.out_samplerate <= 24000 ? 1 : 2;
      /*
      * Number of granules per frame
      */

      gfp.framesize = 576 * gfc.mode_gr;
      gfp.encoder_delay = $cPNKB.ENCDELAY;
      gfc.resample_ratio = gfp.in_samplerate / gfp.out_samplerate;
      /**
      * <PRE>
      *  sample freq       bitrate     compression ratio
      *     [kHz]      [kbps/channel]   for 16 bit input
      *     44.1            56               12.6
      *     44.1            64               11.025
      *     44.1            80                8.82
      *     22.05           24               14.7
      *     22.05           32               11.025
      *     22.05           40                8.82
      *     16              16               16.0
      *     16              24               10.667
      * </PRE>
      */

      /**
      * <PRE>
      *  For VBR, take a guess at the compression_ratio.
      *  For example:
      *
      *    VBR_q    compression     like
      *     -        4.4         320 kbps/44 kHz
      *   0...1      5.5         256 kbps/44 kHz
      *     2        7.3         192 kbps/44 kHz
      *     4        8.8         160 kbps/44 kHz
      *     6       11           128 kbps/44 kHz
      *     9       14.7          96 kbps
      *
      *  for lower bitrates, downsample with --resample
      * </PRE>
      */

      switch (gfp.VBR) {
        case $ecb6e13812bdc08b$var$VbrMode.vbr_mt:
        case $ecb6e13812bdc08b$var$VbrMode.vbr_rh:
        case $ecb6e13812bdc08b$var$VbrMode.vbr_mtrh:
          /* numbers are a bit strange, but they determine the lowpass value */
          var cmp = [5.7, 6.5, 7.3, 8.2, 10, 11.9, 13, 14, 15, 16.5];
          gfp.compression_ratio = cmp[gfp.VBR_q];
          break;

        case $ecb6e13812bdc08b$var$VbrMode.vbr_abr:
          gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out / (1.e3 * gfp.VBR_mean_bitrate_kbps);
          break;

        default:
          gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out / (1.e3 * gfp.brate);
          break;
      }
      /*
      * mode = -1 (not set by user) or mode = MONO (because of only 1 input
      * channel). If mode has not been set, then select J-STEREO
      */


      if (gfp.mode == MPEGMode.NOT_SET) gfp.mode = MPEGMode.JOINT_STEREO;
      /* apply user driven high pass filter */

      if (gfp.highpassfreq > 0) {
        gfc.highpass1 = 2. * gfp.highpassfreq;
        if (gfp.highpasswidth >= 0) gfc.highpass2 = 2. * (gfp.highpassfreq + gfp.highpasswidth);else
          /* 0% above on default */
          gfc.highpass2 = 2 * gfp.highpassfreq;
        gfc.highpass1 /= gfp.out_samplerate;
        gfc.highpass2 /= gfp.out_samplerate;
      } else {
        gfc.highpass1 = 0;
        gfc.highpass2 = 0;
      }
      /* apply user driven low pass filter */


      if (gfp.lowpassfreq > 0) {
        gfc.lowpass2 = 2. * gfp.lowpassfreq;

        if (gfp.lowpasswidth >= 0) {
          gfc.lowpass1 = 2. * (gfp.lowpassfreq - gfp.lowpasswidth);
          if (gfc.lowpass1 < 0)
            /* has to be >= 0 */
            gfc.lowpass1 = 0;
        } else gfc.lowpass1 = 2 * gfp.lowpassfreq;

        gfc.lowpass1 /= gfp.out_samplerate;
        gfc.lowpass2 /= gfp.out_samplerate;
      } else {
        gfc.lowpass1 = 0;
        gfc.lowpass2 = 0;
      }
      /**********************************************************************/

      /* compute info needed for polyphase filter (filter type==0, default) */

      /**********************************************************************/


      lame_init_params_ppflt(gfp);
      /*******************************************************
      * samplerate and bitrate index
      *******************************************************/

      gfc.samplerate_index = SmpFrqIndex(gfp.out_samplerate, gfp);

      if (gfc.samplerate_index < 0) {
        gfp.internal_flags = null;
        return -1;
      }

      if (gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_off) {
        if (gfp.free_format) gfc.bitrate_index = 0;else {
          gfp.brate = FindNearestBitrate(gfp.brate, gfp.version, gfp.out_samplerate);
          gfc.bitrate_index = BitrateIndex(gfp.brate, gfp.version, gfp.out_samplerate);

          if (gfc.bitrate_index <= 0) {
            gfp.internal_flags = null;
            return -1;
          }
        }
      } else gfc.bitrate_index = 1;
      /* for CBR, we will write an "info" tag. */


      if (gfp.analysis) gfp.bWriteVbrTag = false;
      /* some file options not allowed if output is: not specified or stdout */

      if (gfc.pinfo != null) gfp.bWriteVbrTag = false;
      /* disable Xing VBR tag */

      bs.init_bit_stream_w(gfc);
      var j = gfc.samplerate_index + 3 * gfp.version + 6 * (gfp.out_samplerate < 16000 ? 1 : 0);

      for (var i = 0; i < $cPNKB.SBMAX_l + 1; i++) gfc.scalefac_band.l[i] = qupvt.sfBandIndex[j].l[i];

      for (var i = 0; i < $cPNKB.PSFB21 + 1; i++) {
        var size = (gfc.scalefac_band.l[22] - gfc.scalefac_band.l[21]) / $cPNKB.PSFB21;
        var start = gfc.scalefac_band.l[21] + i * size;
        gfc.scalefac_band.psfb21[i] = start;
      }

      gfc.scalefac_band.psfb21[$cPNKB.PSFB21] = 576;

      for (var i = 0; i < $cPNKB.SBMAX_s + 1; i++) gfc.scalefac_band.s[i] = qupvt.sfBandIndex[j].s[i];

      for (var i = 0; i < $cPNKB.PSFB12 + 1; i++) {
        var size = (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12]) / $cPNKB.PSFB12;
        var start = gfc.scalefac_band.s[12] + i * size;
        gfc.scalefac_band.psfb12[i] = start;
      }

      gfc.scalefac_band.psfb12[$cPNKB.PSFB12] = 192;
      /* determine the mean bitrate for main data */

      if (gfp.version == 1)
        /* MPEG 1 */
        gfc.sideinfo_len = gfc.channels_out == 1 ? 21 : 36;else
        /* MPEG 2 */
        gfc.sideinfo_len = gfc.channels_out == 1 ? 13 : 21;
      if (gfp.error_protection) gfc.sideinfo_len += 2;
      lame_init_bitstream(gfp);
      gfc.Class_ID = LAME_ID;
      var k;

      for (k = 0; k < 19; k++) gfc.nsPsy.pefirbuf[k] = 700 * gfc.mode_gr * gfc.channels_out;

      if (gfp.ATHtype == -1) gfp.ATHtype = 4;
      $ecb6e13812bdc08b$var$assert(gfp.VBR_q <= 9);
      $ecb6e13812bdc08b$var$assert(gfp.VBR_q >= 0);

      switch (gfp.VBR) {
        case $ecb6e13812bdc08b$var$VbrMode.vbr_mt:
          gfp.VBR = $ecb6e13812bdc08b$var$VbrMode.vbr_mtrh;
        //$FALL-THROUGH$

        case $ecb6e13812bdc08b$var$VbrMode.vbr_mtrh:
          if (gfp.useTemporal == null) gfp.useTemporal = false;
          p.apply_preset(gfp, 500 - gfp.VBR_q * 10, 0);
          /**
          * <PRE>
          *   The newer VBR code supports only a limited
          *     subset of quality levels:
          *     9-5=5 are the same, uses x^3/4 quantization
          *   4-0=0 are the same  5 plus best huffman divide code
          * </PRE>
          */

          if (gfp.quality < 0) gfp.quality = LAME_DEFAULT_QUALITY;
          if (gfp.quality < 5) gfp.quality = 0;
          if (gfp.quality > 5) gfp.quality = 5;
          gfc.PSY.mask_adjust = gfp.maskingadjust;
          gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;
          /*
          * sfb21 extra only with MPEG-1 at higher sampling rates
          */

          if (gfp.experimentalY) gfc.sfb21_extra = false;else gfc.sfb21_extra = gfp.out_samplerate > 44000;
          gfc.iteration_loop = new VBRNewIterationLoop(qu);
          break;

        case $ecb6e13812bdc08b$var$VbrMode.vbr_rh:
          p.apply_preset(gfp, 500 - gfp.VBR_q * 10, 0);
          gfc.PSY.mask_adjust = gfp.maskingadjust;
          gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;
          /*
          * sfb21 extra only with MPEG-1 at higher sampling rates
          */

          if (gfp.experimentalY) gfc.sfb21_extra = false;else gfc.sfb21_extra = gfp.out_samplerate > 44000;
          /*
          * VBR needs at least the output of GPSYCHO, so we have to garantee
          * that by setting a minimum quality level, actually level 6 does
          * it. down to level 6
          */

          if (gfp.quality > 6) gfp.quality = 6;
          if (gfp.quality < 0) gfp.quality = LAME_DEFAULT_QUALITY;
          gfc.iteration_loop = new VBROldIterationLoop(qu);
          break;

        default:
          var vbrmode;
          /*
          * no sfb21 extra with CBR code
          */

          gfc.sfb21_extra = false;
          if (gfp.quality < 0) gfp.quality = LAME_DEFAULT_QUALITY;
          vbrmode = gfp.VBR;
          if (vbrmode == $ecb6e13812bdc08b$var$VbrMode.vbr_off) gfp.VBR_mean_bitrate_kbps = gfp.brate;
          /* second, set parameters depending on bitrate */

          p.apply_preset(gfp, gfp.VBR_mean_bitrate_kbps, 0);
          gfp.VBR = vbrmode;
          gfc.PSY.mask_adjust = gfp.maskingadjust;
          gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;
          if (vbrmode == $ecb6e13812bdc08b$var$VbrMode.vbr_off) gfc.iteration_loop = new $e32wu(qu);else gfc.iteration_loop = new ABRIterationLoop(qu);
          break;
      }

      $ecb6e13812bdc08b$var$assert(gfp.scale >= 0);
      /* initialize default values common for all modes */

      if (gfp.VBR != $ecb6e13812bdc08b$var$VbrMode.vbr_off) {
        /* if the user didn't specify VBR_max_bitrate: */
        gfc.VBR_min_bitrate = 1;
        /*
        * default: allow 8 kbps (MPEG-2) or 32 kbps (MPEG-1)
        */

        gfc.VBR_max_bitrate = 14;
        /*
        * default: allow 160 kbps (MPEG-2) or 320 kbps (MPEG-1)
        */

        if (gfp.out_samplerate < 16000) gfc.VBR_max_bitrate = 8;
        /* default: allow 64 kbps (MPEG-2.5) */

        if (gfp.VBR_min_bitrate_kbps != 0) {
          gfp.VBR_min_bitrate_kbps = FindNearestBitrate(gfp.VBR_min_bitrate_kbps, gfp.version, gfp.out_samplerate);
          gfc.VBR_min_bitrate = BitrateIndex(gfp.VBR_min_bitrate_kbps, gfp.version, gfp.out_samplerate);
          if (gfc.VBR_min_bitrate < 0) return -1;
        }

        if (gfp.VBR_max_bitrate_kbps != 0) {
          gfp.VBR_max_bitrate_kbps = FindNearestBitrate(gfp.VBR_max_bitrate_kbps, gfp.version, gfp.out_samplerate);
          gfc.VBR_max_bitrate = BitrateIndex(gfp.VBR_max_bitrate_kbps, gfp.version, gfp.out_samplerate);
          if (gfc.VBR_max_bitrate < 0) return -1;
        }

        gfp.VBR_min_bitrate_kbps = $dQDcS.bitrate_table[gfp.version][gfc.VBR_min_bitrate];
        gfp.VBR_max_bitrate_kbps = $dQDcS.bitrate_table[gfp.version][gfc.VBR_max_bitrate];
        gfp.VBR_mean_bitrate_kbps = Math.min($dQDcS.bitrate_table[gfp.version][gfc.VBR_max_bitrate], gfp.VBR_mean_bitrate_kbps);
        gfp.VBR_mean_bitrate_kbps = Math.max($dQDcS.bitrate_table[gfp.version][gfc.VBR_min_bitrate], gfp.VBR_mean_bitrate_kbps);
      }
      /* just another daily changing developer switch */


      if (gfp.tune) {
        gfc.PSY.mask_adjust += gfp.tune_value_a;
        gfc.PSY.mask_adjust_short += gfp.tune_value_a;
      }
      /* initialize internal qval settings */


      lame_init_qval(gfp);
      $ecb6e13812bdc08b$var$assert(gfp.scale >= 0);
      /*
      * automatic ATH adjustment on
      */

      if (gfp.athaa_type < 0) gfc.ATH.useAdjust = 3;else gfc.ATH.useAdjust = gfp.athaa_type;
      /* initialize internal adaptive ATH settings -jd */

      gfc.ATH.aaSensitivityP = Math.pow(10.0, gfp.athaa_sensitivity / -10);
      if (gfp.short_blocks == null) gfp.short_blocks = $ecb6e13812bdc08b$var$ShortBlock.short_block_allowed;
      /*
      * Note Jan/2003: Many hardware decoders cannot handle short blocks in
      * regular stereo mode unless they are coupled (same type in both
      * channels) it is a rare event (1 frame per min. or so) that LAME would
      * use uncoupled short blocks, so lets turn them off until we decide how
      * to handle this. No other encoders allow uncoupled short blocks, even
      * though it is in the standard.
      */

      /*
      * rh 20040217: coupling makes no sense for mono and dual-mono streams
      */

      if (gfp.short_blocks == $ecb6e13812bdc08b$var$ShortBlock.short_block_allowed && (gfp.mode == MPEGMode.JOINT_STEREO || gfp.mode == MPEGMode.STEREO)) gfp.short_blocks = $ecb6e13812bdc08b$var$ShortBlock.short_block_coupled;
      if (gfp.quant_comp < 0) gfp.quant_comp = 1;
      if (gfp.quant_comp_short < 0) gfp.quant_comp_short = 0;
      if (gfp.msfix < 0) gfp.msfix = 0;
      /* select psychoacoustic model */

      gfp.exp_nspsytune = gfp.exp_nspsytune | 1;
      if (gfp.internal_flags.nsPsy.attackthre < 0) gfp.internal_flags.nsPsy.attackthre = $d2VP0.NSATTACKTHRE;
      if (gfp.internal_flags.nsPsy.attackthre_s < 0) gfp.internal_flags.nsPsy.attackthre_s = $d2VP0.NSATTACKTHRE_S;
      $ecb6e13812bdc08b$var$assert(gfp.scale >= 0);
      if (gfp.scale < 0) gfp.scale = 1;
      if (gfp.ATHtype < 0) gfp.ATHtype = 4;
      if (gfp.ATHcurve < 0) gfp.ATHcurve = 4;
      if (gfp.athaa_loudapprox < 0) gfp.athaa_loudapprox = 2;
      if (gfp.interChRatio < 0) gfp.interChRatio = 0;
      if (gfp.useTemporal == null) gfp.useTemporal = true;
      /* on by default */

      /*
      * padding method as described in
      * "MPEG-Layer3 / Bitstream Syntax and Decoding" by Martin Sieler, Ralph
      * Sperschneider
      *
      * note: there is no padding for the very first frame
      *
      * Robert Hegemann 2000-06-22
      */

      gfc.slot_lag = gfc.frac_SpF = 0;
      if (gfp.VBR == $ecb6e13812bdc08b$var$VbrMode.vbr_off) gfc.slot_lag = gfc.frac_SpF = (gfp.version + 1) * 72000 * gfp.brate % gfp.out_samplerate | 0;
      qupvt.iteration_init(gfp);
      psy.psymodel_init(gfp);
      $ecb6e13812bdc08b$var$assert(gfp.scale >= 0);
      return 0;
    };

    function update_inbuffer_size(gfc, nsamples) {
      if (gfc.in_buffer_0 == null || gfc.in_buffer_nsamples < nsamples) {
        gfc.in_buffer_0 = $ecb6e13812bdc08b$var$new_float(nsamples);
        gfc.in_buffer_1 = $ecb6e13812bdc08b$var$new_float(nsamples);
        gfc.in_buffer_nsamples = nsamples;
      }
    }

    this.lame_encode_flush = function (gfp, mp3buffer, mp3bufferPos, mp3buffer_size) {
      var gfc = gfp.internal_flags;
      var buffer = $ecb6e13812bdc08b$var$new_short_n([2, 1152]);
      var imp3 = 0,
          mp3count,
          mp3buffer_size_remaining;
      /*
      * we always add POSTDELAY=288 padding to make sure granule with real
      * data can be complety decoded (because of 50% overlap with next
      * granule
      */

      var end_padding;
      var frames_left;
      var samples_to_encode = gfc.mf_samples_to_encode - $cPNKB.POSTDELAY;
      var mf_needed = calcNeeded(gfp);
      /* Was flush already called? */

      if (gfc.mf_samples_to_encode < 1) return 0;
      mp3count = 0;
      if (gfp.in_samplerate != gfp.out_samplerate)
        /*
        * delay due to resampling; needs to be fixed, if resampling code
        * gets changed
        */
        samples_to_encode += 16. * gfp.out_samplerate / gfp.in_samplerate;
      end_padding = gfp.framesize - samples_to_encode % gfp.framesize;
      if (end_padding < 576) end_padding += gfp.framesize;
      gfp.encoder_padding = end_padding;
      frames_left = (samples_to_encode + end_padding) / gfp.framesize;
      /*
      * send in a frame of 0 padding until all internal sample buffers are
      * flushed
      */

      while (frames_left > 0 && imp3 >= 0) {
        var bunch = mf_needed - gfc.mf_size;
        var frame_num = gfp.frameNum;
        bunch *= gfp.in_samplerate;
        bunch /= gfp.out_samplerate;
        if (bunch > 1152) bunch = 1152;
        if (bunch < 1) bunch = 1;
        mp3buffer_size_remaining = mp3buffer_size - mp3count;
        /* if user specifed buffer size = 0, dont check size */

        if (mp3buffer_size == 0) mp3buffer_size_remaining = 0;
        imp3 = this.lame_encode_buffer(gfp, buffer[0], buffer[1], bunch, mp3buffer, mp3bufferPos, mp3buffer_size_remaining);
        mp3bufferPos += imp3;
        mp3count += imp3;
        frames_left -= frame_num != gfp.frameNum ? 1 : 0;
      }
      /*
      * Set gfc.mf_samples_to_encode to 0, so we may detect and break loops
      * calling it more than once in a row.
      */


      gfc.mf_samples_to_encode = 0;
      if (imp3 < 0)
        /* some type of fatal error */
        return imp3;
      mp3buffer_size_remaining = mp3buffer_size - mp3count;
      /* if user specifed buffer size = 0, dont check size */

      if (mp3buffer_size == 0) mp3buffer_size_remaining = 0;
      /* mp3 related stuff. bit buffer might still contain some mp3 data */

      bs.flush_bitstream(gfp);
      imp3 = bs.copy_buffer(gfc, mp3buffer, mp3bufferPos, mp3buffer_size_remaining, 1);
      if (imp3 < 0)
        /* some type of fatal error */
        return imp3;
      mp3bufferPos += imp3;
      mp3count += imp3;
      mp3buffer_size_remaining = mp3buffer_size - mp3count;
      /* if user specifed buffer size = 0, dont check size */

      if (mp3buffer_size == 0) mp3buffer_size_remaining = 0;

      if (gfp.write_id3tag_automatic) {
        /* write a id3 tag to the bitstream */
        id3.id3tag_write_v1(gfp);
        imp3 = bs.copy_buffer(gfc, mp3buffer, mp3bufferPos, mp3buffer_size_remaining, 0);
        if (imp3 < 0) return imp3;
        mp3count += imp3;
      }

      return mp3count;
    };

    this.lame_encode_buffer = function (gfp, buffer_l, buffer_r, nsamples, mp3buf, mp3bufPos, mp3buf_size) {
      var gfc = gfp.internal_flags;
      var in_buffer = [null, null];
      if (gfc.Class_ID != LAME_ID) return -3;
      if (nsamples == 0) return 0;
      update_inbuffer_size(gfc, nsamples);
      in_buffer[0] = gfc.in_buffer_0;
      in_buffer[1] = gfc.in_buffer_1;
      /* make a copy of input buffer, changing type to sample_t */

      for (var i = 0; i < nsamples; i++) {
        in_buffer[0][i] = buffer_l[i];
        if (gfc.channels_in > 1) in_buffer[1][i] = buffer_r[i];
      }

      return lame_encode_buffer_sample(gfp, in_buffer[0], in_buffer[1], nsamples, mp3buf, mp3bufPos, mp3buf_size);
    };

    function calcNeeded(gfp) {
      var mf_needed = $cPNKB.BLKSIZE + gfp.framesize - $cPNKB.FFTOFFSET;
      /*
      * amount needed for FFT
      */

      mf_needed = Math.max(mf_needed, 512 + gfp.framesize - 32);
      $ecb6e13812bdc08b$var$assert($4SDnr.MFSIZE >= mf_needed);
      return mf_needed;
    }

    function lame_encode_buffer_sample(gfp, buffer_l, buffer_r, nsamples, mp3buf, mp3bufPos, mp3buf_size) {
      var gfc = gfp.internal_flags;
      var mp3size = 0,
          ret,
          i,
          ch,
          mf_needed;
      var mp3out;
      var mfbuf = [null, null];
      var in_buffer = [null, null];
      if (gfc.Class_ID != LAME_ID) return -3;
      if (nsamples == 0) return 0;
      /* copy out any tags that may have been written into bitstream */

      mp3out = bs.copy_buffer(gfc, mp3buf, mp3bufPos, mp3buf_size, 0);
      if (mp3out < 0) return mp3out;
      /* not enough buffer space */

      mp3bufPos += mp3out;
      mp3size += mp3out;
      in_buffer[0] = buffer_l;
      in_buffer[1] = buffer_r;
      /* Apply user defined re-scaling */

      /* user selected scaling of the samples */

      if ($ctaQC.NEQ(gfp.scale, 0) && $ctaQC.NEQ(gfp.scale, 1.0)) for (i = 0; i < nsamples; ++i) {
        in_buffer[0][i] *= gfp.scale;
        if (gfc.channels_out == 2) in_buffer[1][i] *= gfp.scale;
      }
      /* user selected scaling of the channel 0 (left) samples */

      if ($ctaQC.NEQ(gfp.scale_left, 0) && $ctaQC.NEQ(gfp.scale_left, 1.0)) for (i = 0; i < nsamples; ++i) in_buffer[0][i] *= gfp.scale_left;
      /* user selected scaling of the channel 1 (right) samples */

      if ($ctaQC.NEQ(gfp.scale_right, 0) && $ctaQC.NEQ(gfp.scale_right, 1.0)) for (i = 0; i < nsamples; ++i) in_buffer[1][i] *= gfp.scale_right;
      /* Downsample to Mono if 2 channels in and 1 channel out */

      if (gfp.num_channels == 2 && gfc.channels_out == 1) for (i = 0; i < nsamples; ++i) {
        in_buffer[0][i] = 0.5 * (in_buffer[0][i] + in_buffer[1][i]);
        in_buffer[1][i] = 0.0;
      }
      mf_needed = calcNeeded(gfp);
      mfbuf[0] = gfc.mfbuf[0];
      mfbuf[1] = gfc.mfbuf[1];
      var in_bufferPos = 0;

      while (nsamples > 0) {
        var in_buffer_ptr = [null, null];
        var n_in = 0;
        /* number of input samples processed with fill_buffer */

        var n_out = 0;
        /* number of samples output with fill_buffer */

        /* n_in <> n_out if we are resampling */

        in_buffer_ptr[0] = in_buffer[0];
        in_buffer_ptr[1] = in_buffer[1];
        /* copy in new samples into mfbuf, with resampling */

        var inOut = new InOut();
        fill_buffer(gfp, mfbuf, in_buffer_ptr, in_bufferPos, nsamples, inOut);
        n_in = inOut.n_in;
        n_out = inOut.n_out;
        /* compute ReplayGain of resampled input if requested */

        if (gfc.findReplayGain && !gfc.decode_on_the_fly) {
          if (ga.AnalyzeSamples(gfc.rgdata, mfbuf[0], gfc.mf_size, mfbuf[1], gfc.mf_size, n_out, gfc.channels_out) == GainAnalysis.GAIN_ANALYSIS_ERROR) return -6;
        }
        /* update in_buffer counters */


        nsamples -= n_in;
        in_bufferPos += n_in;
        gfc.channels_out; // in_bufferPos += n_in;

        /* update mfbuf[] counters */

        gfc.mf_size += n_out;
        $ecb6e13812bdc08b$var$assert(gfc.mf_size <= $4SDnr.MFSIZE);
        /*
        * lame_encode_flush may have set gfc.mf_sample_to_encode to 0 so we
        * have to reinitialize it here when that happened.
        */

        if (gfc.mf_samples_to_encode < 1) gfc.mf_samples_to_encode = $cPNKB.ENCDELAY + $cPNKB.POSTDELAY;
        gfc.mf_samples_to_encode += n_out;

        if (gfc.mf_size >= mf_needed) {
          /* encode the frame. */

          /* mp3buf = pointer to current location in buffer */

          /* mp3buf_size = size of original mp3 output buffer */

          /* = 0 if we should not worry about the */

          /* buffer size because calling program is */

          /* to lazy to compute it */

          /* mp3size = size of data written to buffer so far */

          /* mp3buf_size-mp3size = amount of space avalable */
          var buf_size = mp3buf_size - mp3size;
          if (mp3buf_size == 0) buf_size = 0;
          ret = lame_encode_frame(gfp, mfbuf[0], mfbuf[1], mp3buf, mp3bufPos, buf_size);
          if (ret < 0) return ret;
          mp3bufPos += ret;
          mp3size += ret;
          /* shift out old samples */

          gfc.mf_size -= gfp.framesize;
          gfc.mf_samples_to_encode -= gfp.framesize;

          for (ch = 0; ch < gfc.channels_out; ch++) for (i = 0; i < gfc.mf_size; i++) mfbuf[ch][i] = mfbuf[ch][i + gfp.framesize];
        }
      }

      $ecb6e13812bdc08b$var$assert(nsamples == 0);
      return mp3size;
    }

    function lame_encode_frame(gfp, inbuf_l, inbuf_r, mp3buf, mp3bufPos, mp3buf_size) {
      var ret = self.enc.lame_encode_mp3_frame(gfp, inbuf_l, inbuf_r, mp3buf, mp3bufPos, mp3buf_size);
      gfp.frameNum++;
      return ret;
    }

    function InOut() {
      this.n_in = 0;
      this.n_out = 0;
    }

    function NumUsed() {
      this.num_used = 0;
    }
    /**
    * Greatest common divisor.
    * <p>
    * Joint work of Euclid and M. Hendry
    */


    function gcd(i, j) {
      return j != 0 ? gcd(j, i % j) : i;
    }
    /**
    * Resampling via FIR filter, blackman window.
    */


    function blackman(x, fcn, l) {
      /*
      * This algorithm from: SIGNAL PROCESSING ALGORITHMS IN FORTRAN AND C
      * S.D. Stearns and R.A. David, Prentice-Hall, 1992
      */
      var wcn = Math.PI * fcn;
      x /= l;
      if (x < 0) x = 0;
      if (x > 1) x = 1;
      var x2 = x - .5;
      var bkwn = 0.42 - 0.5 * Math.cos(2 * x * Math.PI) + 0.08 * Math.cos(4 * x * Math.PI);
      if (Math.abs(x2) < 1e-9) return wcn / Math.PI;else return bkwn * Math.sin(l * wcn * x2) / (Math.PI * l * x2);
    }

    function fill_buffer_resample(gfp, outbuf, outbufPos, desired_len, inbuf, in_bufferPos, len, num_used, ch) {
      var gfc = gfp.internal_flags;
      var i,
          j = 0,
          k;
      /* number of convolution functions to pre-compute */

      var bpc = gfp.out_samplerate / gcd(gfp.out_samplerate, gfp.in_samplerate);
      if (bpc > $4SDnr.BPC) bpc = $4SDnr.BPC;
      var intratio = Math.abs(gfc.resample_ratio - Math.floor(.5 + gfc.resample_ratio)) < .0001 ? 1 : 0;
      var fcn = 1.00 / gfc.resample_ratio;
      if (fcn > 1.00) fcn = 1.00;
      var filter_l = 31;
      if (0 == filter_l % 2) --filter_l;
      /* must be odd */

      filter_l += intratio;
      /* unless resample_ratio=int, it must be even */

      var BLACKSIZE = filter_l + 1;
      /* size of data needed for FIR */

      if (gfc.fill_buffer_resample_init == 0) {
        gfc.inbuf_old[0] = $ecb6e13812bdc08b$var$new_float(BLACKSIZE);
        gfc.inbuf_old[1] = $ecb6e13812bdc08b$var$new_float(BLACKSIZE);

        for (i = 0; i <= 2 * bpc; ++i) gfc.blackfilt[i] = $ecb6e13812bdc08b$var$new_float(BLACKSIZE);

        gfc.itime[0] = 0;
        gfc.itime[1] = 0;
        /* precompute blackman filter coefficients */

        for (j = 0; j <= 2 * bpc; j++) {
          var sum = 0.;
          var offset = (j - bpc) / (2. * bpc);

          for (i = 0; i <= filter_l; i++) sum += gfc.blackfilt[j][i] = blackman(i - offset, fcn, filter_l);

          for (i = 0; i <= filter_l; i++) gfc.blackfilt[j][i] /= sum;
        }

        gfc.fill_buffer_resample_init = 1;
      }

      var inbuf_old = gfc.inbuf_old[ch];
      /* time of j'th element in inbuf = itime + j/ifreq; */

      /* time of k'th element in outbuf = j/ofreq */

      for (k = 0; k < desired_len; k++) {
        var time0;
        var joff;
        time0 = k * gfc.resample_ratio;
        /* time of k'th output sample */

        j = 0 | Math.floor(time0 - gfc.itime[ch]);
        /* check if we need more input data */

        if (filter_l + j - filter_l / 2 >= len) break;
        /* blackman filter. by default, window centered at j+.5(filter_l%2) */

        /* but we want a window centered at time0. */

        var offset = time0 - gfc.itime[ch] - (j + .5 * (filter_l % 2));
        $ecb6e13812bdc08b$var$assert(Math.abs(offset) <= .501);
        /* find the closest precomputed window for this offset: */

        joff = 0 | Math.floor(offset * 2 * bpc + bpc + .5);
        var xvalue = 0.;

        for (i = 0; i <= filter_l; ++i) {
          /* force integer index */
          var j2 = 0 | i + j - filter_l / 2;
          var y;
          $ecb6e13812bdc08b$var$assert(j2 < len);
          $ecb6e13812bdc08b$var$assert(j2 + BLACKSIZE >= 0);
          y = j2 < 0 ? inbuf_old[BLACKSIZE + j2] : inbuf[in_bufferPos + j2];
          xvalue += y * gfc.blackfilt[joff][i];
        }

        outbuf[outbufPos + k] = xvalue;
      }
      /* k = number of samples added to outbuf */

      /* last k sample used data from [j-filter_l/2,j+filter_l-filter_l/2] */

      /* how many samples of input data were used: */


      num_used.num_used = Math.min(len, filter_l + j - filter_l / 2);
      /*
      * adjust our input time counter. Incriment by the number of samples
      * used, then normalize so that next output sample is at time 0, next
      * input buffer is at time itime[ch]
      */

      gfc.itime[ch] += num_used.num_used - k * gfc.resample_ratio;
      /* save the last BLACKSIZE samples into the inbuf_old buffer */

      if (num_used.num_used >= BLACKSIZE) for (i = 0; i < BLACKSIZE; i++) inbuf_old[i] = inbuf[in_bufferPos + num_used.num_used + i - BLACKSIZE];else {
        /* shift in num_used.num_used samples into inbuf_old */
        var n_shift = BLACKSIZE - num_used.num_used;
        /*
        * number of samples to
        * shift
        */

        /*
        * shift n_shift samples by num_used.num_used, to make room for the
        * num_used new samples
        */

        for (i = 0; i < n_shift; ++i) inbuf_old[i] = inbuf_old[i + num_used.num_used];
        /* shift in the num_used.num_used samples */


        for (j = 0; i < BLACKSIZE; ++i, ++j) inbuf_old[i] = inbuf[in_bufferPos + j];

        $ecb6e13812bdc08b$var$assert(j == num_used.num_used);
      }
      return k;
      /* return the number samples created at the new samplerate */
    }

    function fill_buffer(gfp, mfbuf, in_buffer, in_bufferPos, nsamples, io) {
      var gfc = gfp.internal_flags;
      /* copy in new samples into mfbuf, with resampling if necessary */

      if (gfc.resample_ratio < .9999 || gfc.resample_ratio > 1.0001) for (var ch = 0; ch < gfc.channels_out; ch++) {
        var numUsed = new NumUsed();
        io.n_out = fill_buffer_resample(gfp, mfbuf[ch], gfc.mf_size, gfp.framesize, in_buffer[ch], in_bufferPos, nsamples, numUsed, ch);
        io.n_in = numUsed.num_used;
      } else {
        io.n_out = Math.min(gfp.framesize, nsamples);
        io.n_in = io.n_out;

        for (var i = 0; i < io.n_out; ++i) {
          mfbuf[0][gfc.mf_size + i] = in_buffer[0][in_bufferPos + i];
          if (gfc.channels_out == 2) mfbuf[1][gfc.mf_size + i] = in_buffer[1][in_bufferPos + i];
        }
      }
    }
  }

  module.exports = $ecb6e13812bdc08b$var$Lame;
});
parcelRequire.register("3YDN3", function (module, exports) {
  function $2e55d7364d01815c$var$new_byte(count) {
    return new Int8Array(count);
  }

  function $2e55d7364d01815c$var$new_short(count) {
    return new Int16Array(count);
  }

  function $2e55d7364d01815c$var$new_int(count) {
    return new Int32Array(count);
  }

  function $2e55d7364d01815c$var$new_float(count) {
    return new Float32Array(count);
  }

  function $2e55d7364d01815c$var$new_double(count) {
    return new Float64Array(count);
  }

  function $2e55d7364d01815c$var$new_float_n(args) {
    if (args.length == 1) return $2e55d7364d01815c$var$new_float(args[0]);
    var sz = args[0];
    args = args.slice(1);
    var A = [];

    for (var i = 0; i < sz; i++) A.push($2e55d7364d01815c$var$new_float_n(args));

    return A;
  }

  function $2e55d7364d01815c$var$new_int_n(args) {
    if (args.length == 1) return $2e55d7364d01815c$var$new_int(args[0]);
    var sz = args[0];
    args = args.slice(1);
    var A = [];

    for (var i = 0; i < sz; i++) A.push($2e55d7364d01815c$var$new_int_n(args));

    return A;
  }

  function $2e55d7364d01815c$var$new_short_n(args) {
    if (args.length == 1) return $2e55d7364d01815c$var$new_short(args[0]);
    var sz = args[0];
    args = args.slice(1);
    var A = [];

    for (var i = 0; i < sz; i++) A.push($2e55d7364d01815c$var$new_short_n(args));

    return A;
  }

  function $2e55d7364d01815c$var$new_array_n(args) {
    if (args.length == 1) return new Array(args[0]);
    var sz = args[0];
    args = args.slice(1);
    var A = [];

    for (var i = 0; i < sz; i++) A.push($2e55d7364d01815c$var$new_array_n(args));

    return A;
  }

  var $2e55d7364d01815c$var$Arrays = {};

  $2e55d7364d01815c$var$Arrays.fill = function (a, fromIndex, toIndex, val) {
    if (arguments.length == 2) for (var i = 0; i < a.length; i++) a[i] = arguments[1];else for (var i = fromIndex; i < toIndex; i++) a[i] = val;
  };

  var $2e55d7364d01815c$var$System = {};

  $2e55d7364d01815c$var$System.arraycopy = function (src, srcPos, dest, destPos, length) {
    var srcEnd = srcPos + length;

    while (srcPos < srcEnd) dest[destPos++] = src[srcPos++];
  };

  $2e55d7364d01815c$var$System.out = {};

  $2e55d7364d01815c$var$System.out.println = function (message) {
    console.log(message);
  };

  $2e55d7364d01815c$var$System.out.printf = function () {
    console.log.apply(console, arguments);
  };

  var $2e55d7364d01815c$var$Util = {};
  $2e55d7364d01815c$var$Util.SQRT2 = 1.41421356237309504880;

  $2e55d7364d01815c$var$Util.FAST_LOG10 = function (x) {
    return Math.log10(x);
  };

  $2e55d7364d01815c$var$Util.FAST_LOG10_X = function (x, y) {
    return Math.log10(x) * y;
  };

  function $2e55d7364d01815c$var$ShortBlock(ordinal) {
    this.ordinal = ordinal;
  }
  /**
  * LAME may use them, even different block types for L/R.
  */


  $2e55d7364d01815c$var$ShortBlock.short_block_allowed = new $2e55d7364d01815c$var$ShortBlock(0);
  /**
  * LAME may use them, but always same block types in L/R.
  */

  $2e55d7364d01815c$var$ShortBlock.short_block_coupled = new $2e55d7364d01815c$var$ShortBlock(1);
  /**
  * LAME will not use short blocks, long blocks only.
  */

  $2e55d7364d01815c$var$ShortBlock.short_block_dispensed = new $2e55d7364d01815c$var$ShortBlock(2);
  /**
  * LAME will not use long blocks, short blocks only.
  */

  $2e55d7364d01815c$var$ShortBlock.short_block_forced = new $2e55d7364d01815c$var$ShortBlock(3);
  var $2e55d7364d01815c$var$Float = {};
  $2e55d7364d01815c$var$Float.MAX_VALUE = 3.4028235e+38;

  function $2e55d7364d01815c$var$VbrMode(ordinal) {
    this.ordinal = ordinal;
  }

  $2e55d7364d01815c$var$VbrMode.vbr_off = new $2e55d7364d01815c$var$VbrMode(0);
  $2e55d7364d01815c$var$VbrMode.vbr_mt = new $2e55d7364d01815c$var$VbrMode(1);
  $2e55d7364d01815c$var$VbrMode.vbr_rh = new $2e55d7364d01815c$var$VbrMode(2);
  $2e55d7364d01815c$var$VbrMode.vbr_abr = new $2e55d7364d01815c$var$VbrMode(3);
  $2e55d7364d01815c$var$VbrMode.vbr_mtrh = new $2e55d7364d01815c$var$VbrMode(4);
  $2e55d7364d01815c$var$VbrMode.vbr_default = $2e55d7364d01815c$var$VbrMode.vbr_mtrh;

  var $2e55d7364d01815c$var$assert = function (x) {//console.assert(x);
  };

  module.exports = {
    "System": $2e55d7364d01815c$var$System,
    "VbrMode": $2e55d7364d01815c$var$VbrMode,
    "Float": $2e55d7364d01815c$var$Float,
    "ShortBlock": $2e55d7364d01815c$var$ShortBlock,
    "Util": $2e55d7364d01815c$var$Util,
    "Arrays": $2e55d7364d01815c$var$Arrays,
    "new_array_n": $2e55d7364d01815c$var$new_array_n,
    "new_byte": $2e55d7364d01815c$var$new_byte,
    "new_double": $2e55d7364d01815c$var$new_double,
    "new_float": $2e55d7364d01815c$var$new_float,
    "new_float_n": $2e55d7364d01815c$var$new_float_n,
    "new_int": $2e55d7364d01815c$var$new_int,
    "new_int_n": $2e55d7364d01815c$var$new_int_n,
    "new_short": $2e55d7364d01815c$var$new_short,
    "new_short_n": $2e55d7364d01815c$var$new_short_n,
    "assert": $2e55d7364d01815c$var$assert
  };
});
parcelRequire.register("d2VP0", function (module, exports) {
  /*
  *      psymodel.c
  *
  *      Copyright (c) 1999-2000 Mark Taylor
  *      Copyright (c) 2001-2002 Naoki Shibata
  *      Copyright (c) 2000-2003 Takehiro Tominaga
  *      Copyright (c) 2000-2008 Robert Hegemann
  *      Copyright (c) 2000-2005 Gabriel Bouvigne
  *      Copyright (c) 2000-2005 Alexander Leidinger
  *
  * This library is free software; you can redistribute it and/or
  * modify it under the terms of the GNU Lesser General Public
  * License as published by the Free Software Foundation; either
  * version 2 of the License, or (at your option) any later version.
  *
  * This library is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * Library General Public License for more details.
  *
  * You should have received a copy of the GNU Lesser General Public
  * License along with this library; if not, write to the
  * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
  * Boston, MA 02111-1307, USA.
  */

  /* $Id: PsyModel.java,v 1.27 2011/05/24 20:48:06 kenchis Exp $ */

  /*
  PSYCHO ACOUSTICS
  This routine computes the psycho acoustics, delayed by one granule.
  Input: buffer of PCM data (1024 samples).
  This window should be centered over the 576 sample granule window.
  The routine will compute the psycho acoustics for
  this granule, but return the psycho acoustics computed
  for the *previous* granule.  This is because the block
  type of the previous granule can only be determined
  after we have computed the psycho acoustics for the following
  granule.
  Output:  maskings and energies for each scalefactor band.
  block type, PE, and some correlation measures.
  The PE is used by CBR modes to determine if extra bits
  from the bit reservoir should be used.  The correlation
  measures are used to determine mid/side or regular stereo.
  */

  /*
  Notation:
  barks:  a non-linear frequency scale.  Mapping from frequency to
  barks is given by freq2bark()
  scalefactor bands: The spectrum (frequencies) are broken into
  SBMAX "scalefactor bands".  Thes bands
  are determined by the MPEG ISO spec.  In
  the noise shaping/quantization code, we allocate
  bits among the partition bands to achieve the
  best possible quality
  partition bands:   The spectrum is also broken into about
  64 "partition bands".  Each partition
  band is about .34 barks wide.  There are about 2-5
  partition bands for each scalefactor band.
  LAME computes all psycho acoustic information for each partition
  band.  Then at the end of the computations, this information
  is mapped to scalefactor bands.  The energy in each scalefactor
  band is taken as the sum of the energy in all partition bands
  which overlap the scalefactor band.  The maskings can be computed
  in the same way (and thus represent the average masking in that band)
  or by taking the minmum value multiplied by the number of
  partition bands used (which represents a minimum masking in that band).
  */

  /*
  The general outline is as follows:
  1. compute the energy in each partition band
  2. compute the tonality in each partition band
  3. compute the strength of each partion band "masker"
  4. compute the masking (via the spreading function applied to each masker)
  5. Modifications for mid/side masking.
  Each partition band is considiered a "masker".  The strength
  of the i'th masker in band j is given by:
  s3(bark(i)-bark(j))*strength(i)
  The strength of the masker is a function of the energy and tonality.
  The more tonal, the less masking.  LAME uses a simple linear formula
  (controlled by NMT and TMN) which says the strength is given by the
  energy divided by a linear function of the tonality.
  */

  /*
  s3() is the "spreading function".  It is given by a formula
  determined via listening tests.
  The total masking in the j'th partition band is the sum over
  all maskings i.  It is thus given by the convolution of
  the strength with s3(), the "spreading function."
  masking(j) = sum_over_i  s3(i-j)*strength(i)  = s3 o strength
  where "o" = convolution operator.  s3 is given by a formula determined
  via listening tests.  It is normalized so that s3 o 1 = 1.
  Note: instead of a simple convolution, LAME also has the
  option of using "additive masking"
  The most critical part is step 2, computing the tonality of each
  partition band.  LAME has two tonality estimators.  The first
  is based on the ISO spec, and measures how predictiable the
  signal is over time.  The more predictable, the more tonal.
  The second measure is based on looking at the spectrum of
  a single granule.  The more peaky the spectrum, the more
  tonal.  By most indications, the latter approach is better.
  Finally, in step 5, the maskings for the mid and side
  channel are possibly increased.  Under certain circumstances,
  noise in the mid & side channels is assumed to also
  be masked by strong maskers in the L or R channels.
  Other data computed by the psy-model:
  ms_ratio        side-channel / mid-channel masking ratio (for previous granule)
  ms_ratio_next   side-channel / mid-channel masking ratio for this granule
  percep_entropy[2]     L and R values (prev granule) of PE - A measure of how
  much pre-echo is in the previous granule
  percep_entropy_MS[2]  mid and side channel values (prev granule) of percep_entropy
  energy[4]             L,R,M,S energy in each channel, prev granule
  blocktype_d[2]        block type to use for previous granule
  */
  //package mp3;
  //import java.util.Arrays;
  var $3YDN3 = parcelRequire("3YDN3");
  $3YDN3.System;
  var $97f850779472263e$var$VbrMode = $3YDN3.VbrMode;
  var $97f850779472263e$var$Float = $3YDN3.Float;
  var $97f850779472263e$var$ShortBlock = $3YDN3.ShortBlock;
  var $97f850779472263e$var$Util = $3YDN3.Util;
  var $97f850779472263e$var$Arrays = $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $97f850779472263e$var$new_float = $3YDN3.new_float;
  var $97f850779472263e$var$new_float_n = $3YDN3.new_float_n;
  var $97f850779472263e$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  var $97f850779472263e$var$assert = $3YDN3.assert;
  var $2g11P = parcelRequire("2g11P");
  var $cPNKB = parcelRequire("cPNKB");

  function $97f850779472263e$var$PsyModel() {
    var MPEGMode = parcelRequire("jL6I1");
    var fft = new $2g11P();
    var LOG10 = 2.30258509299404568402;
    var rpelev = 2;
    var rpelev2 = 16;
    var rpelev_s = 2;
    var rpelev2_s = 16;
    /* size of each partition band, in barks: */

    var DELBARK = .34;
    /* tuned for output level (sensitive to energy scale) */

    var VO_SCALE = 1. / 217621504 / ($cPNKB.BLKSIZE / 2);
    var temporalmask_sustain_sec = 0.01;
    var NS_PREECHO_ATT0 = 0.8;
    var NS_PREECHO_ATT1 = 0.6;
    var NS_PREECHO_ATT2 = 0.3;
    var NS_MSFIX = 3.5;
    var NSFIRLEN = 21;
    /* size of each partition band, in barks: */

    var LN_TO_LOG10 = 0.2302585093;

    function NON_LINEAR_SCALE_ENERGY(x) {
      return x;
    }
    /**
    * <PRE>
    *       L3psycho_anal.  Compute psycho acoustics.
    *
    *       Data returned to the calling program must be delayed by one
    *       granule.
    *
    *       This is done in two places.
    *       If we do not need to know the blocktype, the copying
    *       can be done here at the top of the program: we copy the data for
    *       the last granule (computed during the last call) before it is
    *       overwritten with the new data.  It looks like this:
    *
    *       0. static psymodel_data
    *       1. calling_program_data = psymodel_data
    *       2. compute psymodel_data
    *
    *       For data which needs to know the blocktype, the copying must be
    *       done at the end of this loop, and the old values must be saved:
    *
    *       0. static psymodel_data_old
    *       1. compute psymodel_data
    *       2. compute possible block type of this granule
    *       3. compute final block type of previous granule based on #2.
    *       4. calling_program_data = psymodel_data_old
    *       5. psymodel_data_old = psymodel_data
    *     psycho_loudness_approx
    *       jd - 2001 mar 12
    *    in:  energy   - BLKSIZE/2 elements of frequency magnitudes ^ 2
    *         gfp      - uses out_samplerate, ATHtype (also needed for ATHformula)
    *    returns: loudness^2 approximation, a positive value roughly tuned for a value
    *             of 1.0 for signals near clipping.
    *    notes:   When calibrated, feeding this function binary white noise at sample
    *             values +32767 or -32768 should return values that approach 3.
    *             ATHformula is used to approximate an equal loudness curve.
    *    future:  Data indicates that the shape of the equal loudness curve varies
    *             with intensity.  This function might be improved by using an equal
    *             loudness curve shaped for typical playback levels (instead of the
    *             ATH, that is shaped for the threshold).  A flexible realization might
    *             simply bend the existing ATH curve to achieve the desired shape.
    *             However, the potential gain may not be enough to justify an effort.
    * </PRE>
    */


    function psycho_loudness_approx(energy, gfc) {
      var loudness_power = 0.0;
      /* apply weights to power in freq. bands */

      for (var i = 0; i < $cPNKB.BLKSIZE / 2; ++i) loudness_power += energy[i] * gfc.ATH.eql_w[i];

      loudness_power *= VO_SCALE;
      return loudness_power;
    }

    function compute_ffts(gfp, fftenergy, fftenergy_s, wsamp_l, wsamp_lPos, wsamp_s, wsamp_sPos, gr_out, chn, buffer, bufPos) {
      var gfc = gfp.internal_flags;

      if (chn < 2) {
        fft.fft_long(gfc, wsamp_l[wsamp_lPos], chn, buffer, bufPos);
        fft.fft_short(gfc, wsamp_s[wsamp_sPos], chn, buffer, bufPos);
      } else if (chn == 2) {
        for (var j = $cPNKB.BLKSIZE - 1; j >= 0; --j) {
          var l = wsamp_l[wsamp_lPos + 0][j];
          var r = wsamp_l[wsamp_lPos + 1][j];
          wsamp_l[wsamp_lPos + 0][j] = (l + r) * $97f850779472263e$var$Util.SQRT2 * 0.5;
          wsamp_l[wsamp_lPos + 1][j] = (l - r) * $97f850779472263e$var$Util.SQRT2 * 0.5;
        }

        for (var b = 2; b >= 0; --b) for (var j = $cPNKB.BLKSIZE_s - 1; j >= 0; --j) {
          var l = wsamp_s[wsamp_sPos + 0][b][j];
          var r = wsamp_s[wsamp_sPos + 1][b][j];
          wsamp_s[wsamp_sPos + 0][b][j] = (l + r) * $97f850779472263e$var$Util.SQRT2 * 0.5;
          wsamp_s[wsamp_sPos + 1][b][j] = (l - r) * $97f850779472263e$var$Util.SQRT2 * 0.5;
        }
      }
      /*********************************************************************
      * compute energies
      *********************************************************************/


      fftenergy[0] = NON_LINEAR_SCALE_ENERGY(wsamp_l[wsamp_lPos + 0][0]);
      fftenergy[0] *= fftenergy[0];

      for (var j = $cPNKB.BLKSIZE / 2 - 1; j >= 0; --j) {
        var re = wsamp_l[wsamp_lPos + 0][$cPNKB.BLKSIZE / 2 - j];
        var im = wsamp_l[wsamp_lPos + 0][$cPNKB.BLKSIZE / 2 + j];
        fftenergy[$cPNKB.BLKSIZE / 2 - j] = NON_LINEAR_SCALE_ENERGY((re * re + im * im) * 0.5);
      }

      for (var b = 2; b >= 0; --b) {
        fftenergy_s[b][0] = wsamp_s[wsamp_sPos + 0][b][0];
        fftenergy_s[b][0] *= fftenergy_s[b][0];

        for (var j = $cPNKB.BLKSIZE_s / 2 - 1; j >= 0; --j) {
          var re = wsamp_s[wsamp_sPos + 0][b][$cPNKB.BLKSIZE_s / 2 - j];
          var im = wsamp_s[wsamp_sPos + 0][b][$cPNKB.BLKSIZE_s / 2 + j];
          fftenergy_s[b][$cPNKB.BLKSIZE_s / 2 - j] = NON_LINEAR_SCALE_ENERGY((re * re + im * im) * 0.5);
        }
      }

      var totalenergy = 0.0;

      for (var j = 11; j < $cPNKB.HBLKSIZE; j++) totalenergy += fftenergy[j];

      gfc.tot_ener[chn] = totalenergy;

      if (gfp.analysis) {
        for (var j = 0; j < $cPNKB.HBLKSIZE; j++) {
          gfc.pinfo.energy[gr_out][chn][j] = gfc.pinfo.energy_save[chn][j];
          gfc.pinfo.energy_save[chn][j] = fftenergy[j];
        }

        gfc.pinfo.pe[gr_out][chn] = gfc.pe[chn];
      }
      /*********************************************************************
      * compute loudness approximation (used for ATH auto-level adjustment)
      *********************************************************************/


      if (gfp.athaa_loudapprox == 2 && chn < 2) {
        // no loudness for mid/side ch
        gfc.loudness_sq[gr_out][chn] = gfc.loudness_sq_save[chn];
        gfc.loudness_sq_save[chn] = psycho_loudness_approx(fftenergy, gfc);
      }
    }
    /* mask_add optimization */

    /* init the limit values used to avoid computing log in mask_add when it is not necessary */

    /**
    * <PRE>
    *  For example, with i = 10*log10(m2/m1)/10*16         (= log10(m2/m1)*16)
    *
    * abs(i)>8 is equivalent (as i is an integer) to
    * abs(i)>=9
    * i>=9 || i<=-9
    * equivalent to (as i is the biggest integer smaller than log10(m2/m1)*16
    * or the smallest integer bigger than log10(m2/m1)*16 depending on the sign of log10(m2/m1)*16)
    * log10(m2/m1)>=9/16 || log10(m2/m1)<=-9/16
    * exp10 is strictly increasing thus this is equivalent to
    * m2/m1 >= 10^(9/16) || m2/m1<=10^(-9/16) which are comparisons to constants
    * </PRE>
    */

    /**
    * as in if(i>8)
    */


    var I1LIMIT = 8;
    /**
    * as in if(i>24) . changed 23
    */

    var I2LIMIT = 23;
    /**
    * as in if(m<15)
    */

    var MLIMIT = 15;
    var ma_max_i1;
    var ma_max_i2;
    var ma_max_m;
    /**
    * This is the masking table:<BR>
    * According to tonality, values are going from 0dB (TMN) to 9.3dB (NMT).<BR>
    * After additive masking computation, 8dB are added, so final values are
    * going from 8dB to 17.3dB
    *
    * pow(10, -0.0..-0.6)
    */

    var tab = [1.0, 0.79433, 0.63096, 0.63096, 0.63096, 0.63096, 0.63096, 0.25119, 0.11749];

    function init_mask_add_max_values() {
      ma_max_i1 = Math.pow(10, (I1LIMIT + 1) / 16.0);
      ma_max_i2 = Math.pow(10, (I2LIMIT + 1) / 16.0);
      ma_max_m = Math.pow(10, MLIMIT / 10.0);
    }

    var table1 = [3.3246 * 3.3246, 3.23837 * 3.23837, 9.9500500969, 9.0247369744, 8.1854926609, 7.0440875649, 2.46209 * 2.46209, 2.284 * 2.284, 4.4892710641, 1.96552 * 1.96552, 1.82335 * 1.82335, 1.69146 * 1.69146, 2.4621061921, 2.1508568964, 1.37074 * 1.37074, 1.31036 * 1.31036, 1.5691069696, 1.4555939904, 1.16203 * 1.16203, 1.2715945225, 1.09428 * 1.09428, 1.0659 * 1.0659, 1.0779838276, 1.0382591025, 1];
    var table2 = [1.7782755904, 1.35879 * 1.35879, 1.38454 * 1.38454, 1.39497 * 1.39497, 1.40548 * 1.40548, 1.3537 * 1.3537, 1.6999465924, 1.22321 * 1.22321, 1.3169398564, 1];
    var table3 = [5.5396212496, 2.29259 * 2.29259, 4.9868695969, 2.12675 * 2.12675, 2.02545 * 2.02545, 1.87894 * 1.87894, 1.74303 * 1.74303, 1.61695 * 1.61695, 2.2499700001, 1.39148 * 1.39148, 1.29083 * 1.29083, 1.19746 * 1.19746, 1.2339655056, 1.0779838276];
    /**
    * addition of simultaneous masking Naoki Shibata 2000/7
    */

    function mask_add(m1, m2, kk, b, gfc, shortblock) {
      var ratio;

      if (m2 > m1) {
        if (m2 < m1 * ma_max_i2) ratio = m2 / m1;else return m1 + m2;
      } else {
        if (m1 >= m2 * ma_max_i2) return m1 + m2;
        ratio = m1 / m2;
      }
      /* Should always be true, just checking */


      $97f850779472263e$var$assert(m1 >= 0);
      $97f850779472263e$var$assert(m2 >= 0);
      m1 += m2; //if (((long)(b + 3) & 0xffffffff) <= 3 + 3) {

      if (b + 3 <= 6) {
        /* approximately, 1 bark = 3 partitions */

        /* 65% of the cases */

        /* originally 'if(i > 8)' */
        if (ratio >= ma_max_i1)
          /* 43% of the total */
          return m1;
        /* 22% of the total */

        var i = 0 | $97f850779472263e$var$Util.FAST_LOG10_X(ratio, 16.0);
        return m1 * table2[i];
      }
      /**
      * <PRE>
      * m<15 equ log10((m1+m2)/gfc.ATH.cb[k])<1.5
      * equ (m1+m2)/gfc.ATH.cb[k]<10^1.5
      * equ (m1+m2)<10^1.5 * gfc.ATH.cb[k]
      * </PRE>
      */


      var i = 0 | $97f850779472263e$var$Util.FAST_LOG10_X(ratio, 16.0);
      if (shortblock != 0) m2 = gfc.ATH.cb_s[kk] * gfc.ATH.adjust;else m2 = gfc.ATH.cb_l[kk] * gfc.ATH.adjust;
      $97f850779472263e$var$assert(m2 >= 0);

      if (m1 < ma_max_m * m2) {
        /* 3% of the total */

        /* Originally if (m > 0) { */
        if (m1 > m2) {
          var f, r;
          f = 1.0;
          if (i <= 13) f = table3[i];
          r = $97f850779472263e$var$Util.FAST_LOG10_X(m1 / m2, 10.0 / 15.0);
          return m1 * ((table1[i] - f) * r + f);
        }

        if (i > 13) return m1;
        return m1 * table3[i];
      }
      /* 10% of total */


      return m1 * table1[i];
    }

    var table2_ = [1.7782755904, 1.35879 * 1.35879, 1.38454 * 1.38454, 1.39497 * 1.39497, 1.40548 * 1.40548, 1.3537 * 1.3537, 1.6999465924, 1.22321 * 1.22321, 1.3169398564, 1];
    /**
    * addition of simultaneous masking Naoki Shibata 2000/7
    */

    function vbrpsy_mask_add(m1, m2, b) {
      var ratio;
      if (m1 < 0) m1 = 0;
      if (m2 < 0) m2 = 0;
      if (m1 <= 0) return m2;
      if (m2 <= 0) return m1;
      if (m2 > m1) ratio = m2 / m1;else ratio = m1 / m2;

      if (-2 <= b && b <= 2) {
        /* approximately, 1 bark = 3 partitions */

        /* originally 'if(i > 8)' */
        if (ratio >= ma_max_i1) return m1 + m2;else {
          var i = 0 | $97f850779472263e$var$Util.FAST_LOG10_X(ratio, 16.0);
          return (m1 + m2) * table2_[i];
        }
      }

      if (ratio < ma_max_i2) return m1 + m2;
      if (m1 < m2) m1 = m2;
      return m1;
    }
    /**
    * compute interchannel masking effects
    */


    function calc_interchannel_masking(gfp, ratio) {
      var gfc = gfp.internal_flags;

      if (gfc.channels_out > 1) {
        for (var sb = 0; sb < $cPNKB.SBMAX_l; sb++) {
          var l = gfc.thm[0].l[sb];
          var r = gfc.thm[1].l[sb];
          gfc.thm[0].l[sb] += r * ratio;
          gfc.thm[1].l[sb] += l * ratio;
        }

        for (var sb = 0; sb < $cPNKB.SBMAX_s; sb++) for (var sblock = 0; sblock < 3; sblock++) {
          var l = gfc.thm[0].s[sb][sblock];
          var r = gfc.thm[1].s[sb][sblock];
          gfc.thm[0].s[sb][sblock] += r * ratio;
          gfc.thm[1].s[sb][sblock] += l * ratio;
        }
      }
    }
    /**
    * compute M/S thresholds from Johnston & Ferreira 1992 ICASSP paper
    */


    function msfix1(gfc) {
      for (var sb = 0; sb < $cPNKB.SBMAX_l; sb++) {
        /* use this fix if L & R masking differs by 2db or less */

        /* if db = 10*log10(x2/x1) < 2 */

        /* if (x2 < 1.58*x1) { */
        if (gfc.thm[0].l[sb] > 1.58 * gfc.thm[1].l[sb] || gfc.thm[1].l[sb] > 1.58 * gfc.thm[0].l[sb]) continue;
        var mld = gfc.mld_l[sb] * gfc.en[3].l[sb];
        var rmid = Math.max(gfc.thm[2].l[sb], Math.min(gfc.thm[3].l[sb], mld));
        mld = gfc.mld_l[sb] * gfc.en[2].l[sb];
        var rside = Math.max(gfc.thm[3].l[sb], Math.min(gfc.thm[2].l[sb], mld));
        gfc.thm[2].l[sb] = rmid;
        gfc.thm[3].l[sb] = rside;
      }

      for (var sb = 0; sb < $cPNKB.SBMAX_s; sb++) for (var sblock = 0; sblock < 3; sblock++) {
        if (gfc.thm[0].s[sb][sblock] > 1.58 * gfc.thm[1].s[sb][sblock] || gfc.thm[1].s[sb][sblock] > 1.58 * gfc.thm[0].s[sb][sblock]) continue;
        var mld = gfc.mld_s[sb] * gfc.en[3].s[sb][sblock];
        var rmid = Math.max(gfc.thm[2].s[sb][sblock], Math.min(gfc.thm[3].s[sb][sblock], mld));
        mld = gfc.mld_s[sb] * gfc.en[2].s[sb][sblock];
        var rside = Math.max(gfc.thm[3].s[sb][sblock], Math.min(gfc.thm[2].s[sb][sblock], mld));
        gfc.thm[2].s[sb][sblock] = rmid;
        gfc.thm[3].s[sb][sblock] = rside;
      }
    }
    /**
    * Adjust M/S maskings if user set "msfix"
    *
    * Naoki Shibata 2000
    */


    function ns_msfix(gfc, msfix, athadjust) {
      var msfix2 = msfix;
      var athlower = Math.pow(10, athadjust);
      msfix *= 2.0;
      msfix2 *= 2.0;

      for (var sb = 0; sb < $cPNKB.SBMAX_l; sb++) {
        var thmLR, thmM, thmS, ath;
        ath = gfc.ATH.cb_l[gfc.bm_l[sb]] * athlower;
        thmLR = Math.min(Math.max(gfc.thm[0].l[sb], ath), Math.max(gfc.thm[1].l[sb], ath));
        thmM = Math.max(gfc.thm[2].l[sb], ath);
        thmS = Math.max(gfc.thm[3].l[sb], ath);

        if (thmLR * msfix < thmM + thmS) {
          var f = thmLR * msfix2 / (thmM + thmS);
          thmM *= f;
          thmS *= f;
          $97f850779472263e$var$assert(thmM + thmS > 0);
        }

        gfc.thm[2].l[sb] = Math.min(thmM, gfc.thm[2].l[sb]);
        gfc.thm[3].l[sb] = Math.min(thmS, gfc.thm[3].l[sb]);
      }

      athlower *= $cPNKB.BLKSIZE_s / $cPNKB.BLKSIZE;

      for (var sb = 0; sb < $cPNKB.SBMAX_s; sb++) for (var sblock = 0; sblock < 3; sblock++) {
        var thmLR, thmM, thmS, ath;
        ath = gfc.ATH.cb_s[gfc.bm_s[sb]] * athlower;
        thmLR = Math.min(Math.max(gfc.thm[0].s[sb][sblock], ath), Math.max(gfc.thm[1].s[sb][sblock], ath));
        thmM = Math.max(gfc.thm[2].s[sb][sblock], ath);
        thmS = Math.max(gfc.thm[3].s[sb][sblock], ath);

        if (thmLR * msfix < thmM + thmS) {
          var f = thmLR * msfix / (thmM + thmS);
          thmM *= f;
          thmS *= f;
          $97f850779472263e$var$assert(thmM + thmS > 0);
        }

        gfc.thm[2].s[sb][sblock] = Math.min(gfc.thm[2].s[sb][sblock], thmM);
        gfc.thm[3].s[sb][sblock] = Math.min(gfc.thm[3].s[sb][sblock], thmS);
      }
    }
    /**
    * short block threshold calculation (part 2)
    *
    * partition band bo_s[sfb] is at the transition from scalefactor band sfb
    * to the next one sfb+1; enn and thmm have to be split between them
    */


    function convert_partition2scalefac_s(gfc, eb, thr, chn, sblock) {
      var sb, b;
      var enn = 0.0;
      var thmm = 0.0;

      for (sb = b = 0; sb < $cPNKB.SBMAX_s; ++b, ++sb) {
        var bo_s_sb = gfc.bo_s[sb];
        var npart_s = gfc.npart_s;
        var b_lim = bo_s_sb < npart_s ? bo_s_sb : npart_s;

        while (b < b_lim) {
          $97f850779472263e$var$assert(eb[b] >= 0); // iff failed, it may indicate some index error elsewhere

          $97f850779472263e$var$assert(thr[b] >= 0);
          enn += eb[b];
          thmm += thr[b];
          b++;
        }

        gfc.en[chn].s[sb][sblock] = enn;
        gfc.thm[chn].s[sb][sblock] = thmm;

        if (b >= npart_s) {
          ++sb;
          break;
        }

        $97f850779472263e$var$assert(eb[b] >= 0); // iff failed, it may indicate some index error elsewhere

        $97f850779472263e$var$assert(thr[b] >= 0);
        /* at transition sfb . sfb+1 */

        var w_curr = gfc.PSY.bo_s_weight[sb];
        var w_next = 1.0 - w_curr;
        enn = w_curr * eb[b];
        thmm = w_curr * thr[b];
        gfc.en[chn].s[sb][sblock] += enn;
        gfc.thm[chn].s[sb][sblock] += thmm;
        enn = w_next * eb[b];
        thmm = w_next * thr[b];
      }
      /* zero initialize the rest */


      for (; sb < $cPNKB.SBMAX_s; ++sb) {
        gfc.en[chn].s[sb][sblock] = 0;
        gfc.thm[chn].s[sb][sblock] = 0;
      }
    }
    /**
    * longblock threshold calculation (part 2)
    */


    function convert_partition2scalefac_l(gfc, eb, thr, chn) {
      var sb, b;
      var enn = 0.0;
      var thmm = 0.0;

      for (sb = b = 0; sb < $cPNKB.SBMAX_l; ++b, ++sb) {
        var bo_l_sb = gfc.bo_l[sb];
        var npart_l = gfc.npart_l;
        var b_lim = bo_l_sb < npart_l ? bo_l_sb : npart_l;

        while (b < b_lim) {
          $97f850779472263e$var$assert(eb[b] >= 0); // iff failed, it may indicate some index error elsewhere

          $97f850779472263e$var$assert(thr[b] >= 0);
          enn += eb[b];
          thmm += thr[b];
          b++;
        }

        gfc.en[chn].l[sb] = enn;
        gfc.thm[chn].l[sb] = thmm;

        if (b >= npart_l) {
          ++sb;
          break;
        }

        $97f850779472263e$var$assert(eb[b] >= 0);
        $97f850779472263e$var$assert(thr[b] >= 0);
        /* at transition sfb . sfb+1 */

        var w_curr = gfc.PSY.bo_l_weight[sb];
        var w_next = 1.0 - w_curr;
        enn = w_curr * eb[b];
        thmm = w_curr * thr[b];
        gfc.en[chn].l[sb] += enn;
        gfc.thm[chn].l[sb] += thmm;
        enn = w_next * eb[b];
        thmm = w_next * thr[b];
      }
      /* zero initialize the rest */


      for (; sb < $cPNKB.SBMAX_l; ++sb) {
        gfc.en[chn].l[sb] = 0;
        gfc.thm[chn].l[sb] = 0;
      }
    }

    function compute_masking_s(gfp, fftenergy_s, eb, thr, chn, sblock) {
      var gfc = gfp.internal_flags;
      var j, b;

      for (b = j = 0; b < gfc.npart_s; ++b) {
        var ebb = 0;
        var n = gfc.numlines_s[b];

        for (var i = 0; i < n; ++i, ++j) {
          var el = fftenergy_s[sblock][j];
          ebb += el;
        }

        eb[b] = ebb;
      }

      $97f850779472263e$var$assert(b == gfc.npart_s);
      $97f850779472263e$var$assert(j == 129);

      for (j = b = 0; b < gfc.npart_s; b++) {
        var kk = gfc.s3ind_s[b][0];
        var ecb = gfc.s3_ss[j++] * eb[kk];
        ++kk;

        while (kk <= gfc.s3ind_s[b][1]) {
          ecb += gfc.s3_ss[j] * eb[kk];
          ++j;
          ++kk;
        }

        var x = rpelev_s * gfc.nb_s1[chn][b];
        thr[b] = Math.min(ecb, x);

        if (gfc.blocktype_old[chn & 1] == $cPNKB.SHORT_TYPE) {
          /* limit calculated threshold by even older granule */
          var x = rpelev2_s * gfc.nb_s2[chn][b];
          var y = thr[b];
          thr[b] = Math.min(x, y);
        }

        gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];
        gfc.nb_s1[chn][b] = ecb;
        $97f850779472263e$var$assert(thr[b] >= 0);
      }

      for (; b <= $cPNKB.CBANDS; ++b) {
        eb[b] = 0;
        thr[b] = 0;
      }
    }

    function block_type_set(gfp, uselongblock, blocktype_d, blocktype) {
      var gfc = gfp.internal_flags;
      if (gfp.short_blocks == $97f850779472263e$var$ShortBlock.short_block_coupled && !(uselongblock[0] != 0 && uselongblock[1] != 0)) uselongblock[0] = uselongblock[1] = 0;
      /*
      * update the blocktype of the previous granule, since it depends on
      * what happend in this granule
      */

      for (var chn = 0; chn < gfc.channels_out; chn++) {
        blocktype[chn] = $cPNKB.NORM_TYPE;
        /* disable short blocks */

        if (gfp.short_blocks == $97f850779472263e$var$ShortBlock.short_block_dispensed) uselongblock[chn] = 1;
        if (gfp.short_blocks == $97f850779472263e$var$ShortBlock.short_block_forced) uselongblock[chn] = 0;

        if (uselongblock[chn] != 0) {
          /* no attack : use long blocks */
          $97f850779472263e$var$assert(gfc.blocktype_old[chn] != $cPNKB.START_TYPE);
          if (gfc.blocktype_old[chn] == $cPNKB.SHORT_TYPE) blocktype[chn] = $cPNKB.STOP_TYPE;
        } else {
          /* attack : use short blocks */
          blocktype[chn] = $cPNKB.SHORT_TYPE;
          if (gfc.blocktype_old[chn] == $cPNKB.NORM_TYPE) gfc.blocktype_old[chn] = $cPNKB.START_TYPE;
          if (gfc.blocktype_old[chn] == $cPNKB.STOP_TYPE) gfc.blocktype_old[chn] = $cPNKB.SHORT_TYPE;
        }

        blocktype_d[chn] = gfc.blocktype_old[chn]; // value returned to calling program

        gfc.blocktype_old[chn] = blocktype[chn]; // save for next call to l3psy_anal
      }
    }

    function NS_INTERP(x, y, r) {
      /* was pow((x),(r))*pow((y),1-(r)) */
      if (r >= 1.0)
        /* 99.7% of the time */
        return x;
      if (r <= 0.0) return y;
      if (y > 0.0)
        /* rest of the time */
        return Math.pow(x / y, r) * y;
      /* never happens */

      return 0.0;
    }
    /**
    * these values are tuned only for 44.1kHz...
    */


    var regcoef_s = [11.8, 13.6, 17.2, 32, 46.5, 51.3, 57.5, 67.1, 71.5, 84.6, 97.6, 130];

    function pecalc_s(mr, masking_lower) {
      var pe_s = 309.07;

      for (var sb = 0; sb < $cPNKB.SBMAX_s - 1; sb++) for (var sblock = 0; sblock < 3; sblock++) {
        var thm = mr.thm.s[sb][sblock];
        $97f850779472263e$var$assert(sb < regcoef_s.length);

        if (thm > 0.0) {
          var x = thm * masking_lower;
          var en = mr.en.s[sb][sblock];

          if (en > x) {
            if (en > x * 1e10) pe_s += regcoef_s[sb] * (10.0 * LOG10);else {
              $97f850779472263e$var$assert(x > 0);
              pe_s += regcoef_s[sb] * $97f850779472263e$var$Util.FAST_LOG10(en / x);
            }
          }
        }
      }

      return pe_s;
    }
    /**
    * these values are tuned only for 44.1kHz...
    */


    var regcoef_l = [6.8, 5.8, 5.8, 6.4, 6.5, 9.9, 12.1, 14.4, 15, 18.9, 21.6, 26.9, 34.2, 40.2, 46.8, 56.5, 60.7, 73.9, 85.7, 93.4, 126.1];

    function pecalc_l(mr, masking_lower) {
      var pe_l = 281.0575;

      for (var sb = 0; sb < $cPNKB.SBMAX_l - 1; sb++) {
        var thm = mr.thm.l[sb];
        $97f850779472263e$var$assert(sb < regcoef_l.length);

        if (thm > 0.0) {
          var x = thm * masking_lower;
          var en = mr.en.l[sb];

          if (en > x) {
            if (en > x * 1e10) pe_l += regcoef_l[sb] * (10.0 * LOG10);else {
              $97f850779472263e$var$assert(x > 0);
              pe_l += regcoef_l[sb] * $97f850779472263e$var$Util.FAST_LOG10(en / x);
            }
          }
        }
      }

      return pe_l;
    }

    function calc_energy(gfc, fftenergy, eb, max, avg) {
      var b, j;

      for (b = j = 0; b < gfc.npart_l; ++b) {
        var ebb = 0,
            m = 0;
        var i;

        for (i = 0; i < gfc.numlines_l[b]; ++i, ++j) {
          var el = fftenergy[j];
          $97f850779472263e$var$assert(el >= 0);
          ebb += el;
          if (m < el) m = el;
        }

        eb[b] = ebb;
        max[b] = m;
        avg[b] = ebb * gfc.rnumlines_l[b];
        $97f850779472263e$var$assert(gfc.rnumlines_l[b] >= 0);
        $97f850779472263e$var$assert(ebb >= 0);
        $97f850779472263e$var$assert(eb[b] >= 0);
        $97f850779472263e$var$assert(max[b] >= 0);
        $97f850779472263e$var$assert(avg[b] >= 0);
      }
    }

    function calc_mask_index_l(gfc, max, avg, mask_idx) {
      var last_tab_entry = tab.length - 1;
      var b = 0;
      var a = avg[b] + avg[b + 1];
      $97f850779472263e$var$assert(a >= 0);

      if (a > 0.0) {
        var m = max[b];
        if (m < max[b + 1]) m = max[b + 1];
        $97f850779472263e$var$assert(gfc.numlines_l[b] + gfc.numlines_l[b + 1] - 1 > 0);
        a = 20.0 * (m * 2.0 - a) / (a * (gfc.numlines_l[b] + gfc.numlines_l[b + 1] - 1));
        var k = 0 | a;
        if (k > last_tab_entry) k = last_tab_entry;
        mask_idx[b] = k;
      } else mask_idx[b] = 0;

      for (b = 1; b < gfc.npart_l - 1; b++) {
        a = avg[b - 1] + avg[b] + avg[b + 1];
        $97f850779472263e$var$assert(a >= 0);

        if (a > 0.0) {
          var m = max[b - 1];
          if (m < max[b]) m = max[b];
          if (m < max[b + 1]) m = max[b + 1];
          $97f850779472263e$var$assert(gfc.numlines_l[b - 1] + gfc.numlines_l[b] + gfc.numlines_l[b + 1] - 1 > 0);
          a = 20.0 * (m * 3.0 - a) / (a * (gfc.numlines_l[b - 1] + gfc.numlines_l[b] + gfc.numlines_l[b + 1] - 1));
          var k = 0 | a;
          if (k > last_tab_entry) k = last_tab_entry;
          mask_idx[b] = k;
        } else mask_idx[b] = 0;
      }

      $97f850779472263e$var$assert(b > 0);
      $97f850779472263e$var$assert(b == gfc.npart_l - 1);
      a = avg[b - 1] + avg[b];
      $97f850779472263e$var$assert(a >= 0);

      if (a > 0.0) {
        var m = max[b - 1];
        if (m < max[b]) m = max[b];
        $97f850779472263e$var$assert(gfc.numlines_l[b - 1] + gfc.numlines_l[b] - 1 > 0);
        a = 20.0 * (m * 2.0 - a) / (a * (gfc.numlines_l[b - 1] + gfc.numlines_l[b] - 1));
        var k = 0 | a;
        if (k > last_tab_entry) k = last_tab_entry;
        mask_idx[b] = k;
      } else mask_idx[b] = 0;

      $97f850779472263e$var$assert(b == gfc.npart_l - 1);
    }

    var fircoef = [-0.00000000000000000865163 * 2, -0.01703172, -0.00000000000000000674764 * 2, 0.0418072, -0.0000000000000000336639 * 2, -0.0876324, -0.0000000000000000154175 * 2, 0.1863476, -0.0000000000000000552212 * 2, -0.627638];

    this.L3psycho_anal_ns = function (gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, percep_entropy, percep_MS_entropy, energy, blocktype_d) {
      /*
      * to get a good cache performance, one has to think about the sequence,
      * in which the variables are used.
      */
      var gfc = gfp.internal_flags;
      /* fft and energy calculation */

      var wsamp_L = $97f850779472263e$var$new_float_n([2, $cPNKB.BLKSIZE]);
      var wsamp_S = $97f850779472263e$var$new_float_n([2, 3, $cPNKB.BLKSIZE_s]);
      /* convolution */

      var eb_l = $97f850779472263e$var$new_float($cPNKB.CBANDS + 1);
      var eb_s = $97f850779472263e$var$new_float($cPNKB.CBANDS + 1);
      var thr = $97f850779472263e$var$new_float($cPNKB.CBANDS + 2);
      /* block type */

      var blocktype = $97f850779472263e$var$new_int(2),
          uselongblock = $97f850779472263e$var$new_int(2);
      /* usual variables like loop indices, etc.. */

      var numchn, chn;
      var b, i, j, k;
      var sb, sblock;
      /* variables used for --nspsytune */

      var ns_hpfsmpl = $97f850779472263e$var$new_float_n([2, 576]);
      var pcfact;
      var mask_idx_l = $97f850779472263e$var$new_int($cPNKB.CBANDS + 2),
          mask_idx_s = $97f850779472263e$var$new_int($cPNKB.CBANDS + 2);
      $97f850779472263e$var$Arrays.fill(mask_idx_s, 0);
      numchn = gfc.channels_out;
      /* chn=2 and 3 = Mid and Side channels */

      if (gfp.mode == MPEGMode.JOINT_STEREO) numchn = 4;
      if (gfp.VBR == $97f850779472263e$var$VbrMode.vbr_off) pcfact = gfc.ResvMax == 0 ? 0 : gfc.ResvSize / gfc.ResvMax * 0.5;else if (gfp.VBR == $97f850779472263e$var$VbrMode.vbr_rh || gfp.VBR == $97f850779472263e$var$VbrMode.vbr_mtrh || gfp.VBR == $97f850779472263e$var$VbrMode.vbr_mt) pcfact = 0.6;else pcfact = 1.0;
      /**********************************************************************
      * Apply HPF of fs/4 to the input signal. This is used for attack
      * detection / handling.
      **********************************************************************/

      /* Don't copy the input buffer into a temporary buffer */

      /* unroll the loop 2 times */

      for (chn = 0; chn < gfc.channels_out; chn++) {
        /* apply high pass filter of fs/4 */
        var firbuf1 = buffer[chn];
        var firbufPos = bufPos + 576 - 350 - NSFIRLEN + 192;
        $97f850779472263e$var$assert(fircoef.length == (NSFIRLEN - 1) / 2);

        for (i = 0; i < 576; i++) {
          var sum1, sum2;
          sum1 = firbuf1[firbufPos + i + 10];
          sum2 = 0.0;

          for (j = 0; j < (NSFIRLEN - 1) / 2 - 1; j += 2) {
            sum1 += fircoef[j] * (firbuf1[firbufPos + i + j] + firbuf1[firbufPos + i + NSFIRLEN - j]);
            sum2 += fircoef[j + 1] * (firbuf1[firbufPos + i + j + 1] + firbuf1[firbufPos + i + NSFIRLEN - j - 1]);
          }

          ns_hpfsmpl[chn][i] = sum1 + sum2;
        }

        masking_ratio[gr_out][chn].en.assign(gfc.en[chn]);
        masking_ratio[gr_out][chn].thm.assign(gfc.thm[chn]);

        if (numchn > 2) {
          /* MS maskings */

          /* percep_MS_entropy [chn-2] = gfc . pe [chn]; */
          masking_MS_ratio[gr_out][chn].en.assign(gfc.en[chn + 2]);
          masking_MS_ratio[gr_out][chn].thm.assign(gfc.thm[chn + 2]);
        }
      }

      for (chn = 0; chn < numchn; chn++) {
        var wsamp_l;
        var wsamp_s;
        var en_subshort = $97f850779472263e$var$new_float(12);
        var en_short = [0, 0, 0, 0];
        var attack_intensity = $97f850779472263e$var$new_float(12);
        var ns_uselongblock = 1;
        var attackThreshold;
        var max = $97f850779472263e$var$new_float($cPNKB.CBANDS),
            avg = $97f850779472263e$var$new_float($cPNKB.CBANDS);
        var ns_attacks = [0, 0, 0, 0];
        var fftenergy = $97f850779472263e$var$new_float($cPNKB.HBLKSIZE);
        var fftenergy_s = $97f850779472263e$var$new_float_n([3, $cPNKB.HBLKSIZE_s]);
        /*
        * rh 20040301: the following loops do access one off the limits so
        * I increase the array dimensions by one and initialize the
        * accessed values to zero
        */

        $97f850779472263e$var$assert(gfc.npart_s <= $cPNKB.CBANDS);
        $97f850779472263e$var$assert(gfc.npart_l <= $cPNKB.CBANDS);
        /***************************************************************
        * determine the block type (window type)
        ***************************************************************/

        /* calculate energies of each sub-shortblocks */

        for (i = 0; i < 3; i++) {
          en_subshort[i] = gfc.nsPsy.last_en_subshort[chn][i + 6];
          $97f850779472263e$var$assert(gfc.nsPsy.last_en_subshort[chn][i + 4] > 0);
          attack_intensity[i] = en_subshort[i] / gfc.nsPsy.last_en_subshort[chn][i + 4];
          en_short[0] += en_subshort[i];
        }

        if (chn == 2) for (i = 0; i < 576; i++) {
          var l, r;
          l = ns_hpfsmpl[0][i];
          r = ns_hpfsmpl[1][i];
          ns_hpfsmpl[0][i] = l + r;
          ns_hpfsmpl[1][i] = l - r;
        }
        var pf = ns_hpfsmpl[chn & 1];
        var pfPos = 0;

        for (i = 0; i < 9; i++) {
          var pfe = pfPos + 64;
          var p = 1.;

          for (; pfPos < pfe; pfPos++) if (p < Math.abs(pf[pfPos])) p = Math.abs(pf[pfPos]);

          gfc.nsPsy.last_en_subshort[chn][i] = en_subshort[i + 3] = p;
          en_short[1 + i / 3] += p;

          if (p > en_subshort[i + 3 - 2]) {
            $97f850779472263e$var$assert(en_subshort[i + 3 - 2] > 0);
            p = p / en_subshort[i + 3 - 2];
          } else if (en_subshort[i + 3 - 2] > p * 10.0) {
            $97f850779472263e$var$assert(p > 0);
            p = en_subshort[i + 3 - 2] / (p * 10.0);
          } else p = 0.0;

          attack_intensity[i + 3] = p;
        }

        if (gfp.analysis) {
          var x = attack_intensity[0];

          for (i = 1; i < 12; i++) if (x < attack_intensity[i]) x = attack_intensity[i];

          gfc.pinfo.ers[gr_out][chn] = gfc.pinfo.ers_save[chn];
          gfc.pinfo.ers_save[chn] = x;
        }
        /* compare energies between sub-shortblocks */


        attackThreshold = chn == 3 ? gfc.nsPsy.attackthre_s : gfc.nsPsy.attackthre;

        for (i = 0; i < 12; i++) if (0 == ns_attacks[i / 3] && attack_intensity[i] > attackThreshold) ns_attacks[i / 3] = i % 3 + 1;
        /*
        * should have energy change between short blocks, in order to avoid
        * periodic signals
        */


        for (i = 1; i < 4; i++) {
          var ratio;

          if (en_short[i - 1] > en_short[i]) {
            $97f850779472263e$var$assert(en_short[i] > 0);
            ratio = en_short[i - 1] / en_short[i];
          } else {
            $97f850779472263e$var$assert(en_short[i - 1] > 0);
            ratio = en_short[i] / en_short[i - 1];
          }

          if (ratio < 1.7) {
            ns_attacks[i] = 0;
            if (i == 1) ns_attacks[0] = 0;
          }
        }

        if (ns_attacks[0] != 0 && gfc.nsPsy.lastAttacks[chn] != 0) ns_attacks[0] = 0;

        if (gfc.nsPsy.lastAttacks[chn] == 3 || ns_attacks[0] + ns_attacks[1] + ns_attacks[2] + ns_attacks[3] != 0) {
          ns_uselongblock = 0;
          if (ns_attacks[1] != 0 && ns_attacks[0] != 0) ns_attacks[1] = 0;
          if (ns_attacks[2] != 0 && ns_attacks[1] != 0) ns_attacks[2] = 0;
          if (ns_attacks[3] != 0 && ns_attacks[2] != 0) ns_attacks[3] = 0;
        }

        if (chn < 2) uselongblock[chn] = ns_uselongblock;else if (ns_uselongblock == 0) uselongblock[0] = uselongblock[1] = 0;
        /*
        * there is a one granule delay. Copy maskings computed last call
        * into masking_ratio to return to calling program.
        */

        energy[chn] = gfc.tot_ener[chn];
        /*********************************************************************
        * compute FFTs
        *********************************************************************/

        wsamp_s = wsamp_S;
        wsamp_l = wsamp_L;
        compute_ffts(gfp, fftenergy, fftenergy_s, wsamp_l, chn & 1, wsamp_s, chn & 1, gr_out, chn, buffer, bufPos);
        /*********************************************************************
        * Calculate the energy and the tonality of each partition.
        *********************************************************************/

        calc_energy(gfc, fftenergy, eb_l, max, avg);
        calc_mask_index_l(gfc, max, avg, mask_idx_l);
        /* compute masking thresholds for short blocks */

        for (sblock = 0; sblock < 3; sblock++) {
          var enn, thmm;
          compute_masking_s(gfp, fftenergy_s, eb_s, thr, chn, sblock);
          convert_partition2scalefac_s(gfc, eb_s, thr, chn, sblock);
          /**** short block pre-echo control ****/

          for (sb = 0; sb < $cPNKB.SBMAX_s; sb++) {
            thmm = gfc.thm[chn].s[sb][sblock];
            thmm *= NS_PREECHO_ATT0;

            if (ns_attacks[sblock] >= 2 || ns_attacks[sblock + 1] == 1) {
              var idx = sblock != 0 ? sblock - 1 : 2;
              var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm, NS_PREECHO_ATT1 * pcfact);
              thmm = Math.min(thmm, p);
            }

            if (ns_attacks[sblock] == 1) {
              var idx = sblock != 0 ? sblock - 1 : 2;
              var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm, NS_PREECHO_ATT2 * pcfact);
              thmm = Math.min(thmm, p);
            } else if (sblock != 0 && ns_attacks[sblock - 1] == 3 || sblock == 0 && gfc.nsPsy.lastAttacks[chn] == 3) {
              var idx = sblock != 2 ? sblock + 1 : 0;
              var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm, NS_PREECHO_ATT2 * pcfact);
              thmm = Math.min(thmm, p);
            }
            /* pulse like signal detection for fatboy.wav and so on */


            enn = en_subshort[sblock * 3 + 3] + en_subshort[sblock * 3 + 4] + en_subshort[sblock * 3 + 5];

            if (en_subshort[sblock * 3 + 5] * 6 < enn) {
              thmm *= 0.5;
              if (en_subshort[sblock * 3 + 4] * 6 < enn) thmm *= 0.5;
            }

            gfc.thm[chn].s[sb][sblock] = thmm;
          }
        }

        gfc.nsPsy.lastAttacks[chn] = ns_attacks[2];
        /*********************************************************************
        * convolve the partitioned energy and unpredictability with the
        * spreading function, s3_l[b][k]
        ********************************************************************/

        k = 0;

        for (b = 0; b < gfc.npart_l; b++) {
          /*
          * convolve the partitioned energy with the spreading
          * function
          */
          var kk = gfc.s3ind[b][0];
          var eb2 = eb_l[kk] * tab[mask_idx_l[kk]];
          var ecb = gfc.s3_ll[k++] * eb2;

          while (++kk <= gfc.s3ind[b][1]) {
            eb2 = eb_l[kk] * tab[mask_idx_l[kk]];
            ecb = mask_add(ecb, gfc.s3_ll[k++] * eb2, kk, kk - b, gfc, 0);
          }

          ecb *= 0.158489319246111;
          /* pow(10,-0.8) */

          /**** long block pre-echo control ****/

          /**
          * <PRE>
          * dont use long block pre-echo control if previous granule was
          * a short block.  This is to avoid the situation:
          * frame0:  quiet (very low masking)
          * frame1:  surge  (triggers short blocks)
          * frame2:  regular frame.  looks like pre-echo when compared to
          *          frame0, but all pre-echo was in frame1.
          * </PRE>
          */

          /*
          * chn=0,1 L and R channels
          *
          * chn=2,3 S and M channels.
          */

          if (gfc.blocktype_old[chn & 1] == $cPNKB.SHORT_TYPE) thr[b] = ecb;else thr[b] = NS_INTERP(Math.min(ecb, Math.min(rpelev * gfc.nb_1[chn][b], rpelev2 * gfc.nb_2[chn][b])), ecb, pcfact);
          gfc.nb_2[chn][b] = gfc.nb_1[chn][b];
          gfc.nb_1[chn][b] = ecb;
        }

        for (; b <= $cPNKB.CBANDS; ++b) {
          eb_l[b] = 0;
          thr[b] = 0;
        }
        /* compute masking thresholds for long blocks */


        convert_partition2scalefac_l(gfc, eb_l, thr, chn);
      }
      /* end loop over chn */


      if (gfp.mode == MPEGMode.STEREO || gfp.mode == MPEGMode.JOINT_STEREO) {
        if (gfp.interChRatio > 0.0) calc_interchannel_masking(gfp, gfp.interChRatio);
      }

      if (gfp.mode == MPEGMode.JOINT_STEREO) {
        var msfix;
        msfix1(gfc);
        msfix = gfp.msfix;
        if (Math.abs(msfix) > 0.0) ns_msfix(gfc, msfix, gfp.ATHlower * gfc.ATH.adjust);
      }
      /***************************************************************
      * determine final block type
      ***************************************************************/


      block_type_set(gfp, uselongblock, blocktype_d, blocktype);
      /*********************************************************************
      * compute the value of PE to return ... no delay and advance
      *********************************************************************/

      for (chn = 0; chn < numchn; chn++) {
        var ppe;
        var ppePos = 0;
        var type;
        var mr;

        if (chn > 1) {
          ppe = percep_MS_entropy;
          ppePos = -2;
          type = $cPNKB.NORM_TYPE;
          if (blocktype_d[0] == $cPNKB.SHORT_TYPE || blocktype_d[1] == $cPNKB.SHORT_TYPE) type = $cPNKB.SHORT_TYPE;
          mr = masking_MS_ratio[gr_out][chn - 2];
        } else {
          ppe = percep_entropy;
          ppePos = 0;
          type = blocktype_d[chn];
          mr = masking_ratio[gr_out][chn];
        }

        if (type == $cPNKB.SHORT_TYPE) ppe[ppePos + chn] = pecalc_s(mr, gfc.masking_lower);else ppe[ppePos + chn] = pecalc_l(mr, gfc.masking_lower);
        if (gfp.analysis) gfc.pinfo.pe[gr_out][chn] = ppe[ppePos + chn];
      }

      return 0;
    };

    function vbrpsy_compute_fft_l(gfp, buffer, bufPos, chn, gr_out, fftenergy, wsamp_l, wsamp_lPos) {
      var gfc = gfp.internal_flags;
      if (chn < 2) fft.fft_long(gfc, wsamp_l[wsamp_lPos], chn, buffer, bufPos);else if (chn == 2)
        /* FFT data for mid and side channel is derived from L & R */
        for (var j = $cPNKB.BLKSIZE - 1; j >= 0; --j) {
          var l = wsamp_l[wsamp_lPos + 0][j];
          var r = wsamp_l[wsamp_lPos + 1][j];
          wsamp_l[wsamp_lPos + 0][j] = (l + r) * $97f850779472263e$var$Util.SQRT2 * 0.5;
          wsamp_l[wsamp_lPos + 1][j] = (l - r) * $97f850779472263e$var$Util.SQRT2 * 0.5;
        }
      /*********************************************************************
      * compute energies
      *********************************************************************/

      fftenergy[0] = NON_LINEAR_SCALE_ENERGY(wsamp_l[wsamp_lPos + 0][0]);
      fftenergy[0] *= fftenergy[0];

      for (var j = $cPNKB.BLKSIZE / 2 - 1; j >= 0; --j) {
        var re = wsamp_l[wsamp_lPos + 0][$cPNKB.BLKSIZE / 2 - j];
        var im = wsamp_l[wsamp_lPos + 0][$cPNKB.BLKSIZE / 2 + j];
        fftenergy[$cPNKB.BLKSIZE / 2 - j] = NON_LINEAR_SCALE_ENERGY((re * re + im * im) * 0.5);
      }

      var totalenergy = 0.0;

      for (var j = 11; j < $cPNKB.HBLKSIZE; j++) totalenergy += fftenergy[j];

      gfc.tot_ener[chn] = totalenergy;

      if (gfp.analysis) {
        for (var j = 0; j < $cPNKB.HBLKSIZE; j++) {
          gfc.pinfo.energy[gr_out][chn][j] = gfc.pinfo.energy_save[chn][j];
          gfc.pinfo.energy_save[chn][j] = fftenergy[j];
        }

        gfc.pinfo.pe[gr_out][chn] = gfc.pe[chn];
      }
    }

    function vbrpsy_compute_fft_s(gfp, buffer, bufPos, chn, sblock, fftenergy_s, wsamp_s, wsamp_sPos) {
      var gfc = gfp.internal_flags;
      if (sblock == 0 && chn < 2) fft.fft_short(gfc, wsamp_s[wsamp_sPos], chn, buffer, bufPos);
      if (chn == 2)
        /* FFT data for mid and side channel is derived from L & R */
        for (var j = $cPNKB.BLKSIZE_s - 1; j >= 0; --j) {
          var l = wsamp_s[wsamp_sPos + 0][sblock][j];
          var r = wsamp_s[wsamp_sPos + 1][sblock][j];
          wsamp_s[wsamp_sPos + 0][sblock][j] = (l + r) * $97f850779472263e$var$Util.SQRT2 * 0.5;
          wsamp_s[wsamp_sPos + 1][sblock][j] = (l - r) * $97f850779472263e$var$Util.SQRT2 * 0.5;
        }
      /*********************************************************************
      * compute energies
      *********************************************************************/

      fftenergy_s[sblock][0] = wsamp_s[wsamp_sPos + 0][sblock][0];
      fftenergy_s[sblock][0] *= fftenergy_s[sblock][0];

      for (var j = $cPNKB.BLKSIZE_s / 2 - 1; j >= 0; --j) {
        var re = wsamp_s[wsamp_sPos + 0][sblock][$cPNKB.BLKSIZE_s / 2 - j];
        var im = wsamp_s[wsamp_sPos + 0][sblock][$cPNKB.BLKSIZE_s / 2 + j];
        fftenergy_s[sblock][$cPNKB.BLKSIZE_s / 2 - j] = NON_LINEAR_SCALE_ENERGY((re * re + im * im) * 0.5);
      }
    }
    /**
    * compute loudness approximation (used for ATH auto-level adjustment)
    */


    function vbrpsy_compute_loudness_approximation_l(gfp, gr_out, chn, fftenergy) {
      var gfc = gfp.internal_flags;

      if (gfp.athaa_loudapprox == 2 && chn < 2) {
        // no loudness for mid/side ch
        gfc.loudness_sq[gr_out][chn] = gfc.loudness_sq_save[chn];
        gfc.loudness_sq_save[chn] = psycho_loudness_approx(fftenergy, gfc);
      }
    }

    var fircoef_ = [-0.00000000000000000865163 * 2, -0.01703172, -0.00000000000000000674764 * 2, 0.0418072, -0.0000000000000000336639 * 2, -0.0876324, -0.0000000000000000154175 * 2, 0.1863476, -0.0000000000000000552212 * 2, -0.627638];
    /**
    * Apply HPF of fs/4 to the input signal. This is used for attack detection
    * / handling.
    */

    function vbrpsy_attack_detection(gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, energy, sub_short_factor, ns_attacks, uselongblock) {
      var ns_hpfsmpl = $97f850779472263e$var$new_float_n([2, 576]);
      var gfc = gfp.internal_flags;
      var n_chn_out = gfc.channels_out;
      /* chn=2 and 3 = Mid and Side channels */

      var n_chn_psy = gfp.mode == MPEGMode.JOINT_STEREO ? 4 : n_chn_out;
      /* Don't copy the input buffer into a temporary buffer */

      /* unroll the loop 2 times */

      for (var chn = 0; chn < n_chn_out; chn++) {
        /* apply high pass filter of fs/4 */
        firbuf = buffer[chn];
        var firbufPos = bufPos + 576 - 350 - NSFIRLEN + 192;
        $97f850779472263e$var$assert(fircoef_.length == (NSFIRLEN - 1) / 2);

        for (var i = 0; i < 576; i++) {
          var sum1, sum2;
          sum1 = firbuf[firbufPos + i + 10];
          sum2 = 0.0;

          for (var j = 0; j < (NSFIRLEN - 1) / 2 - 1; j += 2) {
            sum1 += fircoef_[j] * (firbuf[firbufPos + i + j] + firbuf[firbufPos + i + NSFIRLEN - j]);
            sum2 += fircoef_[j + 1] * (firbuf[firbufPos + i + j + 1] + firbuf[firbufPos + i + NSFIRLEN - j - 1]);
          }

          ns_hpfsmpl[chn][i] = sum1 + sum2;
        }

        masking_ratio[gr_out][chn].en.assign(gfc.en[chn]);
        masking_ratio[gr_out][chn].thm.assign(gfc.thm[chn]);

        if (n_chn_psy > 2) {
          /* MS maskings */

          /* percep_MS_entropy [chn-2] = gfc . pe [chn]; */
          masking_MS_ratio[gr_out][chn].en.assign(gfc.en[chn + 2]);
          masking_MS_ratio[gr_out][chn].thm.assign(gfc.thm[chn + 2]);
        }
      }

      for (var chn = 0; chn < n_chn_psy; chn++) {
        var attack_intensity = $97f850779472263e$var$new_float(12);
        var en_subshort = $97f850779472263e$var$new_float(12);
        var en_short = [0, 0, 0, 0];
        var pf = ns_hpfsmpl[chn & 1];
        var pfPos = 0;
        var attackThreshold = chn == 3 ? gfc.nsPsy.attackthre_s : gfc.nsPsy.attackthre;
        var ns_uselongblock = 1;
        if (chn == 2) for (var i = 0, j = 576; j > 0; ++i, --j) {
          var l = ns_hpfsmpl[0][i];
          var r = ns_hpfsmpl[1][i];
          ns_hpfsmpl[0][i] = l + r;
          ns_hpfsmpl[1][i] = l - r;
        }
        /***************************************************************
        * determine the block type (window type)
        ***************************************************************/

        /* calculate energies of each sub-shortblocks */

        for (var i = 0; i < 3; i++) {
          en_subshort[i] = gfc.nsPsy.last_en_subshort[chn][i + 6];
          $97f850779472263e$var$assert(gfc.nsPsy.last_en_subshort[chn][i + 4] > 0);
          attack_intensity[i] = en_subshort[i] / gfc.nsPsy.last_en_subshort[chn][i + 4];
          en_short[0] += en_subshort[i];
        }

        for (var i = 0; i < 9; i++) {
          var pfe = pfPos + 64;
          var p = 1.;

          for (; pfPos < pfe; pfPos++) if (p < Math.abs(pf[pfPos])) p = Math.abs(pf[pfPos]);

          gfc.nsPsy.last_en_subshort[chn][i] = en_subshort[i + 3] = p;
          en_short[1 + i / 3] += p;

          if (p > en_subshort[i + 3 - 2]) {
            $97f850779472263e$var$assert(en_subshort[i + 3 - 2] > 0);
            p = p / en_subshort[i + 3 - 2];
          } else if (en_subshort[i + 3 - 2] > p * 10.0) {
            $97f850779472263e$var$assert(p > 0);
            p = en_subshort[i + 3 - 2] / (p * 10.0);
          } else p = 0.0;

          attack_intensity[i + 3] = p;
        }
        /* pulse like signal detection for fatboy.wav and so on */


        for (var i = 0; i < 3; ++i) {
          var enn = en_subshort[i * 3 + 3] + en_subshort[i * 3 + 4] + en_subshort[i * 3 + 5];
          var factor = 1.;

          if (en_subshort[i * 3 + 5] * 6 < enn) {
            factor *= 0.5;
            if (en_subshort[i * 3 + 4] * 6 < enn) factor *= 0.5;
          }

          sub_short_factor[chn][i] = factor;
        }

        if (gfp.analysis) {
          var x = attack_intensity[0];

          for (var i = 1; i < 12; i++) if (x < attack_intensity[i]) x = attack_intensity[i];

          gfc.pinfo.ers[gr_out][chn] = gfc.pinfo.ers_save[chn];
          gfc.pinfo.ers_save[chn] = x;
        }
        /* compare energies between sub-shortblocks */


        for (var i = 0; i < 12; i++) if (0 == ns_attacks[chn][i / 3] && attack_intensity[i] > attackThreshold) ns_attacks[chn][i / 3] = i % 3 + 1;
        /*
        * should have energy change between short blocks, in order to avoid
        * periodic signals
        */

        /* Good samples to show the effect are Trumpet test songs */

        /*
        * GB: tuned (1) to avoid too many short blocks for test sample
        * TRUMPET
        */

        /*
        * RH: tuned (2) to let enough short blocks through for test sample
        * FSOL and SNAPS
        */


        for (var i = 1; i < 4; i++) {
          var u = en_short[i - 1];
          var v = en_short[i];
          var m = Math.max(u, v);

          if (m < 40000) {
            if (u < 1.7 * v && v < 1.7 * u) {
              if (i == 1 && ns_attacks[chn][0] <= ns_attacks[chn][i]) ns_attacks[chn][0] = 0;
              ns_attacks[chn][i] = 0;
            }
          }
        }

        if (ns_attacks[chn][0] <= gfc.nsPsy.lastAttacks[chn]) ns_attacks[chn][0] = 0;

        if (gfc.nsPsy.lastAttacks[chn] == 3 || ns_attacks[chn][0] + ns_attacks[chn][1] + ns_attacks[chn][2] + ns_attacks[chn][3] != 0) {
          ns_uselongblock = 0;
          if (ns_attacks[chn][1] != 0 && ns_attacks[chn][0] != 0) ns_attacks[chn][1] = 0;
          if (ns_attacks[chn][2] != 0 && ns_attacks[chn][1] != 0) ns_attacks[chn][2] = 0;
          if (ns_attacks[chn][3] != 0 && ns_attacks[chn][2] != 0) ns_attacks[chn][3] = 0;
        }

        if (chn < 2) uselongblock[chn] = ns_uselongblock;else if (ns_uselongblock == 0) uselongblock[0] = uselongblock[1] = 0;
        /*
        * there is a one granule delay. Copy maskings computed last call
        * into masking_ratio to return to calling program.
        */

        energy[chn] = gfc.tot_ener[chn];
      }
    }

    function vbrpsy_skip_masking_s(gfc, chn, sblock) {
      if (sblock == 0) for (var b = 0; b < gfc.npart_s; b++) {
        gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];
        gfc.nb_s1[chn][b] = 0;
      }
    }

    function vbrpsy_skip_masking_l(gfc, chn) {
      for (var b = 0; b < gfc.npart_l; b++) {
        gfc.nb_2[chn][b] = gfc.nb_1[chn][b];
        gfc.nb_1[chn][b] = 0;
      }
    }

    function psyvbr_calc_mask_index_s(gfc, max, avg, mask_idx) {
      var last_tab_entry = tab.length - 1;
      var b = 0;
      var a = avg[b] + avg[b + 1];
      $97f850779472263e$var$assert(a >= 0);

      if (a > 0.0) {
        var m = max[b];
        if (m < max[b + 1]) m = max[b + 1];
        $97f850779472263e$var$assert(gfc.numlines_s[b] + gfc.numlines_s[b + 1] - 1 > 0);
        a = 20.0 * (m * 2.0 - a) / (a * (gfc.numlines_s[b] + gfc.numlines_s[b + 1] - 1));
        var k = 0 | a;
        if (k > last_tab_entry) k = last_tab_entry;
        mask_idx[b] = k;
      } else mask_idx[b] = 0;

      for (b = 1; b < gfc.npart_s - 1; b++) {
        a = avg[b - 1] + avg[b] + avg[b + 1];
        $97f850779472263e$var$assert(b + 1 < gfc.npart_s);
        $97f850779472263e$var$assert(a >= 0);

        if (a > 0.0) {
          var m = max[b - 1];
          if (m < max[b]) m = max[b];
          if (m < max[b + 1]) m = max[b + 1];
          $97f850779472263e$var$assert(gfc.numlines_s[b - 1] + gfc.numlines_s[b] + gfc.numlines_s[b + 1] - 1 > 0);
          a = 20.0 * (m * 3.0 - a) / (a * (gfc.numlines_s[b - 1] + gfc.numlines_s[b] + gfc.numlines_s[b + 1] - 1));
          var k = 0 | a;
          if (k > last_tab_entry) k = last_tab_entry;
          mask_idx[b] = k;
        } else mask_idx[b] = 0;
      }

      $97f850779472263e$var$assert(b > 0);
      $97f850779472263e$var$assert(b == gfc.npart_s - 1);
      a = avg[b - 1] + avg[b];
      $97f850779472263e$var$assert(a >= 0);

      if (a > 0.0) {
        var m = max[b - 1];
        if (m < max[b]) m = max[b];
        $97f850779472263e$var$assert(gfc.numlines_s[b - 1] + gfc.numlines_s[b] - 1 > 0);
        a = 20.0 * (m * 2.0 - a) / (a * (gfc.numlines_s[b - 1] + gfc.numlines_s[b] - 1));
        var k = 0 | a;
        if (k > last_tab_entry) k = last_tab_entry;
        mask_idx[b] = k;
      } else mask_idx[b] = 0;

      $97f850779472263e$var$assert(b == gfc.npart_s - 1);
    }

    function vbrpsy_compute_masking_s(gfp, fftenergy_s, eb, thr, chn, sblock) {
      var gfc = gfp.internal_flags;
      var max = new float[$cPNKB.CBANDS](),
          avg = $97f850779472263e$var$new_float($cPNKB.CBANDS);
      var i, j, b;
      var mask_idx_s = new int[$cPNKB.CBANDS]();

      for (b = j = 0; b < gfc.npart_s; ++b) {
        var ebb = 0,
            m = 0;
        var n = gfc.numlines_s[b];

        for (i = 0; i < n; ++i, ++j) {
          var el = fftenergy_s[sblock][j];
          ebb += el;
          if (m < el) m = el;
        }

        eb[b] = ebb;
        $97f850779472263e$var$assert(ebb >= 0);
        max[b] = m;
        $97f850779472263e$var$assert(n > 0);
        avg[b] = ebb / n;
        $97f850779472263e$var$assert(avg[b] >= 0);
      }

      $97f850779472263e$var$assert(b == gfc.npart_s);
      $97f850779472263e$var$assert(j == 129);

      for (; b < $cPNKB.CBANDS; ++b) {
        max[b] = 0;
        avg[b] = 0;
      }

      psyvbr_calc_mask_index_s(gfc, max, avg, mask_idx_s);

      for (j = b = 0; b < gfc.npart_s; b++) {
        var kk = gfc.s3ind_s[b][0];
        var last = gfc.s3ind_s[b][1];
        var dd, dd_n;
        var x, ecb, avg_mask;
        dd = mask_idx_s[kk];
        dd_n = 1;
        ecb = gfc.s3_ss[j] * eb[kk] * tab[mask_idx_s[kk]];
        ++j;
        ++kk;

        while (kk <= last) {
          dd += mask_idx_s[kk];
          dd_n += 1;
          x = gfc.s3_ss[j] * eb[kk] * tab[mask_idx_s[kk]];
          ecb = vbrpsy_mask_add(ecb, x, kk - b);
          ++j;
          ++kk;
        }

        dd = (1 + 2 * dd) / (2 * dd_n);
        avg_mask = tab[dd] * 0.5;
        ecb *= avg_mask;
        thr[b] = ecb;
        gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];
        gfc.nb_s1[chn][b] = ecb;
        /*
        * if THR exceeds EB, the quantization routines will take the
        * difference from other bands. in case of strong tonal samples
        * (tonaltest.wav) this leads to heavy distortions. that's why
        * we limit THR here.
        */

        x = max[b];
        x *= gfc.minval_s[b];
        x *= avg_mask;
        if (thr[b] > x) thr[b] = x;
        if (gfc.masking_lower > 1) thr[b] *= gfc.masking_lower;
        if (thr[b] > eb[b]) thr[b] = eb[b];
        if (gfc.masking_lower < 1) thr[b] *= gfc.masking_lower;
        $97f850779472263e$var$assert(thr[b] >= 0);
      }

      for (; b < $cPNKB.CBANDS; ++b) {
        eb[b] = 0;
        thr[b] = 0;
      }
    }

    function vbrpsy_compute_masking_l(gfc, fftenergy, eb_l, thr, chn) {
      var max = $97f850779472263e$var$new_float($cPNKB.CBANDS),
          avg = $97f850779472263e$var$new_float($cPNKB.CBANDS);
      var mask_idx_l = $97f850779472263e$var$new_int($cPNKB.CBANDS + 2);
      var b;
      /*********************************************************************
      * Calculate the energy and the tonality of each partition.
      *********************************************************************/

      calc_energy(gfc, fftenergy, eb_l, max, avg);
      calc_mask_index_l(gfc, max, avg, mask_idx_l);
      /*********************************************************************
      * convolve the partitioned energy and unpredictability with the
      * spreading function, s3_l[b][k]
      ********************************************************************/

      var k = 0;

      for (b = 0; b < gfc.npart_l; b++) {
        var x, ecb, avg_mask, t;
        /* convolve the partitioned energy with the spreading function */

        var kk = gfc.s3ind[b][0];
        var last = gfc.s3ind[b][1];
        var dd = 0,
            dd_n = 0;
        dd = mask_idx_l[kk];
        dd_n += 1;
        ecb = gfc.s3_ll[k] * eb_l[kk] * tab[mask_idx_l[kk]];
        ++k;
        ++kk;

        while (kk <= last) {
          dd += mask_idx_l[kk];
          dd_n += 1;
          x = gfc.s3_ll[k] * eb_l[kk] * tab[mask_idx_l[kk]];
          t = vbrpsy_mask_add(ecb, x, kk - b);
          ecb = t;
          ++k;
          ++kk;
        }

        dd = (1 + 2 * dd) / (2 * dd_n);
        avg_mask = tab[dd] * 0.5;
        ecb *= avg_mask;
        /**** long block pre-echo control ****/

        /**
        * <PRE>
        * dont use long block pre-echo control if previous granule was
        * a short block.  This is to avoid the situation:
        * frame0:  quiet (very low masking)
        * frame1:  surge  (triggers short blocks)
        * frame2:  regular frame.  looks like pre-echo when compared to
        *          frame0, but all pre-echo was in frame1.
        * </PRE>
        */

        /*
        * chn=0,1 L and R channels chn=2,3 S and M channels.
        */

        if (gfc.blocktype_old[chn & 0x01] == $cPNKB.SHORT_TYPE) {
          var ecb_limit = rpelev * gfc.nb_1[chn][b];
          if (ecb_limit > 0) thr[b] = Math.min(ecb, ecb_limit);else
            /**
            * <PRE>
            * Robert 071209:
            * Because we don't calculate long block psy when we know a granule
            * should be of short blocks, we don't have any clue how the granule
            * before would have looked like as a long block. So we have to guess
            * a little bit for this END_TYPE block.
            * Most of the time we get away with this sloppyness. (fingers crossed :)
            * The speed increase is worth it.
            * </PRE>
            */
            thr[b] = Math.min(ecb, eb_l[b] * NS_PREECHO_ATT2);
        } else {
          var ecb_limit_2 = rpelev2 * gfc.nb_2[chn][b];
          var ecb_limit_1 = rpelev * gfc.nb_1[chn][b];
          var ecb_limit;
          if (ecb_limit_2 <= 0) ecb_limit_2 = ecb;
          if (ecb_limit_1 <= 0) ecb_limit_1 = ecb;
          if (gfc.blocktype_old[chn & 0x01] == $cPNKB.NORM_TYPE) ecb_limit = Math.min(ecb_limit_1, ecb_limit_2);else ecb_limit = ecb_limit_1;
          thr[b] = Math.min(ecb, ecb_limit);
        }

        gfc.nb_2[chn][b] = gfc.nb_1[chn][b];
        gfc.nb_1[chn][b] = ecb;
        /*
        * if THR exceeds EB, the quantization routines will take the
        * difference from other bands. in case of strong tonal samples
        * (tonaltest.wav) this leads to heavy distortions. that's why
        * we limit THR here.
        */

        x = max[b];
        x *= gfc.minval_l[b];
        x *= avg_mask;
        if (thr[b] > x) thr[b] = x;
        if (gfc.masking_lower > 1) thr[b] *= gfc.masking_lower;
        if (thr[b] > eb_l[b]) thr[b] = eb_l[b];
        if (gfc.masking_lower < 1) thr[b] *= gfc.masking_lower;
        $97f850779472263e$var$assert(thr[b] >= 0);
      }

      for (; b < $cPNKB.CBANDS; ++b) {
        eb_l[b] = 0;
        thr[b] = 0;
      }
    }

    function vbrpsy_compute_block_type(gfp, uselongblock) {
      var gfc = gfp.internal_flags;
      if (gfp.short_blocks == $97f850779472263e$var$ShortBlock.short_block_coupled && !(uselongblock[0] != 0 && uselongblock[1] != 0)) uselongblock[0] = uselongblock[1] = 0;

      for (var chn = 0; chn < gfc.channels_out; chn++) {
        /* disable short blocks */
        if (gfp.short_blocks == $97f850779472263e$var$ShortBlock.short_block_dispensed) uselongblock[chn] = 1;
        if (gfp.short_blocks == $97f850779472263e$var$ShortBlock.short_block_forced) uselongblock[chn] = 0;
      }
    }

    function vbrpsy_apply_block_type(gfp, uselongblock, blocktype_d) {
      var gfc = gfp.internal_flags;
      /*
      * update the blocktype of the previous granule, since it depends on
      * what happend in this granule
      */

      for (var chn = 0; chn < gfc.channels_out; chn++) {
        var blocktype = $cPNKB.NORM_TYPE;
        /* disable short blocks */

        if (uselongblock[chn] != 0) {
          /* no attack : use long blocks */
          $97f850779472263e$var$assert(gfc.blocktype_old[chn] != $cPNKB.START_TYPE);
          if (gfc.blocktype_old[chn] == $cPNKB.SHORT_TYPE) blocktype = $cPNKB.STOP_TYPE;
        } else {
          /* attack : use short blocks */
          blocktype = $cPNKB.SHORT_TYPE;
          if (gfc.blocktype_old[chn] == $cPNKB.NORM_TYPE) gfc.blocktype_old[chn] = $cPNKB.START_TYPE;
          if (gfc.blocktype_old[chn] == $cPNKB.STOP_TYPE) gfc.blocktype_old[chn] = $cPNKB.SHORT_TYPE;
        }

        blocktype_d[chn] = gfc.blocktype_old[chn]; // value returned to calling program

        gfc.blocktype_old[chn] = blocktype; // save for next call to l3psy_anal
      }
    }
    /**
       * compute M/S thresholds from Johnston & Ferreira 1992 ICASSP paper
       */


    function vbrpsy_compute_MS_thresholds(eb, thr, cb_mld, ath_cb, athadjust, msfix, n) {
      var msfix2 = msfix * 2;
      var athlower = msfix > 0 ? Math.pow(10, athadjust) : 1;
      var rside, rmid;

      for (var b = 0; b < n; ++b) {
        var ebM = eb[2][b];
        var ebS = eb[3][b];
        var thmL = thr[0][b];
        var thmR = thr[1][b];
        var thmM = thr[2][b];
        var thmS = thr[3][b];
        /* use this fix if L & R masking differs by 2db or less */

        if (thmL <= 1.58 * thmR && thmR <= 1.58 * thmL) {
          var mld_m = cb_mld[b] * ebS;
          var mld_s = cb_mld[b] * ebM;
          rmid = Math.max(thmM, Math.min(thmS, mld_m));
          rside = Math.max(thmS, Math.min(thmM, mld_s));
        } else {
          rmid = thmM;
          rside = thmS;
        }

        if (msfix > 0) {
          /***************************************************************/

          /* Adjust M/S maskings if user set "msfix" */

          /***************************************************************/

          /* Naoki Shibata 2000 */
          var thmLR, thmMS;
          var ath = ath_cb[b] * athlower;
          thmLR = Math.min(Math.max(thmL, ath), Math.max(thmR, ath));
          thmM = Math.max(rmid, ath);
          thmS = Math.max(rside, ath);
          thmMS = thmM + thmS;

          if (thmMS > 0 && thmLR * msfix2 < thmMS) {
            var f = thmLR * msfix2 / thmMS;
            thmM *= f;
            thmS *= f;
            $97f850779472263e$var$assert(thmMS > 0);
          }

          rmid = Math.min(thmM, rmid);
          rside = Math.min(thmS, rside);
        }

        if (rmid > ebM) rmid = ebM;
        if (rside > ebS) rside = ebS;
        thr[2][b] = rmid;
        thr[3][b] = rside;
      }
    }

    this.L3psycho_anal_vbr = function (gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, percep_entropy, percep_MS_entropy, energy, blocktype_d) {
      var gfc = gfp.internal_flags;
      /* fft and energy calculation */

      var wsamp_l;
      var wsamp_s;
      var fftenergy = $97f850779472263e$var$new_float($cPNKB.HBLKSIZE);
      var fftenergy_s = $97f850779472263e$var$new_float_n([3, $cPNKB.HBLKSIZE_s]);
      var wsamp_L = $97f850779472263e$var$new_float_n([2, $cPNKB.BLKSIZE]);
      var wsamp_S = $97f850779472263e$var$new_float_n([2, 3, $cPNKB.BLKSIZE_s]);
      var eb = $97f850779472263e$var$new_float_n([4, $cPNKB.CBANDS]),
          thr = $97f850779472263e$var$new_float_n([4, $cPNKB.CBANDS]);
      var sub_short_factor = $97f850779472263e$var$new_float_n([4, 3]);
      var pcfact = 0.6;
      /* block type */

      var ns_attacks = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]];
      var uselongblock = $97f850779472263e$var$new_int(2);
      /* usual variables like loop indices, etc.. */

      /* chn=2 and 3 = Mid and Side channels */

      var n_chn_psy = gfp.mode == MPEGMode.JOINT_STEREO ? 4 : gfc.channels_out;
      vbrpsy_attack_detection(gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, energy, sub_short_factor, ns_attacks, uselongblock);
      vbrpsy_compute_block_type(gfp, uselongblock);

      for (var chn = 0; chn < n_chn_psy; chn++) {
        var ch01 = chn & 0x01;
        wsamp_l = wsamp_L;
        vbrpsy_compute_fft_l(gfp, buffer, bufPos, chn, gr_out, fftenergy, wsamp_l, ch01);
        vbrpsy_compute_loudness_approximation_l(gfp, gr_out, chn, fftenergy);
        if (uselongblock[ch01] != 0) vbrpsy_compute_masking_l(gfc, fftenergy, eb[chn], thr[chn], chn);else vbrpsy_skip_masking_l(gfc, chn);
      }

      if (uselongblock[0] + uselongblock[1] == 2)
        /* M/S channel */
        {
          if (gfp.mode == MPEGMode.JOINT_STEREO) vbrpsy_compute_MS_thresholds(eb, thr, gfc.mld_cb_l, gfc.ATH.cb_l, gfp.ATHlower * gfc.ATH.adjust, gfp.msfix, gfc.npart_l);
        }
      /* TODO: apply adaptive ATH masking here ?? */


      for (var chn = 0; chn < n_chn_psy; chn++) {
        var ch01 = chn & 0x01;
        if (uselongblock[ch01] != 0) convert_partition2scalefac_l(gfc, eb[chn], thr[chn], chn);
      }

      for (var sblock = 0; sblock < 3; sblock++) {
        for (var chn = 0; chn < n_chn_psy; ++chn) {
          var ch01 = chn & 0x01;
          if (uselongblock[ch01] != 0) vbrpsy_skip_masking_s(gfc, chn, sblock);else {
            /* compute masking thresholds for short blocks */
            wsamp_s = wsamp_S;
            vbrpsy_compute_fft_s(gfp, buffer, bufPos, chn, sblock, fftenergy_s, wsamp_s, ch01);
            vbrpsy_compute_masking_s(gfp, fftenergy_s, eb[chn], thr[chn], chn, sblock);
          }
        }

        if (uselongblock[0] + uselongblock[1] == 0)
          /* M/S channel */
          {
            if (gfp.mode == MPEGMode.JOINT_STEREO) vbrpsy_compute_MS_thresholds(eb, thr, gfc.mld_cb_s, gfc.ATH.cb_s, gfp.ATHlower * gfc.ATH.adjust, gfp.msfix, gfc.npart_s);
          }
        /* TODO: apply adaptive ATH masking here ?? */


        for (var chn = 0; chn < n_chn_psy; ++chn) {
          var ch01 = chn & 0x01;
          if (0 == uselongblock[ch01]) convert_partition2scalefac_s(gfc, eb[chn], thr[chn], chn, sblock);
        }
      }
      /**** short block pre-echo control ****/


      for (var chn = 0; chn < n_chn_psy; chn++) {
        var ch01 = chn & 0x01;
        if (uselongblock[ch01] != 0) continue;

        for (var sb = 0; sb < $cPNKB.SBMAX_s; sb++) {
          var new_thmm = $97f850779472263e$var$new_float(3);

          for (var sblock = 0; sblock < 3; sblock++) {
            var thmm = gfc.thm[chn].s[sb][sblock];
            thmm *= NS_PREECHO_ATT0;

            if (ns_attacks[chn][sblock] >= 2 || ns_attacks[chn][sblock + 1] == 1) {
              var idx = sblock != 0 ? sblock - 1 : 2;
              var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm, NS_PREECHO_ATT1 * pcfact);
              thmm = Math.min(thmm, p);
            } else if (ns_attacks[chn][sblock] == 1) {
              var idx = sblock != 0 ? sblock - 1 : 2;
              var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm, NS_PREECHO_ATT2 * pcfact);
              thmm = Math.min(thmm, p);
            } else if (sblock != 0 && ns_attacks[chn][sblock - 1] == 3 || sblock == 0 && gfc.nsPsy.lastAttacks[chn] == 3) {
              var idx = sblock != 2 ? sblock + 1 : 0;
              var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm, NS_PREECHO_ATT2 * pcfact);
              thmm = Math.min(thmm, p);
            }
            /* pulse like signal detection for fatboy.wav and so on */


            thmm *= sub_short_factor[chn][sblock];
            new_thmm[sblock] = thmm;
          }

          for (var sblock = 0; sblock < 3; sblock++) gfc.thm[chn].s[sb][sblock] = new_thmm[sblock];
        }
      }

      for (var chn = 0; chn < n_chn_psy; chn++) gfc.nsPsy.lastAttacks[chn] = ns_attacks[chn][2];
      /***************************************************************
      * determine final block type
      ***************************************************************/


      vbrpsy_apply_block_type(gfp, uselongblock, blocktype_d);
      /*********************************************************************
      * compute the value of PE to return ... no delay and advance
      *********************************************************************/

      for (var chn = 0; chn < n_chn_psy; chn++) {
        var ppe;
        var ppePos;
        var type;
        var mr;

        if (chn > 1) {
          ppe = percep_MS_entropy;
          ppePos = -2;
          type = $cPNKB.NORM_TYPE;
          if (blocktype_d[0] == $cPNKB.SHORT_TYPE || blocktype_d[1] == $cPNKB.SHORT_TYPE) type = $cPNKB.SHORT_TYPE;
          mr = masking_MS_ratio[gr_out][chn - 2];
        } else {
          ppe = percep_entropy;
          ppePos = 0;
          type = blocktype_d[chn];
          mr = masking_ratio[gr_out][chn];
        }

        if (type == $cPNKB.SHORT_TYPE) ppe[ppePos + chn] = pecalc_s(mr, gfc.masking_lower);else ppe[ppePos + chn] = pecalc_l(mr, gfc.masking_lower);
        if (gfp.analysis) gfc.pinfo.pe[gr_out][chn] = ppe[ppePos + chn];
      }

      return 0;
    };

    function s3_func_x(bark, hf_slope) {
      var tempx = bark,
          tempy;
      if (tempx >= 0) tempy = -tempx * 27;else tempy = tempx * hf_slope;
      if (tempy <= -72) return 0;
      return Math.exp(tempy * LN_TO_LOG10);
    }

    function norm_s3_func_x(hf_slope) {
      var lim_a = 0,
          lim_b = 0;
      var x = 0,
          l,
          h;

      for (x = 0; s3_func_x(x, hf_slope) > 1e-20; x -= 1);

      l = x;
      h = 0;

      while (Math.abs(h - l) > 1e-12) {
        x = (h + l) / 2;
        if (s3_func_x(x, hf_slope) > 0) h = x;else l = x;
      }

      lim_a = l;
      var x = 0,
          l,
          h;

      for (x = 0; s3_func_x(x, hf_slope) > 1e-20; x += 1);

      l = 0;
      h = x;

      while (Math.abs(h - l) > 1e-12) {
        x = (h + l) / 2;
        if (s3_func_x(x, hf_slope) > 0) l = x;else h = x;
      }

      lim_b = h;
      var sum = 0;
      var m = 1000;
      var i;

      for (i = 0; i <= m; ++i) {
        var x = lim_a + i * (lim_b - lim_a) / m;
        var y = s3_func_x(x, hf_slope);
        sum += y;
      }

      var norm = (m + 1) / (sum * (lim_b - lim_a));
      /* printf( "norm = %lf\n",norm); */

      return norm;
    }
    /**
    *   The spreading function.  Values returned in units of energy
    */


    function s3_func(bark) {
      var tempx, x, tempy, temp;
      tempx = bark;
      if (tempx >= 0) tempx *= 3;else tempx *= 1.5;

      if (tempx >= 0.5 && tempx <= 2.5) {
        temp = tempx - 0.5;
        x = 8.0 * (temp * temp - 2.0 * temp);
      } else x = 0.0;

      tempx += 0.474;
      tempy = 15.811389 + 7.5 * tempx - 17.5 * Math.sqrt(1.0 + tempx * tempx);
      if (tempy <= -60) return 0.0;
      tempx = Math.exp((x + tempy) * LN_TO_LOG10);
      /**
      * <PRE>
      * Normalization.  The spreading function should be normalized so that:
      * +inf
      * /
      * |  s3 [ bark ]  d(bark)   =  1
      * /
      * -inf
      * </PRE>
      */

      tempx /= .6609193;
      return tempx;
    }
    /**
    * see for example "Zwicker: Psychoakustik, 1982; ISBN 3-540-11401-7
    */


    function freq2bark(freq) {
      /* input: freq in hz output: barks */
      if (freq < 0) freq = 0;
      freq = freq * 0.001;
      return 13.0 * Math.atan(.76 * freq) + 3.5 * Math.atan(freq * freq / 56.25);
    }

    function init_numline(numlines, bo, bm, bval, bval_width, mld, bo_w, sfreq, blksize, scalepos, deltafreq, sbmax) {
      var b_frq = $97f850779472263e$var$new_float($cPNKB.CBANDS + 1);
      var sample_freq_frac = sfreq / (sbmax > 15 ? 1152 : 384);
      var partition = $97f850779472263e$var$new_int($cPNKB.HBLKSIZE);
      var i;
      sfreq /= blksize;
      var j = 0;
      var ni = 0;
      /* compute numlines, the number of spectral lines in each partition band */

      /* each partition band should be about DELBARK wide. */

      for (i = 0; i < $cPNKB.CBANDS; i++) {
        var bark1;
        var j2;
        bark1 = freq2bark(sfreq * j);
        b_frq[i] = sfreq * j;

        for (j2 = j; freq2bark(sfreq * j2) - bark1 < DELBARK && j2 <= blksize / 2; j2++);

        numlines[i] = j2 - j;
        ni = i + 1;

        while (j < j2) {
          $97f850779472263e$var$assert(j < $cPNKB.HBLKSIZE);
          partition[j++] = i;
        }

        if (j > blksize / 2) {
          j = blksize / 2;
          ++i;
          break;
        }
      }

      $97f850779472263e$var$assert(i < $cPNKB.CBANDS);
      b_frq[i] = sfreq * j;

      for (var sfb = 0; sfb < sbmax; sfb++) {
        var i1, i2, start, end;
        var arg;
        start = scalepos[sfb];
        end = scalepos[sfb + 1];
        i1 = 0 | Math.floor(.5 + deltafreq * (start - .5));
        if (i1 < 0) i1 = 0;
        i2 = 0 | Math.floor(.5 + deltafreq * (end - .5));
        if (i2 > blksize / 2) i2 = blksize / 2;
        bm[sfb] = (partition[i1] + partition[i2]) / 2;
        bo[sfb] = partition[i2];
        var f_tmp = sample_freq_frac * end;
        /*
        * calculate how much of this band belongs to current scalefactor
        * band
        */

        bo_w[sfb] = (f_tmp - b_frq[bo[sfb]]) / (b_frq[bo[sfb] + 1] - b_frq[bo[sfb]]);
        if (bo_w[sfb] < 0) bo_w[sfb] = 0;else if (bo_w[sfb] > 1) bo_w[sfb] = 1;
        /* setup stereo demasking thresholds */

        /* formula reverse enginerred from plot in paper */

        arg = freq2bark(sfreq * scalepos[sfb] * deltafreq);
        arg = Math.min(arg, 15.5) / 15.5;
        mld[sfb] = Math.pow(10.0, 1.25 * (1 - Math.cos(Math.PI * arg)) - 2.5);
      }
      /* compute bark values of each critical band */


      j = 0;

      for (var k = 0; k < ni; k++) {
        var w = numlines[k];
        var bark1, bark2;
        bark1 = freq2bark(sfreq * j);
        bark2 = freq2bark(sfreq * (j + w - 1));
        bval[k] = .5 * (bark1 + bark2);
        bark1 = freq2bark(sfreq * (j - .5));
        bark2 = freq2bark(sfreq * (j + w - .5));
        bval_width[k] = bark2 - bark1;
        j += w;
      }

      return ni;
    }

    function init_s3_values(s3ind, npart, bval, bval_width, norm, use_old_s3) {
      var s3 = $97f850779472263e$var$new_float_n([$cPNKB.CBANDS, $cPNKB.CBANDS]);
      /*
      * The s3 array is not linear in the bark scale.
      *
      * bval[x] should be used to get the bark value.
      */

      var j;
      var numberOfNoneZero = 0;
      /**
      * <PRE>
      * s[i][j], the value of the spreading function,
      * centered at band j (masker), for band i (maskee)
      *
      * i.e.: sum over j to spread into signal barkval=i
      * NOTE: i and j are used opposite as in the ISO docs
      * </PRE>
      */

      if (use_old_s3) {
        for (var i = 0; i < npart; i++) for (j = 0; j < npart; j++) {
          var v = s3_func(bval[i] - bval[j]) * bval_width[j];
          s3[i][j] = v * norm[i];
        }
      } else for (j = 0; j < npart; j++) {
        var hf_slope = 15 + Math.min(21 / bval[j], 12);
        var s3_x_norm = norm_s3_func_x(hf_slope);

        for (var i = 0; i < npart; i++) {
          var v = s3_x_norm * s3_func_x(bval[i] - bval[j], hf_slope) * bval_width[j];
          s3[i][j] = v * norm[i];
        }
      }

      for (var i = 0; i < npart; i++) {
        for (j = 0; j < npart; j++) {
          if (s3[i][j] > 0.0) break;
        }

        s3ind[i][0] = j;

        for (j = npart - 1; j > 0; j--) {
          if (s3[i][j] > 0.0) break;
        }

        s3ind[i][1] = j;
        numberOfNoneZero += s3ind[i][1] - s3ind[i][0] + 1;
      }

      var p = $97f850779472263e$var$new_float(numberOfNoneZero);
      var k = 0;

      for (var i = 0; i < npart; i++) for (j = s3ind[i][0]; j <= s3ind[i][1]; j++) p[k++] = s3[i][j];

      return p;
    }

    function stereo_demask(f) {
      /* setup stereo demasking thresholds */

      /* formula reverse enginerred from plot in paper */
      var arg = freq2bark(f);
      arg = Math.min(arg, 15.5) / 15.5;
      return Math.pow(10.0, 1.25 * (1 - Math.cos(Math.PI * arg)) - 2.5);
    }
    /**
    * NOTE: the bitrate reduction from the inter-channel masking effect is low
    * compared to the chance of getting annyoing artefacts. L3psycho_anal_vbr
    * does not use this feature. (Robert 071216)
    */


    this.psymodel_init = function (gfp) {
      var gfc = gfp.internal_flags;
      var i;
      var useOldS3 = true;
      var bvl_a = 13,
          bvl_b = 24;
      var snr_l_a = 0,
          snr_l_b = 0;
      var snr_s_a = -8.25,
          snr_s_b = -4.5;
      var bval = $97f850779472263e$var$new_float($cPNKB.CBANDS);
      var bval_width = $97f850779472263e$var$new_float($cPNKB.CBANDS);
      var norm = $97f850779472263e$var$new_float($cPNKB.CBANDS);
      var sfreq = gfp.out_samplerate;

      switch (gfp.experimentalZ) {
        default:
        case 0:
          useOldS3 = true;
          break;

        case 1:
          useOldS3 = gfp.VBR == $97f850779472263e$var$VbrMode.vbr_mtrh || gfp.VBR == $97f850779472263e$var$VbrMode.vbr_mt ? false : true;
          break;

        case 2:
          useOldS3 = false;
          break;

        case 3:
          bvl_a = 8;
          snr_l_a = -1.75;
          snr_l_b = -0.0125;
          snr_s_a = -8.25;
          snr_s_b = -2.25;
          break;
      }

      gfc.ms_ener_ratio_old = .25;
      gfc.blocktype_old[0] = gfc.blocktype_old[1] = $cPNKB.NORM_TYPE; // the vbr header is long blocks

      for (i = 0; i < 4; ++i) {
        for (var j = 0; j < $cPNKB.CBANDS; ++j) {
          gfc.nb_1[i][j] = 1e20;
          gfc.nb_2[i][j] = 1e20;
          gfc.nb_s1[i][j] = gfc.nb_s2[i][j] = 1.0;
        }

        for (var sb = 0; sb < $cPNKB.SBMAX_l; sb++) {
          gfc.en[i].l[sb] = 1e20;
          gfc.thm[i].l[sb] = 1e20;
        }

        for (var j = 0; j < 3; ++j) {
          for (var sb = 0; sb < $cPNKB.SBMAX_s; sb++) {
            gfc.en[i].s[sb][j] = 1e20;
            gfc.thm[i].s[sb][j] = 1e20;
          }

          gfc.nsPsy.lastAttacks[i] = 0;
        }

        for (var j = 0; j < 9; j++) gfc.nsPsy.last_en_subshort[i][j] = 10.;
      }
      /* init. for loudness approx. -jd 2001 mar 27 */


      gfc.loudness_sq_save[0] = gfc.loudness_sq_save[1] = 0.0;
      /*************************************************************************
      * now compute the psychoacoustic model specific constants
      ************************************************************************/

      /* compute numlines, bo, bm, bval, bval_width, mld */

      gfc.npart_l = init_numline(gfc.numlines_l, gfc.bo_l, gfc.bm_l, bval, bval_width, gfc.mld_l, gfc.PSY.bo_l_weight, sfreq, $cPNKB.BLKSIZE, gfc.scalefac_band.l, $cPNKB.BLKSIZE / 1152, $cPNKB.SBMAX_l);
      $97f850779472263e$var$assert(gfc.npart_l < $cPNKB.CBANDS);
      /* compute the spreading function */

      for (i = 0; i < gfc.npart_l; i++) {
        var snr = snr_l_a;
        if (bval[i] >= bvl_a) snr = snr_l_b * (bval[i] - bvl_a) / (bvl_b - bvl_a) + snr_l_a * (bvl_b - bval[i]) / (bvl_b - bvl_a);
        norm[i] = Math.pow(10.0, snr / 10.0);
        if (gfc.numlines_l[i] > 0) gfc.rnumlines_l[i] = 1.0 / gfc.numlines_l[i];else gfc.rnumlines_l[i] = 0;
      }

      gfc.s3_ll = init_s3_values(gfc.s3ind, gfc.npart_l, bval, bval_width, norm, useOldS3);
      /* compute long block specific values, ATH and MINVAL */

      var j = 0;

      for (i = 0; i < gfc.npart_l; i++) {
        var x;
        /* ATH */

        x = $97f850779472263e$var$Float.MAX_VALUE;

        for (var k = 0; k < gfc.numlines_l[i]; k++, j++) {
          var freq = sfreq * j / (1000.0 * $cPNKB.BLKSIZE);
          var level;
          /*
          * ATH below 100 Hz constant, not further climbing
          */

          level = this.ATHformula(freq * 1000, gfp) - 20; // scale to FFT units; returned value is in dB

          level = Math.pow(10., 0.1 * level); // convert from dB . energy

          level *= gfc.numlines_l[i];
          if (x > level) x = level;
        }

        gfc.ATH.cb_l[i] = x;
        /*
        * MINVAL. For low freq, the strength of the masking is limited by
        * minval this is an ISO MPEG1 thing, dont know if it is really
        * needed
        */

        /*
        * FIXME: it does work to reduce low-freq problems in S53-Wind-Sax
        * and lead-voice samples, but introduces some 3 kbps bit bloat too.
        * TODO: Further refinement of the shape of this hack.
        */

        x = -20 + bval[i] * 20 / 10;
        if (x > 6) x = 100;
        if (x < -15) x = -15;
        x -= 8.;
        gfc.minval_l[i] = Math.pow(10.0, x / 10.) * gfc.numlines_l[i];
      }
      /************************************************************************
      * do the same things for short blocks
      ************************************************************************/


      gfc.npart_s = init_numline(gfc.numlines_s, gfc.bo_s, gfc.bm_s, bval, bval_width, gfc.mld_s, gfc.PSY.bo_s_weight, sfreq, $cPNKB.BLKSIZE_s, gfc.scalefac_band.s, $cPNKB.BLKSIZE_s / 384, $cPNKB.SBMAX_s);
      $97f850779472263e$var$assert(gfc.npart_s < $cPNKB.CBANDS);
      /* SNR formula. short block is normalized by SNR. is it still right ? */

      j = 0;

      for (i = 0; i < gfc.npart_s; i++) {
        var x;
        var snr = snr_s_a;
        if (bval[i] >= bvl_a) snr = snr_s_b * (bval[i] - bvl_a) / (bvl_b - bvl_a) + snr_s_a * (bvl_b - bval[i]) / (bvl_b - bvl_a);
        norm[i] = Math.pow(10.0, snr / 10.0);
        /* ATH */

        x = $97f850779472263e$var$Float.MAX_VALUE;

        for (var k = 0; k < gfc.numlines_s[i]; k++, j++) {
          var freq = sfreq * j / (1000.0 * $cPNKB.BLKSIZE_s);
          var level;
          /* freq = Min(.1,freq); */

          /*
          * ATH below 100 Hz constant, not
          * further climbing
          */

          level = this.ATHformula(freq * 1000, gfp) - 20; // scale to FFT units; returned value is in dB

          level = Math.pow(10., 0.1 * level); // convert from dB . energy

          level *= gfc.numlines_s[i];
          if (x > level) x = level;
        }

        gfc.ATH.cb_s[i] = x;
        /*
        * MINVAL. For low freq, the strength of the masking is limited by
        * minval this is an ISO MPEG1 thing, dont know if it is really
        * needed
        */

        x = -7 + bval[i] * 7.0 / 12.0;
        if (bval[i] > 12) x *= 1 + Math.log(1 + x) * 3.1;
        if (bval[i] < 12) x *= 1 + Math.log(1 - x) * 2.3;
        if (x < -15) x = -15;
        x -= 8;
        gfc.minval_s[i] = Math.pow(10.0, x / 10) * gfc.numlines_s[i];
      }

      gfc.s3_ss = init_s3_values(gfc.s3ind_s, gfc.npart_s, bval, bval_width, norm, useOldS3);
      init_mask_add_max_values();
      fft.init_fft(gfc);
      /* setup temporal masking */

      gfc.decay = Math.exp(-1 * LOG10 / (temporalmask_sustain_sec * sfreq / 192.0));
      var msfix;
      msfix = NS_MSFIX;
      if ((gfp.exp_nspsytune & 2) != 0) msfix = 1.0;
      if (Math.abs(gfp.msfix) > 0.0) msfix = gfp.msfix;
      gfp.msfix = msfix;
      /*
      * spread only from npart_l bands. Normally, we use the spreading
      * function to convolve from npart_l down to npart_l bands
      */

      for (var b = 0; b < gfc.npart_l; b++) if (gfc.s3ind[b][1] > gfc.npart_l - 1) gfc.s3ind[b][1] = gfc.npart_l - 1;
      /*
      * prepare for ATH auto adjustment: we want to decrease the ATH by 12 dB
      * per second
      */


      var frame_duration = 576. * gfc.mode_gr / sfreq;
      gfc.ATH.decay = Math.pow(10., -1.2 * frame_duration);
      gfc.ATH.adjust = 0.01;
      /* minimum, for leading low loudness */

      gfc.ATH.adjustLimit = 1.0;
      /* on lead, allow adjust up to maximum */

      $97f850779472263e$var$assert(gfc.bo_l[$cPNKB.SBMAX_l - 1] <= gfc.npart_l);
      $97f850779472263e$var$assert(gfc.bo_s[$cPNKB.SBMAX_s - 1] <= gfc.npart_s);

      if (gfp.ATHtype != -1) {
        /* compute equal loudness weights (eql_w) */
        var freq;
        var freq_inc = gfp.out_samplerate / $cPNKB.BLKSIZE;
        var eql_balance = 0.0;
        freq = 0.0;

        for (i = 0; i < $cPNKB.BLKSIZE / 2; ++i) {
          /* convert ATH dB to relative power (not dB) */

          /* to determine eql_w */
          freq += freq_inc;
          gfc.ATH.eql_w[i] = 1. / Math.pow(10, this.ATHformula(freq, gfp) / 10);
          eql_balance += gfc.ATH.eql_w[i];
        }

        eql_balance = 1.0 / eql_balance;

        for (i = $cPNKB.BLKSIZE / 2; --i >= 0;) gfc.ATH.eql_w[i] *= eql_balance;
      }

      for (var b = j = 0; b < gfc.npart_s; ++b) for (i = 0; i < gfc.numlines_s[b]; ++i) ++j;

      $97f850779472263e$var$assert(j == 129);

      for (var b = j = 0; b < gfc.npart_l; ++b) for (i = 0; i < gfc.numlines_l[b]; ++i) ++j;

      $97f850779472263e$var$assert(j == 513);
      j = 0;

      for (i = 0; i < gfc.npart_l; i++) {
        var freq = sfreq * (j + gfc.numlines_l[i] / 2) / (1.0 * $cPNKB.BLKSIZE);
        gfc.mld_cb_l[i] = stereo_demask(freq);
        j += gfc.numlines_l[i];
      }

      for (; i < $cPNKB.CBANDS; ++i) gfc.mld_cb_l[i] = 1;

      j = 0;

      for (i = 0; i < gfc.npart_s; i++) {
        var freq = sfreq * (j + gfc.numlines_s[i] / 2) / (1.0 * $cPNKB.BLKSIZE_s);
        gfc.mld_cb_s[i] = stereo_demask(freq);
        j += gfc.numlines_s[i];
      }

      for (; i < $cPNKB.CBANDS; ++i) gfc.mld_cb_s[i] = 1;

      return 0;
    };
    /**
    * Those ATH formulas are returning their minimum value for input = -1
    */


    function ATHformula_GB(f, value) {
      /**
      * <PRE>
      *  from Painter & Spanias
      *           modified by Gabriel Bouvigne to better fit the reality
      *           ath =    3.640 * pow(f,-0.8)
      *           - 6.800 * exp(-0.6*pow(f-3.4,2.0))
      *           + 6.000 * exp(-0.15*pow(f-8.7,2.0))
      *           + 0.6* 0.001 * pow(f,4.0);
      *
      *
      *           In the past LAME was using the Painter &Spanias formula.
      *           But we had some recurrent problems with HF content.
      *           We measured real ATH values, and found the older formula
      *           to be inaccurate in the higher part. So we made this new
      *           formula and this solved most of HF problematic test cases.
      *           The tradeoff is that in VBR mode it increases a lot the
      *           bitrate.
      * </PRE>
      */

      /*
      * This curve can be adjusted according to the VBR scale: it adjusts
      * from something close to Painter & Spanias on V9 up to Bouvigne's
      * formula for V0. This way the VBR bitrate is more balanced according
      * to the -V value.
      */
      // the following Hack allows to ask for the lowest value
      if (f < -0.3) f = 3410; // convert to khz

      f /= 1000;
      f = Math.max(0.1, f);
      var ath = 3.640 * Math.pow(f, -0.8) - 6.800 * Math.exp(-0.6 * Math.pow(f - 3.4, 2.0)) + 6.000 * Math.exp(-0.15 * Math.pow(f - 8.7, 2.0)) + (0.6 + 0.04 * value) * 0.001 * Math.pow(f, 4.0);
      return ath;
    }

    this.ATHformula = function (f, gfp) {
      var ath;

      switch (gfp.ATHtype) {
        case 0:
          ath = ATHformula_GB(f, 9);
          break;

        case 1:
          // over sensitive, should probably be removed
          ath = ATHformula_GB(f, -1);
          break;

        case 2:
          ath = ATHformula_GB(f, 0);
          break;

        case 3:
          // modification of GB formula by Roel
          ath = ATHformula_GB(f, 1) + 6;
          break;

        case 4:
          ath = ATHformula_GB(f, gfp.ATHcurve);
          break;

        default:
          ath = ATHformula_GB(f, 0);
          break;
      }

      return ath;
    };
  }

  module.exports = $97f850779472263e$var$PsyModel;
});
parcelRequire.register("2g11P", function (module, exports) {
  var $3YDN3 = parcelRequire("3YDN3");
  $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  var $1a4ddf9b01454eb6$var$Util = $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $1a4ddf9b01454eb6$var$new_float = $3YDN3.new_float;
  $3YDN3.new_float_n;
  $3YDN3.new_int;
  $3YDN3.new_int_n;
  $3YDN3.assert;
  var $cPNKB = parcelRequire("cPNKB");

  function $1a4ddf9b01454eb6$var$FFT() {
    var window = $1a4ddf9b01454eb6$var$new_float($cPNKB.BLKSIZE);
    var window_s = $1a4ddf9b01454eb6$var$new_float($cPNKB.BLKSIZE_s / 2);
    var costab = [9.238795325112867e-01, 3.826834323650898e-01, 9.951847266721969e-01, 9.801714032956060e-02, 9.996988186962042e-01, 2.454122852291229e-02, 9.999811752826011e-01, 6.135884649154475e-03];

    function fht(fz, fzPos, n) {
      var tri = 0;
      var k4;
      var fi;
      var gi;
      n <<= 1;
      /* to get BLKSIZE, because of 3DNow! ASM routine */

      var fn = fzPos + n;
      k4 = 4;

      do {
        var s1, c1;
        var i, k1, k2, k3, kx;
        kx = k4 >> 1;
        k1 = k4;
        k2 = k4 << 1;
        k3 = k2 + k1;
        k4 = k2 << 1;
        fi = fzPos;
        gi = fi + kx;

        do {
          var f0, f1, f2, f3;
          f1 = fz[fi + 0] - fz[fi + k1];
          f0 = fz[fi + 0] + fz[fi + k1];
          f3 = fz[fi + k2] - fz[fi + k3];
          f2 = fz[fi + k2] + fz[fi + k3];
          fz[fi + k2] = f0 - f2;
          fz[fi + 0] = f0 + f2;
          fz[fi + k3] = f1 - f3;
          fz[fi + k1] = f1 + f3;
          f1 = fz[gi + 0] - fz[gi + k1];
          f0 = fz[gi + 0] + fz[gi + k1];
          f3 = $1a4ddf9b01454eb6$var$Util.SQRT2 * fz[gi + k3];
          f2 = $1a4ddf9b01454eb6$var$Util.SQRT2 * fz[gi + k2];
          fz[gi + k2] = f0 - f2;
          fz[gi + 0] = f0 + f2;
          fz[gi + k3] = f1 - f3;
          fz[gi + k1] = f1 + f3;
          gi += k4;
          fi += k4;
        } while (fi < fn);

        c1 = costab[tri + 0];
        s1 = costab[tri + 1];

        for (i = 1; i < kx; i++) {
          var c2, s2;
          c2 = 1 - 2 * s1 * s1;
          s2 = 2 * s1 * c1;
          fi = fzPos + i;
          gi = fzPos + k1 - i;

          do {
            var a, b, g0, f0, f1, g1, f2, g2, f3, g3;
            b = s2 * fz[fi + k1] - c2 * fz[gi + k1];
            a = c2 * fz[fi + k1] + s2 * fz[gi + k1];
            f1 = fz[fi + 0] - a;
            f0 = fz[fi + 0] + a;
            g1 = fz[gi + 0] - b;
            g0 = fz[gi + 0] + b;
            b = s2 * fz[fi + k3] - c2 * fz[gi + k3];
            a = c2 * fz[fi + k3] + s2 * fz[gi + k3];
            f3 = fz[fi + k2] - a;
            f2 = fz[fi + k2] + a;
            g3 = fz[gi + k2] - b;
            g2 = fz[gi + k2] + b;
            b = s1 * f2 - c1 * g3;
            a = c1 * f2 + s1 * g3;
            fz[fi + k2] = f0 - a;
            fz[fi + 0] = f0 + a;
            fz[gi + k3] = g1 - b;
            fz[gi + k1] = g1 + b;
            b = c1 * g2 - s1 * f3;
            a = s1 * g2 + c1 * f3;
            fz[gi + k2] = g0 - a;
            fz[gi + 0] = g0 + a;
            fz[fi + k3] = f1 - b;
            fz[fi + k1] = f1 + b;
            gi += k4;
            fi += k4;
          } while (fi < fn);

          c2 = c1;
          c1 = c2 * costab[tri + 0] - s1 * costab[tri + 1];
          s1 = c2 * costab[tri + 1] + s1 * costab[tri + 0];
        }

        tri += 2;
      } while (k4 < n);
    }

    var rv_tbl = [0x00, 0x80, 0x40, 0xc0, 0x20, 0xa0, 0x60, 0xe0, 0x10, 0x90, 0x50, 0xd0, 0x30, 0xb0, 0x70, 0xf0, 0x08, 0x88, 0x48, 0xc8, 0x28, 0xa8, 0x68, 0xe8, 0x18, 0x98, 0x58, 0xd8, 0x38, 0xb8, 0x78, 0xf8, 0x04, 0x84, 0x44, 0xc4, 0x24, 0xa4, 0x64, 0xe4, 0x14, 0x94, 0x54, 0xd4, 0x34, 0xb4, 0x74, 0xf4, 0x0c, 0x8c, 0x4c, 0xcc, 0x2c, 0xac, 0x6c, 0xec, 0x1c, 0x9c, 0x5c, 0xdc, 0x3c, 0xbc, 0x7c, 0xfc, 0x02, 0x82, 0x42, 0xc2, 0x22, 0xa2, 0x62, 0xe2, 0x12, 0x92, 0x52, 0xd2, 0x32, 0xb2, 0x72, 0xf2, 0x0a, 0x8a, 0x4a, 0xca, 0x2a, 0xaa, 0x6a, 0xea, 0x1a, 0x9a, 0x5a, 0xda, 0x3a, 0xba, 0x7a, 0xfa, 0x06, 0x86, 0x46, 0xc6, 0x26, 0xa6, 0x66, 0xe6, 0x16, 0x96, 0x56, 0xd6, 0x36, 0xb6, 0x76, 0xf6, 0x0e, 0x8e, 0x4e, 0xce, 0x2e, 0xae, 0x6e, 0xee, 0x1e, 0x9e, 0x5e, 0xde, 0x3e, 0xbe, 0x7e, 0xfe];

    this.fft_short = function (gfc, x_real, chn, buffer, bufPos) {
      for (var b = 0; b < 3; b++) {
        var x = $cPNKB.BLKSIZE_s / 2;
        var k = 0xffff & 192 * (b + 1);
        var j = $cPNKB.BLKSIZE_s / 8 - 1;

        do {
          var f0, f1, f2, f3, w;
          var i = rv_tbl[j << 2] & 0xff;
          f0 = window_s[i] * buffer[chn][bufPos + i + k];
          w = window_s[0x7f - i] * buffer[chn][bufPos + i + k + 0x80];
          f1 = f0 - w;
          f0 = f0 + w;
          f2 = window_s[i + 0x40] * buffer[chn][bufPos + i + k + 0x40];
          w = window_s[0x3f - i] * buffer[chn][bufPos + i + k + 0xc0];
          f3 = f2 - w;
          f2 = f2 + w;
          x -= 4;
          x_real[b][x + 0] = f0 + f2;
          x_real[b][x + 2] = f0 - f2;
          x_real[b][x + 1] = f1 + f3;
          x_real[b][x + 3] = f1 - f3;
          f0 = window_s[i + 0x01] * buffer[chn][bufPos + i + k + 0x01];
          w = window_s[0x7e - i] * buffer[chn][bufPos + i + k + 0x81];
          f1 = f0 - w;
          f0 = f0 + w;
          f2 = window_s[i + 0x41] * buffer[chn][bufPos + i + k + 0x41];
          w = window_s[0x3e - i] * buffer[chn][bufPos + i + k + 0xc1];
          f3 = f2 - w;
          f2 = f2 + w;
          x_real[b][x + $cPNKB.BLKSIZE_s / 2 + 0] = f0 + f2;
          x_real[b][x + $cPNKB.BLKSIZE_s / 2 + 2] = f0 - f2;
          x_real[b][x + $cPNKB.BLKSIZE_s / 2 + 1] = f1 + f3;
          x_real[b][x + $cPNKB.BLKSIZE_s / 2 + 3] = f1 - f3;
        } while (--j >= 0);

        fht(x_real[b], x, $cPNKB.BLKSIZE_s / 2);
        /* BLKSIZE_s/2 because of 3DNow! ASM routine */

        /* BLKSIZE/2 because of 3DNow! ASM routine */
      }
    };

    this.fft_long = function (gfc, y, chn, buffer, bufPos) {
      var jj = $cPNKB.BLKSIZE / 8 - 1;
      var x = $cPNKB.BLKSIZE / 2;

      do {
        var f0, f1, f2, f3, w;
        var i = rv_tbl[jj] & 0xff;
        f0 = window[i] * buffer[chn][bufPos + i];
        w = window[i + 0x200] * buffer[chn][bufPos + i + 0x200];
        f1 = f0 - w;
        f0 = f0 + w;
        f2 = window[i + 0x100] * buffer[chn][bufPos + i + 0x100];
        w = window[i + 0x300] * buffer[chn][bufPos + i + 0x300];
        f3 = f2 - w;
        f2 = f2 + w;
        x -= 4;
        y[x + 0] = f0 + f2;
        y[x + 2] = f0 - f2;
        y[x + 1] = f1 + f3;
        y[x + 3] = f1 - f3;
        f0 = window[i + 0x001] * buffer[chn][bufPos + i + 0x001];
        w = window[i + 0x201] * buffer[chn][bufPos + i + 0x201];
        f1 = f0 - w;
        f0 = f0 + w;
        f2 = window[i + 0x101] * buffer[chn][bufPos + i + 0x101];
        w = window[i + 0x301] * buffer[chn][bufPos + i + 0x301];
        f3 = f2 - w;
        f2 = f2 + w;
        y[x + $cPNKB.BLKSIZE / 2 + 0] = f0 + f2;
        y[x + $cPNKB.BLKSIZE / 2 + 2] = f0 - f2;
        y[x + $cPNKB.BLKSIZE / 2 + 1] = f1 + f3;
        y[x + $cPNKB.BLKSIZE / 2 + 3] = f1 - f3;
      } while (--jj >= 0);

      fht(y, x, $cPNKB.BLKSIZE / 2);
      /* BLKSIZE/2 because of 3DNow! ASM routine */
    };

    this.init_fft = function (gfc) {
      /* The type of window used here will make no real difference, but */

      /*
      * in the interest of merging nspsytune stuff - switch to blackman
      * window
      */
      for (var i = 0; i < $cPNKB.BLKSIZE; i++)
      /* blackman window */
      window[i] = 0.42 - 0.5 * Math.cos(2 * Math.PI * (i + .5) / $cPNKB.BLKSIZE) + 0.08 * Math.cos(4 * Math.PI * (i + .5) / $cPNKB.BLKSIZE);

      for (var i = 0; i < $cPNKB.BLKSIZE_s / 2; i++) window_s[i] = 0.5 * (1.0 - Math.cos(2.0 * Math.PI * (i + 0.5) / $cPNKB.BLKSIZE_s));
    };
  }

  module.exports = $1a4ddf9b01454eb6$var$FFT;
});
parcelRequire.register("cPNKB", function (module, exports) {
  var $3YDN3 = parcelRequire("3YDN3");
  var $9580d6e047027232$var$System = $3YDN3.System;
  var $9580d6e047027232$var$VbrMode = $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  var $9580d6e047027232$var$new_array_n = $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $9580d6e047027232$var$new_float = $3YDN3.new_float;
  var $9580d6e047027232$var$new_float_n = $3YDN3.new_float_n;
  var $9580d6e047027232$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  var $9580d6e047027232$var$assert = $3YDN3.assert;
  /**
  * ENCDELAY The encoder delay.
  *
  * Minimum allowed is MDCTDELAY (see below)
  *
  * The first 96 samples will be attenuated, so using a value less than 96
  * will result in corrupt data for the first 96-ENCDELAY samples.
  *
  * suggested: 576 set to 1160 to sync with FhG.
  */

  $9580d6e047027232$var$Encoder.ENCDELAY = 576;
  /**
  * make sure there is at least one complete frame after the last frame
  * containing real data
  *
  * Using a value of 288 would be sufficient for a a very sophisticated
  * decoder that can decode granule-by-granule instead of frame by frame. But
  * lets not assume this, and assume the decoder will not decode frame N
  * unless it also has data for frame N+1
  */

  $9580d6e047027232$var$Encoder.POSTDELAY = 1152;
  /**
  * delay of the MDCT used in mdct.c original ISO routines had a delay of
  * 528! Takehiro's routines:
  */

  $9580d6e047027232$var$Encoder.MDCTDELAY = 48;
  $9580d6e047027232$var$Encoder.FFTOFFSET = 224 + $9580d6e047027232$var$Encoder.MDCTDELAY;
  /**
  * Most decoders, including the one we use, have a delay of 528 samples.
  */

  $9580d6e047027232$var$Encoder.DECDELAY = 528;
  /**
  * number of subbands
  */

  $9580d6e047027232$var$Encoder.SBLIMIT = 32;
  /**
  * parition bands bands
  */

  $9580d6e047027232$var$Encoder.CBANDS = 64;
  /**
  * number of critical bands/scale factor bands where masking is computed
  */

  $9580d6e047027232$var$Encoder.SBPSY_l = 21;
  $9580d6e047027232$var$Encoder.SBPSY_s = 12;
  /**
  * total number of scalefactor bands encoded
  */

  $9580d6e047027232$var$Encoder.SBMAX_l = 22;
  $9580d6e047027232$var$Encoder.SBMAX_s = 13;
  $9580d6e047027232$var$Encoder.PSFB21 = 6;
  $9580d6e047027232$var$Encoder.PSFB12 = 6;
  /**
  * FFT sizes
  */

  $9580d6e047027232$var$Encoder.BLKSIZE = 1024;
  $9580d6e047027232$var$Encoder.HBLKSIZE = $9580d6e047027232$var$Encoder.BLKSIZE / 2 + 1;
  $9580d6e047027232$var$Encoder.BLKSIZE_s = 256;
  $9580d6e047027232$var$Encoder.HBLKSIZE_s = $9580d6e047027232$var$Encoder.BLKSIZE_s / 2 + 1;
  $9580d6e047027232$var$Encoder.NORM_TYPE = 0;
  $9580d6e047027232$var$Encoder.START_TYPE = 1;
  $9580d6e047027232$var$Encoder.SHORT_TYPE = 2;
  $9580d6e047027232$var$Encoder.STOP_TYPE = 3;
  /**
  * <PRE>
  * Mode Extention:
  * When we are in stereo mode, there are 4 possible methods to store these
  * two channels. The stereo modes -m? are using a subset of them.
  *
  *  -ms: MPG_MD_LR_LR
  *  -mj: MPG_MD_LR_LR and MPG_MD_MS_LR
  *  -mf: MPG_MD_MS_LR
  *  -mi: all
  * </PRE>
  */

  $9580d6e047027232$var$Encoder.MPG_MD_LR_LR = 0;
  $9580d6e047027232$var$Encoder.MPG_MD_LR_I = 1;
  $9580d6e047027232$var$Encoder.MPG_MD_MS_LR = 2;
  $9580d6e047027232$var$Encoder.MPG_MD_MS_I = 3;
  $9580d6e047027232$var$Encoder.fircoef = [-0.1039435, -0.1892065, -0.0432472 * 5, -0.155915, 7.79609e-18 * 5, 0.0467745 * 5, 0.50455, 0.756825, 0.187098 * 5];

  function $9580d6e047027232$var$Encoder() {
    var NewMDCT = parcelRequire("drj3v");
    var III_psy_ratio = parcelRequire("hvy40");
    var MPEGMode = parcelRequire("jL6I1");
    var FFTOFFSET = $9580d6e047027232$var$Encoder.FFTOFFSET;
    var MPG_MD_MS_LR = $9580d6e047027232$var$Encoder.MPG_MD_MS_LR; //BitStream bs;
    //PsyModel psy;
    //VBRTag vbr;
    //QuantizePVT qupvt;

    var bs = null;
    this.psy = null;
    var psy = null;
    var vbr = null;
    var qupvt = null; //public final void setModules(BitStream bs, PsyModel psy, QuantizePVT qupvt,
    //    VBRTag vbr) {

    this.setModules = function (_bs, _psy, _qupvt, _vbr) {
      bs = _bs;
      this.psy = _psy;
      psy = _psy;
      vbr = _vbr;
      qupvt = _qupvt;
    };

    var newMDCT = new NewMDCT();
    /***********************************************************************
    *
    * encoder and decoder delays
    *
    ***********************************************************************/

    /**
    * <PRE>
    * layer III enc->dec delay:  1056 (1057?)   (observed)
    * layer  II enc->dec delay:   480  (481?)   (observed)
    *
    * polyphase 256-16             (dec or enc)        = 240
    * mdct      256+32  (9*32)     (dec or enc)        = 288
    * total:    512+16
    *
    * My guess is that delay of polyphase filterbank is actualy 240.5
    * (there are technical reasons for this, see postings in mp3encoder).
    * So total Encode+Decode delay = ENCDELAY + 528 + 1
    * </PRE>
    */

    /**
    * auto-adjust of ATH, useful for low volume Gabriel Bouvigne 3 feb 2001
    *
    * modifies some values in gfp.internal_flags.ATH (gfc.ATH)
    */
    //private void adjust_ATH(final LameInternalFlags gfc) {

    function adjust_ATH(gfc) {
      var gr2_max, max_pow;

      if (gfc.ATH.useAdjust == 0) {
        gfc.ATH.adjust = 1.0;
        /* no adjustment */

        return;
      }
      /* jd - 2001 mar 12, 27, jun 30 */

      /* loudness based on equal loudness curve; */

      /* use granule with maximum combined loudness */


      max_pow = gfc.loudness_sq[0][0];
      gr2_max = gfc.loudness_sq[1][0];

      if (gfc.channels_out == 2) {
        max_pow += gfc.loudness_sq[0][1];
        gr2_max += gfc.loudness_sq[1][1];
      } else {
        max_pow += max_pow;
        gr2_max += gr2_max;
      }

      if (gfc.mode_gr == 2) max_pow = Math.max(max_pow, gr2_max);
      max_pow *= 0.5;
      /* max_pow approaches 1.0 for full band noise */

      /* jd - 2001 mar 31, jun 30 */

      /* user tuning of ATH adjustment region */

      max_pow *= gfc.ATH.aaSensitivityP;
      /*
      * adjust ATH depending on range of maximum value
      */

      /* jd - 2001 feb27, mar12,20, jun30, jul22 */

      /* continuous curves based on approximation */

      /* to GB's original values. */

      /* For an increase in approximate loudness, */

      /* set ATH adjust to adjust_limit immediately */

      /* after a delay of one frame. */

      /* For a loudness decrease, reduce ATH adjust */

      /* towards adjust_limit gradually. */

      /* max_pow is a loudness squared or a power. */

      if (max_pow > 0.03125) {
        if (gfc.ATH.adjust >= 1.0) gfc.ATH.adjust = 1.0;else
          /* preceding frame has lower ATH adjust; */

          /* ascend only to the preceding adjust_limit */

          /* in case there is leading low volume */
          if (gfc.ATH.adjust < gfc.ATH.adjustLimit) gfc.ATH.adjust = gfc.ATH.adjustLimit;
        gfc.ATH.adjustLimit = 1.0;
      } else {
        /* about 32 dB maximum adjust (0.000625) */
        var adj_lim_new = 31.98 * max_pow + 0.000625;

        if (gfc.ATH.adjust >= adj_lim_new) {
          gfc.ATH.adjust *= adj_lim_new * 0.075 + 0.925;
          if (gfc.ATH.adjust < adj_lim_new) gfc.ATH.adjust = adj_lim_new;
        } else {
          if (gfc.ATH.adjustLimit >= adj_lim_new) gfc.ATH.adjust = adj_lim_new;else
            /* preceding frame has lower ATH adjust; */

            /* ascend only to the preceding adjust_limit */
            if (gfc.ATH.adjust < gfc.ATH.adjustLimit) gfc.ATH.adjust = gfc.ATH.adjustLimit;
        }

        gfc.ATH.adjustLimit = adj_lim_new;
      }
    }
    /**
    * <PRE>
    *  some simple statistics
    *
    *  bitrate index 0: free bitrate . not allowed in VBR mode
    *  : bitrates, kbps depending on MPEG version
    *  bitrate index 15: forbidden
    *
    *  mode_ext:
    *  0:  LR
    *  1:  LR-i
    *  2:  MS
    *  3:  MS-i
    * </PRE>
    */


    function updateStats(gfc) {
      var gr, ch;
      $9580d6e047027232$var$assert(0 <= gfc.bitrate_index && gfc.bitrate_index < 16);
      $9580d6e047027232$var$assert(0 <= gfc.mode_ext && gfc.mode_ext < 4);
      /* count bitrate indices */

      gfc.bitrate_stereoMode_Hist[gfc.bitrate_index][4]++;
      gfc.bitrate_stereoMode_Hist[15][4]++;
      /* count 'em for every mode extension in case of 2 channel encoding */

      if (gfc.channels_out == 2) {
        gfc.bitrate_stereoMode_Hist[gfc.bitrate_index][gfc.mode_ext]++;
        gfc.bitrate_stereoMode_Hist[15][gfc.mode_ext]++;
      }

      for (gr = 0; gr < gfc.mode_gr; ++gr) for (ch = 0; ch < gfc.channels_out; ++ch) {
        var bt = gfc.l3_side.tt[gr][ch].block_type | 0;
        if (gfc.l3_side.tt[gr][ch].mixed_block_flag != 0) bt = 4;
        gfc.bitrate_blockType_Hist[gfc.bitrate_index][bt]++;
        gfc.bitrate_blockType_Hist[gfc.bitrate_index][5]++;
        gfc.bitrate_blockType_Hist[15][bt]++;
        gfc.bitrate_blockType_Hist[15][5]++;
      }
    }

    function lame_encode_frame_init(gfp, inbuf) {
      var gfc = gfp.internal_flags;
      var ch, gr;

      if (gfc.lame_encode_frame_init == 0) {
        /* prime the MDCT/polyphase filterbank with a short block */
        var i, j;
        var primebuff0 = $9580d6e047027232$var$new_float(2014);
        var primebuff1 = $9580d6e047027232$var$new_float(2014);
        gfc.lame_encode_frame_init = 1;

        for (i = 0, j = 0; i < 286 + 576 * (1 + gfc.mode_gr); ++i) if (i < 576 * gfc.mode_gr) {
          primebuff0[i] = 0;
          if (gfc.channels_out == 2) primebuff1[i] = 0;
        } else {
          primebuff0[i] = inbuf[0][j];
          if (gfc.channels_out == 2) primebuff1[i] = inbuf[1][j];
          ++j;
        }
        /* polyphase filtering / mdct */


        for (gr = 0; gr < gfc.mode_gr; gr++) for (ch = 0; ch < gfc.channels_out; ch++) gfc.l3_side.tt[gr][ch].block_type = $9580d6e047027232$var$Encoder.SHORT_TYPE;

        newMDCT.mdct_sub48(gfc, primebuff0, primebuff1);
        /* check FFT will not use a negative starting offset */

        $9580d6e047027232$var$assert(576 >= $9580d6e047027232$var$Encoder.FFTOFFSET);
        /* check if we have enough data for FFT */

        $9580d6e047027232$var$assert(gfc.mf_size >= $9580d6e047027232$var$Encoder.BLKSIZE + gfp.framesize - $9580d6e047027232$var$Encoder.FFTOFFSET);
        /* check if we have enough data for polyphase filterbank */

        $9580d6e047027232$var$assert(gfc.mf_size >= 512 + gfp.framesize - 32);
      }
    }
    /**
    * <PRE>
    * encodeframe()           Layer 3
    *
    * encode a single frame
    *
    *
    *    lame_encode_frame()
    *
    *
    *                           gr 0            gr 1
    *    inbuf:           |--------------|--------------|--------------|
    *
    *
    *    Polyphase (18 windows, each shifted 32)
    *    gr 0:
    *    window1          <----512---.
    *    window18                 <----512---.
    *
    *    gr 1:
    *    window1                         <----512---.
    *    window18                                <----512---.
    *
    *
    *
    *    MDCT output:  |--------------|--------------|--------------|
    *
    *    FFT's                    <---------1024---------.
    *                                             <---------1024-------.
    *
    *
    *
    *        inbuf = buffer of PCM data size=MP3 framesize
    *        encoder acts on inbuf[ch][0], but output is delayed by MDCTDELAY
    *        so the MDCT coefficints are from inbuf[ch][-MDCTDELAY]
    *
    *        psy-model FFT has a 1 granule delay, so we feed it data for the
    *        next granule.
    *        FFT is centered over granule:  224+576+224
    *        So FFT starts at:   576-224-MDCTDELAY
    *
    *        MPEG2:  FFT ends at:  BLKSIZE+576-224-MDCTDELAY      (1328)
    *        MPEG1:  FFT ends at:  BLKSIZE+2*576-224-MDCTDELAY    (1904)
    *
    *        MPEG2:  polyphase first window:  [0..511]
    *                          18th window:   [544..1055]          (1056)
    *        MPEG1:            36th window:   [1120..1631]         (1632)
    *                data needed:  512+framesize-32
    *
    *        A close look newmdct.c shows that the polyphase filterbank
    *        only uses data from [0..510] for each window.  Perhaps because the window
    *        used by the filterbank is zero for the last point, so Takehiro's
    *        code doesn't bother to compute with it.
    *
    *        FFT starts at 576-224-MDCTDELAY (304)  = 576-FFTOFFSET
    *
    * </PRE>
    */


    this.lame_encode_mp3_frame = function (gfp, inbuf_l, inbuf_r, mp3buf, mp3bufPos, mp3buf_size) {
      var mp3count;
      var masking_LR = $9580d6e047027232$var$new_array_n([2, 2]);
      /*
      * LR masking &
      * energy
      */

      masking_LR[0][0] = new III_psy_ratio();
      masking_LR[0][1] = new III_psy_ratio();
      masking_LR[1][0] = new III_psy_ratio();
      masking_LR[1][1] = new III_psy_ratio();
      var masking_MS = $9580d6e047027232$var$new_array_n([2, 2]);
      /* MS masking & energy */

      masking_MS[0][0] = new III_psy_ratio();
      masking_MS[0][1] = new III_psy_ratio();
      masking_MS[1][0] = new III_psy_ratio();
      masking_MS[1][1] = new III_psy_ratio(); //III_psy_ratio masking[][];

      var masking;
      /* pointer to selected maskings */

      var inbuf = [null, null];
      var gfc = gfp.internal_flags;
      var tot_ener = $9580d6e047027232$var$new_float_n([2, 4]);
      var ms_ener_ratio = [.5, .5];
      var pe = [[0., 0.], [0., 0.]];
      var pe_MS = [[0., 0.], [0., 0.]]; //float[][] pe_use;

      var pe_use;
      var ch, gr;
      inbuf[0] = inbuf_l;
      inbuf[1] = inbuf_r;
      if (gfc.lame_encode_frame_init == 0)
        /* first run? */
        lame_encode_frame_init(gfp, inbuf);
      /********************** padding *****************************/

      /**
      * <PRE>
      * padding method as described in
      * "MPEG-Layer3 / Bitstream Syntax and Decoding"
      * by Martin Sieler, Ralph Sperschneider
      *
      * note: there is no padding for the very first frame
      *
      * Robert Hegemann 2000-06-22
      * </PRE>
      */

      gfc.padding = 0;

      if ((gfc.slot_lag -= gfc.frac_SpF) < 0) {
        gfc.slot_lag += gfp.out_samplerate;
        gfc.padding = 1;
      }
      /****************************************
      * Stage 1: psychoacoustic model *
      ****************************************/


      if (gfc.psymodel != 0) {
        /*
        * psychoacoustic model psy model has a 1 granule (576) delay that
        * we must compensate for (mt 6/99).
        */
        var ret;
        var bufp = [null, null];
        /* address of beginning of left & right granule */

        var bufpPos = 0;
        /* address of beginning of left & right granule */

        var blocktype = $9580d6e047027232$var$new_int(2);

        for (gr = 0; gr < gfc.mode_gr; gr++) {
          for (ch = 0; ch < gfc.channels_out; ch++) {
            bufp[ch] = inbuf[ch];
            bufpPos = 576 + gr * 576 - $9580d6e047027232$var$Encoder.FFTOFFSET;
          }

          if (gfp.VBR == $9580d6e047027232$var$VbrMode.vbr_mtrh || gfp.VBR == $9580d6e047027232$var$VbrMode.vbr_mt) ret = psy.L3psycho_anal_vbr(gfp, bufp, bufpPos, gr, masking_LR, masking_MS, pe[gr], pe_MS[gr], tot_ener[gr], blocktype);else ret = psy.L3psycho_anal_ns(gfp, bufp, bufpPos, gr, masking_LR, masking_MS, pe[gr], pe_MS[gr], tot_ener[gr], blocktype);
          if (ret != 0) return -4;

          if (gfp.mode == MPEGMode.JOINT_STEREO) {
            ms_ener_ratio[gr] = tot_ener[gr][2] + tot_ener[gr][3];
            if (ms_ener_ratio[gr] > 0) ms_ener_ratio[gr] = tot_ener[gr][3] / ms_ener_ratio[gr];
          }
          /* block type flags */


          for (ch = 0; ch < gfc.channels_out; ch++) {
            var cod_info = gfc.l3_side.tt[gr][ch];
            cod_info.block_type = blocktype[ch];
            cod_info.mixed_block_flag = 0;
          }
        }
      } else {
        /* no psy model */
        for (gr = 0; gr < gfc.mode_gr; gr++) for (ch = 0; ch < gfc.channels_out; ch++) {
          gfc.l3_side.tt[gr][ch].block_type = $9580d6e047027232$var$Encoder.NORM_TYPE;
          gfc.l3_side.tt[gr][ch].mixed_block_flag = 0;
          pe_MS[gr][ch] = pe[gr][ch] = 700;
        }
      }
      /* auto-adjust of ATH, useful for low volume */


      adjust_ATH(gfc);
      /****************************************
      * Stage 2: MDCT *
      ****************************************/

      /* polyphase filtering / mdct */

      newMDCT.mdct_sub48(gfc, inbuf[0], inbuf[1]);
      /****************************************
      * Stage 3: MS/LR decision *
      ****************************************/

      /* Here will be selected MS or LR coding of the 2 stereo channels */

      gfc.mode_ext = $9580d6e047027232$var$Encoder.MPG_MD_LR_LR;
      if (gfp.force_ms) gfc.mode_ext = $9580d6e047027232$var$Encoder.MPG_MD_MS_LR;else if (gfp.mode == MPEGMode.JOINT_STEREO) {
        /*
        * ms_ratio = is scaled, for historical reasons, to look like a
        * ratio of side_channel / total. 0 = signal is 100% mono .5 = L & R
        * uncorrelated
        */

        /**
        * <PRE>
        * [0] and [1] are the results for the two granules in MPEG-1,
        * in MPEG-2 it's only a faked averaging of the same value
        * _prev is the value of the last granule of the previous frame
        * _next is the value of the first granule of the next frame
        * </PRE>
        */
        var sum_pe_MS = 0.;
        var sum_pe_LR = 0.;

        for (gr = 0; gr < gfc.mode_gr; gr++) for (ch = 0; ch < gfc.channels_out; ch++) {
          sum_pe_MS += pe_MS[gr][ch];
          sum_pe_LR += pe[gr][ch];
        }
        /* based on PE: M/S coding would not use much more bits than L/R */


        if (sum_pe_MS <= 1.00 * sum_pe_LR) {
          var gi0 = gfc.l3_side.tt[0];
          var gi1 = gfc.l3_side.tt[gfc.mode_gr - 1];
          if (gi0[0].block_type == gi0[1].block_type && gi1[0].block_type == gi1[1].block_type) gfc.mode_ext = $9580d6e047027232$var$Encoder.MPG_MD_MS_LR;
        }
      }
      /* bit and noise allocation */

      if (gfc.mode_ext == MPG_MD_MS_LR) {
        masking = masking_MS;
        /* use MS masking */

        pe_use = pe_MS;
      } else {
        masking = masking_LR;
        /* use LR masking */

        pe_use = pe;
      }
      /* copy data for MP3 frame analyzer */


      if (gfp.analysis && gfc.pinfo != null) {
        for (gr = 0; gr < gfc.mode_gr; gr++) for (ch = 0; ch < gfc.channels_out; ch++) {
          gfc.pinfo.ms_ratio[gr] = gfc.ms_ratio[gr];
          gfc.pinfo.ms_ener_ratio[gr] = ms_ener_ratio[gr];
          gfc.pinfo.blocktype[gr][ch] = gfc.l3_side.tt[gr][ch].block_type;
          gfc.pinfo.pe[gr][ch] = pe_use[gr][ch];
          $9580d6e047027232$var$System.arraycopy(gfc.l3_side.tt[gr][ch].xr, 0, gfc.pinfo.xr[gr][ch], 0, 576);
          /*
          * in psymodel, LR and MS data was stored in pinfo. switch
          * to MS data:
          */

          if (gfc.mode_ext == MPG_MD_MS_LR) {
            gfc.pinfo.ers[gr][ch] = gfc.pinfo.ers[gr][ch + 2];
            $9580d6e047027232$var$System.arraycopy(gfc.pinfo.energy[gr][ch + 2], 0, gfc.pinfo.energy[gr][ch], 0, gfc.pinfo.energy[gr][ch].length);
          }
        }
      }
      /****************************************
      * Stage 4: quantization loop *
      ****************************************/


      if (gfp.VBR == $9580d6e047027232$var$VbrMode.vbr_off || gfp.VBR == $9580d6e047027232$var$VbrMode.vbr_abr) {
        var i;
        var f;

        for (i = 0; i < 18; i++) gfc.nsPsy.pefirbuf[i] = gfc.nsPsy.pefirbuf[i + 1];

        f = 0.0;

        for (gr = 0; gr < gfc.mode_gr; gr++) for (ch = 0; ch < gfc.channels_out; ch++) f += pe_use[gr][ch];

        gfc.nsPsy.pefirbuf[18] = f;
        f = gfc.nsPsy.pefirbuf[9];

        for (i = 0; i < 9; i++) f += (gfc.nsPsy.pefirbuf[i] + gfc.nsPsy.pefirbuf[18 - i]) * $9580d6e047027232$var$Encoder.fircoef[i];

        f = 3350 * gfc.mode_gr * gfc.channels_out / f;

        for (gr = 0; gr < gfc.mode_gr; gr++) for (ch = 0; ch < gfc.channels_out; ch++) pe_use[gr][ch] *= f;
      }

      gfc.iteration_loop.iteration_loop(gfp, pe_use, ms_ener_ratio, masking);
      /****************************************
      * Stage 5: bitstream formatting *
      ****************************************/

      /* write the frame to the bitstream */

      bs.format_bitstream(gfp);
      /* copy mp3 bit buffer into array */

      mp3count = bs.copy_buffer(gfc, mp3buf, mp3bufPos, mp3buf_size, 1);
      if (gfp.bWriteVbrTag) vbr.addVbrFrame(gfp);

      if (gfp.analysis && gfc.pinfo != null) {
        for (ch = 0; ch < gfc.channels_out; ch++) {
          var j;

          for (j = 0; j < FFTOFFSET; j++) gfc.pinfo.pcmdata[ch][j] = gfc.pinfo.pcmdata[ch][j + gfp.framesize];

          for (j = FFTOFFSET; j < 1600; j++) gfc.pinfo.pcmdata[ch][j] = inbuf[ch][j - FFTOFFSET];
        }

        qupvt.set_frame_pinfo(gfp, masking);
      }

      updateStats(gfc);
      return mp3count;
    };
  }

  module.exports = $9580d6e047027232$var$Encoder;
});
parcelRequire.register("drj3v", function (module, exports) {
  /*
  *      MP3 window subband -> subband filtering -> mdct routine
  *
  *      Copyright (c) 1999-2000 Takehiro Tominaga
  *
  *
  * This library is free software; you can redistribute it and/or
  * modify it under the terms of the GNU Lesser General Public
  * License as published by the Free Software Foundation; either
  * version 2 of the License, or (at your option) any later version.
  *
  * This library is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * Library General Public License for more details.
  *
  * You should have received a copy of the GNU Library General Public
  * License along with this library; if not, write to the
  * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
  * Boston, MA 02111-1307, USA.
  */

  /*
  *         Special Thanks to Patrick De Smet for your advices.
  */

  /* $Id: NewMDCT.java,v 1.11 2011/05/24 20:48:06 kenchis Exp $ */
  //package mp3;
  //import java.util.Arrays;
  var $3YDN3 = parcelRequire("3YDN3");
  var $9c8c9409243421ca$var$System = $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  var $9c8c9409243421ca$var$Util = $3YDN3.Util;
  var $9c8c9409243421ca$var$Arrays = $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $9c8c9409243421ca$var$new_float = $3YDN3.new_float;
  $3YDN3.new_float_n;
  $3YDN3.new_int;
  $3YDN3.new_int_n;
  $3YDN3.assert;
  var $cPNKB = parcelRequire("cPNKB");

  function $9c8c9409243421ca$var$NewMDCT() {
    var enwindow = [-0.1482523854003001, 32.308141959636465, 296.40344946382766, 883.1344870032432, 11113.947376231741, 1057.2713659324597, 305.7402417275812, 30.825928907280012,
    /* 15 */
    3.8533188138216365, 59.42900443849514, 709.5899960123345, 5281.91112291017, -5829.66483675846, -817.6293103748613, -76.91656988279972, -4.594269939176596, 9.063471690191471e-01, 1.960342806591213e-01, -0.15466694054279598, 34.324387823855965, 301.8067566458425, 817.599602898885, 11573.795901679885, 1181.2520595540152, 321.59731579894424, 31.232021761053772,
    /* 14 */
    3.7107095756221318, 53.650946155329365, 684.167428119626, 5224.56624370173, -6366.391851890084, -908.9766368219582, -89.83068876699639, -5.411397422890401, 8.206787908286602e-01, 3.901806440322567e-01, -0.16070888947830023, 36.147034243915876, 304.11815768187864, 732.7429163887613, 11989.60988270091, 1300.012278487897, 335.28490093152146, 31.48816102859945,
    /* 13 */
    3.373875931311736, 47.232241542899175, 652.7371796173471, 5132.414255594984, -6909.087078780055, -1001.9990371107289, -103.62185754286375, -6.104916304710272, 7.416505462720353e-01, 5.805693545089249e-01, -0.16636367662261495, 37.751650073343995, 303.01103387567713, 627.9747488785183, 12358.763425278165, 1412.2779918482834, 346.7496836825721, 31.598286663170416,
    /* 12 */
    3.1598635433980946, 40.57878626349686, 616.1671130880391, 5007.833007176154, -7454.040671756168, -1095.7960341867115, -118.24411666465777, -6.818469345853504, 6.681786379192989e-01, 7.653668647301797e-01, -0.1716176790982088, 39.11551877123304, 298.3413246578966, 503.5259106886539, 12679.589408408976, 1516.5821921214542, 355.9850766329023, 31.395241710249053,
    /* 11 */
    2.9164211881972335, 33.79716964664243, 574.8943997801362, 4853.234992253242, -7997.57021486075, -1189.7624067269965, -133.6444792601766, -7.7202770609839915, 5.993769336819237e-01, 9.427934736519954e-01, -0.17645823955292173, 40.21879108166477, 289.9982036694474, 359.3226160751053, 12950.259102786438, 1612.1013903507662, 362.85067106591504, 31.045922092242872,
    /* 10 */
    2.822222032597987, 26.988862316190684, 529.8996541764288, 4671.371946949588, -8535.899136645805, -1282.5898586244496, -149.58553632943463, -8.643494270763135, 5.345111359507916e-01, 1.111140466039205e+00, -0.36174739330527045, 41.04429910497807, 277.5463268268618, 195.6386023135583, 13169.43812144731, 1697.6433561479398, 367.40983966190305, 30.557037410382826,
    /* 9 */
    2.531473372857427, 20.070154905927314, 481.50208566532336, 4464.970341588308, -9065.36882077239, -1373.62841526722, -166.1660487028118, -9.58289321133207, 4.729647758913199e-01, 1.268786568327291e+00, -0.36970682634889585, 41.393213350082036, 261.2935935556502, 12.935476055240873, 13336.131683328815, 1772.508612059496, 369.76534388639965, 29.751323653701338, 2.4023193045459172, 13.304795348228817, 430.5615775526625, 4237.0568611071185, -9581.931701634761, -1461.6913552409758, -183.12733958476446, -10.718010163869403, 4.1421356237309504879e-01,
    /* tan(PI/8) */
    1.414213562373095e+00, -0.37677560326535325, 41.619486213528496, 241.05423794991074, -187.94665032361226, 13450.063605744153, 1836.153896465782, 369.4908799925761, 29.001847876923147,
    /* 7 */
    2.0714759319987186, 6.779591200894186, 377.7767837205709, 3990.386575512536, -10081.709459700915, -1545.947424837898, -200.3762958015653, -11.864482073055006, 3.578057213145241e-01, 1.546020906725474e+00, -0.3829366947518991, 41.1516456456653, 216.47684307105183, -406.1569483347166, 13511.136535077321, 1887.8076599260432, 367.3025214564151, 28.136213436723654,
    /* 6 */
    1.913880671464418, 0.3829366947518991, 323.85365704338597, 3728.1472257487526, -10561.233882199509, -1625.2025997821418, -217.62525175416, -13.015432208941645, 3.033466836073424e-01, 1.662939224605090e+00, -0.5822628872992417, 40.35639251440489, 188.20071124269245, -640.2706748618148, 13519.21490106562, 1927.6022433578062, 362.8197642637487, 26.968821921868447,
    /* 5 */
    1.7463817695935329, -5.62650678237171, 269.3016715297017, 3453.386536448852, -11016.145278780888, -1698.6569643425091, -234.7658734267683, -14.16351421663124, 2.504869601913055e-01, 1.763842528696710e+00, -0.5887180101749253, 39.23429103868072, 155.76096234403798, -889.2492977967378, 13475.470561874661, 1955.0535223723712, 356.4450994756727, 25.894952980042156,
    /* 4 */
    1.5695032905781554, -11.181939564328772, 214.80884394039484, 3169.1640829158237, -11443.321309975563, -1765.1588461316153, -251.68908574481912, -15.49755935939164, 1.989123673796580e-01, 1.847759065022573e+00, -0.7912582233652842, 37.39369355329111, 119.699486012458, -1151.0956593239027, 13380.446257078214, 1970.3952110853447, 348.01959814116185, 24.731487364283044,
    /* 3 */
    1.3850130831637748, -16.421408865300393, 161.05030052864092, 2878.3322807850063, -11838.991423510031, -1823.985884688674, -268.2854986386903, -16.81724543849939, 1.483359875383474e-01, 1.913880671464418e+00, -0.7960642926861912, 35.2322109610459, 80.01928065061526, -1424.0212633405113, 13235.794061869668, 1973.804052543835, 337.9908651258184, 23.289159354463873, 1.3934255946442087, -21.099669467133474, 108.48348407242611, 2583.700758091299, -12199.726194855148, -1874.2780658979746, -284.2467154529415, -18.11369784385905, 9.849140335716425e-02, 1.961570560806461e+00, -0.998795456205172, 32.56307803611191, 36.958364584370486, -1706.075448829146, 13043.287458812016, 1965.3831106103316, 326.43182772364605, 22.175018750622293, 1.198638339011324, -25.371248002043963, 57.53505923036915, 2288.41886619975, -12522.674544337233, -1914.8400385312243, -299.26241273417224, -19.37805630698734, 4.912684976946725e-02, 1.990369453344394e+00, 3.5780907e-02 * $9c8c9409243421ca$var$Util.SQRT2 * 0.5 / 2.384e-06, 1.7876148e-02 * $9c8c9409243421ca$var$Util.SQRT2 * 0.5 / 2.384e-06, 3.134727e-03 * $9c8c9409243421ca$var$Util.SQRT2 * 0.5 / 2.384e-06, 2.457142e-03 * $9c8c9409243421ca$var$Util.SQRT2 * 0.5 / 2.384e-06, 9.71317e-04 * $9c8c9409243421ca$var$Util.SQRT2 * 0.5 / 2.384e-06, 2.18868e-04 * $9c8c9409243421ca$var$Util.SQRT2 * 0.5 / 2.384e-06, 1.01566e-04 * $9c8c9409243421ca$var$Util.SQRT2 * 0.5 / 2.384e-06, 1.3828e-05 * $9c8c9409243421ca$var$Util.SQRT2 * 0.5 / 2.384e-06, 12804.797818791945, 1945.5515939597317, 313.4244966442953, 20.801593959731544, 1995.1556208053692, 9.000838926174497, -29.20218120805369];
    var NS = 12;
    var NL = 36;
    var win = [[2.382191739347913e-13, 6.423305872147834e-13, 9.400849094049688e-13, 1.122435026096556e-12, 1.183840321267481e-12, 1.122435026096556e-12, 9.400849094049690e-13, 6.423305872147839e-13, 2.382191739347918e-13, 5.456116108943412e-12, 4.878985199565852e-12, 4.240448995017367e-12, 3.559909094758252e-12, 2.858043359288075e-12, 2.156177623817898e-12, 1.475637723558783e-12, 8.371015190102974e-13, 2.599706096327376e-13, -0.000000000005456116108943412, -0.000000000004878985199565852, -0.000000000004240448995017367, -0.000000000003559909094758252, -0.000000000002858043359288076, -0.000000000002156177623817898, -0.000000000001475637723558783, -0.0000000000008371015190102975, -0.0000000000002599706096327376, -0.0000000000002382191739347923, -0.0000000000006423305872147843, -0.0000000000009400849094049696, -0.000000000001122435026096556, -0.000000000001183840321267481, -0.000000000001122435026096556, -0.0000000000009400849094049694, -0.000000000000642330587214784, -0.0000000000002382191739347918], [2.382191739347913e-13, 6.423305872147834e-13, 9.400849094049688e-13, 1.122435026096556e-12, 1.183840321267481e-12, 1.122435026096556e-12, 9.400849094049688e-13, 6.423305872147841e-13, 2.382191739347918e-13, 5.456116108943413e-12, 4.878985199565852e-12, 4.240448995017367e-12, 3.559909094758253e-12, 2.858043359288075e-12, 2.156177623817898e-12, 1.475637723558782e-12, 8.371015190102975e-13, 2.599706096327376e-13, -0.000000000005461314069809755, -0.000000000004921085770524055, -0.000000000004343405037091838, -0.000000000003732668368707687, -0.000000000003093523840190885, -0.000000000002430835727329465, -0.000000000001734679010007751, -0.000000000000974825365660928, -0.0000000000002797435120168326, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, -0.0000000000002283748241799531, -0.0000000000004037858874020686, -0.0000000000002146547464825323], [1.316524975873958e-01,
    /* win[SHORT_TYPE] */
    4.142135623730950e-01, 7.673269879789602e-01, 1.091308501069271e+00,
    /* tantab_l */
    1.303225372841206e+00, 1.569685577117490e+00, 1.920982126971166e+00, 2.414213562373094e+00, 3.171594802363212e+00, 4.510708503662055e+00, 7.595754112725146e+00, 2.290376554843115e+01, 0.98480775301220802032,
    /* cx */
    0.64278760968653936292, 0.34202014332566882393, 0.93969262078590842791, -0.1736481776669303, -0.7660444431189779, 0.86602540378443870761, 0.500000000000000e+00, -0.5144957554275265,
    /* ca */
    -0.4717319685649723, -0.3133774542039019, -0.1819131996109812, -0.09457419252642064, -0.04096558288530405, -0.01419856857247115, -0.003699974673760037, 8.574929257125442e-01,
    /* cs */
    8.817419973177052e-01, 9.496286491027329e-01, 9.833145924917901e-01, 9.955178160675857e-01, 9.991605581781475e-01, 9.998991952444470e-01, 9.999931550702802e-01], [0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 2.283748241799531e-13, 4.037858874020686e-13, 2.146547464825323e-13, 5.461314069809755e-12, 4.921085770524055e-12, 4.343405037091838e-12, 3.732668368707687e-12, 3.093523840190885e-12, 2.430835727329466e-12, 1.734679010007751e-12, 9.748253656609281e-13, 2.797435120168326e-13, -0.000000000005456116108943413, -0.000000000004878985199565852, -0.000000000004240448995017367, -0.000000000003559909094758253, -0.000000000002858043359288075, -0.000000000002156177623817898, -0.000000000001475637723558782, -0.0000000000008371015190102975, -0.0000000000002599706096327376, -0.0000000000002382191739347913, -0.0000000000006423305872147834, -0.0000000000009400849094049688, -0.000000000001122435026096556, -0.000000000001183840321267481, -0.000000000001122435026096556, -0.0000000000009400849094049688, -0.0000000000006423305872147841, -0.0000000000002382191739347918]];
    var tantab_l = win[$cPNKB.SHORT_TYPE];
    var cx = win[$cPNKB.SHORT_TYPE];
    var ca = win[$cPNKB.SHORT_TYPE];
    var cs = win[$cPNKB.SHORT_TYPE];
    /**
    * new IDCT routine written by Takehiro TOMINAGA
    *
    * PURPOSE: Overlapping window on PCM samples<BR>
    *
    * SEMANTICS:<BR>
    * 32 16-bit pcm samples are scaled to fractional 2's complement and
    * concatenated to the end of the window buffer #x#. The updated window
    * buffer #x# is then windowed by the analysis window #c# to produce the
    * windowed sample #z#
    */

    var order = [0, 1, 16, 17, 8, 9, 24, 25, 4, 5, 20, 21, 12, 13, 28, 29, 2, 3, 18, 19, 10, 11, 26, 27, 6, 7, 22, 23, 14, 15, 30, 31];
    /**
    * returns sum_j=0^31 a[j]*cos(PI*j*(k+1/2)/32), 0<=k<32
    */

    function window_subband(x1, x1Pos, a) {
      var wp = 10;
      var x2 = x1Pos + 238 - 14 - 286;

      for (var i = -15; i < 0; i++) {
        var w, s, t;
        w = enwindow[wp + -10];
        s = x1[x2 + -224] * w;
        t = x1[x1Pos + 224] * w;
        w = enwindow[wp + -9];
        s += x1[x2 + -160] * w;
        t += x1[x1Pos + 160] * w;
        w = enwindow[wp + -8];
        s += x1[x2 + -96] * w;
        t += x1[x1Pos + 96] * w;
        w = enwindow[wp + -7];
        s += x1[x2 + -32] * w;
        t += x1[x1Pos + 32] * w;
        w = enwindow[wp + -6];
        s += x1[x2 + 32] * w;
        t += x1[x1Pos + -32] * w;
        w = enwindow[wp + -5];
        s += x1[x2 + 96] * w;
        t += x1[x1Pos + -96] * w;
        w = enwindow[wp + -4];
        s += x1[x2 + 160] * w;
        t += x1[x1Pos + -160] * w;
        w = enwindow[wp + -3];
        s += x1[x2 + 224] * w;
        t += x1[x1Pos + -224] * w;
        w = enwindow[wp + -2];
        s += x1[x1Pos + -256] * w;
        t -= x1[x2 + 256] * w;
        w = enwindow[wp + -1];
        s += x1[x1Pos + -192] * w;
        t -= x1[x2 + 192] * w;
        w = enwindow[wp + 0];
        s += x1[x1Pos + -128] * w;
        t -= x1[x2 + 128] * w;
        w = enwindow[wp + 1];
        s += x1[x1Pos + -64] * w;
        t -= x1[x2 + 64] * w;
        w = enwindow[wp + 2];
        s += x1[x1Pos + 0] * w;
        t -= x1[x2 + 0] * w;
        w = enwindow[wp + 3];
        s += x1[x1Pos + 64] * w;
        t -= x1[x2 + -64] * w;
        w = enwindow[wp + 4];
        s += x1[x1Pos + 128] * w;
        t -= x1[x2 + -128] * w;
        w = enwindow[wp + 5];
        s += x1[x1Pos + 192] * w;
        t -= x1[x2 + -192] * w;
        /*
        * this multiplyer could be removed, but it needs more 256 FLOAT
        * data. thinking about the data cache performance, I think we
        * should not use such a huge table. tt 2000/Oct/25
        */

        s *= enwindow[wp + 6];
        w = t - s;
        a[30 + i * 2] = t + s;
        a[31 + i * 2] = enwindow[wp + 7] * w;
        wp += 18;
        x1Pos--;
        x2++;
      }

      var s, t, u, v;
      t = x1[x1Pos + -16] * enwindow[wp + -10];
      s = x1[x1Pos + -32] * enwindow[wp + -2];
      t += (x1[x1Pos + -48] - x1[x1Pos + 16]) * enwindow[wp + -9];
      s += x1[x1Pos + -96] * enwindow[wp + -1];
      t += (x1[x1Pos + -80] + x1[x1Pos + 48]) * enwindow[wp + -8];
      s += x1[x1Pos + -160] * enwindow[wp + 0];
      t += (x1[x1Pos + -112] - x1[x1Pos + 80]) * enwindow[wp + -7];
      s += x1[x1Pos + -224] * enwindow[wp + 1];
      t += (x1[x1Pos + -144] + x1[x1Pos + 112]) * enwindow[wp + -6];
      s -= x1[x1Pos + 32] * enwindow[wp + 2];
      t += (x1[x1Pos + -176] - x1[x1Pos + 144]) * enwindow[wp + -5];
      s -= x1[x1Pos + 96] * enwindow[wp + 3];
      t += (x1[x1Pos + -208] + x1[x1Pos + 176]) * enwindow[wp + -4];
      s -= x1[x1Pos + 160] * enwindow[wp + 4];
      t += (x1[x1Pos + -240] - x1[x1Pos + 208]) * enwindow[wp + -3];
      s -= x1[x1Pos + 224];
      u = s - t;
      v = s + t;
      t = a[14];
      s = a[15] - t;
      a[31] = v + t;
      /* A0 */

      a[30] = u + s;
      /* A1 */

      a[15] = u - s;
      /* A2 */

      a[14] = v - t;
      /* A3 */

      var xr;
      xr = a[28] - a[0];
      a[0] += a[28];
      a[28] = xr * enwindow[wp + -36 + 7];
      xr = a[29] - a[1];
      a[1] += a[29];
      a[29] = xr * enwindow[wp + -36 + 7];
      xr = a[26] - a[2];
      a[2] += a[26];
      a[26] = xr * enwindow[wp + -72 + 7];
      xr = a[27] - a[3];
      a[3] += a[27];
      a[27] = xr * enwindow[wp + -72 + 7];
      xr = a[24] - a[4];
      a[4] += a[24];
      a[24] = xr * enwindow[wp + -108 + 7];
      xr = a[25] - a[5];
      a[5] += a[25];
      a[25] = xr * enwindow[wp + -108 + 7];
      xr = a[22] - a[6];
      a[6] += a[22];
      a[22] = xr * $9c8c9409243421ca$var$Util.SQRT2;
      xr = a[23] - a[7];
      a[7] += a[23];
      a[23] = xr * $9c8c9409243421ca$var$Util.SQRT2 - a[7];
      a[7] -= a[6];
      a[22] -= a[7];
      a[23] -= a[22];
      xr = a[6];
      a[6] = a[31] - xr;
      a[31] = a[31] + xr;
      xr = a[7];
      a[7] = a[30] - xr;
      a[30] = a[30] + xr;
      xr = a[22];
      a[22] = a[15] - xr;
      a[15] = a[15] + xr;
      xr = a[23];
      a[23] = a[14] - xr;
      a[14] = a[14] + xr;
      xr = a[20] - a[8];
      a[8] += a[20];
      a[20] = xr * enwindow[wp + -180 + 7];
      xr = a[21] - a[9];
      a[9] += a[21];
      a[21] = xr * enwindow[wp + -180 + 7];
      xr = a[18] - a[10];
      a[10] += a[18];
      a[18] = xr * enwindow[wp + -216 + 7];
      xr = a[19] - a[11];
      a[11] += a[19];
      a[19] = xr * enwindow[wp + -216 + 7];
      xr = a[16] - a[12];
      a[12] += a[16];
      a[16] = xr * enwindow[wp + -252 + 7];
      xr = a[17] - a[13];
      a[13] += a[17];
      a[17] = xr * enwindow[wp + -252 + 7];
      xr = -a[20] + a[24];
      a[20] += a[24];
      a[24] = xr * enwindow[wp + -216 + 7];
      xr = -a[21] + a[25];
      a[21] += a[25];
      a[25] = xr * enwindow[wp + -216 + 7];
      xr = a[4] - a[8];
      a[4] += a[8];
      a[8] = xr * enwindow[wp + -216 + 7];
      xr = a[5] - a[9];
      a[5] += a[9];
      a[9] = xr * enwindow[wp + -216 + 7];
      xr = a[0] - a[12];
      a[0] += a[12];
      a[12] = xr * enwindow[wp + -72 + 7];
      xr = a[1] - a[13];
      a[1] += a[13];
      a[13] = xr * enwindow[wp + -72 + 7];
      xr = a[16] - a[28];
      a[16] += a[28];
      a[28] = xr * enwindow[wp + -72 + 7];
      xr = -a[17] + a[29];
      a[17] += a[29];
      a[29] = xr * enwindow[wp + -72 + 7];
      xr = $9c8c9409243421ca$var$Util.SQRT2 * (a[2] - a[10]);
      a[2] += a[10];
      a[10] = xr;
      xr = $9c8c9409243421ca$var$Util.SQRT2 * (a[3] - a[11]);
      a[3] += a[11];
      a[11] = xr;
      xr = $9c8c9409243421ca$var$Util.SQRT2 * (-a[18] + a[26]);
      a[18] += a[26];
      a[26] = xr - a[18];
      xr = $9c8c9409243421ca$var$Util.SQRT2 * (-a[19] + a[27]);
      a[19] += a[27];
      a[27] = xr - a[19];
      xr = a[2];
      a[19] -= a[3];
      a[3] -= xr;
      a[2] = a[31] - xr;
      a[31] += xr;
      xr = a[3];
      a[11] -= a[19];
      a[18] -= xr;
      a[3] = a[30] - xr;
      a[30] += xr;
      xr = a[18];
      a[27] -= a[11];
      a[19] -= xr;
      a[18] = a[15] - xr;
      a[15] += xr;
      xr = a[19];
      a[10] -= xr;
      a[19] = a[14] - xr;
      a[14] += xr;
      xr = a[10];
      a[11] -= xr;
      a[10] = a[23] - xr;
      a[23] += xr;
      xr = a[11];
      a[26] -= xr;
      a[11] = a[22] - xr;
      a[22] += xr;
      xr = a[26];
      a[27] -= xr;
      a[26] = a[7] - xr;
      a[7] += xr;
      xr = a[27];
      a[27] = a[6] - xr;
      a[6] += xr;
      xr = $9c8c9409243421ca$var$Util.SQRT2 * (a[0] - a[4]);
      a[0] += a[4];
      a[4] = xr;
      xr = $9c8c9409243421ca$var$Util.SQRT2 * (a[1] - a[5]);
      a[1] += a[5];
      a[5] = xr;
      xr = $9c8c9409243421ca$var$Util.SQRT2 * (a[16] - a[20]);
      a[16] += a[20];
      a[20] = xr;
      xr = $9c8c9409243421ca$var$Util.SQRT2 * (a[17] - a[21]);
      a[17] += a[21];
      a[21] = xr;
      xr = -$9c8c9409243421ca$var$Util.SQRT2 * (a[8] - a[12]);
      a[8] += a[12];
      a[12] = xr - a[8];
      xr = -$9c8c9409243421ca$var$Util.SQRT2 * (a[9] - a[13]);
      a[9] += a[13];
      a[13] = xr - a[9];
      xr = -$9c8c9409243421ca$var$Util.SQRT2 * (a[25] - a[29]);
      a[25] += a[29];
      a[29] = xr - a[25];
      xr = -$9c8c9409243421ca$var$Util.SQRT2 * (a[24] + a[28]);
      a[24] -= a[28];
      a[28] = xr - a[24];
      xr = a[24] - a[16];
      a[24] = xr;
      xr = a[20] - xr;
      a[20] = xr;
      xr = a[28] - xr;
      a[28] = xr;
      xr = a[25] - a[17];
      a[25] = xr;
      xr = a[21] - xr;
      a[21] = xr;
      xr = a[29] - xr;
      a[29] = xr;
      xr = a[17] - a[1];
      a[17] = xr;
      xr = a[9] - xr;
      a[9] = xr;
      xr = a[25] - xr;
      a[25] = xr;
      xr = a[5] - xr;
      a[5] = xr;
      xr = a[21] - xr;
      a[21] = xr;
      xr = a[13] - xr;
      a[13] = xr;
      xr = a[29] - xr;
      a[29] = xr;
      xr = a[1] - a[0];
      a[1] = xr;
      xr = a[16] - xr;
      a[16] = xr;
      xr = a[17] - xr;
      a[17] = xr;
      xr = a[8] - xr;
      a[8] = xr;
      xr = a[9] - xr;
      a[9] = xr;
      xr = a[24] - xr;
      a[24] = xr;
      xr = a[25] - xr;
      a[25] = xr;
      xr = a[4] - xr;
      a[4] = xr;
      xr = a[5] - xr;
      a[5] = xr;
      xr = a[20] - xr;
      a[20] = xr;
      xr = a[21] - xr;
      a[21] = xr;
      xr = a[12] - xr;
      a[12] = xr;
      xr = a[13] - xr;
      a[13] = xr;
      xr = a[28] - xr;
      a[28] = xr;
      xr = a[29] - xr;
      a[29] = xr;
      xr = a[0];
      a[0] += a[31];
      a[31] -= xr;
      xr = a[1];
      a[1] += a[30];
      a[30] -= xr;
      xr = a[16];
      a[16] += a[15];
      a[15] -= xr;
      xr = a[17];
      a[17] += a[14];
      a[14] -= xr;
      xr = a[8];
      a[8] += a[23];
      a[23] -= xr;
      xr = a[9];
      a[9] += a[22];
      a[22] -= xr;
      xr = a[24];
      a[24] += a[7];
      a[7] -= xr;
      xr = a[25];
      a[25] += a[6];
      a[6] -= xr;
      xr = a[4];
      a[4] += a[27];
      a[27] -= xr;
      xr = a[5];
      a[5] += a[26];
      a[26] -= xr;
      xr = a[20];
      a[20] += a[11];
      a[11] -= xr;
      xr = a[21];
      a[21] += a[10];
      a[10] -= xr;
      xr = a[12];
      a[12] += a[19];
      a[19] -= xr;
      xr = a[13];
      a[13] += a[18];
      a[18] -= xr;
      xr = a[28];
      a[28] += a[3];
      a[3] -= xr;
      xr = a[29];
      a[29] += a[2];
      a[2] -= xr;
    }
    /**
    * Function: Calculation of the MDCT In the case of long blocks (type 0,1,3)
    * there are 36 coefficents in the time domain and 18 in the frequency
    * domain.<BR>
    * In the case of short blocks (type 2) there are 3 transformations with
    * short length. This leads to 12 coefficents in the time and 6 in the
    * frequency domain. In this case the results are stored side by side in the
    * vector out[].
    *
    * New layer3
    */


    function mdct_short(inout, inoutPos) {
      for (var l = 0; l < 3; l++) {
        var tc0, tc1, tc2, ts0, ts1, ts2;
        ts0 = inout[inoutPos + 6] * win[$cPNKB.SHORT_TYPE][0] - inout[inoutPos + 15];
        tc0 = inout[inoutPos + 0] * win[$cPNKB.SHORT_TYPE][2] - inout[inoutPos + 9];
        tc1 = ts0 + tc0;
        tc2 = ts0 - tc0;
        ts0 = inout[inoutPos + 15] * win[$cPNKB.SHORT_TYPE][0] + inout[inoutPos + 6];
        tc0 = inout[inoutPos + 9] * win[$cPNKB.SHORT_TYPE][2] + inout[inoutPos + 0];
        ts1 = ts0 + tc0;
        ts2 = -ts0 + tc0;
        tc0 = (inout[inoutPos + 3] * win[$cPNKB.SHORT_TYPE][1] - inout[inoutPos + 12]) * 2.069978111953089e-11;
        /*
        * tritab_s [ 1 ]
        */

        ts0 = (inout[inoutPos + 12] * win[$cPNKB.SHORT_TYPE][1] + inout[inoutPos + 3]) * 2.069978111953089e-11;
        /*
        * tritab_s [ 1 ]
        */

        inout[inoutPos + 0] = tc1 * 1.907525191737280e-11 + tc0;
        /*
        * tritab_s[ 2 ]
        */

        inout[inoutPos + 15] = -ts1 * 1.907525191737280e-11 + ts0;
        /*
        * tritab_s[0 ]
        */

        tc2 = tc2 * 0.000000000016519652744032674;
        /*
        * tritab_s[ 2]
        */

        ts1 = ts1 * 0.5 * 1.907525191737281e-11 + ts0;
        inout[inoutPos + 3] = tc2 - ts1;
        inout[inoutPos + 6] = tc2 + ts1;
        tc1 = tc1 * 0.5 * 1.907525191737281e-11 - tc0;
        ts2 = ts2 * 0.000000000016519652744032674;
        /*
        * tritab_s[ 0]
        */

        inout[inoutPos + 9] = tc1 + ts2;
        inout[inoutPos + 12] = tc1 - ts2;
        inoutPos++;
      }
    }

    function mdct_long(out, outPos, _in) {
      var ct, st;
      var tc1, tc2, tc3, tc4, ts5, ts6, ts7, ts8;
      /* 1,2, 5,6, 9,10, 13,14, 17 */

      tc1 = _in[17] - _in[9];
      tc3 = _in[15] - _in[11];
      tc4 = _in[14] - _in[12];
      ts5 = _in[0] + _in[8];
      ts6 = _in[1] + _in[7];
      ts7 = _in[2] + _in[6];
      ts8 = _in[3] + _in[5];
      out[outPos + 17] = ts5 + ts7 - ts8 - (ts6 - _in[4]);
      st = (ts5 + ts7 - ts8) * cx[19] + (ts6 - _in[4]);
      ct = (tc1 - tc3 - tc4) * cx[18];
      out[outPos + 5] = ct + st;
      out[outPos + 6] = ct - st;
      tc2 = (_in[16] - _in[10]) * cx[18];
      ts6 = ts6 * cx[19] + _in[4];
      ct = tc1 * cx[12] + tc2 + tc3 * cx[13] + tc4 * cx[14];
      st = -ts5 * cx[16] + ts6 - ts7 * cx[17] + ts8 * cx[15];
      out[outPos + 1] = ct + st;
      out[outPos + 2] = ct - st;
      ct = tc1 * cx[13] - tc2 - tc3 * cx[14] + tc4 * cx[12];
      st = -ts5 * cx[17] + ts6 - ts7 * cx[15] + ts8 * cx[16];
      out[outPos + 9] = ct + st;
      out[outPos + 10] = ct - st;
      ct = tc1 * cx[14] - tc2 + tc3 * cx[12] - tc4 * cx[13];
      st = ts5 * cx[15] - ts6 + ts7 * cx[16] - ts8 * cx[17];
      out[outPos + 13] = ct + st;
      out[outPos + 14] = ct - st;
      var ts1, ts2, ts3, ts4, tc5, tc6, tc7, tc8;
      ts1 = _in[8] - _in[0];
      ts3 = _in[6] - _in[2];
      ts4 = _in[5] - _in[3];
      tc5 = _in[17] + _in[9];
      tc6 = _in[16] + _in[10];
      tc7 = _in[15] + _in[11];
      tc8 = _in[14] + _in[12];
      out[outPos + 0] = tc5 + tc7 + tc8 + (tc6 + _in[13]);
      ct = (tc5 + tc7 + tc8) * cx[19] - (tc6 + _in[13]);
      st = (ts1 - ts3 + ts4) * cx[18];
      out[outPos + 11] = ct + st;
      out[outPos + 12] = ct - st;
      ts2 = (_in[7] - _in[1]) * cx[18];
      tc6 = _in[13] - tc6 * cx[19];
      ct = tc5 * cx[15] - tc6 + tc7 * cx[16] + tc8 * cx[17];
      st = ts1 * cx[14] + ts2 + ts3 * cx[12] + ts4 * cx[13];
      out[outPos + 3] = ct + st;
      out[outPos + 4] = ct - st;
      ct = -tc5 * cx[17] + tc6 - tc7 * cx[15] - tc8 * cx[16];
      st = ts1 * cx[13] + ts2 - ts3 * cx[14] - ts4 * cx[12];
      out[outPos + 7] = ct + st;
      out[outPos + 8] = ct - st;
      ct = -tc5 * cx[16] + tc6 - tc7 * cx[17] - tc8 * cx[15];
      st = ts1 * cx[12] - ts2 + ts3 * cx[13] - ts4 * cx[14];
      out[outPos + 15] = ct + st;
      out[outPos + 16] = ct - st;
    }

    this.mdct_sub48 = function (gfc, w0, w1) {
      var wk = w0;
      var wkPos = 286;
      /* thinking cache performance, ch->gr loop is better than gr->ch loop */

      for (var ch = 0; ch < gfc.channels_out; ch++) {
        for (var gr = 0; gr < gfc.mode_gr; gr++) {
          var band;
          var gi = gfc.l3_side.tt[gr][ch];
          var mdct_enc = gi.xr;
          var mdct_encPos = 0;
          var samp = gfc.sb_sample[ch][1 - gr];
          var sampPos = 0;

          for (var k = 0; k < 9; k++) {
            window_subband(wk, wkPos, samp[sampPos]);
            window_subband(wk, wkPos + 32, samp[sampPos + 1]);
            sampPos += 2;
            wkPos += 64;
            /*
            * Compensate for inversion in the analysis filter
            */

            for (band = 1; band < 32; band += 2) samp[sampPos - 1][band] *= -1;
          }
          /*
          * Perform imdct of 18 previous subband samples + 18 current
          * subband samples
          */


          for (band = 0; band < 32; band++, mdct_encPos += 18) {
            var type = gi.block_type;
            var band0 = gfc.sb_sample[ch][gr];
            var band1 = gfc.sb_sample[ch][1 - gr];
            if (gi.mixed_block_flag != 0 && band < 2) type = 0;
            if (gfc.amp_filter[band] < 1e-12) $9c8c9409243421ca$var$Arrays.fill(mdct_enc, mdct_encPos + 0, mdct_encPos + 18, 0);else {
              if (gfc.amp_filter[band] < 1.0) for (var k = 0; k < 18; k++) band1[k][order[band]] *= gfc.amp_filter[band];

              if (type == $cPNKB.SHORT_TYPE) {
                for (var k = -NS / 4; k < 0; k++) {
                  var w = win[$cPNKB.SHORT_TYPE][k + 3];
                  mdct_enc[mdct_encPos + k * 3 + 9] = band0[9 + k][order[band]] * w - band0[8 - k][order[band]];
                  mdct_enc[mdct_encPos + k * 3 + 18] = band0[14 - k][order[band]] * w + band0[15 + k][order[band]];
                  mdct_enc[mdct_encPos + k * 3 + 10] = band0[15 + k][order[band]] * w - band0[14 - k][order[band]];
                  mdct_enc[mdct_encPos + k * 3 + 19] = band1[2 - k][order[band]] * w + band1[3 + k][order[band]];
                  mdct_enc[mdct_encPos + k * 3 + 11] = band1[3 + k][order[band]] * w - band1[2 - k][order[band]];
                  mdct_enc[mdct_encPos + k * 3 + 20] = band1[8 - k][order[band]] * w + band1[9 + k][order[band]];
                }

                mdct_short(mdct_enc, mdct_encPos);
              } else {
                var work = $9c8c9409243421ca$var$new_float(18);

                for (var k = -NL / 4; k < 0; k++) {
                  var a, b;
                  a = win[type][k + 27] * band1[k + 9][order[band]] + win[type][k + 36] * band1[8 - k][order[band]];
                  b = win[type][k + 9] * band0[k + 9][order[band]] - win[type][k + 18] * band0[8 - k][order[band]];
                  work[k + 9] = a - b * tantab_l[3 + k + 9];
                  work[k + 18] = a * tantab_l[3 + k + 9] + b;
                }

                mdct_long(mdct_enc, mdct_encPos, work);
              }
            }
            /*
            * Perform aliasing reduction butterfly
            */

            if (type != $cPNKB.SHORT_TYPE && band != 0) for (var k = 7; k >= 0; --k) {
              var bu, bd;
              bu = mdct_enc[mdct_encPos + k] * ca[20 + k] + mdct_enc[mdct_encPos + -1 - k] * cs[28 + k];
              bd = mdct_enc[mdct_encPos + k] * cs[28 + k] - mdct_enc[mdct_encPos + -1 - k] * ca[20 + k];
              mdct_enc[mdct_encPos + -1 - k] = bu;
              mdct_enc[mdct_encPos + k] = bd;
            }
          }
        }

        wk = w1;
        wkPos = 286;
        if (gfc.mode_gr == 1) for (var i = 0; i < 18; i++) $9c8c9409243421ca$var$System.arraycopy(gfc.sb_sample[ch][1][i], 0, gfc.sb_sample[ch][0][i], 0, 32);
      }
    };
  }

  module.exports = $9c8c9409243421ca$var$NewMDCT;
});
parcelRequire.register("hvy40", function (module, exports) {
  //package mp3;
  var $51XxS = parcelRequire("51XxS");

  function $cbefc13b27188c2b$var$III_psy_ratio() {
    this.thm = new $51XxS();
    this.en = new $51XxS();
  }

  module.exports = $cbefc13b27188c2b$var$III_psy_ratio;
});
parcelRequire.register("51XxS", function (module, exports) {
  var $cPNKB = parcelRequire("cPNKB");
  var $3YDN3 = parcelRequire("3YDN3");
  var $3a9b3c3a1c7d1011$var$System = $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $3a9b3c3a1c7d1011$var$new_float = $3YDN3.new_float;
  var $3a9b3c3a1c7d1011$var$new_float_n = $3YDN3.new_float_n;
  $3YDN3.new_int;
  $3YDN3.new_int_n;
  $3YDN3.assert;

  function $3a9b3c3a1c7d1011$var$III_psy_xmin() {
    this.l = $3a9b3c3a1c7d1011$var$new_float($cPNKB.SBMAX_l);
    this.s = $3a9b3c3a1c7d1011$var$new_float_n([$cPNKB.SBMAX_s, 3]);
    var self = this;

    this.assign = function (iii_psy_xmin) {
      $3a9b3c3a1c7d1011$var$System.arraycopy(iii_psy_xmin.l, 0, self.l, 0, $cPNKB.SBMAX_l);

      for (var i = 0; i < $cPNKB.SBMAX_s; i++) for (var j = 0; j < 3; j++) self.s[i][j] = iii_psy_xmin.s[i][j];
    };
  }

  module.exports = $3a9b3c3a1c7d1011$var$III_psy_xmin;
});
parcelRequire.register("jL6I1", function (module, exports) {
  //package mp3;

  /* MPEG modes */
  function $e6279c632d7fdac0$var$MPEGMode(ordinal) {
    var _ordinal = ordinal;

    this.ordinal = function () {
      return _ordinal;
    };
  }

  $e6279c632d7fdac0$var$MPEGMode.STEREO = new $e6279c632d7fdac0$var$MPEGMode(0);
  $e6279c632d7fdac0$var$MPEGMode.JOINT_STEREO = new $e6279c632d7fdac0$var$MPEGMode(1);
  $e6279c632d7fdac0$var$MPEGMode.DUAL_CHANNEL = new $e6279c632d7fdac0$var$MPEGMode(2);
  $e6279c632d7fdac0$var$MPEGMode.MONO = new $e6279c632d7fdac0$var$MPEGMode(3);
  $e6279c632d7fdac0$var$MPEGMode.NOT_SET = new $e6279c632d7fdac0$var$MPEGMode(4);
  module.exports = $e6279c632d7fdac0$var$MPEGMode;
});
parcelRequire.register("5HJeD", function (module, exports) {
  var $jL6I1 = parcelRequire("jL6I1");

  function $42740ea95db3cb8e$var$LameGlobalFlags() {
    this.class_id = 0;
    /* input description */

    /**
    * number of samples. default=-1
    */

    this.num_samples = 0;
    /**
    * input number of channels. default=2
    */

    this.num_channels = 0;
    /**
    * input_samp_rate in Hz. default=44.1 kHz
    */

    this.in_samplerate = 0;
    /**
    * output_samp_rate. default: LAME picks best value at least not used for
    * MP3 decoding: Remember 44.1 kHz MP3s and AC97
    */

    this.out_samplerate = 0;
    /**
    * scale input by this amount before encoding at least not used for MP3
    * decoding
    */

    this.scale = 0.;
    /**
    * scale input of channel 0 (left) by this amount before encoding
    */

    this.scale_left = 0.;
    /**
    * scale input of channel 1 (right) by this amount before encoding
    */

    this.scale_right = 0.;
    /* general control params */

    /**
    * collect data for a MP3 frame analyzer?
    */

    this.analysis = false;
    /**
    * add Xing VBR tag?
    */

    this.bWriteVbrTag = false;
    /**
    * use lame/mpglib to convert mp3 to wav
    */

    this.decode_only = false;
    /**
    * quality setting 0=best, 9=worst default=5
    */

    this.quality = 0;
    /**
    * see enum default = LAME picks best value
    */

    this.mode = $jL6I1.STEREO;
    /**
    * force M/S mode. requires mode=1
    */

    this.force_ms = false;
    /**
    * use free format? default=0
    */

    this.free_format = false;
    /**
    * find the RG value? default=0
    */

    this.findReplayGain = false;
    /**
    * decode on the fly? default=0
    */

    this.decode_on_the_fly = false;
    /**
    * 1 (default) writes ID3 tags, 0 not
    */

    this.write_id3tag_automatic = false;
    /*
    * set either brate>0 or compression_ratio>0, LAME will compute the value of
    * the variable not set. Default is compression_ratio = 11.025
    */

    /**
    * bitrate
    */

    this.brate = 0;
    /**
    * sizeof(wav file)/sizeof(mp3 file)
    */

    this.compression_ratio = 0.;
    /* frame params */

    /**
    * mark as copyright. default=0
    */

    this.copyright = 0;
    /**
    * mark as original. default=1
    */

    this.original = 0;
    /**
    * the MP3 'private extension' bit. Meaningless
    */

    this.extension = 0;
    /**
    * Input PCM is emphased PCM (for instance from one of the rarely emphased
    * CDs), it is STRONGLY not recommended to use this, because psycho does not
    * take it into account, and last but not least many decoders don't care
    * about these bits
    */

    this.emphasis = 0;
    /**
    * use 2 bytes per frame for a CRC checksum. default=0
    */

    this.error_protection = 0;
    /**
    * enforce ISO spec as much as possible
    */

    this.strict_ISO = false;
    /**
    * use bit reservoir?
    */

    this.disable_reservoir = false;
    /* quantization/noise shaping */

    this.quant_comp = 0;
    this.quant_comp_short = 0;
    this.experimentalY = false;
    this.experimentalZ = 0;
    this.exp_nspsytune = 0;
    this.preset = 0;
    /* VBR control */

    this.VBR = null;
    /**
    * Range [0,...,1[
    */

    this.VBR_q_frac = 0.;
    /**
    * Range [0,...,9]
    */

    this.VBR_q = 0;
    this.VBR_mean_bitrate_kbps = 0;
    this.VBR_min_bitrate_kbps = 0;
    this.VBR_max_bitrate_kbps = 0;
    /**
    * strictly enforce VBR_min_bitrate normaly, it will be violated for analog
    * silence
    */

    this.VBR_hard_min = 0;
    /* resampling and filtering */

    /**
    * freq in Hz. 0=lame choses. -1=no filter
    */

    this.lowpassfreq = 0;
    /**
    * freq in Hz. 0=lame choses. -1=no filter
    */

    this.highpassfreq = 0;
    /**
    * freq width of filter, in Hz (default=15%)
    */

    this.lowpasswidth = 0;
    /**
    * freq width of filter, in Hz (default=15%)
    */

    this.highpasswidth = 0;
    /*
    * psycho acoustics and other arguments which you should not change unless
    * you know what you are doing
    */

    this.maskingadjust = 0.;
    this.maskingadjust_short = 0.;
    /**
    * only use ATH
    */

    this.ATHonly = false;
    /**
    * only use ATH for short blocks
    */

    this.ATHshort = false;
    /**
    * disable ATH
    */

    this.noATH = false;
    /**
    * select ATH formula
    */

    this.ATHtype = 0;
    /**
    * change ATH formula 4 shape
    */

    this.ATHcurve = 0.;
    /**
    * lower ATH by this many db
    */

    this.ATHlower = 0.;
    /**
    * select ATH auto-adjust scheme
    */

    this.athaa_type = 0;
    /**
    * select ATH auto-adjust loudness calc
    */

    this.athaa_loudapprox = 0;
    /**
    * dB, tune active region of auto-level
    */

    this.athaa_sensitivity = 0.;
    this.short_blocks = null;
    /**
    * use temporal masking effect
    */

    this.useTemporal = false;
    this.interChRatio = 0.;
    /**
    * Naoki's adjustment of Mid/Side maskings
    */

    this.msfix = 0.;
    /**
    * 0 off, 1 on
    */

    this.tune = false;
    /**
    * used to pass values for debugging and stuff
    */

    this.tune_value_a = 0.;
    /************************************************************************/

    /* internal variables, do not set... */

    /* provided because they may be of use to calling application */

    /************************************************************************/

    /**
    * 0=MPEG-2/2.5 1=MPEG-1
    */

    this.version = 0;
    this.encoder_delay = 0;
    /**
    * number of samples of padding appended to input
    */

    this.encoder_padding = 0;
    this.framesize = 0;
    /**
    * number of frames encoded
    */

    this.frameNum = 0;
    /**
    * is this struct owned by calling program or lame?
    */

    this.lame_allocated_gfp = 0;
    /**************************************************************************/

    /* more internal variables are stored in this structure: */

    /**************************************************************************/

    this.internal_flags = null;
  }

  module.exports = $42740ea95db3cb8e$var$LameGlobalFlags;
});
parcelRequire.register("4SDnr", function (module, exports) {
  var $3YDN3 = parcelRequire("3YDN3");
  $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  var $38dac00579cf6ffc$var$new_byte = $3YDN3.new_byte;
  var $38dac00579cf6ffc$var$new_double = $3YDN3.new_double;
  var $38dac00579cf6ffc$var$new_float = $3YDN3.new_float;
  var $38dac00579cf6ffc$var$new_float_n = $3YDN3.new_float_n;
  var $38dac00579cf6ffc$var$new_int = $3YDN3.new_int;
  var $38dac00579cf6ffc$var$new_int_n = $3YDN3.new_int_n;
  $3YDN3.assert;
  var $eWXBy = parcelRequire("eWXBy");
  var $7imnH = parcelRequire("7imnH");
  var $7yzUB = parcelRequire("7yzUB");
  var $jTmCQ = parcelRequire("jTmCQ");
  var $51XxS = parcelRequire("51XxS");
  var $cPNKB = parcelRequire("cPNKB");
  var $arIi9 = parcelRequire("arIi9");
  $38dac00579cf6ffc$var$LameInternalFlags.MFSIZE = 3456 + $cPNKB.ENCDELAY - $cPNKB.MDCTDELAY;
  $38dac00579cf6ffc$var$LameInternalFlags.MAX_HEADER_BUF = 256;
  $38dac00579cf6ffc$var$LameInternalFlags.MAX_BITS_PER_CHANNEL = 4095;
  $38dac00579cf6ffc$var$LameInternalFlags.MAX_BITS_PER_GRANULE = 7680;
  $38dac00579cf6ffc$var$LameInternalFlags.BPC = 320;

  function $38dac00579cf6ffc$var$LameInternalFlags() {
    var MAX_HEADER_LEN = 40;
    /********************************************************************
    * internal variables NOT set by calling program, and should not be *
    * modified by the calling program *
    ********************************************************************/

    /**
    * Some remarks to the Class_ID field: The Class ID is an Identifier for a
    * pointer to this struct. It is very unlikely that a pointer to
    * lame_global_flags has the same 32 bits in it's structure (large and other
    * special properties, for instance prime).
    *
    * To test that the structure is right and initialized, use: if ( gfc .
    * Class_ID == LAME_ID ) ... Other remark: If you set a flag to 0 for uninit
    * data and 1 for init data, the right test should be "if (flag == 1)" and
    * NOT "if (flag)". Unintended modification of this element will be
    * otherwise misinterpreted as an init.
    */

    this.Class_ID = 0;
    this.lame_encode_frame_init = 0;
    this.iteration_init_init = 0;
    this.fill_buffer_resample_init = 0; //public float mfbuf[][] = new float[2][MFSIZE];

    this.mfbuf = $38dac00579cf6ffc$var$new_float_n([2, $38dac00579cf6ffc$var$LameInternalFlags.MFSIZE]);
    /**
    * granules per frame
    */

    this.mode_gr = 0;
    /**
    * number of channels in the input data stream (PCM or decoded PCM)
    */

    this.channels_in = 0;
    /**
    * number of channels in the output data stream (not used for decoding)
    */

    this.channels_out = 0;
    /**
    * input_samp_rate/output_samp_rate
    */
    //public double resample_ratio;

    this.resample_ratio = 0.;
    this.mf_samples_to_encode = 0;
    this.mf_size = 0;
    /**
    * min bitrate index
    */

    this.VBR_min_bitrate = 0;
    /**
    * max bitrate index
    */

    this.VBR_max_bitrate = 0;
    this.bitrate_index = 0;
    this.samplerate_index = 0;
    this.mode_ext = 0;
    /* lowpass and highpass filter control */

    /**
    * normalized frequency bounds of passband
    */

    this.lowpass1 = 0.;
    this.lowpass2 = 0.;
    /**
    * normalized frequency bounds of passband
    */

    this.highpass1 = 0.;
    this.highpass2 = 0.;
    /**
    * 0 = none 1 = ISO AAC model 2 = allow scalefac_select=1
    */

    this.noise_shaping = 0;
    /**
    * 0 = ISO model: amplify all distorted bands<BR>
    * 1 = amplify within 50% of max (on db scale)<BR>
    * 2 = amplify only most distorted band<BR>
    * 3 = method 1 and refine with method 2<BR>
    */

    this.noise_shaping_amp = 0;
    /**
    * 0 = no substep<BR>
    * 1 = use substep shaping at last step(VBR only)<BR>
    * (not implemented yet)<BR>
    * 2 = use substep inside loop<BR>
    * 3 = use substep inside loop and last step<BR>
    */

    this.substep_shaping = 0;
    /**
    * 1 = gpsycho. 0 = none
    */

    this.psymodel = 0;
    /**
    * 0 = stop at over=0, all scalefacs amplified or<BR>
    * a scalefac has reached max value<BR>
    * 1 = stop when all scalefacs amplified or a scalefac has reached max value<BR>
    * 2 = stop when all scalefacs amplified
    */

    this.noise_shaping_stop = 0;
    /**
    * 0 = no, 1 = yes
    */

    this.subblock_gain = 0;
    /**
    * 0 = no. 1=outside loop 2=inside loop(slow)
    */

    this.use_best_huffman = 0;
    /**
    * 0 = stop early after 0 distortion found. 1 = full search
    */

    this.full_outer_loop = 0; //public IIISideInfo l3_side = new IIISideInfo();

    this.l3_side = new $eWXBy();
    this.ms_ratio = $38dac00579cf6ffc$var$new_float(2);
    /* used for padding */

    /**
    * padding for the current frame?
    */

    this.padding = 0;
    this.frac_SpF = 0;
    this.slot_lag = 0;
    /**
    * optional ID3 tags
    */
    //public ID3TagSpec tag_spec;

    this.tag_spec = null;
    this.nMusicCRC = 0;
    /* variables used by Quantize */
    //public int OldValue[] = new int[2];

    this.OldValue = $38dac00579cf6ffc$var$new_int(2); //public int CurrentStep[] = new int[2];

    this.CurrentStep = $38dac00579cf6ffc$var$new_int(2);
    this.masking_lower = 0.; //public int bv_scf[] = new int[576];

    this.bv_scf = $38dac00579cf6ffc$var$new_int(576); //public int pseudohalf[] = new int[L3Side.SFBMAX];

    this.pseudohalf = $38dac00579cf6ffc$var$new_int($arIi9.SFBMAX);
    /**
    * will be set in lame_init_params
    */

    this.sfb21_extra = false;
    /* BPC = maximum number of filter convolution windows to precompute */
    //public float[][] inbuf_old = new float[2][];

    this.inbuf_old = new Array(2); //public float[][] blackfilt = new float[2 * BPC + 1][];

    this.blackfilt = new Array(2 * $38dac00579cf6ffc$var$LameInternalFlags.BPC + 1); //public double itime[] = new double[2];

    this.itime = $38dac00579cf6ffc$var$new_double(2);
    this.sideinfo_len = 0;
    /* variables for newmdct.c */
    //public float sb_sample[][][][] = new float[2][2][18][Encoder.SBLIMIT];

    this.sb_sample = $38dac00579cf6ffc$var$new_float_n([2, 2, 18, $cPNKB.SBLIMIT]);
    this.amp_filter = $38dac00579cf6ffc$var$new_float(32);
    /* variables for BitStream */

    /**
    * <PRE>
    * mpeg1: buffer=511 bytes  smallest frame: 96-38(sideinfo)=58
    * max number of frames in reservoir:  8
    * mpeg2: buffer=255 bytes.  smallest frame: 24-23bytes=1
    * with VBR, if you are encoding all silence, it is possible to
    * have 8kbs/24khz frames with 1byte of data each, which means we need
    * to buffer up to 255 headers!
    * </PRE>
    */

    /**
    * also, max_header_buf has to be a power of two
    */

    /**
    * max size of header is 38
    */

    function Header() {
      this.write_timing = 0;
      this.ptr = 0; //public byte buf[] = new byte[MAX_HEADER_LEN];

      this.buf = $38dac00579cf6ffc$var$new_byte(MAX_HEADER_LEN);
    }

    this.header = new Array($38dac00579cf6ffc$var$LameInternalFlags.MAX_HEADER_BUF);
    this.h_ptr = 0;
    this.w_ptr = 0;
    this.ancillary_flag = 0;
    /* variables for Reservoir */

    /**
    * in bits
    */

    this.ResvSize = 0;
    /**
    * in bits
    */

    this.ResvMax = 0; //public ScaleFac scalefac_band = new ScaleFac();

    this.scalefac_band = new $7imnH();
    /* daa from PsyModel */

    /* The static variables "r", "phi_sav", "new", "old" and "oldest" have */

    /* to be remembered for the unpredictability measure. For "r" and */

    /* "phi_sav", the first index from the left is the channel select and */

    /* the second index is the "age" of the data. */

    this.minval_l = $38dac00579cf6ffc$var$new_float($cPNKB.CBANDS);
    this.minval_s = $38dac00579cf6ffc$var$new_float($cPNKB.CBANDS);
    this.nb_1 = $38dac00579cf6ffc$var$new_float_n([4, $cPNKB.CBANDS]);
    this.nb_2 = $38dac00579cf6ffc$var$new_float_n([4, $cPNKB.CBANDS]);
    this.nb_s1 = $38dac00579cf6ffc$var$new_float_n([4, $cPNKB.CBANDS]);
    this.nb_s2 = $38dac00579cf6ffc$var$new_float_n([4, $cPNKB.CBANDS]);
    this.s3_ss = null;
    this.s3_ll = null;
    this.decay = 0.; //public III_psy_xmin[] thm = new III_psy_xmin[4];
    //public III_psy_xmin[] en = new III_psy_xmin[4];

    this.thm = new Array(4);
    this.en = new Array(4);
    /**
    * fft and energy calculation
    */

    this.tot_ener = $38dac00579cf6ffc$var$new_float(4);
    /* loudness calculation (for adaptive threshold of hearing) */

    /**
    * loudness^2 approx. per granule and channel
    */

    this.loudness_sq = $38dac00579cf6ffc$var$new_float_n([2, 2]);
    /**
    * account for granule delay of L3psycho_anal
    */

    this.loudness_sq_save = $38dac00579cf6ffc$var$new_float(2);
    /**
    * Scale Factor Bands
    */

    this.mld_l = $38dac00579cf6ffc$var$new_float($cPNKB.SBMAX_l);
    this.mld_s = $38dac00579cf6ffc$var$new_float($cPNKB.SBMAX_s);
    this.bm_l = $38dac00579cf6ffc$var$new_int($cPNKB.SBMAX_l);
    this.bo_l = $38dac00579cf6ffc$var$new_int($cPNKB.SBMAX_l);
    this.bm_s = $38dac00579cf6ffc$var$new_int($cPNKB.SBMAX_s);
    this.bo_s = $38dac00579cf6ffc$var$new_int($cPNKB.SBMAX_s);
    this.npart_l = 0;
    this.npart_s = 0;
    this.s3ind = $38dac00579cf6ffc$var$new_int_n([$cPNKB.CBANDS, 2]);
    this.s3ind_s = $38dac00579cf6ffc$var$new_int_n([$cPNKB.CBANDS, 2]);
    this.numlines_s = $38dac00579cf6ffc$var$new_int($cPNKB.CBANDS);
    this.numlines_l = $38dac00579cf6ffc$var$new_int($cPNKB.CBANDS);
    this.rnumlines_l = $38dac00579cf6ffc$var$new_float($cPNKB.CBANDS);
    this.mld_cb_l = $38dac00579cf6ffc$var$new_float($cPNKB.CBANDS);
    this.mld_cb_s = $38dac00579cf6ffc$var$new_float($cPNKB.CBANDS);
    this.numlines_s_num1 = 0;
    this.numlines_l_num1 = 0;
    /* ratios */

    this.pe = $38dac00579cf6ffc$var$new_float(4);
    this.ms_ratio_s_old = 0.;
    this.ms_ratio_l_old = 0.;
    this.ms_ener_ratio_old = 0.;
    /**
    * block type
    */

    this.blocktype_old = $38dac00579cf6ffc$var$new_int(2);
    /**
    * variables used for --nspsytune
    */

    this.nsPsy = new $7yzUB();
    /**
    * used for Xing VBR header
    */

    this.VBR_seek_table = new $jTmCQ();
    /**
    * all ATH related stuff
    */
    //public ATH ATH;

    this.ATH = null;
    this.PSY = null;
    this.nogap_total = 0;
    this.nogap_current = 0;
    /* ReplayGain */

    this.decode_on_the_fly = true;
    this.findReplayGain = true;
    this.findPeakSample = true;
    this.PeakSample = 0.;
    this.RadioGain = 0;
    this.AudiophileGain = 0; //public ReplayGain rgdata;

    this.rgdata = null;
    /**
    * gain change required for preventing clipping
    */

    this.noclipGainChange = 0;
    /**
    * user-specified scale factor required for preventing clipping
    */

    this.noclipScale = 0.;
    /* simple statistics */

    this.bitrate_stereoMode_Hist = $38dac00579cf6ffc$var$new_int_n([16, 5]);
    /**
    * norm/start/short/stop/mixed(short)/sum
    */

    this.bitrate_blockType_Hist = $38dac00579cf6ffc$var$new_int_n([16, 6]); //public PlottingData pinfo;
    //public MPGLib.mpstr_tag hip;

    this.pinfo = null;
    this.hip = null;
    this.in_buffer_nsamples = 0; //public float[] in_buffer_0;
    //public float[] in_buffer_1;

    this.in_buffer_0 = null;
    this.in_buffer_1 = null; //public IIterationLoop iteration_loop;

    this.iteration_loop = null;

    for (var i = 0; i < this.en.length; i++) this.en[i] = new $51XxS();

    for (var i = 0; i < this.thm.length; i++) this.thm[i] = new $51XxS();

    for (var i = 0; i < this.header.length; i++) this.header[i] = new Header();
  }

  module.exports = $38dac00579cf6ffc$var$LameInternalFlags;
});
parcelRequire.register("eWXBy", function (module, exports) {
  var $3YDN3 = parcelRequire("3YDN3");
  $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  $3YDN3.new_float;
  $3YDN3.new_float_n;
  var $ae24b7bb56fee1da$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  $3YDN3.assert;
  var $7weBo = parcelRequire("7weBo");

  function $ae24b7bb56fee1da$var$IIISideInfo() {
    this.tt = [[null, null], [null, null]];
    this.main_data_begin = 0;
    this.private_bits = 0;
    this.resvDrain_pre = 0;
    this.resvDrain_post = 0;
    this.scfsi = [$ae24b7bb56fee1da$var$new_int(4), $ae24b7bb56fee1da$var$new_int(4)];

    for (var gr = 0; gr < 2; gr++) for (var ch = 0; ch < 2; ch++) this.tt[gr][ch] = new $7weBo();
  }

  module.exports = $ae24b7bb56fee1da$var$IIISideInfo;
});
parcelRequire.register("7weBo", function (module, exports) {
  //package mp3;
  var $3YDN3 = parcelRequire("3YDN3");
  $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $5796d93ba9162632$var$new_float = $3YDN3.new_float;
  $3YDN3.new_float_n;
  var $5796d93ba9162632$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  $3YDN3.assert;
  var $arIi9 = parcelRequire("arIi9");

  function $5796d93ba9162632$var$GrInfo() {
    //float xr[] = new float[576];
    this.xr = $5796d93ba9162632$var$new_float(576); //int l3_enc[] = new int[576];

    this.l3_enc = $5796d93ba9162632$var$new_int(576); //int scalefac[] = new int[L3Side.SFBMAX];

    this.scalefac = $5796d93ba9162632$var$new_int($arIi9.SFBMAX);
    this.xrpow_max = 0.;
    this.part2_3_length = 0;
    this.big_values = 0;
    this.count1 = 0;
    this.global_gain = 0;
    this.scalefac_compress = 0;
    this.block_type = 0;
    this.mixed_block_flag = 0;
    this.table_select = $5796d93ba9162632$var$new_int(3);
    this.subblock_gain = $5796d93ba9162632$var$new_int(4);
    this.region0_count = 0;
    this.region1_count = 0;
    this.preflag = 0;
    this.scalefac_scale = 0;
    this.count1table_select = 0;
    this.part2_length = 0;
    this.sfb_lmax = 0;
    this.sfb_smin = 0;
    this.psy_lmax = 0;
    this.sfbmax = 0;
    this.psymax = 0;
    this.sfbdivide = 0;
    this.width = $5796d93ba9162632$var$new_int($arIi9.SFBMAX);
    this.window = $5796d93ba9162632$var$new_int($arIi9.SFBMAX);
    this.count1bits = 0;
    /**
    * added for LSF
    */

    this.sfb_partition_table = null;
    this.slen = $5796d93ba9162632$var$new_int(4);
    this.max_nonzero_coeff = 0;
    var self = this;

    function clone_int(array) {
      return new Int32Array(array);
    }

    function clone_float(array) {
      return new Float32Array(array);
    }

    this.assign = function (other) {
      self.xr = clone_float(other.xr); //.slice(0); //clone();

      self.l3_enc = clone_int(other.l3_enc); //.slice(0); //clone();

      self.scalefac = clone_int(other.scalefac); //.slice(0); //clone();

      self.xrpow_max = other.xrpow_max;
      self.part2_3_length = other.part2_3_length;
      self.big_values = other.big_values;
      self.count1 = other.count1;
      self.global_gain = other.global_gain;
      self.scalefac_compress = other.scalefac_compress;
      self.block_type = other.block_type;
      self.mixed_block_flag = other.mixed_block_flag;
      self.table_select = clone_int(other.table_select); //.slice(0); //clone();

      self.subblock_gain = clone_int(other.subblock_gain); //.slice(0); //.clone();

      self.region0_count = other.region0_count;
      self.region1_count = other.region1_count;
      self.preflag = other.preflag;
      self.scalefac_scale = other.scalefac_scale;
      self.count1table_select = other.count1table_select;
      self.part2_length = other.part2_length;
      self.sfb_lmax = other.sfb_lmax;
      self.sfb_smin = other.sfb_smin;
      self.psy_lmax = other.psy_lmax;
      self.sfbmax = other.sfbmax;
      self.psymax = other.psymax;
      self.sfbdivide = other.sfbdivide;
      self.width = clone_int(other.width); //.slice(0); //.clone();

      self.window = clone_int(other.window); //.slice(0); //.clone();

      self.count1bits = other.count1bits;
      self.sfb_partition_table = other.sfb_partition_table.slice(0); //.clone();

      self.slen = clone_int(other.slen); //.slice(0); //.clone();

      self.max_nonzero_coeff = other.max_nonzero_coeff;
    };
  }

  module.exports = $5796d93ba9162632$var$GrInfo;
});
parcelRequire.register("arIi9", function (module, exports) {
  var $cPNKB = parcelRequire("cPNKB");
  var $79aec86e829b6e82$var$L3Side = {};
  /**
  * max scalefactor band, max(SBMAX_l, SBMAX_s*3, (SBMAX_s-3)*3+8)
  */

  $79aec86e829b6e82$var$L3Side.SFBMAX = $cPNKB.SBMAX_s * 3;
  module.exports = $79aec86e829b6e82$var$L3Side;
});
parcelRequire.register("7imnH", function (module, exports) {
  //package mp3;

  /**
   * Layer III side information.
   *
   * @author Ken
   *
   */
  var $3YDN3 = parcelRequire("3YDN3");
  var $54fb93475471cb87$var$System = $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  $3YDN3.new_float;
  $3YDN3.new_float_n;
  var $54fb93475471cb87$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  $3YDN3.assert;
  var $cPNKB = parcelRequire("cPNKB");

  function $54fb93475471cb87$var$ScaleFac(arrL, arrS, arr21, arr12) {
    this.l = $54fb93475471cb87$var$new_int(1 + $cPNKB.SBMAX_l);
    this.s = $54fb93475471cb87$var$new_int(1 + $cPNKB.SBMAX_s);
    this.psfb21 = $54fb93475471cb87$var$new_int(1 + $cPNKB.PSFB21);
    this.psfb12 = $54fb93475471cb87$var$new_int(1 + $cPNKB.PSFB12);
    var l = this.l;
    var s = this.s;

    if (arguments.length == 4) {
      //public ScaleFac(final int[] arrL, final int[] arrS, final int[] arr21,
      //    final int[] arr12) {
      this.arrL = arguments[0];
      this.arrS = arguments[1];
      this.arr21 = arguments[2];
      this.arr12 = arguments[3];
      $54fb93475471cb87$var$System.arraycopy(this.arrL, 0, l, 0, Math.min(this.arrL.length, this.l.length));
      $54fb93475471cb87$var$System.arraycopy(this.arrS, 0, s, 0, Math.min(this.arrS.length, this.s.length));
      $54fb93475471cb87$var$System.arraycopy(this.arr21, 0, this.psfb21, 0, Math.min(this.arr21.length, this.psfb21.length));
      $54fb93475471cb87$var$System.arraycopy(this.arr12, 0, this.psfb12, 0, Math.min(this.arr12.length, this.psfb12.length));
    }
  }

  module.exports = $54fb93475471cb87$var$ScaleFac;
});
parcelRequire.register("7yzUB", function (module, exports) {
  var $3YDN3 = parcelRequire("3YDN3");
  $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $580790bdd94a8b57$var$new_float = $3YDN3.new_float;
  var $580790bdd94a8b57$var$new_float_n = $3YDN3.new_float_n;
  var $580790bdd94a8b57$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  $3YDN3.assert;
  var $cPNKB = parcelRequire("cPNKB"); //package mp3;

  /**
   * Variables used for --nspsytune
   *
   * @author Ken
   *
   */

  function $580790bdd94a8b57$var$NsPsy() {
    this.last_en_subshort = $580790bdd94a8b57$var$new_float_n([4, 9]);
    this.lastAttacks = $580790bdd94a8b57$var$new_int(4);
    this.pefirbuf = $580790bdd94a8b57$var$new_float(19);
    this.longfact = $580790bdd94a8b57$var$new_float($cPNKB.SBMAX_l);
    this.shortfact = $580790bdd94a8b57$var$new_float($cPNKB.SBMAX_s);
    /**
    * short block tuning
    */

    this.attackthre = 0.;
    this.attackthre_s = 0.;
  }

  module.exports = $580790bdd94a8b57$var$NsPsy;
});
parcelRequire.register("jTmCQ", function (module, exports) {
  //package mp3;
  function $e7b4b455db8db26b$var$VBRSeekInfo() {
    /**
    * What we have seen so far.
    */
    this.sum = 0;
    /**
    * How many frames we have seen in this chunk.
    */

    this.seen = 0;
    /**
    * How many frames we want to collect into one chunk.
    */

    this.want = 0;
    /**
    * Actual position in our bag.
    */

    this.pos = 0;
    /**
    * Size of our bag.
    */

    this.size = 0;
    /**
    * Pointer to our bag.
    */

    this.bag = null;
    this.nVbrNumFrames = 0;
    this.nBytesWritten = 0;
    /* VBR tag data */

    this.TotalFrameSize = 0;
  }

  module.exports = $e7b4b455db8db26b$var$VBRSeekInfo;
});
parcelRequire.register("cU3Yf", function (module, exports) {
  var $3YDN3 = parcelRequire("3YDN3");
  $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $964dcb8066029e00$var$new_float = $3YDN3.new_float;
  $3YDN3.new_float_n;
  $3YDN3.new_int;
  $3YDN3.new_int_n;
  $3YDN3.assert;
  var $cPNKB = parcelRequire("cPNKB");
  /**
  * ATH related stuff, if something new ATH related has to be added, please plug
  * it here into the ATH.
  */

  function $964dcb8066029e00$var$ATH() {
    /**
    * Method for the auto adjustment.
    */
    this.useAdjust = 0;
    /**
    * factor for tuning the (sample power) point below which adaptive threshold
    * of hearing adjustment occurs
    */

    this.aaSensitivityP = 0.;
    /**
    * Lowering based on peak volume, 1 = no lowering.
    */

    this.adjust = 0.;
    /**
    * Limit for dynamic ATH adjust.
    */

    this.adjustLimit = 0.;
    /**
    * Determined to lower x dB each second.
    */

    this.decay = 0.;
    /**
    * Lowest ATH value.
    */

    this.floor = 0.;
    /**
    * ATH for sfbs in long blocks.
    */

    this.l = $964dcb8066029e00$var$new_float($cPNKB.SBMAX_l);
    /**
    * ATH for sfbs in short blocks.
    */

    this.s = $964dcb8066029e00$var$new_float($cPNKB.SBMAX_s);
    /**
    * ATH for partitioned sfb21 in long blocks.
    */

    this.psfb21 = $964dcb8066029e00$var$new_float($cPNKB.PSFB21);
    /**
    * ATH for partitioned sfb12 in short blocks.
    */

    this.psfb12 = $964dcb8066029e00$var$new_float($cPNKB.PSFB12);
    /**
    * ATH for long block convolution bands.
    */

    this.cb_l = $964dcb8066029e00$var$new_float($cPNKB.CBANDS);
    /**
    * ATH for short block convolution bands.
    */

    this.cb_s = $964dcb8066029e00$var$new_float($cPNKB.CBANDS);
    /**
    * Equal loudness weights (based on ATH).
    */

    this.eql_w = $964dcb8066029e00$var$new_float($cPNKB.BLKSIZE / 2);
  }

  module.exports = $964dcb8066029e00$var$ATH;
});
parcelRequire.register("2qGTD", function (module, exports) {
  var $3YDN3 = parcelRequire("3YDN3");
  $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $1c4f48cc96a3a753$var$new_float = $3YDN3.new_float;
  $3YDN3.new_float_n;
  var $1c4f48cc96a3a753$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  $3YDN3.assert;
  var $b8dhq = parcelRequire("b8dhq");

  function $1c4f48cc96a3a753$var$ReplayGain() {
    this.linprebuf = $1c4f48cc96a3a753$var$new_float($b8dhq.MAX_ORDER * 2);
    /**
    * left input samples, with pre-buffer
    */

    this.linpre = 0;
    this.lstepbuf = $1c4f48cc96a3a753$var$new_float($b8dhq.MAX_SAMPLES_PER_WINDOW + $b8dhq.MAX_ORDER);
    /**
    * left "first step" (i.e. post first filter) samples
    */

    this.lstep = 0;
    this.loutbuf = $1c4f48cc96a3a753$var$new_float($b8dhq.MAX_SAMPLES_PER_WINDOW + $b8dhq.MAX_ORDER);
    /**
    * left "out" (i.e. post second filter) samples
    */

    this.lout = 0;
    this.rinprebuf = $1c4f48cc96a3a753$var$new_float($b8dhq.MAX_ORDER * 2);
    /**
    * right input samples ...
    */

    this.rinpre = 0;
    this.rstepbuf = $1c4f48cc96a3a753$var$new_float($b8dhq.MAX_SAMPLES_PER_WINDOW + $b8dhq.MAX_ORDER);
    this.rstep = 0;
    this.routbuf = $1c4f48cc96a3a753$var$new_float($b8dhq.MAX_SAMPLES_PER_WINDOW + $b8dhq.MAX_ORDER);
    this.rout = 0;
    /**
    * number of samples required to reach number of milliseconds required
    * for RMS window
    */

    this.sampleWindow = 0;
    this.totsamp = 0;
    this.lsum = 0.;
    this.rsum = 0.;
    this.freqindex = 0;
    this.first = 0;
    this.A = $1c4f48cc96a3a753$var$new_int(0 | $b8dhq.STEPS_per_dB * $b8dhq.MAX_dB);
    this.B = $1c4f48cc96a3a753$var$new_int(0 | $b8dhq.STEPS_per_dB * $b8dhq.MAX_dB);
  }

  module.exports = $1c4f48cc96a3a753$var$ReplayGain;
});
parcelRequire.register("b8dhq", function (module, exports) {
  /*
  *  ReplayGainAnalysis - analyzes input samples and give the recommended dB change
  *  Copyright (C) 2001 David Robinson and Glen Sawyer
  *  Improvements and optimizations added by Frank Klemm, and by Marcel Muller 
  *
  *  This library is free software; you can redistribute it and/or
  *  modify it under the terms of the GNU Lesser General Public
  *  License as published by the Free Software Foundation; either
  *  version 2.1 of the License, or (at your option) any later version.
  *
  *  This library is distributed in the hope that it will be useful,
  *  but WITHOUT ANY WARRANTY; without even the implied warranty of
  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  *  Lesser General Public License for more details.
  *
  *  You should have received a copy of the GNU Lesser General Public
  *  License along with this library; if not, write to the Free Software
  *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
  *
  *  concept and filter values by David Robinson (David@Robinson.org)
  *    -- blame him if you think the idea is flawed
  *  original coding by Glen Sawyer (mp3gain@hotmail.com)
  *    -- blame him if you think this runs too slowly, or the coding is otherwise flawed
  *
  *  lots of code improvements by Frank Klemm ( http://www.uni-jena.de/~pfk/mpp/ )
  *    -- credit him for all the _good_ programming ;)
  *
  *
  *  For an explanation of the concepts and the basic algorithms involved, go to:
  *    http://www.replaygain.org/
  */

  /*
  *  Here's the deal. Call
  *
  *    InitGainAnalysis ( long samplefreq );
  *
  *  to initialize everything. Call
  *
  *    AnalyzeSamples ( var Float_t*  left_samples,
  *                     var Float_t*  right_samples,
  *                     size_t          num_samples,
  *                     int             num_channels );
  *
  *  as many times as you want, with as many or as few samples as you want.
  *  If mono, pass the sample buffer in through left_samples, leave
  *  right_samples NULL, and make sure num_channels = 1.
  *
  *    GetTitleGain()
  *
  *  will return the recommended dB level change for all samples analyzed
  *  SINCE THE LAST TIME you called GetTitleGain() OR InitGainAnalysis().
  *
  *    GetAlbumGain()
  *
  *  will return the recommended dB level change for all samples analyzed
  *  since InitGainAnalysis() was called and finalized with GetTitleGain().
  *
  *  Pseudo-code to process an album:
  *
  *    Float_t       l_samples [4096];
  *    Float_t       r_samples [4096];
  *    size_t        num_samples;
  *    unsigned int  num_songs;
  *    unsigned int  i;
  *
  *    InitGainAnalysis ( 44100 );
  *    for ( i = 1; i <= num_songs; i++ ) {
  *        while ( ( num_samples = getSongSamples ( song[i], left_samples, right_samples ) ) > 0 )
  *            AnalyzeSamples ( left_samples, right_samples, num_samples, 2 );
  *        fprintf ("Recommended dB change for song %2d: %+6.2 dB\n", i, GetTitleGain() );
  *    }
  *    fprintf ("Recommended dB change for whole album: %+6.2 dB\n", GetAlbumGain() );
  */

  /*
  *  So here's the main source of potential code confusion:
  *
  *  The filters applied to the incoming samples are IIR filters,
  *  meaning they rely on up to <filter order> number of previous samples
  *  AND up to <filter order> number of previous filtered samples.
  *
  *  I set up the AnalyzeSamples routine to minimize memory usage and interface
  *  complexity. The speed isn't compromised too much (I don't think), but the
  *  internal complexity is higher than it should be for such a relatively
  *  simple routine.
  *
  *  Optimization/clarity suggestions are welcome.
  */
  var $3YDN3 = parcelRequire("3YDN3");
  var $81aabe360221f821$var$System = $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  var $81aabe360221f821$var$Arrays = $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  $3YDN3.new_float;
  $3YDN3.new_float_n;
  $3YDN3.new_int;
  $3YDN3.new_int_n;
  $3YDN3.assert;
  /**
  * Table entries per dB
  */

  $81aabe360221f821$var$GainAnalysis.STEPS_per_dB = 100.;
  /**
  * Table entries for 0...MAX_dB (normal max. values are 70...80 dB)
  */

  $81aabe360221f821$var$GainAnalysis.MAX_dB = 120.;
  $81aabe360221f821$var$GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES = -24601;
  $81aabe360221f821$var$GainAnalysis.GAIN_ANALYSIS_ERROR = 0;
  $81aabe360221f821$var$GainAnalysis.GAIN_ANALYSIS_OK = 1;
  $81aabe360221f821$var$GainAnalysis.INIT_GAIN_ANALYSIS_ERROR = 0;
  $81aabe360221f821$var$GainAnalysis.INIT_GAIN_ANALYSIS_OK = 1;
  $81aabe360221f821$var$GainAnalysis.YULE_ORDER = 10;
  $81aabe360221f821$var$GainAnalysis.MAX_ORDER = $81aabe360221f821$var$GainAnalysis.YULE_ORDER;
  $81aabe360221f821$var$GainAnalysis.MAX_SAMP_FREQ = 48000;
  $81aabe360221f821$var$GainAnalysis.RMS_WINDOW_TIME_NUMERATOR = 1;
  $81aabe360221f821$var$GainAnalysis.RMS_WINDOW_TIME_DENOMINATOR = 20;
  $81aabe360221f821$var$GainAnalysis.MAX_SAMPLES_PER_WINDOW = $81aabe360221f821$var$GainAnalysis.MAX_SAMP_FREQ * $81aabe360221f821$var$GainAnalysis.RMS_WINDOW_TIME_NUMERATOR / $81aabe360221f821$var$GainAnalysis.RMS_WINDOW_TIME_DENOMINATOR + 1;

  function $81aabe360221f821$var$GainAnalysis() {
    /**
    * calibration value for 89dB
    */
    var PINK_REF = 64.82;
    $81aabe360221f821$var$GainAnalysis.YULE_ORDER;
    /**
    * percentile which is louder than the proposed level
    */

    var RMS_PERCENTILE = 0.95;
    /**
    * maximum allowed sample frequency [Hz]
    */

    $81aabe360221f821$var$GainAnalysis.MAX_SAMP_FREQ;
    var RMS_WINDOW_TIME_NUMERATOR = $81aabe360221f821$var$GainAnalysis.RMS_WINDOW_TIME_NUMERATOR;
    /**
    * numerator / denominator = time slice size [s]
    */

    var RMS_WINDOW_TIME_DENOMINATOR = $81aabe360221f821$var$GainAnalysis.RMS_WINDOW_TIME_DENOMINATOR;
    /**
    * max. Samples per Time slice
    */

    $81aabe360221f821$var$GainAnalysis.MAX_SAMPLES_PER_WINDOW;
    var ABYule = [[0.03857599435200, -3.84664617118067, -0.02160367184185, 7.81501653005538, -0.00123395316851, -11.34170355132042, -0.00009291677959, 13.05504219327545, -0.01655260341619, -12.28759895145294, 0.02161526843274, 9.48293806319790, -0.02074045215285, -5.87257861775999, 0.00594298065125, 2.75465861874613, 0.00306428023191, -0.86984376593551, 0.00012025322027, 0.13919314567432, 0.00288463683916], [0.05418656406430, -3.47845948550071, -0.02911007808948, 6.36317777566148, -0.00848709379851, -8.54751527471874, -0.00851165645469, 9.47693607801280, -0.00834990904936, -8.81498681370155, 0.02245293253339, 6.85401540936998, -0.02596338512915, -4.39470996079559, 0.01624864962975, 2.19611684890774, -0.00240879051584, -0.75104302451432, 0.00674613682247, 0.13149317958808, -0.00187763777362], [0.15457299681924, -2.37898834973084, -0.09331049056315, 2.84868151156327, -0.06247880153653, -2.64577170229825, 0.02163541888798, 2.23697657451713, -0.05588393329856, -1.67148153367602, 0.04781476674921, 1.00595954808547, 0.00222312597743, -0.45953458054983, 0.03174092540049, 0.16378164858596, -0.01390589421898, -0.05032077717131, 0.00651420667831, 0.02347897407020, -0.00881362733839], [0.30296907319327, -1.61273165137247, -0.22613988682123, 1.07977492259970, -0.08587323730772, -0.2565625775407, 0.03282930172664, -0.1627671912044, -0.00915702933434, -0.22638893773906, -0.02364141202522, 0.39120800788284, -0.00584456039913, -0.22138138954925, 0.06276101321749, 0.04500235387352, -0.00000828086748, 0.02005851806501, 0.00205861885564, 0.00302439095741, -0.02950134983287], [0.33642304856132, -1.49858979367799, -0.2557224142557, 0.87350271418188, -0.11828570177555, 0.12205022308084, 0.11921148675203, -0.80774944671438, -0.07834489609479, 0.47854794562326, -0.0046997791438, -0.12453458140019, -0.0058950022444, -0.04067510197014, 0.05724228140351, 0.08333755284107, 0.00832043980773, -0.04237348025746, -0.0163538138454, 0.02977207319925, -0.0176017656815], [0.44915256608450, -0.62820619233671, -0.14351757464547, 0.29661783706366, -0.22784394429749, -0.372563729424, -0.01419140100551, 0.00213767857124, 0.04078262797139, -0.42029820170918, -0.12398163381748, 0.22199650564824, 0.04097565135648, 0.00613424350682, 0.10478503600251, 0.06747620744683, -0.01863887810927, 0.05784820375801, -0.03193428438915, 0.03222754072173, 0.00541907748707], [0.56619470757641, -1.04800335126349, -0.75464456939302, 0.29156311971249, 0.16242137742230, -0.26806001042947, 0.16744243493672, 0.00819999645858, -0.18901604199609, 0.45054734505008, 0.30931782841830, -0.33032403314006, -0.27562961986224, 0.06739368333110, 0.00647310677246, -0.04784254229033, 0.08647503780351, 0.01639907836189, -0.0378898455484, 0.01807364323573, -0.00588215443421], [0.58100494960553, -0.51035327095184, -0.53174909058578, -0.31863563325245, -0.14289799034253, -0.20256413484477, 0.17520704835522, 0.14728154134330, 0.02377945217615, 0.38952639978999, 0.15558449135573, -0.23313271880868, -0.25344790059353, -0.05246019024463, 0.01628462406333, -0.02505961724053, 0.06920467763959, 0.02442357316099, -0.03721611395801, 0.01818801111503, -0.00749618797172], [0.53648789255105, -0.2504987195602, -0.42163034350696, -0.43193942311114, -0.00275953611929, -0.03424681017675, 0.04267842219415, -0.04678328784242, -0.10214864179676, 0.26408300200955, 0.14590772289388, 0.15113130533216, -0.02459864859345, -0.17556493366449, -0.11202315195388, -0.18823009262115, -0.04060034127, 0.05477720428674, 0.04788665548180, 0.04704409688120, -0.02217936801134]];
    var ABButter = [[0.98621192462708, -1.97223372919527, -1.97242384925416, 0.97261396931306, 0.98621192462708], [0.98500175787242, -1.96977855582618, -1.97000351574484, 0.97022847566350, 0.98500175787242], [0.97938932735214, -1.95835380975398, -1.95877865470428, 0.95920349965459, 0.97938932735214], [0.97531843204928, -1.95002759149878, -1.95063686409857, 0.95124613669835, 0.97531843204928], [0.97316523498161, -1.94561023566527, -1.94633046996323, 0.94705070426118, 0.97316523498161], [0.96454515552826, -1.92783286977036, -1.92909031105652, 0.93034775234268, 0.96454515552826], [0.96009142950541, -1.91858953033784, -1.92018285901082, 0.92177618768381, 0.96009142950541], [0.95856916599601, -1.9154210807478, -1.91713833199203, 0.91885558323625, 0.95856916599601], [0.94597685600279, -1.88903307939452, -1.89195371200558, 0.89487434461664, 0.94597685600279]];
    /**
    * When calling this procedure, make sure that ip[-order] and op[-order]
    * point to real data
    */
    //private void filterYule(final float[] input, int inputPos, float[] output,
    //int outputPos, int nSamples, final float[] kernel) {

    function filterYule(input, inputPos, output, outputPos, nSamples, kernel) {
      while (nSamples-- != 0) {
        /* 1e-10 is a hack to avoid slowdown because of denormals */
        output[outputPos] = 1e-10 + input[inputPos + 0] * kernel[0] - output[outputPos - 1] * kernel[1] + input[inputPos - 1] * kernel[2] - output[outputPos - 2] * kernel[3] + input[inputPos - 2] * kernel[4] - output[outputPos - 3] * kernel[5] + input[inputPos - 3] * kernel[6] - output[outputPos - 4] * kernel[7] + input[inputPos - 4] * kernel[8] - output[outputPos - 5] * kernel[9] + input[inputPos - 5] * kernel[10] - output[outputPos - 6] * kernel[11] + input[inputPos - 6] * kernel[12] - output[outputPos - 7] * kernel[13] + input[inputPos - 7] * kernel[14] - output[outputPos - 8] * kernel[15] + input[inputPos - 8] * kernel[16] - output[outputPos - 9] * kernel[17] + input[inputPos - 9] * kernel[18] - output[outputPos - 10] * kernel[19] + input[inputPos - 10] * kernel[20];
        ++outputPos;
        ++inputPos;
      }
    } //private void filterButter(final float[] input, int inputPos,
    //    float[] output, int outputPos, int nSamples, final float[] kernel) {


    function filterButter(input, inputPos, output, outputPos, nSamples, kernel) {
      while (nSamples-- != 0) {
        output[outputPos] = input[inputPos + 0] * kernel[0] - output[outputPos - 1] * kernel[1] + input[inputPos - 1] * kernel[2] - output[outputPos - 2] * kernel[3] + input[inputPos - 2] * kernel[4];
        ++outputPos;
        ++inputPos;
      }
    }
    /**
    * @return INIT_GAIN_ANALYSIS_OK if successful, INIT_GAIN_ANALYSIS_ERROR if
    *         not
    */


    function ResetSampleFrequency(rgData, samplefreq) {
      /* zero out initial values */
      for (var i = 0; i < MAX_ORDER; i++) rgData.linprebuf[i] = rgData.lstepbuf[i] = rgData.loutbuf[i] = rgData.rinprebuf[i] = rgData.rstepbuf[i] = rgData.routbuf[i] = 0.;

      switch (0 | samplefreq) {
        case 48000:
          rgData.reqindex = 0;
          break;

        case 44100:
          rgData.reqindex = 1;
          break;

        case 32000:
          rgData.reqindex = 2;
          break;

        case 24000:
          rgData.reqindex = 3;
          break;

        case 22050:
          rgData.reqindex = 4;
          break;

        case 16000:
          rgData.reqindex = 5;
          break;

        case 12000:
          rgData.reqindex = 6;
          break;

        case 11025:
          rgData.reqindex = 7;
          break;

        case 8000:
          rgData.reqindex = 8;
          break;

        default:
          return INIT_GAIN_ANALYSIS_ERROR;
      }

      rgData.sampleWindow = 0 | (samplefreq * RMS_WINDOW_TIME_NUMERATOR + RMS_WINDOW_TIME_DENOMINATOR - 1) / RMS_WINDOW_TIME_DENOMINATOR;
      rgData.lsum = 0.;
      rgData.rsum = 0.;
      rgData.totsamp = 0;
      $81aabe360221f821$var$Arrays.ill(rgData.A, 0);
      return INIT_GAIN_ANALYSIS_OK;
    }

    this.InitGainAnalysis = function (rgData, samplefreq) {
      if (ResetSampleFrequency(rgData, samplefreq) != INIT_GAIN_ANALYSIS_OK) return INIT_GAIN_ANALYSIS_ERROR;
      rgData.linpre = MAX_ORDER;
      rgData.rinpre = MAX_ORDER;
      rgData.lstep = MAX_ORDER;
      rgData.rstep = MAX_ORDER;
      rgData.lout = MAX_ORDER;
      rgData.rout = MAX_ORDER;
      $81aabe360221f821$var$Arrays.fill(rgData.B, 0);
      return INIT_GAIN_ANALYSIS_OK;
    };
    /**
    * square
    */


    function fsqr(d) {
      return d * d;
    }

    this.AnalyzeSamples = function (rgData, left_samples, left_samplesPos, right_samples, right_samplesPos, num_samples, num_channels) {
      var curleft;
      var curleftBase;
      var curright;
      var currightBase;
      var batchsamples;
      var cursamples;
      var cursamplepos;
      if (num_samples == 0) return GAIN_ANALYSIS_OK;
      cursamplepos = 0;
      batchsamples = num_samples;

      switch (num_channels) {
        case 1:
          right_samples = left_samples;
          right_samplesPos = left_samplesPos;
          break;

        case 2:
          break;

        default:
          return GAIN_ANALYSIS_ERROR;
      }

      if (num_samples < MAX_ORDER) {
        $81aabe360221f821$var$System.arraycopy(left_samples, left_samplesPos, rgData.linprebuf, MAX_ORDER, num_samples);
        $81aabe360221f821$var$System.arraycopy(right_samples, right_samplesPos, rgData.rinprebuf, MAX_ORDER, num_samples);
      } else {
        $81aabe360221f821$var$System.arraycopy(left_samples, left_samplesPos, rgData.linprebuf, MAX_ORDER, MAX_ORDER);
        $81aabe360221f821$var$System.arraycopy(right_samples, right_samplesPos, rgData.rinprebuf, MAX_ORDER, MAX_ORDER);
      }

      while (batchsamples > 0) {
        cursamples = batchsamples > rgData.sampleWindow - rgData.totsamp ? rgData.sampleWindow - rgData.totsamp : batchsamples;

        if (cursamplepos < MAX_ORDER) {
          curleft = rgData.linpre + cursamplepos;
          curleftBase = rgData.linprebuf;
          curright = rgData.rinpre + cursamplepos;
          currightBase = rgData.rinprebuf;
          if (cursamples > MAX_ORDER - cursamplepos) cursamples = MAX_ORDER - cursamplepos;
        } else {
          curleft = left_samplesPos + cursamplepos;
          curleftBase = left_samples;
          curright = right_samplesPos + cursamplepos;
          currightBase = right_samples;
        }

        filterYule(curleftBase, curleft, rgData.lstepbuf, rgData.lstep + rgData.totsamp, cursamples, ABYule[rgData.reqindex]);
        filterYule(currightBase, curright, rgData.rstepbuf, rgData.rstep + rgData.totsamp, cursamples, ABYule[rgData.reqindex]);
        filterButter(rgData.lstepbuf, rgData.lstep + rgData.totsamp, rgData.loutbuf, rgData.lout + rgData.totsamp, cursamples, ABButter[rgData.reqindex]);
        filterButter(rgData.rstepbuf, rgData.rstep + rgData.totsamp, rgData.routbuf, rgData.rout + rgData.totsamp, cursamples, ABButter[rgData.reqindex]);
        curleft = rgData.lout + rgData.totsamp;
        /* Get the squared values */

        curleftBase = rgData.loutbuf;
        curright = rgData.rout + rgData.totsamp;
        currightBase = rgData.routbuf;
        var i = cursamples % 8;

        while (i-- != 0) {
          rgData.lsum += fsqr(curleftBase[curleft++]);
          rgData.rsum += fsqr(currightBase[curright++]);
        }

        i = cursamples / 8;

        while (i-- != 0) {
          rgData.lsum += fsqr(curleftBase[curleft + 0]) + fsqr(curleftBase[curleft + 1]) + fsqr(curleftBase[curleft + 2]) + fsqr(curleftBase[curleft + 3]) + fsqr(curleftBase[curleft + 4]) + fsqr(curleftBase[curleft + 5]) + fsqr(curleftBase[curleft + 6]) + fsqr(curleftBase[curleft + 7]);
          curleft += 8;
          rgData.rsum += fsqr(currightBase[curright + 0]) + fsqr(currightBase[curright + 1]) + fsqr(currightBase[curright + 2]) + fsqr(currightBase[curright + 3]) + fsqr(currightBase[curright + 4]) + fsqr(currightBase[curright + 5]) + fsqr(currightBase[curright + 6]) + fsqr(currightBase[curright + 7]);
          curright += 8;
        }

        batchsamples -= cursamples;
        cursamplepos += cursamples;
        rgData.totsamp += cursamples;

        if (rgData.totsamp == rgData.sampleWindow) {
          /* Get the Root Mean Square (RMS) for this set of samples */
          var val = $81aabe360221f821$var$GainAnalysis.STEPS_per_dB * 10. * Math.log10((rgData.lsum + rgData.rsum) / rgData.totsamp * 0.5 + 1.e-37);
          var ival = val <= 0 ? 0 : 0 | val;
          if (ival >= rgData.A.length) ival = rgData.A.length - 1;
          rgData.A[ival]++;
          rgData.lsum = rgData.rsum = 0.;
          $81aabe360221f821$var$System.arraycopy(rgData.loutbuf, rgData.totsamp, rgData.loutbuf, 0, MAX_ORDER);
          $81aabe360221f821$var$System.arraycopy(rgData.routbuf, rgData.totsamp, rgData.routbuf, 0, MAX_ORDER);
          $81aabe360221f821$var$System.arraycopy(rgData.lstepbuf, rgData.totsamp, rgData.lstepbuf, 0, MAX_ORDER);
          $81aabe360221f821$var$System.arraycopy(rgData.rstepbuf, rgData.totsamp, rgData.rstepbuf, 0, MAX_ORDER);
          rgData.totsamp = 0;
        }

        if (rgData.totsamp > rgData.sampleWindow)
          /*
          * somehow I really screwed up: Error in programming! Contact
          * author about totsamp > sampleWindow
          */
          return GAIN_ANALYSIS_ERROR;
      }

      if (num_samples < MAX_ORDER) {
        $81aabe360221f821$var$System.arraycopy(rgData.linprebuf, num_samples, rgData.linprebuf, 0, MAX_ORDER - num_samples);
        $81aabe360221f821$var$System.arraycopy(rgData.rinprebuf, num_samples, rgData.rinprebuf, 0, MAX_ORDER - num_samples);
        $81aabe360221f821$var$System.arraycopy(left_samples, left_samplesPos, rgData.linprebuf, MAX_ORDER - num_samples, num_samples);
        $81aabe360221f821$var$System.arraycopy(right_samples, right_samplesPos, rgData.rinprebuf, MAX_ORDER - num_samples, num_samples);
      } else {
        $81aabe360221f821$var$System.arraycopy(left_samples, left_samplesPos + num_samples - MAX_ORDER, rgData.linprebuf, 0, MAX_ORDER);
        $81aabe360221f821$var$System.arraycopy(right_samples, right_samplesPos + num_samples - MAX_ORDER, rgData.rinprebuf, 0, MAX_ORDER);
      }

      return GAIN_ANALYSIS_OK;
    };

    function analyzeResult(Array, len) {
      var i;
      var elems = 0;

      for (i = 0; i < len; i++) elems += Array[i];

      if (elems == 0) return GAIN_NOT_ENOUGH_SAMPLES;
      var upper = 0 | Math.ceil(elems * (1. - RMS_PERCENTILE));

      for (i = len; i-- > 0;) {
        if ((upper -= Array[i]) <= 0) break;
      } //return (float) ((float) PINK_REF - (float) i / (float) STEPS_per_dB);


      return PINK_REF - i / $81aabe360221f821$var$GainAnalysis.STEPS_per_dB;
    }

    this.GetTitleGain = function (rgData) {
      var retval = analyzeResult(rgData.A, rgData.A.length);

      for (var i = 0; i < rgData.A.length; i++) {
        rgData.B[i] += rgData.A[i];
        rgData.A[i] = 0;
      }

      for (var i = 0; i < MAX_ORDER; i++) rgData.linprebuf[i] = rgData.lstepbuf[i] = rgData.loutbuf[i] = rgData.rinprebuf[i] = rgData.rstepbuf[i] = rgData.routbuf[i] = 0.;

      rgData.totsamp = 0;
      rgData.lsum = rgData.rsum = 0.;
      return retval;
    };
  }

  module.exports = $81aabe360221f821$var$GainAnalysis;
});
parcelRequire.register("e32wu", function (module, exports) {
  var $3YDN3 = parcelRequire("3YDN3");
  $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $a3a34d831b8c1682$var$new_float = $3YDN3.new_float;
  $3YDN3.new_float_n;
  var $a3a34d831b8c1682$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  var $a3a34d831b8c1682$var$assert = $3YDN3.assert;
  var $lL4Le = parcelRequire("lL4Le");
  var $cPNKB = parcelRequire("cPNKB");
  var $arIi9 = parcelRequire("arIi9");
  var $4SDnr = parcelRequire("4SDnr");

  function $a3a34d831b8c1682$var$CBRNewIterationLoop(_quantize) {
    var quantize = _quantize;
    this.quantize = quantize;

    this.iteration_loop = function (gfp, pe, ms_ener_ratio, ratio) {
      var gfc = gfp.internal_flags;
      var l3_xmin = $a3a34d831b8c1682$var$new_float($arIi9.SFBMAX);
      var xrpow = $a3a34d831b8c1682$var$new_float(576);
      var targ_bits = $a3a34d831b8c1682$var$new_int(2);
      var mean_bits = 0,
          max_bits;
      var l3_side = gfc.l3_side;
      var mb = new $lL4Le(mean_bits);
      this.quantize.rv.ResvFrameBegin(gfp, mb);
      mean_bits = mb.bits;
      /* quantize! */

      for (var gr = 0; gr < gfc.mode_gr; gr++) {
        /*
        * calculate needed bits
        */
        max_bits = this.quantize.qupvt.on_pe(gfp, pe, targ_bits, mean_bits, gr, gr);

        if (gfc.mode_ext == $cPNKB.MPG_MD_MS_LR) {
          this.quantize.ms_convert(gfc.l3_side, gr);
          this.quantize.qupvt.reduce_side(targ_bits, ms_ener_ratio[gr], mean_bits, max_bits);
        }

        for (var ch = 0; ch < gfc.channels_out; ch++) {
          var adjust, masking_lower_db;
          var cod_info = l3_side.tt[gr][ch];

          if (cod_info.block_type != $cPNKB.SHORT_TYPE) {
            // NORM, START or STOP type
            adjust = 0;
            masking_lower_db = gfc.PSY.mask_adjust - adjust;
          } else {
            adjust = 0;
            masking_lower_db = gfc.PSY.mask_adjust_short - adjust;
          }

          gfc.masking_lower = Math.pow(10.0, masking_lower_db * 0.1);
          /*
          * init_outer_loop sets up cod_info, scalefac and xrpow
          */

          this.quantize.init_outer_loop(gfc, cod_info);

          if (this.quantize.init_xrpow(gfc, cod_info, xrpow)) {
            /*
            * xr contains energy we will have to encode calculate the
            * masking abilities find some good quantization in
            * outer_loop
            */
            this.quantize.qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info, l3_xmin);
            this.quantize.outer_loop(gfp, cod_info, l3_xmin, xrpow, ch, targ_bits[ch]);
          }

          this.quantize.iteration_finish_one(gfc, gr, ch);
          $a3a34d831b8c1682$var$assert(cod_info.part2_3_length <= $4SDnr.MAX_BITS_PER_CHANNEL);
          $a3a34d831b8c1682$var$assert(cod_info.part2_3_length <= targ_bits[ch]);
        }
        /* for ch */

      }
      /* for gr */


      this.quantize.rv.ResvFrameEnd(gfc, mean_bits);
    };
  }

  module.exports = $a3a34d831b8c1682$var$CBRNewIterationLoop;
});
parcelRequire.register("lL4Le", function (module, exports) {
  function $fd71ae23813c0974$var$MeanBits(meanBits) {
    this.bits = meanBits;
  }

  module.exports = $fd71ae23813c0974$var$MeanBits;
});
parcelRequire.register("ctaQC", function (module, exports) {
  var $3YDN3 = parcelRequire("3YDN3");
  var $91409b9649b00300$var$System = $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  var $91409b9649b00300$var$Arrays = $3YDN3.Arrays;
  $3YDN3.new_array_n;
  var $91409b9649b00300$var$new_byte = $3YDN3.new_byte;
  $3YDN3.new_double;
  $3YDN3.new_float;
  var $91409b9649b00300$var$new_float_n = $3YDN3.new_float_n;
  var $91409b9649b00300$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  var $91409b9649b00300$var$assert = $3YDN3.assert;
  var $65Sx2 = parcelRequire("65Sx2");
  var $dQDcS = parcelRequire("dQDcS");
  var $cPNKB = parcelRequire("cPNKB");
  var $4SDnr = parcelRequire("4SDnr");

  $91409b9649b00300$var$BitStream.EQ = function (a, b) {
    return Math.abs(a) > Math.abs(b) ? Math.abs(a - b) <= Math.abs(a) * 1e-6 : Math.abs(a - b) <= Math.abs(b) * 1e-6;
  };

  $91409b9649b00300$var$BitStream.NEQ = function (a, b) {
    return !$91409b9649b00300$var$BitStream.EQ(a, b);
  };

  function $91409b9649b00300$var$BitStream() {
    var Lame = parcelRequire("kk1yk");
    var self = this;
    var CRC16_POLYNOMIAL = 0x8005;
    /*
    * we work with ints, so when doing bit manipulation, we limit ourselves to
    * MAX_LENGTH-2 just to be on the safe side
    */

    var MAX_LENGTH = 32; //GainAnalysis ga;
    //MPGLib mpg;
    //Version ver;
    //VBRTag vbr;

    var ga = null;
    var mpg = null;
    var ver = null;
    var vbr = null; //public final void setModules(GainAnalysis ga, MPGLib mpg, Version ver,
    //	VBRTag vbr) {

    this.setModules = function (_ga, _mpg, _ver, _vbr) {
      ga = _ga;
      mpg = _mpg;
      ver = _ver;
      vbr = _vbr;
    };
    /**
    * Bit stream buffer.
    */
    //private byte[] buf;


    var buf = null;
    /**
    * Bit counter of bit stream.
    */

    var totbit = 0;
    /**
    * Pointer to top byte in buffer.
    */

    var bufByteIdx = 0;
    /**
    * Pointer to top bit of top byte in buffer.
    */

    var bufBitIdx = 0;
    /**
    * compute bitsperframe and mean_bits for a layer III frame
    */

    this.getframebits = function (gfp) {
      var gfc = gfp.internal_flags;
      var bit_rate;
      /* get bitrate in kbps [?] */

      if (gfc.bitrate_index != 0) bit_rate = $dQDcS.bitrate_table[gfp.version][gfc.bitrate_index];else bit_rate = gfp.brate;
      $91409b9649b00300$var$assert(8 <= bit_rate && bit_rate <= 640);
      /* main encoding routine toggles padding on and off */

      /* one Layer3 Slot consists of 8 bits */

      var bytes = 0 | (gfp.version + 1) * 72000 * bit_rate / gfp.out_samplerate + gfc.padding;
      return 8 * bytes;
    };

    function putheader_bits(gfc) {
      $91409b9649b00300$var$System.arraycopy(gfc.header[gfc.w_ptr].buf, 0, buf, bufByteIdx, gfc.sideinfo_len);
      bufByteIdx += gfc.sideinfo_len;
      totbit += gfc.sideinfo_len * 8;
      gfc.w_ptr = gfc.w_ptr + 1 & $4SDnr.MAX_HEADER_BUF - 1;
    }
    /**
    * write j bits into the bit stream
    */


    function putbits2(gfc, val, j) {
      $91409b9649b00300$var$assert(j < MAX_LENGTH - 2);

      while (j > 0) {
        var k;

        if (bufBitIdx == 0) {
          bufBitIdx = 8;
          bufByteIdx++;
          $91409b9649b00300$var$assert(bufByteIdx < Lame.LAME_MAXMP3BUFFER);
          $91409b9649b00300$var$assert(gfc.header[gfc.w_ptr].write_timing >= totbit);
          if (gfc.header[gfc.w_ptr].write_timing == totbit) putheader_bits(gfc);
          buf[bufByteIdx] = 0;
        }

        k = Math.min(j, bufBitIdx);
        j -= k;
        bufBitIdx -= k;
        $91409b9649b00300$var$assert(j < MAX_LENGTH);
        /* 32 too large on 32 bit machines */

        $91409b9649b00300$var$assert(bufBitIdx < MAX_LENGTH);
        buf[bufByteIdx] |= val >> j << bufBitIdx;
        totbit += k;
      }
    }
    /**
    * write j bits into the bit stream, ignoring frame headers
    */


    function putbits_noheaders(gfc, val, j) {
      $91409b9649b00300$var$assert(j < MAX_LENGTH - 2);

      while (j > 0) {
        var k;

        if (bufBitIdx == 0) {
          bufBitIdx = 8;
          bufByteIdx++;
          $91409b9649b00300$var$assert(bufByteIdx < Lame.LAME_MAXMP3BUFFER);
          buf[bufByteIdx] = 0;
        }

        k = Math.min(j, bufBitIdx);
        j -= k;
        bufBitIdx -= k;
        $91409b9649b00300$var$assert(j < MAX_LENGTH);
        /* 32 too large on 32 bit machines */

        $91409b9649b00300$var$assert(bufBitIdx < MAX_LENGTH);
        buf[bufByteIdx] |= val >> j << bufBitIdx;
        totbit += k;
      }
    }
    /**
    * Some combinations of bitrate, Fs, and stereo make it impossible to stuff
    * out a frame using just main_data, due to the limited number of bits to
    * indicate main_data_length. In these situations, we put stuffing bits into
    * the ancillary data...
    */


    function drain_into_ancillary(gfp, remainingBits) {
      var gfc = gfp.internal_flags;
      var i;
      $91409b9649b00300$var$assert(remainingBits >= 0);

      if (remainingBits >= 8) {
        putbits2(gfc, 0x4c, 8);
        remainingBits -= 8;
      }

      if (remainingBits >= 8) {
        putbits2(gfc, 0x41, 8);
        remainingBits -= 8;
      }

      if (remainingBits >= 8) {
        putbits2(gfc, 0x4d, 8);
        remainingBits -= 8;
      }

      if (remainingBits >= 8) {
        putbits2(gfc, 0x45, 8);
        remainingBits -= 8;
      }

      if (remainingBits >= 32) {
        var version = ver.getLameShortVersion();
        if (remainingBits >= 32) for (i = 0; i < version.length && remainingBits >= 8; ++i) {
          remainingBits -= 8;
          putbits2(gfc, version.charAt(i), 8);
        }
      }

      for (; remainingBits >= 1; remainingBits -= 1) {
        putbits2(gfc, gfc.ancillary_flag, 1);
        gfc.ancillary_flag ^= !gfp.disable_reservoir ? 1 : 0;
      }

      $91409b9649b00300$var$assert(remainingBits == 0);
    }
    /**
    * write N bits into the header
    */


    function writeheader(gfc, val, j) {
      var ptr = gfc.header[gfc.h_ptr].ptr;

      while (j > 0) {
        var k = Math.min(j, 8 - (ptr & 7));
        j -= k;
        $91409b9649b00300$var$assert(j < MAX_LENGTH);
        /* >> 32 too large for 32 bit machines */

        gfc.header[gfc.h_ptr].buf[ptr >> 3] |= val >> j << 8 - (ptr & 7) - k;
        ptr += k;
      }

      gfc.header[gfc.h_ptr].ptr = ptr;
    }

    function CRC_update(value, crc) {
      value <<= 8;

      for (var i = 0; i < 8; i++) {
        value <<= 1;
        crc <<= 1;
        if (((crc ^ value) & 0x10000) != 0) crc ^= CRC16_POLYNOMIAL;
      }

      return crc;
    }

    this.CRC_writeheader = function (gfc, header) {
      var crc = 0xffff;
      /* (jo) init crc16 for error_protection */

      crc = CRC_update(header[2] & 0xff, crc);
      crc = CRC_update(header[3] & 0xff, crc);

      for (var i = 6; i < gfc.sideinfo_len; i++) crc = CRC_update(header[i] & 0xff, crc);

      header[4] = byte(crc >> 8);
      header[5] = byte(crc & 255);
    };

    function encodeSideInfo2(gfp, bitsPerFrame) {
      var gfc = gfp.internal_flags;
      var l3_side;
      var gr, ch;
      l3_side = gfc.l3_side;
      gfc.header[gfc.h_ptr].ptr = 0;
      $91409b9649b00300$var$Arrays.fill(gfc.header[gfc.h_ptr].buf, 0, gfc.sideinfo_len, 0);
      if (gfp.out_samplerate < 16000) writeheader(gfc, 0xffe, 12);else writeheader(gfc, 0xfff, 12);
      writeheader(gfc, gfp.version, 1);
      writeheader(gfc, 1, 2);
      writeheader(gfc, !gfp.error_protection ? 1 : 0, 1);
      writeheader(gfc, gfc.bitrate_index, 4);
      writeheader(gfc, gfc.samplerate_index, 2);
      writeheader(gfc, gfc.padding, 1);
      writeheader(gfc, gfp.extension, 1);
      writeheader(gfc, gfp.mode.ordinal(), 2);
      writeheader(gfc, gfc.mode_ext, 2);
      writeheader(gfc, gfp.copyright, 1);
      writeheader(gfc, gfp.original, 1);
      writeheader(gfc, gfp.emphasis, 2);
      if (gfp.error_protection) writeheader(gfc, 0, 16);

      if (gfp.version == 1) {
        /* MPEG1 */
        $91409b9649b00300$var$assert(l3_side.main_data_begin >= 0);
        writeheader(gfc, l3_side.main_data_begin, 9);
        if (gfc.channels_out == 2) writeheader(gfc, l3_side.private_bits, 3);else writeheader(gfc, l3_side.private_bits, 5);

        for (ch = 0; ch < gfc.channels_out; ch++) {
          var band;

          for (band = 0; band < 4; band++) writeheader(gfc, l3_side.scfsi[ch][band], 1);
        }

        for (gr = 0; gr < 2; gr++) for (ch = 0; ch < gfc.channels_out; ch++) {
          var gi = l3_side.tt[gr][ch];
          writeheader(gfc, gi.part2_3_length + gi.part2_length, 12);
          writeheader(gfc, gi.big_values / 2, 9);
          writeheader(gfc, gi.global_gain, 8);
          writeheader(gfc, gi.scalefac_compress, 4);

          if (gi.block_type != $cPNKB.NORM_TYPE) {
            writeheader(gfc, 1, 1);
            /* window_switching_flag */

            writeheader(gfc, gi.block_type, 2);
            writeheader(gfc, gi.mixed_block_flag, 1);
            if (gi.table_select[0] == 14) gi.table_select[0] = 16;
            writeheader(gfc, gi.table_select[0], 5);
            if (gi.table_select[1] == 14) gi.table_select[1] = 16;
            writeheader(gfc, gi.table_select[1], 5);
            writeheader(gfc, gi.subblock_gain[0], 3);
            writeheader(gfc, gi.subblock_gain[1], 3);
            writeheader(gfc, gi.subblock_gain[2], 3);
          } else {
            writeheader(gfc, 0, 1);
            /* window_switching_flag */

            if (gi.table_select[0] == 14) gi.table_select[0] = 16;
            writeheader(gfc, gi.table_select[0], 5);
            if (gi.table_select[1] == 14) gi.table_select[1] = 16;
            writeheader(gfc, gi.table_select[1], 5);
            if (gi.table_select[2] == 14) gi.table_select[2] = 16;
            writeheader(gfc, gi.table_select[2], 5);
            $91409b9649b00300$var$assert(0 <= gi.region0_count && gi.region0_count < 16);
            $91409b9649b00300$var$assert(0 <= gi.region1_count && gi.region1_count < 8);
            writeheader(gfc, gi.region0_count, 4);
            writeheader(gfc, gi.region1_count, 3);
          }

          writeheader(gfc, gi.preflag, 1);
          writeheader(gfc, gi.scalefac_scale, 1);
          writeheader(gfc, gi.count1table_select, 1);
        }
      } else {
        /* MPEG2 */
        $91409b9649b00300$var$assert(l3_side.main_data_begin >= 0);
        writeheader(gfc, l3_side.main_data_begin, 8);
        writeheader(gfc, l3_side.private_bits, gfc.channels_out);
        gr = 0;

        for (ch = 0; ch < gfc.channels_out; ch++) {
          var gi = l3_side.tt[gr][ch];
          writeheader(gfc, gi.part2_3_length + gi.part2_length, 12);
          writeheader(gfc, gi.big_values / 2, 9);
          writeheader(gfc, gi.global_gain, 8);
          writeheader(gfc, gi.scalefac_compress, 9);

          if (gi.block_type != $cPNKB.NORM_TYPE) {
            writeheader(gfc, 1, 1);
            /* window_switching_flag */

            writeheader(gfc, gi.block_type, 2);
            writeheader(gfc, gi.mixed_block_flag, 1);
            if (gi.table_select[0] == 14) gi.table_select[0] = 16;
            writeheader(gfc, gi.table_select[0], 5);
            if (gi.table_select[1] == 14) gi.table_select[1] = 16;
            writeheader(gfc, gi.table_select[1], 5);
            writeheader(gfc, gi.subblock_gain[0], 3);
            writeheader(gfc, gi.subblock_gain[1], 3);
            writeheader(gfc, gi.subblock_gain[2], 3);
          } else {
            writeheader(gfc, 0, 1);
            /* window_switching_flag */

            if (gi.table_select[0] == 14) gi.table_select[0] = 16;
            writeheader(gfc, gi.table_select[0], 5);
            if (gi.table_select[1] == 14) gi.table_select[1] = 16;
            writeheader(gfc, gi.table_select[1], 5);
            if (gi.table_select[2] == 14) gi.table_select[2] = 16;
            writeheader(gfc, gi.table_select[2], 5);
            $91409b9649b00300$var$assert(0 <= gi.region0_count && gi.region0_count < 16);
            $91409b9649b00300$var$assert(0 <= gi.region1_count && gi.region1_count < 8);
            writeheader(gfc, gi.region0_count, 4);
            writeheader(gfc, gi.region1_count, 3);
          }

          writeheader(gfc, gi.scalefac_scale, 1);
          writeheader(gfc, gi.count1table_select, 1);
        }
      }

      if (gfp.error_protection)
        /* (jo) error_protection: add crc16 information to header */
        CRC_writeheader(gfc, gfc.header[gfc.h_ptr].buf);
      var old = gfc.h_ptr;
      $91409b9649b00300$var$assert(gfc.header[old].ptr == gfc.sideinfo_len * 8);
      gfc.h_ptr = old + 1 & $4SDnr.MAX_HEADER_BUF - 1;
      gfc.header[gfc.h_ptr].write_timing = gfc.header[old].write_timing + bitsPerFrame;
      if (gfc.h_ptr == gfc.w_ptr)
        /* yikes! we are out of header buffer space */
        $91409b9649b00300$var$System.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n");
    }

    function huffman_coder_count1(gfc, gi) {
      /* Write count1 area */
      var h = $dQDcS.ht[gi.count1table_select + 32];
      var i,
          bits = 0;
      var ix = gi.big_values;
      var xr = gi.big_values;
      $91409b9649b00300$var$assert(gi.count1table_select < 2);

      for (i = (gi.count1 - gi.big_values) / 4; i > 0; --i) {
        var huffbits = 0;
        var p = 0,
            v;
        v = gi.l3_enc[ix + 0];

        if (v != 0) {
          p += 8;
          if (gi.xr[xr + 0] < 0) huffbits++;
          $91409b9649b00300$var$assert(v <= 1);
        }

        v = gi.l3_enc[ix + 1];

        if (v != 0) {
          p += 4;
          huffbits *= 2;
          if (gi.xr[xr + 1] < 0) huffbits++;
          $91409b9649b00300$var$assert(v <= 1);
        }

        v = gi.l3_enc[ix + 2];

        if (v != 0) {
          p += 2;
          huffbits *= 2;
          if (gi.xr[xr + 2] < 0) huffbits++;
          $91409b9649b00300$var$assert(v <= 1);
        }

        v = gi.l3_enc[ix + 3];

        if (v != 0) {
          p++;
          huffbits *= 2;
          if (gi.xr[xr + 3] < 0) huffbits++;
          $91409b9649b00300$var$assert(v <= 1);
        }

        ix += 4;
        xr += 4;
        putbits2(gfc, huffbits + h.table[p], h.hlen[p]);
        bits += h.hlen[p];
      }

      return bits;
    }
    /**
    * Implements the pseudocode of page 98 of the IS
    */


    function Huffmancode(gfc, tableindex, start, end, gi) {
      var h = $dQDcS.ht[tableindex];
      var bits = 0;
      $91409b9649b00300$var$assert(tableindex < 32);
      if (0 == tableindex) return bits;

      for (var i = start; i < end; i += 2) {
        var cbits = 0;
        var xbits = 0;
        var linbits = h.xlen;
        var xlen = h.xlen;
        var ext = 0;
        var x1 = gi.l3_enc[i];
        var x2 = gi.l3_enc[i + 1];

        if (x1 != 0) {
          if (gi.xr[i] < 0) ext++;
          cbits--;
        }

        if (tableindex > 15) {
          /* use ESC-words */
          if (x1 > 14) {
            var linbits_x1 = x1 - 15;
            $91409b9649b00300$var$assert(linbits_x1 <= h.linmax);
            ext |= linbits_x1 << 1;
            xbits = linbits;
            x1 = 15;
          }

          if (x2 > 14) {
            var linbits_x2 = x2 - 15;
            $91409b9649b00300$var$assert(linbits_x2 <= h.linmax);
            ext <<= linbits;
            ext |= linbits_x2;
            xbits += linbits;
            x2 = 15;
          }

          xlen = 16;
        }

        if (x2 != 0) {
          ext <<= 1;
          if (gi.xr[i + 1] < 0) ext++;
          cbits--;
        }

        $91409b9649b00300$var$assert((x1 | x2) < 16);
        x1 = x1 * xlen + x2;
        xbits -= cbits;
        cbits += h.hlen[x1];
        $91409b9649b00300$var$assert(cbits <= MAX_LENGTH);
        $91409b9649b00300$var$assert(xbits <= MAX_LENGTH);
        putbits2(gfc, h.table[x1], cbits);
        putbits2(gfc, ext, xbits);
        bits += cbits + xbits;
      }

      return bits;
    }
    /**
    * Note the discussion of huffmancodebits() on pages 28 and 29 of the IS, as
    * well as the definitions of the side information on pages 26 and 27.
    */


    function ShortHuffmancodebits(gfc, gi) {
      var region1Start = 3 * gfc.scalefac_band.s[3];
      if (region1Start > gi.big_values) region1Start = gi.big_values;
      /* short blocks do not have a region2 */

      var bits = Huffmancode(gfc, gi.table_select[0], 0, region1Start, gi);
      bits += Huffmancode(gfc, gi.table_select[1], region1Start, gi.big_values, gi);
      return bits;
    }

    function LongHuffmancodebits(gfc, gi) {
      var bigvalues, bits;
      var region1Start, region2Start;
      bigvalues = gi.big_values;
      $91409b9649b00300$var$assert(0 <= bigvalues && bigvalues <= 576);
      var i = gi.region0_count + 1;
      $91409b9649b00300$var$assert(0 <= i);
      $91409b9649b00300$var$assert(i < gfc.scalefac_band.l.length);
      region1Start = gfc.scalefac_band.l[i];
      i += gi.region1_count + 1;
      $91409b9649b00300$var$assert(0 <= i);
      $91409b9649b00300$var$assert(i < gfc.scalefac_band.l.length);
      region2Start = gfc.scalefac_band.l[i];
      if (region1Start > bigvalues) region1Start = bigvalues;
      if (region2Start > bigvalues) region2Start = bigvalues;
      bits = Huffmancode(gfc, gi.table_select[0], 0, region1Start, gi);
      bits += Huffmancode(gfc, gi.table_select[1], region1Start, region2Start, gi);
      bits += Huffmancode(gfc, gi.table_select[2], region2Start, bigvalues, gi);
      return bits;
    }

    function writeMainData(gfp) {
      var gr,
          ch,
          sfb,
          data_bits,
          tot_bits = 0;
      var gfc = gfp.internal_flags;
      var l3_side = gfc.l3_side;

      if (gfp.version == 1) {
        /* MPEG 1 */
        for (gr = 0; gr < 2; gr++) for (ch = 0; ch < gfc.channels_out; ch++) {
          var gi = l3_side.tt[gr][ch];
          var slen1 = $65Sx2.slen1_tab[gi.scalefac_compress];
          var slen2 = $65Sx2.slen2_tab[gi.scalefac_compress];
          data_bits = 0;

          for (sfb = 0; sfb < gi.sfbdivide; sfb++) {
            if (gi.scalefac[sfb] == -1) continue;
            /* scfsi is used */

            putbits2(gfc, gi.scalefac[sfb], slen1);
            data_bits += slen1;
          }

          for (; sfb < gi.sfbmax; sfb++) {
            if (gi.scalefac[sfb] == -1) continue;
            /* scfsi is used */

            putbits2(gfc, gi.scalefac[sfb], slen2);
            data_bits += slen2;
          }

          $91409b9649b00300$var$assert(data_bits == gi.part2_length);
          if (gi.block_type == $cPNKB.SHORT_TYPE) data_bits += ShortHuffmancodebits(gfc, gi);else data_bits += LongHuffmancodebits(gfc, gi);
          data_bits += huffman_coder_count1(gfc, gi);
          /* does bitcount in quantize.c agree with actual bit count? */

          $91409b9649b00300$var$assert(data_bits == gi.part2_3_length + gi.part2_length);
          tot_bits += data_bits;
        }
        /* for gr */

      } else {
        /* MPEG 2 */
        gr = 0;

        for (ch = 0; ch < gfc.channels_out; ch++) {
          var gi = l3_side.tt[gr][ch];
          var i,
              sfb_partition,
              scale_bits = 0;
          $91409b9649b00300$var$assert(gi.sfb_partition_table != null);
          data_bits = 0;
          sfb = 0;
          sfb_partition = 0;

          if (gi.block_type == $cPNKB.SHORT_TYPE) {
            for (; sfb_partition < 4; sfb_partition++) {
              var sfbs = gi.sfb_partition_table[sfb_partition] / 3;
              var slen = gi.slen[sfb_partition];

              for (i = 0; i < sfbs; i++, sfb++) {
                putbits2(gfc, Math.max(gi.scalefac[sfb * 3 + 0], 0), slen);
                putbits2(gfc, Math.max(gi.scalefac[sfb * 3 + 1], 0), slen);
                putbits2(gfc, Math.max(gi.scalefac[sfb * 3 + 2], 0), slen);
                scale_bits += 3 * slen;
              }
            }

            data_bits += ShortHuffmancodebits(gfc, gi);
          } else {
            for (; sfb_partition < 4; sfb_partition++) {
              var sfbs = gi.sfb_partition_table[sfb_partition];
              var slen = gi.slen[sfb_partition];

              for (i = 0; i < sfbs; i++, sfb++) {
                putbits2(gfc, Math.max(gi.scalefac[sfb], 0), slen);
                scale_bits += slen;
              }
            }

            data_bits += LongHuffmancodebits(gfc, gi);
          }

          data_bits += huffman_coder_count1(gfc, gi);
          /* does bitcount in quantize.c agree with actual bit count? */

          $91409b9649b00300$var$assert(data_bits == gi.part2_3_length);
          $91409b9649b00300$var$assert(scale_bits == gi.part2_length);
          tot_bits += scale_bits + data_bits;
        }
        /* for ch */

      }
      /* for gf */


      return tot_bits;
    }
    /* main_data */


    function TotalBytes() {
      this.total = 0;
    }
    /*
    * compute the number of bits required to flush all mp3 frames currently in
    * the buffer. This should be the same as the reservoir size. Only call this
    * routine between frames - i.e. only after all headers and data have been
    * added to the buffer by format_bitstream().
    *
    * Also compute total_bits_output = size of mp3 buffer (including frame
    * headers which may not have yet been send to the mp3 buffer) + number of
    * bits needed to flush all mp3 frames.
    *
    * total_bytes_output is the size of the mp3 output buffer if
    * lame_encode_flush_nogap() was called right now.
    */


    function compute_flushbits(gfp, total_bytes_output) {
      var gfc = gfp.internal_flags;
      var flushbits, remaining_headers;
      var bitsPerFrame;
      var last_ptr, first_ptr;
      first_ptr = gfc.w_ptr;
      /* first header to add to bitstream */

      last_ptr = gfc.h_ptr - 1;
      /* last header to add to bitstream */

      if (last_ptr == -1) last_ptr = $4SDnr.MAX_HEADER_BUF - 1;
      /* add this many bits to bitstream so we can flush all headers */

      flushbits = gfc.header[last_ptr].write_timing - totbit;
      total_bytes_output.total = flushbits;

      if (flushbits >= 0) {
        /* if flushbits >= 0, some headers have not yet been written */

        /* reduce flushbits by the size of the headers */
        remaining_headers = 1 + last_ptr - first_ptr;
        if (last_ptr < first_ptr) remaining_headers = 1 + last_ptr - first_ptr + $4SDnr.MAX_HEADER_BUF;
        flushbits -= remaining_headers * 8 * gfc.sideinfo_len;
      }
      /*
      * finally, add some bits so that the last frame is complete these bits
      * are not necessary to decode the last frame, but some decoders will
      * ignore last frame if these bits are missing
      */


      bitsPerFrame = self.getframebits(gfp);
      flushbits += bitsPerFrame;
      total_bytes_output.total += bitsPerFrame;
      /* round up: */

      if (total_bytes_output.total % 8 != 0) total_bytes_output.total = 1 + total_bytes_output.total / 8;else total_bytes_output.total = total_bytes_output.total / 8;
      total_bytes_output.total += bufByteIdx + 1;
      if (flushbits < 0) $91409b9649b00300$var$System.err.println("strange error flushing buffer ... \n");
      return flushbits;
    }

    this.flush_bitstream = function (gfp) {
      var gfc = gfp.internal_flags;
      var l3_side;
      var flushbits;
      var last_ptr = gfc.h_ptr - 1;
      /* last header to add to bitstream */

      if (last_ptr == -1) last_ptr = $4SDnr.MAX_HEADER_BUF - 1;
      l3_side = gfc.l3_side;
      if ((flushbits = compute_flushbits(gfp, new TotalBytes())) < 0) return;
      drain_into_ancillary(gfp, flushbits);
      /* check that the 100% of the last frame has been written to bitstream */

      $91409b9649b00300$var$assert(gfc.header[last_ptr].write_timing + this.getframebits(gfp) == totbit);
      /*
      * we have padded out all frames with ancillary data, which is the same
      * as filling the bitreservoir with ancillary data, so :
      */

      gfc.ResvSize = 0;
      l3_side.main_data_begin = 0;
      /* save the ReplayGain value */

      if (gfc.findReplayGain) {
        var RadioGain = ga.GetTitleGain(gfc.rgdata);
        $91409b9649b00300$var$assert(NEQ(RadioGain, GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES));
        gfc.RadioGain = Math.floor(RadioGain * 10.0 + 0.5) | 0;
        /* round to nearest */
      }
      /* find the gain and scale change required for no clipping */


      if (gfc.findPeakSample) {
        gfc.noclipGainChange = Math.ceil(Math.log10(gfc.PeakSample / 32767.0) * 200) | 0;
        /* round up */

        if (gfc.noclipGainChange > 0) {
          /* clipping occurs */
          if (EQ(gfp.scale, 1.0) || EQ(gfp.scale, 0.0)) gfc.noclipScale = Math.floor(32767.0 / gfc.PeakSample * 100.0) / 100.0;else
            /*
            * the user specified his own scaling factor. We could
            * suggest the scaling factor of
            * (32767.0/gfp.PeakSample)*(gfp.scale) but it's usually
            * very inaccurate. So we'd rather not advice him on the
            * scaling factor.
            */
            gfc.noclipScale = -1;
        } else
          /* no clipping */
          gfc.noclipScale = -1;
      }
    };

    this.add_dummy_byte = function (gfp, val, n) {
      var gfc = gfp.internal_flags;
      var i;

      while (n-- > 0) {
        putbits_noheaders(gfc, val, 8);

        for (i = 0; i < $4SDnr.MAX_HEADER_BUF; ++i) gfc.header[i].write_timing += 8;
      }
    };
    /**
    * This is called after a frame of audio has been quantized and coded. It
    * will write the encoded audio to the bitstream. Note that from a layer3
    * encoder's perspective the bit stream is primarily a series of main_data()
    * blocks, with header and side information inserted at the proper locations
    * to maintain framing. (See Figure A.7 in the IS).
    */


    this.format_bitstream = function (gfp) {
      var gfc = gfp.internal_flags;
      var l3_side;
      l3_side = gfc.l3_side;
      var bitsPerFrame = this.getframebits(gfp);
      drain_into_ancillary(gfp, l3_side.resvDrain_pre);
      encodeSideInfo2(gfp, bitsPerFrame);
      var bits = 8 * gfc.sideinfo_len;
      bits += writeMainData(gfp);
      drain_into_ancillary(gfp, l3_side.resvDrain_post);
      bits += l3_side.resvDrain_post;
      l3_side.main_data_begin += (bitsPerFrame - bits) / 8;
      /*
      * compare number of bits needed to clear all buffered mp3 frames with
      * what we think the resvsize is:
      */

      if (compute_flushbits(gfp, new TotalBytes()) != gfc.ResvSize) $91409b9649b00300$var$System.err.println("Internal buffer inconsistency. flushbits <> ResvSize");
      /*
      * compare main_data_begin for the next frame with what we think the
      * resvsize is:
      */

      if (l3_side.main_data_begin * 8 != gfc.ResvSize) {
        $91409b9649b00300$var$System.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n", 8 * l3_side.main_data_begin, gfc.ResvSize, l3_side.resvDrain_post, l3_side.resvDrain_pre, 8 * gfc.sideinfo_len, bits - l3_side.resvDrain_post - 8 * gfc.sideinfo_len, bits, bits % 8, bitsPerFrame);
        $91409b9649b00300$var$System.err.println("This is a fatal error.  It has several possible causes:");
        $91409b9649b00300$var$System.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations");
        $91409b9649b00300$var$System.err.println(" 9%%  Your system is overclocked");
        $91409b9649b00300$var$System.err.println(" 1%%  bug in LAME encoding library");
        gfc.ResvSize = l3_side.main_data_begin * 8;
      } //;


      $91409b9649b00300$var$assert(totbit % 8 == 0);

      if (totbit > 1000000000) {
        /*
        * to avoid totbit overflow, (at 8h encoding at 128kbs) lets reset
        * bit counter
        */
        var i;

        for (i = 0; i < $4SDnr.MAX_HEADER_BUF; ++i) gfc.header[i].write_timing -= totbit;

        totbit = 0;
      }

      return 0;
    };
    /**
    * <PRE>
    * copy data out of the internal MP3 bit buffer into a user supplied
    *       unsigned char buffer.
    *
    *       mp3data=0      indicates data in buffer is an id3tags and VBR tags
    *       mp3data=1      data is real mp3 frame data.
    * </PRE>
    */


    this.copy_buffer = function (gfc, buffer, bufferPos, size, mp3data) {
      var minimum = bufByteIdx + 1;
      if (minimum <= 0) return 0;
      if (size != 0 && minimum > size)
        /* buffer is too small */
        return -1;
      $91409b9649b00300$var$System.arraycopy(buf, 0, buffer, bufferPos, minimum);
      bufByteIdx = -1;
      bufBitIdx = 0;

      if (mp3data != 0) {
        var crc = $91409b9649b00300$var$new_int(1);
        crc[0] = gfc.nMusicCRC;
        vbr.updateMusicCRC(crc, buffer, bufferPos, minimum);
        gfc.nMusicCRC = crc[0];
        /**
        * sum number of bytes belonging to the mp3 stream this info will be
        * written into the Xing/LAME header for seeking
        */

        if (minimum > 0) gfc.VBR_seek_table.nBytesWritten += minimum;

        if (gfc.decode_on_the_fly) {
          var pcm_buf = $91409b9649b00300$var$new_float_n([2, 1152]);
          var mp3_in = minimum;
          var samples_out = -1;
          var i;
          /* re-synthesis to pcm. Repeat until we get a samples_out=0 */

          while (samples_out != 0) {
            samples_out = mpg.hip_decode1_unclipped(gfc.hip, buffer, bufferPos, mp3_in, pcm_buf[0], pcm_buf[1]);
            /*
            * samples_out = 0: need more data to decode samples_out =
            * -1: error. Lets assume 0 pcm output samples_out = number
            * of samples output
            */

            /*
            * set the lenght of the mp3 input buffer to zero, so that
            * in the next iteration of the loop we will be querying
            * mpglib about buffered data
            */

            mp3_in = 0;
            if (samples_out == -1)
              /*
              * error decoding. Not fatal, but might screw up the
              * ReplayGain tag. What should we do? Ignore for now
              */
              samples_out = 0;

            if (samples_out > 0) {
              /* process the PCM data */

              /*
              * this should not be possible, and indicates we have
              * overflown the pcm_buf buffer
              */
              $91409b9649b00300$var$assert(samples_out <= 1152);

              if (gfc.findPeakSample) {
                for (i = 0; i < samples_out; i++) {
                  if (pcm_buf[0][i] > gfc.PeakSample) gfc.PeakSample = pcm_buf[0][i];else if (-pcm_buf[0][i] > gfc.PeakSample) gfc.PeakSample = -pcm_buf[0][i];
                }

                if (gfc.channels_out > 1) for (i = 0; i < samples_out; i++) {
                  if (pcm_buf[1][i] > gfc.PeakSample) gfc.PeakSample = pcm_buf[1][i];else if (-pcm_buf[1][i] > gfc.PeakSample) gfc.PeakSample = -pcm_buf[1][i];
                }
              }

              if (gfc.findReplayGain) {
                if (ga.AnalyzeSamples(gfc.rgdata, pcm_buf[0], 0, pcm_buf[1], 0, samples_out, gfc.channels_out) == GainAnalysis.GAIN_ANALYSIS_ERROR) return -6;
              }
            }
            /* if (samples_out>0) */

          }
          /* while (samples_out!=0) */

        }
        /* if (gfc.decode_on_the_fly) */

      }
      /* if (mp3data) */


      return minimum;
    };

    this.init_bit_stream_w = function (gfc) {
      buf = $91409b9649b00300$var$new_byte(Lame.LAME_MAXMP3BUFFER);
      gfc.h_ptr = gfc.w_ptr = 0;
      gfc.header[gfc.h_ptr].write_timing = 0;
      bufByteIdx = -1;
      bufBitIdx = 0;
      totbit = 0;
    }; // From machine.h

  }

  module.exports = $91409b9649b00300$var$BitStream;
});
parcelRequire.register("65Sx2", function (module, exports) {
  /*
  *	MP3 huffman table selecting and bit counting
  *
  *	Copyright (c) 1999-2005 Takehiro TOMINAGA
  *	Copyright (c) 2002-2005 Gabriel Bouvigne
  *
  * This library is free software; you can redistribute it and/or
  * modify it under the terms of the GNU Lesser General Public
  * License as published by the Free Software Foundation; either
  * version 2 of the License, or (at your option) any later version.
  *
  * This library is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	 See the GNU
  * Library General Public License for more details.
  *
  * You should have received a copy of the GNU Lesser General Public
  * License along with this library; if not, write to the
  * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
  * Boston, MA 02111-1307, USA.
  */

  /* $Id: Takehiro.java,v 1.26 2011/05/24 20:48:06 kenchis Exp $ */
  //package mp3;
  //import java.util.Arrays;
  var $3YDN3 = parcelRequire("3YDN3");
  var $46fd82963609949b$var$System = $3YDN3.System;
  $3YDN3.VbrMode;
  $3YDN3.Float;
  $3YDN3.ShortBlock;
  $3YDN3.Util;
  var $46fd82963609949b$var$Arrays = $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  $3YDN3.new_float;
  $3YDN3.new_float_n;
  var $46fd82963609949b$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  var $46fd82963609949b$var$assert = $3YDN3.assert;
  var $cPNKB = parcelRequire("cPNKB");
  var $dQDcS = parcelRequire("dQDcS");
  var $7weBo = parcelRequire("7weBo");
  var $84mea = parcelRequire("84mea");

  function $46fd82963609949b$var$Takehiro() {
    var qupvt = null;
    this.qupvt = null;

    this.setModules = function (_qupvt) {
      this.qupvt = _qupvt;
      qupvt = _qupvt;
    };

    function Bits(b) {
      this.bits = 0 | b;
    }

    var subdv_table = [[0, 0],
    /* 0 bands */
    [0, 0],
    /* 1 bands */
    [0, 0],
    /* 2 bands */
    [0, 0],
    /* 3 bands */
    [0, 0],
    /* 4 bands */
    [0, 1],
    /* 5 bands */
    [1, 1],
    /* 6 bands */
    [1, 1],
    /* 7 bands */
    [1, 2],
    /* 8 bands */
    [2, 2],
    /* 9 bands */
    [2, 3],
    /* 10 bands */
    [2, 3],
    /* 11 bands */
    [3, 4],
    /* 12 bands */
    [3, 4],
    /* 13 bands */
    [3, 4],
    /* 14 bands */
    [4, 5],
    /* 15 bands */
    [4, 5],
    /* 16 bands */
    [4, 6],
    /* 17 bands */
    [5, 6],
    /* 18 bands */
    [5, 6],
    /* 19 bands */
    [5, 7],
    /* 20 bands */
    [6, 7],
    /* 21 bands */
    [6, 7]];
    /**
    * nonlinear quantization of xr More accurate formula than the ISO formula.
    * Takes into account the fact that we are quantizing xr . ix, but we want
    * ix^4/3 to be as close as possible to x^4/3. (taking the nearest int would
    * mean ix is as close as possible to xr, which is different.)
    *
    * From Segher Boessenkool <segher@eastsite.nl> 11/1999
    *
    * 09/2000: ASM code removed in favor of IEEE754 hack by Takehiro Tominaga.
    * If you need the ASM code, check CVS circa Aug 2000.
    *
    * 01/2004: Optimizations by Gabriel Bouvigne
    */

    function quantize_lines_xrpow_01(l, istep, xr, xrPos, ix, ixPos) {
      var compareval0 = 0.5946 / istep;
      $46fd82963609949b$var$assert(l > 0);
      l = l >> 1;

      while (l-- != 0) {
        ix[ixPos++] = compareval0 > xr[xrPos++] ? 0 : 1;
        ix[ixPos++] = compareval0 > xr[xrPos++] ? 0 : 1;
      }
    }
    /**
    * XRPOW_FTOI is a macro to convert floats to ints.<BR>
    * if XRPOW_FTOI(x) = nearest_int(x), then QUANTFAC(x)=adj43asm[x]<BR>
    * ROUNDFAC= -0.0946<BR>
    *
    * if XRPOW_FTOI(x) = floor(x), then QUANTFAC(x)=asj43[x]<BR>
    * ROUNDFAC=0.4054<BR>
    *
    * Note: using floor() or 0| is extremely slow. On machines where the
    * TAKEHIRO_IEEE754_HACK code above does not work, it is worthwile to write
    * some ASM for XRPOW_FTOI().
    */


    function quantize_lines_xrpow(l, istep, xr, xrPos, ix, ixPos) {
      $46fd82963609949b$var$assert(l > 0);
      l = l >> 1;
      var remaining = l % 2;
      l = l >> 1;

      while (l-- != 0) {
        var x0, x1, x2, x3;
        var rx0, rx1, rx2, rx3;
        x0 = xr[xrPos++] * istep;
        x1 = xr[xrPos++] * istep;
        rx0 = 0 | x0;
        x2 = xr[xrPos++] * istep;
        rx1 = 0 | x1;
        x3 = xr[xrPos++] * istep;
        rx2 = 0 | x2;
        x0 += qupvt.adj43[rx0];
        rx3 = 0 | x3;
        x1 += qupvt.adj43[rx1];
        ix[ixPos++] = 0 | x0;
        x2 += qupvt.adj43[rx2];
        ix[ixPos++] = 0 | x1;
        x3 += qupvt.adj43[rx3];
        ix[ixPos++] = 0 | x2;
        ix[ixPos++] = 0 | x3;
      }

      if (remaining != 0) {
        var x0, x1;
        var rx0, rx1;
        x0 = xr[xrPos++] * istep;
        x1 = xr[xrPos++] * istep;
        rx0 = 0 | x0;
        rx1 = 0 | x1;
        x0 += qupvt.adj43[rx0];
        x1 += qupvt.adj43[rx1];
        ix[ixPos++] = 0 | x0;
        ix[ixPos++] = 0 | x1;
      }
    }
    /**
    * Quantization function This function will select which lines to quantize
    * and call the proper quantization function
    */


    function quantize_xrpow(xp, pi, istep, codInfo, prevNoise) {
      /* quantize on xr^(3/4) instead of xr */
      var sfb;
      var sfbmax;
      var j = 0;
      var prev_data_use;
      var accumulate = 0;
      var accumulate01 = 0;
      var xpPos = 0;
      var iData = pi;
      var iDataPos = 0;
      var acc_iData = iData;
      var acc_iDataPos = 0;
      var acc_xp = xp;
      var acc_xpPos = 0;
      /*
      * Reusing previously computed data does not seems to work if global
      * gain is changed. Finding why it behaves this way would allow to use a
      * cache of previously computed values (let's 10 cached values per sfb)
      * that would probably provide a noticeable speedup
      */

      prev_data_use = prevNoise != null && codInfo.global_gain == prevNoise.global_gain;
      if (codInfo.block_type == $cPNKB.SHORT_TYPE) sfbmax = 38;else sfbmax = 21;

      for (sfb = 0; sfb <= sfbmax; sfb++) {
        var step = -1;
        if (prev_data_use || codInfo.block_type == $cPNKB.NORM_TYPE) step = codInfo.global_gain - (codInfo.scalefac[sfb] + (codInfo.preflag != 0 ? qupvt.pretab[sfb] : 0) << codInfo.scalefac_scale + 1) - codInfo.subblock_gain[codInfo.window[sfb]] * 8;
        $46fd82963609949b$var$assert(codInfo.width[sfb] >= 0);

        if (prev_data_use && prevNoise.step[sfb] == step) {
          /*
          * do not recompute this part, but compute accumulated lines
          */
          if (accumulate != 0) {
            quantize_lines_xrpow(accumulate, istep, acc_xp, acc_xpPos, acc_iData, acc_iDataPos);
            accumulate = 0;
          }

          if (accumulate01 != 0) {
            quantize_lines_xrpow_01(accumulate01, istep, acc_xp, acc_xpPos, acc_iData, acc_iDataPos);
            accumulate01 = 0;
          }
        } else {
          var l = codInfo.width[sfb];

          if (j + codInfo.width[sfb] > codInfo.max_nonzero_coeff) {
            /* do not compute upper zero part */
            var usefullsize;
            usefullsize = codInfo.max_nonzero_coeff - j + 1;
            $46fd82963609949b$var$Arrays.fill(pi, codInfo.max_nonzero_coeff, 576, 0);
            l = usefullsize;
            if (l < 0) l = 0;
            /* no need to compute higher sfb values */

            sfb = sfbmax + 1;
          }
          /* accumulate lines to quantize */


          if (0 == accumulate && 0 == accumulate01) {
            acc_iData = iData;
            acc_iDataPos = iDataPos;
            acc_xp = xp;
            acc_xpPos = xpPos;
          }

          if (prevNoise != null && prevNoise.sfb_count1 > 0 && sfb >= prevNoise.sfb_count1 && prevNoise.step[sfb] > 0 && step >= prevNoise.step[sfb]) {
            if (accumulate != 0) {
              quantize_lines_xrpow(accumulate, istep, acc_xp, acc_xpPos, acc_iData, acc_iDataPos);
              accumulate = 0;
              acc_iData = iData;
              acc_iDataPos = iDataPos;
              acc_xp = xp;
              acc_xpPos = xpPos;
            }

            accumulate01 += l;
          } else {
            if (accumulate01 != 0) {
              quantize_lines_xrpow_01(accumulate01, istep, acc_xp, acc_xpPos, acc_iData, acc_iDataPos);
              accumulate01 = 0;
              acc_iData = iData;
              acc_iDataPos = iDataPos;
              acc_xp = xp;
              acc_xpPos = xpPos;
            }

            accumulate += l;
          }

          if (l <= 0) {
            /*
            * rh: 20040215 may happen due to "prev_data_use"
            * optimization
            */
            if (accumulate01 != 0) {
              quantize_lines_xrpow_01(accumulate01, istep, acc_xp, acc_xpPos, acc_iData, acc_iDataPos);
              accumulate01 = 0;
            }

            if (accumulate != 0) {
              quantize_lines_xrpow(accumulate, istep, acc_xp, acc_xpPos, acc_iData, acc_iDataPos);
              accumulate = 0;
            }

            break;
            /* ends for-loop */
          }
        }

        if (sfb <= sfbmax) {
          iDataPos += codInfo.width[sfb];
          xpPos += codInfo.width[sfb];
          j += codInfo.width[sfb];
        }
      }

      if (accumulate != 0) {
        quantize_lines_xrpow(accumulate, istep, acc_xp, acc_xpPos, acc_iData, acc_iDataPos);
        accumulate = 0;
      }

      if (accumulate01 != 0) {
        quantize_lines_xrpow_01(accumulate01, istep, acc_xp, acc_xpPos, acc_iData, acc_iDataPos);
        accumulate01 = 0;
      }
    }
    /**
    * ix_max
    */


    function ix_max(ix, ixPos, endPos) {
      var max1 = 0,
          max2 = 0;

      do {
        var x1 = ix[ixPos++];
        var x2 = ix[ixPos++];
        if (max1 < x1) max1 = x1;
        if (max2 < x2) max2 = x2;
      } while (ixPos < endPos);

      if (max1 < max2) max1 = max2;
      return max1;
    }

    function count_bit_ESC(ix, ixPos, end, t1, t2, s) {
      /* ESC-table is used */
      var linbits = $dQDcS.ht[t1].xlen * 65536 + $dQDcS.ht[t2].xlen;
      var sum = 0,
          sum2;

      do {
        var x = ix[ixPos++];
        var y = ix[ixPos++];

        if (x != 0) {
          if (x > 14) {
            x = 15;
            sum += linbits;
          }

          x *= 16;
        }

        if (y != 0) {
          if (y > 14) {
            y = 15;
            sum += linbits;
          }

          x += y;
        }

        sum += $dQDcS.largetbl[x];
      } while (ixPos < end);

      sum2 = sum & 0xffff;
      sum >>= 16;

      if (sum > sum2) {
        sum = sum2;
        t1 = t2;
      }

      s.bits += sum;
      return t1;
    }

    function count_bit_noESC(ix, ixPos, end, s) {
      /* No ESC-words */
      var sum1 = 0;
      var hlen1 = $dQDcS.ht[1].hlen;

      do {
        var x = ix[ixPos + 0] * 2 + ix[ixPos + 1];
        ixPos += 2;
        sum1 += hlen1[x];
      } while (ixPos < end);

      s.bits += sum1;
      return 1;
    }

    function count_bit_noESC_from2(ix, ixPos, end, t1, s) {
      /* No ESC-words */
      var sum = 0,
          sum2;
      var xlen = $dQDcS.ht[t1].xlen;
      var hlen;
      if (t1 == 2) hlen = $dQDcS.table23;else hlen = $dQDcS.table56;

      do {
        var x = ix[ixPos + 0] * xlen + ix[ixPos + 1];
        ixPos += 2;
        sum += hlen[x];
      } while (ixPos < end);

      sum2 = sum & 0xffff;
      sum >>= 16;

      if (sum > sum2) {
        sum = sum2;
        t1++;
      }

      s.bits += sum;
      return t1;
    }

    function count_bit_noESC_from3(ix, ixPos, end, t1, s) {
      /* No ESC-words */
      var sum1 = 0;
      var sum2 = 0;
      var sum3 = 0;
      var xlen = $dQDcS.ht[t1].xlen;
      var hlen1 = $dQDcS.ht[t1].hlen;
      var hlen2 = $dQDcS.ht[t1 + 1].hlen;
      var hlen3 = $dQDcS.ht[t1 + 2].hlen;

      do {
        var x = ix[ixPos + 0] * xlen + ix[ixPos + 1];
        ixPos += 2;
        sum1 += hlen1[x];
        sum2 += hlen2[x];
        sum3 += hlen3[x];
      } while (ixPos < end);

      var t = t1;

      if (sum1 > sum2) {
        sum1 = sum2;
        t++;
      }

      if (sum1 > sum3) {
        sum1 = sum3;
        t = t1 + 2;
      }

      s.bits += sum1;
      return t;
    }
    /*************************************************************************/

    /* choose table */

    /*************************************************************************/


    var huf_tbl_noESC = [1, 2, 5, 7, 7, 10, 10, 13, 13, 13, 13, 13, 13, 13, 13];
    /**
    * Choose the Huffman table that will encode ix[begin..end] with the fewest
    * bits.
    *
    * Note: This code contains knowledge about the sizes and characteristics of
    * the Huffman tables as defined in the IS (Table B.7), and will not work
    * with any arbitrary tables.
    */

    function choose_table(ix, ixPos, endPos, s) {
      var max = ix_max(ix, ixPos, endPos);

      switch (max) {
        case 0:
          return max;

        case 1:
          return count_bit_noESC(ix, ixPos, endPos, s);

        case 2:
        case 3:
          return count_bit_noESC_from2(ix, ixPos, endPos, huf_tbl_noESC[max - 1], s);

        case 4:
        case 5:
        case 6:
        case 7:
        case 8:
        case 9:
        case 10:
        case 11:
        case 12:
        case 13:
        case 14:
        case 15:
          return count_bit_noESC_from3(ix, ixPos, endPos, huf_tbl_noESC[max - 1], s);

        default:
          /* try tables with linbits */
          if (max > $84mea.IXMAX_VAL) {
            s.bits = $84mea.LARGE_BITS;
            return -1;
          }

          max -= 15;
          var choice2;

          for (choice2 = 24; choice2 < 32; choice2++) {
            if ($dQDcS.ht[choice2].linmax >= max) break;
          }

          var choice;

          for (choice = choice2 - 8; choice < 24; choice++) {
            if ($dQDcS.ht[choice].linmax >= max) break;
          }

          return count_bit_ESC(ix, ixPos, endPos, choice, choice2, s);
      }
    }
    /**
    * count_bit
    */


    this.noquant_count_bits = function (gfc, gi, prev_noise) {
      var ix = gi.l3_enc;
      var i = Math.min(576, gi.max_nonzero_coeff + 2 >> 1 << 1);
      if (prev_noise != null) prev_noise.sfb_count1 = 0;
      /* Determine count1 region */

      for (; i > 1; i -= 2) if ((ix[i - 1] | ix[i - 2]) != 0) break;

      gi.count1 = i;
      /* Determines the number of bits to encode the quadruples. */

      var a1 = 0;
      var a2 = 0;

      for (; i > 3; i -= 4) {
        var p;
        /* hack to check if all values <= 1 */
        //throw "TODO: HACK         if ((((long) ix[i - 1] | (long) ix[i - 2] | (long) ix[i - 3] | (long) ix[i - 4]) & 0xffffffffL) > 1L        "
        //if (true) {

        if (((ix[i - 1] | ix[i - 2] | ix[i - 3] | ix[i - 4]) & 0x7fffffff) > 1) break;
        p = ((ix[i - 4] * 2 + ix[i - 3]) * 2 + ix[i - 2]) * 2 + ix[i - 1];
        a1 += $dQDcS.t32l[p];
        a2 += $dQDcS.t33l[p];
      }

      var bits = a1;
      gi.count1table_select = 0;

      if (a1 > a2) {
        bits = a2;
        gi.count1table_select = 1;
      }

      gi.count1bits = bits;
      gi.big_values = i;
      if (i == 0) return bits;

      if (gi.block_type == $cPNKB.SHORT_TYPE) {
        a1 = 3 * gfc.scalefac_band.s[3];
        if (a1 > gi.big_values) a1 = gi.big_values;
        a2 = gi.big_values;
      } else if (gi.block_type == $cPNKB.NORM_TYPE) {
        $46fd82963609949b$var$assert(i <= 576);
        /* bv_scf has 576 entries (0..575) */

        a1 = gi.region0_count = gfc.bv_scf[i - 2];
        a2 = gi.region1_count = gfc.bv_scf[i - 1];
        $46fd82963609949b$var$assert(a1 + a2 + 2 < $cPNKB.SBPSY_l);
        a2 = gfc.scalefac_band.l[a1 + a2 + 2];
        a1 = gfc.scalefac_band.l[a1 + 1];

        if (a2 < i) {
          var bi = new Bits(bits);
          gi.table_select[2] = choose_table(ix, a2, i, bi);
          bits = bi.bits;
        }
      } else {
        gi.region0_count = 7;
        /* gi.region1_count = SBPSY_l - 7 - 1; */

        gi.region1_count = $cPNKB.SBMAX_l - 1 - 7 - 1;
        a1 = gfc.scalefac_band.l[8];
        a2 = i;
        if (a1 > a2) a1 = a2;
      }
      /* have to allow for the case when bigvalues < region0 < region1 */

      /* (and region0, region1 are ignored) */


      a1 = Math.min(a1, i);
      a2 = Math.min(a2, i);
      $46fd82963609949b$var$assert(a1 >= 0);
      $46fd82963609949b$var$assert(a2 >= 0);
      /* Count the number of bits necessary to code the bigvalues region. */

      if (0 < a1) {
        var bi = new Bits(bits);
        gi.table_select[0] = choose_table(ix, 0, a1, bi);
        bits = bi.bits;
      }

      if (a1 < a2) {
        var bi = new Bits(bits);
        gi.table_select[1] = choose_table(ix, a1, a2, bi);
        bits = bi.bits;
      }

      if (gfc.use_best_huffman == 2) {
        gi.part2_3_length = bits;
        best_huffman_divide(gfc, gi);
        bits = gi.part2_3_length;
      }

      if (prev_noise != null) {
        if (gi.block_type == $cPNKB.NORM_TYPE) {
          var sfb = 0;

          while (gfc.scalefac_band.l[sfb] < gi.big_values) sfb++;

          prev_noise.sfb_count1 = sfb;
        }
      }

      return bits;
    };

    this.count_bits = function (gfc, xr, gi, prev_noise) {
      var ix = gi.l3_enc;
      /* since quantize_xrpow uses table lookup, we need to check this first: */

      var w = $84mea.IXMAX_VAL / qupvt.IPOW20(gi.global_gain);
      if (gi.xrpow_max > w) return $84mea.LARGE_BITS;
      quantize_xrpow(xr, ix, qupvt.IPOW20(gi.global_gain), gi, prev_noise);

      if ((gfc.substep_shaping & 2) != 0) {
        var j = 0;
        /* 0.634521682242439 = 0.5946*2**(.5*0.1875) */

        var gain = gi.global_gain + gi.scalefac_scale;
        var roundfac = 0.634521682242439 / qupvt.IPOW20(gain);

        for (var sfb = 0; sfb < gi.sfbmax; sfb++) {
          var width = gi.width[sfb];
          $46fd82963609949b$var$assert(width >= 0);
          if (0 == gfc.pseudohalf[sfb]) j += width;else {
            var k;

            for (k = j, j += width; k < j; ++k) ix[k] = xr[k] >= roundfac ? ix[k] : 0;
          }
        }
      }

      return this.noquant_count_bits(gfc, gi, prev_noise);
    };
    /**
    * re-calculate the best scalefac_compress using scfsi the saved bits are
    * kept in the bit reservoir.
    */


    function recalc_divide_init(gfc, cod_info, ix, r01_bits, r01_div, r0_tbl, r1_tbl) {
      var bigv = cod_info.big_values;

      for (var r0 = 0; r0 <= 22; r0++) r01_bits[r0] = $84mea.LARGE_BITS;

      for (var r0 = 0; r0 < 16; r0++) {
        var a1 = gfc.scalefac_band.l[r0 + 1];
        if (a1 >= bigv) break;
        var r0bits = 0;
        var bi = new Bits(r0bits);
        var r0t = choose_table(ix, 0, a1, bi);
        r0bits = bi.bits;

        for (var r1 = 0; r1 < 8; r1++) {
          var a2 = gfc.scalefac_band.l[r0 + r1 + 2];
          if (a2 >= bigv) break;
          var bits = r0bits;
          bi = new Bits(bits);
          var r1t = choose_table(ix, a1, a2, bi);
          bits = bi.bits;

          if (r01_bits[r0 + r1] > bits) {
            r01_bits[r0 + r1] = bits;
            r01_div[r0 + r1] = r0;
            r0_tbl[r0 + r1] = r0t;
            r1_tbl[r0 + r1] = r1t;
          }
        }
      }
    }

    function recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div, r0_tbl, r1_tbl) {
      var bigv = cod_info2.big_values;

      for (var r2 = 2; r2 < $cPNKB.SBMAX_l + 1; r2++) {
        var a2 = gfc.scalefac_band.l[r2];
        if (a2 >= bigv) break;
        var bits = r01_bits[r2 - 2] + cod_info2.count1bits;
        if (gi.part2_3_length <= bits) break;
        var bi = new Bits(bits);
        var r2t = choose_table(ix, a2, bigv, bi);
        bits = bi.bits;
        if (gi.part2_3_length <= bits) continue;
        gi.assign(cod_info2);
        gi.part2_3_length = bits;
        gi.region0_count = r01_div[r2 - 2];
        gi.region1_count = r2 - 2 - r01_div[r2 - 2];
        gi.table_select[0] = r0_tbl[r2 - 2];
        gi.table_select[1] = r1_tbl[r2 - 2];
        gi.table_select[2] = r2t;
      }
    }

    this.best_huffman_divide = function (gfc, gi) {
      var cod_info2 = new $7weBo();
      var ix = gi.l3_enc;
      var r01_bits = $46fd82963609949b$var$new_int(23);
      var r01_div = $46fd82963609949b$var$new_int(23);
      var r0_tbl = $46fd82963609949b$var$new_int(23);
      var r1_tbl = $46fd82963609949b$var$new_int(23);
      /* SHORT BLOCK stuff fails for MPEG2 */

      if (gi.block_type == $cPNKB.SHORT_TYPE && gfc.mode_gr == 1) return;
      cod_info2.assign(gi);

      if (gi.block_type == $cPNKB.NORM_TYPE) {
        recalc_divide_init(gfc, gi, ix, r01_bits, r01_div, r0_tbl, r1_tbl);
        recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div, r0_tbl, r1_tbl);
      }

      var i = cod_info2.big_values;
      if (i == 0 || (ix[i - 2] | ix[i - 1]) > 1) return;
      i = gi.count1 + 2;
      if (i > 576) return;
      /* Determines the number of bits to encode the quadruples. */

      cod_info2.assign(gi);
      cod_info2.count1 = i;
      var a1 = 0;
      var a2 = 0;
      $46fd82963609949b$var$assert(i <= 576);

      for (; i > cod_info2.big_values; i -= 4) {
        var p = ((ix[i - 4] * 2 + ix[i - 3]) * 2 + ix[i - 2]) * 2 + ix[i - 1];
        a1 += $dQDcS.t32l[p];
        a2 += $dQDcS.t33l[p];
      }

      cod_info2.big_values = i;
      cod_info2.count1table_select = 0;

      if (a1 > a2) {
        a1 = a2;
        cod_info2.count1table_select = 1;
      }

      cod_info2.count1bits = a1;
      if (cod_info2.block_type == $cPNKB.NORM_TYPE) recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div, r0_tbl, r1_tbl);else {
        /* Count the number of bits necessary to code the bigvalues region. */
        cod_info2.part2_3_length = a1;
        a1 = gfc.scalefac_band.l[8];
        if (a1 > i) a1 = i;

        if (a1 > 0) {
          var bi = new Bits(cod_info2.part2_3_length);
          cod_info2.table_select[0] = choose_table(ix, 0, a1, bi);
          cod_info2.part2_3_length = bi.bits;
        }

        if (i > a1) {
          var bi = new Bits(cod_info2.part2_3_length);
          cod_info2.table_select[1] = choose_table(ix, a1, i, bi);
          cod_info2.part2_3_length = bi.bits;
        }

        if (gi.part2_3_length > cod_info2.part2_3_length) gi.assign(cod_info2);
      }
    };

    var slen1_n = [1, 1, 1, 1, 8, 2, 2, 2, 4, 4, 4, 8, 8, 8, 16, 16];
    var slen2_n = [1, 2, 4, 8, 1, 2, 4, 8, 2, 4, 8, 2, 4, 8, 4, 8];
    var slen1_tab = [0, 0, 0, 0, 3, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4];
    var slen2_tab = [0, 1, 2, 3, 0, 1, 2, 3, 1, 2, 3, 1, 2, 3, 2, 3];
    $46fd82963609949b$var$Takehiro.slen1_tab = slen1_tab;
    $46fd82963609949b$var$Takehiro.slen2_tab = slen2_tab;

    function scfsi_calc(ch, l3_side) {
      var sfb;
      var gi = l3_side.tt[1][ch];
      var g0 = l3_side.tt[0][ch];

      for (var i = 0; i < $dQDcS.scfsi_band.length - 1; i++) {
        for (sfb = $dQDcS.scfsi_band[i]; sfb < $dQDcS.scfsi_band[i + 1]; sfb++) {
          if (g0.scalefac[sfb] != gi.scalefac[sfb] && gi.scalefac[sfb] >= 0) break;
        }

        if (sfb == $dQDcS.scfsi_band[i + 1]) {
          for (sfb = $dQDcS.scfsi_band[i]; sfb < $dQDcS.scfsi_band[i + 1]; sfb++) gi.scalefac[sfb] = -1;

          l3_side.scfsi[ch][i] = 1;
        }
      }

      var s1 = 0;
      var c1 = 0;

      for (sfb = 0; sfb < 11; sfb++) {
        if (gi.scalefac[sfb] == -1) continue;
        c1++;
        if (s1 < gi.scalefac[sfb]) s1 = gi.scalefac[sfb];
      }

      var s2 = 0;
      var c2 = 0;

      for (; sfb < $cPNKB.SBPSY_l; sfb++) {
        if (gi.scalefac[sfb] == -1) continue;
        c2++;
        if (s2 < gi.scalefac[sfb]) s2 = gi.scalefac[sfb];
      }

      for (var i = 0; i < 16; i++) if (s1 < slen1_n[i] && s2 < slen2_n[i]) {
        var c = slen1_tab[i] * c1 + slen2_tab[i] * c2;

        if (gi.part2_length > c) {
          gi.part2_length = c;
          gi.scalefac_compress = i;
        }
      }
    }
    /**
    * Find the optimal way to store the scalefactors. Only call this routine
    * after final scalefactors have been chosen and the channel/granule will
    * not be re-encoded.
    */


    this.best_scalefac_store = function (gfc, gr, ch, l3_side) {
      /* use scalefac_scale if we can */
      var gi = l3_side.tt[gr][ch];
      var sfb, i, j, l;
      var recalc = 0;
      /*
      * remove scalefacs from bands with ix=0. This idea comes from the AAC
      * ISO docs. added mt 3/00
      */

      /* check if l3_enc=0 */

      j = 0;

      for (sfb = 0; sfb < gi.sfbmax; sfb++) {
        var width = gi.width[sfb];
        $46fd82963609949b$var$assert(width >= 0);
        j += width;

        for (l = -width; l < 0; l++) {
          if (gi.l3_enc[l + j] != 0) break;
        }

        if (l == 0) gi.scalefac[sfb] = recalc = -2;
        /* anything goes. */

        /*
        * only best_scalefac_store and calc_scfsi know--and only they
        * should know--about the magic number -2.
        */
      }

      if (0 == gi.scalefac_scale && 0 == gi.preflag) {
        var s = 0;

        for (sfb = 0; sfb < gi.sfbmax; sfb++) if (gi.scalefac[sfb] > 0) s |= gi.scalefac[sfb];

        if (0 == (s & 1) && s != 0) {
          for (sfb = 0; sfb < gi.sfbmax; sfb++) if (gi.scalefac[sfb] > 0) gi.scalefac[sfb] >>= 1;

          gi.scalefac_scale = recalc = 1;
        }
      }

      if (0 == gi.preflag && gi.block_type != $cPNKB.SHORT_TYPE && gfc.mode_gr == 2) {
        for (sfb = 11; sfb < $cPNKB.SBPSY_l; sfb++) if (gi.scalefac[sfb] < qupvt.pretab[sfb] && gi.scalefac[sfb] != -2) break;

        if (sfb == $cPNKB.SBPSY_l) {
          for (sfb = 11; sfb < $cPNKB.SBPSY_l; sfb++) if (gi.scalefac[sfb] > 0) gi.scalefac[sfb] -= qupvt.pretab[sfb];

          gi.preflag = recalc = 1;
        }
      }

      for (i = 0; i < 4; i++) l3_side.scfsi[ch][i] = 0;

      if (gfc.mode_gr == 2 && gr == 1 && l3_side.tt[0][ch].block_type != $cPNKB.SHORT_TYPE && l3_side.tt[1][ch].block_type != $cPNKB.SHORT_TYPE) {
        scfsi_calc(ch, l3_side);
        recalc = 0;
      }

      for (sfb = 0; sfb < gi.sfbmax; sfb++) if (gi.scalefac[sfb] == -2) gi.scalefac[sfb] = 0;

      if (recalc != 0) {
        if (gfc.mode_gr == 2) this.scale_bitcount(gi);else this.scale_bitcount_lsf(gfc, gi);
      }
    };

    function all_scalefactors_not_negative(scalefac, n) {
      for (var i = 0; i < n; ++i) {
        if (scalefac[i] < 0) return false;
      }

      return true;
    }
    /**
    * number of bits used to encode scalefacs.
    *
    * 18*slen1_tab[i] + 18*slen2_tab[i]
    */


    var scale_short = [0, 18, 36, 54, 54, 36, 54, 72, 54, 72, 90, 72, 90, 108, 108, 126];
    /**
    * number of bits used to encode scalefacs.
    *
    * 17*slen1_tab[i] + 18*slen2_tab[i]
    */

    var scale_mixed = [0, 18, 36, 54, 51, 35, 53, 71, 52, 70, 88, 69, 87, 105, 104, 122];
    /**
    * number of bits used to encode scalefacs.
    *
    * 11*slen1_tab[i] + 10*slen2_tab[i]
    */

    var scale_long = [0, 10, 20, 30, 33, 21, 31, 41, 32, 42, 52, 43, 53, 63, 64, 74];
    /**
    * Also calculates the number of bits necessary to code the scalefactors.
    */

    this.scale_bitcount = function (cod_info) {
      var k,
          sfb,
          max_slen1 = 0,
          max_slen2 = 0;
      /* maximum values */

      var tab;
      var scalefac = cod_info.scalefac;
      $46fd82963609949b$var$assert(all_scalefactors_not_negative(scalefac, cod_info.sfbmax));

      if (cod_info.block_type == $cPNKB.SHORT_TYPE) {
        tab = scale_short;
        if (cod_info.mixed_block_flag != 0) tab = scale_mixed;
      } else {
        tab = scale_long;

        if (0 == cod_info.preflag) {
          for (sfb = 11; sfb < $cPNKB.SBPSY_l; sfb++) if (scalefac[sfb] < qupvt.pretab[sfb]) break;

          if (sfb == $cPNKB.SBPSY_l) {
            cod_info.preflag = 1;

            for (sfb = 11; sfb < $cPNKB.SBPSY_l; sfb++) scalefac[sfb] -= qupvt.pretab[sfb];
          }
        }
      }

      for (sfb = 0; sfb < cod_info.sfbdivide; sfb++) if (max_slen1 < scalefac[sfb]) max_slen1 = scalefac[sfb];

      for (; sfb < cod_info.sfbmax; sfb++) if (max_slen2 < scalefac[sfb]) max_slen2 = scalefac[sfb];
      /*
      * from Takehiro TOMINAGA <tominaga@isoternet.org> 10/99 loop over *all*
      * posible values of scalefac_compress to find the one which uses the
      * smallest number of bits. ISO would stop at first valid index
      */


      cod_info.part2_length = $84mea.LARGE_BITS;

      for (k = 0; k < 16; k++) if (max_slen1 < slen1_n[k] && max_slen2 < slen2_n[k] && cod_info.part2_length > tab[k]) {
        cod_info.part2_length = tab[k];
        cod_info.scalefac_compress = k;
      }

      return cod_info.part2_length == $84mea.LARGE_BITS;
    };
    /**
    * table of largest scalefactor values for MPEG2
    */


    var max_range_sfac_tab = [[15, 15, 7, 7], [15, 15, 7, 0], [7, 3, 0, 0], [15, 31, 31, 0], [7, 7, 7, 0], [3, 3, 0, 0]];
    /**
    * Also counts the number of bits to encode the scalefacs but for MPEG 2
    * Lower sampling frequencies (24, 22.05 and 16 kHz.)
    *
    * This is reverse-engineered from section 2.4.3.2 of the MPEG2 IS,
    * "Audio Decoding Layer III"
    */

    this.scale_bitcount_lsf = function (gfc, cod_info) {
      var table_number, row_in_table, partition, nr_sfb, window;
      var over;
      var i, sfb;
      var max_sfac = $46fd82963609949b$var$new_int(4); //var partition_table;

      var scalefac = cod_info.scalefac;
      /*
      * Set partition table. Note that should try to use table one, but do
      * not yet...
      */

      if (cod_info.preflag != 0) table_number = 2;else table_number = 0;

      for (i = 0; i < 4; i++) max_sfac[i] = 0;

      if (cod_info.block_type == $cPNKB.SHORT_TYPE) {
        row_in_table = 1;
        var partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];

        for (sfb = 0, partition = 0; partition < 4; partition++) {
          nr_sfb = partition_table[partition] / 3;

          for (i = 0; i < nr_sfb; i++, sfb++) for (window = 0; window < 3; window++) if (scalefac[sfb * 3 + window] > max_sfac[partition]) max_sfac[partition] = scalefac[sfb * 3 + window];
        }
      } else {
        row_in_table = 0;
        var partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];

        for (sfb = 0, partition = 0; partition < 4; partition++) {
          nr_sfb = partition_table[partition];

          for (i = 0; i < nr_sfb; i++, sfb++) if (scalefac[sfb] > max_sfac[partition]) max_sfac[partition] = scalefac[sfb];
        }
      }

      for (over = false, partition = 0; partition < 4; partition++) if (max_sfac[partition] > max_range_sfac_tab[table_number][partition]) over = true;

      if (!over) {
        var slen1, slen2, slen3, slen4;
        cod_info.sfb_partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];

        for (partition = 0; partition < 4; partition++) cod_info.slen[partition] = log2tab[max_sfac[partition]];
        /* set scalefac_compress */


        slen1 = cod_info.slen[0];
        slen2 = cod_info.slen[1];
        slen3 = cod_info.slen[2];
        slen4 = cod_info.slen[3];

        switch (table_number) {
          case 0:
            cod_info.scalefac_compress = (slen1 * 5 + slen2 << 4) + (slen3 << 2) + slen4;
            break;

          case 1:
            cod_info.scalefac_compress = 400 + (slen1 * 5 + slen2 << 2) + slen3;
            break;

          case 2:
            cod_info.scalefac_compress = 500 + slen1 * 3 + slen2;
            break;

          default:
            $46fd82963609949b$var$System.err.printf("intensity stereo not implemented yet\n");
            break;
        }
      }

      if (!over) {
        $46fd82963609949b$var$assert(cod_info.sfb_partition_table != null);
        cod_info.part2_length = 0;

        for (partition = 0; partition < 4; partition++) cod_info.part2_length += cod_info.slen[partition] * cod_info.sfb_partition_table[partition];
      }

      return over;
    };
    /*
    * Since no bands have been over-amplified, we can set scalefac_compress and
    * slen[] for the formatter
    */


    var log2tab = [0, 1, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4];

    this.huffman_init = function (gfc) {
      for (var i = 2; i <= 576; i += 2) {
        var scfb_anz = 0,
            bv_index;

        while (gfc.scalefac_band.l[++scfb_anz] < i);

        bv_index = subdv_table[scfb_anz][0]; // .region0_count

        while (gfc.scalefac_band.l[bv_index + 1] > i) bv_index--;

        if (bv_index < 0)
          /*
          * this is an indication that everything is going to be encoded
          * as region0: bigvalues < region0 < region1 so lets set
          * region0, region1 to some value larger than bigvalues
          */
          bv_index = subdv_table[scfb_anz][0]; // .region0_count

        gfc.bv_scf[i - 2] = bv_index;
        bv_index = subdv_table[scfb_anz][1]; // .region1_count

        while (gfc.scalefac_band.l[bv_index + gfc.bv_scf[i - 2] + 2] > i) bv_index--;

        if (bv_index < 0) bv_index = subdv_table[scfb_anz][1]; // .region1_count

        gfc.bv_scf[i - 1] = bv_index;
      }
    };
  }

  module.exports = $46fd82963609949b$var$Takehiro;
});
parcelRequire.register("dQDcS", function (module, exports) {
  function $a14e8b54f947e3d4$var$HuffCodeTab(len, max, tab, hl) {
    this.xlen = len;
    this.linmax = max;
    this.table = tab;
    this.hlen = hl;
  }

  var $a14e8b54f947e3d4$var$Tables = {};
  $a14e8b54f947e3d4$var$Tables.t1HB = [1, 1, 1, 0];
  $a14e8b54f947e3d4$var$Tables.t2HB = [1, 2, 1, 3, 1, 1, 3, 2, 0];
  $a14e8b54f947e3d4$var$Tables.t3HB = [3, 2, 1, 1, 1, 1, 3, 2, 0];
  $a14e8b54f947e3d4$var$Tables.t5HB = [1, 2, 6, 5, 3, 1, 4, 4, 7, 5, 7, 1, 6, 1, 1, 0];
  $a14e8b54f947e3d4$var$Tables.t6HB = [7, 3, 5, 1, 6, 2, 3, 2, 5, 4, 4, 1, 3, 3, 2, 0];
  $a14e8b54f947e3d4$var$Tables.t7HB = [1, 2, 10, 19, 16, 10, 3, 3, 7, 10, 5, 3, 11, 4, 13, 17, 8, 4, 12, 11, 18, 15, 11, 2, 7, 6, 9, 14, 3, 1, 6, 4, 5, 3, 2, 0];
  $a14e8b54f947e3d4$var$Tables.t8HB = [3, 4, 6, 18, 12, 5, 5, 1, 2, 16, 9, 3, 7, 3, 5, 14, 7, 3, 19, 17, 15, 13, 10, 4, 13, 5, 8, 11, 5, 1, 12, 4, 4, 1, 1, 0];
  $a14e8b54f947e3d4$var$Tables.t9HB = [7, 5, 9, 14, 15, 7, 6, 4, 5, 5, 6, 7, 7, 6, 8, 8, 8, 5, 15, 6, 9, 10, 5, 1, 11, 7, 9, 6, 4, 1, 14, 4, 6, 2, 6, 0];
  $a14e8b54f947e3d4$var$Tables.t10HB = [1, 2, 10, 23, 35, 30, 12, 17, 3, 3, 8, 12, 18, 21, 12, 7, 11, 9, 15, 21, 32, 40, 19, 6, 14, 13, 22, 34, 46, 23, 18, 7, 20, 19, 33, 47, 27, 22, 9, 3, 31, 22, 41, 26, 21, 20, 5, 3, 14, 13, 10, 11, 16, 6, 5, 1, 9, 8, 7, 8, 4, 4, 2, 0];
  $a14e8b54f947e3d4$var$Tables.t11HB = [3, 4, 10, 24, 34, 33, 21, 15, 5, 3, 4, 10, 32, 17, 11, 10, 11, 7, 13, 18, 30, 31, 20, 5, 25, 11, 19, 59, 27, 18, 12, 5, 35, 33, 31, 58, 30, 16, 7, 5, 28, 26, 32, 19, 17, 15, 8, 14, 14, 12, 9, 13, 14, 9, 4, 1, 11, 4, 6, 6, 6, 3, 2, 0];
  $a14e8b54f947e3d4$var$Tables.t12HB = [9, 6, 16, 33, 41, 39, 38, 26, 7, 5, 6, 9, 23, 16, 26, 11, 17, 7, 11, 14, 21, 30, 10, 7, 17, 10, 15, 12, 18, 28, 14, 5, 32, 13, 22, 19, 18, 16, 9, 5, 40, 17, 31, 29, 17, 13, 4, 2, 27, 12, 11, 15, 10, 7, 4, 1, 27, 12, 8, 12, 6, 3, 1, 0];
  $a14e8b54f947e3d4$var$Tables.t13HB = [1, 5, 14, 21, 34, 51, 46, 71, 42, 52, 68, 52, 67, 44, 43, 19, 3, 4, 12, 19, 31, 26, 44, 33, 31, 24, 32, 24, 31, 35, 22, 14, 15, 13, 23, 36, 59, 49, 77, 65, 29, 40, 30, 40, 27, 33, 42, 16, 22, 20, 37, 61, 56, 79, 73, 64, 43, 76, 56, 37, 26, 31, 25, 14, 35, 16, 60, 57, 97, 75, 114, 91, 54, 73, 55, 41, 48, 53, 23, 24, 58, 27, 50, 96, 76, 70, 93, 84, 77, 58, 79, 29, 74, 49, 41, 17, 47, 45, 78, 74, 115, 94, 90, 79, 69, 83, 71, 50, 59, 38, 36, 15, 72, 34, 56, 95, 92, 85, 91, 90, 86, 73, 77, 65, 51, 44, 43, 42, 43, 20, 30, 44, 55, 78, 72, 87, 78, 61, 46, 54, 37, 30, 20, 16, 53, 25, 41, 37, 44, 59, 54, 81, 66, 76, 57, 54, 37, 18, 39, 11, 35, 33, 31, 57, 42, 82, 72, 80, 47, 58, 55, 21, 22, 26, 38, 22, 53, 25, 23, 38, 70, 60, 51, 36, 55, 26, 34, 23, 27, 14, 9, 7, 34, 32, 28, 39, 49, 75, 30, 52, 48, 40, 52, 28, 18, 17, 9, 5, 45, 21, 34, 64, 56, 50, 49, 45, 31, 19, 12, 15, 10, 7, 6, 3, 48, 23, 20, 39, 36, 35, 53, 21, 16, 23, 13, 10, 6, 1, 4, 2, 16, 15, 17, 27, 25, 20, 29, 11, 17, 12, 16, 8, 1, 1, 0, 1];
  $a14e8b54f947e3d4$var$Tables.t15HB = [7, 12, 18, 53, 47, 76, 124, 108, 89, 123, 108, 119, 107, 81, 122, 63, 13, 5, 16, 27, 46, 36, 61, 51, 42, 70, 52, 83, 65, 41, 59, 36, 19, 17, 15, 24, 41, 34, 59, 48, 40, 64, 50, 78, 62, 80, 56, 33, 29, 28, 25, 43, 39, 63, 55, 93, 76, 59, 93, 72, 54, 75, 50, 29, 52, 22, 42, 40, 67, 57, 95, 79, 72, 57, 89, 69, 49, 66, 46, 27, 77, 37, 35, 66, 58, 52, 91, 74, 62, 48, 79, 63, 90, 62, 40, 38, 125, 32, 60, 56, 50, 92, 78, 65, 55, 87, 71, 51, 73, 51, 70, 30, 109, 53, 49, 94, 88, 75, 66, 122, 91, 73, 56, 42, 64, 44, 21, 25, 90, 43, 41, 77, 73, 63, 56, 92, 77, 66, 47, 67, 48, 53, 36, 20, 71, 34, 67, 60, 58, 49, 88, 76, 67, 106, 71, 54, 38, 39, 23, 15, 109, 53, 51, 47, 90, 82, 58, 57, 48, 72, 57, 41, 23, 27, 62, 9, 86, 42, 40, 37, 70, 64, 52, 43, 70, 55, 42, 25, 29, 18, 11, 11, 118, 68, 30, 55, 50, 46, 74, 65, 49, 39, 24, 16, 22, 13, 14, 7, 91, 44, 39, 38, 34, 63, 52, 45, 31, 52, 28, 19, 14, 8, 9, 3, 123, 60, 58, 53, 47, 43, 32, 22, 37, 24, 17, 12, 15, 10, 2, 1, 71, 37, 34, 30, 28, 20, 17, 26, 21, 16, 10, 6, 8, 6, 2, 0];
  $a14e8b54f947e3d4$var$Tables.t16HB = [1, 5, 14, 44, 74, 63, 110, 93, 172, 149, 138, 242, 225, 195, 376, 17, 3, 4, 12, 20, 35, 62, 53, 47, 83, 75, 68, 119, 201, 107, 207, 9, 15, 13, 23, 38, 67, 58, 103, 90, 161, 72, 127, 117, 110, 209, 206, 16, 45, 21, 39, 69, 64, 114, 99, 87, 158, 140, 252, 212, 199, 387, 365, 26, 75, 36, 68, 65, 115, 101, 179, 164, 155, 264, 246, 226, 395, 382, 362, 9, 66, 30, 59, 56, 102, 185, 173, 265, 142, 253, 232, 400, 388, 378, 445, 16, 111, 54, 52, 100, 184, 178, 160, 133, 257, 244, 228, 217, 385, 366, 715, 10, 98, 48, 91, 88, 165, 157, 148, 261, 248, 407, 397, 372, 380, 889, 884, 8, 85, 84, 81, 159, 156, 143, 260, 249, 427, 401, 392, 383, 727, 713, 708, 7, 154, 76, 73, 141, 131, 256, 245, 426, 406, 394, 384, 735, 359, 710, 352, 11, 139, 129, 67, 125, 247, 233, 229, 219, 393, 743, 737, 720, 885, 882, 439, 4, 243, 120, 118, 115, 227, 223, 396, 746, 742, 736, 721, 712, 706, 223, 436, 6, 202, 224, 222, 218, 216, 389, 386, 381, 364, 888, 443, 707, 440, 437, 1728, 4, 747, 211, 210, 208, 370, 379, 734, 723, 714, 1735, 883, 877, 876, 3459, 865, 2, 377, 369, 102, 187, 726, 722, 358, 711, 709, 866, 1734, 871, 3458, 870, 434, 0, 12, 10, 7, 11, 10, 17, 11, 9, 13, 12, 10, 7, 5, 3, 1, 3];
  $a14e8b54f947e3d4$var$Tables.t24HB = [15, 13, 46, 80, 146, 262, 248, 434, 426, 669, 653, 649, 621, 517, 1032, 88, 14, 12, 21, 38, 71, 130, 122, 216, 209, 198, 327, 345, 319, 297, 279, 42, 47, 22, 41, 74, 68, 128, 120, 221, 207, 194, 182, 340, 315, 295, 541, 18, 81, 39, 75, 70, 134, 125, 116, 220, 204, 190, 178, 325, 311, 293, 271, 16, 147, 72, 69, 135, 127, 118, 112, 210, 200, 188, 352, 323, 306, 285, 540, 14, 263, 66, 129, 126, 119, 114, 214, 202, 192, 180, 341, 317, 301, 281, 262, 12, 249, 123, 121, 117, 113, 215, 206, 195, 185, 347, 330, 308, 291, 272, 520, 10, 435, 115, 111, 109, 211, 203, 196, 187, 353, 332, 313, 298, 283, 531, 381, 17, 427, 212, 208, 205, 201, 193, 186, 177, 169, 320, 303, 286, 268, 514, 377, 16, 335, 199, 197, 191, 189, 181, 174, 333, 321, 305, 289, 275, 521, 379, 371, 11, 668, 184, 183, 179, 175, 344, 331, 314, 304, 290, 277, 530, 383, 373, 366, 10, 652, 346, 171, 168, 164, 318, 309, 299, 287, 276, 263, 513, 375, 368, 362, 6, 648, 322, 316, 312, 307, 302, 292, 284, 269, 261, 512, 376, 370, 364, 359, 4, 620, 300, 296, 294, 288, 282, 273, 266, 515, 380, 374, 369, 365, 361, 357, 2, 1033, 280, 278, 274, 267, 264, 259, 382, 378, 372, 367, 363, 360, 358, 356, 0, 43, 20, 19, 17, 15, 13, 11, 9, 7, 6, 4, 7, 5, 3, 1, 3];
  $a14e8b54f947e3d4$var$Tables.t32HB = [1, 10, 8, 20, 12, 20, 16, 32, 14, 12, 24, 0, 28, 16, 24, 16];
  $a14e8b54f947e3d4$var$Tables.t33HB = [15, 28, 26, 48, 22, 40, 36, 64, 14, 24, 20, 32, 12, 16, 8, 0];
  $a14e8b54f947e3d4$var$Tables.t1l = [1, 4, 3, 5];
  $a14e8b54f947e3d4$var$Tables.t2l = [1, 4, 7, 4, 5, 7, 6, 7, 8];
  $a14e8b54f947e3d4$var$Tables.t3l = [2, 3, 7, 4, 4, 7, 6, 7, 8];
  $a14e8b54f947e3d4$var$Tables.t5l = [1, 4, 7, 8, 4, 5, 8, 9, 7, 8, 9, 10, 8, 8, 9, 10];
  $a14e8b54f947e3d4$var$Tables.t6l = [3, 4, 6, 8, 4, 4, 6, 7, 5, 6, 7, 8, 7, 7, 8, 9];
  $a14e8b54f947e3d4$var$Tables.t7l = [1, 4, 7, 9, 9, 10, 4, 6, 8, 9, 9, 10, 7, 7, 9, 10, 10, 11, 8, 9, 10, 11, 11, 11, 8, 9, 10, 11, 11, 12, 9, 10, 11, 12, 12, 12];
  $a14e8b54f947e3d4$var$Tables.t8l = [2, 4, 7, 9, 9, 10, 4, 4, 6, 10, 10, 10, 7, 6, 8, 10, 10, 11, 9, 10, 10, 11, 11, 12, 9, 9, 10, 11, 12, 12, 10, 10, 11, 11, 13, 13];
  $a14e8b54f947e3d4$var$Tables.t9l = [3, 4, 6, 7, 9, 10, 4, 5, 6, 7, 8, 10, 5, 6, 7, 8, 9, 10, 7, 7, 8, 9, 9, 10, 8, 8, 9, 9, 10, 11, 9, 9, 10, 10, 11, 11];
  $a14e8b54f947e3d4$var$Tables.t10l = [1, 4, 7, 9, 10, 10, 10, 11, 4, 6, 8, 9, 10, 11, 10, 10, 7, 8, 9, 10, 11, 12, 11, 11, 8, 9, 10, 11, 12, 12, 11, 12, 9, 10, 11, 12, 12, 12, 12, 12, 10, 11, 12, 12, 13, 13, 12, 13, 9, 10, 11, 12, 12, 12, 13, 13, 10, 10, 11, 12, 12, 13, 13, 13];
  $a14e8b54f947e3d4$var$Tables.t11l = [2, 4, 6, 8, 9, 10, 9, 10, 4, 5, 6, 8, 10, 10, 9, 10, 6, 7, 8, 9, 10, 11, 10, 10, 8, 8, 9, 11, 10, 12, 10, 11, 9, 10, 10, 11, 11, 12, 11, 12, 9, 10, 11, 12, 12, 13, 12, 13, 9, 9, 9, 10, 11, 12, 12, 12, 9, 9, 10, 11, 12, 12, 12, 12];
  $a14e8b54f947e3d4$var$Tables.t12l = [4, 4, 6, 8, 9, 10, 10, 10, 4, 5, 6, 7, 9, 9, 10, 10, 6, 6, 7, 8, 9, 10, 9, 10, 7, 7, 8, 8, 9, 10, 10, 10, 8, 8, 9, 9, 10, 10, 10, 11, 9, 9, 10, 10, 10, 11, 10, 11, 9, 9, 9, 10, 10, 11, 11, 12, 10, 10, 10, 11, 11, 11, 11, 12];
  $a14e8b54f947e3d4$var$Tables.t13l = [1, 5, 7, 8, 9, 10, 10, 11, 10, 11, 12, 12, 13, 13, 14, 14, 4, 6, 8, 9, 10, 10, 11, 11, 11, 11, 12, 12, 13, 14, 14, 14, 7, 8, 9, 10, 11, 11, 12, 12, 11, 12, 12, 13, 13, 14, 15, 15, 8, 9, 10, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 15, 15, 9, 9, 11, 11, 12, 12, 13, 13, 12, 13, 13, 14, 14, 15, 15, 16, 10, 10, 11, 12, 12, 12, 13, 13, 13, 13, 14, 13, 15, 15, 16, 16, 10, 11, 12, 12, 13, 13, 13, 13, 13, 14, 14, 14, 15, 15, 16, 16, 11, 11, 12, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 16, 18, 18, 10, 10, 11, 12, 12, 13, 13, 14, 14, 14, 14, 15, 15, 16, 17, 17, 11, 11, 12, 12, 13, 13, 13, 15, 14, 15, 15, 16, 16, 16, 18, 17, 11, 12, 12, 13, 13, 14, 14, 15, 14, 15, 16, 15, 16, 17, 18, 19, 12, 12, 12, 13, 14, 14, 14, 14, 15, 15, 15, 16, 17, 17, 17, 18, 12, 13, 13, 14, 14, 15, 14, 15, 16, 16, 17, 17, 17, 18, 18, 18, 13, 13, 14, 15, 15, 15, 16, 16, 16, 16, 16, 17, 18, 17, 18, 18, 14, 14, 14, 15, 15, 15, 17, 16, 16, 19, 17, 17, 17, 19, 18, 18, 13, 14, 15, 16, 16, 16, 17, 16, 17, 17, 18, 18, 21, 20, 21, 18];
  $a14e8b54f947e3d4$var$Tables.t15l = [3, 5, 6, 8, 8, 9, 10, 10, 10, 11, 11, 12, 12, 12, 13, 14, 5, 5, 7, 8, 9, 9, 10, 10, 10, 11, 11, 12, 12, 12, 13, 13, 6, 7, 7, 8, 9, 9, 10, 10, 10, 11, 11, 12, 12, 13, 13, 13, 7, 8, 8, 9, 9, 10, 10, 11, 11, 11, 12, 12, 12, 13, 13, 13, 8, 8, 9, 9, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 13, 9, 9, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 13, 13, 13, 14, 10, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 14, 14, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 14, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 14, 14, 14, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 13, 14, 15, 14, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 15, 12, 12, 11, 12, 12, 12, 13, 13, 13, 13, 13, 13, 14, 14, 15, 15, 12, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 14, 14, 15, 15, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 14, 15, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 15, 15, 15, 15];
  $a14e8b54f947e3d4$var$Tables.t16_5l = [1, 5, 7, 9, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 14, 11, 4, 6, 8, 9, 10, 11, 11, 11, 12, 12, 12, 13, 14, 13, 14, 11, 7, 8, 9, 10, 11, 11, 12, 12, 13, 12, 13, 13, 13, 14, 14, 12, 9, 9, 10, 11, 11, 12, 12, 12, 13, 13, 14, 14, 14, 15, 15, 13, 10, 10, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 15, 15, 15, 12, 10, 10, 11, 11, 12, 13, 13, 14, 13, 14, 14, 15, 15, 15, 16, 13, 11, 11, 11, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 16, 13, 11, 11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 17, 17, 13, 11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 13, 12, 12, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 15, 16, 15, 14, 12, 13, 12, 13, 14, 14, 14, 14, 15, 16, 16, 16, 17, 17, 16, 13, 13, 13, 13, 13, 14, 14, 15, 16, 16, 16, 16, 16, 16, 15, 16, 14, 13, 14, 14, 14, 14, 15, 15, 15, 15, 17, 16, 16, 16, 16, 18, 14, 15, 14, 14, 14, 15, 15, 16, 16, 16, 18, 17, 17, 17, 19, 17, 14, 14, 15, 13, 14, 16, 16, 15, 16, 16, 17, 18, 17, 19, 17, 16, 14, 11, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 12];
  $a14e8b54f947e3d4$var$Tables.t16l = [1, 5, 7, 9, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 14, 10, 4, 6, 8, 9, 10, 11, 11, 11, 12, 12, 12, 13, 14, 13, 14, 10, 7, 8, 9, 10, 11, 11, 12, 12, 13, 12, 13, 13, 13, 14, 14, 11, 9, 9, 10, 11, 11, 12, 12, 12, 13, 13, 14, 14, 14, 15, 15, 12, 10, 10, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 15, 15, 15, 11, 10, 10, 11, 11, 12, 13, 13, 14, 13, 14, 14, 15, 15, 15, 16, 12, 11, 11, 11, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 16, 12, 11, 11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 17, 17, 12, 11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 12, 12, 12, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 15, 16, 15, 13, 12, 13, 12, 13, 14, 14, 14, 14, 15, 16, 16, 16, 17, 17, 16, 12, 13, 13, 13, 13, 14, 14, 15, 16, 16, 16, 16, 16, 16, 15, 16, 13, 13, 14, 14, 14, 14, 15, 15, 15, 15, 17, 16, 16, 16, 16, 18, 13, 15, 14, 14, 14, 15, 15, 16, 16, 16, 18, 17, 17, 17, 19, 17, 13, 14, 15, 13, 14, 16, 16, 15, 16, 16, 17, 18, 17, 19, 17, 16, 13, 10, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 10];
  $a14e8b54f947e3d4$var$Tables.t24l = [4, 5, 7, 8, 9, 10, 10, 11, 11, 12, 12, 12, 12, 12, 13, 10, 5, 6, 7, 8, 9, 10, 10, 11, 11, 11, 12, 12, 12, 12, 12, 10, 7, 7, 8, 9, 9, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 9, 8, 8, 9, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 9, 9, 9, 9, 10, 10, 10, 10, 11, 11, 11, 12, 12, 12, 12, 13, 9, 10, 9, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 9, 10, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 9, 11, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 10, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 10, 12, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 10, 12, 12, 11, 11, 11, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 10, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 10, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 10, 13, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 10, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 6];
  $a14e8b54f947e3d4$var$Tables.t32l = [1, 5, 5, 7, 5, 8, 7, 9, 5, 7, 7, 9, 7, 9, 9, 10];
  $a14e8b54f947e3d4$var$Tables.t33l = [4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8];
  $a14e8b54f947e3d4$var$Tables.ht = [
  /* xlen, linmax, table, hlen */
  new $a14e8b54f947e3d4$var$HuffCodeTab(0, 0, null, null), new $a14e8b54f947e3d4$var$HuffCodeTab(2, 0, $a14e8b54f947e3d4$var$Tables.t1HB, $a14e8b54f947e3d4$var$Tables.t1l), new $a14e8b54f947e3d4$var$HuffCodeTab(3, 0, $a14e8b54f947e3d4$var$Tables.t2HB, $a14e8b54f947e3d4$var$Tables.t2l), new $a14e8b54f947e3d4$var$HuffCodeTab(3, 0, $a14e8b54f947e3d4$var$Tables.t3HB, $a14e8b54f947e3d4$var$Tables.t3l), new $a14e8b54f947e3d4$var$HuffCodeTab(0, 0, null, null),
  /* Apparently not used */
  new $a14e8b54f947e3d4$var$HuffCodeTab(4, 0, $a14e8b54f947e3d4$var$Tables.t5HB, $a14e8b54f947e3d4$var$Tables.t5l), new $a14e8b54f947e3d4$var$HuffCodeTab(4, 0, $a14e8b54f947e3d4$var$Tables.t6HB, $a14e8b54f947e3d4$var$Tables.t6l), new $a14e8b54f947e3d4$var$HuffCodeTab(6, 0, $a14e8b54f947e3d4$var$Tables.t7HB, $a14e8b54f947e3d4$var$Tables.t7l), new $a14e8b54f947e3d4$var$HuffCodeTab(6, 0, $a14e8b54f947e3d4$var$Tables.t8HB, $a14e8b54f947e3d4$var$Tables.t8l), new $a14e8b54f947e3d4$var$HuffCodeTab(6, 0, $a14e8b54f947e3d4$var$Tables.t9HB, $a14e8b54f947e3d4$var$Tables.t9l), new $a14e8b54f947e3d4$var$HuffCodeTab(8, 0, $a14e8b54f947e3d4$var$Tables.t10HB, $a14e8b54f947e3d4$var$Tables.t10l), new $a14e8b54f947e3d4$var$HuffCodeTab(8, 0, $a14e8b54f947e3d4$var$Tables.t11HB, $a14e8b54f947e3d4$var$Tables.t11l), new $a14e8b54f947e3d4$var$HuffCodeTab(8, 0, $a14e8b54f947e3d4$var$Tables.t12HB, $a14e8b54f947e3d4$var$Tables.t12l), new $a14e8b54f947e3d4$var$HuffCodeTab(16, 0, $a14e8b54f947e3d4$var$Tables.t13HB, $a14e8b54f947e3d4$var$Tables.t13l), new $a14e8b54f947e3d4$var$HuffCodeTab(0, 0, null, $a14e8b54f947e3d4$var$Tables.t16_5l),
  /* Apparently not used */
  new $a14e8b54f947e3d4$var$HuffCodeTab(16, 0, $a14e8b54f947e3d4$var$Tables.t15HB, $a14e8b54f947e3d4$var$Tables.t15l), new $a14e8b54f947e3d4$var$HuffCodeTab(1, 1, $a14e8b54f947e3d4$var$Tables.t16HB, $a14e8b54f947e3d4$var$Tables.t16l), new $a14e8b54f947e3d4$var$HuffCodeTab(2, 3, $a14e8b54f947e3d4$var$Tables.t16HB, $a14e8b54f947e3d4$var$Tables.t16l), new $a14e8b54f947e3d4$var$HuffCodeTab(3, 7, $a14e8b54f947e3d4$var$Tables.t16HB, $a14e8b54f947e3d4$var$Tables.t16l), new $a14e8b54f947e3d4$var$HuffCodeTab(4, 15, $a14e8b54f947e3d4$var$Tables.t16HB, $a14e8b54f947e3d4$var$Tables.t16l), new $a14e8b54f947e3d4$var$HuffCodeTab(6, 63, $a14e8b54f947e3d4$var$Tables.t16HB, $a14e8b54f947e3d4$var$Tables.t16l), new $a14e8b54f947e3d4$var$HuffCodeTab(8, 255, $a14e8b54f947e3d4$var$Tables.t16HB, $a14e8b54f947e3d4$var$Tables.t16l), new $a14e8b54f947e3d4$var$HuffCodeTab(10, 1023, $a14e8b54f947e3d4$var$Tables.t16HB, $a14e8b54f947e3d4$var$Tables.t16l), new $a14e8b54f947e3d4$var$HuffCodeTab(13, 8191, $a14e8b54f947e3d4$var$Tables.t16HB, $a14e8b54f947e3d4$var$Tables.t16l), new $a14e8b54f947e3d4$var$HuffCodeTab(4, 15, $a14e8b54f947e3d4$var$Tables.t24HB, $a14e8b54f947e3d4$var$Tables.t24l), new $a14e8b54f947e3d4$var$HuffCodeTab(5, 31, $a14e8b54f947e3d4$var$Tables.t24HB, $a14e8b54f947e3d4$var$Tables.t24l), new $a14e8b54f947e3d4$var$HuffCodeTab(6, 63, $a14e8b54f947e3d4$var$Tables.t24HB, $a14e8b54f947e3d4$var$Tables.t24l), new $a14e8b54f947e3d4$var$HuffCodeTab(7, 127, $a14e8b54f947e3d4$var$Tables.t24HB, $a14e8b54f947e3d4$var$Tables.t24l), new $a14e8b54f947e3d4$var$HuffCodeTab(8, 255, $a14e8b54f947e3d4$var$Tables.t24HB, $a14e8b54f947e3d4$var$Tables.t24l), new $a14e8b54f947e3d4$var$HuffCodeTab(9, 511, $a14e8b54f947e3d4$var$Tables.t24HB, $a14e8b54f947e3d4$var$Tables.t24l), new $a14e8b54f947e3d4$var$HuffCodeTab(11, 2047, $a14e8b54f947e3d4$var$Tables.t24HB, $a14e8b54f947e3d4$var$Tables.t24l), new $a14e8b54f947e3d4$var$HuffCodeTab(13, 8191, $a14e8b54f947e3d4$var$Tables.t24HB, $a14e8b54f947e3d4$var$Tables.t24l), new $a14e8b54f947e3d4$var$HuffCodeTab(0, 0, $a14e8b54f947e3d4$var$Tables.t32HB, $a14e8b54f947e3d4$var$Tables.t32l), new $a14e8b54f947e3d4$var$HuffCodeTab(0, 0, $a14e8b54f947e3d4$var$Tables.t33HB, $a14e8b54f947e3d4$var$Tables.t33l)];
  /**
  * <CODE>
  *  for (i = 0; i < 16*16; i++) [
  *      largetbl[i] = ((ht[16].hlen[i]) << 16) + ht[24].hlen[i];
  *  ]
  * </CODE>
  *
  */

  $a14e8b54f947e3d4$var$Tables.largetbl = [0x010004, 0x050005, 0x070007, 0x090008, 0x0a0009, 0x0a000a, 0x0b000a, 0x0b000b, 0x0c000b, 0x0c000c, 0x0c000c, 0x0d000c, 0x0d000c, 0x0d000c, 0x0e000d, 0x0a000a, 0x040005, 0x060006, 0x080007, 0x090008, 0x0a0009, 0x0b000a, 0x0b000a, 0x0b000b, 0x0c000b, 0x0c000b, 0x0c000c, 0x0d000c, 0x0e000c, 0x0d000c, 0x0e000c, 0x0a000a, 0x070007, 0x080007, 0x090008, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000b, 0x0d000b, 0x0c000b, 0x0d000b, 0x0d000c, 0x0d000c, 0x0e000c, 0x0e000d, 0x0b0009, 0x090008, 0x090008, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000a, 0x0c000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0c0009, 0x0a0009, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000a, 0x0d000a, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000d, 0x0b0009, 0x0a000a, 0x0a0009, 0x0b000a, 0x0b000a, 0x0c000a, 0x0d000a, 0x0d000b, 0x0e000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x0c0009, 0x0b000a, 0x0b000a, 0x0b000a, 0x0c000a, 0x0d000a, 0x0d000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x10000d, 0x0c0009, 0x0b000b, 0x0b000a, 0x0c000a, 0x0c000a, 0x0d000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x11000d, 0x11000d, 0x0c000a, 0x0b000b, 0x0c000b, 0x0c000b, 0x0d000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000b, 0x0f000b, 0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x10000d, 0x10000d, 0x0c000a, 0x0c000b, 0x0c000b, 0x0c000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000b, 0x0f000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x0f000d, 0x10000d, 0x0f000d, 0x0d000a, 0x0c000c, 0x0d000b, 0x0c000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x10000c, 0x10000c, 0x10000d, 0x11000d, 0x11000d, 0x10000d, 0x0c000a, 0x0d000c, 0x0d000c, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0f000c, 0x10000c, 0x10000c, 0x10000c, 0x10000c, 0x10000d, 0x10000d, 0x0f000d, 0x10000d, 0x0d000a, 0x0d000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x11000c, 0x10000d, 0x10000d, 0x10000d, 0x10000d, 0x12000d, 0x0d000a, 0x0f000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x10000c, 0x10000c, 0x10000d, 0x12000d, 0x11000d, 0x11000d, 0x11000d, 0x13000d, 0x11000d, 0x0d000a, 0x0e000d, 0x0f000c, 0x0d000c, 0x0e000c, 0x10000c, 0x10000c, 0x0f000c, 0x10000d, 0x10000d, 0x11000d, 0x12000d, 0x11000d, 0x13000d, 0x11000d, 0x10000d, 0x0d000a, 0x0a0009, 0x0a0009, 0x0a0009, 0x0b0009, 0x0b0009, 0x0c0009, 0x0c0009, 0x0c0009, 0x0d0009, 0x0d0009, 0x0d0009, 0x0d000a, 0x0d000a, 0x0d000a, 0x0d000a, 0x0a0006];
  /**
  * <CODE>
  *  for (i = 0; i < 3*3; i++) [
  *      table23[i] = ((ht[2].hlen[i]) << 16) + ht[3].hlen[i];
  *  ]
  * </CODE>
  *
  */

  $a14e8b54f947e3d4$var$Tables.table23 = [0x010002, 0x040003, 0x070007, 0x040004, 0x050004, 0x070007, 0x060006, 0x070007, 0x080008];
  /**
  * <CODE>
  *  for (i = 0; i < 4*4; i++) [
  *       table56[i] = ((ht[5].hlen[i]) << 16) + ht[6].hlen[i];
  *   ]
  * </CODE>
  *
  */

  $a14e8b54f947e3d4$var$Tables.table56 = [0x010003, 0x040004, 0x070006, 0x080008, 0x040004, 0x050004, 0x080006, 0x090007, 0x070005, 0x080006, 0x090007, 0x0a0008, 0x080007, 0x080007, 0x090008, 0x0a0009];
  $a14e8b54f947e3d4$var$Tables.bitrate_table = [[0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, -1],
  /* MPEG 2 */
  [0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, -1],
  /* MPEG 1 */
  [0, 8, 16, 24, 32, 40, 48, 56, 64, -1, -1, -1, -1, -1, -1, -1]];
  /**
  * MPEG 2, MPEG 1, MPEG 2.5.
  */

  $a14e8b54f947e3d4$var$Tables.samplerate_table = [[22050, 24000, 16000, -1], [44100, 48000, 32000, -1], [11025, 12000, 8000, -1]];
  /**
  * This is the scfsi_band table from 2.4.2.7 of the IS.
  */

  $a14e8b54f947e3d4$var$Tables.scfsi_band = [0, 6, 11, 16, 21];
  module.exports = $a14e8b54f947e3d4$var$Tables;
});
parcelRequire.register("84mea", function (module, exports) {
  /*
  *      quantize_pvt source file
  *
  *      Copyright (c) 1999-2002 Takehiro Tominaga
  *      Copyright (c) 2000-2002 Robert Hegemann
  *      Copyright (c) 2001 Naoki Shibata
  *      Copyright (c) 2002-2005 Gabriel Bouvigne
  *
  * This library is free software; you can redistribute it and/or
  * modify it under the terms of the GNU Lesser General Public
  * License as published by the Free Software Foundation; either
  * version 2 of the License, or (at your option) any later version.
  *
  * This library is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * Library General Public License for more details.
  *
  * You should have received a copy of the GNU Lesser General Public
  * License along with this library; if not, write to the
  * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
  * Boston, MA 02111-1307, USA.
  */

  /* $Id: QuantizePVT.java,v 1.24 2011/05/24 20:48:06 kenchis Exp $ */
  var $7imnH = parcelRequire("7imnH");
  var $3YDN3 = parcelRequire("3YDN3");
  $3YDN3.System;
  var $5dfff05939c3cc74$var$VbrMode = $3YDN3.VbrMode;
  var $5dfff05939c3cc74$var$Float = $3YDN3.Float;
  $3YDN3.ShortBlock;
  var $5dfff05939c3cc74$var$Util = $3YDN3.Util;
  $3YDN3.Arrays;
  $3YDN3.new_array_n;
  $3YDN3.new_byte;
  $3YDN3.new_double;
  var $5dfff05939c3cc74$var$new_float = $3YDN3.new_float;
  $3YDN3.new_float_n;
  var $5dfff05939c3cc74$var$new_int = $3YDN3.new_int;
  $3YDN3.new_int_n;
  var $5dfff05939c3cc74$var$assert = $3YDN3.assert;
  var $cPNKB = parcelRequire("cPNKB");
  var $lL4Le = parcelRequire("lL4Le");
  var $4SDnr = parcelRequire("4SDnr");
  $5dfff05939c3cc74$var$QuantizePVT.Q_MAX = 257;
  $5dfff05939c3cc74$var$QuantizePVT.Q_MAX2 = 116;
  $5dfff05939c3cc74$var$QuantizePVT.LARGE_BITS = 100000;
  $5dfff05939c3cc74$var$QuantizePVT.IXMAX_VAL = 8206;

  function $5dfff05939c3cc74$var$QuantizePVT() {
    var BitStream = parcelRequire("ctaQC");
    var tak = null;
    var rv = null;
    var psy = null;

    this.setModules = function (_tk, _rv, _psy) {
      tak = _tk;
      rv = _rv;
      psy = _psy;
    };

    function POW20(x) {
      $5dfff05939c3cc74$var$assert(0 <= x + $5dfff05939c3cc74$var$QuantizePVT.Q_MAX2 && x < $5dfff05939c3cc74$var$QuantizePVT.Q_MAX);
      return pow20[x + $5dfff05939c3cc74$var$QuantizePVT.Q_MAX2];
    }

    this.IPOW20 = function (x) {
      $5dfff05939c3cc74$var$assert(0 <= x && x < $5dfff05939c3cc74$var$QuantizePVT.Q_MAX);
      return ipow20[x];
    };
    /**
    * smallest such that 1.0+DBL_EPSILON != 1.0
    */


    var DBL_EPSILON = 2.2204460492503131e-016;
    /**
    * ix always <= 8191+15. see count_bits()
    */

    var IXMAX_VAL = $5dfff05939c3cc74$var$QuantizePVT.IXMAX_VAL;
    var PRECALC_SIZE = IXMAX_VAL + 2;
    var Q_MAX = $5dfff05939c3cc74$var$QuantizePVT.Q_MAX;
    /**
    * <CODE>
    * minimum possible number of
    * -cod_info.global_gain + ((scalefac[] + (cod_info.preflag ? pretab[sfb] : 0))
    * << (cod_info.scalefac_scale + 1)) + cod_info.subblock_gain[cod_info.window[sfb]] * 8;
    *
    * for long block, 0+((15+3)<<2) = 18*4 = 72
    * for short block, 0+(15<<2)+7*8 = 15*4+56 = 116
    * </CODE>
    */

    var Q_MAX2 = $5dfff05939c3cc74$var$QuantizePVT.Q_MAX2;
    $5dfff05939c3cc74$var$QuantizePVT.LARGE_BITS;
    /**
    * Assuming dynamic range=96dB, this value should be 92
    */

    var NSATHSCALE = 100;
    /**
    * The following table is used to implement the scalefactor partitioning for
    * MPEG2 as described in section 2.4.3.2 of the IS. The indexing corresponds
    * to the way the tables are presented in the IS:
    *
    * [table_number][row_in_table][column of nr_of_sfb]
    */

    this.nr_of_sfb_block = [[[6, 5, 5, 5], [9, 9, 9, 9], [6, 9, 9, 9]], [[6, 5, 7, 3], [9, 9, 12, 6], [6, 9, 12, 6]], [[11, 10, 0, 0], [18, 18, 0, 0], [15, 18, 0, 0]], [[7, 7, 7, 0], [12, 12, 12, 0], [6, 15, 12, 0]], [[6, 6, 6, 3], [12, 9, 9, 6], [6, 12, 9, 6]], [[8, 8, 5, 0], [15, 12, 9, 0], [6, 18, 9, 0]]];
    /**
    * Table B.6: layer3 preemphasis
    */

    var pretab = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 3, 3, 3, 2, 0];
    this.pretab = pretab;
    /**
    * Here are MPEG1 Table B.8 and MPEG2 Table B.1 -- Layer III scalefactor
    * bands. <BR>
    * Index into this using a method such as:<BR>
    * idx = fr_ps.header.sampling_frequency + (fr_ps.header.version * 3)
    */

    this.sfBandIndex = [// Table B.2.b: 22.05 kHz
    new $7imnH([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464, 522, 576], [0, 4, 8, 12, 18, 24, 32, 42, 56, 74, 100, 132, 174, 192], [0, 0, 0, 0, 0, 0, 0] //  sfb21 pseudo sub bands
    , [0, 0, 0, 0, 0, 0, 0] //  sfb12 pseudo sub bands
    ),
    /* Table B.2.c: 24 kHz */

    /* docs: 332. mpg123(broken): 330 */
    new $7imnH([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 114, 136, 162, 194, 232, 278, 332, 394, 464, 540, 576], [0, 4, 8, 12, 18, 26, 36, 48, 62, 80, 104, 136, 180, 192], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]),
    /* Table B.2.a: 16 kHz */
    new $7imnH([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464, 522, 576], [0, 4, 8, 12, 18, 26, 36, 48, 62, 80, 104, 134, 174, 192], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]),
    /* Table B.8.b: 44.1 kHz */
    new $7imnH([0, 4, 8, 12, 16, 20, 24, 30, 36, 44, 52, 62, 74, 90, 110, 134, 162, 196, 238, 288, 342, 418, 576], [0, 4, 8, 12, 16, 22, 30, 40, 52, 66, 84, 106, 136, 192], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]),
    /* Table B.8.c: 48 kHz */
    new $7imnH([0, 4, 8, 12, 16, 20, 24, 30, 36, 42, 50, 60, 72, 88, 106, 128, 156, 190, 230, 276, 330, 384, 576], [0, 4, 8, 12, 16, 22, 28, 38, 50, 64, 80, 100, 126, 192], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]),
    /* Table B.8.a: 32 kHz */
    new $7imnH([0, 4, 8, 12, 16, 20, 24, 30, 36, 44, 54, 66, 82, 102, 126, 156, 194, 240, 296, 364, 448, 550, 576], [0, 4, 8, 12, 16, 22, 30, 42, 58, 78, 104, 138, 180, 192], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]),
    /* MPEG-2.5 11.025 kHz */
    new $7imnH([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464, 522, 576], [0, 4, 8, 12, 18, 26, 36, 48, 62, 80, 104, 134, 174, 192], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]),
    /* MPEG-2.5 12 kHz */
    new $7imnH([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464, 522, 576], [0, 4, 8, 12, 18, 26, 36, 48, 62, 80, 104, 134, 174, 192], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]),
    /* MPEG-2.5 8 kHz */
    new $7imnH([0, 12, 24, 36, 48, 60, 72, 88, 108, 132, 160, 192, 232, 280, 336, 400, 476, 566, 568, 570, 572, 574, 576], [0, 8, 16, 24, 36, 52, 72, 96, 124, 160, 162, 164, 166, 192], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0])];
    var pow20 = $5dfff05939c3cc74$var$new_float(Q_MAX + Q_MAX2 + 1);
    var ipow20 = $5dfff05939c3cc74$var$new_float(Q_MAX);
    var pow43 = $5dfff05939c3cc74$var$new_float(PRECALC_SIZE);
    var adj43 = $5dfff05939c3cc74$var$new_float(PRECALC_SIZE);
    this.adj43 = adj43;
    /**
    * <PRE>
    * compute the ATH for each scalefactor band cd range: 0..96db
    *
    * Input: 3.3kHz signal 32767 amplitude (3.3kHz is where ATH is smallest =
    * -5db) longblocks: sfb=12 en0/bw=-11db max_en0 = 1.3db shortblocks: sfb=5
    * -9db 0db
    *
    * Input: 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 (repeated) longblocks: amp=1
    * sfb=12 en0/bw=-103 db max_en0 = -92db amp=32767 sfb=12 -12 db -1.4db
    *
    * Input: 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 (repeated) shortblocks: amp=1
    * sfb=5 en0/bw= -99 -86 amp=32767 sfb=5 -9 db 4db
    *
    *
    * MAX energy of largest wave at 3.3kHz = 1db AVE energy of largest wave at
    * 3.3kHz = -11db Let's take AVE: -11db = maximum signal in sfb=12. Dynamic
    * range of CD: 96db. Therefor energy of smallest audible wave in sfb=12 =
    * -11 - 96 = -107db = ATH at 3.3kHz.
    *
    * ATH formula for this wave: -5db. To adjust to LAME scaling, we need ATH =
    * ATH_formula - 103 (db) ATH = ATH * 2.5e-10 (ener)
    * </PRE>
    */

    function ATHmdct(gfp, f) {
      var ath = psy.ATHformula(f, gfp);
      ath -= NSATHSCALE;
      /* modify the MDCT scaling for the ATH and convert to energy */

      ath = Math.pow(10.0, ath / 10.0 + gfp.ATHlower);
      return ath;
    }

    function compute_ath(gfp) {
      var ATH_l = gfp.internal_flags.ATH.l;
      var ATH_psfb21 = gfp.internal_flags.ATH.psfb21;
      var ATH_s = gfp.internal_flags.ATH.s;
      var ATH_psfb12 = gfp.internal_flags.ATH.psfb12;
      var gfc = gfp.internal_flags;
      var samp_freq = gfp.out_samplerate;

      for (var sfb = 0; sfb < $cPNKB.SBMAX_l; sfb++) {
        var start = gfc.scalefac_band.l[sfb];
        var end = gfc.scalefac_band.l[sfb + 1];
        ATH_l[sfb] = $5dfff05939c3cc74$var$Float.MAX_VALUE;

        for (var i = start; i < end; i++) {
          var freq = i * samp_freq / 1152;
          var ATH_f = ATHmdct(gfp, freq);
          /* freq in kHz */

          ATH_l[sfb] = Math.min(ATH_l[sfb], ATH_f);
        }
      }

      for (var sfb = 0; sfb < $cPNKB.PSFB21; sfb++) {
        var start = gfc.scalefac_band.psfb21[sfb];
        var end = gfc.scalefac_band.psfb21[sfb + 1];
        ATH_psfb21[sfb] = $5dfff05939c3cc74$var$Float.MAX_VALUE;

        for (var i = start; i < end; i++) {
          var freq = i * samp_freq / 1152;
          var ATH_f = ATHmdct(gfp, freq);
          /* freq in kHz */

          ATH_psfb21[sfb] = Math.min(ATH_psfb21[sfb], ATH_f);
        }
      }

      for (var sfb = 0; sfb < $cPNKB.SBMAX_s; sfb++) {
        var start = gfc.scalefac_band.s[sfb];
        var end = gfc.scalefac_band.s[sfb + 1];
        ATH_s[sfb] = $5dfff05939c3cc74$var$Float.MAX_VALUE;

        for (var i = start; i < end; i++) {
          var freq = i * samp_freq / 384;
          var ATH_f = ATHmdct(gfp, freq);
          /* freq in kHz */

          ATH_s[sfb] = Math.min(ATH_s[sfb], ATH_f);
        }

        ATH_s[sfb] *= gfc.scalefac_band.s[sfb + 1] - gfc.scalefac_band.s[sfb];
      }

      for (var sfb = 0; sfb < $cPNKB.PSFB12; sfb++) {
        var start = gfc.scalefac_band.psfb12[sfb];
        var end = gfc.scalefac_band.psfb12[sfb + 1];
        ATH_psfb12[sfb] = $5dfff05939c3cc74$var$Float.MAX_VALUE;

        for (var i = start; i < end; i++) {
          var freq = i * samp_freq / 384;
          var ATH_f = ATHmdct(gfp, freq);
          /* freq in kHz */

          ATH_psfb12[sfb] = Math.min(ATH_psfb12[sfb], ATH_f);
        }
        /* not sure about the following */


        ATH_psfb12[sfb] *= gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12];
      }
      /*
      * no-ATH mode: reduce ATH to -200 dB
      */


      if (gfp.noATH) {
        for (var sfb = 0; sfb < $cPNKB.SBMAX_l; sfb++) ATH_l[sfb] = 1E-20;

        for (var sfb = 0; sfb < $cPNKB.PSFB21; sfb++) ATH_psfb21[sfb] = 1E-20;

        for (var sfb = 0; sfb < $cPNKB.SBMAX_s; sfb++) ATH_s[sfb] = 1E-20;

        for (var sfb = 0; sfb < $cPNKB.PSFB12; sfb++) ATH_psfb12[sfb] = 1E-20;
      }
      /*
      * work in progress, don't rely on it too much
      */


      gfc.ATH.floor = 10. * Math.log10(ATHmdct(gfp, -1));
    }
    /**
    * initialization for iteration_loop
    */


    this.iteration_init = function (gfp) {
      var gfc = gfp.internal_flags;
      var l3_side = gfc.l3_side;
      var i;

      if (gfc.iteration_init_init == 0) {
        gfc.iteration_init_init = 1;
        l3_side.main_data_begin = 0;
        compute_ath(gfp);
        pow43[0] = 0.0;

        for (i = 1; i < PRECALC_SIZE; i++) pow43[i] = Math.pow(i, 4.0 / 3.0);

        for (i = 0; i < PRECALC_SIZE - 1; i++) adj43[i] = i + 1 - Math.pow(0.5 * (pow43[i] + pow43[i + 1]), 0.75);

        adj43[i] = 0.5;

        for (i = 0; i < Q_MAX; i++) ipow20[i] = Math.pow(2.0, (i - 210) * -0.1875);

        for (i = 0; i <= Q_MAX + Q_MAX2; i++) pow20[i] = Math.pow(2.0, (i - 210 - Q_MAX2) * 0.25);

        tak.huffman_init(gfc);
        var bass, alto, treble, sfb21;
        i = gfp.exp_nspsytune >> 2 & 63;
        if (i >= 32) i -= 64;
        bass = Math.pow(10, i / 4.0 / 10.0);
        i = gfp.exp_nspsytune >> 8 & 63;
        if (i >= 32) i -= 64;
        alto = Math.pow(10, i / 4.0 / 10.0);
        i = gfp.exp_nspsytune >> 14 & 63;
        if (i >= 32) i -= 64;
        treble = Math.pow(10, i / 4.0 / 10.0);
        /*
        * to be compatible with Naoki's original code, the next 6 bits
        * define only the amount of changing treble for sfb21
        */

        i = gfp.exp_nspsytune >> 20 & 63;
        if (i >= 32) i -= 64;
        sfb21 = treble * Math.pow(10, i / 4.0 / 10.0);

        for (i = 0; i < $cPNKB.SBMAX_l; i++) {
          var f;
          if (i <= 6) f = bass;else if (i <= 13) f = alto;else if (i <= 20) f = treble;else f = sfb21;
          gfc.nsPsy.longfact[i] = f;
        }

        for (i = 0; i < $cPNKB.SBMAX_s; i++) {
          var f;
          if (i <= 5) f = bass;else if (i <= 10) f = alto;else if (i <= 11) f = treble;else f = sfb21;
          gfc.nsPsy.shortfact[i] = f;
        }
      }
    };
    /**
    * allocate bits among 2 channels based on PE<BR>
    * mt 6/99<BR>
    * bugfixes rh 8/01: often allocated more than the allowed 4095 bits
    */


    this.on_pe = function (gfp, pe, targ_bits, mean_bits, gr, cbr) {
      var gfc = gfp.internal_flags;
      var tbits = 0,
          bits;
      var add_bits = $5dfff05939c3cc74$var$new_int(2);
      var ch;
      /* allocate targ_bits for granule */

      var mb = new $lL4Le(tbits);
      var extra_bits = rv.ResvMaxBits(gfp, mean_bits, mb, cbr);
      tbits = mb.bits;
      /* maximum allowed bits for this granule */

      var max_bits = tbits + extra_bits;
      if (max_bits > $4SDnr.MAX_BITS_PER_GRANULE) // hard limit per granule
        max_bits = $4SDnr.MAX_BITS_PER_GRANULE;

      for (bits = 0, ch = 0; ch < gfc.channels_out; ++ch) {
        /******************************************************************
        * allocate bits for each channel
        ******************************************************************/
        targ_bits[ch] = Math.min($4SDnr.MAX_BITS_PER_CHANNEL, tbits / gfc.channels_out);
        add_bits[ch] = 0 | targ_bits[ch] * pe[gr][ch] / 700.0 - targ_bits[ch];
        /* at most increase bits by 1.5*average */

        if (add_bits[ch] > mean_bits * 3 / 4) add_bits[ch] = mean_bits * 3 / 4;
        if (add_bits[ch] < 0) add_bits[ch] = 0;
        if (add_bits[ch] + targ_bits[ch] > $4SDnr.MAX_BITS_PER_CHANNEL) add_bits[ch] = Math.max(0, $4SDnr.MAX_BITS_PER_CHANNEL - targ_bits[ch]);
        bits += add_bits[ch];
      }

      if (bits > extra_bits) for (ch = 0; ch < gfc.channels_out; ++ch) add_bits[ch] = extra_bits * add_bits[ch] / bits;

      for (ch = 0; ch < gfc.channels_out; ++ch) {
        targ_bits[ch] += add_bits[ch];
        extra_bits -= add_bits[ch];
      }

      for (bits = 0, ch = 0; ch < gfc.channels_out; ++ch) bits += targ_bits[ch];

      if (bits > $4SDnr.MAX_BITS_PER_GRANULE) {
        var sum = 0;

        for (ch = 0; ch < gfc.channels_out; ++ch) {
          targ_bits[ch] *= $4SDnr.MAX_BITS_PER_GRANULE;
          targ_bits[ch] /= bits;
          sum += targ_bits[ch];
        }

        $5dfff05939c3cc74$var$assert(sum <= $4SDnr.MAX_BITS_PER_GRANULE);
      }

      return max_bits;
    };

    this.reduce_side = function (targ_bits, ms_ener_ratio, mean_bits, max_bits) {
      $5dfff05939c3cc74$var$assert(max_bits <= $4SDnr.MAX_BITS_PER_GRANULE);
      $5dfff05939c3cc74$var$assert(targ_bits[0] + targ_bits[1] <= $4SDnr.MAX_BITS_PER_GRANULE);
      /*
      * ms_ener_ratio = 0: allocate 66/33 mid/side fac=.33 ms_ener_ratio =.5:
      * allocate 50/50 mid/side fac= 0
      */

      /* 75/25 split is fac=.5 */

      var fac = .33 * (.5 - ms_ener_ratio) / .5;
      if (fac < 0) fac = 0;
      if (fac > .5) fac = .5;
      /* number of bits to move from side channel to mid channel */

      /* move_bits = fac*targ_bits[1]; */

      var move_bits = 0 | fac * .5 * (targ_bits[0] + targ_bits[1]);
      if (move_bits > $4SDnr.MAX_BITS_PER_CHANNEL - targ_bits[0]) move_bits = $4SDnr.MAX_BITS_PER_CHANNEL - targ_bits[0];
      if (move_bits < 0) move_bits = 0;

      if (targ_bits[1] >= 125) {
        /* dont reduce side channel below 125 bits */
        if (targ_bits[1] - move_bits > 125) {
          /* if mid channel already has 2x more than average, dont bother */

          /* mean_bits = bits per granule (for both channels) */
          if (targ_bits[0] < mean_bits) targ_bits[0] += move_bits;
          targ_bits[1] -= move_bits;
        } else {
          targ_bits[0] += targ_bits[1] - 125;
          targ_bits[1] = 125;
        }
      }

      move_bits = targ_bits[0] + targ_bits[1];

      if (move_bits > max_bits) {
        targ_bits[0] = max_bits * targ_bits[0] / move_bits;
        targ_bits[1] = max_bits * targ_bits[1] / move_bits;
      }

      $5dfff05939c3cc74$var$assert(targ_bits[0] <= $4SDnr.MAX_BITS_PER_CHANNEL);
      $5dfff05939c3cc74$var$assert(targ_bits[1] <= $4SDnr.MAX_BITS_PER_CHANNEL);
      $5dfff05939c3cc74$var$assert(targ_bits[0] + targ_bits[1] <= $4SDnr.MAX_BITS_PER_GRANULE);
    };
    /**
    *  Robert Hegemann 2001-04-27:
    *  this adjusts the ATH, keeping the original noise floor
    *  affects the higher frequencies more than the lower ones
    */


    this.athAdjust = function (a, x, athFloor) {
      /*
      * work in progress
      */
      var o = 90.30873362;
      var p = 94.82444863;
      var u = $5dfff05939c3cc74$var$Util.FAST_LOG10_X(x, 10.0);
      var v = a * a;
      var w = 0.0;
      u -= athFloor;
      /* undo scaling */

      if (v > 1E-20) w = 1. + $5dfff05939c3cc74$var$Util.FAST_LOG10_X(v, 10.0 / o);
      if (w < 0) w = 0.;
      u *= w;
      u += athFloor + o - p;
      /* redo scaling */

      return Math.pow(10., 0.1 * u);
    };
    /**
    * Calculate the allowed distortion for each scalefactor band, as determined
    * by the psychoacoustic model. xmin(sb) = ratio(sb) * en(sb) / bw(sb)
    *
    * returns number of sfb's with energy > ATH
    */


    this.calc_xmin = function (gfp, ratio, cod_info, pxmin) {
      var pxminPos = 0;
      var gfc = gfp.internal_flags;
      var gsfb,
          j = 0,
          ath_over = 0;
      var ATH = gfc.ATH;
      var xr = cod_info.xr;
      var enable_athaa_fix = gfp.VBR == $5dfff05939c3cc74$var$VbrMode.vbr_mtrh ? 1 : 0;
      var masking_lower = gfc.masking_lower;
      if (gfp.VBR == $5dfff05939c3cc74$var$VbrMode.vbr_mtrh || gfp.VBR == $5dfff05939c3cc74$var$VbrMode.vbr_mt)
        /* was already done in PSY-Model */
        masking_lower = 1.0;

      for (gsfb = 0; gsfb < cod_info.psy_lmax; gsfb++) {
        var en0, xmin;
        var rh1, rh2;
        var width, l;
        if (gfp.VBR == $5dfff05939c3cc74$var$VbrMode.vbr_rh || gfp.VBR == $5dfff05939c3cc74$var$VbrMode.vbr_mtrh) xmin = athAdjust(ATH.adjust, ATH.l[gsfb], ATH.floor);else xmin = ATH.adjust * ATH.l[gsfb];
        width = cod_info.width[gsfb];
        rh1 = xmin / width;
        rh2 = DBL_EPSILON;
        l = width >> 1;
        en0 = 0.0;

        do {
          var xa, xb;
          xa = xr[j] * xr[j];
          en0 += xa;
          rh2 += xa < rh1 ? xa : rh1;
          j++;
          xb = xr[j] * xr[j];
          en0 += xb;
          rh2 += xb < rh1 ? xb : rh1;
          j++;
        } while (--l > 0);

        if (en0 > xmin) ath_over++;

        if (gsfb == $cPNKB.SBPSY_l) {
          var x = xmin * gfc.nsPsy.longfact[gsfb];
          if (rh2 < x) rh2 = x;
        }

        if (enable_athaa_fix != 0) xmin = rh2;

        if (!gfp.ATHonly) {
          var e = ratio.en.l[gsfb];

          if (e > 0.0) {
            var x;
            x = en0 * ratio.thm.l[gsfb] * masking_lower / e;
            if (enable_athaa_fix != 0) x *= gfc.nsPsy.longfact[gsfb];
            if (xmin < x) xmin = x;
          }
        }

        if (enable_athaa_fix != 0) pxmin[pxminPos++] = xmin;else pxmin[pxminPos++] = xmin * gfc.nsPsy.longfact[gsfb];
      }
      /* end of long block loop */

      /* use this function to determine the highest non-zero coeff */


      var max_nonzero = 575;

      if (cod_info.block_type != $cPNKB.SHORT_TYPE) {
        // NORM, START or STOP type, but not SHORT
        var k = 576;

        while (k-- != 0 && BitStream.EQ(xr[k], 0)) max_nonzero = k;
      }

      cod_info.max_nonzero_coeff = max_nonzero;

      for (var sfb = cod_info.sfb_smin; gsfb < cod_info.psymax; sfb++, gsfb += 3) {
        var width, b;
        var tmpATH;
        if (gfp.VBR == $5dfff05939c3cc74$var$VbrMode.vbr_rh || gfp.VBR == $5dfff05939c3cc74$var$VbrMode.vbr_mtrh) tmpATH = athAdjust(ATH.adjust, ATH.s[sfb], ATH.floor);else tmpATH = ATH.adjust * ATH.s[sfb];
        width = cod_info.width[gsfb];

        for (b = 0; b < 3; b++) {
          var en0 = 0.0,
              xmin;
          var rh1, rh2;
          var l = width >> 1;
          rh1 = tmpATH / width;
          rh2 = DBL_EPSILON;

          do {
            var xa, xb;
            xa = xr[j] * xr[j];
            en0 += xa;
            rh2 += xa < rh1 ? xa : rh1;
            j++;
            xb = xr[j] * xr[j];
            en0 += xb;
            rh2 += xb < rh1 ? xb : rh1;
            j++;
          } while (--l > 0);

          if (en0 > tmpATH) ath_over++;

          if (sfb == $cPNKB.SBPSY_s) {
            var x = tmpATH * gfc.nsPsy.shortfact[sfb];
            if (rh2 < x) rh2 = x;
          }

          if (enable_athaa_fix != 0) xmin = rh2;else xmin = tmpATH;

          if (!gfp.ATHonly && !gfp.ATHshort) {
            var e = ratio.en.s[sfb][b];

            if (e > 0.0) {
              var x;
              x = en0 * ratio.thm.s[sfb][b] * masking_lower / e;
              if (enable_athaa_fix != 0) x *= gfc.nsPsy.shortfact[sfb];
              if (xmin < x) xmin = x;
            }
          }

          if (enable_athaa_fix != 0) pxmin[pxminPos++] = xmin;else pxmin[pxminPos++] = xmin * gfc.nsPsy.shortfact[sfb];
        }
        /* b */


        if (gfp.useTemporal) {
          if (pxmin[pxminPos - 3] > pxmin[pxminPos - 3 + 1]) pxmin[pxminPos - 3 + 1] += (pxmin[pxminPos - 3] - pxmin[pxminPos - 3 + 1]) * gfc.decay;
          if (pxmin[pxminPos - 3 + 1] > pxmin[pxminPos - 3 + 2]) pxmin[pxminPos - 3 + 2] += (pxmin[pxminPos - 3 + 1] - pxmin[pxminPos - 3 + 2]) * gfc.decay;
        }
      }
      /* end of short block sfb loop */


      return ath_over;
    };

    function StartLine(j) {
      this.s = j;
    }

    this.calc_noise_core = function (cod_info, startline, l, step) {
      var noise = 0;
      var j = startline.s;
      var ix = cod_info.l3_enc;
      if (j > cod_info.count1) while (l-- != 0) {
        var temp;
        temp = cod_info.xr[j];
        j++;
        noise += temp * temp;
        temp = cod_info.xr[j];
        j++;
        noise += temp * temp;
      } else if (j > cod_info.big_values) {
        var ix01 = $5dfff05939c3cc74$var$new_float(2);
        ix01[0] = 0;
        ix01[1] = step;

        while (l-- != 0) {
          var temp;
          temp = Math.abs(cod_info.xr[j]) - ix01[ix[j]];
          j++;
          noise += temp * temp;
          temp = Math.abs(cod_info.xr[j]) - ix01[ix[j]];
          j++;
          noise += temp * temp;
        }
      } else while (l-- != 0) {
        var temp;
        temp = Math.abs(cod_info.xr[j]) - pow43[ix[j]] * step;
        j++;
        noise += temp * temp;
        temp = Math.abs(cod_info.xr[j]) - pow43[ix[j]] * step;
        j++;
        noise += temp * temp;
      }
      startline.s = j;
      return noise;
    };
    /**
    * <PRE>
    * -oo dB  =>  -1.00
    * - 6 dB  =>  -0.97
    * - 3 dB  =>  -0.80
    * - 2 dB  =>  -0.64
    * - 1 dB  =>  -0.38
    *   0 dB  =>   0.00
    * + 1 dB  =>  +0.49
    * + 2 dB  =>  +1.06
    * + 3 dB  =>  +1.68
    * + 6 dB  =>  +3.69
    * +10 dB  =>  +6.45
    * </PRE>
    */


    this.calc_noise = function (cod_info, l3_xmin, distort, res, prev_noise) {
      var distortPos = 0;
      var l3_xminPos = 0;
      var sfb,
          l,
          over = 0;
      var over_noise_db = 0;
      /* 0 dB relative to masking */

      var tot_noise_db = 0;
      /* -200 dB relative to masking */

      var max_noise = -20;
      var j = 0;
      var scalefac = cod_info.scalefac;
      var scalefacPos = 0;
      res.over_SSD = 0;

      for (sfb = 0; sfb < cod_info.psymax; sfb++) {
        var s = cod_info.global_gain - (scalefac[scalefacPos++] + (cod_info.preflag != 0 ? pretab[sfb] : 0) << cod_info.scalefac_scale + 1) - cod_info.subblock_gain[cod_info.window[sfb]] * 8;
        var noise = 0.0;

        if (prev_noise != null && prev_noise.step[sfb] == s) {
          /* use previously computed values */
          noise = prev_noise.noise[sfb];
          j += cod_info.width[sfb];
          distort[distortPos++] = noise / l3_xmin[l3_xminPos++];
          noise = prev_noise.noise_log[sfb];
        } else {
          var step = POW20(s);
          l = cod_info.width[sfb] >> 1;

          if (j + cod_info.width[sfb] > cod_info.max_nonzero_coeff) {
            var usefullsize;
            usefullsize = cod_info.max_nonzero_coeff - j + 1;
            if (usefullsize > 0) l = usefullsize >> 1;else l = 0;
          }

          var sl = new StartLine(j);
          noise = this.calc_noise_core(cod_info, sl, l, step);
          j = sl.s;

          if (prev_noise != null) {
            /* save noise values */
            prev_noise.step[sfb] = s;
            prev_noise.noise[sfb] = noise;
          }

          noise = distort[distortPos++] = noise / l3_xmin[l3_xminPos++];
          /* multiplying here is adding in dB, but can overflow */

          noise = $5dfff05939c3cc74$var$Util.FAST_LOG10(Math.max(noise, 1E-20));
          if (prev_noise != null)
            /* save noise values */
            prev_noise.noise_log[sfb] = noise;
        }

        if (prev_noise != null)
          /* save noise values */
          prev_noise.global_gain = cod_info.global_gain;
        tot_noise_db += noise;

        if (noise > 0.0) {
          var tmp;
          tmp = Math.max(0 | noise * 10 + .5, 1);
          res.over_SSD += tmp * tmp;
          over++;
          /* multiplying here is adding in dB -but can overflow */

          /* over_noise *= noise; */

          over_noise_db += noise;
        }

        max_noise = Math.max(max_noise, noise);
      }

      res.over_count = over;
      res.tot_noise = tot_noise_db;
      res.over_noise = over_noise_db;
      res.max_noise = max_noise;
      return over;
    };
    /**
    * updates plotting data
    *
    * Mark Taylor 2000-??-??
    *
    * Robert Hegemann: moved noise/distortion calc into it
    */


    this.set_pinfo = function (gfp, cod_info, ratio, gr, ch) {
      var gfc = gfp.internal_flags;
      var sfb, sfb2;
      var l;
      var en0, en1;
      var ifqstep = cod_info.scalefac_scale == 0 ? .5 : 1.0;
      var scalefac = cod_info.scalefac;
      var l3_xmin = $5dfff05939c3cc74$var$new_float(L3Side.SFBMAX);
      var xfsf = $5dfff05939c3cc74$var$new_float(L3Side.SFBMAX);
      var noise = new CalcNoiseResult();
      calc_xmin(gfp, ratio, cod_info, l3_xmin);
      calc_noise(cod_info, l3_xmin, xfsf, noise, null);
      var j = 0;
      sfb2 = cod_info.sfb_lmax;
      if (cod_info.block_type != $cPNKB.SHORT_TYPE && 0 == cod_info.mixed_block_flag) sfb2 = 22;

      for (sfb = 0; sfb < sfb2; sfb++) {
        var start = gfc.scalefac_band.l[sfb];
        var end = gfc.scalefac_band.l[sfb + 1];
        var bw = end - start;

        for (en0 = 0.0; j < end; j++) en0 += cod_info.xr[j] * cod_info.xr[j];

        en0 /= bw;
        /* convert to MDCT units */

        /* scaling so it shows up on FFT plot */

        en1 = 1e15;
        gfc.pinfo.en[gr][ch][sfb] = en1 * en0;
        gfc.pinfo.xfsf[gr][ch][sfb] = en1 * l3_xmin[sfb] * xfsf[sfb] / bw;
        if (ratio.en.l[sfb] > 0 && !gfp.ATHonly) en0 = en0 / ratio.en.l[sfb];else en0 = 0.0;
        gfc.pinfo.thr[gr][ch][sfb] = en1 * Math.max(en0 * ratio.thm.l[sfb], gfc.ATH.l[sfb]);
        /* there is no scalefactor bands >= SBPSY_l */

        gfc.pinfo.LAMEsfb[gr][ch][sfb] = 0;
        if (cod_info.preflag != 0 && sfb >= 11) gfc.pinfo.LAMEsfb[gr][ch][sfb] = -ifqstep * pretab[sfb];

        if (sfb < $cPNKB.SBPSY_l) {
          /* scfsi should be decoded by caller side */
          $5dfff05939c3cc74$var$assert(scalefac[sfb] >= 0);
          gfc.pinfo.LAMEsfb[gr][ch][sfb] -= ifqstep * scalefac[sfb];
        }
      }
      /* for sfb */


      if (cod_info.block_type == $cPNKB.SHORT_TYPE) {
        sfb2 = sfb;

        for (sfb = cod_info.sfb_smin; sfb < $cPNKB.SBMAX_s; sfb++) {
          var start = gfc.scalefac_band.s[sfb];
          var end = gfc.scalefac_band.s[sfb + 1];
          var bw = end - start;

          for (var i = 0; i < 3; i++) {
            for (en0 = 0.0, l = start; l < end; l++) {
              en0 += cod_info.xr[j] * cod_info.xr[j];
              j++;
            }

            en0 = Math.max(en0 / bw, 1e-20);
            /* convert to MDCT units */

            /* scaling so it shows up on FFT plot */

            en1 = 1e15;
            gfc.pinfo.en_s[gr][ch][3 * sfb + i] = en1 * en0;
            gfc.pinfo.xfsf_s[gr][ch][3 * sfb + i] = en1 * l3_xmin[sfb2] * xfsf[sfb2] / bw;
            if (ratio.en.s[sfb][i] > 0) en0 = en0 / ratio.en.s[sfb][i];else en0 = 0.0;
            if (gfp.ATHonly || gfp.ATHshort) en0 = 0;
            gfc.pinfo.thr_s[gr][ch][3 * sfb + i] = en1 * Math.max(en0 * ratio.thm.s[sfb][i], gfc.ATH.s[sfb]);
            /* there is no scalefactor bands >= SBPSY_s */

            gfc.pinfo.LAMEsfb_s[gr][ch][3 * sfb + i] = -2 * cod_info.subblock_gain[i];
            if (sfb < $cPNKB.SBPSY_s) gfc.pinfo.LAMEsfb_s[gr][ch][3 * sfb + i] -= ifqstep * scalefac[sfb2];
            sfb2++;
          }
        }
      }
      /* block type short */


      gfc.pinfo.LAMEqss[gr][ch] = cod_info.global_gain;
      gfc.pinfo.LAMEmainbits[gr][ch] = cod_info.part2_3_length + cod_info.part2_length;
      gfc.pinfo.LAMEsfbits[gr][ch] = cod_info.part2_length;
      gfc.pinfo.over[gr][ch] = noise.over_count;
      gfc.pinfo.max_noise[gr][ch] = noise.max_noise * 10.0;
      gfc.pinfo.over_noise[gr][ch] = noise.over_noise * 10.0;
      gfc.pinfo.tot_noise[gr][ch] = noise.tot_noise * 10.0;
      gfc.pinfo.over_SSD[gr][ch] = noise.over_SSD;
    };
  }

  module.exports = $5dfff05939c3cc74$var$QuantizePVT;
});
var $dd7ee3788d91dcb8$exports = {};
$parcel$export($dd7ee3788d91dcb8$exports, "Mp3Encoder", () => $dd7ee3788d91dcb8$export$9ca5d136ebf61cf2, v => $dd7ee3788d91dcb8$export$9ca5d136ebf61cf2 = v);
$parcel$export($dd7ee3788d91dcb8$exports, "WavHeader", () => $dd7ee3788d91dcb8$export$cb948f2d6837f136, v => $dd7ee3788d91dcb8$export$cb948f2d6837f136 = v);
var $dd7ee3788d91dcb8$export$9ca5d136ebf61cf2;
var $dd7ee3788d91dcb8$export$cb948f2d6837f136;
var $3YDN3 = parcelRequire("3YDN3");
$3YDN3.System;
$3YDN3.VbrMode;
$3YDN3.Float;
$3YDN3.ShortBlock;
$3YDN3.Util;
$3YDN3.Arrays;
$3YDN3.new_array_n;
var $dd7ee3788d91dcb8$var$new_byte = $3YDN3.new_byte;
$3YDN3.new_double;
$3YDN3.new_float;
$3YDN3.new_float_n;
$3YDN3.new_int;
$3YDN3.new_int_n;
var $dd7ee3788d91dcb8$var$assert = $3YDN3.assert;
var $kk1yk = parcelRequire("kk1yk");
var $7960aab77e945546$exports = {};
var $3YDN3 = parcelRequire("3YDN3");
$3YDN3.System;
var $7960aab77e945546$var$VbrMode = $3YDN3.VbrMode;
$3YDN3.Float;
$3YDN3.ShortBlock;
$3YDN3.Util;
$3YDN3.Arrays;
$3YDN3.new_array_n;
$3YDN3.new_byte;
$3YDN3.new_double;
$3YDN3.new_float;
$3YDN3.new_float_n;
$3YDN3.new_int;
$3YDN3.new_int_n;
$3YDN3.assert;

function $7960aab77e945546$var$Presets() {
  var Lame = parcelRequire("kk1yk");

  function VBRPresets(qual, comp, compS, y, shThreshold, shThresholdS, adj, adjShort, lower, curve, sens, inter, joint, mod, fix) {
    this.vbr_q = qual;
    this.quant_comp = comp;
    this.quant_comp_s = compS;
    this.expY = y;
    this.st_lrm = shThreshold;
    this.st_s = shThresholdS;
    this.masking_adj = adj;
    this.masking_adj_short = adjShort;
    this.ath_lower = lower;
    this.ath_curve = curve;
    this.ath_sensitivity = sens;
    this.interch = inter;
    this.safejoint = joint;
    this.sfb21mod = mod;
    this.msfix = fix;
  }

  function ABRPresets(kbps, comp, compS, joint, fix, shThreshold, shThresholdS, bass, sc, mask, lower, curve, interCh, sfScale) {
    this.quant_comp = comp;
    this.quant_comp_s = compS;
    this.safejoint = joint;
    this.nsmsfix = fix;
    this.st_lrm = shThreshold;
    this.st_s = shThresholdS;
    this.nsbass = bass;
    this.scale = sc;
    this.masking_adj = mask;
    this.ath_lower = lower;
    this.ath_curve = curve;
    this.interch = interCh;
    this.sfscale = sfScale;
  }

  var lame;

  this.setModules = function (_lame) {
    lame = _lame;
  };
  /**
  * <PRE>
  * Switch mappings for VBR mode VBR_RH
  *             vbr_q  qcomp_l  qcomp_s  expY  st_lrm   st_s  mask adj_l  adj_s  ath_lower  ath_curve  ath_sens  interChR  safejoint sfb21mod  msfix
  * </PRE>
  */


  var vbr_old_switch_map = [new VBRPresets(0, 9, 9, 0, 5.20, 125.0, -4.2, -6.3, 4.8, 1, 0, 0, 2, 21, 0.97), new VBRPresets(1, 9, 9, 0, 5.30, 125.0, -3.6, -5.6, 4.5, 1.5, 0, 0, 2, 21, 1.35), new VBRPresets(2, 9, 9, 0, 5.60, 125.0, -2.2, -3.5, 2.8, 2, 0, 0, 2, 21, 1.49), new VBRPresets(3, 9, 9, 1, 5.80, 130.0, -1.8, -2.8, 2.6, 3, -4, 0, 2, 20, 1.64), new VBRPresets(4, 9, 9, 1, 6.00, 135.0, -0.7, -1.1, 1.1, 3.5, -8, 0, 2, 0, 1.79), new VBRPresets(5, 9, 9, 1, 6.40, 140.0, 0.5, 0.4, -7.5, 4, -12, 0.0002, 0, 0, 1.95), new VBRPresets(6, 9, 9, 1, 6.60, 145.0, 0.67, 0.65, -14.7, 6.5, -19, 0.0004, 0, 0, 2.30), new VBRPresets(7, 9, 9, 1, 6.60, 145.0, 0.8, 0.75, -19.7, 8, -22, 0.0006, 0, 0, 2.70), new VBRPresets(8, 9, 9, 1, 6.60, 145.0, 1.2, 1.15, -27.5, 10, -23, 0.0007, 0, 0, 0), new VBRPresets(9, 9, 9, 1, 6.60, 145.0, 1.6, 1.6, -36, 11, -25, 0.0008, 0, 0, 0), new VBRPresets(10, 9, 9, 1, 6.60, 145.0, 2.0, 2.0, -36, 12, -25, 0.0008, 0, 0, 0)];
  /**
  * <PRE>
  *                 vbr_q  qcomp_l  qcomp_s  expY  st_lrm   st_s  mask adj_l  adj_s  ath_lower  ath_curve  ath_sens  interChR  safejoint sfb21mod  msfix
  * </PRE>
  */

  var vbr_psy_switch_map = [new VBRPresets(0, 9, 9, 0, 4.20, 25.0, -7, -4, 7.5, 1, 0, 0, 2, 26, 0.97), new VBRPresets(1, 9, 9, 0, 4.20, 25.0, -5.6, -3.6, 4.5, 1.5, 0, 0, 2, 21, 1.35), new VBRPresets(2, 9, 9, 0, 4.20, 25.0, -4.4, -1.8, 2, 2, 0, 0, 2, 18, 1.49), new VBRPresets(3, 9, 9, 1, 4.20, 25.0, -3.4, -1.25, 1.1, 3, -4, 0, 2, 15, 1.64), new VBRPresets(4, 9, 9, 1, 4.20, 25.0, -2.2, 0.1, 0, 3.5, -8, 0, 2, 0, 1.79), new VBRPresets(5, 9, 9, 1, 4.20, 25.0, -1, 1.65, -7.7, 4, -12, 0.0002, 0, 0, 1.95), new VBRPresets(6, 9, 9, 1, 4.20, 25.0, -0, 2.47, -7.7, 6.5, -19, 0.0004, 0, 0, 2), new VBRPresets(7, 9, 9, 1, 4.20, 25.0, 0.5, 2.0, -14.5, 8, -22, 0.0006, 0, 0, 2), new VBRPresets(8, 9, 9, 1, 4.20, 25.0, 1.0, 2.4, -22, 10, -23, 0.0007, 0, 0, 2), new VBRPresets(9, 9, 9, 1, 4.20, 25.0, 1.5, 2.95, -30, 11, -25, 0.0008, 0, 0, 2), new VBRPresets(10, 9, 9, 1, 4.20, 25.0, 2.0, 2.95, -36, 12, -30, 0.0008, 0, 0, 2)];

  function apply_vbr_preset(gfp, a, enforce) {
    var vbr_preset = gfp.VBR == $7960aab77e945546$var$VbrMode.vbr_rh ? vbr_old_switch_map : vbr_psy_switch_map;
    var x = gfp.VBR_q_frac;
    var p = vbr_preset[a];
    var q = vbr_preset[a + 1];
    var set = p; // NOOP(vbr_q);
    // NOOP(quant_comp);
    // NOOP(quant_comp_s);
    // NOOP(expY);

    p.st_lrm = p.st_lrm + x * (q.st_lrm - p.st_lrm); // LERP(st_lrm);

    p.st_s = p.st_s + x * (q.st_s - p.st_s); // LERP(st_s);

    p.masking_adj = p.masking_adj + x * (q.masking_adj - p.masking_adj); // LERP(masking_adj);

    p.masking_adj_short = p.masking_adj_short + x * (q.masking_adj_short - p.masking_adj_short); // LERP(masking_adj_short);

    p.ath_lower = p.ath_lower + x * (q.ath_lower - p.ath_lower); // LERP(ath_lower);

    p.ath_curve = p.ath_curve + x * (q.ath_curve - p.ath_curve); // LERP(ath_curve);

    p.ath_sensitivity = p.ath_sensitivity + x * (q.ath_sensitivity - p.ath_sensitivity); // LERP(ath_sensitivity);

    p.interch = p.interch + x * (q.interch - p.interch); // LERP(interch);
    // NOOP(safejoint);
    // NOOP(sfb21mod);

    p.msfix = p.msfix + x * (q.msfix - p.msfix); // LERP(msfix);

    lame_set_VBR_q(gfp, set.vbr_q);
    if (enforce != 0) gfp.quant_comp = set.quant_comp;else if (!(Math.abs(gfp.quant_comp - -1) > 0)) gfp.quant_comp = set.quant_comp; // SET_OPTION(quant_comp, set.quant_comp, -1);

    if (enforce != 0) gfp.quant_comp_short = set.quant_comp_s;else if (!(Math.abs(gfp.quant_comp_short - -1) > 0)) gfp.quant_comp_short = set.quant_comp_s; // SET_OPTION(quant_comp_short, set.quant_comp_s, -1);

    if (set.expY != 0) gfp.experimentalY = set.expY != 0;
    if (enforce != 0) gfp.internal_flags.nsPsy.attackthre = set.st_lrm;else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre - -1) > 0)) gfp.internal_flags.nsPsy.attackthre = set.st_lrm; // SET_OPTION(short_threshold_lrm, set.st_lrm, -1);

    if (enforce != 0) gfp.internal_flags.nsPsy.attackthre_s = set.st_s;else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre_s - -1) > 0)) gfp.internal_flags.nsPsy.attackthre_s = set.st_s; // SET_OPTION(short_threshold_s, set.st_s, -1);

    if (enforce != 0) gfp.maskingadjust = set.masking_adj;else if (!(Math.abs(gfp.maskingadjust - 0) > 0)) gfp.maskingadjust = set.masking_adj; // SET_OPTION(maskingadjust, set.masking_adj, 0);

    if (enforce != 0) gfp.maskingadjust_short = set.masking_adj_short;else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0)) gfp.maskingadjust_short = set.masking_adj_short; // SET_OPTION(maskingadjust_short, set.masking_adj_short, 0);

    if (enforce != 0) gfp.ATHlower = -set.ath_lower / 10.0;else if (!(Math.abs(-gfp.ATHlower * 10.0 - 0) > 0)) gfp.ATHlower = -set.ath_lower / 10.0; // SET_OPTION(ATHlower, set.ath_lower, 0);

    if (enforce != 0) gfp.ATHcurve = set.ath_curve;else if (!(Math.abs(gfp.ATHcurve - -1) > 0)) gfp.ATHcurve = set.ath_curve; // SET_OPTION(ATHcurve, set.ath_curve, -1);

    if (enforce != 0) gfp.athaa_sensitivity = set.ath_sensitivity;else if (!(Math.abs(gfp.athaa_sensitivity - -1) > 0)) gfp.athaa_sensitivity = set.ath_sensitivity; // SET_OPTION(athaa_sensitivity, set.ath_sensitivity, 0);

    if (set.interch > 0) {
      if (enforce != 0) gfp.interChRatio = set.interch;else if (!(Math.abs(gfp.interChRatio - -1) > 0)) gfp.interChRatio = set.interch; // SET_OPTION(interChRatio, set.interch, -1);
    }
    /* parameters for which there is no proper set/get interface */


    if (set.safejoint > 0) gfp.exp_nspsytune = gfp.exp_nspsytune | set.safejoint;
    if (set.sfb21mod > 0) gfp.exp_nspsytune = gfp.exp_nspsytune | set.sfb21mod << 20;
    if (enforce != 0) gfp.msfix = set.msfix;else if (!(Math.abs(gfp.msfix - -1) > 0)) gfp.msfix = set.msfix; // SET_OPTION(msfix, set.msfix, -1);

    if (enforce == 0) {
      gfp.VBR_q = a;
      gfp.VBR_q_frac = x;
    }
  }
  /**
  * <PRE>
  *  Switch mappings for ABR mode
  *
  *              kbps  quant q_s safejoint nsmsfix st_lrm  st_s  ns-bass scale   msk ath_lwr ath_curve  interch , sfscale
  * </PRE>
  */


  var abr_switch_map = [new ABRPresets(8, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -30, 11, 0.0012, 1),
  /*   8, impossible to use in stereo */
  new ABRPresets(16, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -25, 11, 0.0010, 1),
  /*  16 */
  new ABRPresets(24, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -20, 11, 0.0010, 1),
  /*  24 */
  new ABRPresets(32, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -15, 11, 0.0010, 1),
  /*  32 */
  new ABRPresets(40, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -10, 11, 0.0009, 1),
  /*  40 */
  new ABRPresets(48, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -10, 11, 0.0009, 1),
  /*  48 */
  new ABRPresets(56, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -6, 11, 0.0008, 1),
  /*  56 */
  new ABRPresets(64, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -2, 11, 0.0008, 1),
  /*  64 */
  new ABRPresets(80, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, .0, 8, 0.0007, 1),
  /*  80 */
  new ABRPresets(96, 9, 9, 0, 2.50, 6.60, 145, 0, 0.95, 0, 1.0, 5.5, 0.0006, 1),
  /*  96 */
  new ABRPresets(112, 9, 9, 0, 2.25, 6.60, 145, 0, 0.95, 0, 2.0, 4.5, 0.0005, 1),
  /* 112 */
  new ABRPresets(128, 9, 9, 0, 1.95, 6.40, 140, 0, 0.95, 0, 3.0, 4, 0.0002, 1),
  /* 128 */
  new ABRPresets(160, 9, 9, 1, 1.79, 6.00, 135, 0, 0.95, -2, 5.0, 3.5, 0, 1),
  /* 160 */
  new ABRPresets(192, 9, 9, 1, 1.49, 5.60, 125, 0, 0.97, -4, 7.0, 3, 0, 0),
  /* 192 */
  new ABRPresets(224, 9, 9, 1, 1.25, 5.20, 125, 0, 0.98, -6, 9.0, 2, 0, 0),
  /* 224 */
  new ABRPresets(256, 9, 9, 1, 0.97, 5.20, 125, 0, 1.00, -8, 10.0, 1, 0, 0),
  /* 256 */
  new ABRPresets(320, 9, 9, 1, 0.90, 5.20, 125, 0, 1.00, -10, 12.0, 0, 0, 0)];

  function apply_abr_preset(gfp, preset, enforce) {
    /* Variables for the ABR stuff */
    var actual_bitrate = preset;
    var r = lame.nearestBitrateFullIndex(preset);
    gfp.VBR = $7960aab77e945546$var$VbrMode.vbr_abr;
    gfp.VBR_mean_bitrate_kbps = actual_bitrate;
    gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps, 320);
    gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps, 8);
    gfp.brate = gfp.VBR_mean_bitrate_kbps;
    if (gfp.VBR_mean_bitrate_kbps > 320) gfp.disable_reservoir = true;
    /* parameters for which there is no proper set/get interface */

    if (abr_switch_map[r].safejoint > 0) gfp.exp_nspsytune = gfp.exp_nspsytune | 2;
    /* safejoint */

    if (abr_switch_map[r].sfscale > 0) gfp.internal_flags.noise_shaping = 2;
    /* ns-bass tweaks */

    if (Math.abs(abr_switch_map[r].nsbass) > 0) {
      var k = int(abr_switch_map[r].nsbass * 4);
      if (k < 0) k += 64;
      gfp.exp_nspsytune = gfp.exp_nspsytune | k << 2;
    }

    if (enforce != 0) gfp.quant_comp = abr_switch_map[r].quant_comp;else if (!(Math.abs(gfp.quant_comp - -1) > 0)) gfp.quant_comp = abr_switch_map[r].quant_comp; // SET_OPTION(quant_comp, abr_switch_map[r].quant_comp, -1);

    if (enforce != 0) gfp.quant_comp_short = abr_switch_map[r].quant_comp_s;else if (!(Math.abs(gfp.quant_comp_short - -1) > 0)) gfp.quant_comp_short = abr_switch_map[r].quant_comp_s; // SET_OPTION(quant_comp_short, abr_switch_map[r].quant_comp_s, -1);

    if (enforce != 0) gfp.msfix = abr_switch_map[r].nsmsfix;else if (!(Math.abs(gfp.msfix - -1) > 0)) gfp.msfix = abr_switch_map[r].nsmsfix; // SET_OPTION(msfix, abr_switch_map[r].nsmsfix, -1);

    if (enforce != 0) gfp.internal_flags.nsPsy.attackthre = abr_switch_map[r].st_lrm;else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre - -1) > 0)) gfp.internal_flags.nsPsy.attackthre = abr_switch_map[r].st_lrm; // SET_OPTION(short_threshold_lrm, abr_switch_map[r].st_lrm, -1);

    if (enforce != 0) gfp.internal_flags.nsPsy.attackthre_s = abr_switch_map[r].st_s;else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre_s - -1) > 0)) gfp.internal_flags.nsPsy.attackthre_s = abr_switch_map[r].st_s; // SET_OPTION(short_threshold_s, abr_switch_map[r].st_s, -1);

    /*
             * ABR seems to have big problems with clipping, especially at low
             * bitrates
             */

    /*
    * so we compensate for that here by using a scale value depending on
    * bitrate
    */

    if (enforce != 0) gfp.scale = abr_switch_map[r].scale;else if (!(Math.abs(gfp.scale - -1) > 0)) gfp.scale = abr_switch_map[r].scale; // SET_OPTION(scale, abr_switch_map[r].scale, -1);

    if (enforce != 0) gfp.maskingadjust = abr_switch_map[r].masking_adj;else if (!(Math.abs(gfp.maskingadjust - 0) > 0)) gfp.maskingadjust = abr_switch_map[r].masking_adj; // SET_OPTION(maskingadjust, abr_switch_map[r].masking_adj, 0);

    if (abr_switch_map[r].masking_adj > 0) {
      if (enforce != 0) gfp.maskingadjust_short = abr_switch_map[r].masking_adj * .9;else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0)) gfp.maskingadjust_short = abr_switch_map[r].masking_adj * .9; // SET_OPTION(maskingadjust_short, abr_switch_map[r].masking_adj *
      // .9, 0);
    } else {
      if (enforce != 0) gfp.maskingadjust_short = abr_switch_map[r].masking_adj * 1.1;else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0)) gfp.maskingadjust_short = abr_switch_map[r].masking_adj * 1.1; // SET_OPTION(maskingadjust_short, abr_switch_map[r].masking_adj *
      // 1.1, 0);
    }

    if (enforce != 0) gfp.ATHlower = -abr_switch_map[r].ath_lower / 10.;else if (!(Math.abs(-gfp.ATHlower * 10. - 0) > 0)) gfp.ATHlower = -abr_switch_map[r].ath_lower / 10.; // SET_OPTION(ATHlower, abr_switch_map[r].ath_lower, 0);

    if (enforce != 0) gfp.ATHcurve = abr_switch_map[r].ath_curve;else if (!(Math.abs(gfp.ATHcurve - -1) > 0)) gfp.ATHcurve = abr_switch_map[r].ath_curve; // SET_OPTION(ATHcurve, abr_switch_map[r].ath_curve, -1);

    if (enforce != 0) gfp.interChRatio = abr_switch_map[r].interch;else if (!(Math.abs(gfp.interChRatio - -1) > 0)) gfp.interChRatio = abr_switch_map[r].interch; // SET_OPTION(interChRatio, abr_switch_map[r].interch, -1);

    return preset;
  }

  this.apply_preset = function (gfp, preset, enforce) {
    /* translate legacy presets */
    switch (preset) {
      case Lame.R3MIX:
        preset = Lame.V3;
        gfp.VBR = $7960aab77e945546$var$VbrMode.vbr_mtrh;
        break;

      case Lame.MEDIUM:
        preset = Lame.V4;
        gfp.VBR = $7960aab77e945546$var$VbrMode.vbr_rh;
        break;

      case Lame.MEDIUM_FAST:
        preset = Lame.V4;
        gfp.VBR = $7960aab77e945546$var$VbrMode.vbr_mtrh;
        break;

      case Lame.STANDARD:
        preset = Lame.V2;
        gfp.VBR = $7960aab77e945546$var$VbrMode.vbr_rh;
        break;

      case Lame.STANDARD_FAST:
        preset = Lame.V2;
        gfp.VBR = $7960aab77e945546$var$VbrMode.vbr_mtrh;
        break;

      case Lame.EXTREME:
        preset = Lame.V0;
        gfp.VBR = $7960aab77e945546$var$VbrMode.vbr_rh;
        break;

      case Lame.EXTREME_FAST:
        preset = Lame.V0;
        gfp.VBR = $7960aab77e945546$var$VbrMode.vbr_mtrh;
        break;

      case Lame.INSANE:
        preset = 320;
        gfp.preset = preset;
        apply_abr_preset(gfp, preset, enforce);
        gfp.VBR = $7960aab77e945546$var$VbrMode.vbr_off;
        return preset;
    }

    gfp.preset = preset;

    switch (preset) {
      case Lame.V9:
        apply_vbr_preset(gfp, 9, enforce);
        return preset;

      case Lame.V8:
        apply_vbr_preset(gfp, 8, enforce);
        return preset;

      case Lame.V7:
        apply_vbr_preset(gfp, 7, enforce);
        return preset;

      case Lame.V6:
        apply_vbr_preset(gfp, 6, enforce);
        return preset;

      case Lame.V5:
        apply_vbr_preset(gfp, 5, enforce);
        return preset;

      case Lame.V4:
        apply_vbr_preset(gfp, 4, enforce);
        return preset;

      case Lame.V3:
        apply_vbr_preset(gfp, 3, enforce);
        return preset;

      case Lame.V2:
        apply_vbr_preset(gfp, 2, enforce);
        return preset;

      case Lame.V1:
        apply_vbr_preset(gfp, 1, enforce);
        return preset;

      case Lame.V0:
        apply_vbr_preset(gfp, 0, enforce);
        return preset;
    }

    if (8 <= preset && preset <= 320) return apply_abr_preset(gfp, preset, enforce);
    /* no corresponding preset found */

    gfp.preset = 0;
    return preset;
  }; // Rest from getset.c:

  /**
       * VBR quality level.<BR>
       * 0 = highest<BR>
       * 9 = lowest
       */


  function lame_set_VBR_q(gfp, VBR_q) {
    var ret = 0;

    if (0 > VBR_q) {
      /* Unknown VBR quality level! */
      ret = -1;
      VBR_q = 0;
    }

    if (9 < VBR_q) {
      ret = -1;
      VBR_q = 9;
    }

    gfp.VBR_q = VBR_q;
    gfp.VBR_q_frac = 0;
    return ret;
  }
}

$7960aab77e945546$exports = $7960aab77e945546$var$Presets;
var $b8dhq = parcelRequire("b8dhq");
var $84mea = parcelRequire("84mea");
var $df08f3a0d41b7a78$exports = {};
/*
* MP3 quantization
*
*      Copyright (c) 1999-2000 Mark Taylor
*      Copyright (c) 1999-2003 Takehiro Tominaga
*      Copyright (c) 2000-2007 Robert Hegemann
*      Copyright (c) 2001-2005 Gabriel Bouvigne
*
* This library is free software; you can redistribute it and/or
* modify it under the terms of the GNU Lesser General Public
* License as published by the Free Software Foundation; either
* version 2 of the License, or (at your option) any later version.
*
* This library is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.     See the GNU
* Library General Public License for more details.
*
* You should have received a copy of the GNU Lesser General Public
* License along with this library; if not, write to the
* Free Software Foundation, Inc., 59 Temple Place - Suite 330,
* Boston, MA 02111-1307, USA.
*/

/* $Id: Quantize.java,v 1.24 2011/05/24 20:48:06 kenchis Exp $ */
//package mp3;
//import java.util.Arrays;

var $3YDN3 = parcelRequire("3YDN3");
var $df08f3a0d41b7a78$var$System = $3YDN3.System;
var $df08f3a0d41b7a78$var$VbrMode = $3YDN3.VbrMode;
$3YDN3.Float;
$3YDN3.ShortBlock;
var $df08f3a0d41b7a78$var$Util = $3YDN3.Util;
var $df08f3a0d41b7a78$var$Arrays = $3YDN3.Arrays;
$3YDN3.new_array_n;
$3YDN3.new_byte;
$3YDN3.new_double;
var $df08f3a0d41b7a78$var$new_float = $3YDN3.new_float;
$3YDN3.new_float_n;
$3YDN3.new_int;
$3YDN3.new_int_n;
var $df08f3a0d41b7a78$var$assert = $3YDN3.assert;
var $225800021a714f05$exports = {};

function $225800021a714f05$var$VBRQuantize() {
  this.setModules = function (_qupvt, _tk) {}; //TODO

}

$225800021a714f05$exports = $225800021a714f05$var$VBRQuantize;
var $3afa85f14aff627b$exports = {}; //package mp3;

function $3afa85f14aff627b$var$CalcNoiseResult() {
  /**
  * sum of quantization noise > masking
  */
  this.over_noise = 0.;
  /**
  * sum of all quantization noise
  */

  this.tot_noise = 0.;
  /**
  * max quantization noise
  */

  this.max_noise = 0.;
  /**
  * number of quantization noise > masking
  */

  this.over_count = 0;
  /**
  * SSD-like cost of distorted bands
  */

  this.over_SSD = 0;
  this.bits = 0;
}

$3afa85f14aff627b$exports = $3afa85f14aff627b$var$CalcNoiseResult;
var $4fc41bdea3aedc83$exports = {};
var $3YDN3 = parcelRequire("3YDN3");
var $4fc41bdea3aedc83$var$new_float = $3YDN3.new_float;
var $4fc41bdea3aedc83$var$new_int = $3YDN3.new_int;
$3YDN3.assert;

function $4fc41bdea3aedc83$var$CalcNoiseData() {
  this.global_gain = 0;
  this.sfb_count1 = 0;
  this.step = $4fc41bdea3aedc83$var$new_int(39);
  this.noise = $4fc41bdea3aedc83$var$new_float(39);
  this.noise_log = $4fc41bdea3aedc83$var$new_float(39);
}

$4fc41bdea3aedc83$exports = $4fc41bdea3aedc83$var$CalcNoiseData;
var $cPNKB = parcelRequire("cPNKB");
var $7weBo = parcelRequire("7weBo");
var $arIi9 = parcelRequire("arIi9");

function $df08f3a0d41b7a78$var$Quantize() {
  var bs;
  this.rv = null;
  var rv;
  this.qupvt = null;
  var qupvt;
  var vbr = new $225800021a714f05$exports();
  var tk;

  this.setModules = function (_bs, _rv, _qupvt, _tk) {
    bs = _bs;
    rv = _rv;
    this.rv = _rv;
    qupvt = _qupvt;
    this.qupvt = _qupvt;
    tk = _tk;
    vbr.setModules(qupvt, tk);
  };
  /**
  * convert from L/R <. Mid/Side
  */


  this.ms_convert = function (l3_side, gr) {
    for (var i = 0; i < 576; ++i) {
      var l = l3_side.tt[gr][0].xr[i];
      var r = l3_side.tt[gr][1].xr[i];
      l3_side.tt[gr][0].xr[i] = (l + r) * ($df08f3a0d41b7a78$var$Util.SQRT2 * 0.5);
      l3_side.tt[gr][1].xr[i] = (l - r) * ($df08f3a0d41b7a78$var$Util.SQRT2 * 0.5);
    }
  };
  /**
  * mt 6/99
  *
  * initializes cod_info, scalefac and xrpow
  *
  * returns 0 if all energies in xr are zero, else 1
  */


  function init_xrpow_core(cod_info, xrpow, upper, sum) {
    sum = 0;

    for (var i = 0; i <= upper; ++i) {
      var tmp = Math.abs(cod_info.xr[i]);
      sum += tmp;
      xrpow[i] = Math.sqrt(tmp * Math.sqrt(tmp));
      if (xrpow[i] > cod_info.xrpow_max) cod_info.xrpow_max = xrpow[i];
    }

    return sum;
  }

  this.init_xrpow = function (gfc, cod_info, xrpow) {
    var sum = 0;
    var upper = 0 | cod_info.max_nonzero_coeff;
    $df08f3a0d41b7a78$var$assert(xrpow != null);
    cod_info.xrpow_max = 0;
    /*
    * check if there is some energy we have to quantize and calculate xrpow
    * matching our fresh scalefactors
    */

    $df08f3a0d41b7a78$var$assert(0 <= upper && upper <= 575);
    $df08f3a0d41b7a78$var$Arrays.fill(xrpow, upper, 576, 0);
    sum = init_xrpow_core(cod_info, xrpow, upper, sum);
    /*
    * return 1 if we have something to quantize, else 0
    */

    if (sum > 1E-20) {
      var j = 0;
      if ((gfc.substep_shaping & 2) != 0) j = 1;

      for (var i = 0; i < cod_info.psymax; i++) gfc.pseudohalf[i] = j;

      return true;
    }

    $df08f3a0d41b7a78$var$Arrays.fill(cod_info.l3_enc, 0, 576, 0);
    return false;
  };
  /**
  * Gabriel Bouvigne feb/apr 2003<BR>
  * Analog silence detection in partitionned sfb21 or sfb12 for short blocks
  *
  * From top to bottom of sfb, changes to 0 coeffs which are below ath. It
  * stops on the first coeff higher than ath.
  */


  function psfb21_analogsilence(gfc, cod_info) {
    var ath = gfc.ATH;
    var xr = cod_info.xr;

    if (cod_info.block_type != $cPNKB.SHORT_TYPE) {
      /* NORM, START or STOP type, but not SHORT blocks */
      var stop = false;

      for (var gsfb = $cPNKB.PSFB21 - 1; gsfb >= 0 && !stop; gsfb--) {
        var start = gfc.scalefac_band.psfb21[gsfb];
        var end = gfc.scalefac_band.psfb21[gsfb + 1];
        var ath21 = qupvt.athAdjust(ath.adjust, ath.psfb21[gsfb], ath.floor);
        if (gfc.nsPsy.longfact[21] > 1e-12) ath21 *= gfc.nsPsy.longfact[21];

        for (var j = end - 1; j >= start; j--) if (Math.abs(xr[j]) < ath21) xr[j] = 0;else {
          stop = true;
          break;
        }
      }
    } else
      /* note: short blocks coeffs are reordered */
      for (var block = 0; block < 3; block++) {
        var stop = false;

        for (var gsfb = $cPNKB.PSFB12 - 1; gsfb >= 0 && !stop; gsfb--) {
          var start = gfc.scalefac_band.s[12] * 3 + (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12]) * block + (gfc.scalefac_band.psfb12[gsfb] - gfc.scalefac_band.psfb12[0]);
          var end = start + (gfc.scalefac_band.psfb12[gsfb + 1] - gfc.scalefac_band.psfb12[gsfb]);
          var ath12 = qupvt.athAdjust(ath.adjust, ath.psfb12[gsfb], ath.floor);
          if (gfc.nsPsy.shortfact[12] > 1e-12) ath12 *= gfc.nsPsy.shortfact[12];

          for (var j = end - 1; j >= start; j--) if (Math.abs(xr[j]) < ath12) xr[j] = 0;else {
            stop = true;
            break;
          }
        }
      }
  }

  this.init_outer_loop = function (gfc, cod_info) {
    /*
    * initialize fresh cod_info
    */
    cod_info.part2_3_length = 0;
    cod_info.big_values = 0;
    cod_info.count1 = 0;
    cod_info.global_gain = 210;
    cod_info.scalefac_compress = 0;
    /* mixed_block_flag, block_type was set in psymodel.c */

    cod_info.table_select[0] = 0;
    cod_info.table_select[1] = 0;
    cod_info.table_select[2] = 0;
    cod_info.subblock_gain[0] = 0;
    cod_info.subblock_gain[1] = 0;
    cod_info.subblock_gain[2] = 0;
    cod_info.subblock_gain[3] = 0;
    /* this one is always 0 */

    cod_info.region0_count = 0;
    cod_info.region1_count = 0;
    cod_info.preflag = 0;
    cod_info.scalefac_scale = 0;
    cod_info.count1table_select = 0;
    cod_info.part2_length = 0;
    cod_info.sfb_lmax = $cPNKB.SBPSY_l;
    cod_info.sfb_smin = $cPNKB.SBPSY_s;
    cod_info.psy_lmax = gfc.sfb21_extra ? $cPNKB.SBMAX_l : $cPNKB.SBPSY_l;
    cod_info.psymax = cod_info.psy_lmax;
    cod_info.sfbmax = cod_info.sfb_lmax;
    cod_info.sfbdivide = 11;

    for (var sfb = 0; sfb < $cPNKB.SBMAX_l; sfb++) {
      cod_info.width[sfb] = gfc.scalefac_band.l[sfb + 1] - gfc.scalefac_band.l[sfb];
      /* which is always 0. */

      cod_info.window[sfb] = 3;
    }

    if (cod_info.block_type == $cPNKB.SHORT_TYPE) {
      var ixwork = $df08f3a0d41b7a78$var$new_float(576);
      cod_info.sfb_smin = 0;
      cod_info.sfb_lmax = 0;

      if (cod_info.mixed_block_flag != 0) {
        /*
        * MPEG-1: sfbs 0-7 long block, 3-12 short blocks MPEG-2(.5):
        * sfbs 0-5 long block, 3-12 short blocks
        */
        cod_info.sfb_smin = 3;
        cod_info.sfb_lmax = gfc.mode_gr * 2 + 4;
      }

      cod_info.psymax = cod_info.sfb_lmax + 3 * ((gfc.sfb21_extra ? $cPNKB.SBMAX_s : $cPNKB.SBPSY_s) - cod_info.sfb_smin);
      cod_info.sfbmax = cod_info.sfb_lmax + 3 * ($cPNKB.SBPSY_s - cod_info.sfb_smin);
      cod_info.sfbdivide = cod_info.sfbmax - 18;
      cod_info.psy_lmax = cod_info.sfb_lmax;
      /* re-order the short blocks, for more efficient encoding below */

      /* By Takehiro TOMINAGA */

      /*
      * Within each scalefactor band, data is given for successive time
      * windows, beginning with window 0 and ending with window 2. Within
      * each window, the quantized values are then arranged in order of
      * increasing frequency...
      */

      var ix = gfc.scalefac_band.l[cod_info.sfb_lmax];
      $df08f3a0d41b7a78$var$System.arraycopy(cod_info.xr, 0, ixwork, 0, 576);

      for (var sfb = cod_info.sfb_smin; sfb < $cPNKB.SBMAX_s; sfb++) {
        var start = gfc.scalefac_band.s[sfb];
        var end = gfc.scalefac_band.s[sfb + 1];

        for (var window = 0; window < 3; window++) for (var l = start; l < end; l++) cod_info.xr[ix++] = ixwork[3 * l + window];
      }

      var j = cod_info.sfb_lmax;

      for (var sfb = cod_info.sfb_smin; sfb < $cPNKB.SBMAX_s; sfb++) {
        cod_info.width[j] = cod_info.width[j + 1] = cod_info.width[j + 2] = gfc.scalefac_band.s[sfb + 1] - gfc.scalefac_band.s[sfb];
        cod_info.window[j] = 0;
        cod_info.window[j + 1] = 1;
        cod_info.window[j + 2] = 2;
        j += 3;
      }
    }

    cod_info.count1bits = 0;
    cod_info.sfb_partition_table = qupvt.nr_of_sfb_block[0][0];
    cod_info.slen[0] = 0;
    cod_info.slen[1] = 0;
    cod_info.slen[2] = 0;
    cod_info.slen[3] = 0;
    cod_info.max_nonzero_coeff = 575;
    /*
    * fresh scalefactors are all zero
    */

    $df08f3a0d41b7a78$var$Arrays.fill(cod_info.scalefac, 0);
    psfb21_analogsilence(gfc, cod_info);
  };

  function BinSearchDirection(ordinal) {
    this.ordinal = ordinal;
  }

  BinSearchDirection.BINSEARCH_NONE = new BinSearchDirection(0);
  BinSearchDirection.BINSEARCH_UP = new BinSearchDirection(1);
  BinSearchDirection.BINSEARCH_DOWN = new BinSearchDirection(2);
  /**
  * author/date??
  *
  * binary step size search used by outer_loop to get a quantizer step size
  * to start with
  */

  function bin_search_StepSize(gfc, cod_info, desired_rate, ch, xrpow) {
    var nBits;
    var CurrentStep = gfc.CurrentStep[ch];
    var flagGoneOver = false;
    var start = gfc.OldValue[ch];
    var Direction = BinSearchDirection.BINSEARCH_NONE;
    cod_info.global_gain = start;
    desired_rate -= cod_info.part2_length;
    $df08f3a0d41b7a78$var$assert(CurrentStep != 0);

    for (;;) {
      var step;
      nBits = tk.count_bits(gfc, xrpow, cod_info, null);
      if (CurrentStep == 1 || nBits == desired_rate) break;
      /* nothing to adjust anymore */

      if (nBits > desired_rate) {
        /* increase Quantize_StepSize */
        if (Direction == BinSearchDirection.BINSEARCH_DOWN) flagGoneOver = true;
        if (flagGoneOver) CurrentStep /= 2;
        Direction = BinSearchDirection.BINSEARCH_UP;
        step = CurrentStep;
      } else {
        /* decrease Quantize_StepSize */
        if (Direction == BinSearchDirection.BINSEARCH_UP) flagGoneOver = true;
        if (flagGoneOver) CurrentStep /= 2;
        Direction = BinSearchDirection.BINSEARCH_DOWN;
        step = -CurrentStep;
      }

      cod_info.global_gain += step;

      if (cod_info.global_gain < 0) {
        cod_info.global_gain = 0;
        flagGoneOver = true;
      }

      if (cod_info.global_gain > 255) {
        cod_info.global_gain = 255;
        flagGoneOver = true;
      }
    }

    $df08f3a0d41b7a78$var$assert(cod_info.global_gain >= 0);
    $df08f3a0d41b7a78$var$assert(cod_info.global_gain < 256);

    while (nBits > desired_rate && cod_info.global_gain < 255) {
      cod_info.global_gain++;
      nBits = tk.count_bits(gfc, xrpow, cod_info, null);
    }

    gfc.CurrentStep[ch] = start - cod_info.global_gain >= 4 ? 4 : 2;
    gfc.OldValue[ch] = cod_info.global_gain;
    cod_info.part2_3_length = nBits;
    return nBits;
  }

  this.trancate_smallspectrums = function (gfc, gi, l3_xmin, work) {
    var distort = $df08f3a0d41b7a78$var$new_float($arIi9.SFBMAX);
    if (0 == (gfc.substep_shaping & 4) && gi.block_type == $cPNKB.SHORT_TYPE || (gfc.substep_shaping & 0x80) != 0) return;
    qupvt.calc_noise(gi, l3_xmin, distort, new $3afa85f14aff627b$exports(), null);

    for (var j = 0; j < 576; j++) {
      var xr = 0.0;
      if (gi.l3_enc[j] != 0) xr = Math.abs(gi.xr[j]);
      work[j] = xr;
    }

    var j = 0;
    var sfb = 8;
    if (gi.block_type == $cPNKB.SHORT_TYPE) sfb = 6;

    do {
      var allowedNoise, trancateThreshold;
      var nsame, start;
      var width = gi.width[sfb];
      j += width;
      if (distort[sfb] >= 1.0) continue;
      $df08f3a0d41b7a78$var$Arrays.sort(work, j - width, width);
      if (BitStream.EQ(work[j - 1], 0.0)) continue;
      /* all zero sfb */

      allowedNoise = (1.0 - distort[sfb]) * l3_xmin[sfb];
      trancateThreshold = 0.0;
      start = 0;

      do {
        var noise;

        for (nsame = 1; start + nsame < width; nsame++) if (BitStream.NEQ(work[start + j - width], work[start + j + nsame - width])) break;

        noise = work[start + j - width] * work[start + j - width] * nsame;

        if (allowedNoise < noise) {
          if (start != 0) trancateThreshold = work[start + j - width - 1];
          break;
        }

        allowedNoise -= noise;
        start += nsame;
      } while (start < width);

      if (BitStream.EQ(trancateThreshold, 0.0)) continue;

      do if (Math.abs(gi.xr[j - width]) <= trancateThreshold) gi.l3_enc[j - width] = 0; while (--width > 0);
    } while (++sfb < gi.psymax);

    gi.part2_3_length = tk.noquant_count_bits(gfc, gi, null);
  };
  /**
  * author/date??
  *
  * Function: Returns zero if there is a scalefac which has not been
  * amplified. Otherwise it returns one.
  */


  function loop_break(cod_info) {
    for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) if (cod_info.scalefac[sfb] + cod_info.subblock_gain[cod_info.window[sfb]] == 0) return false;

    return true;
  }
  /* mt 5/99: Function: Improved calc_noise for a single channel */


  function penalties(noise) {
    return $df08f3a0d41b7a78$var$Util.FAST_LOG10(0.368 + 0.632 * noise * noise * noise);
  }
  /**
  * author/date??
  *
  * several different codes to decide which quantization is better
  */


  function get_klemm_noise(distort, gi) {
    var klemm_noise = 1E-37;

    for (var sfb = 0; sfb < gi.psymax; sfb++) klemm_noise += penalties(distort[sfb]);

    return Math.max(1e-20, klemm_noise);
  }

  function quant_compare(quant_comp, best, calc, gi, distort) {
    /**
    * noise is given in decibels (dB) relative to masking thesholds.<BR>
    *
    * over_noise: ??? (the previous comment is fully wrong)<BR>
    * tot_noise: ??? (the previous comment is fully wrong)<BR>
    * max_noise: max quantization noise
    */
    var better;

    switch (quant_comp) {
      default:
      case 9:
        if (best.over_count > 0) {
          /* there are distorted sfb */
          better = calc.over_SSD <= best.over_SSD;
          if (calc.over_SSD == best.over_SSD) better = calc.bits < best.bits;
        } else
          /* no distorted sfb */
          better = calc.max_noise < 0 && calc.max_noise * 10 + calc.bits <= best.max_noise * 10 + best.bits;

        break;

      case 0:
        better = calc.over_count < best.over_count || calc.over_count == best.over_count && calc.over_noise < best.over_noise || calc.over_count == best.over_count && BitStream.EQ(calc.over_noise, best.over_noise) && calc.tot_noise < best.tot_noise;
        break;

      case 8:
        calc.max_noise = get_klemm_noise(distort, gi);
      //$FALL-THROUGH$

      case 1:
        better = calc.max_noise < best.max_noise;
        break;

      case 2:
        better = calc.tot_noise < best.tot_noise;
        break;

      case 3:
        better = calc.tot_noise < best.tot_noise && calc.max_noise < best.max_noise;
        break;

      case 4:
        better = calc.max_noise <= 0.0 && best.max_noise > 0.2 || calc.max_noise <= 0.0 && best.max_noise < 0.0 && best.max_noise > calc.max_noise - 0.2 && calc.tot_noise < best.tot_noise || calc.max_noise <= 0.0 && best.max_noise > 0.0 && best.max_noise > calc.max_noise - 0.2 && calc.tot_noise < best.tot_noise + best.over_noise || calc.max_noise > 0.0 && best.max_noise > -0.05 && best.max_noise > calc.max_noise - 0.1 && calc.tot_noise + calc.over_noise < best.tot_noise + best.over_noise || calc.max_noise > 0.0 && best.max_noise > -0.1 && best.max_noise > calc.max_noise - 0.15 && calc.tot_noise + calc.over_noise + calc.over_noise < best.tot_noise + best.over_noise + best.over_noise;
        break;

      case 5:
        better = calc.over_noise < best.over_noise || BitStream.EQ(calc.over_noise, best.over_noise) && calc.tot_noise < best.tot_noise;
        break;

      case 6:
        better = calc.over_noise < best.over_noise || BitStream.EQ(calc.over_noise, best.over_noise) && (calc.max_noise < best.max_noise || BitStream.EQ(calc.max_noise, best.max_noise) && calc.tot_noise <= best.tot_noise);
        break;

      case 7:
        better = calc.over_count < best.over_count || calc.over_noise < best.over_noise;
        break;
    }

    if (best.over_count == 0)
      /*
      * If no distorted bands, only use this quantization if it is
      * better, and if it uses less bits. Unfortunately, part2_3_length
      * is sometimes a poor estimator of the final size at low bitrates.
      */
      better = better && calc.bits < best.bits;
    return better;
  }
  /**
  * author/date??
  *
  * <PRE>
  *  Amplify the scalefactor bands that violate the masking threshold.
  *  See ISO 11172-3 Section C.1.5.4.3.5
  *
  *  distort[] = noise/masking
  *  distort[] > 1   ==> noise is not masked
  *  distort[] < 1   ==> noise is masked
  *  max_dist = maximum value of distort[]
  *
  *  Three algorithms:
  *  noise_shaping_amp
  *        0             Amplify all bands with distort[]>1.
  *
  *        1             Amplify all bands with distort[] >= max_dist^(.5);
  *                     ( 50% in the db scale)
  *
  *        2             Amplify first band with distort[] >= max_dist;
  *
  *
  *  For algorithms 0 and 1, if max_dist < 1, then amplify all bands
  *  with distort[] >= .95*max_dist.  This is to make sure we always
  *  amplify at least one band.
  * </PRE>
  */


  function amp_scalefac_bands(gfp, cod_info, distort, xrpow, bRefine) {
    var gfc = gfp.internal_flags;
    var ifqstep34;
    if (cod_info.scalefac_scale == 0) ifqstep34 = 1.29683955465100964055;else ifqstep34 = 1.68179283050742922612;
    /* compute maximum value of distort[] */

    var trigger = 0;

    for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) if (trigger < distort[sfb]) trigger = distort[sfb];

    var noise_shaping_amp = gfc.noise_shaping_amp;

    if (noise_shaping_amp == 3) {
      if (bRefine) noise_shaping_amp = 2;else noise_shaping_amp = 1;
    }

    switch (noise_shaping_amp) {
      case 2:
        break;

      case 1:
        /* amplify bands within 50% of max (on db scale) */
        if (trigger > 1.0) trigger = Math.pow(trigger, .5);else trigger *= .95;
        break;

      case 0:
      default:
        /* ISO algorithm. amplify all bands with distort>1 */
        if (trigger > 1.0) trigger = 1.0;else trigger *= .95;
        break;
    }

    var j = 0;

    for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {
      var width = cod_info.width[sfb];
      var l;
      j += width;
      if (distort[sfb] < trigger) continue;

      if ((gfc.substep_shaping & 2) != 0) {
        gfc.pseudohalf[sfb] = 0 == gfc.pseudohalf[sfb] ? 1 : 0;
        if (0 == gfc.pseudohalf[sfb] && gfc.noise_shaping_amp == 2) return;
      }

      cod_info.scalefac[sfb]++;

      for (l = -width; l < 0; l++) {
        xrpow[j + l] *= ifqstep34;
        if (xrpow[j + l] > cod_info.xrpow_max) cod_info.xrpow_max = xrpow[j + l];
      }

      if (gfc.noise_shaping_amp == 2) return;
    }
  }
  /**
  * Takehiro Tominaga 2000-xx-xx
  *
  * turns on scalefac scale and adjusts scalefactors
  */


  function inc_scalefac_scale(cod_info, xrpow) {
    var ifqstep34 = 1.29683955465100964055;
    var j = 0;

    for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {
      var width = cod_info.width[sfb];
      var s = cod_info.scalefac[sfb];
      if (cod_info.preflag != 0) s += qupvt.pretab[sfb];
      j += width;

      if ((s & 1) != 0) {
        s++;

        for (var l = -width; l < 0; l++) {
          xrpow[j + l] *= ifqstep34;
          if (xrpow[j + l] > cod_info.xrpow_max) cod_info.xrpow_max = xrpow[j + l];
        }
      }

      cod_info.scalefac[sfb] = s >> 1;
    }

    cod_info.preflag = 0;
    cod_info.scalefac_scale = 1;
  }
  /**
  * Takehiro Tominaga 2000-xx-xx
  *
  * increases the subblock gain and adjusts scalefactors
  */


  function inc_subblock_gain(gfc, cod_info, xrpow) {
    var sfb;
    var scalefac = cod_info.scalefac;
    /* subbloc_gain can't do anything in the long block region */

    for (sfb = 0; sfb < cod_info.sfb_lmax; sfb++) {
      if (scalefac[sfb] >= 16) return true;
    }

    for (var window = 0; window < 3; window++) {
      var s1 = 0;
      var s2 = 0;

      for (sfb = cod_info.sfb_lmax + window; sfb < cod_info.sfbdivide; sfb += 3) if (s1 < scalefac[sfb]) s1 = scalefac[sfb];

      for (; sfb < cod_info.sfbmax; sfb += 3) if (s2 < scalefac[sfb]) s2 = scalefac[sfb];

      if (s1 < 16 && s2 < 8) continue;
      if (cod_info.subblock_gain[window] >= 7) return true;
      /*
      * even though there is no scalefactor for sfb12 subblock gain
      * affects upper frequencies too, that's why we have to go up to
      * SBMAX_s
      */

      cod_info.subblock_gain[window]++;
      var j = gfc.scalefac_band.l[cod_info.sfb_lmax];

      for (sfb = cod_info.sfb_lmax + window; sfb < cod_info.sfbmax; sfb += 3) {
        var amp;
        var width = cod_info.width[sfb];
        var s = scalefac[sfb];
        $df08f3a0d41b7a78$var$assert(s >= 0);
        s = s - (4 >> cod_info.scalefac_scale);

        if (s >= 0) {
          scalefac[sfb] = s;
          j += width * 3;
          continue;
        }

        scalefac[sfb] = 0;
        var gain = 210 + (s << cod_info.scalefac_scale + 1);
        amp = qupvt.IPOW20(gain);
        j += width * (window + 1);

        for (var l = -width; l < 0; l++) {
          xrpow[j + l] *= amp;
          if (xrpow[j + l] > cod_info.xrpow_max) cod_info.xrpow_max = xrpow[j + l];
        }

        j += width * (3 - window - 1);
      }

      var amp = qupvt.IPOW20(202);
      j += cod_info.width[sfb] * (window + 1);

      for (var l = -cod_info.width[sfb]; l < 0; l++) {
        xrpow[j + l] *= amp;
        if (xrpow[j + l] > cod_info.xrpow_max) cod_info.xrpow_max = xrpow[j + l];
      }
    }

    return false;
  }
  /**
  * <PRE>
  *  Takehiro Tominaga /date??
  *  Robert Hegemann 2000-09-06: made a function of it
  *
  *  amplifies scalefactor bands,
  *   - if all are already amplified returns 0
  *   - if some bands are amplified too much:
  *      * try to increase scalefac_scale
  *      * if already scalefac_scale was set
  *          try on short blocks to increase subblock gain
  * </PRE>
  */


  function balance_noise(gfp, cod_info, distort, xrpow, bRefine) {
    var gfc = gfp.internal_flags;
    amp_scalefac_bands(gfp, cod_info, distort, xrpow, bRefine);
    /*
    * check to make sure we have not amplified too much loop_break returns
    * 0 if there is an unamplified scalefac scale_bitcount returns 0 if no
    * scalefactors are too large
    */

    var status = loop_break(cod_info);
    if (status) return false;
    /* all bands amplified */

    /*
    * not all scalefactors have been amplified. so these scalefacs are
    * possibly valid. encode them:
    */

    if (gfc.mode_gr == 2) status = tk.scale_bitcount(cod_info);else status = tk.scale_bitcount_lsf(gfc, cod_info);
    if (!status) return true;
    /* amplified some bands not exceeding limits */

    /*
    * some scalefactors are too large. lets try setting scalefac_scale=1
    */

    if (gfc.noise_shaping > 1) {
      $df08f3a0d41b7a78$var$Arrays.fill(gfc.pseudohalf, 0);

      if (0 == cod_info.scalefac_scale) {
        inc_scalefac_scale(cod_info, xrpow);
        status = false;
      } else if (cod_info.block_type == $cPNKB.SHORT_TYPE && gfc.subblock_gain > 0) status = inc_subblock_gain(gfc, cod_info, xrpow) || loop_break(cod_info);
    }

    if (!status) {
      if (gfc.mode_gr == 2) status = tk.scale_bitcount(cod_info);else status = tk.scale_bitcount_lsf(gfc, cod_info);
    }

    return !status;
  }
  /**
  * <PRE>
  *  Function: The outer iteration loop controls the masking conditions
  *  of all scalefactorbands. It computes the best scalefac and
  *  global gain. This module calls the inner iteration loop
  *
  *  mt 5/99 completely rewritten to allow for bit reservoir control,
  *  mid/side channels with L/R or mid/side masking thresholds,
  *  and chooses best quantization instead of last quantization when
  *  no distortion free quantization can be found.
  *
  *  added VBR support mt 5/99
  *
  *  some code shuffle rh 9/00
  * </PRE>
  *
  * @param l3_xmin
  *            allowed distortion
  * @param xrpow
  *            coloured magnitudes of spectral
  * @param targ_bits
  *            maximum allowed bits
  */


  this.outer_loop = function (gfp, cod_info, l3_xmin, xrpow, ch, targ_bits) {
    var gfc = gfp.internal_flags;
    var cod_info_w = new $7weBo();
    var save_xrpow = $df08f3a0d41b7a78$var$new_float(576);
    var distort = $df08f3a0d41b7a78$var$new_float($arIi9.SFBMAX);
    var best_noise_info = new $3afa85f14aff627b$exports();
    var better;
    var prev_noise = new $4fc41bdea3aedc83$exports();
    var best_part2_3_length = 9999999;
    var bEndOfSearch = false;
    var bRefine = false;
    var best_ggain_pass1 = 0;
    bin_search_StepSize(gfc, cod_info, targ_bits, ch, xrpow);
    if (0 == gfc.noise_shaping)
      /* fast mode, no noise shaping, we are ready */
      return 100;
    /* default noise_info.over_count */

    /* compute the distortion in this quantization */

    /* coefficients and thresholds both l/r (or both mid/side) */

    qupvt.calc_noise(cod_info, l3_xmin, distort, best_noise_info, prev_noise);
    best_noise_info.bits = cod_info.part2_3_length;
    cod_info_w.assign(cod_info);
    var age = 0;
    $df08f3a0d41b7a78$var$System.arraycopy(xrpow, 0, save_xrpow, 0, 576);

    while (!bEndOfSearch) {
      /* BEGIN MAIN LOOP */
      do {
        var noise_info = new $3afa85f14aff627b$exports();
        var search_limit;
        var maxggain = 255;
        /*
        * When quantization with no distorted bands is found, allow up
        * to X new unsuccesful tries in serial. This gives us more
        * possibilities for different quant_compare modes. Much more
        * than 3 makes not a big difference, it is only slower.
        */

        if ((gfc.substep_shaping & 2) != 0) search_limit = 20;else search_limit = 3;
        /*
        * Check if the last scalefactor band is distorted. in VBR mode
        * we can't get rid of the distortion, so quit now and VBR mode
        * will try again with more bits. (makes a 10% speed increase,
        * the files I tested were binary identical, 2000/05/20 Robert
        * Hegemann) distort[] > 1 means noise > allowed noise
        */

        if (gfc.sfb21_extra) {
          if (distort[cod_info_w.sfbmax] > 1.0) break;
          if (cod_info_w.block_type == $cPNKB.SHORT_TYPE && (distort[cod_info_w.sfbmax + 1] > 1.0 || distort[cod_info_w.sfbmax + 2] > 1.0)) break;
        }
        /* try a new scalefactor conbination on cod_info_w */


        if (!balance_noise(gfp, cod_info_w, distort, xrpow, bRefine)) break;
        if (cod_info_w.scalefac_scale != 0) maxggain = 254;
        /*
        * inner_loop starts with the initial quantization step computed
        * above and slowly increases until the bits < huff_bits. Thus
        * it is important not to start with too large of an inital
        * quantization step. Too small is ok, but inner_loop will take
        * longer
        */

        var huff_bits = targ_bits - cod_info_w.part2_length;
        if (huff_bits <= 0) break;
        /*
        * increase quantizer stepsize until needed bits are below
        * maximum
        */

        while ((cod_info_w.part2_3_length = tk.count_bits(gfc, xrpow, cod_info_w, prev_noise)) > huff_bits && cod_info_w.global_gain <= maxggain) cod_info_w.global_gain++;

        if (cod_info_w.global_gain > maxggain) break;

        if (best_noise_info.over_count == 0) {
          while ((cod_info_w.part2_3_length = tk.count_bits(gfc, xrpow, cod_info_w, prev_noise)) > best_part2_3_length && cod_info_w.global_gain <= maxggain) cod_info_w.global_gain++;

          if (cod_info_w.global_gain > maxggain) break;
        }
        /* compute the distortion in this quantization */


        qupvt.calc_noise(cod_info_w, l3_xmin, distort, noise_info, prev_noise);
        noise_info.bits = cod_info_w.part2_3_length;
        /*
        * check if this quantization is better than our saved
        * quantization
        */

        if (cod_info.block_type != $cPNKB.SHORT_TYPE) // NORM, START or STOP type
          better = gfp.quant_comp;else better = gfp.quant_comp_short;
        better = quant_compare(better, best_noise_info, noise_info, cod_info_w, distort) ? 1 : 0;
        /* save data so we can restore this quantization later */

        if (better != 0) {
          best_part2_3_length = cod_info.part2_3_length;
          best_noise_info = noise_info;
          cod_info.assign(cod_info_w);
          age = 0;
          /* save data so we can restore this quantization later */

          /* store for later reuse */

          $df08f3a0d41b7a78$var$System.arraycopy(xrpow, 0, save_xrpow, 0, 576);
        } else
          /* early stop? */
          if (gfc.full_outer_loop == 0) {
            if (++age > search_limit && best_noise_info.over_count == 0) break;
            if (gfc.noise_shaping_amp == 3 && bRefine && age > 30) break;
            if (gfc.noise_shaping_amp == 3 && bRefine && cod_info_w.global_gain - best_ggain_pass1 > 15) break;
          }
      } while (cod_info_w.global_gain + cod_info_w.scalefac_scale < 255);

      if (gfc.noise_shaping_amp == 3) {
        if (!bRefine) {
          /* refine search */
          cod_info_w.assign(cod_info);
          $df08f3a0d41b7a78$var$System.arraycopy(save_xrpow, 0, xrpow, 0, 576);
          age = 0;
          best_ggain_pass1 = cod_info_w.global_gain;
          bRefine = true;
        } else
          /* search already refined, stop */
          bEndOfSearch = true;
      } else bEndOfSearch = true;
    }

    $df08f3a0d41b7a78$var$assert(cod_info.global_gain + cod_info.scalefac_scale <= 255);
    /*
    * finish up
    */

    if (gfp.VBR == $df08f3a0d41b7a78$var$VbrMode.vbr_rh || gfp.VBR == $df08f3a0d41b7a78$var$VbrMode.vbr_mtrh)
      /* restore for reuse on next try */
      $df08f3a0d41b7a78$var$System.arraycopy(save_xrpow, 0, xrpow, 0, 576);else if ((gfc.substep_shaping & 1) != 0) trancate_smallspectrums(gfc, cod_info, l3_xmin, xrpow);
    return best_noise_info.over_count;
  };
  /**
  * Robert Hegemann 2000-09-06
  *
  * update reservoir status after FINAL quantization/bitrate
  */


  this.iteration_finish_one = function (gfc, gr, ch) {
    var l3_side = gfc.l3_side;
    var cod_info = l3_side.tt[gr][ch];
    /*
    * try some better scalefac storage
    */

    tk.best_scalefac_store(gfc, gr, ch, l3_side);
    /*
    * best huffman_divide may save some bits too
    */

    if (gfc.use_best_huffman == 1) tk.best_huffman_divide(gfc, cod_info);
    /*
    * update reservoir status after FINAL quantization/bitrate
    */

    rv.ResvAdjust(gfc, cod_info);
  };
  /**
  *
  * 2000-09-04 Robert Hegemann
  *
  * @param l3_xmin
  *            allowed distortion of the scalefactor
  * @param xrpow
  *            coloured magnitudes of spectral values
  */


  this.VBR_encode_granule = function (gfp, cod_info, l3_xmin, xrpow, ch, min_bits, max_bits) {
    var gfc = gfp.internal_flags;
    var bst_cod_info = new $7weBo();
    var bst_xrpow = $df08f3a0d41b7a78$var$new_float(576);
    var Max_bits = max_bits;
    var real_bits = max_bits + 1;
    var this_bits = (max_bits + min_bits) / 2;
    var dbits,
        over,
        found = 0;
    var sfb21_extra = gfc.sfb21_extra;
    $df08f3a0d41b7a78$var$assert(Max_bits <= LameInternalFlags.MAX_BITS_PER_CHANNEL);
    $df08f3a0d41b7a78$var$Arrays.fill(bst_cod_info.l3_enc, 0);
    /*
    * search within round about 40 bits of optimal
    */

    do {
      $df08f3a0d41b7a78$var$assert(this_bits >= min_bits);
      $df08f3a0d41b7a78$var$assert(this_bits <= max_bits);
      $df08f3a0d41b7a78$var$assert(min_bits <= max_bits);
      if (this_bits > Max_bits - 42) gfc.sfb21_extra = false;else gfc.sfb21_extra = sfb21_extra;
      over = outer_loop(gfp, cod_info, l3_xmin, xrpow, ch, this_bits);
      /*
      * is quantization as good as we are looking for ? in this case: is
      * no scalefactor band distorted?
      */

      if (over <= 0) {
        found = 1;
        /*
        * now we know it can be done with "real_bits" and maybe we can
        * skip some iterations
        */

        real_bits = cod_info.part2_3_length;
        /*
        * store best quantization so far
        */

        bst_cod_info.assign(cod_info);
        $df08f3a0d41b7a78$var$System.arraycopy(xrpow, 0, bst_xrpow, 0, 576);
        /*
        * try with fewer bits
        */

        max_bits = real_bits - 32;
        dbits = max_bits - min_bits;
        this_bits = (max_bits + min_bits) / 2;
      } else {
        /*
        * try with more bits
        */
        min_bits = this_bits + 32;
        dbits = max_bits - min_bits;
        this_bits = (max_bits + min_bits) / 2;

        if (found != 0) {
          found = 2;
          /*
          * start again with best quantization so far
          */

          cod_info.assign(bst_cod_info);
          $df08f3a0d41b7a78$var$System.arraycopy(bst_xrpow, 0, xrpow, 0, 576);
        }
      }
    } while (dbits > 12);

    gfc.sfb21_extra = sfb21_extra;
    /*
    * found=0 => nothing found, use last one found=1 => we just found the
    * best and left the loop found=2 => we restored a good one and have now
    * l3_enc to restore too
    */

    if (found == 2) $df08f3a0d41b7a78$var$System.arraycopy(bst_cod_info.l3_enc, 0, cod_info.l3_enc, 0, 576);
    $df08f3a0d41b7a78$var$assert(cod_info.part2_3_length <= Max_bits);
  };
  /**
  * Robert Hegemann 2000-09-05
  *
  * calculates * how many bits are available for analog silent granules * how
  * many bits to use for the lowest allowed bitrate * how many bits each
  * bitrate would provide
  */


  this.get_framebits = function (gfp, frameBits) {
    var gfc = gfp.internal_flags;
    /*
    * always use at least this many bits per granule per channel unless we
    * detect analog silence, see below
    */

    gfc.bitrate_index = gfc.VBR_min_bitrate;
    var bitsPerFrame = bs.getframebits(gfp);
    /*
    * bits for analog silence
    */

    gfc.bitrate_index = 1;
    bitsPerFrame = bs.getframebits(gfp);

    for (var i = 1; i <= gfc.VBR_max_bitrate; i++) {
      gfc.bitrate_index = i;
      var mb = new MeanBits(bitsPerFrame);
      frameBits[i] = rv.ResvFrameBegin(gfp, mb);
      bitsPerFrame = mb.bits;
    }
  };
  /* RH: this one needs to be overhauled sometime */

  /**
  * <PRE>
  *  2000-09-04 Robert Hegemann
  *
  *  * converts LR to MS coding when necessary
  *  * calculates allowed/adjusted quantization noise amounts
  *  * detects analog silent frames
  *
  *  some remarks:
  *  - lower masking depending on Quality setting
  *  - quality control together with adjusted ATH MDCT scaling
  *    on lower quality setting allocate more noise from
  *    ATH masking, and on higher quality setting allocate
  *    less noise from ATH masking.
  *  - experiments show that going more than 2dB over GPSYCHO's
  *    limits ends up in very annoying artefacts
  * </PRE>
  */


  this.VBR_old_prepare = function (gfp, pe, ms_ener_ratio, ratio, l3_xmin, frameBits, min_bits, max_bits, bands) {
    var gfc = gfp.internal_flags;
    var masking_lower_db,
        adjust = 0.0;
    var analog_silence = 1;
    var bits = 0;
    gfc.bitrate_index = gfc.VBR_max_bitrate;
    var avg = rv.ResvFrameBegin(gfp, new MeanBits(0)) / gfc.mode_gr;
    get_framebits(gfp, frameBits);

    for (var gr = 0; gr < gfc.mode_gr; gr++) {
      var mxb = qupvt.on_pe(gfp, pe, max_bits[gr], avg, gr, 0);

      if (gfc.mode_ext == $cPNKB.MPG_MD_MS_LR) {
        ms_convert(gfc.l3_side, gr);
        qupvt.reduce_side(max_bits[gr], ms_ener_ratio[gr], avg, mxb);
      }

      for (var ch = 0; ch < gfc.channels_out; ++ch) {
        var cod_info = gfc.l3_side.tt[gr][ch];

        if (cod_info.block_type != $cPNKB.SHORT_TYPE) {
          // NORM, START or STOP type
          adjust = 1.28 / (1 + Math.exp(3.5 - pe[gr][ch] / 300.)) - 0.05;
          masking_lower_db = gfc.PSY.mask_adjust - adjust;
        } else {
          adjust = 2.56 / (1 + Math.exp(3.5 - pe[gr][ch] / 300.)) - 0.14;
          masking_lower_db = gfc.PSY.mask_adjust_short - adjust;
        }

        gfc.masking_lower = Math.pow(10.0, masking_lower_db * 0.1);
        init_outer_loop(gfc, cod_info);
        bands[gr][ch] = qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info, l3_xmin[gr][ch]);
        if (bands[gr][ch] != 0) analog_silence = 0;
        min_bits[gr][ch] = 126;
        bits += max_bits[gr][ch];
      }
    }

    for (var gr = 0; gr < gfc.mode_gr; gr++) for (var ch = 0; ch < gfc.channels_out; ch++) {
      if (bits > frameBits[gfc.VBR_max_bitrate]) {
        max_bits[gr][ch] *= frameBits[gfc.VBR_max_bitrate];
        max_bits[gr][ch] /= bits;
      }

      if (min_bits[gr][ch] > max_bits[gr][ch]) min_bits[gr][ch] = max_bits[gr][ch];
    }
    /* for gr */


    return analog_silence;
  };

  this.bitpressure_strategy = function (gfc, l3_xmin, min_bits, max_bits) {
    for (var gr = 0; gr < gfc.mode_gr; gr++) for (var ch = 0; ch < gfc.channels_out; ch++) {
      var gi = gfc.l3_side.tt[gr][ch];
      var pxmin = l3_xmin[gr][ch];
      var pxminPos = 0;

      for (var sfb = 0; sfb < gi.psy_lmax; sfb++) pxmin[pxminPos++] *= 1. + .029 * sfb * sfb / $cPNKB.SBMAX_l / $cPNKB.SBMAX_l;

      if (gi.block_type == $cPNKB.SHORT_TYPE) for (var sfb = gi.sfb_smin; sfb < $cPNKB.SBMAX_s; sfb++) {
        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb / $cPNKB.SBMAX_s / $cPNKB.SBMAX_s;
        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb / $cPNKB.SBMAX_s / $cPNKB.SBMAX_s;
        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb / $cPNKB.SBMAX_s / $cPNKB.SBMAX_s;
      }
      max_bits[gr][ch] = 0 | Math.max(min_bits[gr][ch], 0.9 * max_bits[gr][ch]);
    }
  };

  this.VBR_new_prepare = function (gfp, pe, ratio, l3_xmin, frameBits, max_bits) {
    var gfc = gfp.internal_flags;
    var analog_silence = 1;
    var avg = 0,
        bits = 0;
    var maximum_framebits;

    if (!gfp.free_format) {
      gfc.bitrate_index = gfc.VBR_max_bitrate;
      var mb = new MeanBits(avg);
      rv.ResvFrameBegin(gfp, mb);
      avg = mb.bits;
      get_framebits(gfp, frameBits);
      maximum_framebits = frameBits[gfc.VBR_max_bitrate];
    } else {
      gfc.bitrate_index = 0;
      var mb = new MeanBits(avg);
      maximum_framebits = rv.ResvFrameBegin(gfp, mb);
      avg = mb.bits;
      frameBits[0] = maximum_framebits;
    }

    for (var gr = 0; gr < gfc.mode_gr; gr++) {
      qupvt.on_pe(gfp, pe, max_bits[gr], avg, gr, 0);
      if (gfc.mode_ext == $cPNKB.MPG_MD_MS_LR) ms_convert(gfc.l3_side, gr);

      for (var ch = 0; ch < gfc.channels_out; ++ch) {
        var cod_info = gfc.l3_side.tt[gr][ch];
        gfc.masking_lower = Math.pow(10.0, gfc.PSY.mask_adjust * 0.1);
        init_outer_loop(gfc, cod_info);
        if (0 != qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info, l3_xmin[gr][ch])) analog_silence = 0;
        bits += max_bits[gr][ch];
      }
    }

    for (var gr = 0; gr < gfc.mode_gr; gr++) {
      for (var ch = 0; ch < gfc.channels_out; ch++) if (bits > maximum_framebits) {
        max_bits[gr][ch] *= maximum_framebits;
        max_bits[gr][ch] /= bits;
      }
      /* for ch */

    }
    /* for gr */


    return analog_silence;
  };
  /**
  * calculates target bits for ABR encoding
  *
  * mt 2000/05/31
  */


  this.calc_target_bits = function (gfp, pe, ms_ener_ratio, targ_bits, analog_silence_bits, max_frame_bits) {
    var gfc = gfp.internal_flags;
    var l3_side = gfc.l3_side;
    var res_factor;
    var gr,
        ch,
        totbits,
        mean_bits = 0;
    gfc.bitrate_index = gfc.VBR_max_bitrate;
    var mb = new MeanBits(mean_bits);
    max_frame_bits[0] = rv.ResvFrameBegin(gfp, mb);
    mean_bits = mb.bits;
    gfc.bitrate_index = 1;
    mean_bits = bs.getframebits(gfp) - gfc.sideinfo_len * 8;
    analog_silence_bits[0] = mean_bits / (gfc.mode_gr * gfc.channels_out);
    mean_bits = gfp.VBR_mean_bitrate_kbps * gfp.framesize * 1000;
    if ((gfc.substep_shaping & 1) != 0) mean_bits *= 1.09;
    mean_bits /= gfp.out_samplerate;
    mean_bits -= gfc.sideinfo_len * 8;
    mean_bits /= gfc.mode_gr * gfc.channels_out;
    /**
    * <PRE>
    *           res_factor is the percentage of the target bitrate that should
    *           be used on average.  the remaining bits are added to the
    *           bitreservoir and used for difficult to encode frames.
    *
    *           Since we are tracking the average bitrate, we should adjust
    *           res_factor "on the fly", increasing it if the average bitrate
    *           is greater than the requested bitrate, and decreasing it
    *           otherwise.  Reasonable ranges are from .9 to 1.0
    *
    *           Until we get the above suggestion working, we use the following
    *           tuning:
    *           compression ratio    res_factor
    *           5.5  (256kbps)         1.0      no need for bitreservoir
    *           11   (128kbps)         .93      7% held for reservoir
    *
    *           with linear interpolation for other values.
    * </PRE>
    */

    res_factor = .93 + .07 * (11.0 - gfp.compression_ratio) / 5.5;
    if (res_factor < .90) res_factor = .90;
    if (res_factor > 1.00) res_factor = 1.00;

    for (gr = 0; gr < gfc.mode_gr; gr++) {
      var sum = 0;

      for (ch = 0; ch < gfc.channels_out; ch++) {
        targ_bits[gr][ch] = int(res_factor * mean_bits);

        if (pe[gr][ch] > 700) {
          var add_bits = int((pe[gr][ch] - 700) / 1.4);
          var cod_info = l3_side.tt[gr][ch];
          targ_bits[gr][ch] = int(res_factor * mean_bits);
          /* short blocks use a little extra, no matter what the pe */

          if (cod_info.block_type == $cPNKB.SHORT_TYPE) {
            if (add_bits < mean_bits / 2) add_bits = mean_bits / 2;
          }
          /* at most increase bits by 1.5*average */


          if (add_bits > mean_bits * 3 / 2) add_bits = mean_bits * 3 / 2;else if (add_bits < 0) add_bits = 0;
          targ_bits[gr][ch] += add_bits;
        }

        if (targ_bits[gr][ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL) targ_bits[gr][ch] = LameInternalFlags.MAX_BITS_PER_CHANNEL;
        sum += targ_bits[gr][ch];
      }
      /* for ch */


      if (sum > LameInternalFlags.MAX_BITS_PER_GRANULE) for (ch = 0; ch < gfc.channels_out; ++ch) {
        targ_bits[gr][ch] *= LameInternalFlags.MAX_BITS_PER_GRANULE;
        targ_bits[gr][ch] /= sum;
      }
    }
    /* for gr */


    if (gfc.mode_ext == $cPNKB.MPG_MD_MS_LR) for (gr = 0; gr < gfc.mode_gr; gr++) qupvt.reduce_side(targ_bits[gr], ms_ener_ratio[gr], mean_bits * gfc.channels_out, LameInternalFlags.MAX_BITS_PER_GRANULE);
    /*
    * sum target bits
    */

    totbits = 0;

    for (gr = 0; gr < gfc.mode_gr; gr++) for (ch = 0; ch < gfc.channels_out; ch++) {
      if (targ_bits[gr][ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL) targ_bits[gr][ch] = LameInternalFlags.MAX_BITS_PER_CHANNEL;
      totbits += targ_bits[gr][ch];
    }
    /*
    * repartion target bits if needed
    */


    if (totbits > max_frame_bits[0]) {
      for (gr = 0; gr < gfc.mode_gr; gr++) for (ch = 0; ch < gfc.channels_out; ch++) {
        targ_bits[gr][ch] *= max_frame_bits[0];
        targ_bits[gr][ch] /= totbits;
      }
    }
  };
}

$df08f3a0d41b7a78$exports = $df08f3a0d41b7a78$var$Quantize;
var $65Sx2 = parcelRequire("65Sx2");
var $b5a7ab7c590f5d1e$exports = {};
/*
*      bit reservoir source file
*
*      Copyright (c) 1999-2000 Mark Taylor
*
* This library is free software; you can redistribute it and/or
* modify it under the terms of the GNU Lesser General Public
* License as published by the Free Software Foundation; either
* version 2 of the License, or (at your option) any later version.
*
* This library is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
* Library General Public License for more details.
*
* You should have received a copy of the GNU Lesser General Public
* License along with this library; if not, write to the
* Free Software Foundation, Inc., 59 Temple Place - Suite 330,
* Boston, MA 02111-1307, USA.
*/

/* $Id: Reservoir.java,v 1.9 2011/05/24 20:48:06 kenchis Exp $ */
//package mp3;

/**
 * ResvFrameBegin:<BR>
 * Called (repeatedly) at the beginning of a frame. Updates the maximum size of
 * the reservoir, and checks to make sure main_data_begin was set properly by
 * the formatter<BR>
 * Background information:
 * 
 * This is the original text from the ISO standard. Because of sooo many bugs
 * and irritations correcting comments are added in brackets []. A '^W' means
 * you should remove the last word.
 * 
 * <PRE>
 *  1. The following rule can be used to calculate the maximum
 *     number of bits used for one granule [^W frame]:<BR>
 *     At the highest possible bitrate of Layer III (320 kbps
 *     per stereo signal [^W^W^W], 48 kHz) the frames must be of
 *     [^W^W^W are designed to have] constant length, i.e.
 *     one buffer [^W^W the frame] length is:<BR>
 * 
 *         320 kbps * 1152/48 kHz = 7680 bit = 960 byte
 * 
 *     This value is used as the maximum buffer per channel [^W^W] at
 *     lower bitrates [than 320 kbps]. At 64 kbps mono or 128 kbps
 *     stereo the main granule length is 64 kbps * 576/48 kHz = 768 bit
 *     [per granule and channel] at 48 kHz sampling frequency.
 *     This means that there is a maximum deviation (short time buffer
 *     [= reservoir]) of 7680 - 2*2*768 = 4608 bits is allowed at 64 kbps.
 *     The actual deviation is equal to the number of bytes [with the
 *     meaning of octets] denoted by the main_data_end offset pointer.
 *     The actual maximum deviation is (2^9-1)*8 bit = 4088 bits
 *     [for MPEG-1 and (2^8-1)*8 bit for MPEG-2, both are hard limits].
 *     ... The xchange of buffer bits between the left and right channel
 *     is allowed without restrictions [exception: dual channel].
 *     Because of the [constructed] constraint on the buffer size
 *     main_data_end is always set to 0 in the case of bit_rate_index==14,
 *     i.e. data rate 320 kbps per stereo signal [^W^W^W]. In this case
 *     all data are allocated between adjacent header [^W sync] words
 *     [, i.e. there is no buffering at all].
 * </PRE>
 */

var $3YDN3 = parcelRequire("3YDN3");
var $b5a7ab7c590f5d1e$var$assert = $3YDN3.assert;

function $b5a7ab7c590f5d1e$var$Reservoir() {
  var bs;

  this.setModules = function (_bs) {
    bs = _bs;
  };

  this.ResvFrameBegin = function (gfp, mean_bits) {
    var gfc = gfp.internal_flags;
    var maxmp3buf;
    var l3_side = gfc.l3_side;
    var frameLength = bs.getframebits(gfp);
    mean_bits.bits = (frameLength - gfc.sideinfo_len * 8) / gfc.mode_gr;
    /**
    * <PRE>
    *  Meaning of the variables:
    *      resvLimit: (0, 8, ..., 8*255 (MPEG-2), 8*511 (MPEG-1))
    *          Number of bits can be stored in previous frame(s) due to
    *          counter size constaints
    *      maxmp3buf: ( ??? ... 8*1951 (MPEG-1 and 2), 8*2047 (MPEG-2.5))
    *          Number of bits allowed to encode one frame (you can take 8*511 bit
    *          from the bit reservoir and at most 8*1440 bit from the current
    *          frame (320 kbps, 32 kHz), so 8*1951 bit is the largest possible
    *          value for MPEG-1 and -2)
    * 
    *          maximum allowed granule/channel size times 4 = 8*2047 bits.,
    *          so this is the absolute maximum supported by the format.
    * 
    * 
    *      fullFrameBits:  maximum number of bits available for encoding
    *                      the current frame.
    * 
    *      mean_bits:      target number of bits per granule.
    * 
    *      frameLength:
    * 
    *      gfc.ResvMax:   maximum allowed reservoir
    * 
    *      gfc.ResvSize:  current reservoir size
    * 
    *      l3_side.resvDrain_pre:
    *         ancillary data to be added to previous frame:
    *         (only usefull in VBR modes if it is possible to have
    *         maxmp3buf < fullFrameBits)).  Currently disabled,
    *         see #define NEW_DRAIN
    *         2010-02-13: RH now enabled, it seems to be needed for CBR too,
    *                     as there exists one example, where the FhG decoder
    *                     can't decode a -b320 CBR file anymore.
    * 
    *      l3_side.resvDrain_post:
    *         ancillary data to be added to this frame:
    * 
    * </PRE>
    */

    /* main_data_begin has 9 bits in MPEG-1, 8 bits MPEG-2 */

    var resvLimit = 2048 * gfc.mode_gr - 8;
    /*
    * maximum allowed frame size. dont use more than this number of bits,
    * even if the frame has the space for them:
    */

    if (gfp.brate > 320)
      /* in freeformat the buffer is constant */
      maxmp3buf = 8 * int(gfp.brate * 1000 / (gfp.out_samplerate / 1152) / 8 + .5);else {
      /*
      * all mp3 decoders should have enough buffer to handle this value:
      * size of a 320kbps 32kHz frame
      */
      maxmp3buf = 11520;
      /*
      * Bouvigne suggests this more lax interpretation of the ISO doc
      * instead of using 8*960.
      */

      if (gfp.strict_ISO) maxmp3buf = 8 * int(320000 / (gfp.out_samplerate / 1152) / 8 + .5);
    }
    gfc.ResvMax = maxmp3buf - frameLength;
    if (gfc.ResvMax > resvLimit) gfc.ResvMax = resvLimit;
    if (gfc.ResvMax < 0 || gfp.disable_reservoir) gfc.ResvMax = 0;
    var fullFrameBits = mean_bits.bits * gfc.mode_gr + Math.min(gfc.ResvSize, gfc.ResvMax);
    if (fullFrameBits > maxmp3buf) fullFrameBits = maxmp3buf;
    $b5a7ab7c590f5d1e$var$assert(0 == gfc.ResvMax % 8);
    $b5a7ab7c590f5d1e$var$assert(gfc.ResvMax >= 0);
    l3_side.resvDrain_pre = 0; // frame analyzer code

    if (gfc.pinfo != null) {
      /*
      * expected bits per channel per granule [is this also right for
      * mono/stereo, MPEG-1/2 ?]
      */
      gfc.pinfo.mean_bits = mean_bits.bits / 2;
      gfc.pinfo.resvsize = gfc.ResvSize;
    }

    return fullFrameBits;
  };
  /**
  * returns targ_bits: target number of bits to use for 1 granule<BR>
  * extra_bits: amount extra available from reservoir<BR>
  * Mark Taylor 4/99
  */


  this.ResvMaxBits = function (gfp, mean_bits, targ_bits, cbr) {
    var gfc = gfp.internal_flags;
    var add_bits;
    var ResvSize = gfc.ResvSize,
        ResvMax = gfc.ResvMax;
    /* compensate the saved bits used in the 1st granule */

    if (cbr != 0) ResvSize += mean_bits;
    if ((gfc.substep_shaping & 1) != 0) ResvMax *= 0.9;
    targ_bits.bits = mean_bits;
    /* extra bits if the reservoir is almost full */

    if (ResvSize * 10 > ResvMax * 9) {
      add_bits = ResvSize - ResvMax * 9 / 10;
      targ_bits.bits += add_bits;
      gfc.substep_shaping |= 0x80;
    } else {
      add_bits = 0;
      gfc.substep_shaping &= 0x7f;
      /*
      * build up reservoir. this builds the reservoir a little slower
      * than FhG. It could simple be mean_bits/15, but this was rigged to
      * always produce 100 (the old value) at 128kbs
      */

      if (!gfp.disable_reservoir && 0 == (gfc.substep_shaping & 1)) targ_bits.bits -= .1 * mean_bits;
    }
    /* amount from the reservoir we are allowed to use. ISO says 6/10 */


    var extra_bits = ResvSize < gfc.ResvMax * 6 / 10 ? ResvSize : gfc.ResvMax * 6 / 10;
    extra_bits -= add_bits;
    if (extra_bits < 0) extra_bits = 0;
    return extra_bits;
  };
  /**
  * Called after a granule's bit allocation. Readjusts the size of the
  * reservoir to reflect the granule's usage.
  */


  this.ResvAdjust = function (gfc, gi) {
    gfc.ResvSize -= gi.part2_3_length + gi.part2_length;
  };
  /**
  * Called after all granules in a frame have been allocated. Makes sure that
  * the reservoir size is within limits, possibly by adding stuffing bits.
  */


  this.ResvFrameEnd = function (gfc, mean_bits) {
    var over_bits;
    var l3_side = gfc.l3_side;
    gfc.ResvSize += mean_bits * gfc.mode_gr;
    var stuffingBits = 0;
    l3_side.resvDrain_post = 0;
    l3_side.resvDrain_pre = 0;
    /* we must be byte aligned */

    if ((over_bits = gfc.ResvSize % 8) != 0) stuffingBits += over_bits;
    over_bits = gfc.ResvSize - stuffingBits - gfc.ResvMax;

    if (over_bits > 0) {
      $b5a7ab7c590f5d1e$var$assert(0 == over_bits % 8);
      $b5a7ab7c590f5d1e$var$assert(over_bits >= 0);
      stuffingBits += over_bits;
    }

    var mdb_bytes = Math.min(l3_side.main_data_begin * 8, stuffingBits) / 8;
    l3_side.resvDrain_pre += 8 * mdb_bytes;
    stuffingBits -= 8 * mdb_bytes;
    gfc.ResvSize -= 8 * mdb_bytes;
    l3_side.main_data_begin -= mdb_bytes;
    /* drain the rest into this frames ancillary data */

    l3_side.resvDrain_post += stuffingBits;
    gfc.ResvSize -= stuffingBits;
  };
}

$b5a7ab7c590f5d1e$exports = $b5a7ab7c590f5d1e$var$Reservoir;
var $jL6I1 = parcelRequire("jL6I1");
var $ctaQC = parcelRequire("ctaQC");
parcelRequire("cPNKB");
var $34609aeb1df0c2af$exports = {};

function $34609aeb1df0c2af$var$Version() {
  /**
  * URL for the LAME website.
  */
  var LAME_URL = "http://www.mp3dev.org/";
  /**
  * Major version number.
  */

  var LAME_MAJOR_VERSION = 3;
  /**
  * Minor version number.
  */

  var LAME_MINOR_VERSION = 98;
  /**
  * Patch level.
  */

  var LAME_PATCH_VERSION = 4;
  /**
  * Major version number.
  */

  var PSY_MAJOR_VERSION = 0;
  /**
  * Minor version number.
  */

  var PSY_MINOR_VERSION = 93;
  /**
  * A string which describes the version of LAME.
  *
  * @return string which describes the version of LAME
  */

  this.getLameVersion = function () {
    // primary to write screen reports
    return LAME_MAJOR_VERSION + "." + LAME_MINOR_VERSION + "." + LAME_PATCH_VERSION;
  };
  /**
  * The short version of the LAME version string.
  *
  * @return short version of the LAME version string
  */


  this.getLameShortVersion = function () {
    // Adding date and time to version string makes it harder for output
    // validation
    return LAME_MAJOR_VERSION + "." + LAME_MINOR_VERSION + "." + LAME_PATCH_VERSION;
  };
  /**
  * The shortest version of the LAME version string.
  *
  * @return shortest version of the LAME version string
  */


  this.getLameVeryShortVersion = function () {
    // Adding date and time to version string makes it harder for output
    return "LAME" + LAME_MAJOR_VERSION + "." + LAME_MINOR_VERSION + "r";
  };
  /**
  * String which describes the version of GPSYCHO
  *
  * @return string which describes the version of GPSYCHO
  */


  this.getPsyVersion = function () {
    return PSY_MAJOR_VERSION + "." + PSY_MINOR_VERSION;
  };
  /**
  * String which is a URL for the LAME website.
  *
  * @return string which is a URL for the LAME website
  */


  this.getLameUrl = function () {
    return LAME_URL;
  };
  /**
  * Quite useless for a java version, however we are compatible ;-)
  *
  * @return "32bits"
  */


  this.getLameOsBitness = function () {
    return "32bits";
  };
}

$34609aeb1df0c2af$exports = $34609aeb1df0c2af$var$Version;
var $e674985ea62d27cf$exports = {};
var $3YDN3 = parcelRequire("3YDN3");
var $e674985ea62d27cf$var$System = $3YDN3.System;
var $e674985ea62d27cf$var$VbrMode = $3YDN3.VbrMode;
$3YDN3.Float;
var $e674985ea62d27cf$var$ShortBlock = $3YDN3.ShortBlock;
$3YDN3.Util;
var $e674985ea62d27cf$var$Arrays = $3YDN3.Arrays;
$3YDN3.new_array_n;
var $e674985ea62d27cf$var$new_byte = $3YDN3.new_byte;
$3YDN3.new_double;
$3YDN3.new_float;
$3YDN3.new_float_n;
$3YDN3.new_int;
$3YDN3.new_int_n;
var $e674985ea62d27cf$var$assert = $3YDN3.assert;
/**
* A Vbr header may be present in the ancillary data field of the first frame of
* an mp3 bitstream<BR>
* The Vbr header (optionally) contains
* <UL>
* <LI>frames total number of audio frames in the bitstream
* <LI>bytes total number of bytes in the bitstream
* <LI>toc table of contents
* </UL>
*
* toc (table of contents) gives seek points for random access.<BR>
* The ith entry determines the seek point for i-percent duration.<BR>
* seek point in bytes = (toc[i]/256.0) * total_bitstream_bytes<BR>
* e.g. half duration seek point = (toc[50]/256.0) * total_bitstream_bytes
*/

$e674985ea62d27cf$var$VBRTag.NUMTOCENTRIES = 100;
$e674985ea62d27cf$var$VBRTag.MAXFRAMESIZE = 2880;

function $e674985ea62d27cf$var$VBRTag() {
  var lame;
  var bs;
  var v;

  this.setModules = function (_lame, _bs, _v) {
    lame = _lame;
    bs = _bs;
    v = _v;
  };

  var FRAMES_FLAG = 0x0001;
  var BYTES_FLAG = 0x0002;
  var TOC_FLAG = 0x0004;
  var VBR_SCALE_FLAG = 0x0008;
  var NUMTOCENTRIES = $e674985ea62d27cf$var$VBRTag.NUMTOCENTRIES;
  /**
  * (0xB40) the max freeformat 640 32kHz framesize.
  */

  var MAXFRAMESIZE = $e674985ea62d27cf$var$VBRTag.MAXFRAMESIZE;
  /**
  * <PRE>
  *    4 bytes for Header Tag
  *    4 bytes for Header Flags
  *  100 bytes for entry (toc)
  *    4 bytes for frame size
  *    4 bytes for stream size
  *    4 bytes for VBR scale. a VBR quality indicator: 0=best 100=worst
  *   20 bytes for LAME tag.  for example, "LAME3.12 (beta 6)"
  * ___________
  *  140 bytes
  * </PRE>
  */

  var VBRHEADERSIZE = NUMTOCENTRIES + 4 + 4 + 4 + 4 + 4;
  var LAMEHEADERSIZE = VBRHEADERSIZE + 9 + 1 + 1 + 8 + 1 + 1 + 3 + 1 + 1 + 2 + 4 + 2 + 2;
  /**
  * The size of the Xing header MPEG-1, bit rate in kbps.
  */

  var XING_BITRATE1 = 128;
  /**
  * The size of the Xing header MPEG-2, bit rate in kbps.
  */

  var XING_BITRATE2 = 64;
  /**
  * The size of the Xing header MPEG-2.5, bit rate in kbps.
  */

  var XING_BITRATE25 = 32;
  /**
  * ISO-8859-1 charset for byte to string operations.
  */

  var ISO_8859_1 = null; //Charset.forName("ISO-8859-1");

  /**
       * VBR header magic string.
       */

  var VBRTag0 = "Xing";
  /**
  * VBR header magic string (VBR == VBRMode.vbr_off).
  */

  var VBRTag1 = "Info";
  /**
  * Lookup table for fast CRC-16 computation. Uses the polynomial
  * x^16+x^15+x^2+1
  */

  var crc16Lookup = [0x0000, 0xC0C1, 0xC181, 0x0140, 0xC301, 0x03C0, 0x0280, 0xC241, 0xC601, 0x06C0, 0x0780, 0xC741, 0x0500, 0xC5C1, 0xC481, 0x0440, 0xCC01, 0x0CC0, 0x0D80, 0xCD41, 0x0F00, 0xCFC1, 0xCE81, 0x0E40, 0x0A00, 0xCAC1, 0xCB81, 0x0B40, 0xC901, 0x09C0, 0x0880, 0xC841, 0xD801, 0x18C0, 0x1980, 0xD941, 0x1B00, 0xDBC1, 0xDA81, 0x1A40, 0x1E00, 0xDEC1, 0xDF81, 0x1F40, 0xDD01, 0x1DC0, 0x1C80, 0xDC41, 0x1400, 0xD4C1, 0xD581, 0x1540, 0xD701, 0x17C0, 0x1680, 0xD641, 0xD201, 0x12C0, 0x1380, 0xD341, 0x1100, 0xD1C1, 0xD081, 0x1040, 0xF001, 0x30C0, 0x3180, 0xF141, 0x3300, 0xF3C1, 0xF281, 0x3240, 0x3600, 0xF6C1, 0xF781, 0x3740, 0xF501, 0x35C0, 0x3480, 0xF441, 0x3C00, 0xFCC1, 0xFD81, 0x3D40, 0xFF01, 0x3FC0, 0x3E80, 0xFE41, 0xFA01, 0x3AC0, 0x3B80, 0xFB41, 0x3900, 0xF9C1, 0xF881, 0x3840, 0x2800, 0xE8C1, 0xE981, 0x2940, 0xEB01, 0x2BC0, 0x2A80, 0xEA41, 0xEE01, 0x2EC0, 0x2F80, 0xEF41, 0x2D00, 0xEDC1, 0xEC81, 0x2C40, 0xE401, 0x24C0, 0x2580, 0xE541, 0x2700, 0xE7C1, 0xE681, 0x2640, 0x2200, 0xE2C1, 0xE381, 0x2340, 0xE101, 0x21C0, 0x2080, 0xE041, 0xA001, 0x60C0, 0x6180, 0xA141, 0x6300, 0xA3C1, 0xA281, 0x6240, 0x6600, 0xA6C1, 0xA781, 0x6740, 0xA501, 0x65C0, 0x6480, 0xA441, 0x6C00, 0xACC1, 0xAD81, 0x6D40, 0xAF01, 0x6FC0, 0x6E80, 0xAE41, 0xAA01, 0x6AC0, 0x6B80, 0xAB41, 0x6900, 0xA9C1, 0xA881, 0x6840, 0x7800, 0xB8C1, 0xB981, 0x7940, 0xBB01, 0x7BC0, 0x7A80, 0xBA41, 0xBE01, 0x7EC0, 0x7F80, 0xBF41, 0x7D00, 0xBDC1, 0xBC81, 0x7C40, 0xB401, 0x74C0, 0x7580, 0xB541, 0x7700, 0xB7C1, 0xB681, 0x7640, 0x7200, 0xB2C1, 0xB381, 0x7340, 0xB101, 0x71C0, 0x7080, 0xB041, 0x5000, 0x90C1, 0x9181, 0x5140, 0x9301, 0x53C0, 0x5280, 0x9241, 0x9601, 0x56C0, 0x5780, 0x9741, 0x5500, 0x95C1, 0x9481, 0x5440, 0x9C01, 0x5CC0, 0x5D80, 0x9D41, 0x5F00, 0x9FC1, 0x9E81, 0x5E40, 0x5A00, 0x9AC1, 0x9B81, 0x5B40, 0x9901, 0x59C0, 0x5880, 0x9841, 0x8801, 0x48C0, 0x4980, 0x8941, 0x4B00, 0x8BC1, 0x8A81, 0x4A40, 0x4E00, 0x8EC1, 0x8F81, 0x4F40, 0x8D01, 0x4DC0, 0x4C80, 0x8C41, 0x4400, 0x84C1, 0x8581, 0x4540, 0x8701, 0x47C0, 0x4680, 0x8641, 0x8201, 0x42C0, 0x4380, 0x8341, 0x4100, 0x81C1, 0x8081, 0x4040];
  /***********************************************************************
  * Robert Hegemann 2001-01-17
  ***********************************************************************/

  function addVbr(v, bitrate) {
    v.nVbrNumFrames++;
    v.sum += bitrate;
    v.seen++;
    if (v.seen < v.want) return;

    if (v.pos < v.size) {
      v.bag[v.pos] = v.sum;
      v.pos++;
      v.seen = 0;
    }

    if (v.pos == v.size) {
      for (var i = 1; i < v.size; i += 2) v.bag[i / 2] = v.bag[i];

      v.want *= 2;
      v.pos /= 2;
    }
  }

  function xingSeekTable(v, t) {
    if (v.pos <= 0) return;

    for (var i = 1; i < NUMTOCENTRIES; ++i) {
      var j = i / NUMTOCENTRIES,
          act,
          sum;
      var indx = 0 | Math.floor(j * v.pos);
      if (indx > v.pos - 1) indx = v.pos - 1;
      act = v.bag[indx];
      sum = v.sum;
      var seek_point = 0 | 256. * act / sum;
      if (seek_point > 255) seek_point = 255;
      t[i] = 0xff & seek_point;
    }
  }
  /**
  * Add VBR entry, used to fill the VBR TOC entries.
  *
  * @param gfp
  *            global flags
  */


  this.addVbrFrame = function (gfp) {
    var gfc = gfp.internal_flags;
    var kbps = Tables.bitrate_table[gfp.version][gfc.bitrate_index];
    $e674985ea62d27cf$var$assert(gfc.VBR_seek_table.bag != null);
    addVbr(gfc.VBR_seek_table, kbps);
  };
  /**
  * Read big endian integer (4-bytes) from header.
  *
  * @param buf
  *            header containing the integer
  * @param bufPos
  *            offset into the header
  * @return extracted integer
  */


  function extractInteger(buf, bufPos) {
    var x = buf[bufPos + 0] & 0xff;
    x <<= 8;
    x |= buf[bufPos + 1] & 0xff;
    x <<= 8;
    x |= buf[bufPos + 2] & 0xff;
    x <<= 8;
    x |= buf[bufPos + 3] & 0xff;
    return x;
  }
  /**
  * Write big endian integer (4-bytes) in the header.
  *
  * @param buf
  *            header to write the integer into
  * @param bufPos
  *            offset into the header
  * @param value
  *            integer value to write
  */


  function createInteger(buf, bufPos, value) {
    buf[bufPos + 0] = 0xff & (value >> 24 & 0xff);
    buf[bufPos + 1] = 0xff & (value >> 16 & 0xff);
    buf[bufPos + 2] = 0xff & (value >> 8 & 0xff);
    buf[bufPos + 3] = 0xff & (value & 0xff);
  }
  /**
  * Write big endian short (2-bytes) in the header.
  *
  * @param buf
  *            header to write the integer into
  * @param bufPos
  *            offset into the header
  * @param value
  *            integer value to write
  */


  function createShort(buf, bufPos, value) {
    buf[bufPos + 0] = 0xff & (value >> 8 & 0xff);
    buf[bufPos + 1] = 0xff & (value & 0xff);
  }
  /**
  * Check for magic strings (Xing/Info).
  *
  * @param buf
  *            header to check
  * @param bufPos
  *            header offset to check
  * @return magic string found
  */


  function isVbrTag(buf, bufPos) {
    return new String(buf, bufPos, VBRTag0.length(), ISO_8859_1).equals(VBRTag0) || new String(buf, bufPos, VBRTag1.length(), ISO_8859_1).equals(VBRTag1);
  }

  function shiftInBitsValue(x, n, v) {
    return 0xff & (x << n | v & ~(-1 << n));
  }
  /**
  * Construct the MP3 header using the settings of the global flags.
  *
  * <img src="1000px-Mp3filestructure.svg.png">
  *
  * @param gfp
  *            global flags
  * @param buffer
  *            header
  */


  function setLameTagFrameHeader(gfp, buffer) {
    var gfc = gfp.internal_flags; // MP3 Sync Word

    buffer[0] = shiftInBitsValue(buffer[0], 8, 0xff);
    buffer[1] = shiftInBitsValue(buffer[1], 3, 7);
    buffer[1] = shiftInBitsValue(buffer[1], 1, gfp.out_samplerate < 16000 ? 0 : 1); // Version

    buffer[1] = shiftInBitsValue(buffer[1], 1, gfp.version); // 01 == Layer 3

    buffer[1] = shiftInBitsValue(buffer[1], 2, 1); // Error protection

    buffer[1] = shiftInBitsValue(buffer[1], 1, !gfp.error_protection ? 1 : 0); // Bit rate

    buffer[2] = shiftInBitsValue(buffer[2], 4, gfc.bitrate_index); // Frequency

    buffer[2] = shiftInBitsValue(buffer[2], 2, gfc.samplerate_index); // Pad. Bit

    buffer[2] = shiftInBitsValue(buffer[2], 1, 0); // Priv. Bit

    buffer[2] = shiftInBitsValue(buffer[2], 1, gfp.extension); // Mode

    buffer[3] = shiftInBitsValue(buffer[3], 2, gfp.mode.ordinal()); // Mode extension (Used with Joint Stereo)

    buffer[3] = shiftInBitsValue(buffer[3], 2, gfc.mode_ext); // Copy

    buffer[3] = shiftInBitsValue(buffer[3], 1, gfp.copyright); // Original

    buffer[3] = shiftInBitsValue(buffer[3], 1, gfp.original); // Emphasis

    buffer[3] = shiftInBitsValue(buffer[3], 2, gfp.emphasis);
    /* the default VBR header. 48 kbps layer III, no padding, no crc */

    /* but sampling freq, mode and copyright/copy protection taken */

    /* from first valid frame */

    buffer[0] = 0xff;
    var abyte = 0xff & (buffer[1] & 0xf1);
    var bitrate;
    if (1 == gfp.version) bitrate = XING_BITRATE1;else if (gfp.out_samplerate < 16000) bitrate = XING_BITRATE25;else bitrate = XING_BITRATE2;
    if (gfp.VBR == $e674985ea62d27cf$var$VbrMode.vbr_off) bitrate = gfp.brate;
    var bbyte;
    if (gfp.free_format) bbyte = 0x00;else bbyte = 0xff & 16 * lame.BitrateIndex(bitrate, gfp.version, gfp.out_samplerate);
    /*
    * Use as much of the info from the real frames in the Xing header:
    * samplerate, channels, crc, etc...
    */

    if (gfp.version == 1) {
      /* MPEG1 */
      buffer[1] = 0xff & (abyte | 0x0a);
      /* was 0x0b; */

      abyte = 0xff & (buffer[2] & 0x0d);
      /* AF keep also private bit */

      buffer[2] = 0xff & (bbyte | abyte);
      /* 64kbs MPEG1 frame */
    } else {
      /* MPEG2 */
      buffer[1] = 0xff & (abyte | 0x02);
      /* was 0x03; */

      abyte = 0xff & (buffer[2] & 0x0d);
      /* AF keep also private bit */

      buffer[2] = 0xff & (bbyte | abyte);
      /* 64kbs MPEG2 frame */
    }
  }
  /**
  * Get VBR tag information
  *
  * @param buf
  *            header to analyze
  * @param bufPos
  *            offset into the header
  * @return VBR tag data
  */


  this.getVbrTag = function (buf) {
    var pTagData = new VBRTagData();
    var bufPos = 0;
    /* get Vbr header data */

    pTagData.flags = 0;
    /* get selected MPEG header data */

    var hId = buf[bufPos + 1] >> 3 & 1;
    var hSrIndex = buf[bufPos + 2] >> 2 & 3;
    var hMode = buf[bufPos + 3] >> 6 & 3;
    var hBitrate = buf[bufPos + 2] >> 4 & 0xf;
    hBitrate = Tables.bitrate_table[hId][hBitrate];
    /* check for FFE syncword */

    if (buf[bufPos + 1] >> 4 == 0xE) pTagData.samprate = Tables.samplerate_table[2][hSrIndex];else pTagData.samprate = Tables.samplerate_table[hId][hSrIndex];
    /* determine offset of header */

    if (hId != 0) {
      /* mpeg1 */
      if (hMode != 3) bufPos += 36;else bufPos += 21;
    } else
      /* mpeg2 */
      if (hMode != 3) bufPos += 21;else bufPos += 13;

    if (!isVbrTag(buf, bufPos)) return null;
    bufPos += 4;
    pTagData.hId = hId;
    /* get flags */

    var head_flags = pTagData.flags = extractInteger(buf, bufPos);
    bufPos += 4;

    if ((head_flags & FRAMES_FLAG) != 0) {
      pTagData.frames = extractInteger(buf, bufPos);
      bufPos += 4;
    }

    if ((head_flags & BYTES_FLAG) != 0) {
      pTagData.bytes = extractInteger(buf, bufPos);
      bufPos += 4;
    }

    if ((head_flags & TOC_FLAG) != 0) {
      if (pTagData.toc != null) for (var i = 0; i < NUMTOCENTRIES; i++) pTagData.toc[i] = buf[bufPos + i];
      bufPos += NUMTOCENTRIES;
    }

    pTagData.vbrScale = -1;

    if ((head_flags & VBR_SCALE_FLAG) != 0) {
      pTagData.vbrScale = extractInteger(buf, bufPos);
      bufPos += 4;
    }

    pTagData.headersize = (hId + 1) * 72000 * hBitrate / pTagData.samprate;
    bufPos += 21;
    var encDelay = buf[bufPos + 0] << 4;
    encDelay += buf[bufPos + 1] >> 4;
    var encPadding = (buf[bufPos + 1] & 0x0F) << 8;
    encPadding += buf[bufPos + 2] & 0xff;
    /* check for reasonable values (this may be an old Xing header, */

    /* not a INFO tag) */

    if (encDelay < 0 || encDelay > 3000) encDelay = -1;
    if (encPadding < 0 || encPadding > 3000) encPadding = -1;
    pTagData.encDelay = encDelay;
    pTagData.encPadding = encPadding;
    /* success */

    return pTagData;
  };
  /**
  * Initializes the header
  *
  * @param gfp
  *            global flags
  */


  this.InitVbrTag = function (gfp) {
    var gfc = gfp.internal_flags;
    /**
    * <PRE>
    * Xing VBR pretends to be a 48kbs layer III frame.  (at 44.1kHz).
    * (at 48kHz they use 56kbs since 48kbs frame not big enough for
    * table of contents)
    * let's always embed Xing header inside a 64kbs layer III frame.
    * this gives us enough room for a LAME version string too.
    * size determined by sampling frequency (MPEG1)
    * 32kHz:    216 bytes@48kbs    288bytes@ 64kbs
    * 44.1kHz:  156 bytes          208bytes@64kbs     (+1 if padding = 1)
    * 48kHz:    144 bytes          192
    *
    * MPEG 2 values are the same since the framesize and samplerate
    * are each reduced by a factor of 2.
    * </PRE>
    */

    var kbps_header;
    if (1 == gfp.version) kbps_header = XING_BITRATE1;else if (gfp.out_samplerate < 16000) kbps_header = XING_BITRATE25;else kbps_header = XING_BITRATE2;
    if (gfp.VBR == $e674985ea62d27cf$var$VbrMode.vbr_off) kbps_header = gfp.brate; // make sure LAME Header fits into Frame

    var totalFrameSize = (gfp.version + 1) * 72000 * kbps_header / gfp.out_samplerate;
    var headerSize = gfc.sideinfo_len + LAMEHEADERSIZE;
    gfc.VBR_seek_table.TotalFrameSize = totalFrameSize;

    if (totalFrameSize < headerSize || totalFrameSize > MAXFRAMESIZE) {
      /* disable tag, it wont fit */
      gfp.bWriteVbrTag = false;
      return;
    }

    gfc.VBR_seek_table.nVbrNumFrames = 0;
    gfc.VBR_seek_table.nBytesWritten = 0;
    gfc.VBR_seek_table.sum = 0;
    gfc.VBR_seek_table.seen = 0;
    gfc.VBR_seek_table.want = 1;
    gfc.VBR_seek_table.pos = 0;

    if (gfc.VBR_seek_table.bag == null) {
      gfc.VBR_seek_table.bag = new int[400]();
      gfc.VBR_seek_table.size = 400;
    } // write dummy VBR tag of all 0's into bitstream


    var buffer = $e674985ea62d27cf$var$new_byte(MAXFRAMESIZE);
    setLameTagFrameHeader(gfp, buffer);
    var n = gfc.VBR_seek_table.TotalFrameSize;

    for (var i = 0; i < n; ++i) bs.add_dummy_byte(gfp, buffer[i] & 0xff, 1);
  };
  /**
  * Fast CRC-16 computation (uses table crc16Lookup).
  *
  * @param value
  * @param crc
  * @return
  */


  function crcUpdateLookup(value, crc) {
    var tmp = crc ^ value;
    crc = crc >> 8 ^ crc16Lookup[tmp & 0xff];
    return crc;
  }

  this.updateMusicCRC = function (crc, buffer, bufferPos, size) {
    for (var i = 0; i < size; ++i) crc[0] = crcUpdateLookup(buffer[bufferPos + i], crc[0]);
  };
  /**
  * Write LAME info: mini version + info on various switches used (Jonathan
  * Dee 2001/08/31).
  *
  * @param gfp
  *            global flags
  * @param musicLength
  *            music length
  * @param streamBuffer
  *            pointer to output buffer
  * @param streamBufferPos
  *            offset into the output buffer
  * @param crc
  *            computation of CRC-16 of Lame Tag so far (starting at frame
  *            sync)
  * @return number of bytes written to the stream
  */


  function putLameVBR(gfp, musicLength, streamBuffer, streamBufferPos, crc) {
    var gfc = gfp.internal_flags;
    var bytesWritten = 0;
    /* encoder delay */

    var encDelay = gfp.encoder_delay;
    /* encoder padding */

    var encPadding = gfp.encoder_padding;
    /* recall: gfp.VBR_q is for example set by the switch -V */

    /* gfp.quality by -q, -h, -f, etc */

    var quality = 100 - 10 * gfp.VBR_q - gfp.quality;
    var version = v.getLameVeryShortVersion();
    var vbr;
    var revision = 0x00;
    var revMethod; // numbering different in vbr_mode vs. Lame tag

    var vbrTypeTranslator = [1, 5, 3, 2, 4, 0, 3];
    var lowpass = 0 | (gfp.lowpassfreq / 100.0 + .5 > 255 ? 255 : gfp.lowpassfreq / 100.0 + .5);
    var peakSignalAmplitude = 0;
    var radioReplayGain = 0;
    var audiophileReplayGain = 0;
    var noiseShaping = gfp.internal_flags.noise_shaping;
    var stereoMode = 0;
    var nonOptimal = 0;
    var sourceFreq = 0;
    var misc = 0;
    var musicCRC = 0; // psy model type: Gpsycho or NsPsytune

    var expNPsyTune = (gfp.exp_nspsytune & 1) != 0;
    var safeJoint = (gfp.exp_nspsytune & 2) != 0;
    var noGapMore = false;
    var noGapPrevious = false;
    var noGapCount = gfp.internal_flags.nogap_total;
    var noGapCurr = gfp.internal_flags.nogap_current; // 4 bits

    var athType = gfp.ATHtype;
    var flags = 0; // vbr modes

    var abrBitrate;

    switch (gfp.VBR) {
      case vbr_abr:
        abrBitrate = gfp.VBR_mean_bitrate_kbps;
        break;

      case vbr_off:
        abrBitrate = gfp.brate;
        break;

      default:
        abrBitrate = gfp.VBR_min_bitrate_kbps;
    } // revision and vbr method


    if (gfp.VBR.ordinal() < vbrTypeTranslator.length) vbr = vbrTypeTranslator[gfp.VBR.ordinal()];else vbr = 0x00; // unknown

    revMethod = 0x10 * revision + vbr; // ReplayGain

    if (gfc.findReplayGain) {
      if (gfc.RadioGain > 0x1FE) gfc.RadioGain = 0x1FE;
      if (gfc.RadioGain < -510) gfc.RadioGain = -510; // set name code

      radioReplayGain = 0x2000; // set originator code to `determined automatically'

      radioReplayGain |= 0xC00;
      if (gfc.RadioGain >= 0) // set gain adjustment
        radioReplayGain |= gfc.RadioGain;else {
        // set the sign bit
        radioReplayGain |= 0x200; // set gain adjustment

        radioReplayGain |= -gfc.RadioGain;
      }
    } // peak sample


    if (gfc.findPeakSample) peakSignalAmplitude = Math.abs(0 | gfc.PeakSample / 32767.0 * Math.pow(2, 23) + .5); // nogap

    if (noGapCount != -1) {
      if (noGapCurr > 0) noGapPrevious = true;
      if (noGapCurr < noGapCount - 1) noGapMore = true;
    } // flags


    flags = athType + ((expNPsyTune ? 1 : 0) << 4) + ((safeJoint ? 1 : 0) << 5) + ((noGapMore ? 1 : 0) << 6) + ((noGapPrevious ? 1 : 0) << 7);
    if (quality < 0) quality = 0; // stereo mode field (Intensity stereo is not implemented)

    switch (gfp.mode) {
      case MONO:
        stereoMode = 0;
        break;

      case STEREO:
        stereoMode = 1;
        break;

      case DUAL_CHANNEL:
        stereoMode = 2;
        break;

      case JOINT_STEREO:
        if (gfp.force_ms) stereoMode = 4;else stereoMode = 3;
        break;

      case NOT_SET: //$FALL-THROUGH$

      default:
        stereoMode = 7;
        break;
    }

    if (gfp.in_samplerate <= 32000) sourceFreq = 0x00;else if (gfp.in_samplerate == 48000) sourceFreq = 0x02;else if (gfp.in_samplerate > 48000) sourceFreq = 0x03;else // default is 44100Hz
      sourceFreq = 0x01; // Check if the user overrided the default LAME behavior with some
    // nasty options

    if (gfp.short_blocks == $e674985ea62d27cf$var$ShortBlock.short_block_forced || gfp.short_blocks == $e674985ea62d27cf$var$ShortBlock.short_block_dispensed || gfp.lowpassfreq == -1 && gfp.highpassfreq == -1 ||
    /* "-k" */
    gfp.scale_left < gfp.scale_right || gfp.scale_left > gfp.scale_right || gfp.disable_reservoir && gfp.brate < 320 || gfp.noATH || gfp.ATHonly || athType == 0 || gfp.in_samplerate <= 32000) nonOptimal = 1;
    misc = noiseShaping + (stereoMode << 2) + (nonOptimal << 5) + (sourceFreq << 6);
    musicCRC = gfc.nMusicCRC; // Write all this information into the stream

    createInteger(streamBuffer, streamBufferPos + bytesWritten, quality);
    bytesWritten += 4;

    for (var j = 0; j < 9; j++) streamBuffer[streamBufferPos + bytesWritten + j] = 0xff & version.charAt(j);

    bytesWritten += 9;
    streamBuffer[streamBufferPos + bytesWritten] = 0xff & revMethod;
    bytesWritten++;
    streamBuffer[streamBufferPos + bytesWritten] = 0xff & lowpass;
    bytesWritten++;
    createInteger(streamBuffer, streamBufferPos + bytesWritten, peakSignalAmplitude);
    bytesWritten += 4;
    createShort(streamBuffer, streamBufferPos + bytesWritten, radioReplayGain);
    bytesWritten += 2;
    createShort(streamBuffer, streamBufferPos + bytesWritten, audiophileReplayGain);
    bytesWritten += 2;
    streamBuffer[streamBufferPos + bytesWritten] = 0xff & flags;
    bytesWritten++;
    if (abrBitrate >= 255) streamBuffer[streamBufferPos + bytesWritten] = 0xFF;else streamBuffer[streamBufferPos + bytesWritten] = 0xff & abrBitrate;
    bytesWritten++;
    streamBuffer[streamBufferPos + bytesWritten] = 0xff & encDelay >> 4;
    streamBuffer[streamBufferPos + bytesWritten + 1] = 0xff & (encDelay << 4) + (encPadding >> 8);
    streamBuffer[streamBufferPos + bytesWritten + 2] = 0xff & encPadding;
    bytesWritten += 3;
    streamBuffer[streamBufferPos + bytesWritten] = 0xff & misc;
    bytesWritten++; // unused in rev0

    streamBuffer[streamBufferPos + bytesWritten++] = 0;
    createShort(streamBuffer, streamBufferPos + bytesWritten, gfp.preset);
    bytesWritten += 2;
    createInteger(streamBuffer, streamBufferPos + bytesWritten, musicLength);
    bytesWritten += 4;
    createShort(streamBuffer, streamBufferPos + bytesWritten, musicCRC);
    bytesWritten += 2; // Calculate tag CRC.... must be done here, since it includes previous
    // information

    for (var i = 0; i < bytesWritten; i++) crc = crcUpdateLookup(streamBuffer[streamBufferPos + i], crc);

    createShort(streamBuffer, streamBufferPos + bytesWritten, crc);
    bytesWritten += 2;
    return bytesWritten;
  }

  function skipId3v2(fpStream) {
    // seek to the beginning of the stream
    fpStream.seek(0); // read 10 bytes in case there's an ID3 version 2 header here

    var id3v2Header = $e674985ea62d27cf$var$new_byte(10);
    fpStream.readFully(id3v2Header);
    /* does the stream begin with the ID3 version 2 file identifier? */

    var id3v2TagSize;
    if (!new String(id3v2Header, "ISO-8859-1").startsWith("ID3"))
      /*
      * the tag size (minus the 10-byte header) is encoded into four
      * bytes where the most significant bit is clear in each byte
      */
      id3v2TagSize = ((id3v2Header[6] & 0x7f) << 21 | (id3v2Header[7] & 0x7f) << 14 | (id3v2Header[8] & 0x7f) << 7 | id3v2Header[9] & 0x7f) + id3v2Header.length;else
      /* no ID3 version 2 tag in this stream */
      id3v2TagSize = 0;
    return id3v2TagSize;
  }

  this.getLameTagFrame = function (gfp, buffer) {
    var gfc = gfp.internal_flags;
    if (!gfp.bWriteVbrTag) return 0;
    if (gfc.Class_ID != Lame.LAME_ID) return 0;
    if (gfc.VBR_seek_table.pos <= 0) return 0;
    if (buffer.length < gfc.VBR_seek_table.TotalFrameSize) return gfc.VBR_seek_table.TotalFrameSize;
    $e674985ea62d27cf$var$Arrays.fill(buffer, 0, gfc.VBR_seek_table.TotalFrameSize, 0); // 4 bytes frame header

    setLameTagFrameHeader(gfp, buffer); // Create TOC entries

    var toc = $e674985ea62d27cf$var$new_byte(NUMTOCENTRIES);
    if (gfp.free_format) for (var i = 1; i < NUMTOCENTRIES; ++i) toc[i] = 0xff & 255 * i / 100;else xingSeekTable(gfc.VBR_seek_table, toc); // Start writing the tag after the zero frame

    var streamIndex = gfc.sideinfo_len;
    /**
    * Note: Xing header specifies that Xing data goes in the ancillary data
    * with NO ERROR PROTECTION. If error protecton in enabled, the Xing
    * data still starts at the same offset, and now it is in sideinfo data
    * block, and thus will not decode correctly by non-Xing tag aware
    * players
    */

    if (gfp.error_protection) streamIndex -= 2; // Put Vbr tag

    if (gfp.VBR == $e674985ea62d27cf$var$VbrMode.vbr_off) {
      buffer[streamIndex++] = 0xff & VBRTag1.charAt(0);
      buffer[streamIndex++] = 0xff & VBRTag1.charAt(1);
      buffer[streamIndex++] = 0xff & VBRTag1.charAt(2);
      buffer[streamIndex++] = 0xff & VBRTag1.charAt(3);
    } else {
      buffer[streamIndex++] = 0xff & VBRTag0.charAt(0);
      buffer[streamIndex++] = 0xff & VBRTag0.charAt(1);
      buffer[streamIndex++] = 0xff & VBRTag0.charAt(2);
      buffer[streamIndex++] = 0xff & VBRTag0.charAt(3);
    } // Put header flags


    createInteger(buffer, streamIndex, FRAMES_FLAG + BYTES_FLAG + TOC_FLAG + VBR_SCALE_FLAG);
    streamIndex += 4; // Put Total Number of frames

    createInteger(buffer, streamIndex, gfc.VBR_seek_table.nVbrNumFrames);
    streamIndex += 4; // Put total audio stream size, including Xing/LAME Header

    var streamSize = gfc.VBR_seek_table.nBytesWritten + gfc.VBR_seek_table.TotalFrameSize;
    createInteger(buffer, streamIndex, 0 | streamSize);
    streamIndex += 4;
    /* Put TOC */

    $e674985ea62d27cf$var$System.arraycopy(toc, 0, buffer, streamIndex, toc.length);
    streamIndex += toc.length;
    if (gfp.error_protection) // (jo) error_protection: add crc16 information to header
      bs.CRC_writeheader(gfc, buffer); // work out CRC so far: initially crc = 0

    var crc = 0x00;

    for (var i = 0; i < streamIndex; i++) crc = crcUpdateLookup(buffer[i], crc); // Put LAME VBR info


    streamIndex += putLameVBR(gfp, streamSize, buffer, streamIndex, crc);
    return gfc.VBR_seek_table.TotalFrameSize;
  };
  /**
  * Write final VBR tag to the file.
  *
  * @param gfp
  *            global flags
  * @param stream
  *            stream to add the VBR tag to
  * @return 0 (OK), -1 else
  * @throws IOException
  *             I/O error
  */


  this.putVbrTag = function (gfp, stream) {
    var gfc = gfp.internal_flags;
    if (gfc.VBR_seek_table.pos <= 0) return -1; // Seek to end of file

    stream.seek(stream.length()); // Get file size, abort if file has zero length.

    if (stream.length() == 0) return -1; // The VBR tag may NOT be located at the beginning of the stream. If an
    // ID3 version 2 tag was added, then it must be skipped to write the VBR
    // tag data.

    var id3v2TagSize = skipId3v2(stream); // Seek to the beginning of the stream

    stream.seek(id3v2TagSize);
    var buffer = $e674985ea62d27cf$var$new_byte(MAXFRAMESIZE);
    var bytes = getLameTagFrame(gfp, buffer);
    if (bytes > buffer.length) return -1;
    if (bytes < 1) return 0; // Put it all to disk again

    stream.write(buffer, 0, bytes); // success

    return 0;
  };
}

$e674985ea62d27cf$exports = $e674985ea62d27cf$var$VBRTag;

function $dd7ee3788d91dcb8$var$GetAudio() {
  this.setModules = function (parse2, mpg2) {};
}

function $dd7ee3788d91dcb8$var$Parse() {
  this.setModules = function (ver2, id32, pre2) {};
}

function $dd7ee3788d91dcb8$var$MPGLib() {}

function $dd7ee3788d91dcb8$var$ID3Tag() {
  this.setModules = function (_bits, _ver) {};
}

function $dd7ee3788d91dcb8$var$Mp3Encoder(channels, samplerate, kbps) {
  if (arguments.length != 3) {
    console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified");
    channels = 1;
    samplerate = 44100;
    kbps = 128;
  }

  var lame = new $kk1yk();
  var gaud = new $dd7ee3788d91dcb8$var$GetAudio();
  var ga = new $b8dhq();
  var bs = new $ctaQC();
  var p = new $7960aab77e945546$exports();
  var qupvt = new $84mea();
  var qu = new $df08f3a0d41b7a78$exports();
  var vbr = new $e674985ea62d27cf$exports();
  var ver = new $34609aeb1df0c2af$exports();
  var id3 = new $dd7ee3788d91dcb8$var$ID3Tag();
  var rv = new $b5a7ab7c590f5d1e$exports();
  var tak = new $65Sx2();
  var parse = new $dd7ee3788d91dcb8$var$Parse();
  var mpg = new $dd7ee3788d91dcb8$var$MPGLib();
  lame.setModules(ga, bs, p, qupvt, qu, vbr, ver, id3, mpg);
  bs.setModules(ga, mpg, ver, vbr);
  id3.setModules(bs, ver);
  p.setModules(lame);
  qu.setModules(bs, rv, qupvt, tak);
  qupvt.setModules(tak, rv, lame.enc.psy);
  rv.setModules(bs);
  tak.setModules(qupvt);
  vbr.setModules(lame, bs, ver);
  gaud.setModules(parse, mpg);
  parse.setModules(ver, id3, p);
  var gfp = lame.lame_init();
  gfp.num_channels = channels;
  gfp.in_samplerate = samplerate;
  gfp.brate = kbps;
  gfp.mode = $jL6I1.STEREO;
  gfp.quality = 3;
  gfp.bWriteVbrTag = false;
  gfp.disable_reservoir = true;
  gfp.write_id3tag_automatic = false;
  var retcode = lame.lame_init_params(gfp);
  $dd7ee3788d91dcb8$var$assert(0 == retcode);
  var maxSamples = 1152;
  var mp3buf_size = 0 | 1.25 * maxSamples + 7200;
  var mp3buf = $dd7ee3788d91dcb8$var$new_byte(mp3buf_size);

  this.encodeBuffer = function (left, right) {
    if (channels == 1) right = left;
    $dd7ee3788d91dcb8$var$assert(left.length == right.length);

    if (left.length > maxSamples) {
      maxSamples = left.length;
      mp3buf_size = 0 | 1.25 * maxSamples + 7200;
      mp3buf = $dd7ee3788d91dcb8$var$new_byte(mp3buf_size);
    }

    var _sz = lame.lame_encode_buffer(gfp, left, right, left.length, mp3buf, 0, mp3buf_size);

    return new Int8Array(mp3buf.subarray(0, _sz));
  };

  this.flush = function () {
    var _sz = lame.lame_encode_flush(gfp, mp3buf, 0, mp3buf_size);

    return new Int8Array(mp3buf.subarray(0, _sz));
  };
}

function $dd7ee3788d91dcb8$var$WavHeader() {
  this.dataOffset = 0;
  this.dataLen = 0;
  this.channels = 0;
  this.sampleRate = 0;
}

function $dd7ee3788d91dcb8$var$fourccToInt(fourcc) {
  return fourcc.charCodeAt(0) << 24 | fourcc.charCodeAt(1) << 16 | fourcc.charCodeAt(2) << 8 | fourcc.charCodeAt(3);
}

$dd7ee3788d91dcb8$var$WavHeader.RIFF = $dd7ee3788d91dcb8$var$fourccToInt("RIFF");
$dd7ee3788d91dcb8$var$WavHeader.WAVE = $dd7ee3788d91dcb8$var$fourccToInt("WAVE");
$dd7ee3788d91dcb8$var$WavHeader.fmt_ = $dd7ee3788d91dcb8$var$fourccToInt("fmt ");
$dd7ee3788d91dcb8$var$WavHeader.data = $dd7ee3788d91dcb8$var$fourccToInt("data");

$dd7ee3788d91dcb8$var$WavHeader.readHeader = function (dataView) {
  var w = new $dd7ee3788d91dcb8$var$WavHeader();
  var header = dataView.getUint32(0, false);
  if ($dd7ee3788d91dcb8$var$WavHeader.RIFF != header) return;
  dataView.getUint32(4, true);
  if ($dd7ee3788d91dcb8$var$WavHeader.WAVE != dataView.getUint32(8, false)) return;
  if ($dd7ee3788d91dcb8$var$WavHeader.fmt_ != dataView.getUint32(12, false)) return;
  var fmtLen = dataView.getUint32(16, true);
  var pos = 20;

  switch (fmtLen) {
    case 16:
    case 18:
      w.channels = dataView.getUint16(pos + 2, true);
      w.sampleRate = dataView.getUint32(pos + 4, true);
      break;

    default:
      throw "extended fmt chunk not implemented";
  }

  pos += fmtLen;
  var data = $dd7ee3788d91dcb8$var$WavHeader.data;
  var len = 0;

  while (data != header) {
    header = dataView.getUint32(pos, false);
    len = dataView.getUint32(pos + 4, true);
    if (data == header) break;
    pos += len + 8;
  }

  w.dataLen = len;
  w.dataOffset = pos + 8;
  return w;
};

$dd7ee3788d91dcb8$export$9ca5d136ebf61cf2 = $dd7ee3788d91dcb8$var$Mp3Encoder;
$dd7ee3788d91dcb8$export$cb948f2d6837f136 = $dd7ee3788d91dcb8$var$WavHeader;

function encodeMp3(arrayBuffer) {
  const wav = $dd7ee3788d91dcb8$export$cb948f2d6837f136.readHeader(new DataView(arrayBuffer));
  const dataView = new Int16Array(arrayBuffer, wav.dataOffset, wav.dataLen / 2);
  const mp3Encoder = new $dd7ee3788d91dcb8$export$9ca5d136ebf61cf2(wav.channels, wav.sampleRate, 128);
  const maxSamples = 1152;
  const samplesLeft = wav.channels === 1 ? dataView : new Int16Array(wav.dataLen / (2 * wav.channels));
  const samplesRight = wav.channels === 2 ? new Int16Array(wav.dataLen / (2 * wav.channels)) : undefined;

  if (wav.channels > 1) {
    for (let j = 0; j < samplesLeft.length; j++) {
      samplesLeft[j] = dataView[j * 2];
      samplesRight[j] = dataView[j * 2 + 1];
    }
  }

  const dataBuffer = [];
  let remaining = samplesLeft.length;

  for (let i = 0; remaining >= maxSamples; i += maxSamples) {
    const left = samplesLeft.subarray(i, i + maxSamples);
    let right;

    if (samplesRight) {
      right = samplesRight.subarray(i, i + maxSamples);
    }

    const mp3buf = mp3Encoder.encodeBuffer(left, right);
    dataBuffer.push(new Int8Array(mp3buf));
    remaining -= maxSamples;
  }

  const mp3Lastbuf = mp3Encoder.flush();
  dataBuffer.push(new Int8Array(mp3Lastbuf));
  return dataBuffer;
} // Convert audioFile to arrayBuffer, because Mp3Encoder requires a parameter of ArrayBuffer type


function downsampleToWav(file, callback) {
  // Browser compatibility
  // https://caniuse.com/?search=AudioContext
  const audioCtx = new AudioContext({
    sampleRate: VOICE_RECORDER_AUDIO_SAMPLE_RATE
  });
  const fileReader = new FileReader();

  fileReader.onload = function (ev) {
    // Decode audio
    audioCtx.decodeAudioData(ev.target.result, buffer => {
      // this is where you down sample the audio, usually is 44100 samples per second
      const usingWebkit = !window.OfflineAudioContext;
      const offlineAudioCtx = new OfflineAudioContext(1, 16000 * buffer.duration, 16000);
      const soundSource = offlineAudioCtx.createBufferSource();
      soundSource.buffer = buffer;
      soundSource.connect(offlineAudioCtx.destination);
      const reader = new FileReader();

      reader.onload = function () {
        const renderCompleteHandler = evt => {
          const renderedBuffer = usingWebkit ? evt.renderedBuffer : evt;
          const buffer = bufferToWav(renderedBuffer, renderedBuffer.length);

          if (callback) {
            callback(buffer);
          }
        };

        if (usingWebkit) {
          offlineAudioCtx.oncomplete = renderCompleteHandler;
          offlineAudioCtx.startRendering();
        } else {
          offlineAudioCtx.startRendering().then(renderCompleteHandler) // eslint-disable-next-line no-console
          .catch(err => console.warn(err));
        }
      };

      reader.readAsArrayBuffer(file);
      soundSource.start(0);
    });
  };

  fileReader.readAsArrayBuffer(file);
}

function bufferToWav(abuffer, len) {
  const numOfChan = abuffer.numberOfChannels;
  const length = len * numOfChan * 2 + 44;
  const buffer = new ArrayBuffer(length);
  const view = new DataView(buffer);
  const channels = [];
  let i = 0;
  let sample;
  let offset = 0;
  let pos = 0; // write WAVE header

  setUint32(0x46464952); // "RIFF"

  setUint32(length - 8); // file length - 8

  setUint32(0x45564157); // "WAVE"

  setUint32(0x20746d66); // "fmt " chunk

  setUint32(16); // length = 16

  setUint16(1); // PCM (uncompressed)

  setUint16(numOfChan);
  setUint32(abuffer.sampleRate);
  setUint32(abuffer.sampleRate * 2 * numOfChan); // avg. bytes/sec

  setUint16(numOfChan * 2); // block-align

  setUint16(16); // 16-bit (hardcoded in this demo)

  setUint32(0x61746164); // "data" - chunk

  setUint32(length - pos - 4); // chunk length
  // write interleaved data

  for (i = 0; i < abuffer.numberOfChannels; i++) channels.push(abuffer.getChannelData(i));

  while (pos < length) {
    for (i = 0; i < numOfChan; i++) {
      // interleave channels
      sample = Math.max(-1, Math.min(1, channels[i][offset])); // clamp

      sample = (0.5 + sample < 0 ? sample * 32768 : sample * 32767) | 0; // scale to 16-bit signed int

      view.setInt16(pos, sample, true); // write 16-bit sample

      pos += 2;
    }

    offset++; // next source sample
  }

  return buffer;

  function setUint16(data) {
    view.setUint16(pos, data, true);
    pos += 2;
  }

  function setUint32(data) {
    view.setUint32(pos, data, true);
    pos += 4;
  }
}

var WebAudioUtils97e524fa = /*#__PURE__*/Object.freeze({
    __proto__: null,
    downsampleToWav: downsampleToWav,
    encodeMp3: encodeMp3
});

export { App };
